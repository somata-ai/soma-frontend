/*! For license information please see main.fc8ebd8b.js.LICENSE.txt */
!function(){var e={4679:function(e,t,n){"use strict";n.d(t,{JL:function(){return i},Zu:function(){return o}});var r=n(5671),a=n(3144),i=function(){function e(t,n){(0,r.Z)(this,e),this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return(0,a.Z)(e,[{key:"get",value:function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}},{key:"set",value:function(e,t){this.dataIdsCount++,this.data.set(e,t)}},{key:"has",value:function(e){return this.data.has(e)}},{key:"delete",value:function(e){return this.dataIdsCount--,this.data.delete(e)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),e}(),o=function(){function e(){(0,r.Z)(this,e)}return(0,a.Z)(e,[{key:"refCount",value:function(e){return u("refCount")}},{key:"incRef",value:function(e){return u("incRef")}},{key:"timerAvailable",value:function(){return!0}},{key:"time",value:function(e){return u("time")}},{key:"read",value:function(e){return u("read")}},{key:"readSync",value:function(e){return u("readSync")}},{key:"readToGPU",value:function(e,t){return u("readToGPU")}},{key:"numDataIds",value:function(){return u("numDataIds")}},{key:"disposeData",value:function(e,t){return u("disposeData")}},{key:"write",value:function(e,t,n){return u("write")}},{key:"move",value:function(e,t,n,r,a){return u("move")}},{key:"createTensorFromGPUData",value:function(e,t,n){return u("createTensorFromGPUData")}},{key:"memory",value:function(){return u("memory")}},{key:"floatPrecision",value:function(){return u("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"dispose",value:function(){return u("dispose")}}]),e}();function u(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}},318:function(e,t,n){"use strict";n.d(t,{BV:function(){return T},wv:function(){return E}});var r=n(7762),a=n(3433),i=n(4165),o=n(5861),u=n(5671),s=n(3144),c=n(4679),l=n(5050),f=n(6581),d=n(2145),h=n(8864),p=n(7269),v=n(115),g=n(6147),m=function(){function e(t,n){(0,u.Z)(this,e),this.backendTimer=t,this.logger=n,null==n&&(this.logger=new y)}return(0,s.Z)(e,[{key:"profileKernel",value:function(e,t,n){var a,i,o=function(){a=n()},u=v.now();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();var s,c=(0,r.Z)(a);try{for(c.s();!(s=c.n()).done;){s.value.dataSync()}}catch(h){c.e(h)}finally{c.f()}i=Promise.resolve({kernelMs:v.now()-u})}if((0,l.OB)().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var f=function(){var t=a[d];t.data().then((function(n){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(n,t.dtype,e)}))},d=0;d<a.length;d++)f();return{kernelName:e,outputs:a,inputs:t,timeMs:i.then((function(e){return e.kernelMs})),extraInfo:i.then((function(e){return null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""}))}}},{key:"logKernelProfile",value:function(e){var t=this,n=e.kernelName,r=e.outputs,a=e.timeMs,i=e.inputs,o=e.extraInfo;r.forEach((function(e){Promise.all([e.data(),a,o]).then((function(r){t.logger.logKernelProfile(n,e,r[0],r[1],i,r[2])}))}))}}]),e}();var y=function(){function e(){(0,u.Z)(this,e)}return(0,s.Z)(e,[{key:"logKernelProfile",value:function(e,t,n,r,a,i){var o="number"===typeof r?g.oj("".concat(r,"ms"),9):r.error,u=g.oj(e,25),s=t.rank,c=t.size,l=g.oj(t.shape.toString(),14),f="";for(var d in a){var h=a[d];if(null!=h){var p=h.shape||t.shape,v=p.length;f+="".concat(d,": ").concat(v,"D ").concat(v>0?p:""," ")}}console.log("%c".concat(u,"\t%c").concat(o,"\t%c").concat(s,"D ").concat(l,"\t%c").concat(c,"\t%c").concat(f,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),e}();function b(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(var o=0;o<e.length;o++){var u=e[o],s=u.inputs;for(var c in s){for(var l=s[c],f=!1,d=0;d<t.length;d++)if(r[l.id]){u.outputs.forEach((function(e){return r[e.id]=!0})),f=!0,a[u.id]=!0;break}if(f)break}}var h={};h[n.id]=!0;for(var p={},v=e.length-1;v>=0;v--)for(var g=e[v],m=g.inputs,y=0;y<g.outputs.length;y++)if(h[g.outputs[y].id]){for(var b in m)h[m[b].id]=!0,p[g.id]=!0;break}for(var x=[],k=0;k<e.length;k++){var w=e[k];if(a[w.id]&&p[w.id]){var _={};for(var C in w.inputs){var S=w.inputs[C];r[S.id]&&(_[C]=S)}var A=Object.assign({},w);A.inputs=_,A.outputs=w.outputs,x.push(A)}}return x}function x(e,t,n,r){for(var a=function(){var a=t[i],o=[];if(a.outputs.forEach((function(t){var n=e[t.id];null!=n?o.push(n):o.push(null)})),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(a.kernelName,"."));var u=a.gradient(o),s=function(t){if(!(t in u))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(u),"."));var i=n((function(){return u[t]()}));if("float32"!==i.dtype)throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(i.dtype,"'"));var o=a.inputs[t];if(!g.cO(i.shape,o.shape))throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(i.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==e[o.id])e[o.id]=i;else{var s=e[o.id];e[o.id]=r(s,i),s.dispose()}};for(var c in a.inputs)s(c)},i=t.length-1;i>=0;i--)a()}var k=n(4376),w=n(9064);function _(e){return null!=e.kernelName}var C=function(){function e(){(0,u.Z)(this,e),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((function(e){return e.name}))))}}}return(0,s.Z)(e,[{key:"dispose",value:function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()}}]),e}(),S=function(){function e(t){(0,u.Z)(this,e),this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new C}return(0,s.Z)(e,[{key:"ready",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t,n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.pendingBackendInit){e.next=2;break}return e.abrupt("return",this.pendingBackendInit.then((function(){})));case 2:if(null==this.backendInstance){e.next=4;break}return e.abrupt("return");case 4:t=this.getSortedBackends(),n=0;case 6:if(!(n<t.length)){e.next=18;break}return r=t[n],e.next=10,this.initializeBackend(r).success;case 10:if(!e.sent){e.next=15;break}return e.next=14,this.setBackend(r);case 14:return e.abrupt("return");case 15:n++,e.next=6;break;case 18:throw new Error("Could not initialize any backends, all backend initializations failed.");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]}},{key:"findBackendFactory",value:function(e){return e in this.registryFactory?this.registryFactory[e].factory:null}},{key:"registerBackend",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(p.Z("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}},{key:"setBackend",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.registryFactory[t]){e.next=2;break}throw new Error("Backend name '".concat(t,"' not found in registry"));case 2:if(this.backendName=t,null!=this.registry[t]){e.next=16;break}if(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,!n.asyncInit){e.next=12;break}return e.next=9,r;case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=r;case 13:if(e.t0){e.next=16;break}return e.abrupt("return",!1);case 16:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new m(this.backendInstance),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupRegisteredKernels",value:function(){var e=this;(0,h.tr)(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(e){var t=this;(0,h.tr)(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))}},{key:"initializeBackend",value:function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{var r=n.factory();if(!r||r instanceof c.Zu||"function"!==typeof r.then)return this.registry[e]=r,{success:!0,asyncInit:!1};var a=++this.pendingBackendInitId,i=r.then((function(n){return!(a<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return a<t.pendingBackendInitId||(t.pendingBackendInit=null,p.Z("Initialization of backend ".concat(e," failed")),p.Z(n.stack||n.message)),!1}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}catch(o){return p.Z("Initialization of backend ".concat(e," failed")),p.Z(o.stack||o.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(e,t){var n,r=this,a=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(e,t,n){e();try{var r=n();return t(),r}catch(a){throw t(),a}}},{key:"nextTensorId",value:function(){return e.nextTensorId++}},{key:"nextVariableId",value:function(){return e.nextVariableId++}},{key:"clone",value:function(e){var t=T.runKernel(d.iJz,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){var t={x:e},n={dtype:"float32"};return T.runKernel(d.RFZ,t,n)}}}),[],{}),t}},{key:"runKernel",value:function(e,t,n){if(null==this.backendName&&this.backend,!(null!=(0,h.pI)(e,this.backendName)))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(e){a+="complex64"===e.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(e,"'"))}},{key:"runKernelFunc",value:function(e){var t,n,r,a=this,i=[],o=this.isTapeOn(),u=this.state.numBytes,s=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;var c=_(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(_(e)){var l=e.kernelName,f=e.inputs,d=e.attrs;null==this.backendName&&this.backend;var p=(0,h.pI)(l,this.backendName);g.hu(null!=p,(function(){return"Cannot find registered kernel '".concat(l,"' for backend '").concat(a.backendName,"'")})),n=function(){var e=a.backend.numDataIds();r=p.kernelFunc({inputs:f,attrs:d,backend:a.backend});var t=Array.isArray(r)?r:[r];a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(l,e,t);var n=t.map((function(e){return null!=e.rank?e:a.makeTensorFromTensorInfo(e)}));if(o){var u=a.getTensorsForGradient(l,f,n);i=a.saveTensorsForBackwardMode(u)}return n}}else{var v=e.forwardFunc,m=function(e){o&&(i=e.map((function(e){return a.keep(a.clone(e))})))};n=function(){var e=a.backend.numDataIds();r=a.tidy((function(){return v(a.backend,m)}));var t=Array.isArray(r)?r:[r];return a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(c,e,t),t}}var y,b=e.inputs,x=e.attrs,k=_(e)?null:e.backwardsFunc;return this.scopedRun((function(){return a.state.kernelDepth++}),(function(){return a.state.kernelDepth--}),(function(){a.ENV.getBool("DEBUG")||a.state.profiling?(y=a.profiler.profileKernel(c,b,(function(){return n()})),a.ENV.getBool("DEBUG")&&a.profiler.logKernelProfile(y),t=y.outputs):t=n()})),o&&this.addTapeNode(c,b,t,k,i,x),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-u,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-s,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(b).map((function(e){return null!=b[e]?b[e].shape:null})),outputShapes:t.map((function(e){return e.shape})),kernelTimeMs:y.timeMs,extraInfo:y.extraInfo}),Array.isArray(r)?t:t[0]}},{key:"saveTensorsForBackwardMode",value:function(e){var t=this,n=e.map((function(e){return t.keep(t.clone(e))}));return n}},{key:"getTensorsForGradient",value:function(e,t,n){var r=(0,h.uk)(e);if(null!=r){var a,i=r.inputsToSave||[],o=r.outputsToSave||[];r.saveAllInputs?(g.hu(Array.isArray(t),(function(){return"saveAllInputs is true, expected inputs to be an array."})),a=Object.keys(t).map((function(e){return t[e]}))):a=i.map((function(e){return t[e]}));var u=n.filter((function(e,t){return o[t]}));return a.concat(u)}return[]}},{key:"makeTensor",value:function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=e;"string"===n&&g.HD(e[0])&&(a=e.map((function(e){return v.encodeString(e)})));var i=r.write(a,t,n),o=new k.es(t,n,i,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){var u=this.state.tensorInfo.get(i),s=(0,g.Ub)(a);this.state.numBytes+=s-u.bytes,u.bytes=s}return o}},{key:"makeTensorFromDataId",value:function(e,t,n,r){var a={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(a,r)}},{key:"makeTensorFromTensorInfo",value:function(e,t){var n=e.dataId,r=e.shape,a=e.dtype,i=new k.es(r,a,n,this.nextTensorId());return this.trackTensor(i,t),i}},{key:"makeVariable",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));var a=new k._w(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}},{key:"trackTensor",value:function(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;var n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*g.bT(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof k._w||this.track(e)}},{key:"incRef",value:function(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}},{key:"removeDataId",value:function(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}},{key:"disposeTensor",value:function(e){if(this.state.tensorInfo.has(e.dataId)){var t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){var n=e.size*g.bT(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}}},{key:"disposeVariables",value:function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}}},{key:"disposeVariable",value:function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}},{key:"memory",value:function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}},{key:"profile",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,o,u,s,c;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.profiling=!0,n=this.state.numBytes,o=this.state.numTensors,this.state.activeProfile.kernels=[],e.next=6,t();case 6:this.state.activeProfile.result=e.sent,this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,(0,a.Z)(this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot})))),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-o,u=(0,r.Z)(this.state.activeProfile.kernels),e.prev=12,u.s();case 14:if((s=u.n()).done){e.next=24;break}return c=s.value,e.next=18,c.kernelTimeMs;case 18:return c.kernelTimeMs=e.sent,e.next=21,c.extraInfo;case 21:c.extraInfo=e.sent;case 22:e.next=14;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(12),u.e(e.t0);case 29:return e.prev=29,u.f(),e.finish(29);case 32:return e.abrupt("return",this.state.activeProfile);case 33:case"end":return e.stop()}}),e,this,[[12,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(e,t,n,r,a,i){var o=this,u={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},s=(0,h.uk)(e);null!=s&&(r=s.gradFunc),null!=r&&(u.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],a=g.wT(r.size,r.dtype);return o.makeTensor(a,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],a,i)}),this.state.activeTape.push(u)}},{key:"keep",value:function(e){return e.kept=!0,e}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}},{key:"endScope",value:function(e){for(var t=this,n=(0,w.getTensorsInContainer)(e),r=new Set(n.map((function(e){return e.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==o.id||t.track(e)}))}},{key:"gradients",value:function(e,t,n){var a=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(g.hu(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var o=this.scopedRun((function(){return a.startTape()}),(function(){return a.endTape()}),(function(){return a.tidy("forward",e)}));g.hu(o instanceof k.es,(function(){return"The result y returned by f() must be a tensor."}));var u=b(this.state.activeTape,t,o);if(!i&&0===u.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e={};e[o.id]=null==n?A(o.shape):n,x(e,u,(function(e){return a.tidy(e)}),N);var i=t.map((function(t){return e[t.id]}));return 0===a.state.gradientDepth&&(a.state.activeTape.forEach((function(e){var t,n=(0,r.Z)(e.saved);try{for(n.s();!(t=n.n()).done;){t.value.dispose()}}catch(a){n.e(a)}finally{n.f()}})),a.state.activeTape=null),{value:o,grads:i}}))}},{key:"customGrad",value:function(e){var t=this;return g.hu(g.mf(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i;g.hu(r.every((function(e){return e instanceof k.es})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};r.forEach((function(e,t){o[t]=e}));var u=function(t,n){return i=e.apply(void 0,[].concat(r,[n])),g.hu(i.value instanceof k.es,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),g.hu(g.mf(i.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),i.value},s=function(e,t){var n=i.gradFunc(e,t),a=Array.isArray(n)?n:[n];g.hu(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),g.hu(a.every((function(e){return e instanceof k.es})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(e,t){o[t]=function(){return e}})),o};return t.runKernelFunc({forwardFunc:u,backwardsFunc:s,inputs:o})}}},{key:"readSync",value:function(e){return this.state.tensorInfo.get(e).backend.readSync(e)}},{key:"read",value:function(e){return this.state.tensorInfo.get(e).backend.read(e)}},{key:"readToGPU",value:function(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}},{key:"time",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(t){var n,r;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,v.now)(),e.next=3,this.backend.time(t);case 3:return(r=e.sent).wallMs=(0,v.now)()-n,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"track",value:function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}},{key:"reset",value:function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new C,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}]),e}();function A(e){var t=(0,g.p8)((0,g.NA)(e),"float32");return T.makeTensor(t,e,"float32")}function E(){var e=(0,f.D)();if(null==e._tfengine){var t=new l.qA(e);e._tfengine=new S(t)}return(0,l.iG)(e._tfengine.ENV),(0,k.Vi)((function(){return e._tfengine})),e._tfengine}S.nextTensorId=0,S.nextVariableId=0;var T=E();function N(e,t){var n={a:e,b:t};return T.runKernel(d.mm_,n)}},5050:function(e,t,n){"use strict";n.d(t,{OB:function(){return h},Vi:function(){return p},iG:function(){return v},qA:function(){return l}});var r=n(9439),a=n(4165),i=n(5861),o=n(5671),u=n(3144),s=n(6147),c="tfjsflags",l=function(){function e(t){(0,o.Z)(this,e),this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=f,this.populateURLFlags()}return(0,u.Z)(e,[{key:"setPlatform",value:function(e,t){null!=this.platform&&(h().getBool("IS_TEST")||h().getBool("PROD")||console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(e,"."))),this.platformName=e,this.platform=t}},{key:"registerFlag",value:function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];h().getBool("IS_TEST")||h().getBool("PROD")||console.warn("Setting feature override from URL ".concat(e,": ").concat(r,".")),this.set(e,r)}}},{key:"getAsync",value:function(){var e=(0,i.Z)((0,a.Z)().mark((function e(t){return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in this.flags)){e.next=2;break}return e.abrupt("return",this.flags[t]);case 2:return e.next=4,this.evaluateFlag(t);case 4:return this.flags[t]=e.sent,e.abrupt("return",this.flags[t]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(e){if(e in this.flags)return this.flags[e];var t=this.evaluateFlag(e);if((0,s.tI)(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}},{key:"getNumber",value:function(e){return this.get(e)}},{key:"getBool",value:function(e){return this.get(e)}},{key:"getFlags",value:function(){return this.flags}},{key:"features",get:function(){return this.flags}},{key:"set",value:function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}},{key:"evaluateFlag",value:function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}},{key:"setFlags",value:function(e){this.flags=Object.assign({},e)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){var e=this;if("undefined"!==typeof this.global&&"undefined"!==typeof this.global.location&&"undefined"!==typeof this.global.location.search){var t=this.getQueryParams(this.global.location.search);if(c in t)t[c].split(",").forEach((function(t){var n=t.split(":"),a=(0,r.Z)(n,2),i=a[0],o=a[1];e.urlFlags[i]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if("".concat(+t)===t)return+t;throw new Error("Could not parse value flag value ".concat(t," for flag ").concat(e,"."))}(i,o)}))}}}]),e}();function f(e){var t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return d(t,r[0],r[1]),r.join("=")})),t}function d(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function h(){return p}var p=null;function v(e){p=e}},6581:function(e,t,n){"use strict";var r;function a(){if(null==r){var e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof n.g)e=n.g;else if("undefined"!==typeof process)e=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}r=e}return r}function i(e,t){var n=function(){var e=a();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);var r=t();return n.set(e,r),n.get(e)}n.d(t,{D:function(){return a},R:function(){return i}})},5875:function(e,t,n){"use strict";n.d(t,{B9:function(){return g},CQ:function(){return b},Cd:function(){return x},Cn:function(){return m},G4:function(){return u},MX:function(){return l},N5:function(){return p},N8:function(){return f},N_:function(){return k},R:function(){return s},SR:function(){return d},VY:function(){return E},XV:function(){return y},cF:function(){return c},cj:function(){return w},jq:function(){return S},lu:function(){return v},sq:function(){return h},x3:function(){return _},y3:function(){return A},ze:function(){return C}});var r=n(318),a=n(5050),i=n(4376),o=n(9064);function u(){(0,a.OB)().set("PROD",!0)}function s(){(0,a.OB)().set("DEBUG",!0)}function c(){(0,a.OB)().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function l(e){(0,a.OB)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function f(){r.BV.disposeVariables()}function d(){return r.BV}function h(){return r.BV.memory()}function p(e){return r.BV.profile(e)}function v(e,t){return r.BV.tidy(e,t)}function g(e){(0,o.getTensorsInContainer)(e).forEach((function(e){return e.dispose()}))}function m(e){return r.BV.keep(e)}function y(e){return r.BV.time(e)}function b(e){return r.BV.setBackend(e)}function x(){return r.BV.ready()}function k(){return r.BV.backendName}function w(e){r.BV.removeBackend(e)}function _(e){return r.BV.findBackend(e)}function C(e){return r.BV.findBackendFactory(e)}function S(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return r.BV.registerBackend(e,t,n)}function A(){return r.BV.backend}function E(e,t){(0,a.OB)().setPlatform(e,t)}(0,i.FZ)(l)},6450:function(e,t,n){"use strict";n.d(t,{UQ:function(){return s},cb:function(){return h},fN:function(){return f},h7:function(){return l},pn:function(){return d},ti:function(){return c}});var r=n(3433),a=n(318),i=n(4376),o=n(8354),u=n(6147);function s(e){return u.hu(u.mf(e),(function(){return"The f passed in grad(f) must be a function"})),function(t,n){var r=(0,o._1)(t,"x","tf.grad","string_or_numeric"),i=null!=n?(0,o._1)(n,"dy","tf.grad"):null;return a.BV.tidy((function(){var t=a.BV.gradients((function(){return e(r)}),[r],i),n=t.value,o=t.grads;return null!=i&&u.k5(n.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),p(o),o[0]}))}}function c(e){return u.hu(u.mf(e),(function(){return"The f passed in grads(f) must be a function"})),function(t,n){u.hu(Array.isArray(t),(function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"}));var i=(0,o.sI)(t,"args","tf.grads","string_or_numeric"),s=null!=n?(0,o._1)(n,"dy","tf.grads"):null;return a.BV.tidy((function(){var t=a.BV.gradients((function(){return e.apply(void 0,(0,r.Z)(i))}),i,s),n=t.value,o=t.grads;return null!=s&&u.k5(n.shape,s.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),p(o),o}))}}function l(e){return u.hu(u.mf(e),(function(){return"The f passed in valueAndGrad(f) must be a function"})),function(t,n){u.hu(t instanceof i.es,(function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"})),u.hu(null==n||n instanceof i.es,(function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"}));var r=a.BV.gradients((function(){return e(t)}),[t],n),o=r.grads,s=r.value;return p(o),{grad:o[0],value:s}}}function f(e){return u.hu(u.mf(e),(function(){return"The f passed in valueAndGrads(f) must be a function"})),function(t,n){u.hu(Array.isArray(t)&&t.every((function(e){return e instanceof i.es})),(function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"})),u.hu(null==n||n instanceof i.es,(function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"}));var o=a.BV.gradients((function(){return e.apply(void 0,(0,r.Z)(t))}),t,n);return null!=n&&u.k5(o.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),p(o.grads),o}}function d(e,t){u.hu(u.mf(e),(function(){return"The f passed in variableGrads(f) must be a function"})),u.hu(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof i._w})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var r in t=[],a.BV.registeredVariables)t.push(a.BV.registeredVariables[r]);var o=n?t.filter((function(e){return!e.trainable})):null,s=t.length;t=t.filter((function(e){return e.trainable})),u.hu(t.length>0,(function(){return"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(s," variables is ")+"trainable."}));var c=a.BV.gradients(e,t,null,!0),l=c.value,f=c.grads;u.hu(f.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),u.hu(0===l.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(l.rank," tensor")}));var d={};return t.forEach((function(e,t){null!=f[t]&&(d[e.name]=f[t])})),null!=o&&o.forEach((function(e){return d[e.name]=null})),{value:l,grads:d}}function h(e){return a.BV.customGrad(e)}function p(e){if(e.filter((function(e){return null==e})).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}},4341:function(e,t,n){"use strict";n.r(t),n.d(t,{Abs:function(){return $t.SYM},Acos:function(){return $t.VGw},Acosh:function(){return $t.SpW},AdadeltaOptimizer:function(){return st},AdagradOptimizer:function(){return lt},AdamOptimizer:function(){return ht},AdamaxOptimizer:function(){return gt},Add:function(){return $t.mm_},AddN:function(){return $t.Xze},All:function(){return $t.oT6},Any:function(){return $t.IKK},ArgMax:function(){return $t.sJF},ArgMin:function(){return $t.aJk},Asin:function(){return $t.M2y},Asinh:function(){return $t.qw7},Atan:function(){return $t.jMg},Atan2:function(){return $t.QCc},Atanh:function(){return $t.Oyi},AvgPool:function(){return $t.JhU},AvgPool3D:function(){return $t._k9},AvgPool3DGrad:function(){return $t.IMb},AvgPoolGrad:function(){return $t.ROF},BatchMatMul:function(){return $t.XLW},BatchToSpaceND:function(){return $t.zws},Bincount:function(){return $t.zvY},BroadcastArgs:function(){return $t.eEB},BroadcastTo:function(){return $t.Ly9},Cast:function(){return $t.RFZ},Ceil:function(){return $t.gJX},ClipByValue:function(){return $t.xnO},Complex:function(){return $t.Zz9},ComplexAbs:function(){return $t.yj2},Concat:function(){return $t.Eh3},Conv2D:function(){return $t.mhS},Conv2DBackpropFilter:function(){return $t.wUP},Conv2DBackpropInput:function(){return $t.wm},Conv3D:function(){return $t.x12},Conv3DBackpropFilterV2:function(){return $t.o2y},Conv3DBackpropInputV2:function(){return $t.ik2},Cos:function(){return $t.mc4},Cosh:function(){return $t.TR1},CropAndResize:function(){return $t.VcC},Cumprod:function(){return $t.Byc},Cumsum:function(){return $t.iHb},DataStorage:function(){return Bs.JL},DenseBincount:function(){return $t.QRR},DepthToSpace:function(){return $t.T0n},DepthwiseConv2dNative:function(){return $t.cie},DepthwiseConv2dNativeBackpropFilter:function(){return $t.sL$},DepthwiseConv2dNativeBackpropInput:function(){return $t.y7R},Diag:function(){return $t.$w},Dilation2D:function(){return $t.p4S},Dilation2DBackpropFilter:function(){return $t.Vn9},Dilation2DBackpropInput:function(){return $t.ekb},ENV:function(){return x.Vi},Einsum:function(){return $t.$g6},Elu:function(){return $t.SX0},EluGrad:function(){return $t.HEU},Environment:function(){return x.qA},Equal:function(){return $t.hdR},Erf:function(){return $t.Omj},Exp:function(){return $t.NEP},ExpandDims:function(){return $t.YFo},Expm1:function(){return $t.Y0y},FFT:function(){return $t.vwp},Fill:function(){return $t.deh},FlipLeftRight:function(){return $t.Uyb},Floor:function(){return $t.OR},FloorDiv:function(){return $t.jeX},FromPixels:function(){return $t.eBW},FusedBatchNorm:function(){return $t.sHE},FusedConv2D:function(){return $t._V0},FusedDepthwiseConv2D:function(){return $t.luS},GatherNd:function(){return $t.q1x},GatherV2:function(){return $t.qi_},Greater:function(){return $t.iZT},GreaterEqual:function(){return $t.Acj},IFFT:function(){return $t.Qg5},Identity:function(){return $t.iJz},Imag:function(){return $t.J_u},IsFinite:function(){return $t.avt},IsInf:function(){return $t.iWB},IsNan:function(){return $t.r7n},KernelBackend:function(){return Bs.Zu},LRN:function(){return $t.eZ0},LRNGrad:function(){return $t.Hhh},LeakyRelu:function(){return $t.J$2},Less:function(){return $t.vtC},LessEqual:function(){return $t.CAk},LinSpace:function(){return $t.e7N},Log:function(){return $t.ZbH},Log1p:function(){return $t.kU},LogSoftmax:function(){return $t.qCd},LogicalAnd:function(){return $t.PYm},LogicalNot:function(){return $t.VfG},LogicalOr:function(){return $t.MZg},LogicalXor:function(){return $t.w6g},LowerBound:function(){return $t.qIC},Max:function(){return $t.YoZ},MaxPool:function(){return $t.mTV},MaxPool3D:function(){return $t.OAf},MaxPool3DGrad:function(){return $t.OU7},MaxPoolGrad:function(){return $t.OV7},MaxPoolWithArgmax:function(){return $t.vFR},Maximum:function(){return $t.BMI},Mean:function(){return $t.q2K},Min:function(){return $t.c17},Minimum:function(){return $t.q8u},MirrorPad:function(){return $t.jQs},Mod:function(){return $t.Vbg},MomentumOptimizer:function(){return yt},Multinomial:function(){return $t.NZg},Multiply:function(){return $t.wYn},Neg:function(){return $t.kuV},NonMaxSuppressionV3:function(){return $t.uv1},NonMaxSuppressionV4:function(){return $t.cye},NonMaxSuppressionV5:function(){return $t.W0H},NotEqual:function(){return $t.yQU},OP_SCOPE_SUFFIX:function(){return qt.z},OneHot:function(){return $t.we_},OnesLike:function(){return $t.qWM},Optimizer:function(){return ut},OptimizerConstructors:function(){return Dn},Pack:function(){return $t.QiL},PadV2:function(){return $t.lyA},Pool:function(){return $t.Kgp},Pow:function(){return $t.pe_},Prelu:function(){return $t.o0g},Prod:function(){return $t.DlI},RMSPropOptimizer:function(){return bt},RaggedGather:function(){return $t.dDz},RaggedRange:function(){return $t.CQl},RaggedTensorToTensor:function(){return $t.BiW},Range:function(){return $t.e6w},Rank:function(){return Fn.yw},Real:function(){return $t.xJR},RealDiv:function(){return $t.oHH},Reciprocal:function(){return $t.$HU},Reduction:function(){return au},Relu:function(){return $t.qkr},Relu6:function(){return $t.SbG},Reshape:function(){return $t.HZH},ResizeBilinear:function(){return $t._Yw},ResizeBilinearGrad:function(){return $t.zbQ},ResizeNearestNeighbor:function(){return $t.dpD},ResizeNearestNeighborGrad:function(){return $t.Hmb},Reverse:function(){return $t.mKl},RotateWithOffset:function(){return $t.b9H},Round:function(){return $t.e07},Rsqrt:function(){return $t.bV0},SGDOptimizer:function(){return mt},ScatterNd:function(){return $t.xQA},SearchSorted:function(){return $t.nr8},Select:function(){return $t.PhF},Selu:function(){return $t.oFR},Sigmoid:function(){return $t.a5O},Sign:function(){return $t.i5y},Sin:function(){return $t.RQH},Sinh:function(){return $t.wYB},Slice:function(){return $t.p2w},Softmax:function(){return $t.Gcp},Softplus:function(){return $t.MRv},SpaceToBatchND:function(){return $t.TQc},SparseFillEmptyRows:function(){return $t.O3z},SparseReshape:function(){return $t.nhH},SparseSegmentMean:function(){return $t.w3H},SparseSegmentSum:function(){return $t.ZjV},SparseToDense:function(){return $t.D2d},SplitV:function(){return $t.L8s},Sqrt:function(){return $t.FKq},Square:function(){return $t.bK0},SquaredDifference:function(){return $t._tC},Step:function(){return $t.h8e},StridedSlice:function(){return $t.jQk},StringNGrams:function(){return $t._JP},StringSplit:function(){return $t.s1s},StringToHashBucketFast:function(){return $t.XkS},Sub:function(){return $t.Tr8},Sum:function(){return $t.GBy},Tan:function(){return $t.sEM},Tanh:function(){return $t.MIZ},Tensor:function(){return je.es},TensorBuffer:function(){return je.YD},Tile:function(){return $t.n9L},TopK:function(){return $t.cWu},Transform:function(){return $t.wx7},Transpose:function(){return $t.G3Y},Unique:function(){return $t.kpP},Unpack:function(){return $t.ToN},UnsortedSegmentSum:function(){return $t.Qvg},UpperBound:function(){return $t.XDQ},Variable:function(){return je._w},ZerosLike:function(){return $t.RuY},_FusedMatMul:function(){return $t.usg},abs:function(){return pt.W},acos:function(){return In.K},acosh:function(){return Mn._},add:function(){return Ke.I},addN:function(){return On},all:function(){return Rn.$},any:function(){return Zn.Y},argMax:function(){return Bn.N},argMin:function(){return zn.v},asin:function(){return Ln.Z},asinh:function(){return Pn.V},atan:function(){return jn.z},atan2:function(){return Un.f},atanh:function(){return Wn.C},avgPool:function(){return Vn.w},avgPool3d:function(){return Hn},backend:function(){return Ye.y3},backend_util:function(){return h},basicLSTMCell:function(){return Qn},batchNorm:function(){return er.t},batchNorm2d:function(){return tr},batchNorm3d:function(){return nr},batchNorm4d:function(){return rr},batchToSpaceND:function(){return Jn.E},bincount:function(){return ar},booleanMaskAsync:function(){return Ji},broadcastArgs:function(){return ir},broadcastTo:function(){return or.U},broadcast_util:function(){return Kt},browser:function(){return u},buffer:function(){return Ue},cast:function(){return We.p},ceil:function(){return ur.m},clipByValue:function(){return sr.i},clone:function(){return Ve.d},complex:function(){return N.P},concat:function(){return Xn.z},concat1d:function(){return cr},concat2d:function(){return lr},concat3d:function(){return fr},concat4d:function(){return dr},conv1d:function(){return hr.P},conv2d:function(){return pr.T},conv2dTranspose:function(){return vr.b},conv3d:function(){return gr},conv3dTranspose:function(){return yr},copyRegisteredKernels:function(){return Qt.T3},cos:function(){return br.m},cosh:function(){return xr.f},cosineWindow:function(){return so},cumprod:function(){return kr.$},cumsum:function(){return wr.z},customGrad:function(){return nt.cb},denseBincount:function(){return _r},deprecationWarn:function(){return Ye.MX},depthToSpace:function(){return Cr.n},depthwiseConv2d:function(){return Sr.B},device_util:function(){return r},diag:function(){return Ar},dilation2d:function(){return Er.W},disableDeprecationWarnings:function(){return Ye.cF},dispose:function(){return Ye.B9},disposeVariables:function(){return Ye.N8},div:function(){return $e.h},divNoNan:function(){return Tr.N},dot:function(){return Nr.A},dropout:function(){return oo},einsum:function(){return Dr},elu:function(){return Fr.p},enableDebugMode:function(){return Ye.R},enableProdMode:function(){return Ye.G4},enclosingPowerOfTwo:function(){return uo},engine:function(){return Ye.SR},env:function(){return x.OB},equal:function(){return Ir.D},erf:function(){return Mr.q},euclideanNorm:function(){return Or.d},exp:function(){return Rr.Q},expandDims:function(){return Zr.d},expm1:function(){return Br.t},eye:function(){return Lr},fft:function(){return _i.k},fill:function(){return ct.h},findBackend:function(){return Ye.x3},findBackendFactory:function(){return Ye.ze},floor:function(){return Pr.G},floorDiv:function(){return jr.q},fused:function(){return f},gather:function(){return Ur.I},gatherND:function(){return io},gather_util:function(){return s},getBackend:function(){return Ye.N_},getGradient:function(){return Qt.uk},getKernel:function(){return Qt.pI},getKernelsForBackend:function(){return Qt.tr},grad:function(){return nt.UQ},grads:function(){return nt.ti},greater:function(){return Wr.p},greaterEqual:function(){return Vr.b},ifft:function(){return Ci.S},imag:function(){return Gr.a},image:function(){return Eu},inTopKAsync:function(){return lo},io:function(){return i},irfft:function(){return Si.w},isFinite:function(){return qr.x},isInf:function(){return Hr.U},isNaN:function(){return Xr.i},keep:function(){return Ye.Cn},kernel_impls:function(){return p},leakyRelu:function(){return Yr.h},less:function(){return Kr.d},lessEqual:function(){return $r.z},linalg:function(){return Tu},linspace:function(){return Qr},localResponseNormalization:function(){return Jr.G},log:function(){return ea.c},log1p:function(){return ta.K},logSigmoid:function(){return na.e},logSoftmax:function(){return ra.C},logSumExp:function(){return aa.l},logicalAnd:function(){return ia.H},logicalNot:function(){return oa.h},logicalOr:function(){return ua.K},logicalXor:function(){return sa.e},losses:function(){return Nu},lowerBound:function(){return fa},matMul:function(){return Vt.O},math:function(){return o},max:function(){return da.F},maxPool:function(){return ha._},maxPool3d:function(){return pa},maxPoolWithArgmax:function(){return va},maximum:function(){return vt.g},mean:function(){return ga.J},memory:function(){return Ye.sq},meshgrid:function(){return ya},min:function(){return ba.V},minimum:function(){return xa.L},mirrorPad:function(){return ka.V},mod:function(){return wa.w},moments:function(){return Ca},movingAverage:function(){return to},mul:function(){return Qe.d},multiRNNCell:function(){return Sa},multinomial:function(){return Aa},neg:function(){return Ea.W},nextFrame:function(){return Ou},norm:function(){return eo.K},notEqual:function(){return Ta.Q},oneHot:function(){return Gt.l},ones:function(){return ma.i},onesLike:function(){return Na.J},op:function(){return qt.op},outerProduct:function(){return Da},pad:function(){return Fa.v},pad1d:function(){return Ia},pad2d:function(){return Ma},pad3d:function(){return Oa},pad4d:function(){return Ra},pool:function(){return Za.d},pow:function(){return ft.s},prelu:function(){return Ba.A},print:function(){return Ge},prod:function(){return za.W},profile:function(){return Ye.N5},raggedGather:function(){return La},raggedRange:function(){return Pa},raggedTensorToTensor:function(){return ja},rand:function(){return Ua},randomGamma:function(){return Ha},randomNormal:function(){return Xa},randomStandardNormal:function(){return Ya},randomUniform:function(){return Ka},range:function(){return $a},ready:function(){return Ye.Cd},real:function(){return Qa.k},reciprocal:function(){return Ja.M},registerBackend:function(){return Ye.jq},registerGradient:function(){return Qt.Li},registerKernel:function(){return Qt.wC},relu:function(){return ei.U},relu6:function(){return ti.b},removeBackend:function(){return Ye.cj},reshape:function(){return qn.X},reverse:function(){return ni.G},reverse1d:function(){return ri},reverse2d:function(){return ai},reverse3d:function(){return ii},reverse4d:function(){return oi},rfft:function(){return Ai.Q},round:function(){return ui.N},rsqrt:function(){return si.b},scalar:function(){return rt.i},scatterND:function(){return no},scatter_util:function(){return c},searchSorted:function(){return la},selu:function(){return ci.U},separableConv2d:function(){return li.U},serialization:function(){return a},setBackend:function(){return Ye.CQ},setPlatform:function(){return Ye.VY},setdiff1dAsync:function(){return di},sigmoid:function(){return Yn.X},sign:function(){return hi.X},signal:function(){return Au},sin:function(){return pi.O},sinh:function(){return vi.R},slice:function(){return Kn.t},slice1d:function(){return gi},slice2d:function(){return mi},slice3d:function(){return yi},slice4d:function(){return bi},slice_util:function(){return dn},softmax:function(){return xi.X},softplus:function(){return ki.W},spaceToBatchND:function(){return wi.f},sparse:function(){return Du},sparseToDense:function(){return ao},spectral:function(){return Su},split:function(){return Ei.V},sqrt:function(){return Je._},square:function(){return et.h},squaredDifference:function(){return Ti.$},squeeze:function(){return Ni.L},stack:function(){return Di.k},step:function(){return Fi.N},stridedSlice:function(){return Ii.N},string:function(){return Fu},sub:function(){return dt.l},sum:function(){return Mi.S},sumOutType:function(){return Fn.z4},tan:function(){return Oi.O},tanh:function(){return $n.A},tensor:function(){return I},tensor1d:function(){return Ri},tensor2d:function(){return Zi},tensor3d:function(){return Jt},tensor4d:function(){return Bi},tensor5d:function(){return zi},tensor6d:function(){return Li},tensor_util:function(){return hn},test_util:function(){return l},tidy:function(){return Ye.lu},tile:function(){return zr.G},time:function(){return Ye.XV},topk:function(){return Pi.h},train:function(){return Iu},transpose:function(){return Ht.p},truncatedNormal:function(){return ji},unique:function(){return Ui.T},unregisterGradient:function(){return Qt.bt},unregisterKernel:function(){return Qt.nE},unsortedSegmentSum:function(){return Wi.p},unstack:function(){return Vi.H},upcastType:function(){return Fn.x8},upperBound:function(){return Gi},util:function(){return pn},valueAndGrad:function(){return nt.h7},valueAndGrads:function(){return nt.fN},variable:function(){return qi},variableGrads:function(){return nt.pn},version_core:function(){return Nn},where:function(){return Hi.a},whereAsync:function(){return Ki},zeros:function(){return $i.l},zerosLike:function(){return tt.P}});var r={};n.r(r),n.d(r,{isBrowser:function(){return b},isMobile:function(){return y},mockIsMobile:function(){return m}});var a={};n.r(a),n.d(a,{Serializable:function(){return at},SerializationMap:function(){return it},registerClass:function(){return ot}});var i={};n.r(i),n.d(i,{browserFiles:function(){return Ct},browserHTTPRequest:function(){return Zt},concatenateArrayBuffers:function(){return W},copyModel:function(){return Me},decodeWeights:function(){return B},encodeWeights:function(){return R},fromMemory:function(){return Pt},fromMemorySync:function(){return jt},getLoadHandlers:function(){return ne},getModelArtifactsForJSON:function(){return H},getModelArtifactsForJSONSync:function(){return q},getModelArtifactsInfoForJSON:function(){return Y},getSaveHandlers:function(){return te},getWeightSpecs:function(){return K},http:function(){return Rt},isHTTPScheme:function(){return Mt},listModels:function(){return Ne},loadWeights:function(){return Tt},moveModel:function(){return Re},registerLoadRouter:function(){return ee},registerSaveRouter:function(){return J},removeModel:function(){return Fe},weightsLoaderFactory:function(){return Dt},withSaveHandler:function(){return Ut},withSaveHandlerSync:function(){return Wt}});var o={};n.r(o),n.d(o,{confusionMatrix:function(){return Yt}});var u={};n.r(u),n.d(u,{fromPixels:function(){return un},fromPixelsAsync:function(){return nn},toPixels:function(){return an}});var s={};n.r(s),n.d(s,{prepareAndValidate:function(){return sn}});var c={};n.r(c),n.d(c,{calculateShapes:function(){return fn},validateInput:function(){return ln},validateUpdateShape:function(){return cn}});var l={};n.r(l),n.d(l,{TEST_EPSILON_FLOAT16:function(){return vn},createVideoElement:function(){return An},encodeStrings:function(){return Sn},expectArrayBuffersEqual:function(){return Cn},expectArraysClose:function(){return gn},expectArraysEqual:function(){return xn},expectNumbersClose:function(){return kn},expectPromiseToFail:function(){return bn},expectValuesInRange:function(){return _n},play:function(){return En},testEpsilon:function(){return mn}});var f={};n.r(f),n.d(f,{conv2d:function(){return yo},depthwiseConv2d:function(){return ko},matMul:function(){return wo}});var d={};n.r(d),n.d(d,{collectGatherOpShapeInfo:function(){return Os},computeOutShape:function(){return Ms},segOpComputeOptimalWindowSize:function(){return Is}});var h={};n.r(h),n.d(h,{ERF_A1:function(){return $u},ERF_A2:function(){return Qu},ERF_A3:function(){return Ju},ERF_A4:function(){return es},ERF_A5:function(){return ts},ERF_P:function(){return Ku},PARALLELIZE_THRESHOLD:function(){return ju},RowPartitionType:function(){return _u},SELU_SCALE:function(){return Yu.$},SELU_SCALEALPHA:function(){return Yu.y},applyActivation:function(){return go},assertAndGetBroadcastShape:function(){return Kt.assertAndGetBroadcastShape},assertAxesAreInnerMostDims:function(){return _a.lB},assertParamsConsistent:function(){return Ru},assignToTypedArray:function(){return ss},axesAreInnerMostDims:function(){return _a.YB},calculateShapes:function(){return fn},checkEinsumDimSizes:function(){return vs},checkPadOnDimRoundingMode:function(){return Gn.m},combineLocations:function(){return _a.Vh},combineRaggedTensorToTensorShapes:function(){return Bu},complexWithEvenIndex:function(){return is},complexWithOddIndex:function(){return os},computeConv2DInfo:function(){return Gn.Ix},computeConv3DInfo:function(){return Gn.jw},computeDefaultPad:function(){return Gn.aO},computeDilation2DInfo:function(){return Gn.Rf},computeOptimalWindowSize:function(){return Uu},computeOutAndReduceShapes:function(){return _a.kz},computeOutShape:function(){return Zu},computePool2DInfo:function(){return Gn.Xw},computePool3DInfo:function(){return Gn.pl},convertConv2DDataFormat:function(){return Gn.sl},decodeEinsumEquation:function(){return hs},eitherStridesOrDilationsAreOne:function(){return Gn.jT},expandShapeToKeepDim:function(){return _a.rv},exponent:function(){return ls},exponents:function(){return cs},fromStringArrayToUint8:function(){return Zs},fromUint8ToStringArray:function(){return Rs},getAxesPermutation:function(){return _a.Q3},getBroadcastDims:function(){return Kt.getBroadcastDims},getComplexWithIndex:function(){return us},getEinsumComputePath:function(){return gs},getEinsumPermutation:function(){return ps},getFusedBiasGradient:function(){return vo},getFusedDyActivation:function(){return po},getImageCenter:function(){return Wu},getInnerMostAxes:function(){return _a.sY},getPermuted:function(){return Gu},getRaggedRank:function(){return Lu},getReductionAxes:function(){return Kt.getReductionAxes},getReshaped:function(){return Vu},getReshapedPermuted:function(){return qu},getRowPartitionTypesHelper:function(){return zu},getSliceBeginCoords:function(){return Hu},getSliceSize:function(){return Xu},getSparseFillEmptyRowsIndicesDenseShapeMismatch:function(){return xs},getSparseFillEmptyRowsNegativeIndexErrorMessage:function(){return ks},getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:function(){return ws},getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:function(){return Ss},getSparseReshapeInputOutputMismatchErrorMessage:function(){return Es},getSparseReshapeInputOutputMultipleErrorMessage:function(){return As},getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:function(){return _s},getSparseReshapeNegativeOutputDimErrorMessage:function(){return Cs},getSparseSegmentReductionIndicesOutOfRangeErrorMessage:function(){return Fs},getSparseSegmentReductionNegativeSegmentIdsErrorMessage:function(){return Ts},getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:function(){return Ns},getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:function(){return Ds},getUndoAxesPermutation:function(){return _a.LJ},isIdentityPermutation:function(){return ms},log:function(){return ns.c},mergeRealAndImagArrays:function(){return rs},prepareAndValidate:function(){return sn},prepareSplitSize:function(){return bs},segment_util:function(){return d},shouldFuse:function(){return mo},slice_util:function(){return dn},splitRealAndImagArrays:function(){return as},stridesOrDilationsArePositive:function(){return Gn.U3},tupleValuesAreOne:function(){return Gn.I0},upcastType:function(){return Fn.x8},validateDefaultValueShape:function(){return Pu},validateInput:function(){return ln},validateUpdateShape:function(){return cn},warn:function(){return ns.Z}});var p={};n.r(p),n.d(p,{nonMaxSuppressionV3Impl:function(){return Ro},nonMaxSuppressionV4Impl:function(){return Zo},nonMaxSuppressionV5Impl:function(){return Bo},whereImpl:function(){return Xi}});var v,g=n(318);function m(e){v=e}function y(e){if(void 0!==v)return v;if(e||"undefined"!==typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;var t=e.userAgent||e.vendor||("undefined"!==typeof window?window.opera:"");if(!t){var n=e;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function b(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}var x=n(5050),k=(0,x.OB)();k.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),k.registerFlag("IS_BROWSER",(function(){return b()})),k.registerFlag("IS_NODE",(function(){return"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node})),k.registerFlag("IS_CHROME",(function(){return"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),k.registerFlag("PROD",(function(){return!1})),k.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return k.getBool("DEBUG")})),k.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),k.registerFlag("IS_TEST",(function(){return!1})),k.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(function(){return!0})),k.registerFlag("WRAP_TO_IMAGEBITMAP",(function(){return!1})),k.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(function(){return!1})),k.registerFlag("USE_SETTIMEOUTCUSTOM",(function(){return!1}));var w=n(5671),_=n(3144),C=n(7762),S=n(4165),A=n(5861),E=n(9439),T=n(3433),N=n(9253),D=n(8354),F=n(7960);function I(e,t,n){var r=(0,D.C)(e,n);return(0,F.H)(e,t,r,n)}var M=n(6147),O={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};function R(e,t){return Z.apply(this,arguments)}function Z(){return Z=(0,A.Z)((0,S.Z)().mark((function e(t,n){var r,a,i,o,u,s;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],a=[],i=Array.isArray(t)?t.map((function(e){return e.name})):Object.keys(t),o=(0,S.Z)().mark((function e(){var o,s,c,l;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=i[u],"float32"===(s=Array.isArray(t)?t[u].tensor:t[o]).dtype||"int32"===s.dtype||"bool"===s.dtype||"string"===s.dtype||"complex64"===s.dtype){e.next=4;break}throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(s.dtype));case 4:c={name:o,shape:s.shape,dtype:s.dtype},"string"===s.dtype?(l=new Promise(function(){var e=(0,A.Z)((0,S.Z)().mark((function e(t){var n,r,a,i,o,u,c;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.bytes();case 2:for(n=e.sent,r=n.reduce((function(e,t){return e+t.length}),0)+4*n.length,a=new Uint8Array(r),i=0,o=0;o<n.length;o++)u=n[o],c=new Uint8Array(new Uint32Array([u.length]).buffer),a.set(c,i),i+=4,a.set(u,i),i+=u.length;t(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),a.push(l)):a.push(s.data()),null!=n&&(c.group=n),r.push(c);case 8:case"end":return e.stop()}}),e)})),u=0;case 5:if(!(u<i.length)){e.next=10;break}return e.delegateYield(o(),"t0",7);case 7:++u,e.next=5;break;case 10:return e.next=12,Promise.all(a);case 12:return s=e.sent,e.abrupt("return",{data:z(s),specs:r});case 14:case"end":return e.stop()}}),e)}))),Z.apply(this,arguments)}function B(e,t){var n,r,a={},i=0,o=(0,C.Z)(t);try{for(o.s();!(r=o.n()).done;){var u=r.value,s=u.name,c=u.dtype,l=u.shape,f=(0,M.NA)(l),d=void 0;if("quantization"in u){var h=u.quantization;if("uint8"===h.dtype||"uint16"===h.dtype){if(!("min"in h)||!("scale"in h))throw new Error("Weight ".concat(u.name," with quantization ").concat(h.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==h.dtype)throw new Error("Weight ".concat(u.name," has unknown ")+"quantization dtype ".concat(h.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==c)throw new Error("Weight ".concat(u.name," is quantized with ").concat(h.dtype," ")+"which only supports weights of type float32 not ".concat(c,"."))}var p=O[h.dtype],v=e.slice(i,i+f*p),g="uint8"===h.dtype?new Uint8Array(v):new Uint16Array(v);if("float32"===c)if("uint8"===h.dtype||"uint16"===h.dtype){d=new Float32Array(g.length);for(var m=0;m<g.length;m++){var y=g[m];d[m]=y*h.scale+h.min}}else{if("float16"!==h.dtype)throw new Error("Unsupported quantization type ".concat(h.dtype," ")+"for weight type float32.");void 0===n&&(n=$()),d=n(g)}else{if("int32"!==c)throw new Error("Unsupported dtype in weight '".concat(s,"': ").concat(c));if("uint8"!==h.dtype&&"uint16"!==h.dtype)throw new Error("Unsupported quantization type ".concat(h.dtype," ")+"for weight type int32.");d=new Int32Array(g.length);for(var b=0;b<g.length;b++){var x=g[b];d[b]=Math.round(x*h.scale+h.min)}}i+=f*p}else if("string"===c){var k=(0,M.NA)(u.shape);d=[];for(var w=0;w<k;w++){var _=new Uint32Array(e.slice(i,i+4))[0];i+=4;var S=new Uint8Array(e.slice(i,i+_));d.push(S),i+=_}}else{var A=O[c],E=e.slice(i,i+f*A);if("float32"===c)d=new Float32Array(E);else if("int32"===c)d=new Int32Array(E);else if("bool"===c)d=new Uint8Array(E);else{if("complex64"!==c)throw new Error("Unsupported dtype in weight '".concat(s,"': ").concat(c));d=new Float32Array(E);for(var T=new Float32Array(d.length/2),D=new Float32Array(d.length/2),F=0;F<T.length;F++)T[F]=d[2*F],D[F]=d[2*F+1];var R=I(T,l,"float32"),Z=I(D,l,"float32");a[s]=(0,N.P)(R,Z),R.dispose(),Z.dispose()}i+=f*A}"complex64"!==c&&(a[s]=I(d,l,c))}}catch(B){o.e(B)}finally{o.f()}return a}function z(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))}));var r=new Uint8Array(t),a=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}var L="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function P(e){return L?Buffer.byteLength(e):new Blob([e]).size}function j(e){if(L)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function U(e){if(L){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}function W(e){if(1===e.length)return e[0];var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function V(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function G(e,t){var n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(n.initializerSignature=e.initializerSignature),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}function q(e,t,n){var r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(r.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=t,r.weightData=n}return null!=e.signature&&(r.signature=e.signature),null!=e.userDefinedMetadata&&(r.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(r.modelInitializer=e.modelInitializer),null!=e.initializerSignature&&(r.initializerSignature=e.initializerSignature),r}function H(e,t){return X.apply(this,arguments)}function X(){return X=(0,A.Z)((0,S.Z)().mark((function e(t,n){var r,a,i,o;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==t.weightsManifest){e.next=7;break}return e.next=3,n(t.weightsManifest);case 3:i=e.sent,o=(0,E.Z)(i,2),r=o[0],a=o[1];case 7:return e.abrupt("return",q(t,r,a));case 8:case"end":return e.stop()}}),e)}))),X.apply(this,arguments)}function Y(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:P(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:P(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}function K(e){var t,n=[],r=(0,C.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push.apply(n,(0,T.Z)(a.weights))}}catch(i){r.e(i)}finally{r.f()}return n}function $(){var e=function(){var e=function(e){for(var t=e<<13,n=0;0===(8388608&t);)n-=8388608,t<<=1;return(t&=-8388609)|n+947912704},t=new Uint32Array(2048);t[0]=0;for(var n=1;n<1024;n++)t[n]=e(n);for(var r=1024;r<2048;r++)t[r]=939524096+(r-1024<<13);return t}(),t=function(){var e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(var t=1;t<31;t++)e[t]=t<<23;for(var n=33;n<63;n++)e[n]=2147483648+(n-32<<23);return e}(),n=function(){for(var e=new Uint32Array(64),t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return function(r){for(var a=new ArrayBuffer(4*r.length),i=new Uint32Array(a),o=0;o<r.length;o++){var u=r[o],s=e[n[u>>10]+(1023&u)]+t[u>>10];i[o]=s}return new Float32Array(a)}}var Q=function(){function e(){(0,w.Z)(this,e),this.saveRouters=[],this.loadRouters=[]}return(0,_.Z)(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerSaveRouter",value:function(t){e.getInstance().saveRouters.push(t)}},{key:"registerLoadRouter",value:function(t){e.getInstance().loadRouters.push(t)}},{key:"getSaveHandlers",value:function(t){return e.getHandlers(t,"save")}},{key:"getLoadHandlers",value:function(t,n){return e.getHandlers(t,"load",n)}},{key:"getHandlers",value:function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&a.push(n)})),a}}]),e}(),J=function(e){return Q.registerSaveRouter(e)},ee=function(e){return Q.registerLoadRouter(e)},te=function(e){return Q.getSaveHandlers(e)},ne=function(e,t){return Q.getLoadHandlers(e,t)},re="tensorflowjs",ae="models_store",ie="model_info_store";function oe(){if(!(0,x.OB)().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function ue(e){var t=e.result;t.createObjectStore(ae,{keyPath:"modelPath"}),t.createObjectStore(ie,{keyPath:"modelPath"})}var se=function(){function e(t){if((0,w.Z)(this,e),this.indexedDB=oe(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return(0,_.Z)(e,[{key:"save",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(t){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return e.abrupt("return",this.databaseAction(this.modelPath,t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.databaseAction(this.modelPath));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"databaseAction",value:function(e,t){var n=this;return new Promise((function(e,r){var a=n.indexedDB.open(re,1);a.onupgradeneeded=function(){return ue(a)},a.onsuccess=function(){var i=a.result;if(null==t){var o=i.transaction(ae,"readonly"),u=o.objectStore(ae).get(n.modelPath);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));e(u.result.modelArtifacts)},u.onerror=function(e){return i.close(),r(u.error)},o.oncomplete=function(){return i.close()}}else{var s,c=Y(t),l=i.transaction(ie,"readwrite"),f=l.objectStore(ie),d=f.put({modelPath:n.modelPath,modelArtifactsInfo:c});d.onsuccess=function(){var a=(s=i.transaction(ae,"readwrite")).objectStore(ae).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:c});a.onsuccess=function(){return e({modelArtifactsInfo:c})},a.onerror=function(e){var t=(f=l.objectStore(ie)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(a.error)},t.onerror=function(e){return i.close(),r(a.error)}}},d.onerror=function(e){return i.close(),r(d.error)},l.oncomplete=function(){null==s?i.close():s.oncomplete=function(){return i.close()}}}},a.onerror=function(e){return r(a.error)}}))}}]),e}();se.URL_SCHEME="indexeddb://";var ce=function(e){return(0,x.OB)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(se.URL_SCHEME)?(t=e.slice(se.URL_SCHEME.length),new se(t)):null;var t};Q.registerSaveRouter(ce),Q.registerLoadRouter(ce);var le=function(){function e(){(0,w.Z)(this,e),this.indexedDB=oe()}return(0,_.Z)(e,[{key:"listModels",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(){var t=this;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.indexedDB.open(re,1);r.onupgradeneeded=function(){return ue(r)},r.onsuccess=function(){var t=r.result,a=t.transaction(ie,"readonly"),i=a.objectStore(ie).getAll();i.onsuccess=function(){var t,n={},r=(0,C.Z)(i.result);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a.modelPath]=a.modelArtifactsInfo}}catch(o){r.e(o)}finally{r.f()}e(n)},i.onerror=function(e){return t.close(),n(i.error)},a.oncomplete=function(){return t.close()}},r.onerror=function(e){return n(r.error)}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(t){var n=this;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(r=t).startsWith(se.URL_SCHEME)?r.slice(se.URL_SCHEME.length):r,e.abrupt("return",new Promise((function(e,r){var a=n.indexedDB.open(re,1);a.onupgradeneeded=function(){return ue(a)},a.onsuccess=function(){var n,i=a.result,o=i.transaction(ie,"readwrite"),u=o.objectStore(ie),s=u.get(t);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));var a=u.delete(t),o=function(){var a=(n=i.transaction(ae,"readwrite")).objectStore(ae).delete(t);a.onsuccess=function(){return e(s.result.modelArtifactsInfo)},a.onerror=function(e){return r(s.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),r(s.error)}},s.onerror=function(e){return i.close(),r(s.error)},o.oncomplete=function(){null==n?i.close():n.oncomplete=function(){return i.close()}}},a.onerror=function(e){return r(a.error)}})));case 2:case"end":return e.stop()}var r}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),fe="/",de="tensorflowjs_models",he="info",pe="model_topology",ve="weight_specs",ge="weight_data",me="model_metadata";function ye(e){return{info:[de,e,he].join(fe),topology:[de,e,pe].join(fe),weightSpecs:[de,e,ve].join(fe),weightData:[de,e,ge].join(fe),modelMetadata:[de,e,me].join(fe)}}function be(e){for(var t=0,n=Object.values(e);t<n.length;t++){var r=n[t];window.localStorage.removeItem(r)}}function xe(e){var t=e.split(fe);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(fe)}var ke=function(){function e(t){if((0,w.Z)(this,e),!(0,x.OB)().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=ye(this.modelPath)}return(0,_.Z)(e,[{key:"save",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(t){var n,r,a,i;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=4;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 4:return n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=Y(t),e.prev=7,this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,j(t.weightData)),i={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:null!=t.signature?t.signature:void 0,userDefinedMetadata:null!=t.userDefinedMetadata?t.userDefinedMetadata:void 0,modelInitializer:null!=t.modelInitializer?t.modelInitializer:void 0,initializerSignature:null!=t.initializerSignature?t.initializerSignature:void 0,trainingConfig:null!=t.trainingConfig?t.trainingConfig:void 0},this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),e.abrupt("return",{modelArtifactsInfo:a});case 17:throw e.prev=17,e.t0=e.catch(7),be(this.keys),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."));case 21:case"end":return e.stop()}}),e,this,[[7,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(){var t,n,r,a,i,o,u;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=JSON.parse(this.LS.getItem(this.keys.info)))){e.next=3;break}throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));case 3:if("JSON"===t.modelTopologyType){e.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(n={},null!=(r=JSON.parse(this.LS.getItem(this.keys.topology)))){e.next=9;break}throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");case 9:if(n.modelTopology=r,null!=(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))){e.next=13;break}throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");case 13:if(n.weightSpecs=a,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,null!=o.signature&&(n.signature=o.signature),null!=o.userDefinedMetadata&&(n.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(n.modelInitializer=o.modelInitializer),null!=o.initializerSignature&&(n.initializerSignature=o.initializerSignature),null!=o.trainingConfig&&(n.trainingConfig=o.trainingConfig)),null!=(u=this.LS.getItem(this.keys.weightData))){e.next=19;break}throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));case 19:return n.weightData=U(u),e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();ke.URL_SCHEME="localstorage://";var we=function(e){return(0,x.OB)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(ke.URL_SCHEME)?(t=e.slice(ke.URL_SCHEME.length),new ke(t)):null;var t};Q.registerSaveRouter(we),Q.registerLoadRouter(we);var _e=function(){function e(){(0,w.Z)(this,e),(0,M.hu)((0,x.OB)().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),(0,M.hu)("undefined"===typeof window||"undefined"!==typeof window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return(0,_.Z)(e,[{key:"listModels",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(){var t,n,r,a,i,o;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={},n=de+fe,r=fe+he,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(n)&&i.endsWith(r)&&(o=xe(i),t[o]=JSON.parse(this.LS.getItem(i)));return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(t){var n,r;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(a=t).startsWith(ke.URL_SCHEME)?a.slice(ke.URL_SCHEME.length):a,n=ye(t),null!=this.LS.getItem(n.info)){e.next=4;break}throw new Error("Cannot find model at path '".concat(t,"'"));case 4:return r=JSON.parse(this.LS.getItem(n.info)),be(n),e.abrupt("return",r);case 7:case"end":return e.stop()}var a}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Ce="://",Se=function(){function e(){(0,w.Z)(this,e),this.managers={}}return(0,_.Z)(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerManager",value:function(t,n){(0,M.hu)(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(Ce)&&(t=t.slice(0,t.indexOf(Ce))),(0,M.hu)(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();(0,M.hu)(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '".concat(t,"'.")})),r.managers[t]=n}},{key:"getManager",value:function(t){var n=e.getInstance().managers[t];if(null==n)throw new Error("Cannot find model manager for scheme '".concat(t,"'"));return n}},{key:"getSchemes",value:function(){return Object.keys(e.getInstance().managers)}}]),e}();function Ae(e){if(-1===e.indexOf(Ce))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(Se.getSchemes().join(",")));return{scheme:e.split(Ce)[0],path:e.split(Ce)[1]}}function Ee(e,t){return Te.apply(this,arguments)}function Te(){return Te=(0,A.Z)((0,S.Z)().mark((function e(t,n){var r,a,i,o,u,s,c,l,f,d,h=arguments;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=h.length>2&&void 0!==h[2]&&h[2],(0,M.hu)(t!==n,(function(){return"Old path and new path are the same: '".concat(t,"'")})),a=Q.getLoadHandlers(t),(0,M.hu)(a.length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(t,".")})),(0,M.hu)(a.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(t,".")})),i=a[0],o=Q.getSaveHandlers(n),(0,M.hu)(o.length>0,(function(){return"Copying failed because no save handler is found for destination "+"URL ".concat(n,".")})),(0,M.hu)(o.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(n,".")})),u=o[0],s=Ae(t).scheme,c=Ae(t).path,l=s===Ae(t).scheme,e.next=15,i.load();case 15:if(f=e.sent,!r||!l){e.next=19;break}return e.next=19,Se.getManager(s).removeModel(c);case 19:return e.next=21,u.save(f);case 21:if(d=e.sent,!r||l){e.next=25;break}return e.next=25,Se.getManager(s).removeModel(c);case 25:return e.abrupt("return",d.modelArtifactsInfo);case 26:case"end":return e.stop()}}),e)}))),Te.apply(this,arguments)}function Ne(){return De.apply(this,arguments)}function De(){return(De=(0,A.Z)((0,S.Z)().mark((function e(){var t,n,r,a,i,o,u;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Se.getSchemes(),n={},r=(0,C.Z)(t),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=13;break}return i=a.value,e.next=9,Se.getManager(i).listModels();case 9:for(u in o=e.sent)n[i+Ce+u]=o[u];case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,null,[[3,15,18,21]])})))).apply(this,arguments)}function Fe(e){return Ie.apply(this,arguments)}function Ie(){return(Ie=(0,A.Z)((0,S.Z)().mark((function e(t){var n,r;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Ae(t),r=Se.getManager(n.scheme),e.abrupt("return",r.removeModel(n.path));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Me(e,t){return Oe.apply(this,arguments)}function Oe(){return(Oe=(0,A.Z)((0,S.Z)().mark((function e(t,n){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!1,e.abrupt("return",Ee(t,n,false));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Re(e,t){return Ze.apply(this,arguments)}function Ze(){return(Ze=(0,A.Z)((0,S.Z)().mark((function e(t,n){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!0,e.abrupt("return",Ee(t,n,true));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Be=function(){function e(){(0,w.Z)(this,e),this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}return(0,_.Z)(e,[{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return new TextDecoder(t).decode(e)}},{key:"setTimeoutCustom",value:function(e,t){var n=this;"undefined"!==typeof window&&(0,x.OB)().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout((function(){window.postMessage({name:n.messageName,index:n.functionRefs.length-1},"*")}),t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(function(e){e.source===window&&e.data.name===n.messageName&&(e.stopPropagation(),(0,n.functionRefs[e.data.index])(),n.handledMessageCount++,n.handledMessageCount===n.functionRefs.length&&(n.functionRefs=[],n.handledMessageCount=0))}),!0))):setTimeout(e,t)}},{key:"isTypedArray",value:function(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}}]),e}();if((0,x.OB)().get("IS_BROWSER")){(0,x.OB)().setPlatform("browser",new Be);try{Se.registerManager(ke.URL_SCHEME,new _e)}catch(zs){}try{Se.registerManager(se.URL_SCHEME,new le)}catch(zs){}}var ze,Le=function(){return n(5410)};var Pe=function(){function e(){(0,w.Z)(this,e),this.util=n(8628),this.textEncoder=new this.util.TextEncoder}return(0,_.Z)(e,[{key:"fetch",value:function(e,t){return null!=(0,x.OB)().global.fetch?(0,x.OB)().global.fetch(e,t):(null==ze&&(ze=Le()),ze(e,t))}},{key:"now",value:function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}},{key:"isTypedArray",value:function(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}]),e}();(0,x.OB)().get("IS_NODE")&&!(0,x.OB)().get("IS_BROWSER")&&(0,x.OB)().setPlatform("node",new Pe);var je=n(4376);function Ue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",M.Mu(e),new je.YD(e,t,n)}var We=n(9118),Ve=n(672);function Ge(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}(0,g.wv)();var qe={buffer:Ue,cast:We.p,clone:Ve.d,print:Ge};(0,je.Vp)(qe);var He=n(136),Xe=n(7277),Ye=n(5875),Ke=n(3312),$e=n(5750),Qe=n(651),Je=n(6902),et=n(7391),tt=n(7293),nt=n(6450),rt=n(7067),at=function(){function e(){(0,w.Z)(this,e)}return(0,_.Z)(e,[{key:"getClassName",value:function(){return this.constructor.className}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),e}(),it=function(){function e(){(0,w.Z)(this,e),this.classNameMap={}}return(0,_.Z)(e,null,[{key:"getMap",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"register",value:function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]}}]),e}();function ot(e){(0,M.hu)(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),(0,M.hu)("string"===typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),(0,M.hu)(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),it.register(e)}var ut=function(e){(0,He.Z)(n,e);var t=(0,Xe.Z)(n);function n(){return(0,w.Z)(this,n),t.apply(this,arguments)}return(0,_.Z)(n,[{key:"minimize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.computeGradients(e,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(o)}else this.applyGradients(i);return(0,Ye.B9)(i),t?a:(a.dispose(),null)}},{key:"iterations",get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}},{key:"incrementIterations",value:function(){this.iterations_=this.iterations+1}},{key:"computeGradients",value:function(e,t){return(0,nt.pn)(e,t)}},{key:"dispose",value:function(){null!=this.iterations_&&(0,Ye.B9)(this.iterations_)}},{key:"saveIterations",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==this.iterations_&&(this.iterations_=0),e.abrupt("return",{name:"iter",tensor:(0,rt.i)(this.iterations_,"int32")});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getWeights",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for this optimizer yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(t){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"extractIterations",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(t){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t[0].tensor.data();case 2:return this.iterations_=e.sent[0],e.abrupt("return",t.slice(1));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(at);Object.defineProperty(ut,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var st=function(e){(0,He.Z)(n,e);var t=(0,Xe.Z)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(0,w.Z)(this,n),(a=t.call(this)).learningRate=e,a.rho=r,a.epsilon=i,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==i&&(a.epsilon=g.BV.backend.epsilon()),a}return(0,_.Z)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=g.BV.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:"".concat(n,"/accum_grad"),variable:(0,Ye.lu)((function(){return(0,tt.P)(a).variable(false)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:"".concat(n,"/accum_var"),variable:(0,Ye.lu)((function(){return(0,tt.P)(a).variable(false)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable,u=t.accumulatedUpdates[r].variable;(0,Ye.lu)((function(){var e=(0,Ke.I)((0,Qe.d)(o,t.rho),(0,Qe.d)((0,et.h)(i),1-t.rho)),n=(0,Qe.d)((0,$e.h)((0,Je._)((0,Ke.I)(u,t.epsilon)),(0,Je._)((0,Ke.I)(o,t.epsilon))),i),r=(0,Ke.I)((0,Qe.d)(u,t.rho),(0,Qe.d)((0,et.h)(n),1-t.rho));o.assign(e),u.assign(r);var s=(0,Ke.I)((0,Qe.d)(n,-t.learningRate),a);a.assign(s)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedUpdates&&((0,Ye.B9)(this.accumulatedGrads.map((function(e){return e.variable}))),(0,Ye.B9)(this.accumulatedUpdates.map((function(e){return e.variable}))))}},{key:"getWeights",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(){var t;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat((0,T.Z)(this.accumulatedGrads),(0,T.Z)(this.accumulatedUpdates)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(t){var n;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=t.length/2,!1,this.accumulatedGrads=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedUpdates=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}}],[{key:"className",get:function(){return"Adadelta"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}]),n}(ut),ct=n(8582),lt=function(e){(0,He.Z)(n,e);var t=(0,Xe.Z)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return(0,w.Z)(this,n),(r=t.call(this)).learningRate=e,r.initialAccumulatorValue=a,r.accumulatedGrads=[],r}return(0,_.Z)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=g.BV.registeredVariables[n];if(null==t.accumulatedGrads[r]){t.accumulatedGrads[r]={originalName:"".concat(n,"/accumulator"),variable:(0,Ye.lu)((function(){return(0,ct.h)(a.shape,t.initialAccumulatorValue).variable(false)}))}}var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable;(0,Ye.lu)((function(){var e=(0,Ke.I)(o,(0,et.h)(i));o.assign(e);var n=(0,Ke.I)((0,Qe.d)((0,$e.h)(i,(0,Je._)((0,Ke.I)(e,g.BV.backend.epsilon()))),-t.learningRate),a);a.assign(n)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedGrads&&(0,Ye.B9)(this.accumulatedGrads.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(t){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulatedGrads=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}}],[{key:"className",get:function(){return"Adagrad"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}]),n}(ut),ft=n(4334),dt=n(4774),ht=function(e){(0,He.Z)(n,e);var t=(0,Xe.Z)(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return(0,w.Z)(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],(0,Ye.lu)((function(){i.accBeta1=(0,rt.i)(r).variable(),i.accBeta2=(0,rt.i)(a).variable()})),null==o&&(i.epsilon=g.BV.backend.epsilon()),i}return(0,_.Z)(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);(0,Ye.lu)((function(){var r=(0,dt.l)(1,t.accBeta1),a=(0,dt.l)(1,t.accBeta2);n.forEach((function(n,i){var o=g.BV.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:(0,Ye.lu)((function(){return(0,tt.P)(o).variable(false)}))}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:"".concat(n,"/v"),variable:(0,Ye.lu)((function(){return(0,tt.P)(o).variable(false)}))});var u=Array.isArray(e)?e[i].tensor:e[n];if(null!=u){var s=t.accumulatedFirstMoment[i].variable,c=t.accumulatedSecondMoment[i].variable,l=(0,Ke.I)((0,Qe.d)(s,t.beta1),(0,Qe.d)(u,1-t.beta1)),f=(0,Ke.I)((0,Qe.d)(c,t.beta2),(0,Qe.d)((0,et.h)(u),1-t.beta2)),d=(0,$e.h)(l,r),h=(0,$e.h)(f,a);s.assign(l),c.assign(f);var p=(0,Ke.I)((0,Qe.d)((0,$e.h)(d,(0,Ke.I)((0,Je._)(h),t.epsilon)),-t.learningRate),o);o.assign(p)}})),t.accBeta1.assign((0,Qe.d)(t.accBeta1,t.beta1)),t.accBeta2.assign((0,Qe.d)(t.accBeta2,t.beta2))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&(0,Ye.B9)(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&(0,Ye.B9)(this.accumulatedSecondMoment.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(){var t;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat((0,T.Z)(this.accumulatedFirstMoment),(0,T.Z)(this.accumulatedSecondMoment)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(t){var n,r=this;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,(0,Ye.lu)((function(){r.accBeta1.assign((0,ft.s)(r.beta1,r.iterations_+1)),r.accBeta2.assign((0,ft.s)(r.beta2,r.iterations_+1))})),n=t.length/2,!1,this.accumulatedFirstMoment=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),this.accumulatedSecondMoment=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}}],[{key:"className",get:function(){return"Adam"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}]),n}(ut),pt=n(7613),vt=n(705),gt=function(e){(0,He.Z)(n,e);var t=(0,Xe.Z)(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return(0,w.Z)(this,n),(i=t.call(this)).learningRate=e,i.beta1=r,i.beta2=a,i.epsilon=o,i.decay=u,i.accumulatedFirstMoment=[],i.accumulatedWeightedInfNorm=[],(0,Ye.lu)((function(){i.iteration=(0,rt.i)(0).variable(),i.accBeta1=(0,rt.i)(r).variable()})),null==o&&(i.epsilon=g.BV.backend.epsilon()),i}return(0,_.Z)(n,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);(0,Ye.lu)((function(){var r=(0,dt.l)(1,t.accBeta1),a=(0,$e.h)(-t.learningRate,(0,Ke.I)((0,Qe.d)(t.iteration,t.decay),1));n.forEach((function(n,i){var o=g.BV.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:(0,tt.P)(o).variable(false)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:"".concat(n,"/v"),variable:(0,tt.P)(o).variable(false)});var u=Array.isArray(e)?e[i].tensor:e[n];if(null!=u){var s=t.accumulatedFirstMoment[i].variable,c=t.accumulatedWeightedInfNorm[i].variable,l=(0,Ke.I)((0,Qe.d)(s,t.beta1),(0,Qe.d)(u,1-t.beta1)),f=(0,Qe.d)(c,t.beta2),d=(0,pt.W)(u),h=(0,vt.g)(f,d);s.assign(l),c.assign(h);var p=(0,Ke.I)((0,Qe.d)((0,$e.h)(a,r),(0,$e.h)(l,(0,Ke.I)(h,t.epsilon))),o);o.assign(p)}})),t.iteration.assign((0,Ke.I)(t.iteration,1)),t.accBeta1.assign((0,Qe.d)(t.accBeta1,t.beta1))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&(0,Ye.B9)(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&(0,Ye.B9)(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(t){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}}],[{key:"className",get:function(){return"Adamax"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}]),n}(ut),mt=function(e){(0,He.Z)(n,e);var t=(0,Xe.Z)(n);function n(e){var r;return(0,w.Z)(this,n),(r=t.call(this)).learningRate=e,r.setLearningRate(e),r}return(0,_.Z)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var i=g.BV.registeredVariables[n];(0,Ye.lu)((function(){var e=(0,Ke.I)((0,Qe.d)(t.c,a),i);i.assign(e)}))}})),this.incrementIterations()}},{key:"setLearningRate",value:function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=(0,Ye.Cn)((0,rt.i)(-e))}},{key:"dispose",value:function(){this.c.dispose()}},{key:"getWeights",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0]);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(t){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:if(0===(t=e.sent).length){e.next=5;break}throw new Error("SGD optimizer does not have settable weights.");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate}}}],[{key:"className",get:function(){return"SGD"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate)}}]),n}(ut),yt=function(e){(0,He.Z)(n,e);var t=(0,Xe.Z)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,w.Z)(this,n),(a=t.call(this,e)).learningRate=e,a.momentum=r,a.useNesterov=i,a.accumulations=[],a.m=(0,rt.i)(a.momentum),a}return(0,_.Z)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=g.BV.registeredVariables[n];if(null==t.accumulations[r]){t.accumulations[r]={originalName:"".concat(n,"/momentum"),variable:(0,Ye.lu)((function(){return(0,tt.P)(a).variable(false)}))}}var i=t.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];null!=o&&(0,Ye.lu)((function(){var e,n=(0,Ke.I)((0,Qe.d)(t.m,i),o);e=t.useNesterov?(0,Ke.I)((0,Qe.d)(t.c,(0,Ke.I)(o,(0,Qe.d)(n,t.m))),a):(0,Ke.I)((0,Qe.d)(t.c,n),a),i.assign(n),a.assign(e)}))})),this.incrementIterations()}},{key:"dispose",value:function(){this.m.dispose(),null!=this.accumulations&&(0,Ye.B9)(this.accumulations.map((function(e){return e.variable})))}},{key:"setMomentum",value:function(e){this.momentum=e}},{key:"getWeights",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(t){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,!1,this.accumulations=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}}],[{key:"className",get:function(){return"Momentum"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}]),n}(mt),bt=function(e){(0,He.Z)(n,e);var t=(0,Xe.Z)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if((0,w.Z)(this,n),(r=t.call(this)).learningRate=e,r.decay=a,r.momentum=i,r.epsilon=o,r.accumulatedMeanSquares=[],r.accumulatedMoments=[],r.accumulatedMeanGrads=[],r.centered=u,null==o&&(r.epsilon=g.BV.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return r}return(0,_.Z)(n,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=g.BV.registeredVariables[n],i=!1;null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:"".concat(n,"/rms"),variable:(0,Ye.lu)((function(){return(0,tt.P)(a).variable(i)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:"".concat(n,"/momentum"),variable:(0,Ye.lu)((function(){return(0,tt.P)(a).variable(i)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:"".concat(n,"/mg"),variable:(0,Ye.lu)((function(){return(0,tt.P)(a).variable(i)}))});var o=Array.isArray(e)?e[r].tensor:e[n];if(null!=o){var u=t.accumulatedMeanSquares[r].variable,s=t.accumulatedMoments[r].variable;(0,Ye.lu)((function(){var e=(0,Ke.I)((0,Qe.d)(u,t.decay),(0,Qe.d)((0,et.h)(o),1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,i=(0,Ke.I)((0,Qe.d)(n,t.decay),(0,Qe.d)(o,1-t.decay)),c=(0,$e.h)((0,Qe.d)(o,t.learningRate),(0,Je._)((0,dt.l)(e,(0,Ke.I)((0,et.h)(i),t.epsilon)))),l=(0,Ke.I)((0,Qe.d)(s,t.momentum),c);u.assign(e),n.assign(i),s.assign(l);var f=(0,dt.l)(a,l);a.assign(f)}else{var d=(0,Ke.I)((0,Qe.d)(u,t.decay),(0,Qe.d)((0,et.h)(o),1-t.decay)),h=(0,Ke.I)((0,Qe.d)(s,t.momentum),(0,$e.h)((0,Qe.d)(o,t.learningRate),(0,Je._)((0,Ke.I)(d,t.epsilon))));u.assign(d),s.assign(h);var p=(0,dt.l)(a,h);a.assign(p)}}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedMeanSquares&&(0,Ye.B9)(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&(0,Ye.B9)(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&(0,Ye.B9)(this.accumulatedMoments.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(){var t;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat((0,T.Z)(this.accumulatedMeanSquares),(0,T.Z)(this.accumulatedMoments)),this.centered&&t.push.apply(t,(0,T.Z)(this.accumulatedMeanGrads)),e.next=4,this.saveIterations();case 4:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWeights",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(t){var n,r;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=this.centered?t.length/3:t.length/2,r=!1,this.accumulatedMeanSquares=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.accumulatedMoments=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*n,3*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(r)}})));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConfig",value:function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}}],[{key:"className",get:function(){return"RMSProp"}},{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}]),n}(ut),xt=[st,lt,ht,gt,yt,bt,mt];function kt(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var wt=function(){function e(t){if((0,w.Z)(this,e),!(0,x.OB)().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelJsonFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return(0,_.Z)(e,[{key:"save",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(t){var n,r,a,i,o,u;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!==typeof document){e.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer)){e.next=7;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 7:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a=G(t,r),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(o=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor).download=this.modelJsonFileName,o.href=i,e.next=15,kt((function(){return o.dispatchEvent(new MouseEvent("click"))}));case 15:if(null==t.weightData){e.next=21;break}return(u=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,u.href=n,e.next=21,kt((function(){return u.dispatchEvent(new MouseEvent("click"))}));case 21:return e.abrupt("return",{modelArtifactsInfo:Y(t)});case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();wt.URL_SCHEME="downloads://";var _t=function(){function e(t){if((0,w.Z)(this,e),null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.jsonFile=t[0],this.weightsFiles=t.slice(1)}return(0,_.Z)(e,[{key:"load",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(){var t=this;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=new FileReader;r.onload=function(r){var a=JSON.parse(r.target.result),i=a.modelTopology;if(null!=i)if(null!=a.weightsManifest)if(0!==t.weightsFiles.length){var o=H(a,(function(e){return t.loadWeights(e)}));e(o)}else e({modelTopology:i});else n(new Error("weightManifest field is missing from file ".concat(t.jsonFile.name)));else n(new Error("modelTopology field is missing from file ".concat(t.jsonFile.name)))},r.onerror=function(e){return n("Failed to read model topology and weights manifest JSON "+"from file '".concat(t.jsonFile.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},r.readAsText(t.jsonFile)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(e){var t,n=this,r=[],a=[],i=(0,C.Z)(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;r.push.apply(r,(0,T.Z)(o.weights)),a.push.apply(a,(0,T.Z)(o.paths))}}catch(zs){i.e(zs)}finally{i.f()}var u=this.checkManifestAndWeightFiles(e),s=a.map((function(e){return n.loadWeightsFile(e,u[e])}));return Promise.all(s).then((function(e){return[r,W(e)]}))}},{key:"loadWeightsFile",value:function(e,t){return new Promise((function(n,r){var a=new FileReader;a.onload=function(e){var t=e.target.result;n(t)},a.onerror=function(t){return r("Failed to weights data from file of path '".concat(e,"'."))},a.readAsArrayBuffer(t)}))}},{key:"checkManifestAndWeightFiles",value:function(e){var t,n=this,r=[],a=this.weightsFiles.map((function(e){return V(e.name)})),i={},o=(0,C.Z)(e);try{for(o.s();!(t=o.n()).done;){t.value.paths.forEach((function(e){var t=V(e);if(-1!==r.indexOf(t))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(t,"'"));if(r.push(t),-1===a.indexOf(t))throw new Error("Weight file with basename '".concat(t,"' is not provided."));i[e]=n.weightsFiles[a.indexOf(t)]}))}}catch(zs){o.e(zs)}finally{o.f()}if(r.length!==this.weightsFiles.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(r.length,") and the number of weight files provided ")+"(".concat(this.weightsFiles.length,")."));return i}}]),e}();function Ct(e){return new _t(e)}function St(e,t,n,r){!function(e){(0,M.hu)(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){(0,M.hu)(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e)})),(0,M.hu)(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t)})),(0,M.hu)(t>=e,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t)}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map((function(i){return i.then((function(i){var o=n+ ++a/e.length*(r-n);return t(o),i})),i})))}function At(e,t){return Et.apply(this,arguments)}function Et(){return(Et=(0,A.Z)((0,S.Z)().mark((function e(t,n){var r,a,i,o,u,s,c,l,f;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&(n={}),r=null==n.fetchFunc?(0,x.OB)().platform.fetch:n.fetchFunc,a=t.map((function(e){return r(e,n.requestInit,{isBinary:!0})})),i=0,o=.5,null!=n.onProgress){e.next=11;break}return e.next=8,Promise.all(a);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,St(a,n.onProgress,i,o);case 13:e.t0=e.sent;case 14:if(u=e.t0,s=u.map((function(e){return e.arrayBuffer()})),c=.5,l=1,null!=n.onProgress){e.next=24;break}return e.next=21,Promise.all(s);case 21:e.t1=e.sent,e.next=27;break;case 24:return e.next=26,St(s,n.onProgress,c,l);case 26:e.t1=e.sent;case 27:return f=e.t1,e.abrupt("return",f);case 29:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Tt(e){return Nt.apply(this,arguments)}function Nt(){return Nt=(0,A.Z)((0,S.Z)().mark((function e(t){var n,r,a,i,o=arguments;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",r=o.length>2?o[2]:void 0,a=o.length>3?o[3]:void 0,i=Dt((function(e){return At(e,{requestInit:a})})),e.abrupt("return",i(t,n,r));case 6:case"end":return e.stop()}}),e)}))),Nt.apply(this,arguments)}function Dt(e){return function(){var t=(0,A.Z)((0,S.Z)().mark((function t(n){var r,a,i,o,u,s,c,l,f,d,h,p,v=arguments;return(0,S.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=v.length>1&&void 0!==v[1]?v[1]:"",a=v.length>2?v[2]:void 0,i=n.map((function(){return!1})),o={},u=null!=a?a.map((function(){return!1})):[],s=[],n.forEach((function(e,t){var n=0;e.weights.forEach((function(e){var r="quantization"in e?e.quantization.dtype:e.dtype,c=O[r]*M.NA(e.shape),l=function(){i[t]=!0,null==o[t]&&(o[t]=[]),o[t].push({manifestEntry:e,groupOffset:n,sizeBytes:c})};null!=a?a.forEach((function(t,n){t===e.name&&(l(),u[n]=!0)})):l(),s.push(e.name),n+=c}))})),u.every((function(e){return e}))){t.next=10;break}throw c=a.filter((function(e,t){return!u[t]})),new Error("Could not find weights in manifest with names: "+"".concat(c.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(s.join(", "),"."));case 10:return l=i.reduce((function(e,t,n){return t&&e.push(n),e}),[]),f=[],l.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;f.push(t)}))})),t.next=15,e(f);case 15:return d=t.sent,h={},p=0,l.forEach((function(e){for(var t=n[e].paths.length,r=0,a=0;a<t;a++)r+=d[p+a].byteLength;for(var i=new ArrayBuffer(r),u=new Uint8Array(i),s=0,c=0;c<t;c++){var l=new Uint8Array(d[p+c]);u.set(l,s),s+=l.byteLength}o[e].forEach((function(e){var t=B(i.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)h[n]=t[n]})),p+=t})),t.abrupt("return",h);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}Q.registerSaveRouter((function(e){return(0,x.OB)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(wt.URL_SCHEME)?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new wt(e)}(e.slice(wt.URL_SCHEME.length)):null}));var Ft=function(){function e(t,n){if((0,w.Z)(this,e),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,null!=n.fetchFunc?((0,M.hu)("function"===typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=(0,x.OB)().platform.fetch,(0,M.hu)(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&(0,M.hu)(2===t.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,").")})),this.path=t,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return(0,_.Z)(e,[{key:"save",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(t){var n,r,a,i;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a=G(t,r),n.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),null!=t.weightData&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),e.next=10,this.fetch(this.path,n);case 10:if(!(i=e.sent).ok){e.next=15;break}return e.abrupt("return",{modelArtifactsInfo:Y(t),responses:[i]});case 15:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(i.status,"."));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(){var t,n,r,a,i,o=this;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(this.path,this.requestInit);case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");case 5:return e.prev=5,e.next=8,t.json();case 8:n=e.sent,e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(5),r="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 16:if(a=n.modelTopology,i=n.weightsManifest,null!=a||null!=i){e.next=20;break}throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");case 20:return e.abrupt("return",H(n,(function(e){return o.loadWeights(e)})));case 21:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(){var e=(0,A.Z)((0,S.Z)().mark((function e(t){var n,r,a,i,o,u,s,c,l,f,d,h,p,v,g,m;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Array.isArray(this.path)?this.path[1]:this.path,r=It(n),a=(0,E.Z)(r,2),i=a[0],o=a[1],u=this.weightPathPrefix||i,s=K(t),c=[],l=[],f=(0,C.Z)(t);try{for(f.s();!(d=f.n()).done;){h=d.value,p=(0,C.Z)(h.paths);try{for(p.s();!(v=p.n()).done;)g=v.value,null!=this.weightUrlConverter?l.push(this.weightUrlConverter(g)):c.push(u+g+o)}catch(zs){p.e(zs)}finally{p.f()}}}catch(zs){f.e(zs)}finally{f.f()}if(!this.weightUrlConverter){e.next=17;break}return e.t0=c.push,e.t1=c,e.t2=T.Z,e.next=14,Promise.all(l);case 14:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4);case 17:return e.next=19,At(c,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});case 19:return m=e.sent,e.abrupt("return",[s,W(m)]);case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function It(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}function Mt(e){return null!=e.match(Ft.URL_SCHEME_REGEX)}Ft.URL_SCHEME_REGEX=/^https?:\/\//;var Ot=function(e,t){if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;return(Array.isArray(e)?e.every((function(e){return Mt(e)})):Mt(e))?Rt(e,t):null};function Rt(e,t){return new Ft(e,t)}function Zt(e,t){return Rt(e,t)}Q.registerSaveRouter(Ot),Q.registerLoadRouter(Ot);var Bt=function(){function e(t){(0,w.Z)(this,e),this.modelArtifacts=t}return(0,_.Z)(e,[{key:"load",value:function(){return this.modelArtifacts}}]),e}(),zt=function(){function e(t){(0,w.Z)(this,e),this.saveHandler=t}return(0,_.Z)(e,[{key:"save",value:function(e){return this.saveHandler(e)}}]),e}(),Lt=(0,_.Z)((function e(t){(0,w.Z)(this,e),t.load&&(this.load=function(){return Promise.resolve(t.load())}),t.save&&(this.save=function(e){return Promise.resolve(t.save(e))})}));function Pt(e,t,n,r){var a=arguments;return new Lt(jt.apply(void 0,(0,T.Z)(a)))}function jt(e,t,n,r){if(1===arguments.length){var a=null!=e.modelTopology||null!=e.weightSpecs;return a?new Bt(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Bt({modelTopology:e}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Bt({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r})}function Ut(e){return new zt(e)}function Wt(e){return new zt(e)}var Vt=n(7221),Gt=n(4326),qt=n(8640),Ht=n(1240);var Xt,Yt=(0,qt.op)({confusionMatrix_:function(e,t,n){var r=(0,D._1)(e,"labels","confusionMatrix"),a=(0,D._1)(t,"predictions","confusionMatrix");M.hu(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, "+"but got ".concat(n)})),M.hu(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got ".concat(r.rank)})),M.hu(1===a.rank,(function(){return"Expected the rank of predictions to be 1, "+"but got ".concat(a.rank)})),M.hu(r.shape[0]===a.shape[0],(function(){return"Mismatch in the number of examples: "+"".concat(r.shape[0]," vs. ").concat(a.shape[0],". ")+"Labels and predictions should have the same number of elements."})),M.hu(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+"".concat(n)}));var i=(0,Gt.l)((0,We.p)(r,"int32"),n),o=(0,Gt.l)((0,We.p)(a,"int32"),n),u=(0,Ht.p)(i),s=(0,Vt.O)(u,o);return(0,We.p)(s,"int32")}}),Kt=n(5774),$t=n(2145),Qt=n(8864);function Jt(e,t,n){if((0,M.Cq)(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var r=(0,D.C)(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return(0,F.H)(e,t,r,n)}function en(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,i=!1,o=!1,u=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else if(null!=e.getContext)o=!0;else{if(!("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(e.constructor.name));u=!0}var s=(0,Qt.pI)($t.eBW,g.BV.backendName);if(null!=s){var c={pixels:e},l={numChannels:t};return g.BV.runKernel($t.eBW,c,l)}var f,d,h=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],p=(0,E.Z)(h,2),v=p[0],m=p[1];if(o)f=e.getContext("2d").getImageData(0,0,v,m).data;else if(r||n)f=e.data;else if(i||a||u){if(null==Xt)if("undefined"===typeof document){if("undefined"===typeof OffscreenCanvas||"undefined"===typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");Xt=new OffscreenCanvas(1,1).getContext("2d")}else Xt=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Xt.canvas.width=v,Xt.canvas.height=m,Xt.drawImage(e,0,0,v,m),f=Xt.getImageData(0,0,v,m).data}if(4===t)d=new Int32Array(f);else{var y=v*m;d=new Int32Array(y*t);for(var b=0;b<y;b++)for(var x=0;x<t;++x)d[b*t+x]=f[4*b+x]}var k=[m,v,t];return Jt(d,k,"int32")}function tn(e){return"undefined"!==typeof window&&"undefined"!==typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(e instanceof ImageBitmap)&&function(e){return null!=e&&0!==e.width&&0!==e.height}(e)&&!function(e){return null!=e&&e.data instanceof Uint8Array}(e)}function nn(e){return rn.apply(this,arguments)}function rn(){return rn=(0,A.Z)((0,S.Z)().mark((function e(t){var n,r,a,i=arguments;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:3,r=null,!(0,x.OB)().getBool("WRAP_TO_IMAGEBITMAP")||!tn(t)){e.next=15;break}return e.prev=3,e.next=6,createImageBitmap(t,{premultiplyAlpha:"none"});case 6:a=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),a=null;case 12:r=null!=a&&a.width===t.width&&a.height===t.height?a:t,e.next=16;break;case 15:r=t;case 16:return e.abrupt("return",en(r,n));case 17:case"end":return e.stop()}}),e,null,[[3,9]])}))),rn.apply(this,arguments)}function an(e,t){return on.apply(this,arguments)}function on(){return(on=(0,A.Z)((0,S.Z)().mark((function e(t,n){var r,a,i,o,u,s,c,l,f,d,h,p,v,g,m,y,b;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(0,D._1)(t,"img","toPixels"),t instanceof je.es||(a=r,r=(0,We.p)(a,"int32"),a.dispose()),2===r.rank||3===r.rank){e.next=4;break}throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(r.rank,"."));case 4:if(i=r.shape.slice(0,2),o=(0,E.Z)(i,2),u=o[0],s=o[1],!((c=2===r.rank?1:r.shape[2])>4||2===c)){e.next=8;break}throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(c));case 8:if("float32"===r.dtype||"int32"===r.dtype){e.next=10;break}throw new Error("Unsupported type for toPixels: ".concat(r.dtype,".")+" Please use float32 or int32 tensors.");case 10:return e.next=12,r.data();case 12:l=e.sent,f="float32"===r.dtype?255:1,d=new Uint8ClampedArray(s*u*4),h=0;case 16:if(!(h<u*s)){e.next=41;break}p=[0,0,0,255],v=0;case 19:if(!(v<c)){e.next=33;break}if(g=l[h*c+v],"float32"!==r.dtype){e.next=26;break}if(!(g<0||g>1)){e.next=24;break}throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(g,"."));case 24:e.next=29;break;case 26:if("int32"!==r.dtype){e.next=29;break}if(!(g<0||g>255)){e.next=29;break}throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(g,"."));case 29:1===c?(p[0]=g*f,p[1]=g*f,p[2]=g*f):p[v]=g*f;case 30:v++,e.next=19;break;case 33:d[(m=4*h)+0]=Math.round(p[0]),d[m+1]=Math.round(p[1]),d[m+2]=Math.round(p[2]),d[m+3]=Math.round(p[3]);case 38:++h,e.next=16;break;case 41:return null!=n&&(n.width=s,n.height=u,y=n.getContext("2d"),b=new ImageData(d,s,u),y.putImageData(b,0,0)),r!==t&&r.dispose(),e.abrupt("return",d);case 44:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var un=(0,qt.op)({fromPixels_:en});function sn(e,t){var n=e.shape.length,r=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[r-1]," vs. ").concat(n));if(0===(0,M.NA)(e.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));for(var a=t.shape,i=a[a.length-1],o=1,u=0;u<a.length-1;++u)o*=a[u];var s=e.shape,c=a.slice();c.pop();for(var l=1,f=i;f<n;++f)l*=s[f],c.push(s[f]);var d=[].concat((0,T.Z)((0,M.e3)(e.shape).map((function(e){return e/l}))),[1]).slice(0,i);return[c,o,l,d]}function cn(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(i+" update.rank < ".concat(a,". "));if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != ".concat(a+e.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(t.shape[o],")."));for(var u=0;u<n.rank-a;++u)if(n.shape[u+a]!==e[u+r])throw new Error(i+" updates.shape[".concat(u+a,"] (").concat(n.shape[u+a],") != shape[").concat(u+a,"] (").concat(e[u+a],")"))}function ln(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}cn(n,t,e)}function fn(e,t,n){for(var r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length,o=1,u=a;u<i;++u)o*=n[u];var s=a<1?1:a;return{sliceRank:a,numUpdates:(0,M.NA)(t.shape)/s,sliceSize:o,strides:[].concat((0,T.Z)((0,M.e3)(n.slice(0,a))),[1]),outputSize:(0,M.NA)(n)}}var dn=n(2875),hn=n(9064),pn=n(115),vn=.1;function gn(e,t,n){return null==n&&(n=mn()),yn(e,t,(function(e,t){return wn(e,t,n)}))}function mn(){return 32===g.BV.backend.floatPrecision()?.001:vn}function yn(e,t,n){var r=!0;if(((0,pn.isTypedArray)(e)||(0,pn.isTypedArray)(t))&&(r=!1),(0,pn.isTypedArray)(e)&&(0,pn.isTypedArray)(t)&&(r=!0),r){var a=e.constructor.name,i=t.constructor.name;if(a!==i)throw new Error("Arrays are of different type. Actual: ".concat(a,". ")+"Expected: ".concat(i))}if(Array.isArray(e)&&Array.isArray(t)){var o=(0,D.C)(e),u=(0,D.C)(t);if(!(0,M.cO)(o,u))throw new Error("Arrays have different shapes. "+"Actual: [".concat(o,"]. Expected: [").concat(u,"]"))}var s=(0,pn.isTypedArray)(e)?e:(0,pn.flatten)(e),c=(0,pn.isTypedArray)(t)?t:(0,pn.flatten)(t);if(s.length!==c.length)throw new Error("Arrays have different lengths actual: ".concat(s.length," vs ")+"expected: ".concat(c.length,".\n")+"Actual:   ".concat(s,".\n")+"Expected: ".concat(c,"."));for(var l=0;l<c.length;++l){var f=s[l],d=c[l];if(!n(f,d))throw new Error("Arrays differ: actual[".concat(l,"] = ").concat(f,", expected[").concat(l,"] = ").concat(d,".\n")+"Actual:   ".concat(s,".\n")+"Expected: ".concat(c,"."))}"undefined"!==typeof expect&&expect().nothing()}function bn(e,t){e().then((function(){return t.fail()}),(function(){return t()})),"undefined"!==typeof expect&&expect().nothing()}function xn(e,t){var n="string"===typeof t||"number"===typeof t||"boolean"===typeof t?[t]:t;return(0,M.HD)(e)||(0,M.HD)(e[0])||(0,M.HD)(t)||(0,M.HD)(t[0])?yn(e,n,(function(e,t){return e==t})):yn(e,t,(function(e,t){return wn(e,t,0)}))}function kn(e,t,n){if(null==n&&(n=mn()),!wn(e,t,n))throw new Error("Numbers differ: actual === ".concat(e,", expected === ").concat(t));"undefined"!==typeof expect&&expect().nothing()}function wn(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function _n(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:".concat(e[r]," low: ").concat(t,", high: ").concat(n))}function Cn(e,t){var n=new Float32Array(e),r=new Float32Array(t);if(n.length!==r.length)throw new Error("Expected ArrayBuffer to be of length "+"".concat(r.length,", but it was ").concat(n.length));for(var a=0;a<r.length;a++)if(n[a]!==r[a])throw new Error("Expected ArrayBuffer value at ".concat(a," to be ")+"".concat(r[a]," but got ").concat(n[a]," instead"))}function Sn(e){for(var t=0;t<e.length;t++){var n=e[t];Array.isArray(n)?Sn(n):e[t]=(0,pn.encodeString)(n)}return e}function An(e){var t=document.createElement("video");return"playsInline"in t&&(t.playsInline=!0),t.muted=!0,t.loop=!0,t.style.position="fixed",t.style.left="0px",t.style.top="0px",t.preload="auto",t.appendChild(e),new Promise((function(e){t.addEventListener("loadeddata",(function(n){return e(t)})),t.load()}))}function En(e){return Tn.apply(this,arguments)}function Tn(){return(Tn=(0,A.Z)((0,S.Z)().mark((function e(t){return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.play();case 2:if(!("requestVideoFrameCallback"in t)){e.next=5;break}return e.next=5,new Promise((function(e){t.requestVideoFrameCallback(e)}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Nn="4.2.0",Dn=function(){function e(){(0,w.Z)(this,e)}return(0,_.Z)(e,null,[{key:"sgd",value:function(e){return new mt(e)}},{key:"momentum",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new yt(e,t,n)}},{key:"rmsprop",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new bt(e,t,n,r,a)}},{key:"adam",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new ht(e,t,n,r)}},{key:"adadelta",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new st(e,t,n)}},{key:"adamax",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new gt(e,t,n,r,a)}},{key:"adagrad",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return new lt(e,t)}}]),e}(),Fn=n(3525),In=n(1719),Mn=n(4502);var On=(0,qt.op)({addN_:function(e){M.hu(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),M.hu(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+"".concat(e.length)}));var t=e.map((function(e,t){return(0,D._1)(e,"tensors".concat(t),"addN")})),n=t[0];t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!M.cO(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=t;return g.BV.runKernel($t.Xze,r)}}),Rn=n(4108),Zn=n(8543),Bn=n(9995),zn=n(5157),Ln=n(3053),Pn=n(54),jn=n(4778),Un=n(2227),Wn=n(7897),Vn=n(9204),Gn=n(9151),qn=n(5561);var Hn=(0,qt.op)({avgPool3d_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=(0,D._1)(e,"x","avgPool3d","float32"),u=o,s=!1;4===o.rank&&(s=!0,u=(0,qn.X)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),M.hu(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(u.rank,".")})),M.hu("NDHWC"===i,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),M.hu("number"===typeof n&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,(function(){return"Error in avgPool3d: Stride must be > 0, but got '".concat(n,"'")})),(0,Gn.m)("avgPool3d",r,a);var c={x:u},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},f=g.BV.runKernel($t._k9,c,l);return f=(0,We.p)(f,u.dtype),s?(0,qn.X)(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}}),Xn=n(4836),Yn=n(7643),Kn=n(9238),$n=n(1744);var Qn=(0,qt.op)({basicLSTMCell_:function(e,t,n,r,a,i){var o=(0,D._1)(e,"forgetBias","basicLSTMCell"),u=(0,D._1)(t,"lstmKernel","basicLSTMCell"),s=(0,D._1)(n,"lstmBias","basicLSTMCell"),c=(0,D._1)(r,"data","basicLSTMCell"),l=(0,D._1)(a,"c","basicLSTMCell"),f=(0,D._1)(i,"h","basicLSTMCell"),d=(0,Xn.z)([c,f],1),h=(0,Vt.O)(d,u),p=(0,Ke.I)(h,s),v=p.shape[0],g=p.shape[1]/4,m=[v,g],y=(0,Kn.t)(p,[0,0],m),b=(0,Kn.t)(p,[0,g],m),x=(0,Kn.t)(p,[0,2*g],m),k=(0,Kn.t)(p,[0,3*g],m),w=(0,Ke.I)((0,Qe.d)((0,Yn.X)(y),(0,$n.A)(b)),(0,Qe.d)(l,(0,Yn.X)((0,Ke.I)(o,x))));return[w,(0,Qe.d)((0,$n.A)(w),(0,Yn.X)(k))]}}),Jn=n(6994),er=n(3700);var tr=(0,qt.op)({batchNorm2d_:function(e,t,n,r,a,i){var o,u,s=(0,D._1)(e,"x","batchNorm"),c=(0,D._1)(t,"mean","batchNorm"),l=(0,D._1)(n,"variance","batchNorm");return null!=a&&(o=(0,D._1)(a,"scale","batchNorm")),null!=r&&(u=(0,D._1)(r,"offset","batchNorm")),M.hu(2===s.rank,(function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(s.rank,".")})),M.hu(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(c.rank,".")})),M.hu(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&M.hu(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=u&&M.hu(2===u.rank||1===u.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(u.rank,".")})),(0,er.t)(s,c,l,u,o,i)}});var nr=(0,qt.op)({batchNorm3d_:function(e,t,n,r,a,i){var o,u,s=(0,D._1)(e,"x","batchNorm"),c=(0,D._1)(t,"mean","batchNorm"),l=(0,D._1)(n,"variance","batchNorm");return null!=a&&(o=(0,D._1)(a,"scale","batchNorm")),null!=r&&(u=(0,D._1)(r,"offset","batchNorm")),M.hu(3===s.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(s.rank,".")})),M.hu(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(c.rank,".")})),M.hu(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&M.hu(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=u&&M.hu(3===u.rank||1===u.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(u.rank,".")})),(0,er.t)(s,c,l,u,o,i)}});var rr=(0,qt.op)({batchNorm4d_:function(e,t,n,r,a,i){var o,u,s=(0,D._1)(e,"x","batchNorm"),c=(0,D._1)(t,"mean","batchNorm"),l=(0,D._1)(n,"variance","batchNorm");return null!=a&&(o=(0,D._1)(a,"scale","batchNorm")),null!=r&&(u=(0,D._1)(r,"offset","batchNorm")),M.hu(4===s.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(s.rank,".")})),M.hu(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(c.rank,".")})),M.hu(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&M.hu(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=u&&M.hu(4===u.rank||1===u.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(u.rank,".")})),(0,er.t)(s,c,l,u,o,i)}});var ar=(0,qt.op)({bincount_:function(e,t,n){var r=(0,D._1)(e,"x","bincount"),a=(0,D._1)(t,"weights","bincount");M.hu("int32"===r.dtype,(function(){return"Error in bincount: input "+"dtype must be int32, but got ".concat(r.dtype)})),M.hu(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),M.hu(a.size===r.size||0===a.size,(function(){return"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(r.shape,", weights shape: ")+"".concat(a.shape,".")}));var i={x:r,weights:a},o={size:n};return g.BV.runKernel($t.zvY,i,o)}});var ir=(0,qt.op)({broadcastArgs_:function(e,t){var n=(0,D._1)(e,"s0","broadcastArgs","int32"),r=(0,D._1)(t,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). "+"Has rank ".concat(n.rank));if(1!==r.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). "+"Has rank ".concat(r.rank));var a={s0:n,s1:r};return g.BV.runKernel($t.eEB,a)}}),or=n(9742),ur=n(1396),sr=n(9836);var cr=(0,qt.op)({concat1d_:function(e){return(0,Xn.z)(e,0)}});var lr=(0,qt.op)({concat2d_:function(e,t){return(0,Xn.z)(e,t)}});var fr=(0,qt.op)({concat3d_:function(e,t){return(0,Xn.z)(e,t)}});var dr=(0,qt.op)({concat4d_:function(e,t){return(0,Xn.z)(e,t)}}),hr=n(4918),pr=n(3457),vr=n(1732);var gr=(0,qt.op)({conv3d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],o=(0,D._1)(e,"x","conv3d"),u=(0,D._1)(t,"filter","conv3d"),s=o,c=!1;4===o.rank&&(c=!0,s=(0,qn.X)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),M.hu(5===s.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(s.rank,".")})),M.hu(5===u.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(u.rank,".")})),M.hu(s.shape[4]===u.shape[3],(function(){return"Error in conv3d: depth of input (".concat(s.shape[4],") must match ")+"input depth for filter ".concat(u.shape[3],".")})),M.hu((0,Gn.jT)(n,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")})),M.hu("NDHWC"===a,(function(){return"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported.")})),M.hu((0,Gn.U3)(i),(function(){return"Error in conv3D: Dilated rates should be larger than 0."})),M.hu((0,Gn.U3)(n),(function(){return"Error in conv3D: Strides should be larger than 0."}));var l={x:s,filter:u},f={strides:n,pad:r,dataFormat:a,dilations:i},d=g.BV.runKernel($t.x12,l,f);return c?(0,qn.X)(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}}),mr=n(1873);var yr=(0,qt.op)({conv3dTranspose_:function(e,t,n,r,a){var i=(0,D._1)(e,"x","conv3dTranspose"),o=(0,D._1)(t,"filter","conv3dTranspose");return(0,mr._)(n,i,o,r,a)}}),br=n(1227),xr=n(6679),kr=n(9457),wr=n(8862);var _r=(0,qt.op)({denseBincount_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=(0,D._1)(e,"x","denseBincount"),i=(0,D._1)(t,"weights","denseBincount");M.hu("int32"===a.dtype,(function(){return"Error in denseBincount: input "+"dtype must be int32, but got ".concat(a.dtype)})),M.hu(a.rank<=2,(function(){return"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(a.rank,".")})),M.hu(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),M.hu(i.size===a.size||0===i.size,(function(){return"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(a.shape,", weights shape: ")+"".concat(i.shape,".")}));var o={x:a,weights:i},u={size:n,binaryOutput:r};return g.BV.runKernel($t.QRR,o,u)}}),Cr=n(1878),Sr=n(1147);var Ar=(0,qt.op)({diag_:function(e){var t={x:(0,D._1)(e,"x","diag")};return g.BV.runKernel($t.$w,t)}}),Er=n(7580),Tr=n(5923),Nr=n(5043);var Dr=(0,qt.op)({einsum_:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map((function(e,t){return(0,D._1)(e,"tensors".concat(t),"einsum")})),i={equation:e};return g.BV.runKernel($t.$g6,a,i)}}),Fr=n(2353),Ir=n(3254),Mr=n(3891),Or=n(3313),Rr=n(411),Zr=n(2975),Br=n(5682),zr=n(2343);var Lr=(0,qt.op)({eye_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";null==t&&(t=e);for(var a=Ue([e,t],r),i=e<=t?e:t,o=0;o<i;++o)a.set(1,o,o);var u=(0,qn.X)(a.toTensor(),[e,t]);if(null==n)return u;if(1===n.length)return(0,zr.G)((0,Zr.d)(u,0),[n[0],1,1]);if(2===n.length)return(0,zr.G)((0,Zr.d)((0,Zr.d)(u,0),0),[n[0],n[1],1,1]);if(3===n.length)return(0,zr.G)((0,Zr.d)((0,Zr.d)((0,Zr.d)(u,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}}),Pr=n(2628),jr=n(7145),Ur=n(9498),Wr=n(5014),Vr=n(8327),Gr=n(6996),qr=n(300),Hr=n(4652),Xr=n(7005),Yr=n(4419),Kr=n(4920),$r=n(2642);function Qr(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");var r={start:e,stop:t,num:n};return g.BV.runKernel($t.e7N,{},r)}var Jr=n(936),ea=n(378),ta=n(5341),na=n(5113),ra=n(4561),aa=n(5530),ia=n(2177),oa=n(875),ua=n(5117),sa=n(1712),ca=2147483648;var la=(0,qt.op)({searchSorted_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left",r=(0,D._1)(e,"sortedSequence","searchSorted"),a=(0,D._1)(t,"values","searchSorted"),i=r.shape[r.shape.length-1],o=a.shape[a.shape.length-1],u=(0,qn.X)(r,[-1,i]),s=(0,qn.X)(a,[-1,o]);if(u.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(u.shape[0]!==s.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if((0,M.NA)(s.shape)>=ca)throw new Error("values tensor size must less than ".concat(ca));if(u.shape[1]>=ca)throw new Error("trailing dim_size must less than ".concat(ca," for int32 output type, was ").concat(u.shape[1]));var c={sortedSequence:u,values:s},l={side:n};return g.BV.runKernel($t.nr8,c,l)}});function fa(e,t){return la(e,t,"left")}var da=n(6176),ha=n(5777);var pa=(0,qt.op)({maxPool3d_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=(0,D._1)(e,"x","maxPool3d"),u=o,s=!1;4===o.rank&&(s=!0,u=(0,qn.X)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),M.hu(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(u.rank,".")})),M.hu("NDHWC"===i,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),(0,Gn.m)("maxPool3d",r,a);var c={x:u},l={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},f=g.BV.runKernel($t.OAf,c,l);return s?(0,qn.X)(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}});var va=(0,qt.op)({maxPoolWithArgmax_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=(0,D._1)(e,"x","maxPoolWithArgmax"),o={x:i},u={filterSize:t,strides:n,pad:r,includeBatchInIndex:a},s=g.BV.runKernel($t.vFR,o,u);return{result:s[0],indexes:s[1]}}}),ga=n(6568),ma=n(6100);function ya(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.indexing,a=void 0===r?"xy":r;if("xy"!==a&&"ij"!==a)throw new TypeError("".concat(a," is not a valid third argument to meshgrid"));if(void 0===e)return[];var i=(0,D._1)(e,"x","meshgrid",e instanceof je.es?e.dtype:"float32");if(void 0===t)return[i];var o=(0,D._1)(t,"y","meshgrid",t instanceof je.es?t.dtype:"float32"),u=(0,M.NA)(i.shape),s=(0,M.NA)(o.shape);return"xy"===a?(i=(0,qn.X)(i,[1,-1]),o=(0,qn.X)(o,[-1,1]),[(0,Vt.O)((0,ma.i)([s,1],i.dtype),i),(0,Vt.O)(o,(0,ma.i)([1,u],o.dtype))]):(i=(0,qn.X)(i,[-1,1]),o=(0,qn.X)(o,[1,-1]),[(0,Vt.O)(i,(0,ma.i)([1,s],i.dtype)),(0,Vt.O)((0,ma.i)([u,1],o.dtype),o)])}var ba=n(7891),xa=n(2273),ka=n(9719),wa=n(4645),_a=n(8473);var Ca=(0,qt.op)({moments_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=(0,D._1)(e,"x","moments");var r=(0,M.EC)(t,e.shape),a=(0,ga.J)(e,r,n),i=a.shape;n||(i=(0,_a.rv)(a.shape,r));var o=(0,et.h)((0,dt.l)((0,We.p)(e,"float32"),(0,qn.X)(a,i))),u=(0,ga.J)(o,r,n);return{mean:a,variance:u}}});var Sa=(0,qt.op)({multiRNNCell_:function(e,t,n,r){for(var a=(0,D._1)(t,"data","multiRNNCell"),i=(0,D.sI)(n,"c","multiRNNCell"),o=(0,D.sI)(r,"h","multiRNNCell"),u=a,s=[],c=0;c<e.length;c++){var l=e[c](u,i[c],o[c]);s.push(l[0]),s.push(l[1]),u=l[1]}for(var f=[],d=[],h=0;h<s.length;h+=2)f.push(s[h]),d.push(s[h+1]);return[f,d]}});var Aa=(0,qt.op)({multinomial_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=(0,D._1)(e,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(i,"."));if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(o));n=n||Math.random();var u=1===o?(0,qn.X)(a,[1,-1]):a,s={logits:u},c={numSamples:t,seed:n,normalized:r},l=g.BV.runKernel($t.NZg,s,c);return 1===o?(0,qn.X)(l,[l.size]):l}}),Ea=n(4362),Ta=n(5549),Na=n(773);var Da=(0,qt.op)({outerProduct_:function(e,t){var n=(0,D._1)(e,"v1","outerProduct"),r=(0,D._1)(t,"v2","outerProduct");M.hu(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=(0,qn.X)(n,[-1,1]),i=(0,qn.X)(r,[1,-1]);return(0,Vt.O)(a,i)}}),Fa=n(1970);var Ia=(0,qt.op)({pad1d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,M.hu)(2===t.length,(function(){return"Invalid number of paddings. Must be length of 2."})),(0,Fa.v)(e,[t],n)}});var Ma=(0,qt.op)({pad2d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,M.hu)(2===t.length&&2===t[0].length&&2===t[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),(0,Fa.v)(e,t,n)}});var Oa=(0,qt.op)({pad3d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,M.hu)(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),(0,Fa.v)(e,t,n)}});var Ra=(0,qt.op)({pad4d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,M.hu)(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),(0,Fa.v)(e,t,n)}}),Za=n(7226),Ba=n(6859),za=n(7722);var La=(0,qt.op)({raggedGather_:function(e,t,n,r){var a={paramsNestedSplits:e.map((function(e,t){return(0,D._1)(e,"tensors".concat(t),"raggedGather","int32")})),paramsDenseValues:(0,D._1)(t,"paramsDenseValues","raggedGather"),indices:(0,D._1)(n,"indices","raggedGather","int32")},i={outputRaggedRank:r},o=g.BV.runKernel($t.dDz,a,i);return{outputNestedSplits:o.slice(0,o.length-1),outputDenseValues:o[o.length-1]}}});var Pa=(0,qt.op)({raggedRange_:function(e,t,n){var r=(0,D._1)(e,"starts","raggedRange"),a={starts:r,limits:(0,D._1)(t,"limits","raggedRange",r.dtype),deltas:(0,D._1)(n,"deltas","raggedRange",r.dtype)},i=g.BV.runKernel($t.CQl,a);return{rtNestedSplits:i[0],rtDenseValues:i[1]}}});var ja=(0,qt.op)({raggedTensorToTensor_:function(e,t,n,r,a){var i=(0,D._1)(e,"shape","raggedTensorToTensor","int32"),o=(0,D._1)(t,"values","raggedTensorToTensor"),u={shape:i,values:o,defaultValue:(0,D._1)(n,"defaultValue","raggedTensorToTensor",o.dtype),rowPartitionTensors:r.map((function(e,t){return(0,D._1)(e,"tensors".concat(t),"raggedTensorToTensor","int32")}))},s={rowPartitionTypes:a};return g.BV.runKernel($t.BiW,u,s)}});var Ua=(0,qt.op)({rand_:function(e,t,n){(0,M.Mu)(e);var r=(0,M.NA)(e),a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));a=new Uint8Array(r)}for(var i=0;i<r;i++)a[i]=t();return g.BV.makeTensor(a,e,n)}}),Wa=n(6699),Va=function(){function e(t,n,r,a,i){(0,w.Z)(this,e),this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=Wa.alea(o.toString())}return(0,_.Z)(e,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var u=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*u,n=this.mean+this.stdDev*i*u,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)}},{key:"convertValue",value:function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}},{key:"isValidTruncated",value:function(e){return e<=this.upper&&e>=this.lower}}]),e}(),Ga=function(){function e(t,n,r,a){(0,w.Z)(this,e),this.alpha=t,this.beta=1/n,this.dtype=r;var i=a||Math.random();this.randu=Wa.alea(i.toString()),this.randn=new Va(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return(0,_.Z)(e,[{key:"nextValue",value:function(){for(var e,t,n,r,a,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-i+Math.log(i)),(a=this.randu())<t||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}},{key:"convertValue",value:function(e){return"float32"===this.dtype?e:Math.round(e)}}]),e}(),qa=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if((0,w.Z)(this,e),this.canReturnFloat=function(){return null==t.dtype||"float32"===t.dtype},this.min=n,this.range=r-n,this.dtype=a,null==i&&(i=Math.random()),"number"===typeof i&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(n," - ").concat(r," <= 1 and dtype is not float"));this.random=Wa.alea(i)}return(0,_.Z)(e,[{key:"convertValue",value:function(e){return this.canReturnFloat()?e:Math.round(e)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),e}();var Ha=(0,qt.op)({randomGamma_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;if((0,M.Mu)(e),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));for(var i=new Ga(t,n,r,a),o=Ue(e,r),u=0;u<o.values.length;u++)o.values[u]=i.nextValue();return o.toTensor()}});var Xa=(0,qt.op)({randomNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if((0,M.Mu)(e),null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));for(var i=new Va(t,n,r,!1,a),o=Ue(e,r),u=0;u<o.values.length;u++)o.values[u]=i.nextValue();return o.toTensor()}});var Ya=(0,qt.op)({randomStandardNormal_:function(e,t,n){if(null!=t&&"bool"===t)throw new Error("Unsupported data type ".concat(t));return Xa(e,0,1,t,n)}});var Ka=(0,qt.op)({randomUniform_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;(0,M.Mu)(e);for(var i=Ue(e,r),o=new qa(t,n,null,a),u=0;u<i.values.length;u++)i.values[u]=o.nextValue();return i.toTensor()}});function $a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");var a={start:e,stop:t,step:n,dtype:r};return g.BV.runKernel($t.e6w,{},a)}var Qa=n(6972),Ja=n(2209),ei=n(7539),ti=n(5900),ni=n(4933);var ri=(0,qt.op)({reverse1d_:function(e){var t=(0,D._1)(e,"x","reverse");return M.hu(1===t.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank ".concat(t.rank,".")})),(0,ni.G)(t,0)}});var ai=(0,qt.op)({reverse2d_:function(e,t){var n=(0,D._1)(e,"x","reverse");return M.hu(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")})),(0,ni.G)(n,t)}});var ii=(0,qt.op)({reverse3d_:function(e,t){var n=(0,D._1)(e,"x","reverse");return M.hu(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")})),(0,ni.G)(n,t)}});var oi=(0,qt.op)({reverse4d_:function(e,t){var n=(0,D._1)(e,"x","reverse");return M.hu(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")})),(0,ni.G)(n,t)}}),ui=n(766),si=n(5115),ci=n(413),li=n(119);function fi(){return fi=(0,A.Z)((0,S.Z)().mark((function e(t,n){var r,a,i,o,u,s,c,l,f,d,h;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,D._1)(t,"x","setdiff1d"),a=(0,D._1)(n,"y","setdiff1d"),M.hu(r.dtype===a.dtype,(function(){return"x and y should have the same dtype, but got x (".concat(r.dtype,") and y (").concat(a.dtype,").")})),M.hu(1===r.rank,(function(){return"x should be 1D tensor, but got x (".concat(r.shape,").")})),M.hu(1===a.rank,(function(){return"y should be 1D tensor, but got y (".concat(a.shape,").")})),e.next=7,r.data();case 7:return i=e.sent,e.next=10,a.data();case 10:for(o=e.sent,u=new Set(o),s=0,c=0;c<i.length;c++)u.has(i[c])||s++;for(l=new je.YD([s],r.dtype),f=new je.YD([s],"int32"),d=0,h=0;d<i.length;d++)u.has(i[d])||(l.values[h]=i[d],f.values[h]=d,h++);return e.abrupt("return",[l.toTensor(),f.toTensor()]);case 18:case"end":return e.stop()}}),e)}))),fi.apply(this,arguments)}var di=function(e,t){return fi.apply(this,arguments)},hi=n(2070),pi=n(7254),vi=n(7657);var gi=(0,qt.op)({slice1d_:function(e,t,n){var r=(0,D._1)(e,"x","slice1d");return M.hu(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")})),(0,Kn.t)(r,[t],[n])}});var mi=(0,qt.op)({slice2d_:function(e,t,n){var r=(0,D._1)(e,"x","slice2d");return M.hu(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")})),(0,Kn.t)(r,t,n)}});var yi=(0,qt.op)({slice3d_:function(e,t,n){var r=(0,D._1)(e,"x","slice3d");return M.hu(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")})),(0,Kn.t)(r,t,n)}});var bi=(0,qt.op)({slice4d_:function(e,t,n){var r=(0,D._1)(e,"x","slice4d");return M.hu(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")})),(0,Kn.t)(r,t,n)}}),xi=n(4910),ki=n(4626),wi=n(5696),_i=n(7635),Ci=n(530),Si=n(774),Ai=n(4617),Ei=n(2588),Ti=n(7993),Ni=n(3931),Di=n(8306),Fi=n(4031),Ii=n(9017),Mi=n(227),Oi=n(6999);function Ri(e,t){(0,M.Cq)(e);var n=(0,D.C)(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return(0,F.H)(e,null,n,t)}function Zi(e,t,n){if((0,M.Cq)(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=(0,D.C)(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return(0,F.H)(e,t,r,n)}function Bi(e,t,n){if((0,M.Cq)(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=(0,D.C)(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return(0,F.H)(e,t,r,n)}function zi(e,t,n){if((0,M.Cq)(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=(0,D.C)(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return(0,F.H)(e,t,r,n)}function Li(e,t,n){if((0,M.Cq)(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=(0,D.C)(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||r,(0,F.H)(e,t,r,n)}var Pi=n(9085);var ji=(0,qt.op)({truncatedNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if((0,M.Mu)(e),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var i=new Va(t,n,r,!0,a),o=Ue(e,r),u=0;u<o.values.length;u++)o.values[u]=i.nextValue();return o.toTensor()}}),Ui=n(4860),Wi=n(6918),Vi=n(4566);function Gi(e,t){return la(e,t,"right")}function qi(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return g.BV.makeVariable(e,t,n,r)}var Hi=n(329);function Xi(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);for(var a=Ue(e,"int32"),i=Ue([n.length,e.length],"int32"),o=0;o<n.length;o++){var u=a.indexToLoc(n[o]),s=o*e.length;i.values.set(u,s)}return i.toTensor()}function Yi(){return(Yi=(0,A.Z)((0,S.Z)().mark((function e(t){var n,r,a;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,D._1)(t,"condition","whereAsync","bool"),e.next=3,n.data();case 3:return r=e.sent,a=Xi(n.shape,r),t!==n&&n.dispose(),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ki=function(e){return Yi.apply(this,arguments)},$i=n(7742);function Qi(){return Qi=(0,A.Z)((0,S.Z)().mark((function e(t,n,r){var a,i,o,u,s,c,l,f,d,h,p,v,g;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=(0,D._1)(t,"tensor","boolMask"),i=(0,D._1)(n,"mask","boolMask","bool"),o=null==r?0:r,u=i.rank,s=a.shape,M.hu(u>0,(function(){return"mask cannot be scalar"})),M.k5(s.slice(o,o+u),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,l=o;l<o+u;l++)c*=s[l];return f=s.slice(0,o).concat([c],s.slice(o+u)),d=(0,qn.X)(a,f),h=(0,qn.X)(i,[-1]),e.next=14,Ki(h);case 14:return p=e.sent,v=(0,Ni.L)(p,[1]),g=(0,Ur.I)(d,v,o),t!==a&&a.dispose(),n!==i&&i.dispose(),v.dispose(),d.dispose(),h.dispose(),p.dispose(),e.abrupt("return",g);case 24:case"end":return e.stop()}}),e)}))),Qi.apply(this,arguments)}var Ji=function(e,t,n){return Qi.apply(this,arguments)},eo=n(6662);var to=(0,qt.op)({movingAverage_:function(e,t,n,r){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=(0,D._1)(e,"v","movingAverage"),o=(0,D._1)(t,"x","movingAverage"),u=(0,D._1)(n,"decay","movingAverage");(0,hn.assertTypesMatch)(i,o),M.hu(M.cO(i.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var s=(0,rt.i)(1),c=(0,dt.l)(s,u),l=(0,Qe.d)((0,dt.l)(o,i),c);if(a){M.hu(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var f=(0,D._1)(r,"step","movingAverage");l=(0,$e.h)(l,(0,dt.l)(s,(0,ft.s)(u,f)))}return(0,Ke.I)(i,l)}});var no=(0,qt.op)({scatterND_:function(e,t,n){(0,M.Mu)(n);var r=(0,D._1)(e,"indices","scatterND","int32"),a=(0,D._1)(t,"updates","scatterND");ln(a,r,n);var i={indices:r,updates:a},o={shape:n};return g.BV.runKernel($t.xQA,i,o)}});function ro(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(e.shape,"."));var a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(i,"."));var o=t.size;if(0!==t.rank&&(1!==t.rank||o!==a))throw new Error("sparseValues has incorrect shape "+"".concat(t.shape,", should be [] or [").concat(a,"]"));if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}var ao=(0,qt.op)({sparseToDense_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;(0,M.Mu)(n);var a=(0,D._1)(e,"sparseIndices","sparseToDense","int32"),i=(0,D._1)(t,"sparseValues","sparseToDense","string_or_numeric"),o=(0,D._1)(r,"defaultValue","sparseToDense",i.dtype);ro(a,i,n,o);var u={sparseIndices:a,sparseValues:i,defaultValue:o},s={outputShape:n};return g.BV.runKernel($t.D2d,u,s)}});var io=(0,qt.op)({gatherND_:function(e,t){var n=(0,D._1)(t,"indices","gatherND","int32"),r={params:(0,D._1)(e,"x","gatherND","string_or_numeric"),indices:n};return g.BV.runKernel($t.q1x,r)}});var oo=(0,qt.op)({dropout_:function(e,t,n,r){var a=(0,D._1)(e,"x","dropout");if(M.hu("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")})),M.hu(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(t,".")})),0===t)return e instanceof je.es?a.clone():a;var i=function(e,t){if(null==t)return e.shape.slice();if(M.cO(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),o=1-t,u=(0,$e.h)((0,Pr.G)((0,Ke.I)(Ka(i,0,1,"float32",r),o)),o);return(0,Qe.d)(a,u)}});function uo(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function so(e,t,n){for(var r=1-e%2,a=new Float32Array(e),i=0;i<e;++i){var o=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(o)}return Ri(a,"float32")}function co(){return co=(0,A.Z)((0,S.Z)().mark((function e(t,n){var r,a,i,o,u,s,c,l,f,d,h,p,v,g,m,y=arguments;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=y.length>2&&void 0!==y[2]?y[2]:1,a=(0,D._1)(t,"predictions","inTopK"),i=(0,D._1)(n,"targets","inTopK"),(0,M.hu)(a.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(a.rank)})),(0,M.hu)(a.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(a.rank," and targets rank ").concat(i.rank)})),(0,M.k5)(a.shape.slice(0,a.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=a.shape[a.shape.length-1],(0,M.hu)(r>0&&r<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(o,"), but got ").concat(r)})),e.next=10,a.data();case 10:return u=e.sent,e.next=13,i.data();case 13:s=e.sent,c=u.length/o,l=o,f=(0,M.WP)("bool",c),d=0;case 17:if(!(d<c)){e.next=35;break}for(h=d*l,p=u.subarray(h,h+l),v=[],g=0;g<p.length;g++)v.push({value:p[g],index:g});v.sort((function(e,t){return t.value-e.value})),f[d]=0,m=0;case 25:if(!(m<r)){e.next=32;break}if(v[m].index!==s[d]){e.next=29;break}return f[d]=1,e.abrupt("break",32);case 29:m++,e.next=25;break;case 32:d++,e.next=17;break;case 35:return t!==a&&a.dispose(),n!==i&&i.dispose(),e.abrupt("return",I(f,i.shape,"bool"));case 38:case"end":return e.stop()}}),e)}))),co.apply(this,arguments)}var lo=function(e,t){return co.apply(this,arguments)},fo=n(8744),ho=n(1045);function po(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return(0,Qe.d)(e,(0,Fi.N)(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function vo(e,t){var n=t,r=Kt.getReductionAxes(e.shape,t.shape);return r.length>0&&(n=(0,Mi.S)(n,r)),(0,qn.X)(n,e.shape)}function go(e,t,n,r){if("linear"===t)return e;if("relu"===t)return(0,ei.U)(e);if("elu"===t)return(0,Fr.p)(e);if("relu6"===t)return(0,ti.b)(e);if("prelu"===t)return(0,Ba.A)(e,n);if("leakyrelu"===t)return(0,Yr.h)(e,r);if("sigmoid"===t)return(0,Yn.X)(e);throw new Error("Unknown fused activation ".concat(t,"."))}var mo=function(e,t){return!(e>0)||"linear"===t};var yo=(0,qt.op)({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,u=e.dilations,s=void 0===u?[1,1]:u,c=e.dimRoundingMode,l=e.bias,f=e.activation,d=void 0===f?"linear":f,h=e.preluActivationWeights,p=e.leakyreluAlpha;if(d=d||"linear",!1===mo(g.BV.state.gradientDepth,d)){M.hu("NHWC"===o,(function(){return"Error in fused conv2d: got dataFormat of ".concat(o," but ")+"only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear."}));var v=(0,pr.T)(t,n,r,a,o,s,c);return null!=l&&(v=(0,Ke.I)(v,l)),go(v,d,h,p)}var m=(0,D._1)(t,"x","conv2d","float32"),y=(0,D._1)(n,"filter","conv2d","float32"),b=m,x=!1;3===m.rank&&(x=!0,b=(0,qn.X)(m,[1,m.shape[0],m.shape[1],m.shape[2]])),M.hu(4===b.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(b.rank,".")})),M.hu(4===y.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(y.rank,".")})),Gn.m("fused conv2d",a,c);var k="NHWC"===o?b.shape[3]:b.shape[1];M.hu(y.shape[2]===k,(function(){return"Error in conv2d: depth of input (".concat(k,") must match ")+"input depth for filter ".concat(y.shape[2],".")})),M.hu(Gn.jT(r,s),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(s,"'")}));var w,_,C=Gn.Ix(b.shape,y.shape,r,s,a,c);if(null!=l){w=(0,D._1)(l,"bias","fused conv2d");var S=(0,hn.makeTypesMatch)(w,m),A=(0,E.Z)(S,1);w=A[0],"NHWC"===o?Kt.assertAndGetBroadcastShape(C.outShape,w.shape):(M.hu(w.shape.length<=1,(function(){return"Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of "+"rank-".concat(w.shape.length,".")})),M.hu(0===w.shape.length||w.shape[0]===C.outChannels||1===w.shape[0],(function(){return"Error in fused conv2d: bias shape (".concat(w.shape,") is not ")+"compatible with the number of output channels "+"(".concat(C.outChannels,")")})))}if(null!=h){var T=h.shape;if(M.hu(T.length<=1||3===T.length,(function(){return"Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of "+"rank-".concat(T.length,".")})),1===T.length)M.hu(1===T[0]||T[0]===C.outChannels,(function(){return"Error in fused conv2d: PReLU activation weights "+"(".concat(T,") is not compatible with the number of output ")+"channels (".concat(C.outChannels,").")}));else if(3===T.length)try{Kt.assertAndGetBroadcastShape(T,C.outShape)}catch(Z){var N="Error in fused conv2d: PReLU activation weights (".concat(T,") ")+"is not compatible with the output shape of the conv2d "+"(".concat(C.outShape,").");throw Error(N)}_=(0,D._1)(h,"prelu weights","fused conv2d")}var F=function(e,t){M.hu("NHWC"===o,(function(){return"Error in gradient of fused conv2D: got dataFormat of ".concat(o," but only NHWC is currently supported.")}));var n=(0,E.Z)(t,4),i=n[0],u=n[1],c=n[2],l=n[3],f=po(e,c,d);M.hu(Gn.I0(s),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(s,"'")}));var h=[(0,ho._)(u.shape,f,i,r,a),(0,fo.p)(u,f,i.shape,r,a)];if(null!=l){var p=vo(l,f);h.push(p)}return h},I={x:b,filter:y,bias:w,preluActivationWeights:_},O={strides:r,pad:a,dataFormat:o,dilations:s,dimRoundingMode:c,activation:d,leakyreluAlpha:p};if(null==l){var R=(0,nt.cb)((function(e,t,n){var r=g.BV.runKernel($t._V0,I,O);return n([t,e,r]),x&&(r=(0,qn.X)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:F}}));return R(b,y)}return(0,nt.cb)((function(e,t,n,r){var a=g.BV.runKernel($t._V0,I,O);return r([t,e,a,n]),x&&(a=(0,qn.X)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:F}}))(b,y,w)}}),bo=n(288),xo=n(6939);var ko=(0,qt.op)({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,u=e.dilations,s=void 0===u?[1,1]:u,c=e.dimRoundingMode,l=e.bias,f=e.activation,d=void 0===f?"linear":f,h=e.preluActivationWeights,p=e.leakyreluAlpha;if(!1===mo(g.BV.state.gradientDepth,d)){var v=(0,Sr.B)(t,n,r,a,o,s,c);return null!=l&&(v=(0,Ke.I)(v,l)),go(v,d,h,p)}var m=(0,D._1)(t,"x","depthwiseConv2d","float32"),y=(0,D._1)(n,"filter","depthwiseConv2d","float32"),b=m,x=!1;3===m.rank&&(x=!0,b=(0,qn.X)(m,[1,m.shape[0],m.shape[1],m.shape[2]])),M.hu(4===b.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(b.rank,".")})),M.hu(4===y.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(y.rank,".")})),M.hu(b.shape[3]===y.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels "+"(".concat(b.shape[3],") must match the inChannels dimension in ")+"filter ".concat(y.shape[2],".")})),null==s&&(s=[1,1]),M.hu(Gn.jT(r,s),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(s,"'")})),Gn.m("fused depthwiseConv2d",a,c);var k,w,_=Gn.Ix(b.shape,y.shape,r,s,a,c,!0);if(null!=l){k=(0,D._1)(l,"bias","fused conv2d");var C=(0,hn.makeTypesMatch)(k,m),S=(0,E.Z)(C,1);k=S[0],Kt.assertAndGetBroadcastShape(_.outShape,k.shape)}null!=h&&(w=(0,D._1)(h,"prelu weights","fused depthwiseConv2d"));var A=function(e,t){M.hu(Gn.I0(s),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'")}));var n=(0,E.Z)(t,4),i=n[0],o=n[1],u=n[2],l=n[3],f=po(e,u,d),h=(0,xo.v)(o.shape,f,i,r,a,s,c),p=(0,bo.z)(o,f,i.shape,r,a,s,c);return null!=l?[h,p,vo(k,f)]:[h,p]},T={x:b,filter:y,bias:k,preluActivationWeights:w},N={strides:r,pad:a,dataFormat:o,dilations:s,dimRoundingMode:c,activation:d,leakyreluAlpha:p};if(null==l){var F=(0,nt.cb)((function(e,t,n){var r=g.BV.runKernel($t.luS,T,N);return n([t,e,r]),x&&(r=(0,qn.X)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:A}}));return F(b,y)}return(0,nt.cb)((function(e,t,n,r){var a=g.BV.runKernel($t.luS,T,N);return r([t,e,a,n]),x&&(a=(0,qn.X)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:A}}))(b,y,k)}});var wo=(0,qt.op)({fusedMatMul_:function(e){var t=e.a,n=e.b,r=e.transposeA,a=void 0!==r&&r,i=e.transposeB,o=void 0!==i&&i,u=e.bias,s=e.activation,c=void 0===s?"linear":s,l=e.preluActivationWeights,f=e.leakyreluAlpha,d=void 0===f?.2:f;if(!1===mo(g.BV.state.gradientDepth,c)){var h=(0,Vt.O)(t,n,a,o);return null!=u&&(h=(0,Ke.I)(h,u)),go(h,c,l,d)}var p=(0,D._1)(t,"a","fused matMul"),v=(0,D._1)(n,"b","fused matMul"),m=(0,hn.makeTypesMatch)(p,v),y=(0,E.Z)(m,2);p=y[0],v=y[1];var b=a?p.shape[p.rank-2]:p.shape[p.rank-1],x=o?v.shape[v.rank-1]:v.shape[v.rank-2],k=a?p.shape[p.rank-1]:p.shape[p.rank-2],w=o?v.shape[v.rank-2]:v.shape[v.rank-1],_=p.shape.slice(0,-2),C=v.shape.slice(0,-2),S=M.NA(_),A=M.NA(C);M.hu(b===x,(function(){return"Error in fused matMul: inner shapes (".concat(b,") and (")+"".concat(x,") of Tensors with shapes ").concat(p.shape," and ")+"".concat(v.shape," and transposeA=").concat(a)+" and transposeB=".concat(o," must match.")}));var T,N,F=Kt.assertAndGetBroadcastShape(p.shape.slice(0,-2),v.shape.slice(0,-2)).concat([k,w]),I=a?(0,qn.X)(p,[S,b,k]):(0,qn.X)(p,[S,k,b]),O=o?(0,qn.X)(v,[A,w,x]):(0,qn.X)(v,[A,x,w]);if(null!=u){T=(0,D._1)(u,"bias","fused matMul");var R=(0,hn.makeTypesMatch)(T,p);T=(0,E.Z)(R,1)[0],Kt.assertAndGetBroadcastShape(F,T.shape)}null!=l&&(N=(0,D._1)(l,"prelu weights","fused matMul"));var Z=function(e,t){var n,r,i=(0,E.Z)(t,4),s=i[0],l=i[1],f=i[2],d=i[3],h=po((0,qn.X)(e,f.shape),f,c);return a||o?!a&&o?(n=(0,Vt.O)(h,l,!1,!1),r=(0,Vt.O)(h,s,!0,!1)):a&&!o?(n=(0,Vt.O)(l,h,!1,!0),r=(0,Vt.O)(s,h,!1,!1)):(n=(0,Vt.O)(l,h,!0,!0),r=(0,Vt.O)(h,s,!0,!0)):(n=(0,Vt.O)(h,l,!1,!0),r=(0,Vt.O)(s,h,!0,!1)),null!=u?[n,r,vo(d,h)]:[n,r]},B={a:I,b:O,bias:T,preluActivationWeights:N},z={transposeA:a,transposeB:o,activation:c,leakyreluAlpha:d};if(null==u){var L=(0,nt.cb)((function(e,t,n){var r=g.BV.runKernel($t.usg,B,z);return n([e,t,r]),{value:(0,qn.X)(r,F),gradFunc:Z}}));return L(I,O)}return(0,nt.cb)((function(e,t,n,r){var a=g.BV.runKernel($t.usg,B,z);return r([e,t,a,n]),{value:(0,qn.X)(a,F),gradFunc:Z}}))(I,O,T)}});var _o=(0,qt.op)({hammingWindow_:function(e){return so(e,.54,.46)}});var Co=(0,qt.op)({hannWindow_:function(e){return so(e,.5,.5)}});var So=(0,qt.op)({frame_:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=0,o=[];i+t<=e.size;)o.push((0,Kn.t)(e,i,t)),i+=n;if(r)for(;i<e.size;){var u=i+t-e.size,s=(0,Xn.z)([(0,Kn.t)(e,i,t-u),(0,ct.h)([u],a)]);o.push(s),i+=n}return 0===o.length?Zi([],[0,t]):(0,qn.X)((0,Xn.z)(o),[o.length,t])}});var Ao=(0,qt.op)({stft_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Co;null==r&&(r=uo(t));var i=So(e,t,n),o=(0,Qe.d)(i,a(t));return(0,Ai.Q)(o,r)}});var Eo=(0,qt.op)({cropAndResize_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=(0,D._1)(e,"image","cropAndResize"),u=(0,D._1)(t,"boxes","cropAndResize","float32"),s=(0,D._1)(n,"boxInd","cropAndResize","int32"),c=u.shape[0];M.hu(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),M.hu(2===u.rank&&4===u.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(c,",4] ")+"but had shape ".concat(u.shape,".")})),M.hu(1===s.rank&&s.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(c,"] ")+"but had shape ".concat(u.shape,".")})),M.hu(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),M.hu(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),M.hu("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was ".concat(a)}));var l={image:o,boxes:u,boxInd:s},f={method:a,extrapolationValue:i,cropSize:r},d=g.BV.runKernel($t.VcC,l,f);return d}});var To=(0,qt.op)({flipLeftRight_:function(e){var t=(0,D._1)(e,"image","flipLeftRight","float32");M.hu(4===t.rank,(function(){return"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,".")}));var n={image:t};return g.BV.runKernel($t.Uyb,n,{})}});var No=(0,qt.op)({grayscaleToRGB_:function(e){var t=(0,D._1)(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];M.hu(t.rank>=2,(function(){return"Error in grayscaleToRGB: images must be at least rank 2, "+"but got rank ".concat(t.rank,".")})),M.hu(1===r,(function(){return"Error in grayscaleToRGB: last dimension of a grayscale image "+"should be size 1, but got size ".concat(r,".")}));var a=new Array(t.rank);return a.fill(1,0,n),a[n]=3,(0,zr.G)(t,a)}});var Do=(0,qt.op)({rotateWithOffset_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=(0,D._1)(e,"image","rotateWithOffset","float32");M.hu(4===a.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,".")}));var i={image:a},o={radians:t,fillValue:n,center:r},u=g.BV.runKernel($t.b9H,i,o);return u}});function Fo(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=e.shape[0];return n=Math.min(n,o),M.hu(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),M.hu(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")})),M.hu(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])})),M.hu(1===t.rank,(function(){return"scores must be a 1D tensor"})),M.hu(t.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(t.shape[0])})),M.hu(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(i,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var Io=(0,qt.op)({nonMaxSuppression_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=(0,D._1)(e,"boxes","nonMaxSuppression","float32"),o=(0,D._1)(t,"scores","nonMaxSuppression","float32"),u=Fo(i,o,n,r,a),s={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:a=u.scoreThreshold};return g.BV.runKernel($t.uv1,{boxes:i,scores:o},s)}});function Mo(e,t,n){var r=function(e,t,n){return function(e,t,n){var r=0,a=e.length,i=0,o=!1;for(;r<a;){var u=n(t,e[i=r+(a-r>>>1)]);u>0?r=i+1:(a=i,o=!u)}return o?r:-r-1}(e,t,n||Oo)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function Oo(e,t){return e>t?1:e<t?-1:0}function Ro(e,t,n,r,a){return zo(e,t,n,r,a,0)}function Zo(e,t,n,r,a,i){return zo(e,t,n,r,a,0,!1,i,!0)}function Bo(e,t,n,r,a,i){return zo(e,t,n,r,a,i,!0)}function zo(e,t,n,r,a,i){for(var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],s=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c=[],l=0;l<t.length;l++)t[l]>a&&c.push({score:t[l],boxIndex:l,suppressBeginIndex:0});c.sort(jo);for(var f=i>0?-.5/i:0,d=[],h=[];d.length<n&&c.length>0;){var p=c.pop(),v=p.score,g=p.boxIndex,m=p.suppressBeginIndex;if(v<a)break;for(var y=!1,b=d.length-1;b>=m;--b){var x=Lo(e,g,d[b]);if(x>=r){y=!0;break}if(p.score=p.score*Po(r,f,x),p.score<=a)break}p.suppressBeginIndex=d.length,y||(p.score===v?(d.push(g),h.push(p.score)):p.score>a&&Mo(c,p,jo))}var k=d.length,w=n-k;u&&w>0&&(d.push.apply(d,(0,T.Z)(new Array(w).fill(0))),h.push.apply(h,(0,T.Z)(new Array(w).fill(0))));var _={selectedIndices:d};return o&&(_.selectedScores=h),s&&(_.validOutputs=k),_}function Lo(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),u=Math.max(r[0],r[2]),s=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),f=Math.max(a[0],a[2]),d=Math.max(a[1],a[3]),h=(u-i)*(s-o),p=(f-c)*(d-l);if(h<=0||p<=0)return 0;var v=Math.max(i,c),g=Math.max(o,l),m=Math.min(u,f),y=Math.min(s,d),b=Math.max(m-v,0)*Math.max(y-g,0);return b/(h+p-b)}function Po(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function jo(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function Uo(){return Uo=(0,A.Z)((0,S.Z)().mark((function e(t,n,r){var a,i,o,u,s,c,l,f,d,h,p=arguments;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=p.length>3&&void 0!==p[3]?p[3]:.5,i=p.length>4&&void 0!==p[4]?p[4]:Number.NEGATIVE_INFINITY,o=(0,D._1)(t,"boxes","nonMaxSuppressionAsync"),u=(0,D._1)(n,"scores","nonMaxSuppressionAsync"),s=Fo(o,u,r,a,i),r=s.maxOutputSize,a=s.iouThreshold,i=s.scoreThreshold,e.next=10,Promise.all([o.data(),u.data()]);case 10:return c=e.sent,l=c[0],f=c[1],d=Ro(l,f,r,a,i),h=d.selectedIndices,o!==t&&o.dispose(),u!==n&&u.dispose(),e.abrupt("return",Ri(h,"int32"));case 17:case"end":return e.stop()}}),e)}))),Uo.apply(this,arguments)}var Wo=function(e,t,n){return Uo.apply(this,arguments)};var Vo=(0,qt.op)({nonMaxSuppressionWithScore_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=(0,D._1)(e,"boxes","nonMaxSuppression"),u=(0,D._1)(t,"scores","nonMaxSuppression"),s=Fo(o,u,n,r,a,i),c={boxes:o,scores:u},l={maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:a=s.scoreThreshold,softNmsSigma:i=s.softNmsSigma},f=g.BV.runKernel($t.W0H,c,l);return{selectedIndices:f[0],selectedScores:f[1]}}});function Go(){return Go=(0,A.Z)((0,S.Z)().mark((function e(t,n,r){var a,i,o,u,s,c,l,f,d,h,p,v,g=arguments;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=g.length>3&&void 0!==g[3]?g[3]:.5,i=g.length>4&&void 0!==g[4]?g[4]:Number.NEGATIVE_INFINITY,o=g.length>5&&void 0!==g[5]?g[5]:0,u=(0,D._1)(t,"boxes","nonMaxSuppressionAsync"),s=(0,D._1)(n,"scores","nonMaxSuppressionAsync"),c=Fo(u,s,r,a,i,o),r=c.maxOutputSize,a=c.iouThreshold,i=c.scoreThreshold,o=c.softNmsSigma,e.next=12,Promise.all([u.data(),s.data()]);case 12:return l=e.sent,f=l[0],d=l[1],h=Bo(f,d,r,a,i,o),p=h.selectedIndices,v=h.selectedScores,u!==t&&u.dispose(),s!==n&&s.dispose(),e.abrupt("return",{selectedIndices:Ri(p,"int32"),selectedScores:Ri(v)});case 19:case"end":return e.stop()}}),e)}))),Go.apply(this,arguments)}var qo=function(e,t,n){return Go.apply(this,arguments)};var Ho=(0,qt.op)({nonMaxSuppressionPadded_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=(0,D._1)(e,"boxes","nonMaxSuppression"),u=(0,D._1)(t,"scores","nonMaxSuppression"),s=Fo(o,u,n,r,a,null),c=s.maxOutputSize,l=s.iouThreshold,f=s.scoreThreshold,d={boxes:o,scores:u},h={maxOutputSize:c,iouThreshold:l,scoreThreshold:f,padToMaxOutputSize:i},p=g.BV.runKernel($t.cye,d,h);return{selectedIndices:p[0],validOutputs:p[1]}}});function Xo(){return Xo=(0,A.Z)((0,S.Z)().mark((function e(t,n,r){var a,i,o,u,s,c,l,f,d,h,p,v,g,m,y,b,x=arguments;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=x.length>3&&void 0!==x[3]?x[3]:.5,i=x.length>4&&void 0!==x[4]?x[4]:Number.NEGATIVE_INFINITY,o=x.length>5&&void 0!==x[5]&&x[5],u=(0,D._1)(t,"boxes","nonMaxSuppressionAsync"),s=(0,D._1)(n,"scores","nonMaxSuppressionAsync"),c=Fo(u,s,r,a,i,null),l=c.maxOutputSize,f=c.iouThreshold,d=c.scoreThreshold,e.next=11,Promise.all([u.data(),s.data()]);case 11:return h=e.sent,p=(0,E.Z)(h,2),v=p[0],g=p[1],m=Zo(v,g,l,f,d,o),y=m.selectedIndices,b=m.validOutputs,u!==t&&u.dispose(),s!==n&&s.dispose(),e.abrupt("return",{selectedIndices:Ri(y,"int32"),validOutputs:(0,rt.i)(b,"int32")});case 19:case"end":return e.stop()}}),e)}))),Xo.apply(this,arguments)}var Yo=function(e,t,n){return Xo.apply(this,arguments)},Ko=n(464),$o=n(8600);function Qo(e,t){for(var n,r,a,i,o,u,s=Ri([-1]),c=Ri([0]),l=Ri([0]),f=0;f<e.size-1;f++){n=(0,Kn.t)(e,0,f+1),r=(0,Kn.t)(e,f+1),o=(0,$e.h)((0,Mi.S)(n),t),u=(0,$e.h)((0,Mi.S)(r),t);var d=(0,Mi.S)((0,Qe.d)(n,$a(0,n.size)));a=(0,$e.h)(d,(0,Mi.S)(n));var h=(0,ct.h)(r.shape,n.size),p=(0,Ke.I)($a(0,r.size),h),v=(0,Qe.d)(r,p);i=(0,$e.h)((0,Mi.S)(v),(0,Mi.S)(r));var g=(0,dt.l)(a,i),m=(0,dt.l)(a,i),y=(0,Qe.d)(o,u);l=(0,Qe.d)((0,Qe.d)(y,g),m);var b=(0,Wr.p)(l,c);c=(0,Hi.a)(b,l,c),s=(0,Hi.a)(b,Ri([f]),s)}return s}var Jo=(0,qt.op)({threshold_:function(e){var t,n,r,a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=(0,D._1)(e,"image","threshold"),c=.2989,l=.587,f=.114,d=s.shape[0]*s.shape[1],h=(0,Qe.d)(Ri([u]),255);if(M.hu(3===s.rank,(function(){return"Error in threshold: image must be rank 3,"+"but got rank ".concat(s.rank,".")})),M.hu(3===s.shape[2]||1===s.shape[2],(function(){return"Error in threshold: image color channel must be equal to 3 or 1"+"but got ".concat(s.shape[2],".")})),M.hu("int32"===s.dtype||"float32"===s.dtype,(function(){return"Error in dtype: image dtype must be int32 or float32,"+"but got dtype ".concat(s.dtype,".")})),M.hu("otsu"===i||"binary"===i,(function(){return"Method must be binary or otsu, but was ".concat(i)})),3===s.shape[2]){var p=(0,Ei.V)(s,[1,1,1],-1),v=(0,E.Z)(p,3);t=v[0],n=v[1],r=v[2];var g=(0,Qe.d)(t,c),m=(0,Qe.d)(n,l),y=(0,Qe.d)(r,f);a=(0,Ke.I)((0,Ke.I)(g,m),y)}else a=e;if("otsu"===i){var b=ar((0,We.p)((0,ui.N)(a),"int32"),I([]),256);h=Qo(b,d)}var x=o?(0,$r.z)(a,h):(0,Wr.p)(a,h),k=(0,We.p)((0,Qe.d)(x,255),"int32");return k}});var eu=(0,qt.op)({transform_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0,o=(0,D._1)(e,"image","transform","float32"),u=(0,D._1)(t,"transforms","transform","float32");M.hu(4===o.rank,(function(){return"Error in transform: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),M.hu(2===u.rank&&(u.shape[0]===o.shape[0]||1===u.shape[0])&&8===u.shape[1],(function(){return"Error in transform: Input transform should be batch x 8 or 1 x 8"})),M.hu(null==i||2===i.length,(function(){return"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(i,".")}));var s={image:o,transforms:u},c={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return g.BV.runKernel($t.wx7,s,c)}});var tu=(0,qt.op)({bandPart_:function(e,t,n){(0,M.hu)(t%1===0,(function(){return"bandPart(): numLower must be an integer, got ".concat(t,".")})),(0,M.hu)(n%1===0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")}));var r=(0,D._1)(e,"a","bandPart");(0,M.hu)(r.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")}));var a=r.shape,i=r.shape.slice(-2),o=(0,E.Z)(i,2),u=o[0],s=o[1];if(!(t<=u))throw new Error("bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(u,")."));if(!(n<=s))throw new Error("bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(s,")."));t<0&&(t=u),n<0&&(n=s);var c=(0,qn.X)($a(0,u,1,"int32"),[-1,1]),l=$a(0,s,1,"int32"),f=(0,dt.l)(c,l),d=(0,ia.H)((0,$r.z)(f,(0,rt.i)(+t,"int32")),(0,Vr.b)(f,(0,rt.i)(-n,"int32"))),h=(0,$i.l)([u,s],r.dtype);return(0,qn.X)((0,Di.k)((0,Vi.H)((0,qn.X)(r,[-1,u,s])).map((function(e){return(0,Hi.a)(d,e,h)}))),a)}});var nu=(0,qt.op)({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,(0,M.hu)(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){(0,M.hu)(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")")}))},a=1;a<e.length;++a)r(a)}else t=!0,e=(0,Ei.V)(e,e.shape[0],0).map((function(e){return(0,Ni.L)(e,[0])}));(0,M.hu)(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],").")}));for(var i=[],o=e,u=function(e){i.push(g.BV.tidy((function(){var t=o[e];if(e>0)for(var n=0;n<e;++n){var r=(0,Qe.d)((0,Mi.S)((0,Qe.d)(i[n],t)),i[n]);t=(0,dt.l)(t,r)}return(0,$e.h)(t,(0,eo.K)(t,"euclidean"))})))},s=0;s<e.length;++s)u(s);return t?(0,Di.k)(i,0):i}});function ru(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return g.BV.tidy((function(){(0,M.hu)(2===e.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor.")}));for(var n=e.shape[0],r=e.shape[1],a=Lr(n),i=(0,Ve.d)(e),o=Zi([[1]],[1,1]),u=(0,Ve.d)(o),s=n>=r?r:n,c=function(e){var t=i,s=u,c=a,l=g.BV.tidy((function(){var t=(0,Kn.t)(i,[e,e],[n-e,1]),s=(0,eo.K)(t),c=(0,Kn.t)(i,[e,e],[1,1]),l=(0,Hi.a)((0,Wr.p)(c,0),Zi([[-1]]),Zi([[1]])),f=(0,dt.l)(c,(0,Qe.d)(l,s)),d=(0,$e.h)(t,f);u=1===d.shape[0]?(0,Ve.d)(o):(0,Xn.z)([o,(0,Kn.t)(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);var h=(0,Ea.W)((0,$e.h)((0,Vt.O)(l,f),s)),p=(0,Kn.t)(i,[e,0],[n-e,r]),v=(0,Qe.d)(h,u),g=(0,Ht.p)(u);if(0===e)i=(0,dt.l)(p,(0,Vt.O)(v,(0,Vt.O)(g,p)));else{var m=(0,dt.l)(p,(0,Vt.O)(v,(0,Vt.O)(g,p)));i=(0,Xn.z)([(0,Kn.t)(i,[0,0],[e,r]),m],0)}var y=(0,Ht.p)(v),b=(0,Kn.t)(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=(0,dt.l)(b,(0,Vt.O)((0,Vt.O)(b,u),y));else{var x=(0,dt.l)(b,(0,Vt.O)((0,Vt.O)(b,u),y));a=(0,Xn.z)([(0,Kn.t)(a,[0,0],[n,e]),x],1)}return[u,i,a]})),f=(0,E.Z)(l,3);u=f[0],i=f[1],a=f[2],(0,Ye.B9)([t,s,c])},l=0;l<s;++l)c(l);return!t&&n>r&&(a=(0,Kn.t)(a,[0,0],[n,r]),i=(0,Kn.t)(i,[0,0],[r,r])),[a,i]}))}var au,iu=(0,qt.op)({qr_:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((0,M.hu)(e.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)})),2===e.rank)return ru(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=(0,Vi.H)((0,qn.X)(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];r.forEach((function(e){var n=ru(e,t),r=(0,E.Z)(n,2),o=r[0],u=r[1];a.push(o),i.push(u)}));var o=(0,qn.X)((0,Di.k)(a,0),e.shape),u=(0,qn.X)((0,Di.k)(i,0),e.shape);return[o,u]}});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(au||(au={}));var ou=(0,qt.op)({computeWeightedLoss_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:au.SUM_BY_NONZERO_WEIGHTS,r=(0,D._1)(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=(0,D._1)(t,"weights","computeWeightedLoss"));var i=null==a?r:(0,Qe.d)(r,a);if(n===au.NONE)return i;if(n===au.SUM)return(0,Mi.S)(i);if(n===au.MEAN){if(null==a)return(0,ga.J)(i);var o=r.size/a.size,u=(0,$e.h)((0,Mi.S)(i),(0,Mi.S)(a));return o>1?(0,$e.h)(u,(0,rt.i)(o)):u}if(n===au.SUM_BY_NONZERO_WEIGHTS){if(null==a)return(0,$e.h)((0,Mi.S)(i),(0,rt.i)(r.size));var s=(0,Qe.d)(a,(0,ma.i)(r.shape)),c=(0,We.p)((0,Mi.S)((0,Ta.Q)(s,(0,rt.i)(0))),"float32");return(0,$e.h)((0,Mi.S)(i),c)}throw Error("Unknown reduction: ".concat(n))}});var uu=(0,qt.op)({absoluteDifference_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:au.SUM_BY_NONZERO_WEIGHTS,a=(0,D._1)(e,"labels","absoluteDifference"),i=(0,D._1)(t,"predictions","absoluteDifference"),o=null;null!=n&&(o=(0,D._1)(n,"weights","absoluteDifference")),(0,M.k5)(a.shape,i.shape,"Error in absoluteDifference: ");var u=(0,pt.W)((0,dt.l)(a,i));return ou(u,o,r)}});var su=(0,qt.op)({cosineDistance_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:au.SUM_BY_NONZERO_WEIGHTS,i=(0,D._1)(e,"labels","cosineDistance"),o=(0,D._1)(t,"predictions","cosineDistance"),u=null;null!=r&&(u=(0,D._1)(r,"weights","cosineDistance")),(0,M.k5)(i.shape,o.shape,"Error in cosineDistance: ");var s=(0,rt.i)(1),c=(0,dt.l)(s,(0,Mi.S)((0,Qe.d)(i,o),n,!0));return ou(c,u,a)}});var cu=(0,qt.op)({hingeLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:au.SUM_BY_NONZERO_WEIGHTS,a=(0,D._1)(e,"labels","hingeLoss"),i=(0,D._1)(t,"predictions","hingeLoss"),o=null;null!=n&&(o=(0,D._1)(n,"weights","hingeLoss")),(0,M.k5)(a.shape,i.shape,"Error in hingeLoss: ");var u=(0,rt.i)(1);a=(0,dt.l)((0,Qe.d)((0,rt.i)(2),a),u);var s=(0,ei.U)((0,dt.l)(u,(0,Qe.d)(a,i)));return ou(s,o,r)}});var lu=(0,qt.op)({huberLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:au.SUM_BY_NONZERO_WEIGHTS,i=(0,D._1)(e,"labels","huberLoss"),o=(0,D._1)(t,"predictions","huberLoss"),u=null;null!=n&&(u=(0,D._1)(n,"weights","huberLoss")),(0,M.k5)(i.shape,o.shape,"Error in huberLoss: ");var s=(0,rt.i)(r),c=(0,pt.W)((0,dt.l)(o,i)),l=(0,xa.L)(c,s),f=(0,dt.l)(c,l),d=(0,Ke.I)((0,Qe.d)((0,rt.i)(.5),(0,et.h)(l)),(0,Qe.d)(s,f));return ou(d,u,a)}});var fu=(0,qt.op)({logLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:au.SUM_BY_NONZERO_WEIGHTS,i=(0,D._1)(e,"labels","logLoss"),o=(0,D._1)(t,"predictions","logLoss"),u=null;null!=n&&(u=(0,D._1)(n,"weights","logLoss")),(0,M.k5)(i.shape,o.shape,"Error in logLoss: ");var s=(0,rt.i)(1),c=(0,rt.i)(r),l=(0,Ea.W)((0,Qe.d)(i,(0,ea.c)((0,Ke.I)(o,c)))),f=(0,Qe.d)((0,dt.l)(s,i),(0,ea.c)((0,Ke.I)((0,dt.l)(s,o),c))),d=(0,dt.l)(l,f);return ou(d,u,a)}});var du=(0,qt.op)({meanSquaredError_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:au.SUM_BY_NONZERO_WEIGHTS,a=(0,D._1)(e,"labels","meanSquaredError"),i=(0,D._1)(t,"predictions","meanSquaredError"),o=null;null!=n&&(o=(0,D._1)(n,"weights","meanSquaredError")),(0,M.k5)(a.shape,i.shape,"Error in meanSquaredError: ");var u=(0,Ti.$)(a,i);return ou(u,o,r)}});function hu(e,t){var n=(0,D._1)(e,"labels","sigmoidCrossEntropyWithLogits"),r=(0,D._1)(t,"logits","sigmoidCrossEntropyWithLogits");(0,M.k5)(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var a=(0,ei.U)(r),i=(0,Qe.d)(r,n),o=(0,ta.K)((0,Rr.Q)((0,Ea.W)((0,pt.W)(r))));return(0,Ke.I)((0,dt.l)(a,i),o)}var pu=(0,qt.op)({sigmoidCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:au.SUM_BY_NONZERO_WEIGHTS,i=(0,D._1)(e,"multiClassLabels","sigmoidCrossEntropy"),o=(0,D._1)(t,"logits","sigmoidCrossEntropy"),u=null;if(null!=n&&(u=(0,D._1)(n,"weights","sigmoidCrossEntropy")),(0,M.k5)(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var s=(0,rt.i)(r),c=(0,rt.i)(1),l=(0,rt.i)(.5);i=(0,Ke.I)((0,Qe.d)(i,(0,dt.l)(c,s)),(0,Qe.d)(l,s))}var f=hu(i,o);return ou(f,u,a)}});function vu(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(t.rank," ")+"and dim was ".concat(n));var r=(0,nt.cb)((function(e,t,r){var a=(0,aa.l)(t,[n],!0),i=(0,dt.l)((0,We.p)(t,"float32"),a);r([e,i]);var o=(0,Ea.W)((0,Qe.d)(i,e));return{value:(0,Mi.S)(o,[n]),gradFunc:function(e,t){var r=(0,E.Z)(t,2),a=r[0],i=r[1],o=(0,_a.rv)(e.shape,[n]);return[(0,Qe.d)((0,qn.X)(e,o),(0,dt.l)((0,We.p)(a,"float32"),(0,Rr.Q)(i))),(0,Qe.d)((0,qn.X)(e,o),(0,dt.l)((0,Rr.Q)(i),(0,We.p)(a,"float32")))]}}}));return r(e,t)}var gu=(0,qt.op)({softmaxCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:au.SUM_BY_NONZERO_WEIGHTS,i=(0,D._1)(e,"onehotLabels","softmaxCrossEntropy"),o=(0,D._1)(t,"logits","softmaxCrossEntropy"),u=null;if(null!=n&&(u=(0,D._1)(n,"weights","softmaxCrossEntropy")),(0,M.k5)(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var s=(0,rt.i)(r),c=(0,rt.i)(1),l=(0,rt.i)(i.shape[1]);i=(0,Ke.I)((0,Qe.d)(i,(0,dt.l)(c,s)),(0,$e.h)(s,l))}var f=vu(i,o);return ou(f,u,a)}});var mu=(0,qt.op)({sparseFillEmptyRows_:function(e,t,n,r){var a=(0,D._1)(e,"indices","sparseFillEmptyRows","int32"),i=(0,D._1)(t,"values","sparseFillEmptyRows"),o=(0,D._1)(n,"denseShape","sparseFillEmptyRows","int32"),u=(0,D._1)(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(2!==a.rank)throw new Error("Indices should be Tensor2D but received shape\n        ".concat(a.shape));if(1!==i.rank)throw new Error("Values should be Tensor1D but received shape ".concat(i.shape));if(1!==o.rank)throw new Error("Dense shape should be Tensor1D but received shape ".concat(o.shape));if(0!==u.rank)throw new Error("Default value should be a scalar but received shape ".concat(u.shape));var s={indices:a,values:i,denseShape:o,defaultValue:u},c=g.BV.runKernel($t.O3z,s);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}});var yu=(0,qt.op)({sparseReshape_:function(e,t,n){var r=(0,D._1)(e,"inputIndices","sparseReshape","int32"),a=(0,D._1)(t,"inputShape","sparseReshape","int32"),i=(0,D._1)(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        ".concat(r.shape));if(1!==a.rank)throw new Error("Input shape should be Tensor1D but received shape ".concat(a.shape));if(1!==i.rank)throw new Error("New shape should be Tensor1D but received shape ".concat(i.shape));var o={inputIndices:r,inputShape:a,newShape:i},u=g.BV.runKernel($t.nhH,o);return{outputIndices:u[0],outputShape:u[1]}}});var bu=(0,qt.op)({sparseSegmentMean_:function(e,t,n){var r=(0,D._1)(e,"data","sparseSegmentMean"),a=(0,D._1)(t,"indices","sparseSegmentMean","int32"),i=(0,D._1)(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n          ".concat(a.shape));if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          ".concat(i.shape));var o={data:r,indices:a,segmentIds:i};return g.BV.runKernel($t.w3H,o)}});var xu=(0,qt.op)({sparseSegmentSum_:function(e,t,n){var r=(0,D._1)(e,"data","sparseSegmentSum"),a=(0,D._1)(t,"indices","sparseSegmentSum","int32"),i=(0,D._1)(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n         ".concat(a.shape));if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         ".concat(i.shape));var o={data:r,indices:a,segmentIds:i};return g.BV.runKernel($t.ZjV,o)}});var ku=(0,qt.op)({stringNGrams_:function(e,t,n,r,a,i,o,u){var s=(0,D._1)(e,"data","stringNGrams","string");if("string"!==s.dtype)throw new Error("Data must be of datatype string");if(1!==s.shape.length)throw new Error("Data must be a vector, saw: ".concat(s.shape));var c=(0,D._1)(t,"dataSplits","stringNGrams");if("int32"!==c.dtype)throw new Error("Data splits must be of datatype int32");var l={separator:n,nGramWidths:r,leftPad:a,rightPad:i,padWidth:o,preserveShortSequences:u},f={data:s,dataSplits:c},d=g.BV.runKernel($t._JP,f,l);return{nGrams:d[0],nGramsSplits:d[1]}}});var wu=(0,qt.op)({stringSplit_:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=(0,D._1)(e,"input","stringSplit","string"),a=(0,D._1)(t,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape ".concat(r.shape));if(0!==a.rank)throw new Error("Delimiter should be a scalar but received shape ".concat(a.shape));var i={skipEmpty:n},o={input:r,delimiter:a},u=g.BV.runKernel($t.s1s,o,i);return{indices:u[0],values:u[1],shape:u[2]}}});var _u,Cu=(0,qt.op)({stringToHashBucketFast_:function(e,t){var n=(0,D._1)(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");var a={input:n};return g.BV.runKernel($t.XkS,a,r)}}),Su={fft:_i.k,ifft:Ci.S,rfft:Ai.Q,irfft:Si.w},Au={hammingWindow:_o,hannWindow:Co,frame:So,stft:Ao},Eu={flipLeftRight:To,grayscaleToRGB:No,resizeNearestNeighbor:$o.j,resizeBilinear:Ko.I,rotateWithOffset:Do,cropAndResize:Eo,nonMaxSuppression:Io,nonMaxSuppressionAsync:Wo,nonMaxSuppressionWithScore:Vo,nonMaxSuppressionWithScoreAsync:qo,nonMaxSuppressionPadded:Ho,nonMaxSuppressionPaddedAsync:Yo,threshold:Jo,transform:eu},Tu={bandPart:tu,gramSchmidt:nu,qr:iu},Nu={absoluteDifference:uu,computeWeightedLoss:ou,cosineDistance:su,hingeLoss:cu,huberLoss:lu,logLoss:fu,meanSquaredError:du,sigmoidCrossEntropy:pu,softmaxCrossEntropy:gu},Du={sparseFillEmptyRows:mu,sparseReshape:yu,sparseSegmentMean:bu,sparseSegmentSum:xu},Fu={stringNGrams:ku,stringSplit:wu,stringToHashBucketFast:Cu},Iu=Dn,Mu="undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:function(e){return e()};function Ou(){return new Promise((function(e){return Mu((function(){return e()}))}))}function Ru(e,t){var n=e[0].length;e.forEach((function(e,t){M.hu(e.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),M.hu(t>=0&&t<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=e[0];e.forEach((function(e,a){for(var i=0;i<n;i++)M.hu(i===t||e[i]===r[i],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,".")}))}))}function Zu(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function Bu(e,t,n){var r=new Array;if(null==n&&null==t)return r;if(null==t)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(null==n)return r;if(e+n.length!==r.length)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.rank = ").concat(e+n.length,", but shape.rank = ").concat(r.length));for(var a=1;a<n.length;++a){var i=n[a],o=r[r.length-n.length+a],u=r[o];if(i>=0)if(u>=0){if(u!==i)throw new Error("rt input.shape and shape=".concat(t," are incompatible: rt input.shape[").concat(a+e,"] = ").concat(i," but shape[").concat(a+e,"] = ").concat(u))}else r[o]=i}return r}function zu(e){var t,n={FIRST_DIM_SIZE:_u.FIRST_DIM_SIZE,VALUE_ROWIDS:_u.VALUE_ROWIDS,ROW_LENGTHS:_u.ROW_LENGTHS,ROW_SPLITS:_u.ROW_SPLITS,ROW_LIMITS:_u.ROW_LIMITS,ROW_STARTS:_u.ROW_STARTS},r=[],a=(0,C.Z)(e);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(!(i in n))break;r.push(n[i])}}catch(zs){a.e(zs)}finally{a.f()}return r}function Lu(e){return 0===e.length?0:e[0]===_u.FIRST_DIM_SIZE?e.length-1:e.length}function Pu(e,t){if(null!=e&&null!=t){var n=e.length,r=t.length;if(n>=r)throw new Error("defaultValue.shape=".concat(e," and ragged tensor flatValues.shape=").concat(t,", are incompatible: defaultValue.rank = ").concat(n," must be less than ragged tensor input flatValues.rank = ").concat(r,")"));for(var a=0;a<Math.min(n,r-1);++a){var i=e[a],o=t[a+1];if(i>=0&&o>=0&&1!==i&&i!==o)throw new Error("defaultValue.shape=".concat(e,", and ragged tensor input flatValues.shape=").concat(t," are incompatible: defaultValue.shape[").concat(a-e.length,"] = ").concat(i," but ragged tensor input.flatValues.shape[").concat(a-e.length,"] = ").concat(o))}}}!function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"}(_u||(_u={}));var ju=30;function Uu(e){return e<=ju?e:(0,M.jP)(e,Math.floor(Math.sqrt(e)))}function Wu(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function Vu(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];if(r)(a=a.concat(t.slice(0))).push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);for(var i=t.length,o=0;o<i;++o)a=a.concat([e[o+1]/t[o],t[o]]);a=a.concat(e.slice(i+1))}return a}function Gu(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];if(n){r.push(t);for(var a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{for(var i=[],o=[],u=1;u<e;++u)u>=2*t+1||u%2===1?o.push(u):i.push(u);r.push.apply(r,i),r.push(0),r.push.apply(r,o)}return r}function qu(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function Hu(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function Xu(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}var Yu=n(349),Ku=.3275911,$u=.254829592,Qu=-.284496736,Ju=1.421413741,es=-1.453152027,ts=1.061405429,ns=n(7269);function rs(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function as(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function is(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function os(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function us(e,t){return{real:e[2*t],imag:e[2*t+1]}}function ss(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function cs(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),a=0;a<Math.ceil(e/2);a++){var i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function ls(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}var fs="->",ds=/->/g;function hs(e,t){var n=((e=e.replace(/\s/g,"")).length-e.replace(ds,"").length)/fs.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("'.concat(fs,'").'));var r=e.split(fs),a=(0,E.Z)(r,2),i=a[0],o=a[1];(0,M.hu)(-1===i.indexOf("..."),(function(){return'The ellipsis notation ("'.concat("...",'") is not supported yet.')}));var u=i.split(","),s=u.length;if(t!==s)throw new Error("Expected ".concat(s," input tensors, received ").concat(t));if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");for(var c=[],l=function(){var e=o[f];if(!u.some((function(t){return-1!==t.indexOf(e)})))throw new Error("Output subscripts contain the label ".concat(e," ")+"not present in the input subscripts.");-1===c.indexOf(e)&&c.push(e)},f=0;f<o.length;++f)l();for(var d=0;d<i.length;++d){var h=i[d];-1===c.indexOf(h)&&","!==h&&c.push(h)}for(var p=new Array(u.length),v=0;v<s;++v){if(new Set(u[v].split("")).size!==u[v].length)throw new Error("Found duplicate axes in input component ".concat(u[v],". ")+"Support for duplicate axes in input is not implemented yet.");p[v]=[];for(var g=0;g<u[v].length;++g)p[v].push(c.indexOf(u[v][g]))}for(var m=c.length,y=[],b=o.length;b<m;++b)y.push(b);return{allDims:c,summedDims:y,idDims:p}}function ps(e,t){var n=new Array(e);n.fill(-1);for(var r=0;r<t.length;++r)n[t[r]]=r;for(var a=[],i=0;i<e;++i)-1===n[i]&&a.push(i);return{permutationIndices:n=n.filter((function(e){return-1!==e})),expandDims:a}}function vs(e,t,n){for(var r=new Array(e),a=function(e){for(var a=n[e].shape,i=function(n){void 0===r[t[e][n]]?r[t[e][n]]=a[n]:(0,M.hu)(r[t[e][n]]===a[n],(function(){return"Expected dimension ".concat(r[t[e][n]]," at axis ").concat(n," ")+"of input shaped ".concat(JSON.stringify(a),", ")+"but got dimension ".concat(a[n])}))},o=0;o<t[e].length;++o)i(o)},i=0;i<n.length;++i)a(i)}function gs(e,t){var n,r=e,a=[];0===e.length&&r.push(-1),n=e.length+1;for(var i=0;i<n;++i)a.push([]);for(var o=[],u=0;u<r.length;++u){var s,c=ys(t,r[u]),l=(0,C.Z)(c);try{for(l.s();!(s=l.n()).done;){var f=s.value;-1===o.indexOf(f)&&(a[u].push(f),o.push(f))}}catch(zs){l.e(zs)}finally{l.f()}}return{path:r,steps:a}}function ms(e){return e.every((function(e,t){return e===t}))}function ys(e,t){for(var n=[],r=0;r<e.length;++r)0!==e[r].length&&-1===e[r].indexOf(t)&&-1!==t||n.push(r);return n}function bs(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)(0,M.hu)(e.shape[n]%t===0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(e.shape[n]/t);else{var a=t.reduce((function(e,t){return-1===t&&(e+=1),e}),0);(0,M.hu)(a<=1,(function(){return"There should be only one negative value in split array."}));var i=t.indexOf(-1);if(-1!==i){var o=t.reduce((function(e,t){return t>0?e+t:e}));t[i]=e.shape[n]-o}(0,M.hu)(e.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t}return r}function xs(e){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ".concat(e)}function ks(e,t){return"indices(".concat(e,", 0) is invalid: ").concat(t," < 0")}function ws(e,t,n){return"indices(".concat(e,", 0) is invalid: ").concat(t," >= ").concat(n)}function _s(e,t){return"only one output dimension may be -1, not both ".concat(e," and ").concat(t)}function Cs(e,t){return"size ".concat(e," must be non-negative, not ").concat(t)}function Ss(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function As(e,t){var n=(0,M.NA)(e),r=(0,M.NA)(t);return"Input to reshape is a SparseTensor with ".concat(n,"\n  dense values, but the requested shape requires a multiple of ").concat(r,". inputShape=").concat(e," outputShape= ").concat(t)}function Es(e,t){var n=(0,M.NA)(e),r=(0,M.NA)(t);return"Input to reshape is a tensor with ".concat(n," dense values, but the requested shape has ").concat(r,". inputShape=").concat(e," outputShape=").concat(t)}function Ts(){return"segment ids must be >= 0"}function Ns(){return"segment ids are not increasing"}function Ds(e,t){return"Segment id ".concat(e," out of range [0, ").concat(t,"), possibly because segmentIds input is not sorted.")}function Fs(e,t,n){return"Bad: indices[".concat(e,"] == ").concat(t," out of range [0, ").concat(n,")")}function Is(e,t){var n,r=!1;for(e<=ju?(n=e,r=!0):n=(0,M.jP)(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=(0,M.jP)(e,n+1);return n}function Ms(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}function Os(e,t,n,r){var a=t.shape.length,i=e.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>i)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(i,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(var o=0;o<r;++o)if(e.shape[o]!==t.shape[o])throw new Error("x.shape[".concat(o,"]: ").concat(e.shape[o]," should be equal to indices.shape[").concat(o,"]: ").concat(t.shape[o],"."));for(var u=e.shape[n],s=[],c=1,l=1,f=1,d=0;d<r;++d)s.push(e.shape[d]),c*=e.shape[d];for(var h=r;h<n;h++)s.push(e.shape[h]),l*=e.shape[h];for(var p=r;p<a;p++)s.push(t.shape[p]);for(var v=n+1;v<i;v++)s.push(e.shape[v]),f*=e.shape[v];return{batchSize:c,sliceSize:f,outerSize:l,dimSize:u,outputShape:s}}function Rs(e){try{return e.map((function(e){return(0,pn.decodeString)(e)}))}catch(zs){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(zs))}}function Zs(e){return e.map((function(e){return(0,pn.encodeString)(e)}))}var Bs=n(4679);!function(){var e,t=(0,C.Z)(xt);try{for(t.s();!(e=t.n()).done;){ot(e.value)}}catch(zs){t.e(zs)}finally{t.f()}}()},2145:function(e,t,n){"use strict";n.d(t,{$HU:function(){return vt},$g6:function(){return J},$w:function(){return X},Acj:function(){return ge},BMI:function(){return ze},BiW:function(){return dt},Byc:function(){return P},CAk:function(){return Se},CQl:function(){return ft},D2d:function(){return Gt},DlI:function(){return ct},Eh3:function(){return F},FKq:function(){return Zt},G3Y:function(){return an},GBy:function(){return Bt},Gcp:function(){return Pt},HEU:function(){return te},HZH:function(){return mt},Hhh:function(){return Ze},Hmb:function(){return bt},IKK:function(){return c},IMb:function(){return x},J$2:function(){return _e},J_u:function(){return be},JhU:function(){return m},Kgp:function(){return ot},L8s:function(){return Lt},Ly9:function(){return C},M2y:function(){return d},MIZ:function(){return en},MRv:function(){return Rt},MZg:function(){return Fe},NEP:function(){return ae},NZg:function(){return Ye},O3z:function(){return jt},OAf:function(){return je},OR:function(){return le},OU7:function(){return Ue},OV7:function(){return Pe},Omj:function(){return ne},Oyi:function(){return v},PYm:function(){return Ne},PhF:function(){return Tt},QCc:function(){return g},QRR:function(){return W},Qg5:function(){return ye},QiL:function(){return at},Qvg:function(){return sn},RFZ:function(){return A},ROF:function(){return y},RQH:function(){return Ft},RuY:function(){return ln},SX0:function(){return ee},SYM:function(){return r},SbG:function(){return wt},SpW:function(){return i},T0n:function(){return V},TQc:function(){return zt},TR1:function(){return L},ToN:function(){return un},Tr8:function(){return Qt},Uyb:function(){return ce},VGw:function(){return a},Vbg:function(){return Xe},VcC:function(){return U},VfG:function(){return De},Vn9:function(){return $},W0H:function(){return tt},XDQ:function(){return cn},XLW:function(){return k},XkS:function(){return $t},Xze:function(){return u},Y0y:function(){return oe},YFo:function(){return ie},YoZ:function(){return Be},ZbH:function(){return Ee},ZjV:function(){return Vt},Zz9:function(){return N},_JP:function(){return Yt},_V0:function(){return vn},_Yw:function(){return xt},_k9:function(){return b},_tC:function(){return qt},a5O:function(){return Ot},aJk:function(){return f},avt:function(){return xe},b9H:function(){return hn},bK0:function(){return Ht},bV0:function(){return St},c17:function(){return Ge},cWu:function(){return nn},cie:function(){return G},cye:function(){return et},dDz:function(){return lt},deh:function(){return se},dpD:function(){return yt},e07:function(){return Ct},e6w:function(){return ht},e7N:function(){return Ae},eBW:function(){return dn},eEB:function(){return S},eZ0:function(){return Re},ekb:function(){return K},gJX:function(){return E},h8e:function(){return fn},hdR:function(){return re},i5y:function(){return Mt},iHb:function(){return j},iJz:function(){return me},iWB:function(){return ke},iZT:function(){return ve},ik2:function(){return B},jMg:function(){return p},jQk:function(){return Xt},jQs:function(){return He},jeX:function(){return fe},kU:function(){return Te},kpP:function(){return on},kuV:function(){return $e},luS:function(){return gn},lyA:function(){return it},mKl:function(){return _t},mTV:function(){return Le},mc4:function(){return z},mhS:function(){return I},mm_:function(){return o},n9L:function(){return tn},nhH:function(){return Ut},nr8:function(){return Et},o0g:function(){return st},o2y:function(){return Z},oFR:function(){return Nt},oHH:function(){return Q},oT6:function(){return s},p2w:function(){return Dt},p4S:function(){return Y},pe_:function(){return ut},q1x:function(){return pe},q2K:function(){return Ve},q8u:function(){return qe},qCd:function(){return Me},qIC:function(){return Oe},qWM:function(){return nt},qi_:function(){return he},qkr:function(){return gt},qw7:function(){return h},r7n:function(){return we},s1s:function(){return Kt},sEM:function(){return Jt},sHE:function(){return de},sJF:function(){return l},sL$:function(){return q},usg:function(){return pn},uv1:function(){return Je},vFR:function(){return We},vtC:function(){return Ce},vwp:function(){return ue},w3H:function(){return Wt},w6g:function(){return Ie},wUP:function(){return M},wYB:function(){return It},wYn:function(){return Ke},we_:function(){return rt},wm:function(){return O},wx7:function(){return rn},x12:function(){return R},xJR:function(){return pt},xQA:function(){return At},xnO:function(){return T},y7R:function(){return H},yQU:function(){return Qe},yj2:function(){return D},zbQ:function(){return kt},zvY:function(){return _},zws:function(){return w}});var r="Abs",a="Acos",i="Acosh",o="Add",u="AddN",s="All",c="Any",l="ArgMax",f="ArgMin",d="Asin",h="Asinh",p="Atan",v="Atanh",g="Atan2",m="AvgPool",y="AvgPoolGrad",b="AvgPool3D",x="AvgPool3DGrad",k="BatchMatMul",w="BatchToSpaceND",_="Bincount",C="BroadcastTo",S="BroadcastArgs",A="Cast",E="Ceil",T="ClipByValue",N="Complex",D="ComplexAbs",F="Concat",I="Conv2D",M="Conv2DBackpropFilter",O="Conv2DBackpropInput",R="Conv3D",Z="Conv3DBackpropFilterV2",B="Conv3DBackpropInputV2",z="Cos",L="Cosh",P="Cumprod",j="Cumsum",U="CropAndResize",W="DenseBincount",V="DepthToSpace",G="DepthwiseConv2dNative",q="DepthwiseConv2dNativeBackpropFilter",H="DepthwiseConv2dNativeBackpropInput",X="Diag",Y="Dilation2D",K="Dilation2DBackpropInput",$="Dilation2DBackpropFilter",Q="RealDiv",J="Einsum",ee="Elu",te="EluGrad",ne="Erf",re="Equal",ae="Exp",ie="ExpandDims",oe="Expm1",ue="FFT",se="Fill",ce="FlipLeftRight",le="Floor",fe="FloorDiv",de="FusedBatchNorm",he="GatherV2",pe="GatherNd",ve="Greater",ge="GreaterEqual",me="Identity",ye="IFFT",be="Imag",xe="IsFinite",ke="IsInf",we="IsNan",_e="LeakyRelu",Ce="Less",Se="LessEqual",Ae="LinSpace",Ee="Log",Te="Log1p",Ne="LogicalAnd",De="LogicalNot",Fe="LogicalOr",Ie="LogicalXor",Me="LogSoftmax",Oe="LowerBound",Re="LRN",Ze="LRNGrad",Be="Max",ze="Maximum",Le="MaxPool",Pe="MaxPoolGrad",je="MaxPool3D",Ue="MaxPool3DGrad",We="MaxPoolWithArgmax",Ve="Mean",Ge="Min",qe="Minimum",He="MirrorPad",Xe="Mod",Ye="Multinomial",Ke="Multiply",$e="Neg",Qe="NotEqual",Je="NonMaxSuppressionV3",et="NonMaxSuppressionV4",tt="NonMaxSuppressionV5",nt="OnesLike",rt="OneHot",at="Pack",it="PadV2",ot="Pool",ut="Pow",st="Prelu",ct="Prod",lt="RaggedGather",ft="RaggedRange",dt="RaggedTensorToTensor",ht="Range",pt="Real",vt="Reciprocal",gt="Relu",mt="Reshape",yt="ResizeNearestNeighbor",bt="ResizeNearestNeighborGrad",xt="ResizeBilinear",kt="ResizeBilinearGrad",wt="Relu6",_t="Reverse",Ct="Round",St="Rsqrt",At="ScatterNd",Et="SearchSorted",Tt="Select",Nt="Selu",Dt="Slice",Ft="Sin",It="Sinh",Mt="Sign",Ot="Sigmoid",Rt="Softplus",Zt="Sqrt",Bt="Sum",zt="SpaceToBatchND",Lt="SplitV",Pt="Softmax",jt="SparseFillEmptyRows",Ut="SparseReshape",Wt="SparseSegmentMean",Vt="SparseSegmentSum",Gt="SparseToDense",qt="SquaredDifference",Ht="Square",Xt="StridedSlice",Yt="StringNGrams",Kt="StringSplit",$t="StringToHashBucketFast",Qt="Sub",Jt="Tan",en="Tanh",tn="Tile",nn="TopK",rn="Transform",an="Transpose",on="Unique",un="Unpack",sn="UnsortedSegmentSum",cn="UpperBound",ln="ZerosLike",fn="Step",dn="FromPixels",hn="RotateWithOffset",pn="_FusedMatMul",vn="FusedConv2D",gn="FusedDepthwiseConv2D"},8864:function(e,t,n){"use strict";n.d(t,{Li:function(){return h},T3:function(){return g},bt:function(){return v},nE:function(){return p},pI:function(){return c},tr:function(){return f},uk:function(){return l},wC:function(){return d}});var r=n(9439),a=n(5050),i=n(6581),o=n(7269),u=(0,i.R)("kernelRegistry",(function(){return new Map})),s=(0,i.R)("gradRegistry",(function(){return new Map}));function c(e,t){var n=m(e,t);return u.get(n)}function l(e){return s.get(e)}function f(e){for(var t=u.entries(),n=[];;){var a=t.next(),i=a.done,o=a.value;if(i)break;var s=(0,r.Z)(o,2),c=s[0],l=s[1],f=c.split("_");(0,r.Z)(f,1)[0]===e&&n.push(l)}return n}function d(e){var t=e.kernelName,n=e.backendName,r=m(t,n);u.has(r)&&o.Z("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),u.set(r,e)}function h(e){var t=e.kernelName;s.has(t)&&(0,a.OB)().getBool("DEBUG")&&o.Z("Overriding the gradient for '".concat(t,"'")),s.set(t,e)}function p(e,t){var n=m(e,t);if(!u.has(n))throw new Error("The kernel '".concat(e,"' for backend ")+"'".concat(t,"' is not registered"));u.delete(n)}function v(e){if(!s.has(e))throw new Error("The gradient '".concat(e,"' for backend is not registered"));s.delete(e)}function g(e,t){f(e).forEach((function(e){d(Object.assign({},e,{backendName:t}))}))}function m(e,t){return"".concat(t,"_").concat(e)}},7269:function(e,t,n){"use strict";n.d(t,{Z:function(){return a},c:function(){return i}});var r=n(5050);function a(){var e;(0,r.OB)().getBool("IS_TEST")||(0,r.OB)().getBool("PROD")||(e=console).warn.apply(e,arguments)}function i(){var e;(0,r.OB)().getBool("IS_TEST")||(0,r.OB)().getBool("PROD")||(e=console).log.apply(e,arguments)}},7613:function(e,t,n){"use strict";n.d(t,{W:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({abs_:function(e){var t=(0,i._1)(e,"x","abs");if("complex64"===t.dtype){var n={x:t};return r.BV.runKernel(a.yj2,n)}var o={x:t};return r.BV.runKernel(a.SYM,o)}})},1719:function(e,t,n){"use strict";n.d(t,{K:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({acos_:function(e){var t={x:(0,i._1)(e,"x","acos")};return r.BV.runKernel(a.VGw,t)}})},4502:function(e,t,n){"use strict";n.d(t,{_:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({acosh_:function(e){var t={x:(0,i._1)(e,"x","acosh")};return r.BV.runKernel(a.SpW,t)}})},3312:function(e,t,n){"use strict";n.d(t,{I:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354);var s=(0,n(8640).op)({add_:function(e,t){var n=(0,u._1)(e,"a","add"),s=(0,u._1)(t,"b","add"),c=(0,o.makeTypesMatch)(n,s),l=(0,r.Z)(c,2),f={a:n=l[0],b:s=l[1]};return a.BV.runKernel(i.mm_,f)}})},4108:function(e,t,n){"use strict";n.d(t,{$:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({all_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(0,i._1)(e,"x","all","bool"),u={x:o},s={axis:t,keepDims:n};return r.BV.runKernel(a.oT6,u,s)}})},8543:function(e,t,n){"use strict";n.d(t,{Y:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({any_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(0,i._1)(e,"x","any","bool"),u={x:o},s={axis:t,keepDims:n};return r.BV.runKernel(a.IKK,u,s)}})},9995:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({argMax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,i._1)(e,"x","argMax"),o={x:n},u={axis:t};return r.BV.runKernel(a.sJF,o,u)}})},5157:function(e,t,n){"use strict";n.d(t,{v:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({argMin_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,i._1)(e,"x","argMin"),o={x:n},u={axis:t};return r.BV.runKernel(a.aJk,o,u)}})},3053:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({asin_:function(e){var t={x:(0,i._1)(e,"x","asin")};return r.BV.runKernel(a.M2y,t)}})},54:function(e,t,n){"use strict";n.d(t,{V:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({asinh_:function(e){var t={x:(0,i._1)(e,"x","asinh")};return r.BV.runKernel(a.qw7,t)}})},4778:function(e,t,n){"use strict";n.d(t,{z:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({atan_:function(e){var t={x:(0,i._1)(e,"x","atan")};return r.BV.runKernel(a.jMg,t)}})},2227:function(e,t,n){"use strict";n.d(t,{f:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354);var s=(0,n(8640).op)({atan2_:function(e,t){var n=(0,u._1)(e,"a","atan2"),s=(0,u._1)(t,"b","atan2"),c=(0,o.makeTypesMatch)(n,s),l=(0,r.Z)(c,2),f={a:n=l[0],b:s=l[1]};return a.BV.runKernel(i.QCc,f)}})},7897:function(e,t,n){"use strict";n.d(t,{C:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({atanh_:function(e){var t={x:(0,i._1)(e,"x","atanh")};return r.BV.runKernel(a.Oyi,t)}})},9204:function(e,t,n){"use strict";n.d(t,{w:function(){return f}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(9118),s=n(9151),c=n(8640),l=n(5561);var f=(0,c.op)({avgPool_:function(e,t,n,c,f){var d=(0,i._1)(e,"x","avgPool","float32");o.hu(s.jT(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")}));var h=d,p=!1;3===d.rank&&(p=!0,h=(0,l.X)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),o.hu(4===h.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(h.rank,".")})),s.m("avgPool",c,f);var v={x:h},g={filterSize:t,strides:n,pad:c,dimRoundingMode:f},m=r.BV.runKernel(a.JhU,v,g);return m=(0,u.p)(m,d.dtype),p?(0,l.X)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},8473:function(e,t,n){"use strict";n.d(t,{LJ:function(){return l},Q3:function(){return c},Vh:function(){return i},YB:function(){return a},kz:function(){return o},lB:function(){return s},rv:function(){return u},sY:function(){return f}});var r=n(6147);function a(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function i(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,u=0;u<r;u++)-1===n.indexOf(u)?a.push(e[i++]):a.push(t[o++]);return a}function o(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);var i=t.map((function(t){return e[t]}));return[n,i]}function u(e,t){return i(e,t.map((function(e){return 1})),t)}function s(e,t,n){r.hu(a(t,n),(function(){return"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input.")}))}function c(e,t){if(a(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function l(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function f(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}},6994:function(e,t,n){"use strict";n.d(t,{E:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({batchToSpaceND_:function(e,t,n){var u=(0,i._1)(e,"x","batchToSpaceND"),s=t.reduce((function(e,t){return e*t}));o.hu(u.rank>=1+t.length,(function(){return"input rank is ".concat(u.rank," but should be > than blockShape.length ").concat(t.length)})),o.hu(n.length===t.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)})),o.hu(u.shape[0]%s===0,(function(){return"input tensor batch is ".concat(u.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(s)}));var c={x:u},l={blockShape:t,crops:n};return r.BV.runKernel(a.zws,c,l)}})},3700:function(e,t,n){"use strict";n.d(t,{t:function(){return s}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(5561);var s=(0,n(8640).op)({batchNorm_:function(e,t,n,s,c,l){null==l&&(l=.001);var f,d,h=(0,i._1)(e,"x","batchNorm"),p=(0,i._1)(t,"mean","batchNorm"),v=(0,i._1)(n,"variance","batchNorm");null!=c&&(f=(0,i._1)(c,"scale","batchNorm")),null!=s&&(d=(0,i._1)(s,"offset","batchNorm")),o.hu(p.rank===v.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),o.hu(null==d||p.rank===d.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),o.hu(null==f||p.rank===f.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var g={x:function(e){return 0===e.rank||1===e.rank?(0,u.X)(e,[1,1,1,e.size]):2===e.rank?(0,u.X)(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?(0,u.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e}(h),scale:f,offset:d,mean:p,variance:v},m={varianceEpsilon:l},y=r.BV.runKernel(a.sHE,g,m);return(0,u.X)(y,h.shape)}})},9742:function(e,t,n){"use strict";n.d(t,{U:function(){return l}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(672),s=n(8640),c=n(5561);var l=(0,s.op)({broadcastTo_:function(e,t){var n=(0,i._1)(e,"broadcastTo","x"),s=n.shape;if((0,o.Mu)(t),t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){for(var l=n.shape.slice();l.length<t.length;)l.unshift(1);n=(0,c.X)(n,l)}for(var f=n.shape,d=Array.from(t),h=t.length-1;h>=0;h--)if(f[h]===t[h])d[h]=1;else if(1!==n.shape[h])throw new Error("broadcastTo(): [".concat(s,"] cannot be broadcast to [").concat(t,"]."));if(0===d.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0})).length)return(0,u.d)(n);var p={x:n},v={reps:d};return r.BV.runKernel(a.n9L,p,v)}})},5774:function(e,t,n){"use strict";function r(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function a(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function i(e,t){for(var n=[],r=Math.max(e.length,t.length),a=0;a<r;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o){var u="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(u)}n.unshift(i)}}return n}n.r(t),n.d(t,{assertAndGetBroadcastShape:function(){return i},getBroadcastDims:function(){return r},getReductionAxes:function(){return a}})},9118:function(e,t,n){"use strict";n.d(t,{p:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({cast_:function(e,t){var n=(0,i._1)(e,"x","cast");if(!o.LP(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var u={x:n},s={dtype:t};return r.BV.runKernel(a.RFZ,u,s)}})},1396:function(e,t,n){"use strict";n.d(t,{m:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({ceil_:function(e){var t={x:(0,i._1)(e,"x","ceil","float32")};return r.BV.runKernel(a.gJX,t)}})},9836:function(e,t,n){"use strict";n.d(t,{i:function(){return s}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(8582);var s=(0,n(8640).op)({clipByValue_:function(e,t,n){var s=(0,i._1)(e,"x","clipByValue");if(o.hu(t<=n,(function(){return"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")})),t===n)return(0,u.h)(s.shape,t,s.dtype);var c={x:s},l={clipValueMin:t,clipValueMax:n};return r.BV.runKernel(a.xnO,c,l)}})},672:function(e,t,n){"use strict";n.d(t,{d:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({clone_:function(e){var t={x:(0,i._1)(e,"x","clone","string_or_numeric")};return r.BV.runKernel(a.iJz,t)}})},9253:function(e,t,n){"use strict";n.d(t,{P:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({complex_:function(e,t){var n=(0,i._1)(e,"real","complex"),u=(0,i._1)(t,"imag","complex");o.k5(n.shape,u.shape,"real and imag shapes, ".concat(n.shape," and ").concat(u.shape,", ")+"must match in call to tf.complex().");var s={real:n,imag:u};return r.BV.runKernel(a.Zz9,s)}})},4836:function(e,t,n){"use strict";n.d(t,{z:function(){return s}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(672);var s=(0,n(8640).op)({concat_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,o.hu)(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=(0,i.sI)(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))})),1===n.length)return(0,u.d)(n[0]);var s=n,c={axis:t};return r.BV.runKernel(a.Eh3,s,c)}})},4918:function(e,t,n){"use strict";n.d(t,{P:function(){return c}});var r=n(8354),a=n(6147),i=n(3457),o=n(9151),u=n(8640),s=n(5561);var c=(0,u.op)({conv1d_:function(e,t,n,u){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,f=arguments.length>6?arguments[6]:void 0,d=(0,r._1)(e,"x","conv1d"),h=(0,r._1)(t,"filter","conv1d"),p=d,v=!1;2===d.rank&&(v=!0,p=(0,s.X)(d,[1,d.shape[0],d.shape[1]])),a.hu(3===p.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(p.rank,".")})),a.hu(3===h.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(h.rank,".")})),o.m("conv1d",u,f),a.hu(p.shape[2]===h.shape[1],(function(){return"Error in conv1d: depth of input (".concat(p.shape[2],") must match ")+"input depth for filter ".concat(h.shape[1],".")})),a.hu(o.jT(n,l),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(l,"'")})),a.hu(o.U3(l),(function(){return"Error in conv1D: Dilated rates should be larger than 0."})),a.hu(o.U3(n),(function(){return"Error in conv1D: Stride should be larger than 0."})),a.hu("NWC"===c,(function(){return"Error in conv1d: got dataFormat of ".concat(c," but only NWC is currently supported.")}));var g=(0,s.X)(h,[1,h.shape[0],h.shape[1],h.shape[2]]),m=(0,s.X)(p,[p.shape[0],1,p.shape[1],p.shape[2]]),y=[1,n],b=[1,l],x="NHWC",k=(0,i.T)(m,g,y,u,x,b,f);return v?(0,s.X)(k,[k.shape[2],k.shape[3]]):(0,s.X)(k,[k.shape[0],k.shape[2],k.shape[3]])}})},3457:function(e,t,n){"use strict";n.d(t,{T:function(){return l}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(9151),s=n(8640),c=n(5561);var l=(0,s.op)({conv2d_:function(e,t,n,s){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],d=arguments.length>6?arguments[6]:void 0,h=(0,i._1)(e,"x","conv2d","float32"),p=(0,i._1)(t,"filter","conv2d","float32"),v=h,g=!1;3===h.rank&&(g=!0,v=(0,c.X)(h,[1,h.shape[0],h.shape[1],h.shape[2]])),o.hu(4===v.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(v.rank,".")})),o.hu(4===p.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(p.rank,".")})),u.m("conv2d",s,d);var m="NHWC"===l?v.shape[3]:v.shape[1];o.hu(m===p.shape[2],(function(){return"Error in conv2d: depth of input (".concat(m,") must match ")+"input depth for filter ".concat(p.shape[2],".")})),o.hu(u.jT(n,f),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(f,"'")})),o.hu(u.U3(f),(function(){return"Error in conv2D: Dilated rates should be larger than 0."})),o.hu(u.U3(n),(function(){return"Error in conv2D: Strides should be larger than 0."}));var y={x:v,filter:p},b={strides:n,pad:s,dataFormat:l,dilations:f,dimRoundingMode:d},x=r.BV.runKernel(a.mhS,y,b);return g?(0,c.X)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},8744:function(e,t,n){"use strict";n.d(t,{p:function(){return c}});var r=n(318),a=n(2145),i=n(6147),o=n(9151),u=n(8640),s=n(5561);var c=(0,u.op)({conv2DBackpropFilter_:function(e,t,n,u,c){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",f=arguments.length>6?arguments[6]:void 0,d=e;3===e.rank&&(d=(0,s.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var h=t;3===h.rank&&(h=(0,s.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]])),i.hu(4===d.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(d.shape,".")})),i.hu(4===h.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(h.shape,".")})),i.hu(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var p="NHWC"===l?d.shape[3]:d.shape[1],v="NHWC"===l?h.shape[3]:h.shape[1];i.hu(p===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(p,") must ")+"match input depth in filter (".concat(n[2],".")})),i.hu(v===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(v,") must ")+"match output depth for filter (".concat(n[3],").")})),o.m("conv2dDerFilter",c,f);var g={x:d,dy:h},m={strides:u,pad:c,dataFormat:l,dimRoundingMode:f,filterShape:n};return r.BV.runKernel(a.wUP,g,m)}})},1045:function(e,t,n){"use strict";n.d(t,{_:function(){return c}});var r=n(318),a=n(2145),i=n(6147),o=n(9151),u=n(8640),s=n(5561);var c=(0,u.op)({conv2DBackpropInput_:function(e,t,n,u,c){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",f=arguments.length>6?arguments[6]:void 0;i.hu(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var d=e,h=t,p=!1;3===t.rank&&(p=!0,h=(0,s.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]),d=[1,e[0],e[1],e[2]]),i.hu(4===d.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(d.length,".")})),i.hu(4===h.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(h.rank)})),i.hu(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var v="NHWC"===l?d[3]:d[1],g="NHWC"===l?h.shape[3]:h.shape[1];i.hu(v===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(v,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),i.hu(g===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(g,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),o.m("conv2dDerInput",c,f);var m={dy:h,filter:n},y={strides:u,pad:c,dataFormat:l,dimRoundingMode:f,inputShape:d},b=r.BV.runKernel(a.wm,m,y);return p?(0,s.X)(b,[b.shape[1],b.shape[2],b.shape[3]]):b}})},1732:function(e,t,n){"use strict";n.d(t,{b:function(){return i}});var r=n(8354),a=n(1045);var i=(0,n(8640).op)({conv2dTranspose_:function(e,t,n,i,o,u){var s=(0,r._1)(e,"x","conv2dTranspose"),c=(0,r._1)(t,"filter","conv2dTranspose");return(0,a._)(n,s,c,i,o,"NHWC",u)}})},1873:function(e,t,n){"use strict";n.d(t,{_:function(){return s}});var r=n(318),a=n(2145),i=n(6147),o=n(8640),u=n(5561);var s=(0,o.op)({conv3DBackpropInput_:function(e,t,n,o,s){i.hu(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var c=e,l=t,f=!1;4===t.rank&&(f=!0,l=(0,u.X)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),c=[1,e[0],e[1],e[2],e[3]]);var d=c[4],h=l.shape[4];i.hu(5===c.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(c.length,".")})),i.hu(5===l.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(l.rank)})),i.hu(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),i.hu(d===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(d,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),i.hu(h===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var p={dy:l,filter:n},v={pad:s,strides:o,inputShape:c},g=r.BV.runKernel(a.ik2,p,v);return f?(0,u.X)(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}})},9151:function(e,t,n){"use strict";n.d(t,{I0:function(){return y},Ix:function(){return c},Rf:function(){return o},U3:function(){return x},Xw:function(){return u},aO:function(){return f},jT:function(){return b},jw:function(){return l},m:function(){return w},pl:function(){return s},sl:function(){return k}});var r=n(9439),a=n(3433),i=n(6147);function o(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",o=arguments.length>5?arguments[5]:void 0,u=e[3],s=[].concat((0,a.Z)(t),[u]),l=k(i);return c(e,s,n,o,r,null,null,l)}function u(e,t,n,a,i,o){var u,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",l=d(t),f=(0,r.Z)(l,2),h=f[0],p=f[1];if("channelsLast"===s)u=[h,p,e[3],e[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));u=[h,p,e[1],e[1]]}return c(e,u,n,a,i,o,!1,s)}function s(e,t,n,a,i,o){var u,s,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",f=h(t),d=(0,r.Z)(f,3),p=d[0],v=d[1],g=d[2];if("NDHWC"===c)s="channelsLast",u=[p,v,g,e[4],e[4]];else{if("NCDHW"!==c)throw new Error("Unknown dataFormat ".concat(c));s="channelsFirst",u=[p,v,g,e[1],e[1]]}return l(e,u,n,a,i,!1,s,o)}function c(e,t,n,a,i,o){var u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",c=-1,l=-1,f=-1,h=-1;if("channelsLast"===s){var g=(0,r.Z)(e,4);c=g[0],l=g[1],f=g[2],h=g[3]}else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));var m=(0,r.Z)(e,4);c=m[0],h=m[1],l=m[2],f=m[3]}var y,b=(0,r.Z)(t,4),x=b[0],k=b[1],w=b[3],_=d(n),C=(0,r.Z)(_,2),S=C[0],A=C[1],E=d(a),T=(0,r.Z)(E,2),N=T[0],D=T[1],F=p(x,N),I=p(k,D),M=v(i,l,f,S,A,F,I,o,s),O=M.padInfo,R=M.outHeight,Z=M.outWidth,B=u?w*h:w;return"channelsFirst"===s?y=[c,B,R,Z]:"channelsLast"===s&&(y=[c,R,Z,B]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:f,inChannels:h,outHeight:R,outWidth:Z,outChannels:B,padInfo:O,strideHeight:S,strideWidth:A,filterHeight:x,filterWidth:k,effectiveFilterHeight:F,effectiveFilterWidth:I,dilationHeight:N,dilationWidth:D,inShape:e,outShape:y,filterShape:t}}function l(e,t,n,a,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,c=-1,l=-1,f=-1,d=-1,v=-1;if("channelsLast"===u){var m=(0,r.Z)(e,5);c=m[0],l=m[1],f=m[2],d=m[3],v=m[4]}else{if("channelsFirst"!==u)throw new Error("Unknown dataFormat ".concat(u));var y=(0,r.Z)(e,5);c=y[0],v=y[1],l=y[2],f=y[3],d=y[4]}var b,x=(0,r.Z)(t,5),k=x[0],w=x[1],_=x[2],C=x[4],S=h(n),A=(0,r.Z)(S,3),E=A[0],T=A[1],N=A[2],D=h(a),F=(0,r.Z)(D,3),I=F[0],M=F[1],O=F[2],R=p(k,I),Z=p(w,M),B=p(_,O),z=g(i,l,f,d,E,T,N,R,Z,B,s),L=z.padInfo,P=z.outDepth,j=z.outHeight,U=z.outWidth,W=o?C*v:C;return"channelsFirst"===u?b=[c,W,P,j,U]:"channelsLast"===u&&(b=[c,P,j,U,W]),{batchSize:c,dataFormat:u,inDepth:l,inHeight:f,inWidth:d,inChannels:v,outDepth:P,outHeight:j,outWidth:U,outChannels:W,padInfo:L,strideDepth:E,strideHeight:T,strideWidth:N,filterDepth:k,filterHeight:w,filterWidth:_,effectiveFilterDepth:R,effectiveFilterHeight:Z,effectiveFilterWidth:B,dilationDepth:I,dilationHeight:M,dilationWidth:O,inShape:e,outShape:b,filterShape:t}}function f(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=p(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function d(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function h(e){return"number"===typeof e?[e,e,e]:e}function p(e,t){return t<=1?e:e+(e-1)*(t-1)}function v(e,t,n,r,a,i,o,u,s){var c,l,d;if("number"===typeof e){c={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var h=function(e,t,n,r,a){null==r&&(r=f(e,t,n));var i=e[0],o=e[1];return[m((i-t+2*r)/n+1,a),m((o-t+2*r)/n+1,a)]}([t,n],i,r,e,u);l=h[0],d=h[1]}else if("same"===e){l=Math.ceil(t/r),d=Math.ceil(n/a);var p=Math.max(0,(l-1)*r+i-t),v=Math.max(0,(d-1)*a+o-n),g=Math.floor(p/2),y=p-g,b=Math.floor(v/2);c={top:g,bottom:y,left:b,right:v-b,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((t-i+1)/r),d=Math.ceil((n-o+1)/a);else{if("object"!==typeof e)throw Error("Unknown padding parameter: ".concat(e));var x="channelsLast"===s?e[1][0]:e[2][0],k="channelsLast"===s?e[1][1]:e[2][1],w="channelsLast"===s?e[2][0]:e[3][0],_="channelsLast"===s?e[2][1]:e[3][1];c={top:x,bottom:k,left:w,right:_,type:0===x&&0===k&&0===w&&0===_?"VALID":"EXPLICIT"},l=m((t-i+x+k)/r+1,u),d=m((n-o+w+_)/a+1,u)}return{padInfo:c,outHeight:l,outWidth:d}}function g(e,t,n,r,a,i,o,u,s,c,l){var d,h,p,v;if("valid"===e&&(e=0),"number"===typeof e){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var g=function(e,t,n,r,a,i){null==a&&(a=f(e,t[0],r[0]));for(var o=[0,0,0,n],u=0;u<3;u++)e[u]+2*a>=t[u]&&(o[u]=m((e[u]-t[u]+2*a)/r[u]+1,i));return o}([t,n,r,1],[u,s,c],1,[a,i,o],e,l);h=g[0],p=g[1],v=g[2]}else{if("same"!==e)throw Error("Unknown padding parameter: ".concat(e));var y=((h=Math.ceil(t/a))-1)*a+u-t,b=((p=Math.ceil(n/i))-1)*i+s-n,x=((v=Math.ceil(r/o))-1)*o+c-r,k=Math.floor(y/2),w=y-k,_=Math.floor(b/2),C=b-_,S=Math.floor(x/2);d={top:_,bottom:C,left:S,right:x-S,front:k,back:w,type:"SAME"}}return{padInfo:d,outDepth:h,outHeight:p,outWidth:v}}function m(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function y(e){var t=d(e),n=(0,r.Z)(t,3),a=n[0],i=n[1],o=n[2];return 1===a&&1===i&&1===o}function b(e,t){return y(e)||y(t)}function x(e){return d(e).every((function(e){return e>0}))}function k(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}function w(e,t,n){if(null!=n){if("string"===typeof t)throw Error("Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,"."));if("number"===typeof t)i.hu(i.GN(t),(function(){return"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,".")}));else{if("object"!==typeof t)throw Error("Error in ".concat(e,": Unknown padding parameter: ").concat(t));t.forEach((function(t){t.forEach((function(t){i.hu(i.GN(t),(function(){return"Error in ".concat(e,": pad must be an integer when using ")+"dimRoundingMode ".concat(n," but got pad ").concat(t,".")}))}))}))}}}},1227:function(e,t,n){"use strict";n.d(t,{m:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({cos_:function(e){var t={x:(0,i._1)(e,"x","cos","float32")};return r.BV.runKernel(a.mc4,t)}})},6679:function(e,t,n){"use strict";n.d(t,{f:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({cosh_:function(e){var t={x:(0,i._1)(e,"x","cosh","float32")};return r.BV.runKernel(a.TR1,t)}})},9457:function(e,t,n){"use strict";n.d(t,{$:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({cumprod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=(0,i._1)(e,"x","cumprod"),s={x:u},c={axis:t,exclusive:n,reverse:o};return r.BV.runKernel(a.Byc,s,c)}})},8862:function(e,t,n){"use strict";n.d(t,{z:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({cumsum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=(0,i._1)(e,"x","cumsum"),s={x:u},c={axis:t,exclusive:n,reverse:o};return r.BV.runKernel(a.iHb,s,c)}})},1878:function(e,t,n){"use strict";n.d(t,{n:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({depthToSpace_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",u=(0,i._1)(e,"x","depthToSpace","float32"),s="NHWC"===n?u.shape[1]:u.shape[2],c="NHWC"===n?u.shape[2]:u.shape[3],l="NHWC"===n?u.shape[3]:u.shape[1];o.hu(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(t)})),o.hu(s*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(s," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(u.shape)})),o.hu(c*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(c," and ").concat(t," for depthToSpace with input shape\n        ").concat(u.shape)})),o.hu(l%(t*t)===0,(function(){return"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(l," for depthToSpace with input shape ").concat(u.shape)}));var f={x:u},d={blockSize:t,dataFormat:n};return r.BV.runKernel(a.T0n,f,d)}})},1147:function(e,t,n){"use strict";n.d(t,{B:function(){return l}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(9151),s=n(8640),c=n(5561);var l=(0,s.op)({depthwiseConv2d_:function(e,t,n,s){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],d=arguments.length>6?arguments[6]:void 0,h=(0,i._1)(e,"x","depthwiseConv2d","float32"),p=(0,i._1)(t,"filter","depthwiseConv2d","float32"),v=h,g=!1;3===h.rank&&(g=!0,v=(0,c.X)(h,[1,h.shape[0],h.shape[1],h.shape[2]])),o.hu(4===v.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(v.rank,".")})),o.hu(4===p.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(p.rank,".")}));var m="NHWC"===l?v.shape[3]:v.shape[1];o.hu(m===p.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(m,") must match the inChannels dimension in ")+"filter ".concat(p.shape[2],".")})),u.m("depthwiseConv2d",s,d);var y={x:v,filter:p},b={strides:n,pad:s,dataFormat:l,dilations:f,dimRoundingMode:d},x=r.BV.runKernel(a.cie,y,b);return g?(0,c.X)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},288:function(e,t,n){"use strict";n.d(t,{z:function(){return u}});var r=n(318),a=n(2145),i=n(8640),o=n(5561);var u=(0,i.op)({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,i,u){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],c=arguments.length>6?arguments[6]:void 0,l=e;3===e.rank&&(l=(0,o.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var f=t;3===f.rank&&(f=(0,o.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var d={x:l,dy:f},h={strides:i,pad:u,dimRoundingMode:c,dilations:s,filterShape:n};return r.BV.runKernel(a.sL$,d,h)}})},6939:function(e,t,n){"use strict";n.d(t,{v:function(){return u}});var r=n(318),a=n(2145),i=n(8640),o=n(5561);var u=(0,i.op)({depthwiseConv2dNativeBackpropInput_:function(e,t,n,i,u){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],c=arguments.length>6?arguments[6]:void 0,l=t,f=!1;3===t.rank&&(f=!0,l=(0,o.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var d={dy:l,filter:n},h={strides:i,pad:u,dimRoundingMode:c,dilations:s,inputShape:e},p=r.BV.runKernel(a.y7R,d,h);return f?(0,o.X)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},7580:function(e,t,n){"use strict";n.d(t,{W:function(){return c}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(8640),s=n(5561);var c=(0,u.op)({dilation2d_:function(e,t,n,u){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",f=(0,i._1)(e,"x","dilation2d"),d=(0,i._1)(t,"filter","dilation2d");o.hu(3===f.rank||4===f.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(f.rank,".")})),o.hu(3===d.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(d.rank,".")})),o.hu("NHWC"===l,(function(){return"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(l)}));var h=f,p=!1;3===f.rank&&(h=(0,s.X)(f,[1,f.shape[0],f.shape[1],f.shape[2]]),p=!0),o.hu(h.shape[3]===d.shape[2],(function(){return"Error in dilation2d:  input and filter must have the same depth: ".concat(h.shape[3]," vs ").concat(d.shape[2])}));var v={x:h,filter:d},g={strides:n,pad:u,dilations:c},m=r.BV.runKernel(a.p4S,v,g);return p?(0,s.X)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},5750:function(e,t,n){"use strict";n.d(t,{h:function(){return c}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(7145);var c=(0,n(8640).op)({div_:function(e,t){var n=(0,u._1)(e,"a","div"),c=(0,u._1)(t,"b","div"),l=(0,o.makeTypesMatch)(n,c),f=(0,r.Z)(l,2);if(n=f[0],c=f[1],"int32"===n.dtype&&"int32"===c.dtype)return(0,s.q)(n,c);var d={a:n,b:c};return a.BV.runKernel(i.oHH,d,{})}})},5923:function(e,t,n){"use strict";n.d(t,{N:function(){return f}});var r=n(9439),a=n(9064),i=n(8354),o=n(5750),u=n(3254),s=n(8640),c=n(329),l=n(7293);var f=(0,s.op)({divNoNan_:function(e,t){var n=(0,i._1)(e,"a","div"),s=(0,i._1)(t,"b","div"),f=(0,a.makeTypesMatch)(n,s),d=(0,r.Z)(f,2);n=d[0],s=d[1];var h=(0,o.h)(n,s),p=(0,l.P)(h),v=(0,u.D)(s,p);return(0,c.a)(v,p,h)}})},5043:function(e,t,n){"use strict";n.d(t,{A:function(){return s}});var r=n(8354),a=n(6147),i=n(7221),o=n(8640),u=n(5561);var s=(0,o.op)({dot_:function(e,t){var n=(0,r._1)(e,"t1","dot"),o=(0,r._1)(t,"t2","dot");a.hu((1===n.rank||2===n.rank)&&(1===o.rank||2===o.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(o.rank,".")}));var s=1===n.rank?n.size:n.shape[1],c=1===o.rank?o.size:o.shape[0];if(a.hu(s===c,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(s," and ").concat(c,".")})),1===n.rank&&1===o.rank){var l=(0,u.X)(n,[1,-1]),f=(0,u.X)(o,[-1,1]),d=(0,i.O)(l,f);return(0,u.X)(d,[])}if(1===n.rank&&2===o.rank){var h=(0,u.X)(n,[1,-1]),p=(0,u.X)(o,[o.shape[0],o.shape[1]]),v=(0,i.O)(h,p);return(0,u.X)(v,[v.size])}if(2===n.rank&&1===o.rank){var g=(0,u.X)(o,[-1,1]),m=(0,i.O)(n,g);return(0,u.X)(m,[m.size])}var y=(0,u.X)(o,[o.shape[0],o.shape[1]]);return(0,i.O)(n,y)}})},2353:function(e,t,n){"use strict";n.d(t,{p:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({elu_:function(e){var t={x:(0,i._1)(e,"x","elu","float32")};return r.BV.runKernel(a.SX0,t)}})},3254:function(e,t,n){"use strict";n.d(t,{D:function(){return c}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774);var c=(0,n(8640).op)({equal_:function(e,t){var n=(0,u._1)(e,"a","equal","string_or_numeric"),c=(0,u._1)(t,"b","equal","string_or_numeric"),l=(0,o.makeTypesMatch)(n,c),f=(0,r.Z)(l,2);n=f[0],c=f[1],(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);var d={a:n,b:c};return a.BV.runKernel(i.hdR,d)}})},3891:function(e,t,n){"use strict";n.d(t,{q:function(){return s}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(9118);var s=(0,n(8640).op)({erf_:function(e){var t=(0,i._1)(e,"x","erf");o.hu("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=(0,u.p)(t,"float32"));var n={x:t};return r.BV.runKernel(a.Omj,n)}})},3313:function(e,t,n){"use strict";n.d(t,{d:function(){return a}});var r=n(6662);var a=(0,n(8640).op)({euclideanNorm_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,r.K)(e,"euclidean",t,n)}})},411:function(e,t,n){"use strict";n.d(t,{Q:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({exp_:function(e){var t={x:(0,i._1)(e,"x","exp")};return r.BV.runKernel(a.NEP,t)}})},2975:function(e,t,n){"use strict";n.d(t,{d:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({expandDims_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,i._1)(e,"x","expandDims","string_or_numeric");o.hu(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var u={input:n},s={dim:t};return r.BV.runKernel(a.YFo,u,s)}})},5682:function(e,t,n){"use strict";n.d(t,{t:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({expm1_:function(e){var t={x:(0,i._1)(e,"x","expm1")};return r.BV.runKernel(a.Y0y,t)}})},8582:function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var r=n(318),a=n(2145),i=n(6147);function o(e,t,n){(0,i.Mu)(e);var o={shape:e,value:t,dtype:n};return r.BV.runKernel(a.deh,{},o)}},2628:function(e,t,n){"use strict";n.d(t,{G:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({floor_:function(e){var t={x:(0,i._1)(e,"x","floor","float32")};return r.BV.runKernel(a.OR,t)}})},7145:function(e,t,n){"use strict";n.d(t,{q:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354);var s=(0,n(8640).op)({floorDiv_:function(e,t){var n=(0,u._1)(e,"a","floorDiv"),s=(0,u._1)(t,"b","floorDiv"),c=(0,o.makeTypesMatch)(n,s),l=(0,r.Z)(c,2),f={a:n=l[0],b:s=l[1]};return a.BV.runKernel(i.jeX,f)}})},9498:function(e,t,n){"use strict";n.d(t,{I:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({gather_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=(0,i._1)(e,"x","gather"),s=(0,i._1)(t,"indices","gather","int32"),c={x:u,indices:s},l={axis:n,batchDims:o};return r.BV.runKernel(a.qi_,c,l)}})},5014:function(e,t,n){"use strict";n.d(t,{p:function(){return c}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774);var c=(0,n(8640).op)({greater_:function(e,t){var n=(0,u._1)(e,"a","greater","string_or_numeric"),c=(0,u._1)(t,"b","greater","string_or_numeric"),l=(0,o.makeTypesMatch)(n,c),f=(0,r.Z)(l,2);n=f[0],c=f[1],(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);var d={a:n,b:c};return a.BV.runKernel(i.iZT,d)}})},8327:function(e,t,n){"use strict";n.d(t,{b:function(){return c}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774);var c=(0,n(8640).op)({greaterEqual_:function(e,t){var n=(0,u._1)(e,"a","greaterEqual","string_or_numeric"),c=(0,u._1)(t,"b","greaterEqual","string_or_numeric"),l=(0,o.makeTypesMatch)(n,c),f=(0,r.Z)(l,2);n=f[0],c=f[1],(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);var d={a:n,b:c};return a.BV.runKernel(i.Acj,d)}})},6996:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({imag_:function(e){var t={input:(0,i._1)(e,"input","imag")};return r.BV.runKernel(a.J_u,t)}})},464:function(e,t,n){"use strict";n.d(t,{I:function(){return l}});var r=n(9439),a=n(318),i=n(2145),o=n(8354),u=n(6147),s=n(8640),c=n(5561);var l=(0,s.op)({resizeBilinear_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=(0,o._1)(e,"images","resizeBilinear");u.hu(3===l.rank||4===l.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(l.rank,".")})),u.hu(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")})),u.hu(!1===s||!1===n,(function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."}));var f=l,d=!1;3===l.rank&&(d=!0,f=(0,c.X)(l,[1,l.shape[0],l.shape[1],l.shape[2]])),(0,r.Z)(t,0);var h={images:f},p={alignCorners:n,halfPixelCenters:s,size:t},v=a.BV.runKernel(i._Yw,h,p);return d?(0,c.X)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},8600:function(e,t,n){"use strict";n.d(t,{j:function(){return l}});var r=n(9439),a=n(318),i=n(2145),o=n(8354),u=n(6147),s=n(8640),c=n(5561);var l=(0,s.op)({resizeNearestNeighbor_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=(0,o._1)(e,"images","resizeNearestNeighbor");u.hu(3===l.rank||4===l.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(l.rank,".")})),u.hu(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")})),u.hu("float32"===l.dtype||"int32"===l.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"})),u.hu(!1===s||!1===n,(function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."}));var f=l,d=!1;3===l.rank&&(d=!0,f=(0,c.X)(l,[1,l.shape[0],l.shape[1],l.shape[2]])),(0,r.Z)(t,0);var h={images:f},p={alignCorners:n,halfPixelCenters:s,size:t},v=a.BV.runKernel(i.dpD,h,p);return d?(0,c.X)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},300:function(e,t,n){"use strict";n.d(t,{x:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({isFinite_:function(e){var t={x:(0,i._1)(e,"x","isFinite")};return r.BV.runKernel(a.avt,t)}})},4652:function(e,t,n){"use strict";n.d(t,{U:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({isInf_:function(e){var t={x:(0,i._1)(e,"x","isInf")};return r.BV.runKernel(a.iWB,t)}})},7005:function(e,t,n){"use strict";n.d(t,{i:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({isNaN_:function(e){var t={x:(0,i._1)(e,"x","isNaN")};return r.BV.runKernel(a.r7n,t)}})},4419:function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({leakyRelu_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=(0,i._1)(e,"x","leakyRelu"),o={x:n},u={alpha:t};return r.BV.runKernel(a.J$2,o,u)}})},4920:function(e,t,n){"use strict";n.d(t,{d:function(){return c}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774);var c=(0,n(8640).op)({less_:function(e,t){var n=(0,u._1)(e,"a","less","string_or_numeric"),c=(0,u._1)(t,"b","less","string_or_numeric"),l=(0,o.makeTypesMatch)(n,c),f=(0,r.Z)(l,2);n=f[0],c=f[1],(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);var d={a:n,b:c};return a.BV.runKernel(i.vtC,d)}})},2642:function(e,t,n){"use strict";n.d(t,{z:function(){return c}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774);var c=(0,n(8640).op)({lessEqual_:function(e,t){var n=(0,u._1)(e,"a","lessEqual","string_or_numeric"),c=(0,u._1)(t,"b","lessEqual","string_or_numeric"),l=(0,o.makeTypesMatch)(n,c),f=(0,r.Z)(l,2);n=f[0],c=f[1],(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);var d={a:n,b:c};return a.BV.runKernel(i.CAk,d)}})},936:function(e,t,n){"use strict";n.d(t,{G:function(){return c}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(8640),s=n(5561);var c=(0,u.op)({localResponseNormalization_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,l=(0,i._1)(e,"x","localResponseNormalization");o.hu(4===l.rank||3===l.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(l.rank,".")})),o.hu(o.GN(t),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,".")}));var f=l,d=!1;3===l.rank&&(d=!0,f=(0,s.X)(l,[1,l.shape[0],l.shape[1],l.shape[2]]));var h={x:f},p={depthRadius:t,bias:n,alpha:u,beta:c},v=r.BV.runKernel(a.eZ0,h,p);return d?(0,s.X)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},378:function(e,t,n){"use strict";n.d(t,{c:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({log_:function(e){var t={x:(0,i._1)(e,"x","log","float32")};return r.BV.runKernel(a.ZbH,t)}})},5341:function(e,t,n){"use strict";n.d(t,{K:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({log1p_:function(e){var t={x:(0,i._1)(e,"x","log1p")};return r.BV.runKernel(a.kU,t)}})},5113:function(e,t,n){"use strict";n.d(t,{e:function(){return l}});var r=n(6450),a=n(8354),i=n(651),o=n(4362),u=n(8640),s=n(7643),c=n(4626);var l=(0,u.op)({logSigmoid_:function(e){var t=(0,a._1)(e,"x","logSigmoid");return(0,r.cb)((function(e){return{value:(0,o.W)((0,c.W)((0,o.W)(e))),gradFunc:function(t){return(0,i.d)(t,(0,s.X)((0,o.W)(e)))}}}))(t)}})},4561:function(e,t,n){"use strict";n.d(t,{C:function(){return p}});var r=n(9439),a=n(6450),i=n(8354),o=n(9118),u=n(411),s=n(378),c=n(6176),l=n(651),f=n(8640),d=n(4774),h=n(227);var p=(0,f.op)({logSoftmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=(0,i._1)(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));var f=(0,a.cb)((function(e,n){var a=(0,c.F)(e,t,!0),i=(0,d.l)(e,a),f=(0,d.l)((0,o.p)(i,"float32"),(0,s.c)((0,h.S)((0,u.Q)(i),t,!0)));n([f]);return{value:f,gradFunc:function(e,n){var a=(0,r.Z)(n,1)[0],i=(0,u.Q)(a);return(0,d.l)(e,(0,l.d)((0,h.S)(e,t,!0),i))}}}));return f(n)}})},5530:function(e,t,n){"use strict";n.d(t,{l:function(){return p}});var r=n(8354),a=n(6147),i=n(3312),o=n(8473),u=n(411),s=n(378),c=n(6176),l=n(8640),f=n(5561),d=n(4774),h=n(227);var p=(0,l.op)({logSumExp_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=(0,r._1)(e,"x","logSumExp"),p=(0,a.EC)(t,l.shape),v=(0,c.F)(l,p,!0),g=(0,d.l)(l,v),m=(0,u.Q)(g),y=(0,h.S)(m,p),b=(0,s.c)(y),x=(0,i.I)((0,f.X)(v,b.shape),b);if(n){var k=(0,o.rv)(x.shape,p);return(0,f.X)(x,k)}return x}})},2177:function(e,t,n){"use strict";n.d(t,{H:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(5774);var u=(0,n(8640).op)({logicalAnd_:function(e,t){var n=(0,i._1)(e,"a","logicalAnd","bool"),u=(0,i._1)(t,"b","logicalAnd","bool");(0,o.assertAndGetBroadcastShape)(n.shape,u.shape);var s={a:n,b:u};return r.BV.runKernel(a.PYm,s)}})},875:function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({logicalNot_:function(e){var t={x:(0,i._1)(e,"x","logicalNot","bool")};return r.BV.runKernel(a.VfG,t)}})},5117:function(e,t,n){"use strict";n.d(t,{K:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(5774);var u=(0,n(8640).op)({logicalOr_:function(e,t){var n=(0,i._1)(e,"a","logicalOr","bool"),u=(0,i._1)(t,"b","logicalOr","bool");(0,o.assertAndGetBroadcastShape)(n.shape,u.shape);var s={a:n,b:u};return r.BV.runKernel(a.MZg,s)}})},1712:function(e,t,n){"use strict";n.d(t,{e:function(){return s}});var r=n(8354),a=n(5774),i=n(2177),o=n(875),u=n(5117);var s=(0,n(8640).op)({logicalXor_:function(e,t){var n=(0,r._1)(e,"a","logicalXor","bool"),s=(0,r._1)(t,"b","logicalXor","bool");return(0,a.assertAndGetBroadcastShape)(n.shape,s.shape),(0,i.H)((0,u.K)(e,t),(0,o.h)((0,i.H)(e,t)))}})},7221:function(e,t,n){"use strict";n.d(t,{O:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354);var s=(0,n(8640).op)({matMul_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=(0,u._1)(e,"a","matMul"),l=(0,u._1)(t,"b","matMul"),f=(0,o.makeTypesMatch)(c,l),d=(0,r.Z)(f,2),h={a:c=d[0],b:l=d[1]},p={transposeA:n,transposeB:s};return a.BV.runKernel(i.XLW,h,p)}})},6176:function(e,t,n){"use strict";n.d(t,{F:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({max_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(0,i._1)(e,"x","max"),u={x:o},s={reductionIndices:t,keepDims:n};return r.BV.runKernel(a.YoZ,u,s)}})},5777:function(e,t,n){"use strict";n.d(t,{_:function(){return l}});var r=n(318),a=n(2145),i=n(8354),o=n(6147),u=n(9151),s=n(8640),c=n(5561);var l=(0,s.op)({maxPool_:function(e,t,n,s,l){var f=(0,i._1)(e,"x","maxPool"),d=f,h=!1;3===f.rank&&(h=!0,d=(0,c.X)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),o.hu(4===d.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(d.rank,".")})),o.hu(u.jT(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")})),u.m("maxPool",s,l);var p={x:d},v={filterSize:t,strides:n,pad:s,dimRoundingMode:l},g=r.BV.runKernel(a.mTV,p,v);return h?(0,c.X)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},705:function(e,t,n){"use strict";n.d(t,{g:function(){return l}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774),c=n(9118);var l=(0,n(8640).op)({maximum_:function(e,t){var n=(0,u._1)(e,"a","maximum"),l=(0,u._1)(t,"b","maximum"),f=(0,o.makeTypesMatch)(n,l),d=(0,r.Z)(f,2);n=d[0],l=d[1],"bool"===n.dtype&&(n=(0,c.p)(n,"int32"),l=(0,c.p)(l,"int32")),(0,s.assertAndGetBroadcastShape)(n.shape,l.shape);var h={a:n,b:l};return a.BV.runKernel(i.BMI,h)}})},6568:function(e,t,n){"use strict";n.d(t,{J:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({mean_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(0,i._1)(e,"x","mean"),u={x:o},s={axis:t,keepDims:n};return r.BV.runKernel(a.q2K,u,s)}})},7891:function(e,t,n){"use strict";n.d(t,{V:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({min_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(0,i._1)(e,"x","min"),u={x:o},s={axis:t,keepDims:n};return r.BV.runKernel(a.c17,u,s)}})},2273:function(e,t,n){"use strict";n.d(t,{L:function(){return l}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774),c=n(9118);var l=(0,n(8640).op)({minimum_:function(e,t){var n=(0,u._1)(e,"a","minimum"),l=(0,u._1)(t,"b","minimum"),f=(0,o.makeTypesMatch)(n,l),d=(0,r.Z)(f,2);n=d[0],l=d[1],"bool"===n.dtype&&(n=(0,c.p)(n,"int32"),l=(0,c.p)(l,"int32")),(0,s.assertAndGetBroadcastShape)(n.shape,l.shape);var h={a:n,b:l};return a.BV.runKernel(i.q8u,h)}})},9719:function(e,t,n){"use strict";n.d(t,{V:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({mirrorPad_:function(e,t,n){o.hu("reflect"===n||"symmetric"===n,(function(){return"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")}));var u=(0,i._1)(e,"x","mirrorPad");if(0===u.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");o.hu(t.length===u.rank,(function(){return"Padding doesn't match input. Must be ".concat(u.rank,". ")+"Got ".concat(t.length,".")}));for(var s="reflect"===n?1:0,c=function(e){o.hu(2===t[e].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),o.hu(t[e][0]>=0&&t[e][0]<=u.shape[e]-s&&t[e][1]>=0&&t[e][1]<=u.shape[e]-s,(function(){return"Padding in dimension ".concat(e," cannot be greater than or equal ")+"to ".concat(u.shape[e]-s," or less than 0 for input of ")+"shape ".concat(u.shape)}))},l=0;l<u.rank;l++)c(l);var f={paddings:t,mode:n},d={x:u};return r.BV.runKernel(a.jQs,d,f)}})},4645:function(e,t,n){"use strict";n.d(t,{w:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354);var s=(0,n(8640).op)({mod_:function(e,t){var n=(0,u._1)(e,"a","mod"),s=(0,u._1)(t,"b","mod"),c=(0,o.makeTypesMatch)(n,s),l=(0,r.Z)(c,2),f={a:n=l[0],b:s=l[1]};return a.BV.runKernel(i.Vbg,f)}})},651:function(e,t,n){"use strict";n.d(t,{d:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354);var s=(0,n(8640).op)({mul_:function(e,t){var n=(0,u._1)(e,"a","mul"),s=(0,u._1)(t,"b","mul"),c=(0,o.makeTypesMatch)(n,s),l=(0,r.Z)(c,2),f={a:n=l[0],b:s=l[1]};return a.BV.runKernel(i.wYn,f)}})},4362:function(e,t,n){"use strict";n.d(t,{W:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({neg_:function(e){var t={x:(0,i._1)(e,"x","neg")};return r.BV.runKernel(a.kuV,t)}})},6662:function(e,t,n){"use strict";n.d(t,{K:function(){return m}});var r=n(8354),a=n(6147),i=n(7613),o=n(8473),u=n(6176),s=n(7891),c=n(8640),l=n(4334),f=n(5561),d=n(7067),h=n(6902),p=n(7391),v=n(227);function g(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return(0,i.W)(e);if(1!==e.rank&&null===n)return g((0,f.X)(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return(0,v.S)((0,i.W)(e),n);if(t===1/0)return(0,u.F)((0,i.W)(e),n);if(t===-1/0)return(0,s.V)((0,i.W)(e),n);if("euclidean"===t||2===t)return(0,h._)((0,v.S)((0,l.s)((0,i.W)(e),(0,d.i)(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return(0,u.F)((0,v.S)((0,i.W)(e),n[0]),n[1]-1);if(t===1/0)return(0,u.F)((0,v.S)((0,i.W)(e),n[1]),n[0]);if(t===-1/0)return(0,s.V)((0,v.S)((0,i.W)(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return(0,h._)((0,v.S)((0,p.h)(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}var m=(0,c.op)({norm_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=g(e=(0,r._1)(e,"x","norm"),t,n),s=u.shape;if(i){var c=(0,a.EC)(n,e.shape);s=o.rv(u.shape,c)}return(0,f.X)(u,s)}})},5549:function(e,t,n){"use strict";n.d(t,{Q:function(){return c}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774);var c=(0,n(8640).op)({notEqual_:function(e,t){var n=(0,u._1)(e,"a","notEqual","string_or_numeric"),c=(0,u._1)(t,"b","notEqual","string_or_numeric"),l=(0,o.makeTypesMatch)(n,c),f=(0,r.Z)(l,2);n=f[0],c=f[1],(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);var d={a:n,b:c};return a.BV.runKernel(i.yQU,d)}})},4326:function(e,t,n){"use strict";n.d(t,{l:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({oneHot_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"int32";if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));var s=(0,i._1)(e,"indices","oneHot","int32"),c={indices:s},l={dtype:u,depth:t,onValue:n,offValue:o};return r.BV.runKernel(a.we_,c,l)}})},6100:function(e,t,n){"use strict";n.d(t,{i:function(){return u}});var r=n(318),a=n(6147),i=n(9253),o=n(7742);function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if((0,a.Mu)(e),"complex64"===t){var n=u(e,"float32"),s=(0,o.l)(e,"float32");return(0,i.P)(n,s)}var c=(0,a.p8)((0,a.NA)(e),t);return r.BV.makeTensor(c,e,t)}},773:function(e,t,n){"use strict";n.d(t,{J:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({onesLike_:function(e){var t={x:(0,i._1)(e,"x","onesLike")};return r.BV.runKernel(a.qWM,t)}})},8640:function(e,t,n){"use strict";n.d(t,{op:function(){return o},z:function(){return i}});var r=n(318),a=n(6147),i="__op";function o(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));var n=t[0],o=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=i;var u=function(){r.BV.startScope(n);try{var e=o.apply(void 0,arguments);return(0,a.tI)(e)&&console.error("Cannot return a Promise inside of tidy."),r.BV.endScope(e),e}catch(t){throw r.BV.endScope(null),t}};return Object.defineProperty(u,"name",{value:n,configurable:!0}),u}},1970:function(e,t,n){"use strict";n.d(t,{v:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({pad_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=(0,i._1)(e,"x","pad");if(0===o.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var u={paddings:t,constantValue:n},s={x:o};return r.BV.runKernel(a.lyA,s,u)}})},7226:function(e,t,n){"use strict";n.d(t,{d:function(){return h}});var r=n(9439),a=n(8354),i=n(6147),o=n(9204),u=n(6994),s=n(9151),c=n(5777),l=n(8640),f=n(5561),d=n(5696);var h=(0,l.op)({pool_:function(e,t,n,l,h,p,v){null==h&&(h=[1,1]),null==p&&(p=1),0===l&&(l="valid");var g=(0,a._1)(e,"x","maxPool"),m=g,y=!1;3===g.rank&&(y=!0,m=(0,f.X)(g,[1,g.shape[0],g.shape[1],g.shape[2]])),i.hu(s.jT(p,h),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(p," and dilations '").concat(h,"'")}));var b,x=s.Xw(m.shape,t,p,h,l),k=[x.dilationHeight,x.dilationWidth];b="same"===l?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})),r=n.map((function(e){return e-1})),a=r.map((function(e){return Math.floor(e/2)})),i=r.map((function(e,t){return e-a[t]}));return r.map((function(e,t){return[a[t],i[t]]}))}([x.filterHeight,x.filterWidth],k):[[0,0],[0,0]];var w=1===k[0]&&1===k[1],_=function(e,t,n){var r=n.map((function(e){return e[0]})),a=n.map((function(e){return e[1]})),i=e.concat(r,a),o=t.map((function(e,t){return(e-i[t]%e)%e})),u=a.map((function(e,t){return e+o[t]})),s=t.map((function(e,t){return[r[t],u[t]]})),c=t.map((function(e,t){return[0,o[t]]}));return[s,c]}([x.inHeight,x.inWidth],k,b),C=(0,r.Z)(_,2),S=C[0],A=C[1],E=w?l:"valid",T=w?m:(0,d.f)(m,k,S),N=("avg"===n?function(){return(0,o.w)(T,t,p,E,v)}:function(){return(0,c._)(T,t,p,E,v)})(),D=w?N:(0,u.E)(N,k,A);return y?(0,f.X)(D,[D.shape[1],D.shape[2],D.shape[3]]):D}})},4334:function(e,t,n){"use strict";n.d(t,{s:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354);var s=(0,n(8640).op)({pow_:function(e,t){var n=(0,u._1)(e,"base","pow"),s=(0,u._1)(t,"exp","pow"),c=(0,o.makeTypesMatch)(n,s),l=(0,r.Z)(c,2),f={a:n=l[0],b:s=l[1]};return a.BV.runKernel(i.pe_,f)}})},6859:function(e,t,n){"use strict";n.d(t,{A:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({prelu_:function(e,t){var n={x:(0,i._1)(e,"x","prelu"),alpha:(0,i._1)(t,"alpha","prelu")};return r.BV.runKernel(a.o0g,n)}})},7722:function(e,t,n){"use strict";n.d(t,{W:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(9118);var u=(0,n(8640).op)({prod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=(0,i._1)(e,"x","prod");"bool"===u.dtype&&(u=(0,o.p)(u,"int32"));var s={x:u},c={axis:t,keepDims:n};return r.BV.runKernel(a.DlI,s,c)}})},6972:function(e,t,n){"use strict";n.d(t,{k:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({real_:function(e){var t={input:(0,i._1)(e,"input","real")};return r.BV.runKernel(a.xJR,t)}})},2209:function(e,t,n){"use strict";n.d(t,{M:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({reciprocal_:function(e){var t={x:(0,i._1)(e,"x","reciprocal")};return r.BV.runKernel(a.$HU,t)}})},7539:function(e,t,n){"use strict";n.d(t,{U:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({relu_:function(e){var t={x:(0,i._1)(e,"x","relu")};return r.BV.runKernel(a.qkr,t)}})},5900:function(e,t,n){"use strict";n.d(t,{b:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({relu6_:function(e){var t={x:(0,i._1)(e,"x","relu6")};return r.BV.runKernel(a.SbG,t)}})},5561:function(e,t,n){"use strict";n.d(t,{X:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({reshape_:function(e,t){var n={x:(0,i._1)(e,"x","reshape","string_or_numeric")},o={shape:t};return r.BV.runKernel(a.HZH,n,o)}})},4933:function(e,t,n){"use strict";n.d(t,{G:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({reverse_:function(e,t){var n={x:(0,i._1)(e,"x","reverse")},o={dims:t};return r.BV.runKernel(a.mKl,n,o)}})},766:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({round_:function(e){var t={x:(0,i._1)(e,"x","round")};return r.BV.runKernel(a.e07,t)}})},5115:function(e,t,n){"use strict";n.d(t,{b:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({rsqrt_:function(e){var t={x:(0,i._1)(e,"x","rsqrt","float32")};return r.BV.runKernel(a.bV0,t)}})},7067:function(e,t,n){"use strict";n.d(t,{i:function(){return i}});var r=n(115),a=n(7960);function i(e,t){if(((0,r.isTypedArray)(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&(0,r.isTypedArray)(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return(0,a.H)(e,[],[],t)}},413:function(e,t,n){"use strict";n.d(t,{U:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({selu_:function(e){var t={x:(0,i._1)(e,"x","selu")};return r.BV.runKernel(a.oFR,t)}})},349:function(e,t,n){"use strict";n.d(t,{$:function(){return a},y:function(){return r}});var r=1.7580993408473768,a=1.0507009873554805},119:function(e,t,n){"use strict";n.d(t,{U:function(){return c}});var r=n(8354),a=n(6147),i=n(3457),o=n(1147),u=n(8640),s=n(5561);var c=(0,u.op)({separableConv2d_:function(e,t,n,u,c){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",d=(0,r._1)(e,"x","separableConv2d"),h=(0,r._1)(t,"depthwiseFilter","separableConv2d"),p=(0,r._1)(n,"pointwiseFilter","separableConv2d"),v=d,g=!1;if(3===d.rank&&(g=!0,v=(0,s.X)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),"NCHW"===f)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");a.hu(4===v.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(v.rank,".")})),a.hu(4===h.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(h.rank,".")})),a.hu(4===p.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(h.rank,".")})),a.hu(1===p.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(p.shape[0],".")})),a.hu(1===p.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(p.shape[1],".")}));var m=h.shape[2],y=h.shape[3];a.hu(p.shape[2]===m*y,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(m*y,", ")+"but got ".concat(p.shape[2],".")}));var b=(0,o.B)(v,h,u,c,f,l),x=1,k=(0,i.T)(b,p,x,"valid",f);return g?(0,s.X)(k,[k.shape[1],k.shape[2],k.shape[3]]):k}})},7643:function(e,t,n){"use strict";n.d(t,{X:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({sigmoid_:function(e){var t={x:(0,i._1)(e,"x","sigmoid","float32")};return r.BV.runKernel(a.a5O,t)}})},2070:function(e,t,n){"use strict";n.d(t,{X:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({sign_:function(e){var t={x:(0,i._1)(e,"x","sign")};return r.BV.runKernel(a.i5y,t)}})},7254:function(e,t,n){"use strict";n.d(t,{O:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({sin_:function(e){var t={x:(0,i._1)(e,"x","sin","float32")};return r.BV.runKernel(a.RQH,t)}})},7657:function(e,t,n){"use strict";n.d(t,{R:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({sinh_:function(e){var t={x:(0,i._1)(e,"x","sinh")};return r.BV.runKernel(a.wYB,t)}})},9238:function(e,t,n){"use strict";n.d(t,{t:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({slice_:function(e,t,n){var o=(0,i._1)(e,"x","slice","string_or_numeric");if(0===o.rank)throw new Error("Slicing scalar is not possible");var u={x:o},s={begin:t,size:n};return r.BV.runKernel(a.p2w,u,s)}})},2875:function(e,t,n){"use strict";n.r(t),n.d(t,{assertParamsValid:function(){return i},computeFlatOffset:function(){return y},computeOutShape:function(){return u},getNormalizedAxes:function(){return f},isSliceContinous:function(){return m},maskToAxes:function(){return o},parseSliceParams:function(){return b},sliceInfo:function(){return x},startForAxis:function(){return v},startIndicesWithElidedDims:function(){return d},stopForAxis:function(){return g},stopIndicesWithElidedDims:function(){return h},stridesForAxis:function(){return p},stridesWithElidedDims:function(){return s}});var r=n(3433),a=n(6147);function i(e,t,n){var r=e.shape.length;a.hu(r===t.length,(function(){return"Error in slice".concat(r,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(r,").")})),a.hu(r===n.length,(function(){return"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,").")}));for(var i=function(i){a.hu(t[i]+n[i]<=e.shape[i],(function(){return"Error in slice".concat(r,"D: begin[").concat(i,"] + size[").concat(i,"] ")+"(".concat(t[i]+n[i],") would overflow input.shape[").concat(i,"] (").concat(e.shape[i],")")}))},o=0;o<r;++o)i(o)}function o(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function u(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function s(e,t,n,a){for(var i=(0,r.Z)(e),o=i.length;o<a.length;o++)i.push(1);for(var u=0;u<n;u++)0===u?i[t]=1:(i.splice(t,0,1),i.pop());return i}function c(e,t,n){return n<=e?n:n-(t-1)}function l(e,t){for(var n=[],r=0;r<e;r++)n.push(t+r);return n}function f(e,t,n,r,a,i,o,u,c){var l=e.length,f=new Array(l),m=new Array(l),y=new Array(l);if(t.length&&n>0){var b=t[0],x=n+1;f=d(o,b,x,r,e),m=h(u,b,x,a,e),y=s(i,b,x,e)}else for(var k=0;k<l;k++)f[k]=v(o,r,i,e,k,c),m[k]=g(u,a,i,e,k,c),y[k]=p(i,k,c);return{begin:f,end:m,strides:y}}function d(e,t,n,a,i){for(var o=(0,r.Z)(i),u=l(n,t),s=0;s<o.length;s++)if(u.indexOf(s)>-1)o[s]=0;else{var f=c(t,n,s),d=a[f];e&1<<f&&(d=0),o[s]=d}return o}function h(e,t,n,i,o){for(var u=(0,r.Z)(o),s=l(n,t),f=0;f<u.length;f++)if(s.indexOf(f)>-1)u[f]=Number.MAX_SAFE_INTEGER;else{var d=c(t,n,f),h=i[d];e&1<<d&&(h=Number.MAX_SAFE_INTEGER),u[f]=h}for(var p=0;p<u.length;p++){var v=o[p];u[p]<0&&(u[p]+=v),u[p]=a.uZ(0,u[p],o[p])}return u}function p(e,t,n){var r=e[t];return(n&1<<t||null==r)&&(r=1),r}function v(e,t,n,r,i,o){var u=t[i],s=n[i]||1;(e&1<<i||o&1<<i||null==u)&&(u=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var c=r[i];return u<0&&(u+=c),u=a.uZ(0,u,c-1)}function g(e,t,n,r,i,o){var u=t[i],s=n[i]||1;(e&1<<i||o&1<<i||null==u)&&(u=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var c=r[i];return u<0&&(u+=c),u=s>0?a.uZ(0,u,c):a.uZ(-1,u,c-1)}function m(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(var i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function y(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function b(e,t,n){var i,o,u=e.shape.length;return(i="number"===typeof t?[t].concat((0,r.Z)(new Array(u-1).fill(0))):t.length<u?t.concat(new Array(u-t.length).fill(0)):t.slice()).forEach((function(e){a.hu(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),o=(o=null==n?new Array(u).fill(-1):"number"===typeof n?[n].concat((0,r.Z)(new Array(u-1).fill(-1))):n.length<u?n.concat(new Array(u-n.length).fill(-1)):n).map((function(t,n){return t>=0?t:(a.hu(-1===t,(function(){return"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,".")})),e.shape[n]-i[n])})),[i,o]}function x(e,t,n,r,a,i,o,u,s){var c;if(null==r?(c=new Array(t.length)).fill(1):c=r,null!=o&&0!==(o&o-1))throw new Error("Multiple ellipses in slice is not allowed.");for(var l=!1,f={dims:c.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:c.slice(),beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:u,shrinkAxisMask:s},d=0;d<f.dims;d++)l&&0!==(1<<d&u)&&f.numAddAxisAfterEllipsis++,1<<d&o&&(l=!0);l||(f.ellipsisMask|=1<<f.dims,f.dims++);var h={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;var n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(var r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask)for(var a=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);n<a;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r;else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(-2),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error("Index out of range using input dim ".concat(n,"; input ")+"has only ".concat(t.dims," dims, ").concat(t.begin.length,"."));null!=e.begin&&(t.begin[n]=e.begin[r]),null!=e.end&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(-1),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}(f,h);for(var p=!0,v=!0,g=!0,m=[],y=[],b=0;b<e.length;++b){if(0===h.strides[b])throw Error("strides[".concat(b,"] must be non-zero"));var x=!!(h.shrinkAxisMask&1<<b),w=e[b];if(-1!==w){var _=[h.beginMask&1<<b,h.endMask&1<<b],C=[h.strides[b]>0?0:-1,h.strides[b]>0?w:w-1];if(x&&h.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&1===h.strides[b];var S=!!(h.beginMask&1<<b&&h.endMask&1<<b);if(h.beginValid&&h.endValid){if(x){var A=h.begin[b]<0?w+h.begin[b]:h.begin[b];if(h.begin[b]=A,h.end[b]=h.begin[b]+1,A<0||A>=w)throw Error("slice index ".concat(h.begin[b]," of dimension ").concat(b," out of bounds."))}else h.begin[b]=k(h.begin[b],0,h.strides[b],w,_,C),h.end[b]=k(h.end[b],1,h.strides[b],w,_,C);var E=1===h.strides[b]&&0===h.begin[b]&&h.end[b]===w;p=p&&E,v=v&&(0===b&&1===h.strides[b]||E)}else p=p&&1===h.strides[b]&&S,v=v&&(0===b&&1===h.strides[b]||S);var T=void 0,N=!1;if(h.beginValid&&h.endValid?(T=h.end[b]-h.begin[b],N=!0):x?(T=1,N=!0):S&&w>=0&&(T=h.strides[b]<0?-w:w,N=!0),N){var D=void 0;D=0===T||T<0!==h.strides[b]<0?0:Math.trunc(T/h.strides[b])+(T%h.strides[b]!==0?1:0),m.push(D)}else m.push(-1)}else m.push(x?1:-1)}for(var F=0;F<h.finalShapeGatherIndices.length;++F){var I=h.finalShapeGatherIndices[F];I>=0?y.push(m[I]):-2===I&&y.push(1)}var M=y.filter((function(e,t){return-2!==h.finalShapeGatherIndices[t]}));return{finalShapeSparse:M,finalShape:y,isIdentity:p,sliceDim0:v,isSimpleSlice:g,begin:h.begin,end:h.end,strides:h.strides}}function k(e,t,n,r,a,i){if(a[t])return n>0?i[t]:i[t+1&1];var o=e<0?r+e:e;return o<i[0]?i[0]:o>i[1]?i[1]:o}},4910:function(e,t,n){"use strict";n.d(t,{X:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({softmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=(0,i._1)(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));var o={logits:n},u={dim:t};return r.BV.runKernel(a.Gcp,o,u)}})},4626:function(e,t,n){"use strict";n.d(t,{W:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({softplus_:function(e){var t={x:(0,i._1)(e,"x","softplus")};return r.BV.runKernel(a.MRv,t)}})},5696:function(e,t,n){"use strict";n.d(t,{f:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({spaceToBatchND_:function(e,t,n){var u=(0,i._1)(e,"x","spaceToBatchND");o.hu(u.rank>=1+t.length,(function(){return"input rank ".concat(u.rank," should be > than [blockShape] ").concat(t.length)})),o.hu(n.length===t.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)})),o.hu(u.shape.reduce((function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]===0:e}),!0),(function(){return"input spatial dimensions ".concat(u.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())}));var s={x:u},c={blockShape:t,paddings:n};return r.BV.runKernel(a.TQc,s,c)}})},7635:function(e,t,n){"use strict";n.d(t,{k:function(){return o}});var r=n(318),a=n(2145),i=n(6147);var o=(0,n(8640).op)({fft_:function(e){(0,i.hu)("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return r.BV.runKernel(a.vwp,t)}})},530:function(e,t,n){"use strict";n.d(t,{S:function(){return o}});var r=n(318),a=n(2145),i=n(6147);var o=(0,n(8640).op)({ifft_:function(e){(0,i.hu)("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return r.BV.runKernel(a.Qg5,t)}})},774:function(e,t,n){"use strict";n.d(t,{w:function(){return p}});var r=n(9253),a=n(4836),i=n(6996),o=n(651),u=n(8640),s=n(6972),c=n(5561),l=n(4933),f=n(7067),d=n(9238),h=n(530);var p=(0,u.op)({irfft_:function(e){var t,n=e.shape[e.shape.length-1],u=e.size/n;if(n<=2){var p=(0,c.X)(e,[u,n]);t=(0,h.S)(p)}else{var v=[u,2*(n-1)],g=(0,c.X)((0,s.k)(e),[u,n]),m=(0,c.X)((0,i.a)(e),[u,n]),y=(0,l.G)((0,d.t)(g,[0,1],[u,n-2]),1),b=(0,o.d)((0,l.G)((0,d.t)(m,[0,1],[u,n-2]),1),(0,f.i)(-1)),x=(0,a.z)([g,y],1),k=(0,a.z)([m,b],1),w=(0,c.X)((0,r.P)(x,k),[v[0],v[1]]);t=(0,h.S)(w)}if(t=(0,s.k)(t),3===e.rank&&0!==e.shape[0]){var _=t,C=e.shape[0];t=(0,c.X)(t,[C,t.shape[0]/C,t.shape[1]]),_.dispose()}return t}})},4617:function(e,t,n){"use strict";n.d(t,{Q:function(){return v}});var r=n(6147),a=n(9253),i=n(4836),o=n(6996),u=n(8640),s=n(6972),c=n(5561),l=n(9238),f=n(2588),d=n(7742),h=n(7293),p=n(7635);var v=(0,u.op)({rfft_:function(e,t){(0,r.hu)("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(e.dtype)}));var n,u=e.shape[e.shape.length-1],v=e.size/u;if(null!=t&&t<u){var g=e.shape.map((function(e){return 0})),m=e.shape.map((function(e){return e}));m[e.shape.length-1]=t,n=(0,l.t)(e,g,m),u=t}else if(null!=t&&t>u){var y=e.shape.map((function(e){return e}));y[e.shape.length-1]=t-u,n=(0,i.z)([e,(0,d.l)(y)],e.shape.length-1),u=t}else n=e;var b=(0,h.P)(n),x=(0,c.X)((0,a.P)(n,b),[v,u]),k=(0,p.k)(x),w=Math.floor(u/2)+1,_=(0,s.k)(k),C=(0,o.a)(k),S=(0,f.V)(_,[w,u-w],_.shape.length-1),A=(0,f.V)(C,[w,u-w],C.shape.length-1),E=n.shape.slice();return E[n.shape.length-1]=w,(0,c.X)((0,a.P)(S[0],A[0]),E)}})},2588:function(e,t,n){"use strict";n.d(t,{V:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({split_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=(0,i._1)(e,"x","split"),u={x:o},s={numOrSizeSplits:t,axis:n};return r.BV.runKernel(a.L8s,u,s)}})},6902:function(e,t,n){"use strict";n.d(t,{_:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({sqrt_:function(e){var t={x:(0,i._1)(e,"x","sqrt","float32")};return r.BV.runKernel(a.FKq,t)}})},7391:function(e,t,n){"use strict";n.d(t,{h:function(){return i}});var r=n(318),a=n(8354);var i=(0,n(8640).op)({square_:function(e){var t=(0,a._1)(e,"x","square");return r.BV.runKernel("Square",{x:t},{})}})},7993:function(e,t,n){"use strict";n.d(t,{$:function(){return c}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354),s=n(5774);var c=(0,n(8640).op)({squaredDifference_:function(e,t){var n=(0,u._1)(e,"a","squaredDifference"),c=(0,u._1)(t,"b","squaredDifference"),l=(0,o.makeTypesMatch)(n,c),f=(0,r.Z)(l,2);n=f[0],c=f[1],(0,s.assertAndGetBroadcastShape)(n.shape,c.shape);var d={a:n,b:c};return a.BV.runKernel(i._tC,d,{})}})},3931:function(e,t,n){"use strict";n.d(t,{L:function(){return u}});var r=n(8354),a=n(6147),i=n(8640),o=n(5561);var u=(0,i.op)({squeeze_:function(e,t){var n=(0,r._1)(e,"x","squeeze","string_or_numeric");return(0,o.X)(n,(0,a.bp)(n.shape,t).newShape)}})},8306:function(e,t,n){"use strict";n.d(t,{k:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({stack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,i.sI)(e,"tensors","stack","string_or_numeric");o.hu(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),n.length>0&&o.hu(t<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"}));var u=n,s={axis:t};return r.BV.runKernel(a.QiL,u,s)}})},4031:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({step_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,i._1)(e,"x","step"),o={x:n},u={alpha:t};return r.BV.runKernel(a.h8e,o,u)}})},9017:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({stridedSlice_:function(e,t,n,o){var u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,f=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,d=(0,i._1)(e,"x","stridedSlice","string_or_numeric"),h={x:d},p={begin:t,end:n,strides:o,beginMask:u,endMask:s,ellipsisMask:c,newAxisMask:l,shrinkAxisMask:f};return r.BV.runKernel(a.jQk,h,p)}})},4774:function(e,t,n){"use strict";n.d(t,{l:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(9064),u=n(8354);var s=(0,n(8640).op)({sub_:function(e,t){var n=(0,u._1)(e,"a","sub"),s=(0,u._1)(t,"b","sub"),c=(0,o.makeTypesMatch)(n,s),l=(0,r.Z)(c,2),f={a:n=l[0],b:s=l[1]};return a.BV.runKernel(i.Tr8,f)}})},227:function(e,t,n){"use strict";n.d(t,{S:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(9118);var u=(0,n(8640).op)({sum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=(0,i._1)(e,"x","sum");"bool"===u.dtype&&(u=(0,o.p)(u,"int32"));var s={x:u},c={axis:t,keepDims:n};return r.BV.runKernel(a.GBy,s,c)}})},6999:function(e,t,n){"use strict";n.d(t,{O:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({tan_:function(e){var t={x:(0,i._1)(e,"x","tan","float32")};return r.BV.runKernel(a.sEM,t)}})},1744:function(e,t,n){"use strict";n.d(t,{A:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({tanh_:function(e){var t={x:(0,i._1)(e,"x","tanh","float32")};return r.BV.runKernel(a.MIZ,t)}})},7960:function(e,t,n){"use strict";n.d(t,{H:function(){return o}});var r=n(318),a=n(6147),i=n(115);function o(e,t,n,o){if(null==o)o=(0,a.D2)(e);else if("complex64"===o)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if("object"===typeof e&&("texture"in e||"buffer"in e&&!(e.buffer instanceof ArrayBuffer))){if("float32"!==o&&"int32"!==o)throw new Error("Creating tensor from GPU data only supports "+"'float32'|'int32' dtype, while the dtype is ".concat(o,"."));return r.BV.backend.createTensorFromGPUData(e,t||n,o)}if(!(0,i.isTypedArray)(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){(0,a.Mu)(t);var u=(0,a.NA)(t),s=(0,a.NA)(n);(0,a.hu)(u===s,(function(){return"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(u," values but has ").concat(s)}));for(var c=0;c<n.length;++c){var l=n[c],f=c!==n.length-1||l!==(0,a.NA)(t.slice(c));(0,a.hu)(n[c]===t[c]||!f,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). ")}))}}return(0,i.isTypedArray)(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==o?(0,i.toTypedArray)(e,o):(0,i.flatten)(e,[],!0),r.BV.makeTensor(e,t,o)}},2343:function(e,t,n){"use strict";n.d(t,{G:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({tile_:function(e,t){var n=(0,i._1)(e,"x","tile","string_or_numeric");o.hu(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,".")}));var u={x:n},s={reps:t};return r.BV.runKernel(a.n9L,u,s)}})},9085:function(e,t,n){"use strict";n.d(t,{h:function(){return u}});var r=n(9439),a=n(318),i=n(2145),o=n(8354);var u=(0,n(8640).op)({topk_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],u=(0,o._1)(e,"x","topk");if(0===u.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var s=u.shape[u.shape.length-1];if(t<0)throw new Error("'k' passed to topk() must be >= 0 but got ".concat(t));if(t>s)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(s,") ")+"but got ".concat(t));var c={x:u},l={k:t,sorted:n},f=a.BV.runKernel(i.cWu,c,l),d=(0,r.Z)(f,2),h=d[0],p=d[1];return{values:h,indices:p}}})},1240:function(e,t,n){"use strict";n.d(t,{p:function(){return h}});var r=n(318),a=n(5875),i=n(2145),o=n(8354),u=n(6147),s=n(9253),c=n(6996),l=n(4362),f=n(8640),d=n(6972);var h=(0,f.op)({transpose_:function(e,t,n){var f=(0,o._1)(e,"x","transpose");if(null==t&&(t=f.shape.map((function(e,t){return t})).reverse()),u.hu(f.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(f.rank," ")+"must match length of perm ".concat(t,".")})),t.forEach((function(e){u.hu(e>=0&&e<f.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(f.rank-1)+" but got ".concat(t)}))})),f.rank<=1)return f.clone();var h={x:f},p={perm:t};return"complex64"===f.dtype?(0,a.lu)((function(){var e=(0,d.k)(f),t=(0,c.a)(f);return e=r.BV.runKernel(i.G3Y,{x:e},p),t=r.BV.runKernel(i.G3Y,{x:t},p),n&&(t=(0,l.W)(t)),(0,s.P)(e,t)})):r.BV.runKernel(i.G3Y,h,p)}})},4860:function(e,t,n){"use strict";n.d(t,{T:function(){return s}});var r=n(9439),a=n(318),i=n(2145),o=n(8354),u=n(6147);var s=(0,n(8640).op)({unique_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,o._1)(e,"x","unique","string_or_numeric");(0,u.hu)(n.rank>0,(function(){return"The input tensor must be at least 1D"}));var s={x:n},c={axis:t},l=a.BV.runKernel(i.kpP,s,c),f=(0,r.Z)(l,2),d=f[0],h=f[1];return{values:d,indices:h}}})},6918:function(e,t,n){"use strict";n.d(t,{p:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({unsortedSegmentSum_:function(e,t,n){var u=(0,i._1)(e,"x","unsortedSegmentSum"),s=(0,i._1)(t,"segmentIds","unsortedSegmentSum","int32");(0,o.hu)((0,o.GN)(n),(function(){return"numSegments must be of dtype int"}));var c={x:u,segmentIds:s},l={numSegments:n};return r.BV.runKernel(a.Qvg,c,l)}})},4566:function(e,t,n){"use strict";n.d(t,{H:function(){return u}});var r=n(318),a=n(2145),i=n(8354),o=n(6147);var u=(0,n(8640).op)({unstack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(0,i._1)(e,"x","unstack","string_or_numeric");o.hu(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")}));var u={value:n},s={axis:t};return r.BV.runKernel(a.ToN,u,s)}})},329:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var r=n(318),a=n(2145),i=n(8354),o=n(9742),u=n(5774);var s=(0,n(8640).op)({where_:function(e,t,n){var s=(0,i._1)(t,"a","where"),c=(0,i._1)(n,"b","where"),l=(0,i._1)(e,"condition","where","bool"),f=(0,u.assertAndGetBroadcastShape)((0,u.assertAndGetBroadcastShape)(l.shape,s.shape),c.shape),d={condition:(0,o.U)(l,f),t:(0,o.U)(s,f),e:(0,o.U)(c,f)};return r.BV.runKernel(a.PhF,d)}})},7742:function(e,t,n){"use strict";n.d(t,{l:function(){return o}});var r=n(318),a=n(6147),i=n(9253);function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if((0,a.Mu)(e),"complex64"===t){var n=o(e,"float32"),u=o(e,"float32");return(0,i.P)(n,u)}var s=(0,a.wT)((0,a.NA)(e),t);return r.BV.makeTensor(s,e,t)}},7293:function(e,t,n){"use strict";n.d(t,{P:function(){return o}});var r=n(318),a=n(2145),i=n(8354);var o=(0,n(8640).op)({zerosLike_:function(e){var t={x:(0,i._1)(e,"x","zerosLike")};return r.BV.runKernel(a.RuY,t)}})},4672:function(e,t,n){"use strict";n.r(t);var r=n(7613),a=n(4376);(0,a.t3)().prototype.abs=function(){return this.throwIfDisposed(),(0,r.W)(this)};var i=n(1719);(0,a.t3)().prototype.acos=function(){return this.throwIfDisposed(),(0,i.K)(this)};var o=n(4502);(0,a.t3)().prototype.acosh=function(){return this.throwIfDisposed(),(0,o._)(this)};var u=n(3312);(0,a.t3)().prototype.add=function(e){return this.throwIfDisposed(),(0,u.I)(this,e)};var s=n(4108);(0,a.t3)().prototype.all=function(e,t){return this.throwIfDisposed(),(0,s.$)(this,e,t)};var c=n(8543);(0,a.t3)().prototype.any=function(e,t){return this.throwIfDisposed(),(0,c.Y)(this,e,t)};var l=n(9995);(0,a.t3)().prototype.argMax=function(e){return this.throwIfDisposed(),(0,l.N)(this,e)};var f=n(5157);(0,a.t3)().prototype.argMin=function(e){return this.throwIfDisposed(),(0,f.v)(this,e)};var d=n(5561),h=n(6147);(0,a.t3)().prototype.asScalar=function(){return this.throwIfDisposed(),(0,h.hu)(1===this.size,(function(){return"The array must have only 1 element."})),(0,d.X)(this,[])};var p=n(9118);(0,a.t3)().prototype.asType=function(e){return this.throwIfDisposed(),(0,p.p)(this,e)},(0,a.t3)().prototype.as1D=function(){return this.throwIfDisposed(),(0,d.X)(this,[this.size])},(0,a.t3)().prototype.as2D=function(e,t){return this.throwIfDisposed(),(0,d.X)(this,[e,t])},(0,a.t3)().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),(0,d.X)(this,[e,t,n])},(0,a.t3)().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),(0,d.X)(this,[e,t,n,r])},(0,a.t3)().prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),(0,d.X)(this,[e,t,n,r,a])};var v=n(3053);(0,a.t3)().prototype.asin=function(){return this.throwIfDisposed(),(0,v.Z)(this)};var g=n(54);(0,a.t3)().prototype.asinh=function(){return this.throwIfDisposed(),(0,g.V)(this)};var m=n(4778);(0,a.t3)().prototype.atan=function(){return this.throwIfDisposed(),(0,m.z)(this)};var y=n(2227);(0,a.t3)().prototype.atan2=function(e){return this.throwIfDisposed(),(0,y.f)(this,e)};var b=n(7897);(0,a.t3)().prototype.atanh=function(){return this.throwIfDisposed(),(0,b.C)(this)};var x=n(9204);(0,a.t3)().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),(0,x.w)(this,e,t,n,r)};var k=n(6994);(0,a.t3)().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),(0,k.E)(this,e,t)};var w=n(3700);(0,a.t3)().prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),(0,w.t)(this,e,t,n,r,a)};var _=n(9742);(0,a.t3)().prototype.broadcastTo=function(e){return this.throwIfDisposed(),(0,_.U)(this,e)},(0,a.t3)().prototype.cast=function(e){return this.throwIfDisposed(),(0,p.p)(this,e)};var C=n(1396);(0,a.t3)().prototype.ceil=function(){return this.throwIfDisposed(),(0,C.m)(this)};var S=n(9836);(0,a.t3)().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),(0,S.i)(this,e,t)};var A=n(3433),E=n(4836);(0,a.t3)().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof a.es&&(e=[e]),(0,E.z)([this].concat((0,A.Z)(e)),t)};var T=n(4918);(0,a.t3)().prototype.conv1d=function(e,t,n,r,a,i){return this.throwIfDisposed(),(0,T.P)(this,e,t,n,r,a,i)};var N=n(1732);(0,a.t3)().prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),(0,N.b)(this,e,t,n,r,a)};var D=n(3457);(0,a.t3)().prototype.conv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),(0,D.T)(this,e,t,n,r,a,i)};var F=n(1227);(0,a.t3)().prototype.cos=function(){return this.throwIfDisposed(),(0,F.m)(this)};var I=n(6679);(0,a.t3)().prototype.cosh=function(){return this.throwIfDisposed(),(0,I.f)(this)};var M=n(9457);(0,a.t3)().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),(0,M.$)(this,e,t,n)};var O=n(8862);(0,a.t3)().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),(0,O.z)(this,e,t,n)};var R=n(1878);(0,a.t3)().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),(0,R.n)(this,e,t)};var Z=n(1147);(0,a.t3)().prototype.depthwiseConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),(0,Z.B)(this,e,t,n,r,a,i)};var B=n(7580);(0,a.t3)().prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),(0,B.W)(this,e,t,n,r,a)};var z=n(5923);(0,a.t3)().prototype.divNoNan=function(e){return this.throwIfDisposed(),(0,z.N)(this,e)};var L=n(5750);(0,a.t3)().prototype.div=function(e){return this.throwIfDisposed(),(0,L.h)(this,e)};var P=n(5043);(0,a.t3)().prototype.dot=function(e){return this.throwIfDisposed(),(0,P.A)(this,e)};var j=n(2353);(0,a.t3)().prototype.elu=function(){return this.throwIfDisposed(),(0,j.p)(this)};var U=n(3254);(0,a.t3)().prototype.equal=function(e){return this.throwIfDisposed(),(0,U.D)(this,e)};var W=n(3891);(0,a.t3)().prototype.erf=function(){return this.throwIfDisposed(),(0,W.q)(this)};var V=n(3313);(0,a.t3)().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),(0,V.d)(this,e,t)};var G=n(411);(0,a.t3)().prototype.exp=function(){return this.throwIfDisposed(),(0,G.Q)(this)};var q=n(2975);(0,a.t3)().prototype.expandDims=function(e){return this.throwIfDisposed(),(0,q.d)(this,e)};var H=n(5682);(0,a.t3)().prototype.expm1=function(){return this.throwIfDisposed(),(0,H.t)(this)};var X=n(7635);(0,a.t3)().prototype.fft=function(){return this.throwIfDisposed(),(0,X.k)(this)},(0,a.t3)().prototype.flatten=function(){return this.throwIfDisposed(),(0,d.X)(this,[this.size])};var Y=n(2628);(0,a.t3)().prototype.floor=function(){return this.throwIfDisposed(),(0,Y.G)(this)};var K=n(7145);(0,a.t3)().prototype.floorDiv=function(e){return this.throwIfDisposed(),(0,K.q)(this,e)};var $=n(9498);(0,a.t3)().prototype.gather=function(e,t){return this.throwIfDisposed(),(0,$.I)(this,e,t)};var Q=n(8327);(0,a.t3)().prototype.greaterEqual=function(e){return this.throwIfDisposed(),(0,Q.b)(this,e)};var J=n(5014);(0,a.t3)().prototype.greater=function(e){return this.throwIfDisposed(),(0,J.p)(this,e)};var ee=n(530);(0,a.t3)().prototype.ifft=function(){return this.throwIfDisposed(),(0,ee.S)(this)};var te=n(774);(0,a.t3)().prototype.irfft=function(){return this.throwIfDisposed(),(0,te.w)(this)};var ne=n(300);(0,a.t3)().prototype.isFinite=function(){return this.throwIfDisposed(),(0,ne.x)(this)};var re=n(4652);(0,a.t3)().prototype.isInf=function(){return this.throwIfDisposed(),(0,re.U)(this)};var ae=n(7005);(0,a.t3)().prototype.isNaN=function(){return this.throwIfDisposed(),(0,ae.i)(this)};var ie=n(4419);(0,a.t3)().prototype.leakyRelu=function(e){return this.throwIfDisposed(),(0,ie.h)(this,e)};var oe=n(2642);(0,a.t3)().prototype.lessEqual=function(e){return this.throwIfDisposed(),(0,oe.z)(this,e)};var ue=n(4920);(0,a.t3)().prototype.less=function(e){return this.throwIfDisposed(),(0,ue.d)(this,e)};var se=n(936);(0,a.t3)().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),(0,se.G)(this,e,t,n,r)};var ce=n(5113);(0,a.t3)().prototype.logSigmoid=function(){return this.throwIfDisposed(),(0,ce.e)(this)};var le=n(4561);(0,a.t3)().prototype.logSoftmax=function(e){return this.throwIfDisposed(),(0,le.C)(this,e)};var fe=n(5530);(0,a.t3)().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),(0,fe.l)(this,e,t)};var de=n(378);(0,a.t3)().prototype.log=function(){return this.throwIfDisposed(),(0,de.c)(this)};var he=n(5341);(0,a.t3)().prototype.log1p=function(){return this.throwIfDisposed(),(0,he.K)(this)};var pe=n(2177);(0,a.t3)().prototype.logicalAnd=function(e){return this.throwIfDisposed(),(0,pe.H)(this,e)};var ve=n(875);(0,a.t3)().prototype.logicalNot=function(){return this.throwIfDisposed(),(0,ve.h)(this)};var ge=n(5117);(0,a.t3)().prototype.logicalOr=function(e){return this.throwIfDisposed(),(0,ge.K)(this,e)};var me=n(1712);(0,a.t3)().prototype.logicalXor=function(e){return this.throwIfDisposed(),(0,me.e)(this,e)};var ye=n(7221);(0,a.t3)().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),(0,ye.O)(this,e,t,n)};var be=n(5777);(0,a.t3)().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),(0,be._)(this,e,t,n,r)};var xe=n(6176);(0,a.t3)().prototype.max=function(e,t){return this.throwIfDisposed(),(0,xe.F)(this,e,t)};var ke=n(705);(0,a.t3)().prototype.maximum=function(e){return this.throwIfDisposed(),(0,ke.g)(this,e)};var we=n(6568);(0,a.t3)().prototype.mean=function(e,t){return this.throwIfDisposed(),(0,we.J)(this,e,t)};var _e=n(7891);(0,a.t3)().prototype.min=function(e,t){return this.throwIfDisposed(),(0,_e.V)(this,e,t)};var Ce=n(2273);(0,a.t3)().prototype.minimum=function(e){return this.throwIfDisposed(),(0,Ce.L)(this,e)};var Se=n(9719);(0,a.t3)().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),(0,Se.V)(this,e,t)};var Ae=n(4645);(0,a.t3)().prototype.mod=function(e){return this.throwIfDisposed(),(0,Ae.w)(this,e)};var Ee=n(651);(0,a.t3)().prototype.mul=function(e){return this.throwIfDisposed(),(0,Ee.d)(this,e)};var Te=n(4362);(0,a.t3)().prototype.neg=function(){return this.throwIfDisposed(),(0,Te.W)(this)};var Ne=n(6662);(0,a.t3)().prototype.norm=function(e,t,n){return this.throwIfDisposed(),(0,Ne.K)(this,e,t,n)};var De=n(5549);(0,a.t3)().prototype.notEqual=function(e){return this.throwIfDisposed(),(0,De.Q)(this,e)};var Fe=n(4326);(0,a.t3)().prototype.oneHot=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),(0,Fe.l)(this,e,t,n)};var Ie=n(773);(0,a.t3)().prototype.onesLike=function(){return this.throwIfDisposed(),(0,Ie.J)(this)};var Me=n(1970);(0,a.t3)().prototype.pad=function(e,t){return this.throwIfDisposed(),(0,Me.v)(this,e,t)};var Oe=n(7226);(0,a.t3)().prototype.pool=function(e,t,n,r,a,i){return this.throwIfDisposed(),(0,Oe.d)(this,e,t,n,r,a,i)};var Re=n(4334);(0,a.t3)().prototype.pow=function(e){return this.throwIfDisposed(),(0,Re.s)(this,e)};var Ze=n(6859);(0,a.t3)().prototype.prelu=function(e){return this.throwIfDisposed(),(0,Ze.A)(this,e)};var Be=n(7722);(0,a.t3)().prototype.prod=function(e,t){return this.throwIfDisposed(),(0,Be.W)(this,e,t)};var ze=n(2209);(0,a.t3)().prototype.reciprocal=function(){return this.throwIfDisposed(),(0,ze.M)(this)};var Le=n(7539);(0,a.t3)().prototype.relu=function(){return this.throwIfDisposed(),(0,Le.U)(this)};var Pe=n(5900);(0,a.t3)().prototype.relu6=function(){return this.throwIfDisposed(),(0,Pe.b)(this)},(0,a.t3)().prototype.reshapeAs=function(e){return this.throwIfDisposed(),(0,d.X)(this,e.shape)},(0,a.t3)().prototype.reshape=function(e){return this.throwIfDisposed(),(0,d.X)(this,e)};var je=n(464);(0,a.t3)().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),(0,je.I)(this,e,t,n)};var Ue=n(8600);(0,a.t3)().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),(0,Ue.j)(this,e,t,n)};var We=n(4933);(0,a.t3)().prototype.reverse=function(e){return this.throwIfDisposed(),(0,We.G)(this,e)};var Ve=n(4617);(0,a.t3)().prototype.rfft=function(){return this.throwIfDisposed(),(0,Ve.Q)(this)};var Ge=n(766);(0,a.t3)().prototype.round=function(){return this.throwIfDisposed(),(0,Ge.N)(this)};var qe=n(5115);(0,a.t3)().prototype.rsqrt=function(){return this.throwIfDisposed(),(0,qe.b)(this)};var He=n(413);(0,a.t3)().prototype.selu=function(){return this.throwIfDisposed(),(0,He.U)(this)};var Xe=n(119);(0,a.t3)().prototype.separableConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),(0,Xe.U)(this,e,t,n,r,a,i)};var Ye=n(7643);(0,a.t3)().prototype.sigmoid=function(){return this.throwIfDisposed(),(0,Ye.X)(this)};var Ke=n(2070);(0,a.t3)().prototype.sign=function(){return this.throwIfDisposed(),(0,Ke.X)(this)};var $e=n(7254);(0,a.t3)().prototype.sin=function(){return this.throwIfDisposed(),(0,$e.O)(this)};var Qe=n(7657);(0,a.t3)().prototype.sinh=function(){return this.throwIfDisposed(),(0,Qe.R)(this)};var Je=n(9238);(0,a.t3)().prototype.slice=function(e,t){return this.throwIfDisposed(),(0,Je.t)(this,e,t)};var et=n(4910);(0,a.t3)().prototype.softmax=function(e){return this.throwIfDisposed(),(0,et.X)(this,e)};var tt=n(4626);(0,a.t3)().prototype.softplus=function(){return this.throwIfDisposed(),(0,tt.W)(this)};var nt=n(5696);(0,a.t3)().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),(0,nt.f)(this,e,t)};var rt=n(2588);(0,a.t3)().prototype.split=function(e,t){return this.throwIfDisposed(),(0,rt.V)(this,e,t)};var at=n(6902);(0,a.t3)().prototype.sqrt=function(){return this.throwIfDisposed(),(0,at._)(this)};var it=n(7391);(0,a.t3)().prototype.square=function(){return this.throwIfDisposed(),(0,it.h)(this)};var ot=n(7993);(0,a.t3)().prototype.squaredDifference=function(e){return this.throwIfDisposed(),(0,ot.$)(this,e)};var ut=n(3931);(0,a.t3)().prototype.squeeze=function(e){return this.throwIfDisposed(),(0,ut.L)(this,e)};var st=n(8306);(0,a.t3)().prototype.stack=function(e,t){this.throwIfDisposed();var n=e instanceof a.es?[this,e]:[this].concat((0,A.Z)(e));return(0,st.k)(n,t)};var ct=n(4031);(0,a.t3)().prototype.step=function(e){return this.throwIfDisposed(),(0,ct.N)(this,e)};var lt=n(9017);(0,a.t3)().prototype.stridedSlice=function(e,t,n,r,a,i,o,u){return this.throwIfDisposed(),(0,lt.N)(this,e,t,n,r,a,i,o,u)};var ft=n(4774);(0,a.t3)().prototype.sub=function(e){return this.throwIfDisposed(),(0,ft.l)(this,e)};var dt=n(227);(0,a.t3)().prototype.sum=function(e,t){return this.throwIfDisposed(),(0,dt.S)(this,e,t)};var ht=n(6999);(0,a.t3)().prototype.tan=function(){return this.throwIfDisposed(),(0,ht.O)(this)};var pt=n(1744);(0,a.t3)().prototype.tanh=function(){return this.throwIfDisposed(),(0,pt.A)(this)};var vt=n(2343);(0,a.t3)().prototype.tile=function(e){return this.throwIfDisposed(),(0,vt.G)(this,e)},(0,a.t3)().prototype.toBool=function(){return this.throwIfDisposed(),(0,p.p)(this,"bool")},(0,a.t3)().prototype.toFloat=function(){return this.throwIfDisposed(),(0,p.p)(this,"float32")},(0,a.t3)().prototype.toInt=function(){return this.throwIfDisposed(),(0,p.p)(this,"int32")};var gt=n(9085);(0,a.t3)().prototype.topk=function(e,t){return this.throwIfDisposed(),(0,gt.h)(this,e,t)};var mt=n(1240);(0,a.t3)().prototype.transpose=function(e){return this.throwIfDisposed(),(0,mt.p)(this,e)};var yt=n(4860);(0,a.t3)().prototype.unique=function(e){return this.throwIfDisposed(),(0,yt.T)(this,e)};var bt=n(6918);(0,a.t3)().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),(0,bt.p)(this,e,t)};var xt=n(4566);(0,a.t3)().prototype.unstack=function(e){return this.throwIfDisposed(),(0,xt.H)(this,e)};var kt=n(329);(0,a.t3)().prototype.where=function(e,t){return this.throwIfDisposed(),(0,kt.a)(e,this,t)};var wt=n(7293);(0,a.t3)().prototype.zerosLike=function(){return this.throwIfDisposed(),(0,wt.P)(this)}},4376:function(e,t,n){"use strict";n.d(t,{es:function(){return C},YD:function(){return y},_w:function(){return A},t3:function(){return S},FZ:function(){return _},Vp:function(){return w},Vi:function(){return k}});var r=n(136),a=n(7277),i=n(4165),o=n(5861),u=n(5671),s=n(3144),c=n(6581),l=n(3433),f=n(6147);function d(e,t,n,r){var a=(0,f.e3)(t),i=function(e,t,n,r){var a=(0,f.NA)(t),i=r[r.length-1],o=new Array(i).fill(0),u=t.length,s="complex64"===n?g(e):e;if(u>1)for(var c=0;c<a/i;c++)for(var l=c*i,d=0;d<i;d++)o[d]=Math.max(o[d],h(s[l+d],0,n).length);return o}(e,t,n,a),o=t.length,u=v(e,t,n,a,i),s=["Tensor"];return r&&(s.push("  dtype: ".concat(n)),s.push("  rank: ".concat(o)),s.push("  shape: [".concat(t,"]")),s.push("  values:")),s.push(u.map((function(e){return"    "+e})).join("\n")),s.join("\n")}function h(e,t,n){var r;return r=Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ")+"".concat(parseFloat(e[1].toFixed(7)),"j"):(0,f.HD)(e)?"'".concat(e,"'"):"bool"===n?p(e):parseFloat(e.toFixed(7)).toString(),(0,f.oj)(r,t)}function p(e){return 0===e?"false":"true"}function v(e,t,n,r,a){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o="complex64"===n?2:1,u=t[0],s=t.length;if(0===s){if("complex64"===n){var c=g(e);return[h(c[0],0,n)]}return"bool"===n?[p(e[0])]:[e[0].toString()]}if(1===s){if(u>20){var f=3*o,d=Array.from(e.slice(0,f)),m=Array.from(e.slice((u-3)*o,u*o));return"complex64"===n&&(d=g(d),m=g(m)),["["+d.map((function(e,t){return h(e,a[t],n)})).join(", ")+", ..., "+m.map((function(e,t){return h(e,a[u-3+t],n)})).join(", ")+"]"]}var y="complex64"===n?g(e):Array.from(e);return["["+y.map((function(e,t){return h(e,a[t],n)})).join(", ")+"]"]}var b=t.slice(1),x=r.slice(1),k=r[0]*o,w=[];if(u>20){for(var _=0;_<3;_++){var C=_*k,S=C+k;w.push.apply(w,(0,l.Z)(v(e.slice(C,S),b,n,x,a,!1)))}w.push("...");for(var A=u-3;A<u;A++){var E=A*k,T=E+k;w.push.apply(w,(0,l.Z)(v(e.slice(E,T),b,n,x,a,A===u-1)))}}else for(var N=0;N<u;N++){var D=N*k,F=D+k;w.push.apply(w,(0,l.Z)(v(e.slice(D,F),b,n,x,a,N===u-1)))}var I=2===s?",":"";w[0]="["+(u>0?w[0]+I:"");for(var M=1;M<w.length-1;M++)w[M]=" "+w[M]+I;for(var O=",\n",R=2;R<s;R++)O+="\n";return w[w.length-1]=" "+w[w.length-1]+"]"+(i?"":O),w}function g(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var m=n(115),y=function(){function e(t,n,r){var a=this;if((0,u.Z)(this,e),this.dtype=n,this.shape=t.slice(),this.size=f.NA(t),null!=r){var i=r.length;f.hu(i===this.size,(function(){return"Length of values '".concat(i,"' does not match the size ")+"inferred by the shape '".concat(a.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||f.rQ(n,this.size),this.strides=(0,f.e3)(t)}return(0,s.Z)(e,[{key:"set",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];0===r.length&&(r=[0]),f.hu(r.length===this.rank,(function(){return"The number of provided coordinates (".concat(r.length,") must ")+"match the rank (".concat(t.rank,")")}));var i=this.locToIndex(r);this.values[i]=e}},{key:"get",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);for(var r=0,a=0,i=t;a<i.length;a++){var o=i[a];if(o<0||o>=this.shape[r]){var u="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(u)}r++}for(var s=t[t.length-1],c=0;c<t.length-1;++c)s+=this.strides[c]*t[c];return this.values[s]}},{key:"locToIndex",value:function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}},{key:"indexToLoc",value:function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}},{key:"rank",get:function(){return this.shape.length}},{key:"toTensor",value:function(){return b().makeTensor(this.values,this.shape,this.dtype)}}]),e}(),b=null,x=null;function k(e){b=e}function w(e){x=e}function _(e){e}var C=function(){function e(t,n,r,a){(0,u.Z)(this,e),this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=f.NA(t),this.strides=(0,f.e3)(t),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return(0,s.Z)(e,[{key:"rank",get:function(){return this.shape.length}},{key:"buffer",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",x.buffer(this.shape,this.dtype,t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bufferSync",value:function(){return x.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",(0,f.GX)(this.shape,t,"complex64"===this.dtype));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"arraySync",value:function(){return(0,f.GX)(this.shape,this.dataSync(),"complex64"===this.dtype)}},{key:"data",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t,n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.throwIfDisposed(),t=b().read(this.dataId),"string"!==this.dtype){e.next=13;break}return e.next=5,t;case 5:return n=e.sent,e.prev=6,e.abrupt("return",n.map((function(e){return m.decodeString(e)})));case 10:throw e.prev=10,e.t0=e.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[6,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"dataToGPU",value:function(e){return this.throwIfDisposed(),b().readToGPU(this.dataId,e)}},{key:"dataSync",value:function(){this.throwIfDisposed();var e=b().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return m.decodeString(e)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}},{key:"bytes",value:function(){var e=(0,o.Z)((0,i.Z)().mark((function e(){var t;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfDisposed(),e.next=3,b().read(this.dataId);case 3:if(t=e.sent,"string"!==this.dtype){e.next=8;break}return e.abrupt("return",t);case 8:return e.abrupt("return",new Uint8Array(t.buffer));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){this.isDisposed||(b().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"isDisposed",get:function(){return this.isDisposedInternal}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"print",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return x.print(this,e)}},{key:"clone",value:function(){return this.throwIfDisposed(),x.clone(this)}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.dataSync();return d(t,this.shape,this.dtype,e)}},{key:"cast",value:function(e){return this.throwIfDisposed(),x.cast(this,e)}},{key:"variable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),b().makeVariable(this,e,t,n)}}]),e}();function S(){return(0,c.R)("Tensor",(function(){return C}))}Object.defineProperty(C,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}}),S();var A=function(e){(0,r.Z)(n,e);var t=(0,a.Z)(n);function n(e,r,a,i){var o;return(0,u.Z)(this,n),(o=t.call(this,e.shape,e.dtype,e.dataId,i)).trainable=r,o.name=a,o}return(0,s.Z)(n,[{key:"assign",value:function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!f.cO(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));b().disposeTensor(this),this.dataId=e.dataId,b().incRef(this,null)}},{key:"dispose",value:function(){b().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(C);Object.defineProperty(A,Symbol.hasInstance,{value:function(e){return e instanceof C&&null!=e.assign&&e.assign instanceof Function}})},9064:function(e,t,n){"use strict";n.r(t),n.d(t,{assertTypesMatch:function(){return u},getTensorsInContainer:function(){return c},isTensorInList:function(){return s},makeTypesMatch:function(){return o}});var r=n(4376),a=n(3525),i=n(6147);function o(e,t){if(e.dtype===t.dtype)return[e,t];var n=(0,a.x8)(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function u(e,t){(0,i.hu)(e.dtype===t.dtype,(function(){return"The dtypes of the first(".concat(e.dtype,") and")+" second(".concat(t.dtype,") input must match")}))}function s(e,t){return t.some((function(t){return t.id===e.id}))}function c(e){var t=[];return l(e,t,new Set),t}function l(e,t,n){if(null!=e)if(e instanceof r.es)t.push(e);else if(a=e,Array.isArray(a)||"object"===typeof a){var a,i=e;for(var o in i){var u=i[o];n.has(u)||(n.add(u),l(u,t,n))}}}},8354:function(e,t,n){"use strict";n.d(t,{C:function(){return s},_1:function(){return f},sI:function(){return d}});var r=n(318),a=n(5050),i=n(4376),o=n(115),u=n(6147);function s(e,t){var n=e;if((0,o.isTypedArray)(e))return"string"===t?[]:[e.length];if("object"===typeof e){if("texture"in e){var r=e.channels||"RGBA";return[e.height,e.width*r.length]}if("buffer"in e&&!(e.buffer instanceof ArrayBuffer))return[e.buffer.size/(null==t?4:(0,u.bT)(t))]}if(!Array.isArray(e))return[];for(var i=[];Array.isArray(n)||(0,o.isTypedArray)(n)&&"string"!==t;)i.push(n.length),n=n[0];return Array.isArray(e)&&(0,a.OB)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&c(e,i,[]),i}function c(e,t,n){if(n=n||[],Array.isArray(e)||(0,o.isTypedArray)(e)){(0,u.hu)(t.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements")})),(0,u.hu)(e.length===t[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements")}));for(var r=t.slice(1),a=0;a<e.length;++a)c(e[a],r,n.concat(a))}else(0,u.hu)(0===t.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements")}))}function l(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}}function f(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof i.es)return l(a,e.dtype,t,n),e;var c=(0,u.D2)(e);if("string"!==c&&["bool","int32","float32"].indexOf(a)>=0&&(c=a),l(a,c,t,n),null==e||!(0,o.isTypedArray)(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){var f=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(f,"'"))}var d=s(e,c);(0,o.isTypedArray)(e)||Array.isArray(e)||(e=[e]);var h=!0,p="string"!==c?(0,o.toTypedArray)(e,c):(0,o.flatten)(e,[],h);return r.BV.makeTensor(p,d,c)}function d(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");var a=e;return a.map((function(e,a){return f(e,"".concat(t,"[").concat(a,"]"),n,r)}))}},3525:function(e,t,n){"use strict";var r,a,i,o,u;n.d(t,{x8:function(){return c},yw:function(){return r},z4:function(){return l}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(r||(r={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(a||(a={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(i||(i={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(o||(o={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(u||(u={}));var s={float32:o,int32:a,bool:i,complex64:u};function c(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return s[e][t]}function l(e){return c(e,"int32")}},115:function(e,t,n){"use strict";n.r(t),n.d(t,{arraysEqual:function(){return a.cO},assert:function(){return a.hu},assertNonNegativeIntegerDimensions:function(){return a.Mu},assertNonNull:function(){return a.Cq},assertShapesMatch:function(){return a.k5},bytesFromStringArray:function(){return a.Ub},bytesPerElement:function(){return a.bT},checkConversionForErrors:function(){return a.D5},clamp:function(){return a.uZ},computeStrides:function(){return a.e3},convertBackendValuesAndArrayBuffer:function(){return a.KS},createScalarValue:function(){return w},createShuffledIndices:function(){return a.U$},decodeString:function(){return E},distSquared:function(){return a.E7},encodeString:function(){return A},fetch:function(){return S},fingerPrint64:function(){return k},flatten:function(){return N},getArrayFromDType:function(){return a.rQ},getTypedArrayFromDType:function(){return a.WP},hasEncodingLoss:function(){return a.QB},hexToLong:function(){return u},indexToLoc:function(){return a.NE},inferDtype:function(){return a.D2},inferFromImplicitShape:function(){return a.JZ},isBoolean:function(){return a.jn},isFunction:function(){return a.mf},isInt:function(){return a.GN},isNumber:function(){return a.hj},isPromise:function(){return a.tI},isScalarShape:function(){return a.xH},isString:function(){return a.HD},isTypedArray:function(){return T},isValidDtype:function(){return a.LP},locToIndex:function(){return a.qy},makeOnesTypedArray:function(){return a.p8},makeZerosNestedTypedArray:function(){return a.l6},makeZerosTypedArray:function(){return a.wT},nearestDivisor:function(){return a.jP},nearestLargerEven:function(){return a.nY},now:function(){return C},parseAxisParam:function(){return a.EC},randUniform:function(){return a.bj},repeatedTry:function(){return a.WD},rightPad:function(){return a.oj},shuffle:function(){return a.TV},shuffleCombo:function(){return a.d7},sizeFromShape:function(){return a.NA},sizeToSquarishShape:function(){return a.YP},squeezeShape:function(){return a.bp},sum:function(){return a.Sm},swap:function(){return a.LF},tanh:function(){return a.AE},toNestedArray:function(){return a.GX},toTypedArray:function(){return _}});var r=n(5050),a=n(6147),i=n(8987),o=n.n(i)()||i;function u(e){return o.fromString(e,!0,16)}var s=u("c3a5c85c97cb3127"),c=u("b492b66fbe98f273"),l=u("9ae16a3b2f90404f");function f(e){return e.xor(e.shru(47))}function d(e,t,n){var r=e.slice(t,t+n);return o.fromBytes(Array.from(r),!0,!0)}function h(e,t){return d(e,t,8)}function p(e,t){return d(e,t,4)}function v(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function g(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u("9ddfea08eb382d69"),r=e.xor(t).mul(n);r=r.xor(r.shru(47));var a=t.xor(r).mul(n);return a=(a=a.xor(a.shru(47))).mul(n)}function m(e,t,n,r){return function(e,t,n,r,a,i){a=a.add(e),i=v(i.add(a).add(r),21);var o=a;return a=(a=a.add(t)).add(n),i=i.add(v(a,44)),[a.add(r),i.add(o)]}(h(e,t),h(e,t+8),h(e,t+16),h(e,t+24),n,r)}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length;if(t>=8){var n=l.add(2*t),r=h(e,0).add(l),a=h(e,t-8),i=v(a,37).mul(n).add(r),o=v(r,25).add(a).mul(n);return g(i,o,n)}if(t>=4){var u=l.add(2*t),c=p(e,0);return g(c.shl(3).add(t),p(e,t-4),u)}if(t>0){var d=e[0],m=e[t>>1],y=e[t-1],b=d+(m<<8),x=t+(y<<2);return f(l.mul(b).xor(s.mul(x))).mul(l)}return l}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=l.add(2*t),r=h(e,0).mul(c),a=h(e,8),i=h(e,t-8).mul(n),o=h(e,t-16).mul(l);return g(v(r.add(a),43).add(v(i,30)).add(o),r.add(v(a.add(l),18)).add(i),n)}function x(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=l.add(2*t),r=h(e,0).mul(l),a=h(e,8),i=h(e,t-8).mul(n),o=h(e,t-16).mul(l),u=v(r.add(a),43).add(v(i,30)).add(o),s=g(u,r.add(v(a.add(l),18)).add(i),n),c=h(e,16).mul(n),f=h(e,24),d=u.add(h(e,t-32)).mul(n),p=s.add(h(e,t-24)).mul(n);return g(v(c.add(f),43).add(v(d,30)).add(p),c.add(v(f.add(r),18)).add(d),n)}function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.length,n=o.fromNumber(81,!0);if(t<=32)return t<=16?y(e,t):b(e,t);if(t<=64)return x(e,t);var r=n,a=n.mul(c).add(113),i=f(a.mul(l).add(113)).mul(l),u=[o.UZERO,o.UZERO],d=[o.UZERO,o.UZERO];r=r.mul(l).add(h(e,0));var p=0,k=64*(t-1>>6),w=k+(t-1&63)-63;do{r=v(r.add(a).add(u[0]).add(h(e,p+8)),37).mul(c),a=v(a.add(u[1]).add(h(e,p+48)),42).mul(c),r=r.xor(d[1]),a=a.add(u[0]).add(h(e,p+40)),i=v(i.add(d[0]),33).mul(c),u=m(e,p,u[1].mul(c),r.add(d[0])),d=m(e,p+32,i.add(d[1]),a.add(h(e,p+16)));var _=[r,i];i=_[0],r=_[1],p+=64}while(p!==k);var C=c.add(i.and(255).shl(1));p=w,d[0]=d[0].add(t-1&63),u[0]=u[0].add(d[0]),d[0]=d[0].add(u[0]),r=v(r.add(a).add(u[0]).add(h(e,p+8)),37).mul(C),a=v(a.add(u[1]).add(h(e,p+48)),42).mul(C),r=r.xor(d[1].mul(9)),a=a.add(u[0].mul(9).add(h(e,p+40))),i=v(i.add(d[0]),33).mul(C),u=m(e,p,u[1].mul(C),r.add(d[0])),d=m(e,p+32,i.add(d[1]),a.add(h(e,p+16)));var S=[r,i];return i=S[0],r=S[1],g(g(u[0],d[0],C).add(f(a).mul(s)).add(i),g(u[1],d[1],C).add(r),C)}function w(e,t){return"string"===t?A(e):_([e],t)}function _(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=N(e)),(0,r.OB)().getBool("DEBUG")&&a.D5(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var n=new Uint8Array(e.length),i=0;i<n.length;++i)0!==Math.round(e[i])&&(n[i]=1);return n}throw new Error("Unknown data type ".concat(t))}function C(){return(0,r.OB)().platform.now()}function S(e,t){return(0,r.OB)().platform.fetch(e,t)}function A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",(0,r.OB)().platform.encode(e,t)}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",(0,r.OB)().platform.decode(e,t)}function T(e){return(0,r.OB)().platform.isTypedArray(e)}function N(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),"boolean"===typeof e||"number"===typeof e||"string"===typeof e||a.tI(e)||null==e||T(e)&&n)t.push(e);else if(Array.isArray(e)||T(e))for(var r=0;r<e.length;++r)N(e[r],t,n);else{for(var i=-1,o=0,u=Object.keys(e);o<u.length;o++){var s=u[o];/^([1-9]+[0-9]*|0)$/.test(s)&&(i=Math.max(i,Number(s)))}for(var c=0;c<=i;c++)N(e[c],t,n)}return t}},6147:function(e,t,n){"use strict";function r(e){for(var t=e.length,n=0;t>0;)n=Math.random()*t|0,u(e,--t,n)}function a(e,t){if(e.length!==t.length)throw new Error("Array sizes must match to be shuffled together "+"First array length was ".concat(e.length)+"Second array length was ".concat(t.length));for(var n=e.length,r=0;n>0;)r=Math.random()*n|0,u(e,--n,r),u(t,n,r)}function i(e,t,n){return Math.max(e,Math.min(t,n))}function o(e){return e%2===0?e:e+1}function u(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function s(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function c(e,t){var n=Math.random();return t*n+(1-n)*e}function l(e,t){for(var n=0,r=0;r<e.length;r++){var a=Number(e[r])-Number(t[r]);n+=a*a}return n}function f(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function d(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";f(g(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}function h(e){f(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function p(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function v(e){return 0===e.length}function g(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function m(e){return e%1===0}function y(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function b(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function x(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return r(t),t}function k(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return 0},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return new Promise((function(a,i){var o=0;!function u(){if(e())a();else{o++;var s=t(o);null!=n&&o>=n?i():null!=r?r(u,s):setTimeout(u,s)}}()}))}function _(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found ".concat(e[a]," at dim ").concat(a));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));var i=e.slice();return i[r]=t/n,i}function C(e,t){var n=t.length;return f((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)})),f(e.every((function(e){return m(e)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(e)})),e.map((function(e){return e<0?n+e:e}))}function S(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:C(t,e).sort(),o=0,u=0;u<e.length;++u){if(null!=i){if(i[o]===u&&1!==e[u])throw new Error("Can't squeeze axis ".concat(u," since its dim '").concat(e[u],"' is not 1"));(null==i[o]||i[o]>u)&&1===e[u]&&(n.push(e[u]),r.push(u)),i[o]<=u&&o++}1!==e[u]&&(n.push(e[u]),r.push(u))}return{newShape:n,keptDims:r}}function A(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type ".concat(e));n=new Uint8Array(t)}return n}function E(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function T(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}function N(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function D(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function F(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function I(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}function M(e){return"string"===typeof e||e instanceof String}function O(e){return"boolean"===typeof e}function R(e){return"number"===typeof e}function Z(e){return Array.isArray(e)?Z(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":R(e)?"float32":M(e)?"string":O(e)?"bool":"float32"}function B(e){return!!(e&&e.constructor&&e.call&&e.apply)}function z(e,t){for(var n=t;n<e;++n)if(e%n===0)return n;return e}function L(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function P(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=new Array;if(1===t.length)for(var i=t[0]*(r?2:1),o=0;o<i;o++)a[o]=n[e+o];else for(var u=t[0],s=t.slice(1),c=s.reduce((function(e,t){return e*t}))*(r?2:1),l=0;l<u;l++)a[l]=P(e+l*c,s,n,r);return a}function j(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0===e.length)return t[0];var r=e.reduce((function(e,t){return e*t}))*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length).concat(n?" for a complex tensor":"","."));return P(0,e,t,n)}function U(e,t){if(Array.isArray(e))return e;if("float32"===t)return e instanceof Float32Array?e:new Float32Array(e);if("int32"===t)return e instanceof Int32Array?e:new Int32Array(e);if("bool"===t||"string"===t)return Uint8Array.from(new Int32Array(e));throw new Error("Unknown dtype ".concat(t))}function W(e,t){for(var n=V(e,t),r=0;r<n.length;r++)n[r]=1;return n}function V(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function G(e,t){var n=e.reduce((function(e,t){return e*t}),1);if(null==t||"float32"===t)return j(e,new Float32Array(n));if("int32"===t)return j(e,new Int32Array(n));if("bool"===t)return j(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function q(e){e.forEach((function(t){f(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"].")}))}))}function H(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function X(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function Y(e){return e&&e.then&&"function"===typeof e.then}n.d(t,{AE:function(){return y},Cq:function(){return h},D2:function(){return Z},D5:function(){return T},E7:function(){return l},EC:function(){return C},GN:function(){return m},GX:function(){return j},HD:function(){return M},JZ:function(){return _},KS:function(){return U},LF:function(){return u},LP:function(){return N},Mu:function(){return q},NA:function(){return p},NE:function(){return X},QB:function(){return D},Sm:function(){return s},TV:function(){return r},U$:function(){return x},Ub:function(){return I},WD:function(){return w},WP:function(){return A},YP:function(){return b},bT:function(){return F},bj:function(){return c},bp:function(){return S},cO:function(){return g},d7:function(){return a},e3:function(){return L},hj:function(){return R},hu:function(){return f},jP:function(){return z},jn:function(){return O},k5:function(){return d},l6:function(){return G},mf:function(){return B},nY:function(){return o},oj:function(){return k},p8:function(){return W},qy:function(){return H},rQ:function(){return E},tI:function(){return Y},uZ:function(){return i},wT:function(){return V},xH:function(){return v}})},6377:function(e,t,n){"use strict";var r=n(6690).default,a=n(9728).default,i=n(1655).default,o=n(6389).default;Object.defineProperty(t,"__esModule",{value:!0});var u=n(8294),s=n(7938),c=function(e){i(n,e);var t=o(n);function n(){return r(this,n),t.apply(this,arguments)}return a(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.name,n=e.tab;this.props.registerSurface(t,n,this)}},{key:"componentDidUpdate",value:function(){return!1}},{key:"render",value:function(){var e=this,t=this.props,r=t.name,a=t.visible,i=t.styles,o=Object.assign({},n.defaultStyles,i),c=o.width,l=o.height,f=o.maxHeight,d=o.maxWidth;f=l===n.defaultStyles.height?f:l,d=c===n.defaultStyles.width?d:c;var h=s.css({display:a?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:l,width:c,maxHeight:f,maxWidth:d,overflow:"auto"}),p=s.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),v=s.css({boxSizing:"border-box"});return u.h("div",{className:"".concat(h," tf-surface"),ref:function(t){return e.container=t},"data-visible":a},u.h("div",{className:"".concat(p," tf-label"),ref:function(t){return e.label=t}},r),u.h("div",{className:"".concat(v," tf-draw-area"),ref:function(t){return e.drawArea=t}}))}}]),n}(u.Component);c.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"},t.SurfaceComponent=c},7733:function(e,t,n){"use strict";var r=n(6690).default,a=n(9728).default,i=n(1655).default,o=n(6389).default;Object.defineProperty(t,"__esModule",{value:!0});var u=n(8294),s=n(7938),c=function(e){i(n,e);var t=o(n);function n(){return r(this,n),t.apply(this,arguments)}return a(n,[{key:"render",value:function(){var e=this.props,t=e.tabNames,n=e.activeTab,r=e.handleClick,a=t.length>0?t.map((function(e){return u.h(l,{key:e,id:e,handleClick:r,isActive:e===n},e)})):null,i=s.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return u.h("div",{className:"".concat(i," visor-tabs")},a)}}]),n}(u.Component);t.Tabs=c;var l=function(e){i(n,e);var t=o(n);function n(){return r(this,n),t.apply(this,arguments)}return a(n,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.isActive,r=e.handleClick,a=e.id,i=s.css({borderBottomColor:n?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return u.h("a",{className:"".concat(i," tf-tab"),"data-isactive":n,onClick:function(){return r(a)}},t)}}]),n}(u.Component)},1042:function(e,t,n){"use strict";var r=n(4704).default,a=n(6690).default,i=n(9728).default,o=n(6115).default,u=n(1655).default,s=n(6389).default;Object.defineProperty(t,"__esModule",{value:!0});var c=n(8294),l=n(7938),f=n(6377),d=n(7733),h=function(e){u(n,e);var t=s(n);function n(e){var r;a(this,n),(r=t.call(this,e)).surfaces=new Map;var i=null==e.startOpen||e.startOpen;return r.state={isOpen:i,isFullscreen:!1,activeTab:null,tabs:new Set},r.keyHandler=r.keyHandler.bind(o(r)),r}return i(n,[{key:"close",value:function(){this.setState({isOpen:!1})}},{key:"open",value:function(){this.setState({isOpen:!0})}},{key:"toggle",value:function(){this.setState({isOpen:!this.state.isOpen})}},{key:"toggleFullScreen",value:function(){this.setState({isFullscreen:!this.state.isFullscreen})}},{key:"isOpen",value:function(){return this.state.isOpen}},{key:"isFullscreen",value:function(){return this.state.isFullscreen}},{key:"getSurface",value:function(e,t){var n,r=this.surfaceId(e,t);if(!this.surfaces.has(r))throw Error("Surface not found with id: ".concat(r));return{container:(n=this.surfaces.get(r)).container,label:n.label,drawArea:n.drawArea}}},{key:"bindKeys",value:function(){document.addEventListener("keydown",this.keyHandler,!1)}},{key:"unbindKeys",value:function(){document.removeEventListener("keydown",this.keyHandler)}},{key:"surfaceId",value:function(e,t){return e+t}},{key:"setTabs",value:function(e){var t,n,a=e.map((function(e){return e.tab})),i=this.state.tabs,o=r(a);try{for(o.s();!(n=o.n()).done;){var u=n.value;i.has(u)||(i.add(u),t=u)}}catch(s){o.e(s)}finally{o.f()}null!=t&&this.setState({tabs:i,activeTab:t})}},{key:"getTabs",value:function(){return this.state.tabs}},{key:"registerSurface",value:function(e,t,n){var r=this.surfaceId(e,t);this.surfaces.set(r,n)}},{key:"keyHandler",value:function(e){192===e.keyCode&&(e.shiftKey?this.toggleFullScreen():this.toggle())}},{key:"setActiveTab",value:function(e){this.setState({activeTab:e})}},{key:"componentDidMount",value:function(){this.bindKeys()}},{key:"componentWillMount",value:function(){this.setTabs(this.props.surfaceList)}},{key:"componentWillReceiveProps",value:function(e){this.setTabs(e.surfaceList)}},{key:"render",value:function(){var e=this,t=this.state,n=t.isOpen,r=t.isFullscreen,a=t.activeTab,i=this.props.surfaceList,o=Array.from(this.getTabs().values()),u=r?"90vw":"550px",s=l.css({width:u,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),h=l.css({right:"0"}),v=l.css({right:"calc(-".concat(u," - 10px)")}),g=n?h:v,m=l.css({});return c.h("div",{className:"".concat(s," ").concat(g," visor"),"data-isopen":n,"data-isfullscreen":r},c.h(p,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:r}),c.h(d.Tabs,{tabNames:o,activeTab:a,handleClick:this.setActiveTab.bind(this)}),c.h("div",{className:"".concat(m," visor-surfaces")},i.map((function(t){return c.h(f.SurfaceComponent,{key:t.name+t.tab,name:t.name,tab:t.tab,styles:t.styles,registerSurface:e.registerSurface.bind(e),visible:a===t.tab})}))))}}],[{key:"render",value:function(e,t,r){return c.render(c.h(n,Object.assign({},r)),e,t)}}]),n}(c.Component);function p(e){var t=e.isFullScreen,n=e.fullScreenHandler,r=e.closeHandler,a=l.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),i=l.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),o=l.css({marginLeft:"auto"});return c.h("div",{className:"".concat(a," visor-controls")},c.h("button",{className:"".concat(i),onClick:n},t?"Minimize":"Maximize"),c.h("button",{className:"".concat(i," ").concat(o),onClick:r},"Hide"))}t.VisorComponent=h},386:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(4341),n(4672);var r=n(3168),a=n(8249),i=n(5342),o=n(6863),u=n(298),s=n(6623),c=n(3413),l=n(4469),f=n(9653),d=n(2150),h=n(3936),p=n(1207),v=n(74);t.version_vis=v.version;var g={barchart:r.barchart,table:c.table,histogram:o.histogram,linechart:u.linechart,scatterplot:s.scatterplot,confusionMatrix:a.confusionMatrix,heatmap:i.heatmap};t.render=g;var m={accuracy:p.accuracy,perClassAccuracy:p.perClassAccuracy,confusionMatrix:p.confusionMatrix};t.metrics=m;var y={history:l.history,fitCallbacks:l.fitCallbacks,perClassAccuracy:d.perClassAccuracy,valuesDistribution:h.valuesDistribution,layer:f.layer,modelSummary:f.modelSummary};t.show=y;var b=n(2890);t.visor=b.visor,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(9263))},3168:function(e,t,n){"use strict";var r=n(7061).default,a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(8240)),u=n(1522),s=n(1253);t.barchart=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a(this,void 0,void 0,r().mark((function a(){var i,f,d,h,p,v,g,m,y,b,x,k,w,_,C,S;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=s.getDrawArea(e),f=t,d=Object.assign({},c,n),!l.has(i)){r.next=13;break}if(h=l.get(i),!s.shallowEquals(d,h.lastOptions)){r.next=13;break}return r.next=8,s.nextFrame();case 8:return p=h.view,v=p.changeset().remove((function(){return!0})).insert(f),r.next=12,p.change("values",v).runAsync();case 12:return r.abrupt("return");case 13:return g=d.xLabel,m=d.yLabel,y=d.xType,b=d.yType,x=null,null!=g&&(x={title:g}),k=null,null!=m&&(k={title:m}),w={actions:!1,mode:"vega-lite",defaultStyle:!1},_=null!=d.color?Array.isArray(d.color)?{field:"index",type:"nominal",scale:{range:d.color}}:{value:d.color}:{value:"#4C78A0"},C={width:d.width||u.getDefaultWidth(i),height:d.height||u.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:d.fontSize,titleFontSize:d.fontSize},text:{fontSize:d.fontSize},legend:{labelFontSize:d.fontSize,titleFontSize:d.fontSize}},data:{values:f,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:y,axis:x},y:{field:"value",type:b,axis:k},color:_}},r.next=23,s.nextFrame();case 23:return r.next=25,o.default(i,C,w);case 25:S=r.sent,l.set(i,{view:S.view,lastOptions:d});case 27:case"end":return r.stop()}}),a)})))};var c={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},l=new Map},8249:function(e,t,n){"use strict";var r=n(7061).default,a=n(4704).default,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(8240)),s=n(1522),c=n(1253);t.confusionMatrix=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(this,void 0,void 0,r().mark((function i(){var o,f,d,h,p,v,g,m,y,b,x,k,w,_,C,S,A,E;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(o=Object.assign({},l,n),f=c.getDrawArea(e),d=[],h=t.values,p=t.tickLabels||[],v=0===p.length,g=!0,m=0;m<h.length;m++)for(y=v?"Class ".concat(m):p[m],v&&p.push(y),b=0;b<h[m].length;b++)x=v?"Class ".concat(b):p[b],k=h[m][b],m!==b||o.shadeDiagonal?(d.push({label:y,prediction:x,count:k,scaleCount:k}),0!==k&&(g=!1)):d.push({label:y,prediction:x,count:k,noFill:!0});if(!o.shadeDiagonal&&g){w=a(d);try{for(w.s();!(_=w.n()).done;)!0===(C=_.value).noFill&&(C.noFill=!1,C.scaleCount=C.count)}catch(i){w.e(i)}finally{w.f()}}return S={actions:!1,mode:"vega-lite",defaultStyle:!1},A={width:o.width||s.getDefaultWidth(f),height:o.height||s.getDefaultHeight(f),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},text:{fontSize:o.fontSize},legend:{labelFontSize:o.fontSize,titleFontSize:o.fontSize}},data:{values:d},encoding:{x:{field:"prediction",type:"ordinal",title:o.xLabel||"prediction",scale:{domain:p}},y:{field:"label",type:"ordinal",title:o.yLabel||"label",scale:{domain:p}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:o.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]},!1===o.shadeDiagonal&&A.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),o.showTextOverlay&&A.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}}),E="string"===typeof o.colorMap?{scheme:o.colorMap}:o.colorMap,A.layer[0].encoding.color.scale.range=E,r.next=17,u.default(f,A,S);case 17:case"end":return r.stop()}}),i)})))};var l={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]}},5342:function(e,t,n){"use strict";var r=n(7061).default,a=n(7424).default,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(4341)),c=u(n(8240)),l=n(1522),f=n(5330),d=n(1253);function h(e){return i(this,void 0,void 0,r().mark((function t(){var n,a,i,o;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e instanceof s.Tensor?(n=e.shape,a=e.transpose()):(n=[e.length,e[0].length],a=s.tidy((function(){return s.tensor2d(e).transpose()}))),f.assert(2===a.rank,"Input to renderHeatmap must be a 2d array or Tensor2d"),t.next=4,a.array();case 4:return i=t.sent,a.dispose(),o=[i.length,i[0].length],f.assert(n[0]===o[1]&&n[1]===o[0],"Unexpected transposed shape. Original ".concat(n," : Transposed ").concat(o)),t.abrupt("return",i);case 9:case"end":return t.stop()}}),t)})))}function p(e,t,n){var r=e instanceof s.Tensor?e.shape:[e.length,e[0].length];0===n?f.assert(r[0]===t.length,"Length of xTickLabels (".concat(t.length,") must match number of rows")+" (".concat(r[0],")")):1===n&&f.assert(r[1]===t.length,"Length of yTickLabels (".concat(t.length,") must match number of columns (").concat(r[1],")"))}t.heatmap=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(this,void 0,void 0,r().mark((function i(){var o,u,g,m,y,b,x,k,w,_,C,S,A,E,T,N,D,F,I,M,O,R,Z,B,z,L,P,j;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(o=Object.assign({},v,n),u=d.getDrawArea(e),g=t.values,!o.rowMajor){r.next=7;break}return r.next=6,h(t.values);case 6:g=r.sent;case 7:if(m=t.xTickLabels,y=t.yTickLabels,null!=m&&(0,p(g,m,0)),null!=y&&(1,p(g,y,1)),b="@tfidx@",x=[],!(g instanceof s.Tensor)){r.next=21;break}return f.assert(2===g.rank,"Input to renderHeatmap must be a 2d array or Tensor2d"),r.next=16,g.data();case 16:for(k=r.sent,w=a(g.shape,2),_=w[0],C=w[1],S=0;S<_;S++)for(A=m?"".concat(m[S]).concat(b).concat(S):S,E=0;E<C;E++)T=y?"".concat(y[E]).concat(b).concat(E):E,N=k[S*C+E],x.push({x:A,y:T,value:N});r.next=23;break;case 21:for(D=g,F=0;F<D.length;F++)for(I=m?"".concat(m[F]).concat(b).concat(F):F,M=0;M<D[F].length;M++)O=y?"".concat(y[M]).concat(b).concat(M):M,R=D[F][M],x.push({x:I,y:O,value:R});case 23:Z={actions:!1,mode:"vega-lite",defaultStyle:!1},B={width:o.width||l.getDefaultWidth(u),height:o.height||l.getDefaultHeight(u),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},text:{fontSize:o.fontSize},legend:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:x},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:o.xType,title:o.xLabel,sort:!1},y:{field:"y",type:o.yType,title:o.yLabel,sort:!1},fill:{field:"value",type:"quantitative"}}},z="".concat(b,"\\d+$"),L=new RegExp(z),m&&(B.encoding.x.axis={labelExpr:"replace(datum.value, regexp(/".concat(z,"/), '')")}),y&&(B.encoding.y.axis={labelExpr:"replace(datum.value, regexp(/".concat(z,"/), '')")}),(m||y)&&(Z.tooltip={sanitize:function(e){return String(e).replace(L,"")}}),r.t0=o.colorMap,r.next="blues"===r.t0?33:"greyscale"===r.t0?35:(r.t0,37);break;case 33:return P=["#f7fbff","#4292c6"],r.abrupt("break",39);case 35:return P=["#000000","#ffffff"],r.abrupt("break",39);case 37:return P="viridis",r.abrupt("break",39);case 39:return"viridis"!==P&&(B.encoding.fill.scale={range:P}),o.domain&&(null!=(j=B.encoding.fill).scale?j.scale=Object.assign({},j.scale,{domain:o.domain}):j.scale={domain:o.domain}),r.next=43,c.default(u,B,Z);case 43:case"end":return r.stop()}}),i)})))};var v={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1}},6863:function(e,t,n){"use strict";var r=n(7061).default,a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1848),u=i(n(8240)),s=n(1522),c=n(1207),l=n(3413),f={maxBins:12,fontSize:11};function d(e,t,n){var r=o.format(",.4~f"),a=o.format(".4~p"),i=[],u=[];if(null!=e.numVals&&(i.push("Num Vals"),u.push(r(e.numVals))),null!=e.min&&(i.push("Min"),u.push(r(e.min))),null!=e.max&&(i.push("Max"),u.push(r(e.max))),null!=e.numZeros){i.push("# Zeros");var s="";e.numVals&&(s=e.numZeros>0?"(".concat(a(e.numZeros/e.numVals),")"):""),u.push("".concat(r(e.numZeros)," ").concat(s))}if(null!=e.numNans){i.push("# NaNs");var c="";e.numVals&&(c=e.numNans>0?"(".concat(a(e.numNans/e.numVals),")"):""),u.push("".concat(r(e.numNans)," ").concat(c))}if(null!=e.numInfs){i.push("# Infinity");var f="";e.numVals&&(f=e.numInfs>0?"(".concat(a(e.numInfs/e.numVals),")"):""),u.push("".concat(r(e.numInfs)," ").concat(f))}l.table(t,{headers:i,values:[u]},n)}function h(e){if(null==e.length)throw new Error("input data must be an array");if(0===e.length)return[];if("object"===typeof e[0]){if(null==e[0].value)throw new Error("input data must have a value field");return e}for(var t=Array(e.length),n=0;n<e.length;n++)t[n]={value:e[n]};return t}t.histogram=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return a(this,void 0,void 0,r().mark((function a(){var i,o,l,p,v,g,m,y,b;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=h(t),o=Object.assign({},f,n),l={actions:!1,mode:"vega-lite",defaultStyle:!1},p=s.subSurface(e,"histogram"),!1!==n.stats&&(v=s.subSurface(e,"stats",{prepend:!0}),d(n.stats?n.stats:c.arrayStats(i.map((function(e){return e.value}))),v,{fontSize:o.fontSize})),0!==i.length){r.next=7;break}return r.abrupt("return",void 0);case 7:for(g=[],m=0;m<i.length;m++)null!=(y=i[m].value)&&isFinite(y)&&g.push(i[m]);return b={width:o.width||s.getDefaultWidth(p),height:o.height||s.getDefaultHeight(p),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:g},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},text:{fontSize:o.fontSize},legend:{labelFontSize:o.fontSize,titleFontSize:o.fontSize}},encoding:{x:{bin:{maxbins:o.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:o.color||"#001B44"}}},r.abrupt("return",u.default(p,b,l));case 11:case"end":return r.stop()}}),a)})))}},298:function(e,t,n){"use strict";var r=n(7061).default,a=n(861).default,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(8240)),s=n(1522),c=n(5330),l=n(1253);t.linechart=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(this,void 0,void 0,r().mark((function i(){var o,d,h,p,v,g,m,y,b,x,k,w,_,C;return r().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:o=Array.isArray(t.values[0])?t.values:[t.values],d=o[0].length,h=t.series?t.series:o.map((function(e,t){return"Series ".concat(t+1)})),c.assert(h.length===o.length,"Must have an equal number of series labels as there are data series"),null!=n.seriesColors&&c.assert(n.seriesColors.length===o.length,"Must have an equal number of series colors as there are data series"),p=[],v=r().mark((function e(t){var n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={x:t},h.forEach((function(e,r){var a=o[r][t].y;n[e]=a,n["".concat(e,"-name")]=e})),p.push(n);case 3:case"end":return e.stop()}}),e)})),g=0;case 8:if(!(g<d)){i.next=13;break}return i.delegateYield(v(g),"t0",10);case 10:g++,i.next=8;break;case 13:return m=Object.assign({},f,n),y=function(){return m.zoomToFit?{zero:!1}:null!=m.yAxisDomain?{domain:m.yAxisDomain}:void 0},b={x:{field:"x",type:m.xType,title:m.xLabel},tooltip:[{field:"x",type:"quantitative"}].concat(a(h.map((function(e){return{field:e,type:"quantitative"}}))))},x=h.map((function(e){return{data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:e,type:m.yType,title:m.yLabel,scale:y()},color:{field:"".concat(e,"-name"),type:"nominal",legend:{values:h,title:null},scale:{range:m.seriesColors}}}}})),k={mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}},w=l.getDrawArea(e),_={width:m.width||s.getDefaultWidth(w),height:m.height||s.getDefaultHeight(w),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:m.fontSize,titleFontSize:m.fontSize},text:{fontSize:m.fontSize},legend:{labelFontSize:m.fontSize,titleFontSize:m.fontSize}},data:{values:p},encoding:b,layer:[].concat(a(x),[k])},C={actions:!1,mode:"vega-lite",defaultStyle:!1},i.next=23,u.default(w,_,C);case 23:return i.abrupt("return",Promise.resolve());case 24:case"end":return i.stop()}}),i)})))};var f={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},1253:function(e,t,n){"use strict";var r=n(7061).default,a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(9263),o=n(2890);t.getDrawArea=function(e){if(e instanceof HTMLElement)return e;if(i.isSurface(e))return e.drawArea;if(i.isSurfaceInfo(e))return o.visor().surface({name:e.name,tab:e.tab,styles:e.styles}).drawArea;throw new Error("Not a drawable")},t.shallowEquals=function(e,t){var n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(var a=0;a<n.length;a++){var i=n[a];if(e[i]!==t[i])return!1}return!0},t.nextFrame=function(){return a(this,void 0,void 0,r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return requestAnimationFrame(e)}));case 2:case"end":return e.stop()}}),e)})))}},6623:function(e,t,n){"use strict";var r=n(7061).default,a=n(861).default,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=o(n(8240)),s=n(1522),c=n(5330),l=n(1253);t.scatterplot=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(this,void 0,void 0,r().mark((function i(){var o,d,h,p,v,g,m,y,b;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=t.values,d=null==t.series?[]:t.series,o=Array.isArray(o[0])?o:[o],h=[],o.forEach((function(e,t){var n=null!=d[t]?d[t]:"Series ".concat(t+1),r=e.map((function(e){return Object.assign({},e,{series:n})}));h.push.apply(h,a(r))})),null!=n.seriesColors&&c.assert(n.seriesColors.length===o.length,"Must have an equal number of series colors as there are data series"),p=l.getDrawArea(e),v=Object.assign({},f,n),g={actions:!1,mode:"vega-lite",defaultStyle:!1},m=function(){return v.zoomToFit?{zero:!1}:null!=v.xAxisDomain?{domain:v.xAxisDomain}:void 0},y=function(){return v.zoomToFit?{zero:!1}:null!=v.yAxisDomain?{domain:v.yAxisDomain}:void 0},b={width:v.width||s.getDefaultWidth(p),height:v.height||s.getDefaultHeight(p),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:v.fontSize,titleFontSize:v.fontSize},text:{fontSize:v.fontSize},legend:{labelFontSize:v.fontSize,titleFontSize:v.fontSize}},data:{values:h},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:v.xType,title:v.xLabel,scale:m()},y:{field:"y",type:v.yType,title:v.yLabel,scale:y()},color:{field:"series",type:"nominal",scale:{range:v.seriesColors}},shape:{field:"series",type:"nominal"}}},r.next=14,u.default(p,b,g);case 14:return r.abrupt("return",Promise.resolve());case 15:case"end":return r.stop()}}),i)})))};var f={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11}},3413:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1848),a=n(6360),i=n(7938),o=n(1253);t.table=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t&&null==t.headers)throw new Error('Data to render must have a "headers" property');if(t&&null==t.values)throw new Error('Data to render must have a "values" property');var s=o.getDrawArea(e),c=Object.assign({},u,n),l=a.select(s).select("table.tf-table"),f=i.css({fontSize:c.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(0===l.size()&&((l=a.select(s).append("table")).attr("class"," ".concat(f," tf-table")),l.append("thead").append("tr"),l.append("tbody")),1!==l.size())throw new Error("Error inserting table");var d=i.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),h=l.select("thead").select("tr").selectAll("th").data(t.headers),p=h.enter().append("th").attr("class","".concat(d));h.merge(p).html((function(e){return e})),h.exit().remove();var v=r.format(",.4~f"),g=l.select("tbody").selectAll("tr").data(t.values),m=g.enter().append("tr"),y=i.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),b=g.merge(m).selectAll("td").data((function(e){return e})),x=b.enter().append("td").attr("class","".concat(y));b.merge(x).html((function(e){return"number"===typeof e?v(e):e})),b.exit().remove(),g.exit().remove()};var u={fontSize:14}},4469:function(e,t,n){"use strict";var r=n(8416).default,a=n(7061).default,i=n(4704).default,o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var u=n(298),s=n(1253),c=n(1522);function l(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return o(this,void 0,void 0,a().mark((function o(){var l,h,p,v,g,m,y,b,x,k,w,_,C,S,A,E,T,N;return a().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:l=s.getDrawArea(e),h={},p=i(n);try{for(p.s();!(v=p.n()).done;)g=v.value,/val_/.test(g)?(y=g.replace("val_",""),f(h,y),b=d(t,g,n.indexOf(g)),h[y].series.push(g),h[y].values.push(b)):(m=d(t,g,n.indexOf(g)),f(h,g),h[g].series.push(g),h[g].values.push(m))}catch(o){p.e(o)}finally{p.f()}for(x=Object.keys(h),k=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},r),w=[],_=0,C=x;_<C.length;_++)S=C[_],A=c.subSurface(l,S),E=h[S].series,T=h[S].values,E.every((function(e){return Boolean(e.match("acc"))}))&&(k.zoomToFitAccuracy?k.zoomToFit=!0:(k.yAxisDomain=[0,1],delete k.zoomToFit)),N=u.linechart(A,{values:T,series:E},k),w.push(N);return a.next=10,Promise.all(w);case 10:case"end":return a.stop()}}),o)})))}function f(e,t){null==e[t]&&(e[t]={series:[],values:[]})}function d(e,t,n){if(Array.isArray(e)){for(var r=Array.isArray(e[0])?e[n]:e,a=[],i=0;i<r.length;i++){var o=r[i];a.push({x:i,y:o[t]})}return a}return e.history[t].map((function(e,t){return{x:t,y:e}}))}function h(e,t,n){return null==e[t]&&(e[t]={}),null==e[t][n]&&(e[t][n]=[]),e[t][n]}t.history=l,t.fitCallbacks=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u={},f=n.callbacks||["onEpochEnd","onBatchEnd"],d=s.getDrawArea(e),p=Object.assign({},n);function v(e){var n=this;return function(f,v){return o(n,void 0,void 0,a().mark((function n(){var o,f,g,m,y,b;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:/batch/i.test(e)?p.xLabel="Batch":/epoch/i.test(e)&&(p.xLabel="Epoch"),o=[],f=[],g=i(t);try{for(g.s();!(m=g.n()).done;)y=m.value,null!=v[y]&&(f.push(y),(b=h(u,e,y)).push(r({},y,v[y])),o.push(b))}catch(a){g.e(a)}finally{g.f()}return l(c.subSurface(d,e,{title:e}),o,f,p),n.next=9,s.nextFrame();case 9:case"end":return n.stop()}}),n)})))}}delete p.callbacks;var g={};return f.forEach((function(e){g[e]=v(e)})),g}},9653:function(e,t,n){"use strict";var r=n(7061).default,a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(6863),o=n(1253),u=n(3413),s=n(1522),c=n(1207);function l(e){return{layers:e.layers.map(f)}}function f(e){var t;if(Array.isArray(e.outputShape[0])){var n=e.outputShape.map((function(e){return h(e)}));t="[".concat(n.join(", "),"]")}else t=h(e.outputShape);return{name:e.name,trainable:e.trainable,parameters:e.countParams(),outputShape:t}}function d(e){return a(this,void 0,void 0,r().mark((function t(){var n,a,i,o,u;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getWeights(),a=e.weights,i=n.map(c.tensorStats),t.next=5,Promise.all(i);case 5:return o=t.sent,u=n.map((function(e){return e.shape})),t.abrupt("return",n.map((function(e,t){return{name:a[t].name,stats:o[t],shape:h(u[t]),weight:e}})));case 8:case"end":return t.stop()}}),t)})))}function h(e){var t=e.slice();return 0===t.length?"Scalar":(null===t[0]&&(t[0]="batch"),"[".concat(t.join(","),"]"))}function p(e,t,n){var r="\n    <select>\n      ".concat(e.map((function(e){return"<option value=".concat(e,">").concat(e,"</option>")})),"\n    </select>\n  "),a="<div>".concat("<button>Show Values Distribution for:</button>").concat(r,"</div>");t.innerHTML=a;var i=t.querySelector("button"),o=t.querySelector("select");i.addEventListener("click",(function(){n(o.selectedOptions[0].label)}))}t.modelSummary=function(e,t){return a(this,void 0,void 0,r().mark((function n(){var a,i,s,c;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=o.getDrawArea(e),i=l(t),s=["Layer Name","Output Shape","# Of Params","Trainable"],c=i.layers.map((function(e){return[e.name,e.outputShape,e.parameters,e.trainable]})),u.table(a,{headers:s,values:c});case 5:case"end":return n.stop()}}),n)})))},t.layer=function(e,t){return a(this,void 0,void 0,r().mark((function n(){var c,l,f,h,v,g,m,y,b=this;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=o.getDrawArea(e),n.next=3,d(t);case 3:l=n.sent,f=["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],h=s.subSurface(c,"layer-weights-info"),v=l.map((function(e){return[e.name,e.shape,e.stats.min,e.stats.max,e.weight.size,e.stats.numZeros,e.stats.numNans,e.stats.numInfs]})),u.table(h,{headers:f,values:v}),g=s.subSurface(c,"select-layer"),m=s.subSurface(c,"param-distribution"),y=function(e){return a(b,void 0,void 0,r().mark((function t(){var n,a;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.filter((function(t){return t.name===e}))[0],t.next=3,n.weight.data();case 3:a=t.sent,i.histogram(m,a,{height:150,width:460,stats:!1});case 5:case"end":return t.stop()}}),t)})))},p(l.map((function(e){return e.name})),g,y);case 12:case"end":return n.stop()}}),n)})))}},2150:function(e,t,n){"use strict";var r=n(7061).default,a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(1253),o=n(3413);t.perClassAccuracy=function(e,t,n){return a(this,void 0,void 0,r().mark((function a(){var u,s,c,l,f,d;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(u=i.getDrawArea(e),s=["Class","Accuracy","# Samples"],c=[],l=0;l<t.length;l++)f=n?n[l]:l.toString(),d=t[l],c.push([f,d.accuracy,d.count]);return r.abrupt("return",o.table(u,{headers:s,values:c}));case 5:case"end":return r.stop()}}),a)})))}},3936:function(e,t,n){"use strict";var r=n(7061).default,a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var i=n(6863),o=n(1253),u=n(1207);t.valuesDistribution=function(e,t){return a(this,void 0,void 0,r().mark((function n(){var a,s,c;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=o.getDrawArea(e),n.next=3,u.tensorStats(t);case 3:return s=n.sent,n.next=6,t.data();case 6:c=n.sent,i.histogram(a,c,{height:150,stats:s});case 8:case"end":return n.stop()}}),n)})))}},9263:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSurfaceInfo=function(e){return null!=e.name},t.isSurface=function(e){return e.drawArea instanceof HTMLElement}},1522:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7938),a=n(1253),i={prepend:!1};t.subSurface=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=a.getDrawArea(e),u=r.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),s=r.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),c=Object.assign({},i,n),l=o.querySelector("div[data-name=".concat(t,"]"));if(!l){if((l=document.createElement("div")).setAttribute("class","".concat(u)),l.dataset.name=t,c.title){var f=document.createElement("div");f.setAttribute("class","subsurface-title ".concat(s)),f.innerText=c.title,l.appendChild(f)}c.prepend?o.insertBefore(l,o.firstChild):o.appendChild(l)}return l},t.getDefaultWidth=function(e){for(var t=0,n=e;n&&0===n.clientWidth;)n=n.parentElement,t=50;return n.clientWidth-t},t.getDefaultHeight=function(e){return 0===e.clientHeight?200:e.clientHeight}},1207:function(e,t,n){"use strict";var r=n(7061).default,a=n(7424).default,i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});var o=n(4341),u=n(5330);t.arrayStats=function(e){if(!Array.isArray(e))throw new Error("input must be an array");if(0===e.length)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};for(var t=e.length,n=-1/0,r=1/0,a=0,i=0,o=0,u=0;u<t;u++){var s=e[u];s>n&&(n=s),s<r&&(r=s),0===s&&(a+=1),isNaN(s)?i+=1:isFinite(s)||(o+=1)}var c={numVals:t,numZeros:a,numNans:i,max:n,min:r,numInfs:o};return c.max===-1/0&&(c.max=NaN),c.min===1/0&&(c.min=NaN),c},t.tensorStats=function(e){return i(this,void 0,void 0,r().mark((function t(){var n,i,u,s,c;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o.tidy((function(){var t=o.scalar(0,e.dtype);return[e.min(),e.max(),e.equal(t).sum()]})),i=a(n,3),u=i[0],s=i[1],c=i[2],t.abrupt("return",Promise.all([e.data(),u.data(),s.data(),c.data()]).then((function(e){for(var t=a(e,4),n=t[0],r=t[1],i=t[2],o=t[3],u=n.length,s=0,c=0,l=0;l<u;l++){var f=n[l];isNaN(f)?s+=1:isFinite(f)||(c+=1)}var d=r[0],h=i[0];return s===u&&(d=NaN,h=NaN),{numVals:u,numZeros:o[0],numNans:s,min:d,max:h,numInfs:c}})));case 2:case"end":return t.stop()}}),t)})))},t.confusionMatrix=function(e,t,n,s){return i(this,void 0,void 0,r().mark((function i(){var c,l,f;return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u.assert(1===e.rank,"labels must be a 1D tensor"),u.assert(1===t.rank,"predictions must be a 1D tensor"),u.assert(e.size===t.size,"labels and predictions must be the same length"),null!=s&&u.assert(s.size===t.size,"labels and predictions must be the same length"),c=e.cast("int32"),l=t.cast("int32"),null==n&&(n=o.tidy((function(){return o.maximum(c.max(),l.max()).cast("int32").dataSync()[0]+1}))),f=Promise.resolve(null),null!=s&&(f=s.data()),r.abrupt("return",Promise.all([c.data(),l.data(),f]).then((function(e){for(var t=a(e,3),r=t[0],i=t[1],o=t[2],u=Array(n).fill(0),s=0;s<n;s++)u[s]=Array(n).fill(0);for(var c=0;c<r.length;c++){var l=r[c],f=i[c];u[l][f]+=null!=o?o[c]:1}return u})));case 10:case"end":return r.stop()}}),i)})))},t.accuracy=function(e,t){return i(this,void 0,void 0,r().mark((function n(){var a,i,s;return r().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u.assertShapesMatch(e.shape,t.shape,"Error computing accuracy."),a=e.equal(t),i=a.mean(),n.next=5,i.data();case 5:return s=n.sent[0],o.dispose([a,i]),n.abrupt("return",s);case 8:case"end":return n.stop()}}),n)})))},t.perClassAccuracy=function(e,t,n){return i(this,void 0,void 0,r().mark((function i(){return r().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u.assert(1===e.rank,"labels must be a 1D tensor"),u.assert(1===t.rank,"predictions must be a 1D tensor"),u.assert(e.size===t.size,"labels and predictions must be the same length"),null==n&&(n=o.tidy((function(){return o.maximum(e.max(),t.max()).dataSync()[0]+1}))),r.abrupt("return",Promise.all([e.data(),t.data()]).then((function(e){for(var t=a(e,2),r=t[0],i=t[1],o=Array(n).fill(0),u=Array(n).fill(0),s=0;s<r.length;s++){var c=r[s],l=i[s];o[c]+=1,c===l&&(u[c]+=1)}for(var f=[],d=0;d<o.length;d++)f.push({count:o[d],accuracy:0===o[d]?0:u[d]/o[d]});return f})));case 5:case"end":return r.stop()}}),i)})))}},5330:function(e,t){"use strict";function n(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function r(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.assert=n,t.assertShapesMatch=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";n(r(e,t),a+" Shapes ".concat(e," and ").concat(t," must match"))},t.arraysEqual=r,t.DECIMAL_PLACES_TO_CHECK=4},74:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.version="1.5.1"},2890:function(e,t,n){"use strict";var r=n(6690).default,a=n(9728).default;Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(1042),u="tfjs-visor-container";t.visor=function(){if("undefined"===typeof document)throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(u)&&null!=i)return i;var e,t=document.getElementById(u);function n(t,n){var r=null;return e=o.VisorComponent.render(t,e,{ref:function(e){return r=e},surfaceList:Array.from(n.values())}),r}null==t&&((t=document.createElement("div")).id=u,document.body.appendChild(t));var r=new Map,a=n(t,r);return i=new s(a,t,r,n)};var s=function(){function e(t,n,a,i){r(this,e),this.visorComponent=t,this.el=n,this.surfaceList=a,this.renderVisor=i}return a(e,[{key:"surface",value:function(e){var t=e.name,n=null==e.tab?"Visor":e.tab;if(null==t||!("string"===typeof t||t instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");var r=Object.assign({},e,{tab:n}),a="".concat(t,"-").concat(n);return this.surfaceList.has(a)||this.surfaceList.set(a,r),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(t,n)}},{key:"isFullscreen",value:function(){return this.visorComponent.isFullscreen()}},{key:"isOpen",value:function(){return this.visorComponent.isOpen()}},{key:"close",value:function(){return this.visorComponent.close()}},{key:"open",value:function(){return this.visorComponent.open()}},{key:"toggle",value:function(){return this.visorComponent.toggle()}},{key:"toggleFullScreen",value:function(){return this.visorComponent.toggleFullScreen()}},{key:"bindKeys",value:function(){return this.visorComponent.bindKeys()}},{key:"unbindKeys",value:function(){return this.visorComponent.unbindKeys()}},{key:"setActiveTab",value:function(e){if(!this.visorComponent.state.tabs.has(e))throw new Error("Tab '".concat(e,"' does not exist"));this.visorComponent.setState({activeTab:e})}}]),e}();t.Visor=s},3991:function(e){var t=function(){"use strict";function e(e,t){return null!=t&&e instanceof t}var t,n,r;try{t=Map}catch(u){t=function(){}}try{n=Set}catch(u){n=function(){}}try{r=Promise}catch(u){r=function(){}}function a(i,u,s,c,l){"object"===typeof u&&(s=u.depth,c=u.prototype,l=u.includeNonEnumerable,u=u.circular);var f=[],d=[],h="undefined"!=typeof Buffer;return"undefined"==typeof u&&(u=!0),"undefined"==typeof s&&(s=1/0),function i(s,p){if(null===s)return null;if(0===p)return s;var v,g;if("object"!=typeof s)return s;if(e(s,t))v=new t;else if(e(s,n))v=new n;else if(e(s,r))v=new r((function(e,t){s.then((function(t){e(i(t,p-1))}),(function(e){t(i(e,p-1))}))}));else if(a.__isArray(s))v=[];else if(a.__isRegExp(s))v=new RegExp(s.source,o(s)),s.lastIndex&&(v.lastIndex=s.lastIndex);else if(a.__isDate(s))v=new Date(s.getTime());else{if(h&&Buffer.isBuffer(s))return v=Buffer.allocUnsafe?Buffer.allocUnsafe(s.length):new Buffer(s.length),s.copy(v),v;e(s,Error)?v=Object.create(s):"undefined"==typeof c?(g=Object.getPrototypeOf(s),v=Object.create(g)):(v=Object.create(c),g=c)}if(u){var m=f.indexOf(s);if(-1!=m)return d[m];f.push(s),d.push(v)}for(var y in e(s,t)&&s.forEach((function(e,t){var n=i(t,p-1),r=i(e,p-1);v.set(n,r)})),e(s,n)&&s.forEach((function(e){var t=i(e,p-1);v.add(t)})),s){var b;g&&(b=Object.getOwnPropertyDescriptor(g,y)),b&&null==b.set||(v[y]=i(s[y],p-1))}if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(s);for(y=0;y<x.length;y++){var k=x[y];(!(_=Object.getOwnPropertyDescriptor(s,k))||_.enumerable||l)&&(v[k]=i(s[k],p-1),_.enumerable||Object.defineProperty(v,k,{enumerable:!1}))}}if(l){var w=Object.getOwnPropertyNames(s);for(y=0;y<w.length;y++){var _,C=w[y];(_=Object.getOwnPropertyDescriptor(s,C))&&_.enumerable||(v[C]=i(s[C],p-1),Object.defineProperty(v,C,{enumerable:!1}))}}return v}(i,s)}function i(e){return Object.prototype.toString.call(e)}function o(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return a.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},a.__objToStr=i,a.__isDate=function(e){return"object"===typeof e&&"[object Date]"===i(e)},a.__isArray=function(e){return"object"===typeof e&&"[object Array]"===i(e)},a.__isRegExp=function(e){return"object"===typeof e&&"[object RegExp]"===i(e)},a.__getRegExpFlags=o,a}();e.exports&&(e.exports=t)},8546:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.default)(e)};var r,a=n(7630),i=(r=a)&&r.__esModule?r:{default:r};e.exports=t.default},5216:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"string"===typeof e&&n.test(e)};var n=/-webkit-|-moz-|-ms-/;e.exports=t.default},1848:function(e,t,n){"use strict";function r(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function a(e){return(e=r(Math.abs(e)))?e[1]:NaN}n.r(t),n.d(t,{format:function(){return h},formatDefaultLocale:function(){return m},formatLocale:function(){return g},formatPrefix:function(){return p},formatSpecifier:function(){return u},precisionFixed:function(){return y},precisionPrefix:function(){return b},precisionRound:function(){return x}});var i,o=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function u(e){return new s(e)}function s(e){if(!(t=o.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}function c(e,t){var n=r(e,t);if(!n)return e+"";var a=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+a:a.length>i+1?a.slice(0,i+1)+"."+a.slice(i+1):a+new Array(i-a.length+2).join("0")}u.prototype=s.prototype,s.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var l={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return c(100*e,t)},r:c,s:function(e,t){var n=r(e,t);if(!n)return e+"";var a=n[0],o=n[1],u=o-(i=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,s=a.length;return u===s?a:u>s?a+new Array(u-s+1).join("0"):u>0?a.slice(0,u)+"."+a.slice(u):"0."+new Array(1-u).join("0")+r(e,Math.max(0,t+u-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function f(e){return e}var d,h,p,v=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function g(e){var t,n,r=e.grouping&&e.thousands?(t=e.grouping,n=e.thousands,function(e,r){for(var a=e.length,i=[],o=0,u=t[0],s=0;a>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),i.push(e.substring(a-=u,a+u)),!((s+=u+1)>r));)u=t[o=(o+1)%t.length];return i.reverse().join(n)}):f,o=e.currency,s=e.decimal,c=e.numerals?function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(e.numerals):f,d=e.percent||"%";function h(e){var t=(e=u(e)).fill,n=e.align,a=e.sign,f=e.symbol,h=e.zero,p=e.width,g=e.comma,m=e.precision,y=e.trim,b=e.type;"n"===b?(g=!0,b="g"):l[b]||(null==m&&(m=12),y=!0,b="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var x="$"===f?o[0]:"#"===f&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",k="$"===f?o[1]:/[%p]/.test(b)?d:"",w=l[b],_=/[defgprs%]/.test(b);function C(e){var o,u,l,f=x,d=k;if("c"===b)d=w(e)+d,e="";else{var C=(e=+e)<0;if(e=w(Math.abs(e),m),y&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(a>0){if(!+e[r])break e;a=0}}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),C&&0===+e&&(C=!1),f=(C?"("===a?a:"-":"-"===a||"("===a?"":a)+f,d=("s"===b?v[8+i/3]:"")+d+(C&&"("===a?")":""),_)for(o=-1,u=e.length;++o<u;)if(48>(l=e.charCodeAt(o))||l>57){d=(46===l?s+e.slice(o+1):e.slice(o))+d,e=e.slice(0,o);break}}g&&!h&&(e=r(e,1/0));var S=f.length+e.length+d.length,A=S<p?new Array(p-S+1).join(t):"";switch(g&&h&&(e=r(A+e,A.length?p-d.length:1/0),A=""),n){case"<":e=f+e+d+A;break;case"=":e=f+A+e+d;break;case"^":e=A.slice(0,S=A.length>>1)+f+e+d+A.slice(S);break;default:e=A+f+e+d}return c(e)}return m=null==m?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),C.toString=function(){return e+""},C}return{format:h,formatPrefix:function(e,t){var n=h(((e=u(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(a(t)/3))),i=Math.pow(10,-r),o=v[8+r/3];return function(e){return n(i*e)+o}}}}function m(e){return d=g(e),h=d.format,p=d.formatPrefix,d}function y(e){return Math.max(0,-a(Math.abs(e)))}function b(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(a(t)/3)))-a(Math.abs(e)))}function x(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,a(t)-a(e))+1}m({decimal:".",thousands:",",grouping:[3],currency:["$",""]})},6360:function(e,t,n){"use strict";n.r(t),n.d(t,{clientPoint:function(){return _e},create:function(){return ye},creator:function(){return s},customEvent:function(){return ce},event:function(){return re},local:function(){return xe},matcher:function(){return g},mouse:function(){return Ce},namespace:function(){return i},namespaces:function(){return a},select:function(){return me},selectAll:function(){return Se},selection:function(){return ge},selector:function(){return l},selectorAll:function(){return d},style:function(){return I},touch:function(){return Ae},touches:function(){return Ee},window:function(){return T}});var r="http://www.w3.org/1999/xhtml",a={svg:"http://www.w3.org/2000/svg",xhtml:r,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function i(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),a.hasOwnProperty(t)?{space:a[t],local:e}:e}function o(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===r&&t.documentElement.namespaceURI===r?t.createElement(e):t.createElementNS(n,e)}}function u(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function s(e){var t=i(e);return(t.local?u:o)(t)}function c(){}function l(e){return null==e?c:function(){return this.querySelector(e)}}function f(){return[]}function d(e){return null==e?f:function(){return this.querySelectorAll(e)}}var h=function(e){return function(){return this.matches(e)}};if("undefined"!==typeof document){var p=document.documentElement;if(!p.matches){var v=p.webkitMatchesSelector||p.msMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector;h=function(e){return function(){return v.call(this,e)}}}}var g=h;function m(e){return new Array(e.length)}function y(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}y.prototype={constructor:y,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function b(e,t,n,r,a,i){for(var o,u=0,s=t.length,c=i.length;u<c;++u)(o=t[u])?(o.__data__=i[u],r[u]=o):n[u]=new y(e,i[u]);for(;u<s;++u)(o=t[u])&&(a[u]=o)}function x(e,t,n,r,a,i,o){var u,s,c,l={},f=t.length,d=i.length,h=new Array(f);for(u=0;u<f;++u)(s=t[u])&&(h[u]=c="$"+o.call(s,s.__data__,u,t),c in l?a[u]=s:l[c]=s);for(u=0;u<d;++u)(s=l[c="$"+o.call(e,i[u],u,i)])?(r[u]=s,s.__data__=i[u],l[c]=null):n[u]=new y(e,i[u]);for(u=0;u<f;++u)(s=t[u])&&l[h[u]]===s&&(a[u]=s)}function k(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function w(e){return function(){this.removeAttribute(e)}}function _(e){return function(){this.removeAttributeNS(e.space,e.local)}}function C(e,t){return function(){this.setAttribute(e,t)}}function S(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function A(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function E(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function T(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function N(e){return function(){this.style.removeProperty(e)}}function D(e,t,n){return function(){this.style.setProperty(e,t,n)}}function F(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function I(e,t){return e.style.getPropertyValue(t)||T(e).getComputedStyle(e,null).getPropertyValue(t)}function M(e){return function(){delete this[e]}}function O(e,t){return function(){this[e]=t}}function R(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function Z(e){return e.trim().split(/^|\s+/)}function B(e){return e.classList||new z(e)}function z(e){this._node=e,this._names=Z(e.getAttribute("class")||"")}function L(e,t){for(var n=B(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function P(e,t){for(var n=B(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function j(e){return function(){L(this,e)}}function U(e){return function(){P(this,e)}}function W(e,t){return function(){(t.apply(this,arguments)?L:P)(this,e)}}function V(){this.textContent=""}function G(e){return function(){this.textContent=e}}function q(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function H(){this.innerHTML=""}function X(e){return function(){this.innerHTML=e}}function Y(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function K(){this.nextSibling&&this.parentNode.appendChild(this)}function $(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Q(){return null}function J(){var e=this.parentNode;e&&e.removeChild(this)}function ee(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function te(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}z.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var ne={},re=null;"undefined"!==typeof document&&("onmouseenter"in document.documentElement||(ne={mouseenter:"mouseover",mouseleave:"mouseout"}));function ae(e,t,n){return e=ie(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function ie(e,t,n){return function(r){var a=re;re=r;try{e.call(this,this.__data__,t,n)}finally{re=a}}}function oe(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function ue(e){return function(){var t=this.__on;if(t){for(var n,r=0,a=-1,i=t.length;r<i;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++a]=n:this.removeEventListener(n.type,n.listener,n.capture);++a?t.length=a:delete this.__on}}}function se(e,t,n){var r=ne.hasOwnProperty(e.type)?ae:ie;return function(a,i,o){var u,s=this.__on,c=r(t,i,o);if(s)for(var l=0,f=s.length;l<f;++l)if((u=s[l]).type===e.type&&u.name===e.name)return this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=c,u.capture=n),void(u.value=t);this.addEventListener(e.type,c,n),u={type:e.type,name:e.name,value:t,listener:c,capture:n},s?s.push(u):this.__on=[u]}}function ce(e,t,n,r){var a=re;e.sourceEvent=re,re=e;try{return t.apply(n,r)}finally{re=a}}function le(e,t,n){var r=T(e),a=r.CustomEvent;"function"===typeof a?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function fe(e,t){return function(){return le(this,e,t)}}function de(e,t){return function(){return le(this,e,t.apply(this,arguments))}}var he=[null];function pe(e,t){this._groups=e,this._parents=t}function ve(){return new pe([[document.documentElement]],he)}pe.prototype=ve.prototype={constructor:pe,select:function(e){"function"!==typeof e&&(e=l(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o,u=t[a],s=u.length,c=r[a]=new Array(s),f=0;f<s;++f)(i=u[f])&&(o=e.call(i,i.__data__,f,u))&&("__data__"in i&&(o.__data__=i.__data__),c[f]=o);return new pe(r,this._parents)},selectAll:function(e){"function"!==typeof e&&(e=d(e));for(var t=this._groups,n=t.length,r=[],a=[],i=0;i<n;++i)for(var o,u=t[i],s=u.length,c=0;c<s;++c)(o=u[c])&&(r.push(e.call(o,o.__data__,c,u)),a.push(o));return new pe(r,a)},filter:function(e){"function"!==typeof e&&(e=g(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o=t[a],u=o.length,s=r[a]=[],c=0;c<u;++c)(i=o[c])&&e.call(i,i.__data__,c,o)&&s.push(i);return new pe(r,this._parents)},data:function(e,t){if(!e)return p=new Array(this.size()),l=-1,this.each((function(e){p[++l]=e})),p;var n,r=t?x:b,a=this._parents,i=this._groups;"function"!==typeof e&&(n=e,e=function(){return n});for(var o=i.length,u=new Array(o),s=new Array(o),c=new Array(o),l=0;l<o;++l){var f=a[l],d=i[l],h=d.length,p=e.call(f,f&&f.__data__,l,a),v=p.length,g=s[l]=new Array(v),m=u[l]=new Array(v);r(f,d,g,m,c[l]=new Array(h),p,t);for(var y,k,w=0,_=0;w<v;++w)if(y=g[w]){for(w>=_&&(_=w+1);!(k=m[_])&&++_<v;);y._next=k||null}}return(u=new pe(u,a))._enter=s,u._exit=c,u},enter:function(){return new pe(this._enter||this._groups.map(m),this._parents)},exit:function(){return new pe(this._exit||this._groups.map(m),this._parents)},merge:function(e){for(var t=this._groups,n=e._groups,r=t.length,a=n.length,i=Math.min(r,a),o=new Array(r),u=0;u<i;++u)for(var s,c=t[u],l=n[u],f=c.length,d=o[u]=new Array(f),h=0;h<f;++h)(s=c[h]||l[h])&&(d[h]=s);for(;u<r;++u)o[u]=t[u];return new pe(o,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,a=e[t],i=a.length-1,o=a[i];--i>=0;)(r=a[i])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=k);for(var n=this._groups,r=n.length,a=new Array(r),i=0;i<r;++i){for(var o,u=n[i],s=u.length,c=a[i]=new Array(s),l=0;l<s;++l)(o=u[l])&&(c[l]=o);c.sort(t)}return new pe(a,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each((function(){e[++t]=this})),e},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,i=r.length;a<i;++a){var o=r[a];if(o)return o}return null},size:function(){var e=0;return this.each((function(){++e})),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a,i=t[n],o=0,u=i.length;o<u;++o)(a=i[o])&&e.call(a,a.__data__,o,i);return this},attr:function(e,t){var n=i(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?_:w:"function"===typeof t?n.local?E:A:n.local?S:C)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?N:"function"===typeof t?F:D)(e,t,null==n?"":n)):I(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?M:"function"===typeof t?R:O)(e,t)):this.node()[e]},classed:function(e,t){var n=Z(e+"");if(arguments.length<2){for(var r=B(this.node()),a=-1,i=n.length;++a<i;)if(!r.contains(n[a]))return!1;return!0}return this.each(("function"===typeof t?W:t?j:U)(n,t))},text:function(e){return arguments.length?this.each(null==e?V:("function"===typeof e?q:G)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?H:("function"===typeof e?Y:X)(e)):this.node().innerHTML},raise:function(){return this.each(K)},lower:function(){return this.each($)},append:function(e){var t="function"===typeof e?e:s(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"===typeof e?e:s(e),r=null==t?Q:"function"===typeof t?t:l(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(J)},clone:function(e){return this.select(e?te:ee)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,a,i=oe(e+""),o=i.length;if(!(arguments.length<2)){for(u=t?se:ue,null==n&&(n=!1),r=0;r<o;++r)this.each(u(i[r],t,n));return this}var u=this.node().__on;if(u)for(var s,c=0,l=u.length;c<l;++c)for(r=0,s=u[c];r<o;++r)if((a=i[r]).type===s.type&&a.name===s.name)return s.value},dispatch:function(e,t){return this.each(("function"===typeof t?de:fe)(e,t))}};var ge=ve;function me(e){return"string"===typeof e?new pe([[document.querySelector(e)]],[document.documentElement]):new pe([[e]],he)}function ye(e){return me(s(e).call(document.documentElement))}var be=0;function xe(){return new ke}function ke(){this._="@"+(++be).toString(36)}function we(){for(var e,t=re;e=t.sourceEvent;)t=e;return t}function _e(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}var a=e.getBoundingClientRect();return[t.clientX-a.left-e.clientLeft,t.clientY-a.top-e.clientTop]}function Ce(e){var t=we();return t.changedTouches&&(t=t.changedTouches[0]),_e(e,t)}function Se(e){return"string"===typeof e?new pe([document.querySelectorAll(e)],[document.documentElement]):new pe([null==e?[]:e],he)}function Ae(e,t,n){arguments.length<3&&(n=t,t=we().changedTouches);for(var r,a=0,i=t?t.length:0;a<i;++a)if((r=t[a]).identifier===n)return _e(e,r);return null}function Ee(e,t){null==t&&(t=we().touches);for(var n=0,r=t?t.length:0,a=new Array(r);n<r;++n)a[n]=_e(e,t[n]);return a}ke.prototype=xe.prototype={constructor:ke,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}}},8262:function(e){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,a,i;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(a=r;0!==a--;)if(!e(t[a],n[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(i=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(a=r;0!==a--;)if(!Object.prototype.hasOwnProperty.call(n,i[a]))return!1;for(a=r;0!==a--;){var o=i[a];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n}},2248:function(e){"use strict";e.exports=function(e,t){t||(t={}),"function"===typeof t&&(t={cmp:t});var n,r="boolean"===typeof t.cycles&&t.cycles,a=t.cmp&&(n=t.cmp,function(e){return function(t,r){var a={key:t,value:e[t]},i={key:r,value:e[r]};return n(a,i)}}),i=[];return function e(t){if(t&&t.toJSON&&"function"===typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!==typeof t)return JSON.stringify(t);var n,o;if(Array.isArray(t)){for(o="[",n=0;n<t.length;n++)n&&(o+=","),o+=e(t[n])||"null";return o+"]"}if(null===t)return"null";if(-1!==i.indexOf(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=i.push(t)-1,s=Object.keys(t).sort(a&&a(t));for(o="",n=0;n<s.length;n++){var c=s[n],l=e(t[c]);l&&(o&&(o+=","),o+=JSON.stringify(c)+":"+l)}return i.splice(u,1),"{"+o+"}"}}(e)}},6514:function(e){"use strict";var t=/-(.)/g;e.exports=function(e){return e.replace(t,(function(e,t){return t.toUpperCase()}))}},4023:function(e,t,n){"use strict";var r=n(6514),a=/^-ms-/;e.exports=function(e){return r(e.replace(a,"ms-"))}},9394:function(e){"use strict";function t(e){return function(){return e}}var n=function(){};n.thatReturns=t,n.thatReturnsFalse=t(!1),n.thatReturnsTrue=t(!0),n.thatReturnsNull=t(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(e){return e},e.exports=n},8186:function(e){"use strict";var t=/([A-Z])/g;e.exports=function(e){return e.replace(t,"-$1").toLowerCase()}},3476:function(e,t,n){"use strict";var r=n(8186),a=/^ms-/;e.exports=function(e){return r(e).replace(a,"-ms-")}},7983:function(e){"use strict";e.exports=function(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}},3255:function(e,t,n){"use strict";var r=n(9394);e.exports=r},4100:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};var r=["Webkit","ms","Moz","O"];Object.keys(n).forEach((function(e){r.forEach((function(t){n[function(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}(t,e)]=n[e]}))}));var a={isUnitlessNumber:n,shorthandPropertyExpansions:{background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}}};t.default=a},1934:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(n(4100));a(n(3255));function a(e){return e&&e.__esModule?e:{default:e}}var i=r.default.isUnitlessNumber;t.default=function(e,t,n){return null==t||"boolean"===typeof t||""===t?"":isNaN(t)||0===t||i.hasOwnProperty(e)&&i[e]?""+t:("string"===typeof t&&(t=t.trim()),t+"px")}},7811:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processStyleName=void 0,t.createMarkupForStyles=function(e,t){var n="";for(var a in e){var i=0===a.indexOf("--");if(e.hasOwnProperty(a)&&"label"!==a){var o=e[a];0,null!=o&&(i?n+=a+":"+o+";":(n+=u(a)+":",n+=(0,r.default)(a,o,t)+";"))}}return n||null};o(n(4023));var r=o(n(1934)),a=o(n(3476)),i=o(n(7983));o(n(3255));function o(e){return e&&e.__esModule?e:{default:e}}var u=t.processStyleName=(0,i.default)(a.default)},5758:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(e){if(function(e){return null===e||void 0===e||!1===e||"object"===("undefined"===typeof e?"undefined":n(e))&&0===Object.keys(e).length}(e))return null;if("object"!==("undefined"===typeof e?"undefined":n(e)))return e;for(var t={},r=Object.keys(e),i=!1,o=0;o<r.length;o++){var u=e[r[o]],s=a(u);null!==s&&s===u||(i=!0),null!==s&&(t[r[o]]=s)}return 0===Object.keys(t).length?null:i?t:e}function a(e){return Array.isArray(e)?function(e){var t=!1,n=[];return e.forEach((function(e){var r=a(e);null!==r&&r===e||(t=!0),null!==r&&n.push(r)})),0==n.length?null:t?n:e}(e):r(e)}t.default=a},7595:function(e,t){"use strict";function n(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)+(e.charCodeAt(t++)<<16)+(e.charCodeAt(t)<<24)}function r(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)}function a(e,t){return(65535&(e|=0))*(t|=0)+(((e>>>16)*t&65535)<<16)|0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var i=1540483477,o=t^e.length,u=e.length,s=0;for(;u>=4;){var c=n(e,s);c=a(c,i),c=a(c^=c>>>24,i),o=a(o,i),o^=c,s+=4,u-=4}switch(u){case 3:o^=r(e,s),o=a(o^=e.charCodeAt(s+2)<<16,i);break;case 2:o=a(o^=r(e,s),i);break;case 1:o=a(o^=e.charCodeAt(s),i)}return o=a(o^=o>>>13,i),(o^=o>>>15)>>>0}},7938:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compose=t.merge=t.$=t.style=t.presets=t.keyframes=t.fontFace=t.insertGlobal=t.insertRule=t.plugins=t.styleSheet=void 0,t.speedy=function(e){return f.speedy(e)},t.simulations=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];v=!!e},t.simulate=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!(t=(0,o.default)(t)))return{};if(!v)return g||(console.warn("can't simulate without once calling simulations(true)"),g=!0),m||(console.warn("don't use simulation outside dev"),m=!0),{};return t.reduce((function(e,t){return e["data-simulate-"+b(t)]="",e}),{})},t.cssLabels=function(e){y=!!e},t.isLikeRule=k,t.idFor=w,t.css=V,t.rehydrate=function(e){(0,r.default)(N,e.reduce((function(e,t){return e[t]=!0,e}),{}))},t.flush=function(){N=f.inserted={},D=f.registered={},I={},f.flush(),f.inject()},t.select=q,t.parent=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return V(l({},e+" &",n))},t.media=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return V(l({},"@media "+e,n))},t.pseudo=H,t.active=function(e){return H(":active",e)},t.any=function(e){return H(":any",e)},t.checked=function(e){return H(":checked",e)},t.disabled=function(e){return H(":disabled",e)},t.empty=function(e){return H(":empty",e)},t.enabled=function(e){return H(":enabled",e)},t._default=function(e){return H(":default",e)},t.first=function(e){return H(":first",e)},t.firstChild=function(e){return H(":first-child",e)},t.firstOfType=function(e){return H(":first-of-type",e)},t.fullscreen=function(e){return H(":fullscreen",e)},t.focus=function(e){return H(":focus",e)},t.hover=function(e){return H(":hover",e)},t.indeterminate=function(e){return H(":indeterminate",e)},t.inRange=function(e){return H(":in-range",e)},t.invalid=function(e){return H(":invalid",e)},t.lastChild=function(e){return H(":last-child",e)},t.lastOfType=function(e){return H(":last-of-type",e)},t.left=function(e){return H(":left",e)},t.link=function(e){return H(":link",e)},t.onlyChild=function(e){return H(":only-child",e)},t.onlyOfType=function(e){return H(":only-of-type",e)},t.optional=function(e){return H(":optional",e)},t.outOfRange=function(e){return H(":out-of-range",e)},t.readOnly=function(e){return H(":read-only",e)},t.readWrite=function(e){return H(":read-write",e)},t.required=function(e){return H(":required",e)},t.right=function(e){return H(":right",e)},t.root=function(e){return H(":root",e)},t.scope=function(e){return H(":scope",e)},t.target=function(e){return H(":target",e)},t.valid=function(e){return H(":valid",e)},t.visited=function(e){return H(":visited",e)},t.dir=function(e,t){return H(":dir("+e+")",t)},t.lang=function(e,t){return H(":lang("+e+")",t)},t.not=function(e,t){var n=e.split(",").map((function(e){return e.trim()})).map((function(e){return":not("+e+")"}));if(1===n.length)return H(":not("+e+")",t);return q(n.join(""),t)},t.nthChild=function(e,t){return H(":nth-child("+e+")",t)},t.nthLastChild=function(e,t){return H(":nth-last-child("+e+")",t)},t.nthLastOfType=function(e,t){return H(":nth-last-of-type("+e+")",t)},t.nthOfType=function(e,t){return H(":nth-of-type("+e+")",t)},t.after=function(e){return H("::after",e)},t.before=function(e){return H("::before",e)},t.firstLetter=function(e){return H("::first-letter",e)},t.firstLine=function(e){return H("::first-line",e)},t.selection=function(e){return H("::selection",e)},t.backdrop=function(e){return H("::backdrop",e)},t.placeholder=function(e){return V({"::placeholder":e})},t.cssFor=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(t=(0,o.default)(t))?t.map((function(e){var t={label:[]};return z(t,{src:e}),T(x(t),E(t)).join("")})).join(""):""},t.attribsFor=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=(t=(0,o.default)(t))?t.map((function(e){w(e);var t=Object.keys(e)[0];return t+'="'+(e[t]||"")+'"'})).join(" "):"";return r};var r=c(n(4368)),a=n(1431),i=n(7811),o=c(n(5758)),u=n(63),s=c(n(7595));function c(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=t.styleSheet=new a.StyleSheet;f.inject();var d=t.plugins=f.plugins=new u.PluginSet([u.prefixes,u.contentWrap,u.fallbacks]);d.media=new u.PluginSet,d.fontFace=new u.PluginSet,d.keyframes=new u.PluginSet([u.prefixes,u.fallbacks]);var h=!1,p="undefined"!==typeof window,v=h,g=!1,m=!1;var y=h;function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.toLowerCase().replace(/[^a-z0-9]/g,t)}function x(e){var t=JSON.stringify(e),n=(0,s.default)(t).toString(36);return e.label&&e.label.length,n}function k(e){var t=Object.keys(e).filter((function(e){return"toString"!==e}));return 1===t.length&&!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0])}function w(e){var t=Object.keys(e).filter((function(e){return"toString"!==e}));if(1!==t.length)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0]);if(!n)throw new Error("not a rule");return n[1]}var _=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function C(e){if(-1===e.indexOf(","))return[e];for(var t,n=[],r=[],a=0;t=_.exec(e);)switch(t[0]){case"(":a++;break;case")":a--;break;case",":if(a)break;n.push(t.index)}for(t=n.length;t--;)r.unshift(e.slice(n[t]+1)),e=e.slice(0,n[t]);return r.unshift(e),r}function S(e,t){if(!e)return t.replace(/\&/g,"");if(!t)return".css-"+e+",[data-css-"+e+"]";var n=C(t).map((function(t){return t.indexOf("&")>=0?[t.replace(/\&/gm,".css-"+e),t.replace(/\&/gm,"[data-css-"+e+"]")].join(","):".css-"+e+t+",[data-css-"+e+"]"+t})).join(",");return v&&/^\&\:/.exec(t)&&!/\s/.exec(t)&&(n+=",.css-"+e+"[data-simulate-"+b(t)+"],[data-css-"+e+"][data-simulate-"+b(t)+"]"),n}function A(e){var t=e.selector,n=e.style,r=d.transform({selector:t,style:n});return r.selector+"{"+(0,i.createMarkupForStyles)(r.style)+"}"}function E(e){var t=void 0,n=void 0,r=void 0,a=void 0;return Object.keys(e).forEach((function(i){i.indexOf("&")>=0?(n=n||{})[i]=e[i]:0===i.indexOf("@media")?(r=r||{})[i]=E(e[i]):0===i.indexOf("@supports")?(a=a||{})[i]=E(e[i]):"label"===i?e.label.length>0&&((t=t||{}).label=y?e.label.join("."):""):(t=t||{})[i]=e[i]})),{plain:t,selects:n,medias:r,supports:a}}function T(e,t){var n=[],r=t.plain,a=t.selects,i=t.medias,o=t.supports;return r&&n.push(A({style:r,selector:S(e)})),a&&Object.keys(a).forEach((function(t){return n.push(A({style:a[t],selector:S(e,t)}))})),i&&Object.keys(i).forEach((function(t){return n.push(t+"{"+T(e,i[t]).join("")+"}")})),o&&Object.keys(o).forEach((function(t){return n.push(t+"{"+T(e,o[t]).join("")+"}")})),n}var N=f.inserted={};var D=f.registered={};function F(e){D[e.id]||(D[e.id]=e)}var I={};function M(e){if(F(e),function(e){if(!N[e.id]){N[e.id]=!0;var t=E(e.style),n=T(e.id,t);N[e.id]=!!p||n,n.forEach((function(e){return f.insert(e)}))}}(e),I[e.id])return I[e.id];var t=l({},"data-css-"+e.id,y&&e.label||"");return Object.defineProperty(t,"toString",{enumerable:!1,value:function(){return"css-"+e.id}}),I[e.id]=t,t}function O(e,t){var n=C(e).map((function(e){return e.indexOf("&")>=0?e:"&"+e})),r=C(t).map((function(e){return e.indexOf("&")>=0?e:"&"+e}));return r.reduce((function(e,t){return e.concat(n.map((function(e){return t.replace(/\&/g,e)})))}),[]).join(",")}function R(e,t){return e?"@supports "+e.substring(9)+" and "+t.substring(9):t}function Z(e){for(var t=[],n=0;n<e.length;n++)t=Array.isArray(e[n])?t.concat(Z(e[n])):t.concat(e[n]);return t}var B={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function z(e,t){var n=t.selector,r=void 0===n?"":n,a=t.mq,i=void 0===a?"":a,u=t.supp,s=void 0===u?"":u,c=t.src,l=void 0===c?{}:c;Array.isArray(l)||(l=[l]),(l=Z(l)).forEach((function(t){if(k(t)){var n=function(e){if(k(e)){var t=D[w(e)];if(null==t)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return t}return e}(t);if("css"!==n.type)throw new Error("cannot merge this rule");t=n.style}(t=(0,o.default)(t))&&t.composes&&z(e,{selector:r,mq:i,supp:s,src:t.composes}),Object.keys(t||{}).forEach((function(n){if(function(e){for(var t=[":",".","[",">"," "],n=!1,r=e.charAt(0),a=0;a<t.length;a++)if(r===t[a]){n=!0;break}return n||e.indexOf("&")>=0}(n))B[n]&&B[n].forEach((function(a){return z(e,{selector:O(r,a),mq:i,supp:s,src:t[n]})})),z(e,{selector:O(r,n),mq:i,supp:s,src:t[n]});else if(function(e){return 0===e.indexOf("@media")}(n))z(e,{selector:r,mq:(o=i,u=n,o?"@media "+o.substring(6)+" and "+u.substring(6):u),supp:s,src:t[n]});else if(function(e){return 0===e.indexOf("@supports")}(n))z(e,{selector:r,mq:i,supp:R(s,n),src:t[n]});else if("composes"===n);else{var a=e;s&&(a[s]=a[s]||{},a=a[s]),i&&(a[i]=a[i]||{},a=a[i]),r&&(a[r]=a[r]||{},a=a[r]),"label"===n?y&&(e.label=e.label.concat(t.label)):a[n]=t[n]}var o,u}))}))}function L(e){var t={label:[]};return z(t,{src:e}),M({id:x(t),style:t,label:y?t.label.join("."):"",type:"css"})}var P={};Object.defineProperty(P,"toString",{enumerable:!1,value:function(){return"css-nil"}});var j="undefined"!==typeof WeakMap?[P,new WeakMap,new WeakMap,new WeakMap]:[P];var U,W="undefined"!==typeof WeakMap?(U=L,function(e){if(j[e.length]){for(var t=j[e.length],n=0;n<e.length-1;)t.has(e[n])||t.set(e[n],new WeakMap),t=t.get(e[n]),n++;if(t.has(e[e.length-1])){var r=t.get(e[n]);if(D[r.toString().substring(4)])return r}}var a=U(e);if(j[e.length]){for(var i=0,o=j[e.length];i<e.length-1;)o=o.get(e[i]),i++;try{o.set(e[i],a)}catch(u){}}return a}):L;function V(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0]&&t[0].length&&t[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return(t=(0,o.default)(t))?W(t):P}V.insert=function(e){var t={id:x(e),css:e,type:"raw"};F(t),N[t.id]||(f.insert(t.css),N[t.id]=!!p||[t.css])};t.insertRule=V.insert;V.global=function(e,t){if(t=(0,o.default)(t))return V.insert(A({selector:e,style:t}))};t.insertGlobal=V.global;V.keyframes=function(e,t){t||(t=e,e="animation");var n={id:x({name:e,kfs:t=(0,o.default)(t)||{}}),type:"keyframes",name:e,keyframes:t};return F(n),function(e){if(!N[e.id]){var t=Object.keys(e.keyframes).map((function(t){var n=d.keyframes.transform({id:e.id,name:t,style:e.keyframes[t]});return n.name+"{"+(0,i.createMarkupForStyles)(n.style)+"}"})).join(""),n=["-webkit-","-moz-","-o-",""].map((function(n){return"@"+n+"keyframes "+e.name+"_"+e.id+"{"+t+"}"}));n.forEach((function(e){return f.insert(e)})),N[e.id]=!!p||n}}(n),e+"_"+n.id},V.fontFace=function(e){var t={id:x(e=(0,o.default)(e)),type:"font-face",font:e};return F(t),function(e){if(!N[e.id]){var t="@font-face{"+(0,i.createMarkupForStyles)(e.font)+"}";f.insert(t),N[e.id]=!!p||[t]}}(t),e.fontFamily};t.fontFace=V.fontFace,t.keyframes=V.keyframes;t.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var G=t.style=V;function q(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e?V(l({},e,n)):G(n)}t.$=q;t.merge=V,t.compose=V;function H(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return V(l({},e,n))}},63:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.PluginSet=s,t.fallbacks=function(e){if(Object.keys(e.style).map((function(t){return Array.isArray(e.style[t])})).indexOf(!0)>=0){var t=e.style,n=Object.keys(t).reduce((function(e,n){return e[n]=Array.isArray(t[n])?t[n].join("; "+(0,i.processStyleName)(n)+": "):t[n],e}),{});return(0,a.default)({},e,{style:n})}return e},t.contentWrap=function(e){if(e.style.content){var t=e.style.content;return c.indexOf(t)>=0||/^(attr|calc|counters?|url)\(/.test(t)?e:t.charAt(0)!==t.charAt(t.length-1)||'"'!==t.charAt(0)&&"'"!==t.charAt(0)?r({},e,{style:r({},e.style,{content:'"'+t+'"'})}):e}return e},t.prefixes=function(e){return(0,a.default)({},e,{style:(0,o.default)(r({},e.style))})};var a=u(n(4368)),i=n(7811),o=u(n(5824));function u(e){return e&&e.__esModule?e:{default:e}}function s(e){this.fns=e||[]}(0,a.default)(s.prototype,{add:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){e.fns.indexOf(t)>=0||(e.fns=[t].concat(e.fns))}))},remove:function(e){this.fns=this.fns.filter((function(t){return t!==e}))},clear:function(){this.fns=[]},transform:function(e){return this.fns.reduce((function(e,t){return t(e)}),e)}});var c=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"]},5824:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t in e){var n=e[t],r=(0,i.default)(m,t,n,e,y);r&&(e[t]=r),(0,a.default)(y,t,e)}return e};var r=g(n(9169)),a=g(n(8183)),i=g(n(4715)),o=g(n(4053)),u=g(n(4370)),s=g(n(6840)),c=g(n(4751)),l=g(n(48)),f=g(n(4810)),d=g(n(8574)),h=g(n(9091)),p=g(n(6312)),v=g(n(4500));function g(e){return e&&e.__esModule?e:{default:e}}var m=[u.default,o.default,s.default,l.default,f.default,d.default,h.default,p.default,v.default,c.default],y=r.default.prefixMap},1431:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StyleSheet=d;var r,a=n(4368),i=(r=a)&&r.__esModule?r:{default:r};function o(e){return e[e.length-1]}function u(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}var s="undefined"!==typeof window,c=!1,l=function(){if(s){var e=document.createElement("div");return e.innerHTML="\x3c!--[if lt IE 10]><i></i><![endif]--\x3e",1===e.getElementsByTagName("i").length}}();function f(){var e=document.createElement("style");return e.type="text/css",e.setAttribute("data-glamor",""),e.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.speedy,n=void 0===t||t,r=e.maxLength,a=void 0===r?s&&l?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=a,this.ctr=0}(0,i.default)(d.prototype,{getSheet:function(){return u(o(this.tags))},inject:function(){var e=this;if(this.injected)throw new Error("already injected stylesheet!");s?this.tags[0]=f():this.sheet={cssRules:[],insertRule:function(t){e.sheet.cssRules.push({cssText:t})}},this.injected=!0},speedy:function(e){if(0!==this.ctr)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+e+") earlier in your app, or call flush() before speedy("+e+")");this.isSpeedy=!!e},_insert:function(e){try{var t=this.getSheet();t.insertRule(e,-1!==e.indexOf("@import")?0:t.cssRules.length)}catch(n){c}},insert:function(e){if(s)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(e);else if(-1!==e.indexOf("@import")){var t=o(this.tags);t.insertBefore(document.createTextNode(e),t.firstChild)}else o(this.tags).appendChild(document.createTextNode(e));else this.sheet.insertRule(e,-1!==e.indexOf("@import")?0:this.sheet.cssRules.length);return this.ctr++,s&&this.ctr%this.maxLength===0&&this.tags.push(f()),this.ctr-1},delete:function(e){return this.replace(e,"")},flush:function(){s?(this.tags.forEach((function(e){return e.parentNode.removeChild(e)})),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!s)return this.sheet.cssRules;var e=[];return this.tags.forEach((function(t){return e.splice.apply(e,[e.length,0].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(Array.from(u(t).cssRules))))})),e}})},7630:function(e,t,n){"use strict";n.r(t);var r=/[A-Z]/g,a=/^ms-/,i={};function o(e){return"-"+e.toLowerCase()}t.default=function(e){if(i.hasOwnProperty(e))return i[e];var t=e.replace(r,o);return i[e]=a.test(t)?"-"+t:t}},4370:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,i.default)(t)&&t.indexOf("cross-fade(")>-1)return o.map((function(e){return t.replace(/cross-fade\(/g,e+"cross-fade(")}))};var r,a=n(5216),i=(r=a)&&r.__esModule?r:{default:r};var o=["-webkit-",""];e.exports=t.default},4053:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("cursor"===e&&r.hasOwnProperty(t))return n.map((function(e){return e+t}))};var n=["-webkit-","-moz-",""],r={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};e.exports=t.default},6840:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,i.default)(t)&&t.indexOf("filter(")>-1)return o.map((function(e){return t.replace(/filter\(/g,e+"filter(")}))};var r,a=n(5216),i=(r=a)&&r.__esModule?r:{default:r};var o=["-webkit-",""];e.exports=t.default},4751:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("display"===e&&n.hasOwnProperty(t))return n[t]};var n={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};e.exports=t.default},48:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a){"flexDirection"===e&&"string"===typeof t&&(t.indexOf("column")>-1?a.WebkitBoxOrient="vertical":a.WebkitBoxOrient="horizontal",t.indexOf("reverse")>-1?a.WebkitBoxDirection="reverse":a.WebkitBoxDirection="normal");r.hasOwnProperty(e)&&(a[r[e]]=n[t]||t)};var n={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},r={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};e.exports=t.default},4810:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,i.default)(t)&&u.test(t))return o.map((function(e){return e+t}))};var r,a=n(5216),i=(r=a)&&r.__esModule?r:{default:r};var o=["-webkit-","-moz-",""],u=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;e.exports=t.default},8574:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("string"===typeof t&&!(0,i.default)(t)&&t.indexOf("image-set(")>-1)return o.map((function(e){return t.replace(/image-set\(/g,e+"image-set(")}))};var r,a=n(5216),i=(r=a)&&r.__esModule?r:{default:r};var o=["-webkit-",""];e.exports=t.default},9091:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if("position"===e&&"sticky"===t)return["-webkit-sticky","sticky"]},e.exports=t.default},6312:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(r.hasOwnProperty(e)&&a.hasOwnProperty(t))return n.map((function(e){return e+t}))};var n=["-webkit-","-moz-",""],r={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},a={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};e.exports=t.default},4500:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o){if("string"===typeof t&&u.hasOwnProperty(e)){var c=function(e,t){if((0,a.default)(e))return e;for(var n=e.split(/,(?![^()]*(?:\([^()]*\))?\))/g),i=0,o=n.length;i<o;++i){var u=n[i],c=[u];for(var l in t){var f=(0,r.default)(l);if(u.indexOf(f)>-1&&"order"!==f)for(var d=t[l],h=0,p=d.length;h<p;++h)c.unshift(u.replace(f,s[d[h]]+f))}n[i]=c.join(",")}return n.join(",")}(t,o),l=c.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(e){return!/-moz-|-ms-/.test(e)})).join(",");if(e.indexOf("Webkit")>-1)return l;var f=c.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(e){return!/-webkit-|-ms-/.test(e)})).join(",");return e.indexOf("Moz")>-1?f:(n["Webkit"+(0,i.default)(e)]=l,n["Moz"+(0,i.default)(e)]=f,c)}};var r=o(n(8546)),a=o(n(5216)),i=o(n(7255));function o(e){return e&&e.__esModule?e:{default:e}}var u={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},s={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};e.exports=t.default},9169:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["Webkit"],r=["Moz"],a=["ms"],i=["Webkit","Moz"],o=["Webkit","ms"],u=["Webkit","Moz","ms"];t.default={plugins:[],prefixMap:{appearance:i,userSelect:u,textEmphasisPosition:n,textEmphasis:n,textEmphasisStyle:n,textEmphasisColor:n,boxDecorationBreak:n,clipPath:n,maskImage:n,maskMode:n,maskRepeat:n,maskPosition:n,maskClip:n,maskOrigin:n,maskSize:n,maskComposite:n,mask:n,maskBorderSource:n,maskBorderMode:n,maskBorderSlice:n,maskBorderWidth:n,maskBorderOutset:n,maskBorderRepeat:n,maskBorder:n,maskType:n,textDecorationStyle:n,textDecorationSkip:n,textDecorationLine:n,textDecorationColor:n,filter:n,fontFeatureSettings:n,breakAfter:u,breakBefore:u,breakInside:u,columnCount:i,columnFill:i,columnGap:i,columnRule:i,columnRuleColor:i,columnRuleStyle:i,columnRuleWidth:i,columns:i,columnSpan:i,columnWidth:i,writingMode:o,flex:n,flexBasis:n,flexDirection:n,flexGrow:n,flexFlow:n,flexShrink:n,flexWrap:n,alignContent:n,alignItems:n,alignSelf:n,justifyContent:n,order:n,transform:n,transformOrigin:n,transformOriginX:n,transformOriginY:n,backfaceVisibility:n,perspective:n,perspectiveOrigin:n,transformStyle:n,transformOriginZ:n,animation:n,animationDelay:n,animationDirection:n,animationFillMode:n,animationDuration:n,animationIterationCount:n,animationName:n,animationPlayState:n,animationTimingFunction:n,backdropFilter:n,fontKerning:n,scrollSnapType:o,scrollSnapPointsX:o,scrollSnapPointsY:o,scrollSnapDestination:o,scrollSnapCoordinate:o,shapeImageThreshold:n,shapeImageMargin:n,shapeImageOutside:n,hyphens:u,flowInto:o,flowFrom:o,regionFragment:o,textAlignLast:r,tabSize:r,wrapFlow:a,wrapThrough:a,wrapMargin:a,gridTemplateColumns:a,gridTemplateRows:a,gridTemplateAreas:a,gridTemplate:a,gridAutoColumns:a,gridAutoRows:a,gridAutoFlow:a,grid:a,gridRowStart:a,gridColumnStart:a,gridRowEnd:a,gridRow:a,gridColumn:a,gridColumnEnd:a,gridColumnGap:a,gridRowGap:a,gridArea:a,gridGap:a,textSizeAdjust:o,borderImage:n,borderImageOutset:n,borderImageRepeat:n,borderImageSlice:n,borderImageSource:n,borderImageWidth:n,transitionDelay:n,transitionDuration:n,transitionProperty:n,transitionTimingFunction:n}},e.exports=t.default},7255:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e.exports=t.default},8183:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(e.hasOwnProperty(t))for(var r=e[t],a=0,o=r.length;a<o;++a)n[r[a]+(0,i.default)(t)]=n[t]};var r,a=n(7255),i=(r=a)&&r.__esModule?r:{default:r};e.exports=t.default},4715:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,r,a){for(var i=0,o=e.length;i<o;++i){var u=e[i](t,n,r,a);if(u)return u}},e.exports=t.default},8987:function(e){e.exports=n;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(S){}function n(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function r(e){return!0===(e&&e.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var a={},i={};function o(e,t){var n,r,o;return t?(o=0<=(e>>>=0)&&e<256)&&(r=i[e])?r:(n=s(e,(0|e)<0?-1:0,!0),o&&(i[e]=n),n):(o=-128<=(e|=0)&&e<128)&&(r=a[e])?r:(n=s(e,e<0?-1:0,!1),o&&(a[e]=n),n)}function u(e,t){if(isNaN(e))return t?m:g;if(t){if(e<0)return m;if(e>=h)return w}else{if(e<=-p)return _;if(e+1>=p)return k}return e<0?u(-e,t).neg():s(e%d|0,e/d|0,t)}function s(e,t,r){return new n(e,t,r)}n.fromInt=o,n.fromNumber=u,n.fromBits=s;var c=Math.pow;function l(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return g;if("number"===typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return l(e.substring(1),t,n).neg();for(var a=u(c(n,8)),i=g,o=0;o<e.length;o+=8){var s=Math.min(8,e.length-o),f=parseInt(e.substring(o,o+s),n);if(s<8){var d=u(c(n,s));i=i.mul(d).add(u(f))}else i=(i=i.mul(a)).add(u(f))}return i.unsigned=t,i}function f(e,t){return"number"===typeof e?u(e,t):"string"===typeof e?l(e,t):s(e.low,e.high,"boolean"===typeof t?t:e.unsigned)}n.fromString=l,n.fromValue=f;var d=4294967296,h=d*d,p=h/2,v=o(1<<24),g=o(0);n.ZERO=g;var m=o(0,!0);n.UZERO=m;var y=o(1);n.ONE=y;var b=o(1,!0);n.UONE=b;var x=o(-1);n.NEG_ONE=x;var k=s(-1,2147483647,!1);n.MAX_VALUE=k;var w=s(-1,-1,!0);n.MAX_UNSIGNED_VALUE=w;var _=s(0,-2147483648,!1);n.MIN_VALUE=_;var C=n.prototype;C.toInt=function(){return this.unsigned?this.low>>>0:this.low},C.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},C.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(_)){var t=u(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var a=u(c(e,6),this.unsigned),i=this,o="";;){var s=i.div(a),l=(i.sub(s.mul(a)).toInt()>>>0).toString(e);if((i=s).isZero())return l+o;for(;l.length<6;)l="0"+l;o=""+l+o}},C.getHighBits=function(){return this.high},C.getHighBitsUnsigned=function(){return this.high>>>0},C.getLowBits=function(){return this.low},C.getLowBitsUnsigned=function(){return this.low>>>0},C.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},C.isZero=function(){return 0===this.high&&0===this.low},C.eqz=C.isZero,C.isNegative=function(){return!this.unsigned&&this.high<0},C.isPositive=function(){return this.unsigned||this.high>=0},C.isOdd=function(){return 1===(1&this.low)},C.isEven=function(){return 0===(1&this.low)},C.equals=function(e){return r(e)||(e=f(e)),(this.unsigned===e.unsigned||this.high>>>31!==1||e.high>>>31!==1)&&(this.high===e.high&&this.low===e.low)},C.eq=C.equals,C.notEquals=function(e){return!this.eq(e)},C.neq=C.notEquals,C.ne=C.notEquals,C.lessThan=function(e){return this.comp(e)<0},C.lt=C.lessThan,C.lessThanOrEqual=function(e){return this.comp(e)<=0},C.lte=C.lessThanOrEqual,C.le=C.lessThanOrEqual,C.greaterThan=function(e){return this.comp(e)>0},C.gt=C.greaterThan,C.greaterThanOrEqual=function(e){return this.comp(e)>=0},C.gte=C.greaterThanOrEqual,C.ge=C.greaterThanOrEqual,C.compare=function(e){if(r(e)||(e=f(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},C.comp=C.compare,C.negate=function(){return!this.unsigned&&this.eq(_)?_:this.not().add(y)},C.neg=C.negate,C.add=function(e){r(e)||(e=f(e));var t=this.high>>>16,n=65535&this.high,a=this.low>>>16,i=65535&this.low,o=e.high>>>16,u=65535&e.high,c=e.low>>>16,l=0,d=0,h=0,p=0;return h+=(p+=i+(65535&e.low))>>>16,d+=(h+=a+c)>>>16,l+=(d+=n+u)>>>16,l+=t+o,s((h&=65535)<<16|(p&=65535),(l&=65535)<<16|(d&=65535),this.unsigned)},C.subtract=function(e){return r(e)||(e=f(e)),this.add(e.neg())},C.sub=C.subtract,C.multiply=function(e){if(this.isZero())return g;if(r(e)||(e=f(e)),t)return s(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return g;if(this.eq(_))return e.isOdd()?_:g;if(e.eq(_))return this.isOdd()?_:g;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(v)&&e.lt(v))return u(this.toNumber()*e.toNumber(),this.unsigned);var n=this.high>>>16,a=65535&this.high,i=this.low>>>16,o=65535&this.low,c=e.high>>>16,l=65535&e.high,d=e.low>>>16,h=65535&e.low,p=0,m=0,y=0,b=0;return y+=(b+=o*h)>>>16,m+=(y+=i*h)>>>16,y&=65535,m+=(y+=o*d)>>>16,p+=(m+=a*h)>>>16,m&=65535,p+=(m+=i*d)>>>16,m&=65535,p+=(m+=o*l)>>>16,p+=n*h+a*d+i*l+o*c,s((y&=65535)<<16|(b&=65535),(p&=65535)<<16|(m&=65535),this.unsigned)},C.mul=C.multiply,C.divide=function(e){if(r(e)||(e=f(e)),e.isZero())throw Error("division by zero");var n,a,i;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?s((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?m:g;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return m;if(e.gt(this.shru(1)))return b;i=m}else{if(this.eq(_))return e.eq(y)||e.eq(x)?_:e.eq(_)?y:(n=this.shr(1).div(e).shl(1)).eq(g)?e.isNegative()?y:x:(a=this.sub(e.mul(n)),i=n.add(a.div(e)));if(e.eq(_))return this.unsigned?m:g;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=g}for(a=this;a.gte(e);){n=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),l=o<=48?1:c(2,o-48),d=u(n),h=d.mul(e);h.isNegative()||h.gt(a);)h=(d=u(n-=l,this.unsigned)).mul(e);d.isZero()&&(d=y),i=i.add(d),a=a.sub(h)}return i},C.div=C.divide,C.modulo=function(e){return r(e)||(e=f(e)),t?s((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},C.mod=C.modulo,C.rem=C.modulo,C.not=function(){return s(~this.low,~this.high,this.unsigned)},C.and=function(e){return r(e)||(e=f(e)),s(this.low&e.low,this.high&e.high,this.unsigned)},C.or=function(e){return r(e)||(e=f(e)),s(this.low|e.low,this.high|e.high,this.unsigned)},C.xor=function(e){return r(e)||(e=f(e)),s(this.low^e.low,this.high^e.high,this.unsigned)},C.shiftLeft=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?s(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):s(0,this.low<<e-32,this.unsigned)},C.shl=C.shiftLeft,C.shiftRight=function(e){return r(e)&&(e=e.toInt()),0===(e&=63)?this:e<32?s(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):s(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},C.shr=C.shiftRight,C.shiftRightUnsigned=function(e){if(r(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?s(this.low>>>e|t<<32-e,t>>>e,this.unsigned):s(32===e?t:t>>>e-32,0,this.unsigned)},C.shru=C.shiftRightUnsigned,C.shr_u=C.shiftRightUnsigned,C.toSigned=function(){return this.unsigned?s(this.low,this.high,!1):this},C.toUnsigned=function(){return this.unsigned?this:s(this.low,this.high,!0)},C.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},C.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},C.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},4368:function(e){"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function a(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(a){return!1}}()?Object.assign:function(e,i){for(var o,u,s=a(e),c=1;c<arguments.length;c++){for(var l in o=Object(arguments[c]))n.call(o,l)&&(s[l]=o[l]);if(t){u=t(o);for(var f=0;f<u.length;f++)r.call(o,u[f])&&(s[u[f]]=o[u[f]])}}return s}},8294:function(e,t,n){"use strict";function r(){}n.r(t),n.d(t,{Component:function(){return Z},cloneElement:function(){return l},createElement:function(){return u},h:function(){return u},options:function(){return a},render:function(){return B},rerender:function(){return p}});var a={},i=[],o=[];function u(e,t){var n,u,s,c,l=o;for(c=arguments.length;c-- >2;)i.push(arguments[c]);for(t&&null!=t.children&&(i.length||i.push(t.children),delete t.children);i.length;)if((u=i.pop())&&void 0!==u.pop)for(c=u.length;c--;)i.push(u[c]);else"boolean"===typeof u&&(u=null),(s="function"!==typeof e)&&(null==u?u="":"number"===typeof u?u=String(u):"string"!==typeof u&&(s=!1)),s&&n?l[l.length-1]+=u:l===o?l=[u]:l.push(u),n=s;var f=new r;return f.nodeName=e,f.children=l,f.attributes=null==t?void 0:t,f.key=null==t?void 0:t.key,void 0!==a.vnode&&a.vnode(f),f}function s(e,t){for(var n in t)e[n]=t[n];return e}var c="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function l(e,t){return u(e.nodeName,s(s({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var f=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,d=[];function h(e){!e._dirty&&(e._dirty=!0)&&1==d.push(e)&&(a.debounceRendering||c)(p)}function p(){var e,t=d;for(d=[];e=t.pop();)e._dirty&&O(e)}function v(e,t,n){return"string"===typeof t||"number"===typeof t?void 0!==e.splitText:"string"===typeof t.nodeName?!e._componentConstructor&&g(e,t.nodeName):n||e._componentConstructor===t.nodeName}function g(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function m(e){var t=s({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===t[r]&&(t[r]=n[r]);return t}function y(e){var t=e.parentNode;t&&t.removeChild(e)}function b(e,t,n,r,a){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)n&&n(null),r&&r(e);else if("class"!==t||a)if("style"===t){if(r&&"string"!==typeof r&&"string"!==typeof n||(e.style.cssText=r||""),r&&"object"===typeof r){if("string"!==typeof n)for(var i in n)i in r||(e.style[i]="");for(var i in r)e.style[i]="number"===typeof r[i]&&!1===f.test(i)?r[i]+"px":r[i]}}else if("dangerouslySetInnerHTML"===t)r&&(e.innerHTML=r.__html||"");else if("o"==t[0]&&"n"==t[1]){var o=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,x,o):e.removeEventListener(t,x,o),(e._listeners||(e._listeners={}))[t]=r}else if("list"!==t&&"type"!==t&&!a&&t in e)!function(e,t,n){try{e[t]=n}catch(r){}}(e,t,null==r?"":r),null!=r&&!1!==r||e.removeAttribute(t);else{var u=a&&t!==(t=t.replace(/^xlink:?/,""));null==r||!1===r?u?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!==typeof r&&(u?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}else e.className=r||""}function x(e){return this._listeners[e.type](a.event&&a.event(e)||e)}var k=[],w=0,_=!1,C=!1;function S(){for(var e;e=k.pop();)a.afterMount&&a.afterMount(e),e.componentDidMount&&e.componentDidMount()}function A(e,t,n,r,a,i){w++||(_=null!=a&&void 0!==a.ownerSVGElement,C=null!=e&&!("__preactattr_"in e));var o=E(e,t,n,r,i);return a&&o.parentNode!==a&&a.appendChild(o),--w||(C=!1,i||S()),o}function E(e,t,n,r,a){var i=e,o=_;if(null!=t&&"boolean"!==typeof t||(t=""),"string"===typeof t||"number"===typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||a)?e.nodeValue!=t&&(e.nodeValue=t):(i=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(i,e),T(e,!0))),i.__preactattr_=!0,i;var u=t.nodeName;if("function"===typeof u)return function(e,t,n,r){var a=e&&e._component,i=a,o=e,u=a&&e._componentConstructor===t.nodeName,s=u,c=m(t);for(;a&&!s&&(a=a._parentComponent);)s=a.constructor===t.nodeName;a&&s&&(!r||a._component)?(M(a,c,3,n,r),e=a.base):(i&&!u&&(R(i),e=o=null),a=F(t.nodeName,c,n),e&&!a.nextBase&&(a.nextBase=e,o=null),M(a,c,1,n,r),e=a.base,o&&e!==o&&(o._component=null,T(o,!1)));return e}(e,t,n,r);if(_="svg"===u||"foreignObject"!==u&&_,u=String(u),(!e||!g(e,u))&&(i=function(e,t){var n=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return n.normalizedNodeName=e,n}(u,_),e)){for(;e.firstChild;)i.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(i,e),T(e,!0)}var s=i.firstChild,c=i.__preactattr_,l=t.children;if(null==c){c=i.__preactattr_={};for(var f=i.attributes,d=f.length;d--;)c[f[d].name]=f[d].value}return!C&&l&&1===l.length&&"string"===typeof l[0]&&null!=s&&void 0!==s.splitText&&null==s.nextSibling?s.nodeValue!=l[0]&&(s.nodeValue=l[0]):(l&&l.length||null!=s)&&function(e,t,n,r,a){var i,o,u,s,c,l=e.childNodes,f=[],d={},h=0,p=0,g=l.length,m=0,b=t?t.length:0;if(0!==g)for(var x=0;x<g;x++){var k=l[x],w=k.__preactattr_;null!=(_=b&&w?k._component?k._component.__key:w.key:null)?(h++,d[_]=k):(w||(void 0!==k.splitText?!a||k.nodeValue.trim():a))&&(f[m++]=k)}if(0!==b)for(x=0;x<b;x++){var _;if(c=null,null!=(_=(s=t[x]).key))h&&void 0!==d[_]&&(c=d[_],d[_]=void 0,h--);else if(!c&&p<m)for(i=p;i<m;i++)if(void 0!==f[i]&&v(o=f[i],s,a)){c=o,f[i]=void 0,i===m-1&&m--,i===p&&p++;break}c=E(c,s,n,r),u=l[x],c&&c!==e&&c!==u&&(null==u?e.appendChild(c):c===u.nextSibling?y(u):e.insertBefore(c,u))}if(h)for(var x in d)void 0!==d[x]&&T(d[x],!1);for(;p<=m;)void 0!==(c=f[m--])&&T(c,!1)}(i,l,n,r,C||null!=c.dangerouslySetInnerHTML),function(e,t,n){var r;for(r in n)t&&null!=t[r]||null==n[r]||b(e,r,n[r],n[r]=void 0,_);for(r in t)"children"===r||"innerHTML"===r||r in n&&t[r]===("value"===r||"checked"===r?e[r]:n[r])||b(e,r,n[r],n[r]=t[r],_)}(i,t.attributes,c),_=o,i}function T(e,t){var n=e._component;n?R(n):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||y(e),N(e))}function N(e){for(e=e.lastChild;e;){var t=e.previousSibling;T(e,!0),e=t}}var D={};function F(e,t,n){var r,a=D[e.name];if(e.prototype&&e.prototype.render?(r=new e(t,n),Z.call(r,t,n)):((r=new Z(t,n)).constructor=e,r.render=I),a)for(var i=a.length;i--;)if(a[i].constructor===e){r.nextBase=a[i].nextBase,a.splice(i,1);break}return r}function I(e,t,n){return this.constructor(e,n)}function M(e,t,n,r,i){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||i?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==n&&(1!==n&&!1===a.syncComponentUpdates&&e.base?h(e):O(e,1,i)),e.__ref&&e.__ref(e))}function O(e,t,n,r){if(!e._disable){var i,o,u,c=e.props,l=e.state,f=e.context,d=e.prevProps||c,h=e.prevState||l,p=e.prevContext||f,v=e.base,g=e.nextBase,y=v||g,b=e._component,x=!1;if(v&&(e.props=d,e.state=h,e.context=p,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(c,l,f)?x=!0:e.componentWillUpdate&&e.componentWillUpdate(c,l,f),e.props=c,e.state=l,e.context=f),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!x){i=e.render(c,l,f),e.getChildContext&&(f=s(s({},f),e.getChildContext()));var _,C,E=i&&i.nodeName;if("function"===typeof E){var N=m(i);(o=b)&&o.constructor===E&&N.key==o.__key?M(o,N,1,f,!1):(_=o,e._component=o=F(E,N,f),o.nextBase=o.nextBase||g,o._parentComponent=e,M(o,N,0,f,!1),O(o,1,n,!0)),C=o.base}else u=y,(_=b)&&(u=e._component=null),(y||1===t)&&(u&&(u._component=null),C=A(u,i,f,n||!v,y&&y.parentNode,!0));if(y&&C!==y&&o!==b){var D=y.parentNode;D&&C!==D&&(D.replaceChild(C,y),_||(y._component=null,T(y,!1)))}if(_&&R(_),e.base=C,C&&!r){for(var I=e,Z=e;Z=Z._parentComponent;)(I=Z).base=C;C._component=I,C._componentConstructor=I.constructor}}if(!v||n?k.unshift(e):x||(e.componentDidUpdate&&e.componentDidUpdate(d,h,p),a.afterUpdate&&a.afterUpdate(e)),null!=e._renderCallbacks)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);w||r||S()}}function R(e){a.beforeUnmount&&a.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?R(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,y(t),function(e){var t=e.constructor.name;(D[t]||(D[t]=[])).push(e)}(e),N(t)),e.__ref&&e.__ref(null)}function Z(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}function B(e,t,n){return A(n,e,{},!1,t,!1)}s(Z.prototype,{setState:function(e,t){var n=this.state;this.prevState||(this.prevState=s({},n)),s(n,"function"===typeof e?e(n,this.props):e),t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),h(this)},forceUpdate:function(e){e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),O(this,2)},render:function(){}});var z={h:u,createElement:u,cloneElement:l,Component:Z,render:B,rerender:p,options:a};t.default=z},4463:function(e,t,n){"use strict";var r=n(2791),a=n(5296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,u={};function s(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(u[e]=t,e=0;e<t.length;e++)o.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),f=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function v(e,t,n,r,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var m=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!f.call(p,e)||!f.call(h,e)&&(d.test(e)?p[e]=!0:(h[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(m,y);g[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=Symbol.for("react.element"),w=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),E=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var M=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function R(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var Z,B=Object.assign;function z(e){if(void 0===Z)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Z=t&&t[1]||""}return"\n"+Z+e}var L=!1;function P(e,t){if(!e||L)return"";L=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,u=i.length-1;1<=o&&0<=u&&a[o]!==i[u];)u--;for(;1<=o&&0<=u;o--,u--)if(a[o]!==i[u]){if(1!==o||1!==u)do{if(o--,0>--u||a[o]!==i[u]){var s="\n"+a[o].replace(" at new "," at ");return e.displayName&&s.includes("<anonymous>")&&(s=s.replace("<anonymous>",e.displayName)),s}}while(1<=o&&0<=u);break}}}finally{L=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?z(e):""}function j(e){switch(e.tag){case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return e=P(e.type,!1);case 11:return e=P(e.type.render,!1);case 1:return e=P(e.type,!0);default:return""}}function U(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case _:return"Fragment";case w:return"Portal";case S:return"Profiler";case C:return"StrictMode";case N:return"Suspense";case D:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case A:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case F:return null!==(t=e.displayName||null)?t:U(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return U(e(t))}catch(n){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return U(t);case 8:return t===C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function H(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=G(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var n=t.checked;return B({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function K(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function Q(e,t){$(e,t);var n=V(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return B({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function ie(e,t){var n=V(t.value),r=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ue(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function se(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ue(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,fe=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var he={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||he.hasOwnProperty(e)&&he[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(he).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),he[t]=he[e]}))}));var me=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function ke(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,_e=null,Ce=null;function Se(e){if(e=ba(e)){if("function"!==typeof we)throw Error(i(280));var t=e.stateNode;t&&(t=ka(t),we(e.stateNode,e.type,t))}}function Ae(e){_e?Ce?Ce.push(e):Ce=[e]:_e=e}function Ee(){if(_e){var e=_e,t=Ce;if(Ce=_e=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Te(e,t){return e(t)}function Ne(){}var De=!1;function Fe(e,t,n){if(De)return e(t,n);De=!0;try{return Te(e,t,n)}finally{De=!1,(null!==_e||null!==Ce)&&(Ne(),Ee())}}function Ie(e,t){var n=e.stateNode;if(null===n)return null;var r=ka(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Me=!1;if(l)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Me=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(le){Me=!1}function Re(e,t,n,r,a,i,o,u,s){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var Ze=!1,Be=null,ze=!1,Le=null,Pe={onError:function(e){Ze=!0,Be=e}};function je(e,t,n,r,a,i,o,u,s){Ze=!1,Be=null,Re.apply(Pe,arguments)}function Ue(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(Ue(e)!==e)throw Error(i(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ue(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return Ve(a),e;if(o===r)return Ve(a),t;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=o;else{for(var u=!1,s=a.child;s;){if(s===n){u=!0,n=a,r=o;break}if(s===r){u=!0,r=a,n=o;break}s=s.sibling}if(!u){for(s=o.child;s;){if(s===n){u=!0,n=o,r=a;break}if(s===r){u=!0,r=o,n=a;break}s=s.sibling}if(!u)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var He=a.unstable_scheduleCallback,Xe=a.unstable_cancelCallback,Ye=a.unstable_shouldYield,Ke=a.unstable_requestPaint,$e=a.unstable_now,Qe=a.unstable_getCurrentPriorityLevel,Je=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ut(e)/st|0)|0},ut=Math.log,st=Math.LN2;var ct=64,lt=4194304;function ft(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,o=268435455&n;if(0!==o){var u=o&~a;0!==u?r=ft(u):0!==(i&=o)&&(r=ft(i))}else 0!==(o=n&~a)?r=ft(o):0!==i&&(r=ft(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-ot(t)),r|=e[n],t&=~a;return r}function ht(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var kt,wt,_t,Ct,St,At=!1,Et=[],Tt=null,Nt=null,Dt=null,Ft=new Map,It=new Map,Mt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rt(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":Dt=null;break;case"pointerover":case"pointerout":Ft.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":It.delete(t.pointerId)}}function Zt(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&wt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Bt(e){var t=ya(e.target);if(null!==t){var n=Ue(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=We(n)))return e.blockedOn=t,void St(e.priority,(function(){_t(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function zt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&wt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Lt(e,t,n){zt(e)&&n.delete(t)}function Pt(){At=!1,null!==Tt&&zt(Tt)&&(Tt=null),null!==Nt&&zt(Nt)&&(Nt=null),null!==Dt&&zt(Dt)&&(Dt=null),Ft.forEach(Lt),It.forEach(Lt)}function jt(e,t){e.blockedOn===t&&(e.blockedOn=null,At||(At=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Pt)))}function Ut(e){function t(t){return jt(t,e)}if(0<Et.length){jt(Et[0],e);for(var n=1;n<Et.length;n++){var r=Et[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Tt&&jt(Tt,e),null!==Nt&&jt(Nt,e),null!==Dt&&jt(Dt,e),Ft.forEach(t),It.forEach(t),n=0;n<Mt.length;n++)(r=Mt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Mt.length&&null===(n=Mt[0]).blockedOn;)Bt(n),null===n.blockedOn&&Mt.shift()}var Wt=x.ReactCurrentBatchConfig,Vt=!0;function Gt(e,t,n,r){var a=bt,i=Wt.transition;Wt.transition=null;try{bt=1,Ht(e,t,n,r)}finally{bt=a,Wt.transition=i}}function qt(e,t,n,r){var a=bt,i=Wt.transition;Wt.transition=null;try{bt=4,Ht(e,t,n,r)}finally{bt=a,Wt.transition=i}}function Ht(e,t,n,r){if(Vt){var a=Yt(e,t,n,r);if(null===a)Vr(e,t,r,Xt,n),Rt(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Tt=Zt(Tt,e,t,n,r,a),!0;case"dragenter":return Nt=Zt(Nt,e,t,n,r,a),!0;case"mouseover":return Dt=Zt(Dt,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return Ft.set(i,Zt(Ft.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,It.set(i,Zt(It.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Rt(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&kt(i),null===(i=Yt(e,t,n,r))&&Vr(e,t,r,Xt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Vr(e,t,r,null,n)}}var Xt=null;function Yt(e,t,n,r){if(Xt=null,null!==(e=ya(e=ke(r))))if(null===(t=Ue(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Kt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qe()){case Je:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var $t=null,Qt=null,Jt=null;function en(){if(Jt)return Jt;var e,t,n=Qt,r=n.length,a="value"in $t?$t.value:$t.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return Jt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return B(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,un,sn,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(cn),fn=B({},cn,{view:0,detail:0}),dn=an(fn),hn=B({},fn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sn&&(sn&&"mousemove"===e.type?(on=e.screenX-sn.screenX,un=e.screenY-sn.screenY):un=on=0,sn=e),on)},movementY:function(e){return"movementY"in e?e.movementY:un}}),pn=an(hn),vn=an(B({},hn,{dataTransfer:0})),gn=an(B({},fn,{relatedTarget:0})),mn=an(B({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=B({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),xn=an(B({},cn,{data:0})),kn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=_n[e])&&!!t[e]}function Sn(){return Cn}var An=B({},fn,{key:function(e){if(e.key){var t=kn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),En=an(An),Tn=an(B({},hn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=an(B({},fn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sn})),Dn=an(B({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Fn=B({},hn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),In=an(Fn),Mn=[9,13,27,32],On=l&&"CompositionEvent"in window,Rn=null;l&&"documentMode"in document&&(Rn=document.documentMode);var Zn=l&&"TextEvent"in window&&!Rn,Bn=l&&(!On||Rn&&8<Rn&&11>=Rn),zn=String.fromCharCode(32),Ln=!1;function Pn(e,t){switch(e){case"keyup":return-1!==Mn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Un=!1;var Wn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wn[e.type]:"textarea"===t}function Gn(e,t,n,r){Ae(r),0<(t=qr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var qn=null,Hn=null;function Xn(e){zr(e,0)}function Yn(e){if(H(xa(e)))return e}function Kn(e,t){if("change"===e)return t}var $n=!1;if(l){var Qn;if(l){var Jn="oninput"in document;if(!Jn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Jn="function"===typeof er.oninput}Qn=Jn}else Qn=!1;$n=Qn&&(!document.documentMode||9<document.documentMode)}function tr(){qn&&(qn.detachEvent("onpropertychange",nr),Hn=qn=null)}function nr(e){if("value"===e.propertyName&&Yn(Hn)){var t=[];Gn(t,Hn,e,ke(e)),Fe(Xn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Hn=n,(qn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Hn)}function ir(e,t){if("click"===e)return Yn(t)}function or(e,t){if("input"===e||"change"===e)return Yn(t)}var ur="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function sr(e,t){if(ur(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!f.call(t,a)||!ur(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function fr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?fr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function hr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&fr(n.ownerDocument.documentElement,n)){if(null!==r&&hr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=lr(n,i);var o=lr(n,r);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=l&&"documentMode"in document&&11>=document.documentMode,gr=null,mr=null,yr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==X(r)||("selectionStart"in(r=gr)&&hr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&sr(yr,r)||(yr=r,0<(r=qr(mr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function kr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wr={animationend:kr("Animation","AnimationEnd"),animationiteration:kr("Animation","AnimationIteration"),animationstart:kr("Animation","AnimationStart"),transitionend:kr("Transition","TransitionEnd")},_r={},Cr={};function Sr(e){if(_r[e])return _r[e];if(!wr[e])return e;var t,n=wr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Cr)return _r[e]=n[t];return e}l&&(Cr=document.createElement("div").style,"AnimationEvent"in window||(delete wr.animationend.animation,delete wr.animationiteration.animation,delete wr.animationstart.animation),"TransitionEvent"in window||delete wr.transitionend.transition);var Ar=Sr("animationend"),Er=Sr("animationiteration"),Tr=Sr("animationstart"),Nr=Sr("transitionend"),Dr=new Map,Fr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ir(e,t){Dr.set(e,t),s(t,[e])}for(var Mr=0;Mr<Fr.length;Mr++){var Or=Fr[Mr];Ir(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}Ir(Ar,"onAnimationEnd"),Ir(Er,"onAnimationIteration"),Ir(Tr,"onAnimationStart"),Ir("dblclick","onDoubleClick"),Ir("focusin","onFocus"),Ir("focusout","onBlur"),Ir(Nr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rr));function Br(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,u,s,c){if(je.apply(this,arguments),Ze){if(!Ze)throw Error(i(198));var l=Be;Ze=!1,Be=null,ze||(ze=!0,Le=l)}}(r,t,void 0,e),e.currentTarget=null}function zr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var u=r[o],s=u.instance,c=u.currentTarget;if(u=u.listener,s!==i&&a.isPropagationStopped())break e;Br(a,u,c),i=s}else for(o=0;o<r.length;o++){if(s=(u=r[o]).instance,c=u.currentTarget,u=u.listener,s!==i&&a.isPropagationStopped())break e;Br(a,u,c),i=s}}}if(ze)throw e=Le,ze=!1,Le=null,e}function Lr(e,t){var n=t[va];void 0===n&&(n=t[va]=new Set);var r=e+"__bubble";n.has(r)||(Wr(t,e,2,!1),n.add(r))}function Pr(e,t,n){var r=0;t&&(r|=4),Wr(n,e,r,t)}var jr="_reactListening"+Math.random().toString(36).slice(2);function Ur(e){if(!e[jr]){e[jr]=!0,o.forEach((function(t){"selectionchange"!==t&&(Zr.has(t)||Pr(t,!1,e),Pr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[jr]||(t[jr]=!0,Pr("selectionchange",!1,t))}}function Wr(e,t,n,r){switch(Kt(t)){case 1:var a=Gt;break;case 4:a=qt;break;default:a=Ht}n=a.bind(null,t,n,e),a=void 0,!Me||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Vr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var u=r.stateNode.containerInfo;if(u===a||8===u.nodeType&&u.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var s=o.tag;if((3===s||4===s)&&((s=o.stateNode.containerInfo)===a||8===s.nodeType&&s.parentNode===a))return;o=o.return}for(;null!==u;){if(null===(o=ya(u)))return;if(5===(s=o.tag)||6===s){r=i=o;continue e}u=u.parentNode}}r=r.return}Fe((function(){var r=i,a=ke(n),o=[];e:{var u=Dr.get(e);if(void 0!==u){var s=ln,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":s=En;break;case"focusin":c="focus",s=gn;break;case"focusout":c="blur",s=gn;break;case"beforeblur":case"afterblur":s=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":s=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":s=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":s=Nn;break;case Ar:case Er:case Tr:s=mn;break;case Nr:s=Dn;break;case"scroll":s=dn;break;case"wheel":s=In;break;case"copy":case"cut":case"paste":s=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":s=Tn}var l=0!==(4&t),f=!l&&"scroll"===e,d=l?null!==u?u+"Capture":null:u;l=[];for(var h,p=r;null!==p;){var v=(h=p).stateNode;if(5===h.tag&&null!==v&&(h=v,null!==d&&(null!=(v=Ie(p,d))&&l.push(Gr(p,v,h)))),f)break;p=p.return}0<l.length&&(u=new s(u,c,null,n,a),o.push({event:u,listeners:l}))}}if(0===(7&t)){if(s="mouseout"===e||"pointerout"===e,(!(u="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!ya(c)&&!c[pa])&&(s||u)&&(u=a.window===a?a:(u=a.ownerDocument)?u.defaultView||u.parentWindow:window,s?(s=r,null!==(c=(c=n.relatedTarget||n.toElement)?ya(c):null)&&(c!==(f=Ue(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(s=null,c=r),s!==c)){if(l=pn,v="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(l=Tn,v="onPointerLeave",d="onPointerEnter",p="pointer"),f=null==s?u:xa(s),h=null==c?u:xa(c),(u=new l(v,p+"leave",s,n,a)).target=f,u.relatedTarget=h,v=null,ya(a)===r&&((l=new l(d,p+"enter",c,n,a)).target=h,l.relatedTarget=f,v=l),f=v,s&&c)e:{for(d=c,p=0,h=l=s;h;h=Hr(h))p++;for(h=0,v=d;v;v=Hr(v))h++;for(;0<p-h;)l=Hr(l),p--;for(;0<h-p;)d=Hr(d),h--;for(;p--;){if(l===d||null!==d&&l===d.alternate)break e;l=Hr(l),d=Hr(d)}l=null}else l=null;null!==s&&Xr(o,u,s,l,!1),null!==c&&null!==f&&Xr(o,f,c,l,!0)}if("select"===(s=(u=r?xa(r):window).nodeName&&u.nodeName.toLowerCase())||"input"===s&&"file"===u.type)var g=Kn;else if(Vn(u))if($n)g=or;else{g=ar;var m=rr}else(s=u.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===u.type||"radio"===u.type)&&(g=ir);switch(g&&(g=g(e,r))?Gn(o,g,n,a):(m&&m(e,u,r),"focusout"===e&&(m=u._wrapperState)&&m.controlled&&"number"===u.type&&ee(u,"number",u.value)),m=r?xa(r):window,e){case"focusin":(Vn(m)||"true"===m.contentEditable)&&(gr=m,mr=r,yr=null);break;case"focusout":yr=mr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(o,n,a);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":xr(o,n,a)}var y;if(On)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Un?Pn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Bn&&"ko"!==n.locale&&(Un||"onCompositionStart"!==b?"onCompositionEnd"===b&&Un&&(y=en()):(Qt="value"in($t=a)?$t.value:$t.textContent,Un=!0)),0<(m=qr(r,b)).length&&(b=new xn(b,e,null,n,a),o.push({event:b,listeners:m}),y?b.data=y:null!==(y=jn(n))&&(b.data=y))),(y=Zn?function(e,t){switch(e){case"compositionend":return jn(t);case"keypress":return 32!==t.which?null:(Ln=!0,zn);case"textInput":return(e=t.data)===zn&&Ln?null:e;default:return null}}(e,n):function(e,t){if(Un)return"compositionend"===e||!On&&Pn(e,t)?(e=en(),Jt=Qt=$t=null,Un=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=qr(r,"onBeforeInput")).length&&(a=new xn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=y))}zr(o,t)}))}function Gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Ie(e,n))&&r.unshift(Gr(e,i,a)),null!=(i=Ie(e,t))&&r.push(Gr(e,i,a))),e=e.return}return r}function Hr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var u=n,s=u.alternate,c=u.stateNode;if(null!==s&&s===r)break;5===u.tag&&null!==c&&(u=c,a?null!=(s=Ie(n,i))&&o.unshift(Gr(n,s,u)):a||null!=(s=Ie(n,i))&&o.push(Gr(n,s,u))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Yr=/\r\n?/g,Kr=/\u0000|\uFFFD/g;function $r(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Kr,"")}function Qr(e,t,n){if(t=$r(t),$r(e)!==t&&n)throw Error(i(425))}function Jr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(ua)}:ra;function ua(e){setTimeout((function(){throw e}))}function sa(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Ut(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Ut(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function la(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var fa=Math.random().toString(36).slice(2),da="__reactFiber$"+fa,ha="__reactProps$"+fa,pa="__reactContainer$"+fa,va="__reactEvents$"+fa,ga="__reactListeners$"+fa,ma="__reactHandles$"+fa;function ya(e){var t=e[da];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pa]||n[da]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=la(e);null!==e;){if(n=e[da])return n;e=la(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[da]||e[pa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function ka(e){return e[ha]||null}var wa=[],_a=-1;function Ca(e){return{current:e}}function Sa(e){0>_a||(e.current=wa[_a],wa[_a]=null,_a--)}function Aa(e,t){_a++,wa[_a]=e.current,e.current=t}var Ea={},Ta=Ca(Ea),Na=Ca(!1),Da=Ea;function Fa(e,t){var n=e.type.contextTypes;if(!n)return Ea;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Ia(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ma(){Sa(Na),Sa(Ta)}function Oa(e,t,n){if(Ta.current!==Ea)throw Error(i(168));Aa(Ta,t),Aa(Na,n)}function Ra(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,W(e)||"Unknown",a));return B({},n,r)}function Za(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ea,Da=Ta.current,Aa(Ta,e),Aa(Na,Na.current),!0}function Ba(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Ra(e,t,Da),r.__reactInternalMemoizedMergedChildContext=e,Sa(Na),Sa(Ta),Aa(Ta,e)):Sa(Na),Aa(Na,n)}var za=null,La=!1,Pa=!1;function ja(e){null===za?za=[e]:za.push(e)}function Ua(){if(!Pa&&null!==za){Pa=!0;var e=0,t=bt;try{var n=za;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}za=null,La=!1}catch(a){throw null!==za&&(za=za.slice(e+1)),He(Je,Ua),a}finally{bt=t,Pa=!1}}return null}var Wa=[],Va=0,Ga=null,qa=0,Ha=[],Xa=0,Ya=null,Ka=1,$a="";function Qa(e,t){Wa[Va++]=qa,Wa[Va++]=Ga,Ga=e,qa=t}function Ja(e,t,n){Ha[Xa++]=Ka,Ha[Xa++]=$a,Ha[Xa++]=Ya,Ya=e;var r=Ka;e=$a;var a=32-ot(r)-1;r&=~(1<<a),n+=1;var i=32-ot(t)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Ka=1<<32-ot(t)+a|n<<a|r,$a=i+e}else Ka=1<<i|n<<a|r,$a=e}function ei(e){null!==e.return&&(Qa(e,1),Ja(e,1,0))}function ti(e){for(;e===Ga;)Ga=Wa[--Va],Wa[Va]=null,qa=Wa[--Va],Wa[Va]=null;for(;e===Ya;)Ya=Ha[--Xa],Ha[Xa]=null,$a=Ha[--Xa],Ha[Xa]=null,Ka=Ha[--Xa],Ha[Xa]=null}var ni=null,ri=null,ai=!1,ii=null;function oi(e,t){var n=Fc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ui(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ya?{id:Ka,overflow:$a}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Fc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function si(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(ai){var t=ri;if(t){var n=t;if(!ui(e,t)){if(si(e))throw Error(i(418));t=ca(n.nextSibling);var r=ni;t&&ui(e,t)?oi(r,n):(e.flags=-4097&e.flags|2,ai=!1,ni=e)}}else{if(si(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ni=e}}}function li(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function fi(e){if(e!==ni)return!1;if(!ai)return li(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ri)){if(si(e))throw di(),Error(i(418));for(;t;)oi(e,t),t=ca(t.nextSibling)}if(li(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?ca(e.stateNode.nextSibling):null;return!0}function di(){for(var e=ri;e;)e=ca(e.nextSibling)}function hi(){ri=ni=null,ai=!1}function pi(e){null===ii?ii=[e]:ii.push(e)}var vi=x.ReactCurrentBatchConfig;function gi(e,t){if(e&&e.defaultProps){for(var n in t=B({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var mi=Ca(null),yi=null,bi=null,xi=null;function ki(){xi=bi=yi=null}function wi(e){var t=mi.current;Sa(mi),e._currentValue=t}function _i(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ci(e,t){yi=e,xi=bi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xu=!0),e.firstContext=null)}function Si(e){var t=e._currentValue;if(xi!==e)if(e={context:e,memoizedValue:t,next:null},null===bi){if(null===yi)throw Error(i(308));bi=e,yi.dependencies={lanes:0,firstContext:e}}else bi=bi.next=e;return t}var Ai=null;function Ei(e){null===Ai?Ai=[e]:Ai.push(e)}function Ti(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Ei(t)):(n.next=a.next,a.next=n),t.interleaved=n,Ni(e,r)}function Ni(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Di=!1;function Fi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ii(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Mi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Oi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Ts)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Ni(e,n)}return null===(a=r.interleaved)?(t.next=t,Ei(r)):(t.next=a.next,a.next=t),r.interleaved=t,Ni(e,n)}function Ri(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Zi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Bi(e,t,n,r){var a=e.updateQueue;Di=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,u=a.shared.pending;if(null!==u){a.shared.pending=null;var s=u,c=s.next;s.next=null,null===o?i=c:o.next=c,o=s;var l=e.alternate;null!==l&&((u=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===u?l.firstBaseUpdate=c:u.next=c,l.lastBaseUpdate=s))}if(null!==i){var f=a.baseState;for(o=0,l=c=s=null,u=i;;){var d=u.lane,h=u.eventTime;if((r&d)===d){null!==l&&(l=l.next={eventTime:h,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var p=e,v=u;switch(d=t,h=n,v.tag){case 1:if("function"===typeof(p=v.payload)){f=p.call(h,f,d);break e}f=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=v.payload)?p.call(h,f,d):p)||void 0===d)break e;f=B({},f,d);break e;case 2:Di=!0}}null!==u.callback&&0!==u.lane&&(e.flags|=64,null===(d=a.effects)?a.effects=[u]:d.push(u))}else h={eventTime:h,lane:d,tag:u.tag,payload:u.payload,callback:u.callback,next:null},null===l?(c=l=h,s=f):l=l.next=h,o|=d;if(null===(u=u.next)){if(null===(u=a.shared.pending))break;u=(d=u).next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}if(null===l&&(s=f),a.baseState=s,a.firstBaseUpdate=c,a.lastBaseUpdate=l,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Zs|=o,e.lanes=o,e.memoizedState=f}}function zi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Li=(new r.Component).refs;function Pi(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:B({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ji={isMounted:function(e){return!!(e=e._reactInternals)&&Ue(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),i=Mi(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Oi(e,i,a))&&(nc(t,e,a,r),Ri(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),i=Mi(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Oi(e,i,a))&&(nc(t,e,a,r),Ri(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),a=Mi(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Oi(e,a,r))&&(nc(t,e,r,n),Ri(t,e,r))}};function Ui(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!sr(n,r)||!sr(a,i))}function Wi(e,t,n){var r=!1,a=Ea,i=t.contextType;return"object"===typeof i&&null!==i?i=Si(i):(a=Ia(t)?Da:Ta.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Fa(e,a):Ea),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ji,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Vi(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ji.enqueueReplaceState(t,t.state,null)}function Gi(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=Li,Fi(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Si(i):(i=Ia(t)?Da:Ta.current,a.context=Fa(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(Pi(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&ji.enqueueReplaceState(a,a.state,null),Bi(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function qi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;t===Li&&(t=a.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function Hi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Xi(e){return(0,e._init)(e._payload)}function Yi(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Mc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function u(t){return e&&null===t.alternate&&(t.flags|=2),t}function s(e,t,n,r){return null===t||6!==t.tag?((t=Bc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===_?f(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===I&&Xi(i)===t.type)?((r=a(t,n.props)).ref=qi(e,t,n),r.return=e,r):((r=Oc(n.type,n.key,n.props,null,e.mode,r)).ref=qi(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=zc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function f(e,t,n,r,i){return null===t||7!==t.tag?((t=Rc(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Bc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case k:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=qi(e,null,t),n.return=e,n;case w:return(t=zc(t,e.mode,n)).return=e,t;case I:return d(e,(0,t._init)(t._payload),n)}if(te(t)||R(t))return(t=Rc(t,e.mode,n,null)).return=e,t;Hi(e,t)}return null}function h(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:s(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===a?c(e,t,n,r):null;case w:return n.key===a?l(e,t,n,r):null;case I:return h(e,t,(a=n._init)(n._payload),r)}if(te(n)||R(n))return null!==a?null:f(e,t,n,r,null);Hi(e,n)}return null}function p(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return s(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case k:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case w:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a);case I:return p(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||R(r))return f(t,e=e.get(n)||null,r,a,null);Hi(t,r)}return null}function v(a,i,u,s){for(var c=null,l=null,f=i,v=i=0,g=null;null!==f&&v<u.length;v++){f.index>v?(g=f,f=null):g=f.sibling;var m=h(a,f,u[v],s);if(null===m){null===f&&(f=g);break}e&&f&&null===m.alternate&&t(a,f),i=o(m,i,v),null===l?c=m:l.sibling=m,l=m,f=g}if(v===u.length)return n(a,f),ai&&Qa(a,v),c;if(null===f){for(;v<u.length;v++)null!==(f=d(a,u[v],s))&&(i=o(f,i,v),null===l?c=f:l.sibling=f,l=f);return ai&&Qa(a,v),c}for(f=r(a,f);v<u.length;v++)null!==(g=p(f,a,v,u[v],s))&&(e&&null!==g.alternate&&f.delete(null===g.key?v:g.key),i=o(g,i,v),null===l?c=g:l.sibling=g,l=g);return e&&f.forEach((function(e){return t(a,e)})),ai&&Qa(a,v),c}function g(a,u,s,c){var l=R(s);if("function"!==typeof l)throw Error(i(150));if(null==(s=l.call(s)))throw Error(i(151));for(var f=l=null,v=u,g=u=0,m=null,y=s.next();null!==v&&!y.done;g++,y=s.next()){v.index>g?(m=v,v=null):m=v.sibling;var b=h(a,v,y.value,c);if(null===b){null===v&&(v=m);break}e&&v&&null===b.alternate&&t(a,v),u=o(b,u,g),null===f?l=b:f.sibling=b,f=b,v=m}if(y.done)return n(a,v),ai&&Qa(a,g),l;if(null===v){for(;!y.done;g++,y=s.next())null!==(y=d(a,y.value,c))&&(u=o(y,u,g),null===f?l=y:f.sibling=y,f=y);return ai&&Qa(a,g),l}for(v=r(a,v);!y.done;g++,y=s.next())null!==(y=p(v,a,g,y.value,c))&&(e&&null!==y.alternate&&v.delete(null===y.key?g:y.key),u=o(y,u,g),null===f?l=y:f.sibling=y,f=y);return e&&v.forEach((function(e){return t(a,e)})),ai&&Qa(a,g),l}return function e(r,i,o,s){if("object"===typeof o&&null!==o&&o.type===_&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case k:e:{for(var c=o.key,l=i;null!==l;){if(l.key===c){if((c=o.type)===_){if(7===l.tag){n(r,l.sibling),(i=a(l,o.props.children)).return=r,r=i;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===I&&Xi(c)===l.type){n(r,l.sibling),(i=a(l,o.props)).ref=qi(r,l,o),i.return=r,r=i;break e}n(r,l);break}t(r,l),l=l.sibling}o.type===_?((i=Rc(o.props.children,r.mode,s,o.key)).return=r,r=i):((s=Oc(o.type,o.key,o.props,null,r.mode,s)).ref=qi(r,i,o),s.return=r,r=s)}return u(r);case w:e:{for(l=o.key;null!==i;){if(i.key===l){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(r,i.sibling),(i=a(i,o.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=zc(o,r.mode,s)).return=r,r=i}return u(r);case I:return e(r,i,(l=o._init)(o._payload),s)}if(te(o))return v(r,i,o,s);if(R(o))return g(r,i,o,s);Hi(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,o)).return=r,r=i):(n(r,i),(i=Bc(o,r.mode,s)).return=r,r=i),u(r)):n(r,i)}}var Ki=Yi(!0),$i=Yi(!1),Qi={},Ji=Ca(Qi),eo=Ca(Qi),to=Ca(Qi);function no(e){if(e===Qi)throw Error(i(174));return e}function ro(e,t){switch(Aa(to,t),Aa(eo,e),Aa(Ji,Qi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:se(null,"");break;default:t=se(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Sa(Ji),Aa(Ji,t)}function ao(){Sa(Ji),Sa(eo),Sa(to)}function io(e){no(to.current);var t=no(Ji.current),n=se(t,e.type);t!==n&&(Aa(eo,e),Aa(Ji,n))}function oo(e){eo.current===e&&(Sa(Ji),Sa(eo))}var uo=Ca(0);function so(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var co=[];function lo(){for(var e=0;e<co.length;e++)co[e]._workInProgressVersionPrimary=null;co.length=0}var fo=x.ReactCurrentDispatcher,ho=x.ReactCurrentBatchConfig,po=0,vo=null,go=null,mo=null,yo=!1,bo=!1,xo=0,ko=0;function wo(){throw Error(i(321))}function _o(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ur(e[n],t[n]))return!1;return!0}function Co(e,t,n,r,a,o){if(po=o,vo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fo.current=null===e||null===e.memoizedState?uu:su,e=n(r,a),bo){o=0;do{if(bo=!1,xo=0,25<=o)throw Error(i(301));o+=1,mo=go=null,t.updateQueue=null,fo.current=cu,e=n(r,a)}while(bo)}if(fo.current=ou,t=null!==go&&null!==go.next,po=0,mo=go=vo=null,yo=!1,t)throw Error(i(300));return e}function So(){var e=0!==xo;return xo=0,e}function Ao(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===mo?vo.memoizedState=mo=e:mo=mo.next=e,mo}function Eo(){if(null===go){var e=vo.alternate;e=null!==e?e.memoizedState:null}else e=go.next;var t=null===mo?vo.memoizedState:mo.next;if(null!==t)mo=t,go=e;else{if(null===e)throw Error(i(310));e={memoizedState:(go=e).memoizedState,baseState:go.baseState,baseQueue:go.baseQueue,queue:go.queue,next:null},null===mo?vo.memoizedState=mo=e:mo=mo.next=e}return mo}function To(e,t){return"function"===typeof t?t(e):t}function No(e){var t=Eo(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=go,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var u=a.next;a.next=o.next,o.next=u}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var s=u=null,c=null,l=o;do{var f=l.lane;if((po&f)===f)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var d={lane:f,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(s=c=d,u=r):c=c.next=d,vo.lanes|=f,Zs|=f}l=l.next}while(null!==l&&l!==o);null===c?u=r:c.next=s,ur(r,t.memoizedState)||(xu=!0),t.memoizedState=r,t.baseState=u,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{o=a.lane,vo.lanes|=o,Zs|=o,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Do(e){var t=Eo(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var u=a=a.next;do{o=e(o,u.action),u=u.next}while(u!==a);ur(o,t.memoizedState)||(xu=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Fo(){}function Io(e,t){var n=vo,r=Eo(),a=t(),o=!ur(r.memoizedState,a);if(o&&(r.memoizedState=a,xu=!0),r=r.queue,Vo(Ro.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==mo&&1&mo.memoizedState.tag){if(n.flags|=2048,Lo(9,Oo.bind(null,n,r,a,t),void 0,null),null===Ns)throw Error(i(349));0!==(30&po)||Mo(n,t,a)}return a}function Mo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Oo(e,t,n,r){t.value=n,t.getSnapshot=r,Zo(t)&&Bo(e)}function Ro(e,t,n){return n((function(){Zo(t)&&Bo(e)}))}function Zo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ur(e,n)}catch(r){return!0}}function Bo(e){var t=Ni(e,1);null!==t&&nc(t,e,1,-1)}function zo(e){var t=Ao();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:To,lastRenderedState:e},t.queue=e,e=e.dispatch=nu.bind(null,vo,e),[t.memoizedState,e]}function Lo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Po(){return Eo().memoizedState}function jo(e,t,n,r){var a=Ao();vo.flags|=e,a.memoizedState=Lo(1|t,n,void 0,void 0===r?null:r)}function Uo(e,t,n,r){var a=Eo();r=void 0===r?null:r;var i=void 0;if(null!==go){var o=go.memoizedState;if(i=o.destroy,null!==r&&_o(r,o.deps))return void(a.memoizedState=Lo(t,n,i,r))}vo.flags|=e,a.memoizedState=Lo(1|t,n,i,r)}function Wo(e,t){return jo(8390656,8,e,t)}function Vo(e,t){return Uo(2048,8,e,t)}function Go(e,t){return Uo(4,2,e,t)}function qo(e,t){return Uo(4,4,e,t)}function Ho(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Xo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Uo(4,4,Ho.bind(null,t,e),n)}function Yo(){}function Ko(e,t){var n=Eo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&_o(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function $o(e,t){var n=Eo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&_o(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Qo(e,t,n){return 0===(21&po)?(e.baseState&&(e.baseState=!1,xu=!0),e.memoizedState=n):(ur(n,t)||(n=vt(),vo.lanes|=n,Zs|=n,e.baseState=!0),t)}function Jo(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=ho.transition;ho.transition={};try{e(!1),t()}finally{bt=n,ho.transition=r}}function eu(){return Eo().memoizedState}function tu(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ru(e))au(t,n);else if(null!==(n=Ti(e,t,n,r))){nc(n,e,r,ec()),iu(n,t,r)}}function nu(e,t,n){var r=tc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ru(e))au(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,u=i(o,n);if(a.hasEagerState=!0,a.eagerState=u,ur(u,o)){var s=t.interleaved;return null===s?(a.next=a,Ei(t)):(a.next=s.next,s.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Ti(e,t,a,r))&&(nc(n,e,r,a=ec()),iu(n,t,r))}}function ru(e){var t=e.alternate;return e===vo||null!==t&&t===vo}function au(e,t){bo=yo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function iu(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var ou={readContext:Si,useCallback:wo,useContext:wo,useEffect:wo,useImperativeHandle:wo,useInsertionEffect:wo,useLayoutEffect:wo,useMemo:wo,useReducer:wo,useRef:wo,useState:wo,useDebugValue:wo,useDeferredValue:wo,useTransition:wo,useMutableSource:wo,useSyncExternalStore:wo,useId:wo,unstable_isNewReconciler:!1},uu={readContext:Si,useCallback:function(e,t){return Ao().memoizedState=[e,void 0===t?null:t],e},useContext:Si,useEffect:Wo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,jo(4194308,4,Ho.bind(null,t,e),n)},useLayoutEffect:function(e,t){return jo(4194308,4,e,t)},useInsertionEffect:function(e,t){return jo(4,2,e,t)},useMemo:function(e,t){var n=Ao();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Ao();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=tu.bind(null,vo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Ao().memoizedState=e},useState:zo,useDebugValue:Yo,useDeferredValue:function(e){return Ao().memoizedState=e},useTransition:function(){var e=zo(!1),t=e[0];return e=Jo.bind(null,e[1]),Ao().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=vo,a=Ao();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Ns)throw Error(i(349));0!==(30&po)||Mo(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,Wo(Ro.bind(null,r,o,e),[e]),r.flags|=2048,Lo(9,Oo.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Ao(),t=Ns.identifierPrefix;if(ai){var n=$a;t=":"+t+"R"+(n=(Ka&~(1<<32-ot(Ka)-1)).toString(32)+n),0<(n=xo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ko++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},su={readContext:Si,useCallback:Ko,useContext:Si,useEffect:Vo,useImperativeHandle:Xo,useInsertionEffect:Go,useLayoutEffect:qo,useMemo:$o,useReducer:No,useRef:Po,useState:function(){return No(To)},useDebugValue:Yo,useDeferredValue:function(e){return Qo(Eo(),go.memoizedState,e)},useTransition:function(){return[No(To)[0],Eo().memoizedState]},useMutableSource:Fo,useSyncExternalStore:Io,useId:eu,unstable_isNewReconciler:!1},cu={readContext:Si,useCallback:Ko,useContext:Si,useEffect:Vo,useImperativeHandle:Xo,useInsertionEffect:Go,useLayoutEffect:qo,useMemo:$o,useReducer:Do,useRef:Po,useState:function(){return Do(To)},useDebugValue:Yo,useDeferredValue:function(e){var t=Eo();return null===go?t.memoizedState=e:Qo(t,go.memoizedState,e)},useTransition:function(){return[Do(To)[0],Eo().memoizedState]},useMutableSource:Fo,useSyncExternalStore:Io,useId:eu,unstable_isNewReconciler:!1};function lu(e,t){try{var n="",r=t;do{n+=j(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function fu(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function du(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var hu="function"===typeof WeakMap?WeakMap:Map;function pu(e,t,n){(n=Mi(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Vs||(Vs=!0,Gs=r),du(0,t)},n}function vu(e,t,n){(n=Mi(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){du(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){du(0,t),"function"!==typeof r&&(null===qs?qs=new Set([this]):qs.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function gu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hu;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Sc.bind(null,e,t,n),t.then(e,e))}function mu(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function yu(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Mi(-1,1)).tag=2,Oi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var bu=x.ReactCurrentOwner,xu=!1;function ku(e,t,n,r){t.child=null===e?$i(t,null,n,r):Ki(t,e.child,n,r)}function wu(e,t,n,r,a){n=n.render;var i=t.ref;return Ci(t,a),r=Co(e,t,n,r,i,a),n=So(),null===e||xu?(ai&&n&&ei(t),t.flags|=1,ku(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Vu(e,t,a))}function _u(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Ic(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Cu(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:sr)(o,r)&&e.ref===t.ref)return Vu(e,t,a)}return t.flags|=1,(e=Mc(i,r)).ref=t.ref,e.return=t,t.child=e}function Cu(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(sr(i,r)&&e.ref===t.ref){if(xu=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Vu(e,t,a);0!==(131072&e.flags)&&(xu=!0)}}return Eu(e,t,n,r,a)}function Su(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Aa(Ms,Is),Is|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Aa(Ms,Is),Is|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Aa(Ms,Is),Is|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Aa(Ms,Is),Is|=r;return ku(e,t,a,n),t.child}function Au(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Eu(e,t,n,r,a){var i=Ia(n)?Da:Ta.current;return i=Fa(t,i),Ci(t,a),n=Co(e,t,n,r,i,a),r=So(),null===e||xu?(ai&&r&&ei(t),t.flags|=1,ku(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Vu(e,t,a))}function Tu(e,t,n,r,a){if(Ia(n)){var i=!0;Za(t)}else i=!1;if(Ci(t,a),null===t.stateNode)Wu(e,t),Wi(t,n,r),Gi(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,u=t.memoizedProps;o.props=u;var s=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Si(c):c=Fa(t,c=Ia(n)?Da:Ta.current);var l=n.getDerivedStateFromProps,f="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;f||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(u!==r||s!==c)&&Vi(t,o,r,c),Di=!1;var d=t.memoizedState;o.state=d,Bi(t,r,o,a),s=t.memoizedState,u!==r||d!==s||Na.current||Di?("function"===typeof l&&(Pi(t,n,l,r),s=t.memoizedState),(u=Di||Ui(t,n,u,r,d,s,c))?(f||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=s),o.props=r,o.state=s,o.context=c,r=u):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Ii(e,t),u=t.memoizedProps,c=t.type===t.elementType?u:gi(t.type,u),o.props=c,f=t.pendingProps,d=o.context,"object"===typeof(s=n.contextType)&&null!==s?s=Si(s):s=Fa(t,s=Ia(n)?Da:Ta.current);var h=n.getDerivedStateFromProps;(l="function"===typeof h||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(u!==f||d!==s)&&Vi(t,o,r,s),Di=!1,d=t.memoizedState,o.state=d,Bi(t,r,o,a);var p=t.memoizedState;u!==f||d!==p||Na.current||Di?("function"===typeof h&&(Pi(t,n,h,r),p=t.memoizedState),(c=Di||Ui(t,n,c,r,d,p,s)||!1)?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,s),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,s)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||u===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||u===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=s,r=c):("function"!==typeof o.componentDidUpdate||u===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||u===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Nu(e,t,n,r,i,a)}function Nu(e,t,n,r,a,i){Au(e,t);var o=0!==(128&t.flags);if(!r&&!o)return a&&Ba(t,n,!1),Vu(e,t,i);r=t.stateNode,bu.current=t;var u=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Ki(t,e.child,null,i),t.child=Ki(t,null,u,i)):ku(e,t,u,i),t.memoizedState=r.state,a&&Ba(t,n,!0),t.child}function Du(e){var t=e.stateNode;t.pendingContext?Oa(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oa(0,t.context,!1),ro(e,t.containerInfo)}function Fu(e,t,n,r,a){return hi(),pi(a),t.flags|=256,ku(e,t,n,r),t.child}var Iu,Mu,Ou,Ru={dehydrated:null,treeContext:null,retryLane:0};function Zu(e){return{baseLanes:e,cachePool:null,transitions:null}}function Bu(e,t,n){var r,a=t.pendingProps,o=uo.current,u=!1,s=0!==(128&t.flags);if((r=s)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(u=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Aa(uo,1&o),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(s=a.children,e=a.fallback,u?(a=t.mode,u=t.child,s={mode:"hidden",children:s},0===(1&a)&&null!==u?(u.childLanes=0,u.pendingProps=s):u=Zc(s,a,0,null),e=Rc(e,a,n,null),u.return=t,e.return=t,u.sibling=e,t.child=u,t.child.memoizedState=Zu(n),t.memoizedState=Ru,e):zu(t,s));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,a,o,u){if(n)return 256&t.flags?(t.flags&=-257,Lu(e,t,u,r=fu(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,a=t.mode,r=Zc({mode:"visible",children:r.children},a,0,null),(o=Rc(o,a,u,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Ki(t,e.child,null,u),t.child.memoizedState=Zu(u),t.memoizedState=Ru,o);if(0===(1&t.mode))return Lu(e,t,u,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var s=r.dgst;return r=s,Lu(e,t,u,r=fu(o=Error(i(419)),r,void 0))}if(s=0!==(u&e.childLanes),xu||s){if(null!==(r=Ns)){switch(u&-u){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|u))?0:a)&&a!==o.retryLane&&(o.retryLane=a,Ni(e,a),nc(r,e,a,-1))}return vc(),Lu(e,t,u,r=fu(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,ri=ca(a.nextSibling),ni=t,ai=!0,ii=null,null!==e&&(Ha[Xa++]=Ka,Ha[Xa++]=$a,Ha[Xa++]=Ya,Ka=e.id,$a=e.overflow,Ya=t),t=zu(t,r.children),t.flags|=4096,t)}(e,t,s,a,r,o,n);if(u){u=a.fallback,s=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&s)&&t.child!==o?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Mc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?u=Mc(r,u):(u=Rc(u,s,n,null)).flags|=2,u.return=t,a.return=t,a.sibling=u,t.child=a,a=u,u=t.child,s=null===(s=e.child.memoizedState)?Zu(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},u.memoizedState=s,u.childLanes=e.childLanes&~n,t.memoizedState=Ru,a}return e=(u=e.child).sibling,a=Mc(u,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function zu(e,t){return(t=Zc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Lu(e,t,n,r){return null!==r&&pi(r),Ki(t,e.child,null,n),(e=zu(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Pu(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),_i(e.return,t,n)}function ju(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Uu(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(ku(e,t,r.children,n),0!==(2&(r=uo.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Pu(e,n,t);else if(19===e.tag)Pu(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Aa(uo,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===so(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),ju(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===so(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}ju(t,!0,n,null,i);break;case"together":ju(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Wu(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Vu(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Zs|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Mc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Mc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Gu(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qu(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Hu(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qu(t),null;case 1:case 17:return Ia(t.type)&&Ma(),qu(t),null;case 3:return r=t.stateNode,ao(),Sa(Na),Sa(Ta),lo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(fi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(oc(ii),ii=null))),qu(t),null;case 5:oo(t);var a=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)Mu(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return qu(t),null}if(e=no(Ji.current),fi(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[da]=t,r[ha]=o,e=0!==(1&t.mode),n){case"dialog":Lr("cancel",r),Lr("close",r);break;case"iframe":case"object":case"embed":Lr("load",r);break;case"video":case"audio":for(a=0;a<Rr.length;a++)Lr(Rr[a],r);break;case"source":Lr("error",r);break;case"img":case"image":case"link":Lr("error",r),Lr("load",r);break;case"details":Lr("toggle",r);break;case"input":K(r,o),Lr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Lr("invalid",r);break;case"textarea":ae(r,o),Lr("invalid",r)}for(var s in ye(n,o),a=null,o)if(o.hasOwnProperty(s)){var c=o[s];"children"===s?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Qr(r.textContent,c,e),a=["children",""+c]):u.hasOwnProperty(s)&&null!=c&&"onScroll"===s&&Lr("scroll",r)}switch(n){case"input":q(r),J(r,o,!0);break;case"textarea":q(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Jr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{s=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ue(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=s.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),"select"===n&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[da]=t,e[ha]=r,Iu(e,t),t.stateNode=e;e:{switch(s=be(n,r),n){case"dialog":Lr("cancel",e),Lr("close",e),a=r;break;case"iframe":case"object":case"embed":Lr("load",e),a=r;break;case"video":case"audio":for(a=0;a<Rr.length;a++)Lr(Rr[a],e);a=r;break;case"source":Lr("error",e),a=r;break;case"img":case"image":case"link":Lr("error",e),Lr("load",e),a=r;break;case"details":Lr("toggle",e),a=r;break;case"input":K(e,r),a=Y(e,r),Lr("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=B({},r,{value:void 0}),Lr("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Lr("invalid",e)}for(o in ye(n,a),c=a)if(c.hasOwnProperty(o)){var l=c[o];"style"===o?ge(e,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&fe(e,l):"children"===o?"string"===typeof l?("textarea"!==n||""!==l)&&de(e,l):"number"===typeof l&&de(e,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(u.hasOwnProperty(o)?null!=l&&"onScroll"===o&&Lr("scroll",e):null!=l&&b(e,o,l,s))}switch(n){case"input":q(e),J(e,r,!1);break;case"textarea":q(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+V(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Jr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qu(t),null;case 6:if(e&&null!=t.stateNode)Ou(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=no(to.current),no(Ji.current),fi(t)){if(r=t.stateNode,n=t.memoizedProps,r[da]=t,(o=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:Qr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Qr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[da]=t,t.stateNode=r}return qu(t),null;case 13:if(Sa(uo),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))di(),hi(),t.flags|=98560,o=!1;else if(o=fi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(i(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(i(317));o[da]=t}else hi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qu(t),o=!1}else null!==ii&&(oc(ii),ii=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&uo.current)?0===Os&&(Os=3):vc())),null!==t.updateQueue&&(t.flags|=4),qu(t),null);case 4:return ao(),null===e&&Ur(t.stateNode.containerInfo),qu(t),null;case 10:return wi(t.type._context),qu(t),null;case 19:if(Sa(uo),null===(o=t.memoizedState))return qu(t),null;if(r=0!==(128&t.flags),null===(s=o.rendering))if(r)Gu(o,!1);else{if(0!==Os||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=so(e))){for(t.flags|=128,Gu(o,!1),null!==(r=s.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(s=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Aa(uo,1&uo.current|2),t.child}e=e.sibling}null!==o.tail&&$e()>Us&&(t.flags|=128,r=!0,Gu(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=so(s))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Gu(o,!0),null===o.tail&&"hidden"===o.tailMode&&!s.alternate&&!ai)return qu(t),null}else 2*$e()-o.renderingStartTime>Us&&1073741824!==n&&(t.flags|=128,r=!0,Gu(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(null!==(n=o.last)?n.sibling=s:t.child=s,o.last=s)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=$e(),t.sibling=null,n=uo.current,Aa(uo,r?1&n|2:1&n),t):(qu(t),null);case 22:case 23:return fc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Is)&&(qu(t),6&t.subtreeFlags&&(t.flags|=8192)):qu(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Xu(e,t){switch(ti(t),t.tag){case 1:return Ia(t.type)&&Ma(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ao(),Sa(Na),Sa(Ta),lo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(Sa(uo),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));hi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Sa(uo),null;case 4:return ao(),null;case 10:return wi(t.type._context),null;case 22:case 23:return fc(),null;default:return null}}Iu=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Mu=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,no(Ji.current);var i,o=null;switch(n){case"input":a=Y(e,a),r=Y(e,r),o=[];break;case"select":a=B({},a,{value:void 0}),r=B({},r,{value:void 0}),o=[];break;case"textarea":a=re(e,a),r=re(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Jr)}for(l in ye(n,r),n=null,a)if(!r.hasOwnProperty(l)&&a.hasOwnProperty(l)&&null!=a[l])if("style"===l){var s=a[l];for(i in s)s.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(u.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(s=null!=a?a[l]:void 0,r.hasOwnProperty(l)&&c!==s&&(null!=c||null!=s))if("style"===l)if(s){for(i in s)!s.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&s[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(l,n)),n=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,s=s?s.__html:void 0,null!=c&&s!==c&&(o=o||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(u.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&Lr("scroll",e),o||s===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}},Ou=function(e,t,n,r){n!==r&&(t.flags|=4)};var Yu=!1,Ku=!1,$u="function"===typeof WeakSet?WeakSet:Set,Qu=null;function Ju(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Cc(e,t,r)}else n.current=null}function es(e,t,n){try{n()}catch(r){Cc(e,t,r)}}var ts=!1;function ns(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&es(t,n,i)}a=a.next}while(a!==r)}}function rs(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function as(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function is(e){var t=e.alternate;null!==t&&(e.alternate=null,is(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[da],delete t[ha],delete t[va],delete t[ga],delete t[ma])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function os(e){return 5===e.tag||3===e.tag||4===e.tag}function us(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||os(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ss(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Jr));else if(4!==r&&null!==(e=e.child))for(ss(e,t,n),e=e.sibling;null!==e;)ss(e,t,n),e=e.sibling}function cs(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cs(e,t,n),e=e.sibling;null!==e;)cs(e,t,n),e=e.sibling}var ls=null,fs=!1;function ds(e,t,n){for(n=n.child;null!==n;)hs(e,t,n),n=n.sibling}function hs(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(u){}switch(n.tag){case 5:Ku||Ju(n,t);case 6:var r=ls,a=fs;ls=null,ds(e,t,n),fs=a,null!==(ls=r)&&(fs?(e=ls,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ls.removeChild(n.stateNode));break;case 18:null!==ls&&(fs?(e=ls,n=n.stateNode,8===e.nodeType?sa(e.parentNode,n):1===e.nodeType&&sa(e,n),Ut(e)):sa(ls,n.stateNode));break;case 4:r=ls,a=fs,ls=n.stateNode.containerInfo,fs=!0,ds(e,t,n),ls=r,fs=a;break;case 0:case 11:case 14:case 15:if(!Ku&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&es(n,t,o),a=a.next}while(a!==r)}ds(e,t,n);break;case 1:if(!Ku&&(Ju(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){Cc(n,t,u)}ds(e,t,n);break;case 21:ds(e,t,n);break;case 22:1&n.mode?(Ku=(r=Ku)||null!==n.memoizedState,ds(e,t,n),Ku=r):ds(e,t,n);break;default:ds(e,t,n)}}function ps(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new $u),t.forEach((function(t){var r=Tc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function vs(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,u=t,s=u;e:for(;null!==s;){switch(s.tag){case 5:ls=s.stateNode,fs=!1;break e;case 3:case 4:ls=s.stateNode.containerInfo,fs=!0;break e}s=s.return}if(null===ls)throw Error(i(160));hs(o,u,a),ls=null,fs=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(l){Cc(a,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gs(t,e),t=t.sibling}function gs(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vs(t,e),ms(e),4&r){try{ns(3,e,e.return),rs(3,e)}catch(g){Cc(e,e.return,g)}try{ns(5,e,e.return)}catch(g){Cc(e,e.return,g)}}break;case 1:vs(t,e),ms(e),512&r&&null!==n&&Ju(n,n.return);break;case 5:if(vs(t,e),ms(e),512&r&&null!==n&&Ju(n,n.return),32&e.flags){var a=e.stateNode;try{de(a,"")}catch(g){Cc(e,e.return,g)}}if(4&r&&null!=(a=e.stateNode)){var o=e.memoizedProps,u=null!==n?n.memoizedProps:o,s=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===s&&"radio"===o.type&&null!=o.name&&$(a,o),be(s,u);var l=be(s,o);for(u=0;u<c.length;u+=2){var f=c[u],d=c[u+1];"style"===f?ge(a,d):"dangerouslySetInnerHTML"===f?fe(a,d):"children"===f?de(a,d):b(a,f,d,l)}switch(s){case"input":Q(a,o);break;case"textarea":ie(a,o);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(a,!!o.multiple,p,!1):h!==!!o.multiple&&(null!=o.defaultValue?ne(a,!!o.multiple,o.defaultValue,!0):ne(a,!!o.multiple,o.multiple?[]:"",!1))}a[ha]=o}catch(g){Cc(e,e.return,g)}}break;case 6:if(vs(t,e),ms(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(g){Cc(e,e.return,g)}}break;case 3:if(vs(t,e),ms(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Ut(t.containerInfo)}catch(g){Cc(e,e.return,g)}break;case 4:default:vs(t,e),ms(e);break;case 13:vs(t,e),ms(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(js=$e())),4&r&&ps(e);break;case 22:if(f=null!==n&&null!==n.memoizedState,1&e.mode?(Ku=(l=Ku)||f,vs(t,e),Ku=l):vs(t,e),ms(e),8192&r){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!f&&0!==(1&e.mode))for(Qu=e,f=e.child;null!==f;){for(d=Qu=f;null!==Qu;){switch(p=(h=Qu).child,h.tag){case 0:case 11:case 14:case 15:ns(4,h,h.return);break;case 1:Ju(h,h.return);var v=h.stateNode;if("function"===typeof v.componentWillUnmount){r=h,n=h.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){Cc(r,n,g)}}break;case 5:Ju(h,h.return);break;case 22:if(null!==h.memoizedState){ks(d);continue}}null!==p?(p.return=h,Qu=p):ks(d)}f=f.sibling}e:for(f=null,d=e;;){if(5===d.tag){if(null===f){f=d;try{a=d.stateNode,l?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(s=d.stateNode,u=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,s.style.display=ve("display",u))}catch(g){Cc(e,e.return,g)}}}else if(6===d.tag){if(null===f)try{d.stateNode.nodeValue=l?"":d.memoizedProps}catch(g){Cc(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:vs(t,e),ms(e),4&r&&ps(e);case 21:}}function ms(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(os(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(de(a,""),r.flags&=-33),cs(e,us(e),a);break;case 3:case 4:var o=r.stateNode.containerInfo;ss(e,us(e),o);break;default:throw Error(i(161))}}catch(u){Cc(e,e.return,u)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function ys(e,t,n){Qu=e,bs(e,t,n)}function bs(e,t,n){for(var r=0!==(1&e.mode);null!==Qu;){var a=Qu,i=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||Yu;if(!o){var u=a.alternate,s=null!==u&&null!==u.memoizedState||Ku;u=Yu;var c=Ku;if(Yu=o,(Ku=s)&&!c)for(Qu=a;null!==Qu;)s=(o=Qu).child,22===o.tag&&null!==o.memoizedState?ws(a):null!==s?(s.return=o,Qu=s):ws(a);for(;null!==i;)Qu=i,bs(i,t,n),i=i.sibling;Qu=a,Yu=u,Ku=c}xs(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Qu=i):xs(e)}}function xs(e){for(;null!==Qu;){var t=Qu;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ku||rs(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ku)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:gi(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&zi(t,o,r);break;case 3:var u=t.updateQueue;if(null!==u){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}zi(t,u,n)}break;case 5:var s=t.stateNode;if(null===n&&4&t.flags){n=s;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var f=l.memoizedState;if(null!==f){var d=f.dehydrated;null!==d&&Ut(d)}}}break;default:throw Error(i(163))}Ku||512&t.flags&&as(t)}catch(h){Cc(t,t.return,h)}}if(t===e){Qu=null;break}if(null!==(n=t.sibling)){n.return=t.return,Qu=n;break}Qu=t.return}}function ks(e){for(;null!==Qu;){var t=Qu;if(t===e){Qu=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Qu=n;break}Qu=t.return}}function ws(e){for(;null!==Qu;){var t=Qu;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rs(4,t)}catch(s){Cc(t,n,s)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(s){Cc(t,a,s)}}var i=t.return;try{as(t)}catch(s){Cc(t,i,s)}break;case 5:var o=t.return;try{as(t)}catch(s){Cc(t,o,s)}}}catch(s){Cc(t,t.return,s)}if(t===e){Qu=null;break}var u=t.sibling;if(null!==u){u.return=t.return,Qu=u;break}Qu=t.return}}var _s,Cs=Math.ceil,Ss=x.ReactCurrentDispatcher,As=x.ReactCurrentOwner,Es=x.ReactCurrentBatchConfig,Ts=0,Ns=null,Ds=null,Fs=0,Is=0,Ms=Ca(0),Os=0,Rs=null,Zs=0,Bs=0,zs=0,Ls=null,Ps=null,js=0,Us=1/0,Ws=null,Vs=!1,Gs=null,qs=null,Hs=!1,Xs=null,Ys=0,Ks=0,$s=null,Qs=-1,Js=0;function ec(){return 0!==(6&Ts)?$e():-1!==Qs?Qs:Qs=$e()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Ts)&&0!==Fs?Fs&-Fs:null!==vi.transition?(0===Js&&(Js=vt()),Js):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Kt(e.type)}function nc(e,t,n,r){if(50<Ks)throw Ks=0,$s=null,Error(i(185));mt(e,n,r),0!==(2&Ts)&&e===Ns||(e===Ns&&(0===(2&Ts)&&(Bs|=n),4===Os&&uc(e,Fs)),rc(e,r),1===n&&0===Ts&&0===(1&t.mode)&&(Us=$e()+500,La&&Ua()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-ot(i),u=1<<o,s=a[o];-1===s?0!==(u&n)&&0===(u&r)||(a[o]=ht(u,t)):s<=t&&(e.expiredLanes|=u),i&=~u}}(e,t);var r=dt(e,e===Ns?Fs:0);if(0===r)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){La=!0,ja(e)}(sc.bind(null,e)):ja(sc.bind(null,e)),oa((function(){0===(6&Ts)&&Ua()})),n=null;else{switch(xt(r)){case 1:n=Je;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Nc(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Qs=-1,Js=0,0!==(6&Ts))throw Error(i(327));var n=e.callbackNode;if(wc()&&e.callbackNode!==n)return null;var r=dt(e,e===Ns?Fs:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var a=Ts;Ts|=2;var o=pc();for(Ns===e&&Fs===t||(Ws=null,Us=$e()+500,dc(e,t));;)try{yc();break}catch(s){hc(e,s)}ki(),Ss.current=o,Ts=a,null!==Ds?t=0:(Ns=null,Fs=0,t=Os)}if(0!==t){if(2===t&&(0!==(a=pt(e))&&(r=a,t=ic(e,a))),1===t)throw n=Rs,dc(e,0),uc(e,r),rc(e,$e()),n;if(6===t)uc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!ur(i(),a))return!1}catch(u){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=gc(e,r))&&(0!==(o=pt(e))&&(r=o,t=ic(e,o))),1===t))throw n=Rs,dc(e,0),uc(e,r),rc(e,$e()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:kc(e,Ps,Ws);break;case 3:if(uc(e,r),(130023424&r)===r&&10<(t=js+500-$e())){if(0!==dt(e,0))break;if(((a=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(kc.bind(null,e,Ps,Ws),t);break}kc(e,Ps,Ws);break;case 4:if(uc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var u=31-ot(r);o=1<<u,(u=t[u])>a&&(a=u),r&=~o}if(r=a,10<(r=(120>(r=$e()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Cs(r/1960))-r)){e.timeoutHandle=ra(kc.bind(null,e,Ps,Ws),r);break}kc(e,Ps,Ws);break;default:throw Error(i(329))}}}return rc(e,$e()),e.callbackNode===n?ac.bind(null,e):null}function ic(e,t){var n=Ls;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=Ps,Ps=n,null!==t&&oc(t)),e}function oc(e){null===Ps?Ps=e:Ps.push.apply(Ps,e)}function uc(e,t){for(t&=~zs,t&=~Bs,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function sc(e){if(0!==(6&Ts))throw Error(i(327));wc();var t=dt(e,0);if(0===(1&t))return rc(e,$e()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=ic(e,r))}if(1===n)throw n=Rs,dc(e,0),uc(e,t),rc(e,$e()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,kc(e,Ps,Ws),rc(e,$e()),null}function cc(e,t){var n=Ts;Ts|=1;try{return e(t)}finally{0===(Ts=n)&&(Us=$e()+500,La&&Ua())}}function lc(e){null!==Xs&&0===Xs.tag&&0===(6&Ts)&&wc();var t=Ts;Ts|=1;var n=Es.transition,r=bt;try{if(Es.transition=null,bt=1,e)return e()}finally{bt=r,Es.transition=n,0===(6&(Ts=t))&&Ua()}}function fc(){Is=Ms.current,Sa(Ms)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Ds)for(n=Ds.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ma();break;case 3:ao(),Sa(Na),Sa(Ta),lo();break;case 5:oo(r);break;case 4:ao();break;case 13:case 19:Sa(uo);break;case 10:wi(r.type._context);break;case 22:case 23:fc()}n=n.return}if(Ns=e,Ds=e=Mc(e.current,null),Fs=Is=t,Os=0,Rs=null,zs=Bs=Zs=0,Ps=Ls=null,null!==Ai){for(t=0;t<Ai.length;t++)if(null!==(r=(n=Ai[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var o=i.next;i.next=a,r.next=o}n.pending=r}Ai=null}return e}function hc(e,t){for(;;){var n=Ds;try{if(ki(),fo.current=ou,yo){for(var r=vo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}yo=!1}if(po=0,mo=go=vo=null,bo=!1,xo=0,As.current=null,null===n||null===n.return){Os=1,Rs=t,Ds=null;break}e:{var o=e,u=n.return,s=n,c=t;if(t=Fs,s.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,f=s,d=f.tag;if(0===(1&f.mode)&&(0===d||11===d||15===d)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=mu(u);if(null!==p){p.flags&=-257,yu(p,u,s,0,t),1&p.mode&&gu(o,l,t),c=l;var v=(t=p).updateQueue;if(null===v){var g=new Set;g.add(c),t.updateQueue=g}else v.add(c);break e}if(0===(1&t)){gu(o,l,t),vc();break e}c=Error(i(426))}else if(ai&&1&s.mode){var m=mu(u);if(null!==m){0===(65536&m.flags)&&(m.flags|=256),yu(m,u,s,0,t),pi(lu(c,s));break e}}o=c=lu(c,s),4!==Os&&(Os=2),null===Ls?Ls=[o]:Ls.push(o),o=u;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Zi(o,pu(0,c,t));break e;case 1:s=c;var y=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===qs||!qs.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Zi(o,vu(o,s,t));break e}}o=o.return}while(null!==o)}xc(n)}catch(x){t=x,Ds===n&&null!==n&&(Ds=n=n.return);continue}break}}function pc(){var e=Ss.current;return Ss.current=ou,null===e?ou:e}function vc(){0!==Os&&3!==Os&&2!==Os||(Os=4),null===Ns||0===(268435455&Zs)&&0===(268435455&Bs)||uc(Ns,Fs)}function gc(e,t){var n=Ts;Ts|=2;var r=pc();for(Ns===e&&Fs===t||(Ws=null,dc(e,t));;)try{mc();break}catch(a){hc(e,a)}if(ki(),Ts=n,Ss.current=r,null!==Ds)throw Error(i(261));return Ns=null,Fs=0,Os}function mc(){for(;null!==Ds;)bc(Ds)}function yc(){for(;null!==Ds&&!Ye();)bc(Ds)}function bc(e){var t=_s(e.alternate,e,Is);e.memoizedProps=e.pendingProps,null===t?xc(e):Ds=t,As.current=null}function xc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Hu(n,t,Is)))return void(Ds=n)}else{if(null!==(n=Xu(n,t)))return n.flags&=32767,void(Ds=n);if(null===e)return Os=6,void(Ds=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ds=t);Ds=t=e}while(null!==t);0===Os&&(Os=5)}function kc(e,t,n){var r=bt,a=Es.transition;try{Es.transition=null,bt=1,function(e,t,n,r){do{wc()}while(null!==Xs);if(0!==(6&Ts))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ot(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,o),e===Ns&&(Ds=Ns=null,Fs=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Hs||(Hs=!0,Nc(tt,(function(){return wc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Es.transition,Es.transition=null;var u=bt;bt=1;var s=Ts;Ts|=4,As.current=null,function(e,t){if(ea=Vt,hr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(k){n=null;break e}var u=0,s=-1,c=-1,l=0,f=0,d=e,h=null;t:for(;;){for(var p;d!==n||0!==a&&3!==d.nodeType||(s=u+a),d!==o||0!==r&&3!==d.nodeType||(c=u+r),3===d.nodeType&&(u+=d.nodeValue.length),null!==(p=d.firstChild);)h=d,d=p;for(;;){if(d===e)break t;if(h===n&&++l===a&&(s=u),h===o&&++f===r&&(c=u),null!==(p=d.nextSibling))break;h=(d=h).parentNode}d=p}n=-1===s||-1===c?null:{start:s,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Vt=!1,Qu=t;null!==Qu;)if(e=(t=Qu).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Qu=e;else for(;null!==Qu;){t=Qu;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var g=v.memoizedProps,m=v.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:gi(t.type,g),m);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(i(163))}}catch(k){Cc(t,t.return,k)}if(null!==(e=t.sibling)){e.return=t.return,Qu=e;break}Qu=t.return}v=ts,ts=!1}(e,n),gs(n,e),pr(ta),Vt=!!ea,ta=ea=null,e.current=n,ys(n,e,a),Ke(),Ts=s,bt=u,Es.transition=o}else e.current=n;if(Hs&&(Hs=!1,Xs=e,Ys=a),o=e.pendingLanes,0===o&&(qs=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,$e()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Vs)throw Vs=!1,e=Gs,Gs=null,e;0!==(1&Ys)&&0!==e.tag&&wc(),o=e.pendingLanes,0!==(1&o)?e===$s?Ks++:(Ks=0,$s=e):Ks=0,Ua()}(e,t,n,r)}finally{Es.transition=a,bt=r}return null}function wc(){if(null!==Xs){var e=xt(Ys),t=Es.transition,n=bt;try{if(Es.transition=null,bt=16>e?16:e,null===Xs)var r=!1;else{if(e=Xs,Xs=null,Ys=0,0!==(6&Ts))throw Error(i(331));var a=Ts;for(Ts|=4,Qu=e.current;null!==Qu;){var o=Qu,u=o.child;if(0!==(16&Qu.flags)){var s=o.deletions;if(null!==s){for(var c=0;c<s.length;c++){var l=s[c];for(Qu=l;null!==Qu;){var f=Qu;switch(f.tag){case 0:case 11:case 15:ns(8,f,o)}var d=f.child;if(null!==d)d.return=f,Qu=d;else for(;null!==Qu;){var h=(f=Qu).sibling,p=f.return;if(is(f),f===l){Qu=null;break}if(null!==h){h.return=p,Qu=h;break}Qu=p}}}var v=o.alternate;if(null!==v){var g=v.child;if(null!==g){v.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(null!==g)}}Qu=o}}if(0!==(2064&o.subtreeFlags)&&null!==u)u.return=o,Qu=u;else e:for(;null!==Qu;){if(0!==(2048&(o=Qu).flags))switch(o.tag){case 0:case 11:case 15:ns(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Qu=y;break e}Qu=o.return}}var b=e.current;for(Qu=b;null!==Qu;){var x=(u=Qu).child;if(0!==(2064&u.subtreeFlags)&&null!==x)x.return=u,Qu=x;else e:for(u=b;null!==Qu;){if(0!==(2048&(s=Qu).flags))try{switch(s.tag){case 0:case 11:case 15:rs(9,s)}}catch(w){Cc(s,s.return,w)}if(s===u){Qu=null;break e}var k=s.sibling;if(null!==k){k.return=s.return,Qu=k;break e}Qu=s.return}}if(Ts=a,Ua(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(w){}r=!0}return r}finally{bt=n,Es.transition=t}}return!1}function _c(e,t,n){e=Oi(e,t=pu(0,t=lu(n,t),1),1),t=ec(),null!==e&&(mt(e,1,t),rc(e,t))}function Cc(e,t,n){if(3===e.tag)_c(e,e,n);else for(;null!==t;){if(3===t.tag){_c(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===qs||!qs.has(r))){t=Oi(t,e=vu(t,e=lu(n,e),1),1),e=ec(),null!==t&&(mt(t,1,e),rc(t,e));break}}t=t.return}}function Sc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Ns===e&&(Fs&n)===n&&(4===Os||3===Os&&(130023424&Fs)===Fs&&500>$e()-js?dc(e,0):zs|=n),rc(e,t)}function Ac(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=ec();null!==(e=Ni(e,t))&&(mt(e,t,n),rc(e,n))}function Ec(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ac(e,n)}function Tc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Ac(e,n)}function Nc(e,t){return He(e,t)}function Dc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fc(e,t,n,r){return new Dc(e,t,n,r)}function Ic(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mc(e,t){var n=e.alternate;return null===n?((n=Fc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,r,a,o){var u=2;if(r=e,"function"===typeof e)Ic(e)&&(u=1);else if("string"===typeof e)u=5;else e:switch(e){case _:return Rc(n.children,a,o,t);case C:u=8,a|=8;break;case S:return(e=Fc(12,n,t,2|a)).elementType=S,e.lanes=o,e;case N:return(e=Fc(13,n,t,a)).elementType=N,e.lanes=o,e;case D:return(e=Fc(19,n,t,a)).elementType=D,e.lanes=o,e;case M:return Zc(n,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case A:u=10;break e;case E:u=9;break e;case T:u=11;break e;case F:u=14;break e;case I:u=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Fc(u,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Rc(e,t,n,r){return(e=Fc(7,e,r,t)).lanes=n,e}function Zc(e,t,n,r){return(e=Fc(22,e,r,t)).elementType=M,e.lanes=n,e.stateNode={isHidden:!1},e}function Bc(e,t,n){return(e=Fc(6,e,null,t)).lanes=n,e}function zc(e,t,n){return(t=Fc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Lc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Pc(e,t,n,r,a,i,o,u,s){return e=new Lc(e,t,n,u,s),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Fc(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fi(i),e}function jc(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Uc(e){if(!e)return Ea;e:{if(Ue(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ia(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Ia(n))return Ra(e,n,t)}return t}function Wc(e,t,n,r,a,i,o,u,s){return(e=Pc(n,r,!0,e,0,i,0,u,s)).context=Uc(null),n=e.current,(i=Mi(r=ec(),a=tc(n))).callback=void 0!==t&&null!==t?t:null,Oi(n,i,a),e.current.lanes=a,mt(e,a,r),rc(e,r),e}function Vc(e,t,n,r){var a=t.current,i=ec(),o=tc(a);return n=Uc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Mi(i,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Oi(a,t,o))&&(nc(e,a,o,i),Ri(e,a,o)),o}function Gc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Hc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}_s=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Na.current)xu=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xu=!1,function(e,t,n){switch(t.tag){case 3:Du(t),hi();break;case 5:io(t);break;case 1:Ia(t.type)&&Za(t);break;case 4:ro(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Aa(mi,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Aa(uo,1&uo.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Bu(e,t,n):(Aa(uo,1&uo.current),null!==(e=Vu(e,t,n))?e.sibling:null);Aa(uo,1&uo.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Uu(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Aa(uo,uo.current),r)break;return null;case 22:case 23:return t.lanes=0,Su(e,t,n)}return Vu(e,t,n)}(e,t,n);xu=0!==(131072&e.flags)}else xu=!1,ai&&0!==(1048576&t.flags)&&Ja(t,qa,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Wu(e,t),e=t.pendingProps;var a=Fa(t,Ta.current);Ci(t,n),a=Co(null,t,r,e,a,n);var o=So();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ia(r)?(o=!0,Za(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Fi(t),a.updater=ji,t.stateNode=a,a._reactInternals=t,Gi(t,r,e,n),t=Nu(null,t,r,!0,o,n)):(t.tag=0,ai&&o&&ei(t),ku(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Wu(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Ic(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===F)return 14}return 2}(r),e=gi(r,e),a){case 0:t=Eu(null,t,r,e,n);break e;case 1:t=Tu(null,t,r,e,n);break e;case 11:t=wu(null,t,r,e,n);break e;case 14:t=_u(null,t,r,gi(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Eu(e,t,r,a=t.elementType===r?a:gi(r,a),n);case 1:return r=t.type,a=t.pendingProps,Tu(e,t,r,a=t.elementType===r?a:gi(r,a),n);case 3:e:{if(Du(t),null===e)throw Error(i(387));r=t.pendingProps,a=(o=t.memoizedState).element,Ii(e,t),Bi(t,r,null,n);var u=t.memoizedState;if(r=u.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:u.cache,pendingSuspenseBoundaries:u.pendingSuspenseBoundaries,transitions:u.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Fu(e,t,r,n,a=lu(Error(i(423)),t));break e}if(r!==a){t=Fu(e,t,r,n,a=lu(Error(i(424)),t));break e}for(ri=ca(t.stateNode.containerInfo.firstChild),ni=t,ai=!0,ii=null,n=$i(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(hi(),r===a){t=Vu(e,t,n);break e}ku(e,t,r,n)}t=t.child}return t;case 5:return io(t),null===e&&ci(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,u=a.children,na(r,a)?u=null:null!==o&&na(r,o)&&(t.flags|=32),Au(e,t),ku(e,t,u,n),t.child;case 6:return null===e&&ci(t),null;case 13:return Bu(e,t,n);case 4:return ro(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ki(t,null,r,n):ku(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,wu(e,t,r,a=t.elementType===r?a:gi(r,a),n);case 7:return ku(e,t,t.pendingProps,n),t.child;case 8:case 12:return ku(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,u=a.value,Aa(mi,r._currentValue),r._currentValue=u,null!==o)if(ur(o.value,u)){if(o.children===a.children&&!Na.current){t=Vu(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var s=o.dependencies;if(null!==s){u=o.child;for(var c=s.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Mi(-1,n&-n)).tag=2;var l=o.updateQueue;if(null!==l){var f=(l=l.shared).pending;null===f?c.next=c:(c.next=f.next,f.next=c),l.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),_i(o.return,n,t),s.lanes|=n;break}c=c.next}}else if(10===o.tag)u=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(u=o.return))throw Error(i(341));u.lanes|=n,null!==(s=u.alternate)&&(s.lanes|=n),_i(u,n,t),u=o.sibling}else u=o.child;if(null!==u)u.return=o;else for(u=o;null!==u;){if(u===t){u=null;break}if(null!==(o=u.sibling)){o.return=u.return,u=o;break}u=u.return}o=u}ku(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ci(t,n),r=r(a=Si(a)),t.flags|=1,ku(e,t,r,n),t.child;case 14:return a=gi(r=t.type,t.pendingProps),_u(e,t,r,a=gi(r.type,a),n);case 15:return Cu(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:gi(r,a),Wu(e,t),t.tag=1,Ia(r)?(e=!0,Za(t)):e=!1,Ci(t,n),Wi(t,r,a),Gi(t,r,a,n),Nu(null,t,r,!0,e,n);case 19:return Uu(e,t,n);case 22:return Su(e,t,n)}throw Error(i(156,t.tag))};var Xc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Kc(e){this._internalRoot=e}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function el(e,t,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if("function"===typeof a){var u=a;a=function(){var e=Gc(o);u.call(e)}}Vc(t,o,e,a)}else o=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=Gc(o);i.call(e)}}var o=Wc(t,r,e,0,null,!1,0,"",Jc);return e._reactRootContainer=o,e[pa]=o.current,Ur(8===e.nodeType?e.parentNode:e),lc(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var u=r;r=function(){var e=Gc(s);u.call(e)}}var s=Pc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=s,e[pa]=s.current,Ur(8===e.nodeType?e.parentNode:e),lc((function(){Vc(t,s,n,r)})),s}(n,t,e,a,r);return Gc(o)}Kc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Vc(e,t,null,null)},Kc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;lc((function(){Vc(null,e,null,null)})),t[pa]=null}},Kc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ct();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Mt.length&&0!==t&&t<Mt[n].priority;n++);Mt.splice(n,0,e),0===n&&Bt(e)}},kt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ft(t.pendingLanes);0!==n&&(yt(t,1|n),rc(t,$e()),0===(6&Ts)&&(Us=$e()+500,Ua()))}break;case 13:lc((function(){var t=Ni(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Hc(e,1)}},wt=function(e){if(13===e.tag){var t=Ni(e,134217728);if(null!==t)nc(t,e,134217728,ec());Hc(e,134217728)}},_t=function(e){if(13===e.tag){var t=tc(e),n=Ni(e,t);if(null!==n)nc(n,e,t,ec());Hc(e,t)}},Ct=function(){return bt},St=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},we=function(e,t,n){switch(t){case"input":if(Q(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=ka(r);if(!a)throw Error(i(90));H(r),Q(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Te=cc,Ne=lc;var tl={usingClientEntryPoint:!1,Events:[ba,xa,ka,Ae,Ee,cc]},nl={findFiberByHostInstance:ya,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rl={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!al.isDisabled&&al.supportsFiber)try{at=al.inject(rl),it=al}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$c(t))throw Error(i(200));return jc(e,t,null,n)},t.createRoot=function(e,t){if(!$c(e))throw Error(i(299));var n=!1,r="",a=Xc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Pc(e,1,!1,null,0,n,0,r,a),e[pa]=t.current,Ur(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return lc(e)},t.hydrate=function(e,t,n){if(!Qc(t))throw Error(i(200));return el(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!$c(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",u=Xc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(u=n.onRecoverableError)),t=Wc(t,null,e,1,null!=n?n:null,a,0,o,u),e[pa]=t.current,Ur(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Kc(t)},t.render=function(e,t,n){if(!Qc(t))throw Error(i(200));return el(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Qc(e))throw Error(i(40));return!!e._reactRootContainer&&(lc((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[pa]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Qc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return el(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},1250:function(e,t,n){"use strict";var r=n(4164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4463)},6374:function(e,t,n){"use strict";var r=n(2791),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,u=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,r)&&!s.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:l,props:i,_owner:u.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},9117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),u=Symbol.for("react.provider"),s=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,g={};function m(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=m.prototype;var x=b.prototype=new y;x.constructor=b,v(x,m.prototype),x.isPureReactComponent=!0;var k=Array.isArray,w=Object.prototype.hasOwnProperty,_={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,r){var a,i={},o=null,u=null;if(null!=t)for(a in void 0!==t.ref&&(u=t.ref),void 0!==t.key&&(o=""+t.key),t)w.call(t,a)&&!C.hasOwnProperty(a)&&(i[a]=t[a]);var s=arguments.length-2;if(1===s)i.children=r;else if(1<s){for(var c=Array(s),l=0;l<s;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(a in s=e.defaultProps)void 0===i[a]&&(i[a]=s[a]);return{$$typeof:n,type:e,key:o,ref:u,props:i,_owner:_.current}}function A(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,a,i,o){var u=typeof e;"undefined"!==u&&"boolean"!==u||(e=null);var s=!1;if(null===e)s=!0;else switch(u){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case n:case r:s=!0}}if(s)return o=o(s=e),e=""===i?"."+T(s,0):i,k(o)?(a="",null!=e&&(a=e.replace(E,"$&/")+"/"),N(o,t,a,"",(function(e){return e}))):null!=o&&(A(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||s&&s.key===o.key?"":(""+o.key).replace(E,"$&/")+"/")+e)),t.push(o)),1;if(s=0,i=""===i?".":i+":",k(e))for(var c=0;c<e.length;c++){var l=i+T(u=e[c],c);s+=N(u,t,a,l,o)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(u=e.next()).done;)s+=N(u=u.value,t,a,l=i+T(u,c++),o);else if("object"===u)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function D(e,t,n){if(null==e)return e;var r=[],a=0;return N(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function F(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},M={transition:null},O={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:M,ReactCurrentOwner:_};t.Children={map:D,forEach:function(e,t,n){D(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return D(e,(function(){t++})),t},toArray:function(e){return D(e,(function(e){return e}))||[]},only:function(e){if(!A(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=m,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=i,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=v({},e.props),i=e.key,o=e.ref,u=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,u=_.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(c in t)w.call(t,c)&&!C.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==s?s[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){s=Array(c);for(var l=0;l<c;l++)s[l]=arguments[l+2];a.children=s}return{$$typeof:n,type:e.type,key:i,ref:o,props:a,_owner:u}},t.createContext=function(e){return(e={$$typeof:s,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:u,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=A,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:F}},t.memo=function(e,t){return{$$typeof:f,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=M.transition;M.transition={};try{e()}finally{M.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,n){return I.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,n){return I.current.useReducer(e,t,n)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return I.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return I.current.useTransition()},t.version="18.2.0"},2791:function(e,t,n){"use strict";e.exports=n(9117)},184:function(e,t,n){"use strict";e.exports=n(6374)},6813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var u=2*(r+1)-1,s=e[u],c=u+1,l=e[c];if(0>i(s,n))c<a&&0>i(l,s)?(e[r]=l,e[c]=n,r=c):(e[r]=s,e[u]=n,r=u);else{if(!(c<a&&0>i(l,n)))break e;e[r]=l,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var u=Date,s=u.now();t.unstable_now=function(){return u.now()-s}}var c=[],l=[],f=1,d=null,h=3,p=!1,v=!1,g=!1,m="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(l);null!==t;){if(null===t.callback)a(l);else{if(!(t.startTime<=e))break;a(l),t.sortIndex=t.expirationTime,n(c,t)}t=r(l)}}function k(e){if(g=!1,x(e),!v)if(null!==r(c))v=!0,M(w);else{var t=r(l);null!==t&&O(k,t.startTime-e)}}function w(e,n){v=!1,g&&(g=!1,y(A),A=-1),p=!0;var i=h;try{for(x(n),d=r(c);null!==d&&(!(d.expirationTime>n)||e&&!N());){var o=d.callback;if("function"===typeof o){d.callback=null,h=d.priorityLevel;var u=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof u?d.callback=u:d===r(c)&&a(c),x(n)}else a(c);d=r(c)}if(null!==d)var s=!0;else{var f=r(l);null!==f&&O(k,f.startTime-n),s=!1}return s}finally{d=null,h=i,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,C=!1,S=null,A=-1,E=5,T=-1;function N(){return!(t.unstable_now()-T<E)}function D(){if(null!==S){var e=t.unstable_now();T=e;var n=!0;try{n=S(!0,e)}finally{n?_():(C=!1,S=null)}}else C=!1}if("function"===typeof b)_=function(){b(D)};else if("undefined"!==typeof MessageChannel){var F=new MessageChannel,I=F.port2;F.port1.onmessage=D,_=function(){I.postMessage(null)}}else _=function(){m(D,0)};function M(e){S=e,C||(C=!0,_())}function O(e,n){A=m((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||p||(v=!0,M(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var u=-1;break;case 2:u=250;break;case 5:u=1073741823;break;case 4:u=1e4;break;default:u=5e3}return e={id:f++,callback:a,priorityLevel:e,startTime:i,expirationTime:u=i+u,sortIndex:-1},i>o?(e.sortIndex=i,n(l,e),null===r(c)&&e===r(l)&&(g?(y(A),A=-1):g=!0,O(k,i-o))):(e.sortIndex=u,n(c,e),v||p||(v=!0,M(w))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}},5296:function(e,t,n){"use strict";e.exports=n(6813)},6699:function(e,t,n){var r=n(2501),a=n(9112),i=n(2132),o=n(890),u=n(4113),s=n(1725),c=n(3411);c.alea=r,c.xor128=a,c.xorwow=i,c.xorshift7=o,c.xor4096=u,c.tychei=s,e.exports=c},2501:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n=function(){var e=4022871197,t=function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)};return t}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function u(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.alea=s}(0,e=n.nmd(e),n.amdD)},1725:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function u(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.tychei=s}(0,e=n.nmd(e),n.amdD)},9112:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function u(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xor128=s}(0,e=n.nmd(e),n.amdD)},4113:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,u=[],s=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,s=Math.max(s,t.length)),a=0,i=-32;i<s;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=u[127&i]^=r+o)?a+1:0);for(a>=128&&(u[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=u[a+34&127],n=u[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,u[a]=r^n;e.w=o,e.X=u,e.i=a}(t,e)}function u(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xor4096=s}(0,e=n.nmd(e),n.amdD)},890:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function u(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xorshift7=s}(0,e=n.nmd(e),n.amdD)},2132:function(e,t,n){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function u(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xorwow=s}(0,e=n.nmd(e),n.amdD)},3411:function(e,t,n){var r;!function(a,i,o){var u,s=256,c=o.pow(s,6),l=o.pow(2,52),f=2*l,d=255;function h(e,t,n){var r=[],d=m(g((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(i)]:null==e?function(){try{var e;return u&&(e=u.randomBytes)?e=e(s):(e=new Uint8Array(s),(a.crypto||a.msCrypto).getRandomValues(e)),y(e)}catch(r){var t=a.navigator,n=t&&t.plugins;return[+new Date,a,n,a.screen,y(i)]}}():e,3),r),h=new p(r),b=function(){for(var e=h.g(6),t=c,n=0;e<l;)e=(e+n)*s,t*=s,n=h.g(1);for(;e>=f;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|h.g(4)},b.quick=function(){return h.g(4)/4294967296},b.double=b,m(y(h.S),i),(t.pass||n||function(e,t,n,r){return r&&(r.S&&v(r,h),e.state=function(){return v(h,{})}),n?(o.random=e,t):e})(b,d,"global"in t?t.global:this==o,t.state)}function p(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<s;)o[a]=a++;for(a=0;a<s;a++)o[a]=o[i=d&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=d&a+1],n=n*s+o[d&(o[a]=o[i=d&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(s)}function v(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function g(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(g(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function m(e,t){for(var n,r=e+"",a=0;a<r.length;)t[d&a]=d&(n^=19*t[d&a])+r.charCodeAt(a++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(m(o.random(),i),e.exports){e.exports=h;try{u=n(5042)}catch(b){}}else void 0===(r=function(){return h}.call(t,n,t,e))||(e.exports=r)}("undefined"!==typeof self?self:this,[],Math)},8981:function(e,t,n){var r=n(6690).default,a=n(9728).default,i=Symbol("SemVer ANY"),o=function(){"use strict";function e(t,n){if(r(this,e),n=u(n),t instanceof e){if(t.loose===!!n.loose)return t;t=t.value}d("comparator",t,n),this.options=n,this.loose=!!n.loose,this.parse(t),this.semver===i?this.value="":this.value=this.operator+this.semver.version,d("comp",this)}return a(e,[{key:"parse",value:function(e){var t=this.options.loose?c[l.COMPARATORLOOSE]:c[l.COMPARATOR],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: ".concat(e));this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new h(n[2],this.options.loose):this.semver=i}},{key:"toString",value:function(){return this.value}},{key:"test",value:function(e){if(d("Comparator.test",e,this.options.loose),this.semver===i||e===i)return!0;if("string"===typeof e)try{e=new h(e,this.options)}catch(t){return!1}return f(e,this.operator,this.semver,this.options)}},{key:"intersects",value:function(t,n){if(!(t instanceof e))throw new TypeError("a Comparator is required");if(n&&"object"===typeof n||(n={loose:!!n,includePrerelease:!1}),""===this.operator)return""===this.value||new p(t.value,n).test(this.value);if(""===t.operator)return""===t.value||new p(this.value,n).test(t.semver);var r=(">="===this.operator||">"===this.operator)&&(">="===t.operator||">"===t.operator),a=("<="===this.operator||"<"===this.operator)&&("<="===t.operator||"<"===t.operator),i=this.semver.version===t.semver.version,o=(">="===this.operator||"<="===this.operator)&&(">="===t.operator||"<="===t.operator),u=f(this.semver,"<",t.semver,n)&&(">="===this.operator||">"===this.operator)&&("<="===t.operator||"<"===t.operator),s=f(this.semver,">",t.semver,n)&&("<="===this.operator||"<"===this.operator)&&(">="===t.operator||">"===t.operator);return r||a||i&&o||u||s}}],[{key:"ANY",get:function(){return i}}]),e}();e.exports=o;var u=n(8270),s=n(5446),c=s.re,l=s.t,f=n(2907),d=n(9304),h=n(3298),p=n(487)},487:function(e,t,n){var r=n(861).default,a=n(4704).default,i=n(6690).default,o=n(9728).default,u=function(){"use strict";function e(t,n){var r=this;if(i(this,e),n=c(n),t instanceof e)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new e(t.raw,n);if(t instanceof l)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t,this.set=t.split("||").map((function(e){return r.parseRange(e.trim())})).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(t));if(this.set.length>1){var o=this.set[0];if(this.set=this.set.filter((function(e){return!b(e[0])})),0===this.set.length)this.set=[o];else if(this.set.length>1){var u,s=a(this.set);try{for(s.s();!(u=s.n()).done;){var f=u.value;if(1===f.length&&x(f[0])){this.set=[f];break}}}catch(d){s.e(d)}finally{s.f()}}}this.format()}return o(e,[{key:"format",value:function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range}},{key:"toString",value:function(){return this.range}},{key:"parseRange",value:function(e){var t=this;e=e.trim();var n=Object.keys(this.options).join(","),i="parseRange:".concat(n,":").concat(e),o=s.get(i);if(o)return o;var u=this.options.loose,c=u?p[v.HYPHENRANGELOOSE]:p[v.HYPHENRANGE];e=e.replace(c,I(this.options.includePrerelease)),f("hyphen replace",e),e=e.replace(p[v.COMPARATORTRIM],g),f("comparator trim",e);var d=(e=(e=(e=e.replace(p[v.TILDETRIM],m)).replace(p[v.CARETTRIM],y)).split(/\s+/).join(" ")).split(" ").map((function(e){return w(e,t.options)})).join(" ").split(/\s+/).map((function(e){return F(e,t.options)}));u&&(d=d.filter((function(e){return f("loose invalid filter",e,t.options),!!e.match(p[v.COMPARATORLOOSE])}))),f("range list",d);var h,x=new Map,k=d.map((function(e){return new l(e,t.options)})),_=a(k);try{for(_.s();!(h=_.n()).done;){var C=h.value;if(b(C))return[C];x.set(C.value,C)}}catch(A){_.e(A)}finally{_.f()}x.size>1&&x.has("")&&x.delete("");var S=r(x.values());return s.set(i,S),S}},{key:"intersects",value:function(t,n){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some((function(e){return k(e,n)&&t.set.some((function(t){return k(t,n)&&e.every((function(e){return t.every((function(t){return e.intersects(t,n)}))}))}))}))}},{key:"test",value:function(e){if(!e)return!1;if("string"===typeof e)try{e=new d(e,this.options)}catch(n){return!1}for(var t=0;t<this.set.length;t++)if(M(this.set[t],e,this.options))return!0;return!1}}]),e}();e.exports=u;var s=new(n(5414))({max:1e3}),c=n(8270),l=n(8981),f=n(9304),d=n(3298),h=n(5446),p=h.re,v=h.t,g=h.comparatorTrimReplace,m=h.tildeTrimReplace,y=h.caretTrimReplace,b=function(e){return"<0.0.0-0"===e.value},x=function(e){return""===e.value},k=function(e,t){for(var n=!0,r=e.slice(),a=r.pop();n&&r.length;)n=r.every((function(e){return a.intersects(e,t)})),a=r.pop();return n},w=function(e,t){return f("comp",e,t),e=A(e,t),f("caret",e),e=C(e,t),f("tildes",e),e=T(e,t),f("xrange",e),e=D(e,t),f("stars",e),e},_=function(e){return!e||"x"===e.toLowerCase()||"*"===e},C=function(e,t){return e.trim().split(/\s+/).map((function(e){return S(e,t)})).join(" ")},S=function(e,t){var n=t.loose?p[v.TILDELOOSE]:p[v.TILDE];return e.replace(n,(function(t,n,r,a,i){var o;return f("tilde",e,t,n,r,a,i),_(n)?o="":_(r)?o=">=".concat(n,".0.0 <").concat(+n+1,".0.0-0"):_(a)?o=">=".concat(n,".").concat(r,".0 <").concat(n,".").concat(+r+1,".0-0"):i?(f("replaceTilde pr",i),o=">=".concat(n,".").concat(r,".").concat(a,"-").concat(i," <").concat(n,".").concat(+r+1,".0-0")):o=">=".concat(n,".").concat(r,".").concat(a," <").concat(n,".").concat(+r+1,".0-0"),f("tilde return",o),o}))},A=function(e,t){return e.trim().split(/\s+/).map((function(e){return E(e,t)})).join(" ")},E=function(e,t){f("caret",e,t);var n=t.loose?p[v.CARETLOOSE]:p[v.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,(function(t,n,a,i,o){var u;return f("caret",e,t,n,a,i,o),_(n)?u="":_(a)?u=">=".concat(n,".0.0").concat(r," <").concat(+n+1,".0.0-0"):_(i)?u="0"===n?">=".concat(n,".").concat(a,".0").concat(r," <").concat(n,".").concat(+a+1,".0-0"):">=".concat(n,".").concat(a,".0").concat(r," <").concat(+n+1,".0.0-0"):o?(f("replaceCaret pr",o),u="0"===n?"0"===a?">=".concat(n,".").concat(a,".").concat(i,"-").concat(o," <").concat(n,".").concat(a,".").concat(+i+1,"-0"):">=".concat(n,".").concat(a,".").concat(i,"-").concat(o," <").concat(n,".").concat(+a+1,".0-0"):">=".concat(n,".").concat(a,".").concat(i,"-").concat(o," <").concat(+n+1,".0.0-0")):(f("no pr"),u="0"===n?"0"===a?">=".concat(n,".").concat(a,".").concat(i).concat(r," <").concat(n,".").concat(a,".").concat(+i+1,"-0"):">=".concat(n,".").concat(a,".").concat(i).concat(r," <").concat(n,".").concat(+a+1,".0-0"):">=".concat(n,".").concat(a,".").concat(i," <").concat(+n+1,".0.0-0")),f("caret return",u),u}))},T=function(e,t){return f("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return N(e,t)})).join(" ")},N=function(e,t){e=e.trim();var n=t.loose?p[v.XRANGELOOSE]:p[v.XRANGE];return e.replace(n,(function(n,r,a,i,o,u){f("xRange",e,n,r,a,i,o,u);var s=_(a),c=s||_(i),l=c||_(o),d=l;return"="===r&&d&&(r=""),u=t.includePrerelease?"-0":"",s?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&d?(c&&(i=0),o=0,">"===r?(r=">=",c?(a=+a+1,i=0,o=0):(i=+i+1,o=0)):"<="===r&&(r="<",c?a=+a+1:i=+i+1),"<"===r&&(u="-0"),n="".concat(r+a,".").concat(i,".").concat(o).concat(u)):c?n=">=".concat(a,".0.0").concat(u," <").concat(+a+1,".0.0-0"):l&&(n=">=".concat(a,".").concat(i,".0").concat(u," <").concat(a,".").concat(+i+1,".0-0")),f("xRange return",n),n}))},D=function(e,t){return f("replaceStars",e,t),e.trim().replace(p[v.STAR],"")},F=function(e,t){return f("replaceGTE0",e,t),e.trim().replace(p[t.includePrerelease?v.GTE0PRE:v.GTE0],"")},I=function(e){return function(t,n,r,a,i,o,u,s,c,l,f,d,h){return n=_(r)?"":_(a)?">=".concat(r,".0.0").concat(e?"-0":""):_(i)?">=".concat(r,".").concat(a,".0").concat(e?"-0":""):o?">=".concat(n):">=".concat(n).concat(e?"-0":""),s=_(c)?"":_(l)?"<".concat(+c+1,".0.0-0"):_(f)?"<".concat(c,".").concat(+l+1,".0-0"):d?"<=".concat(c,".").concat(l,".").concat(f,"-").concat(d):e?"<".concat(c,".").concat(l,".").concat(+f+1,"-0"):"<=".concat(s),"".concat(n," ").concat(s).trim()}},M=function(e,t,n){for(var r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(var a=0;a<e.length;a++)if(f(e[a].semver),e[a].semver!==l.ANY&&e[a].semver.prerelease.length>0){var i=e[a].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}},3298:function(e,t,n){var r=n(6690).default,a=n(9728).default,i=n(9304),o=n(7918),u=o.MAX_LENGTH,s=o.MAX_SAFE_INTEGER,c=n(5446),l=c.re,f=c.t,d=n(8270),h=n(3228).compareIdentifiers,p=function(){"use strict";function e(t,n){if(r(this,e),n=d(n),t instanceof e){if(t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease)return t;t=t.version}else if("string"!==typeof t)throw new TypeError("Invalid Version: ".concat(t));if(t.length>u)throw new TypeError("version is longer than ".concat(u," characters"));i("SemVer",t,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;var a=t.trim().match(n.loose?l[f.LOOSE]:l[f.FULL]);if(!a)throw new TypeError("Invalid Version: ".concat(t));if(this.raw=t,this.major=+a[1],this.minor=+a[2],this.patch=+a[3],this.major>s||this.major<0)throw new TypeError("Invalid major version");if(this.minor>s||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>s||this.patch<0)throw new TypeError("Invalid patch version");a[4]?this.prerelease=a[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<s)return t}return e})):this.prerelease=[],this.build=a[5]?a[5].split("."):[],this.format()}return a(e,[{key:"format",value:function(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}},{key:"toString",value:function(){return this.version}},{key:"compare",value:function(t){if(i("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if("string"===typeof t&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}},{key:"compareMain",value:function(t){return t instanceof e||(t=new e(t,this.options)),h(this.major,t.major)||h(this.minor,t.minor)||h(this.patch,t.patch)}},{key:"comparePre",value:function(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var n=0;do{var r=this.prerelease[n],a=t.prerelease[n];if(i("prerelease compare",n,r,a),void 0===r&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===r)return-1;if(r!==a)return h(r,a)}while(++n)}},{key:"compareBuild",value:function(t){t instanceof e||(t=new e(t,this.options));var n=0;do{var r=this.build[n],a=t.build[n];if(i("prerelease compare",n,r,a),void 0===r&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===r)return-1;if(r!==a)return h(r,a)}while(++n)}},{key:"inc",value:function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var n=this.prerelease.length;--n>=0;)"number"===typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);-1===n&&this.prerelease.push(0)}t&&(0===h(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: ".concat(e))}return this.format(),this.raw=this.version,this}}]),e}();e.exports=p},5365:function(e,t,n){var r=n(7985);e.exports=function(e,t){var n=r(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}},2907:function(e,t,n){var r=n(5378),a=n(9078),i=n(4544),o=n(6310),u=n(4562),s=n(7532);e.exports=function(e,t,n,c){switch(t){case"===":return"object"===typeof e&&(e=e.version),"object"===typeof n&&(n=n.version),e===n;case"!==":return"object"===typeof e&&(e=e.version),"object"===typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return r(e,n,c);case"!=":return a(e,n,c);case">":return i(e,n,c);case">=":return o(e,n,c);case"<":return u(e,n,c);case"<=":return s(e,n,c);default:throw new TypeError("Invalid operator: ".concat(t))}}},5071:function(e,t,n){var r=n(3298),a=n(7985),i=n(5446),o=i.re,u=i.t;e.exports=function(e,t){if(e instanceof r)return e;if("number"===typeof e&&(e=String(e)),"string"!==typeof e)return null;var n=null;if((t=t||{}).rtl){for(var i;(i=o[u.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&i.index+i[0].length===n.index+n[0].length||(n=i),o[u.COERCERTL].lastIndex=i.index+i[1].length+i[2].length;o[u.COERCERTL].lastIndex=-1}else n=e.match(o[u.COERCE]);return null===n?null:a("".concat(n[2],".").concat(n[3]||"0",".").concat(n[4]||"0"),t)}},96:function(e,t,n){var r=n(3298);e.exports=function(e,t,n){var a=new r(e,n),i=new r(t,n);return a.compare(i)||a.compareBuild(i)}},832:function(e,t,n){var r=n(2384);e.exports=function(e,t){return r(e,t,!0)}},2384:function(e,t,n){var r=n(3298);e.exports=function(e,t,n){return new r(e,n).compare(new r(t,n))}},639:function(e,t,n){var r=n(7985),a=n(5378);e.exports=function(e,t){if(a(e,t))return null;var n=r(e),i=r(t),o=n.prerelease.length||i.prerelease.length,u=o?"pre":"",s=o?"prerelease":"";for(var c in n)if(("major"===c||"minor"===c||"patch"===c)&&n[c]!==i[c])return u+c;return s}},5378:function(e,t,n){var r=n(2384);e.exports=function(e,t,n){return 0===r(e,t,n)}},4544:function(e,t,n){var r=n(2384);e.exports=function(e,t,n){return r(e,t,n)>0}},6310:function(e,t,n){var r=n(2384);e.exports=function(e,t,n){return r(e,t,n)>=0}},6778:function(e,t,n){var r=n(3298);e.exports=function(e,t,n,a){"string"===typeof n&&(a=n,n=void 0);try{return new r(e instanceof r?e.version:e,n).inc(t,a).version}catch(i){return null}}},4562:function(e,t,n){var r=n(2384);e.exports=function(e,t,n){return r(e,t,n)<0}},7532:function(e,t,n){var r=n(2384);e.exports=function(e,t,n){return r(e,t,n)<=0}},2750:function(e,t,n){var r=n(3298);e.exports=function(e,t){return new r(e,t).major}},4184:function(e,t,n){var r=n(3298);e.exports=function(e,t){return new r(e,t).minor}},9078:function(e,t,n){var r=n(2384);e.exports=function(e,t,n){return 0!==r(e,t,n)}},7985:function(e,t,n){var r=n(7918).MAX_LENGTH,a=n(5446),i=a.re,o=a.t,u=n(3298),s=n(8270);e.exports=function(e,t){if(t=s(t),e instanceof u)return e;if("string"!==typeof e)return null;if(e.length>r)return null;if(!(t.loose?i[o.LOOSE]:i[o.FULL]).test(e))return null;try{return new u(e,t)}catch(n){return null}}},5093:function(e,t,n){var r=n(3298);e.exports=function(e,t){return new r(e,t).patch}},9361:function(e,t,n){var r=n(7985);e.exports=function(e,t){var n=r(e,t);return n&&n.prerelease.length?n.prerelease:null}},8111:function(e,t,n){var r=n(2384);e.exports=function(e,t,n){return r(t,e,n)}},6658:function(e,t,n){var r=n(96);e.exports=function(e,t){return e.sort((function(e,n){return r(n,e,t)}))}},2529:function(e,t,n){var r=n(487);e.exports=function(e,t,n){try{t=new r(t,n)}catch(a){return!1}return t.test(e)}},3462:function(e,t,n){var r=n(96);e.exports=function(e,t){return e.sort((function(e,n){return r(e,n,t)}))}},6793:function(e,t,n){var r=n(7985);e.exports=function(e,t){var n=r(e,t);return n?n.version:null}},724:function(e,t,n){var r=n(5446),a=n(7918),i=n(3298),o=n(3228),u=n(7985),s=n(6793),c=n(5365),l=n(6778),f=n(639),d=n(2750),h=n(4184),p=n(5093),v=n(9361),g=n(2384),m=n(8111),y=n(832),b=n(96),x=n(3462),k=n(6658),w=n(4544),_=n(4562),C=n(5378),S=n(9078),A=n(6310),E=n(7532),T=n(2907),N=n(5071),D=n(8981),F=n(487),I=n(2529),M=n(7545),O=n(2103),R=n(6088),Z=n(1219),B=n(1383),z=n(2643),L=n(7281),P=n(5675),j=n(8772),U=n(4934),W=n(6669);e.exports={parse:u,valid:s,clean:c,inc:l,diff:f,major:d,minor:h,patch:p,prerelease:v,compare:g,rcompare:m,compareLoose:y,compareBuild:b,sort:x,rsort:k,gt:w,lt:_,eq:C,neq:S,gte:A,lte:E,cmp:T,coerce:N,Comparator:D,Range:F,satisfies:I,toComparators:M,maxSatisfying:O,minSatisfying:R,minVersion:Z,validRange:B,outside:z,gtr:L,ltr:P,intersects:j,simplifyRange:U,subset:W,SemVer:i,re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:a.SEMVER_SPEC_VERSION,compareIdentifiers:o.compareIdentifiers,rcompareIdentifiers:o.rcompareIdentifiers}},7918:function(e){var t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:t,MAX_SAFE_COMPONENT_LENGTH:16}},9304:function(e){var t="object"===typeof process&&{NODE_ENV:"production",PUBLIC_URL:"/soma-portal",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NODE_DEBUG&&/\bsemver\b/i.test({NODE_ENV:"production",PUBLIC_URL:"/soma-portal",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.NODE_DEBUG)?function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=console).error.apply(e,["SEMVER"].concat(n))}:function(){};e.exports=t},3228:function(e){var t=/^[0-9]+$/,n=function(e,n){var r=t.test(e),a=t.test(n);return r&&a&&(e=+e,n=+n),e===n?0:r&&!a?-1:a&&!r?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:function(e,t){return n(t,e)}}},8270:function(e){var t=["includePrerelease","loose","rtl"];e.exports=function(e){return e?"object"!==typeof e?{loose:!0}:t.filter((function(t){return e[t]})).reduce((function(e,t){return e[t]=!0,e}),{}):{}}},5446:function(e,t,n){var r=n(7918).MAX_SAFE_COMPONENT_LENGTH,a=n(9304),i=(t=e.exports={}).re=[],o=t.src=[],u=t.t={},s=0,c=function(e,t,n){var r=s++;a(e,r,t),u[e]=r,o[r]=t,i[r]=new RegExp(t,n?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION","(".concat(o[u.NUMERICIDENTIFIER],")\\.")+"(".concat(o[u.NUMERICIDENTIFIER],")\\.")+"(".concat(o[u.NUMERICIDENTIFIER],")")),c("MAINVERSIONLOOSE","(".concat(o[u.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(o[u.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(o[u.NUMERICIDENTIFIERLOOSE],")")),c("PRERELEASEIDENTIFIER","(?:".concat(o[u.NUMERICIDENTIFIER],"|").concat(o[u.NONNUMERICIDENTIFIER],")")),c("PRERELEASEIDENTIFIERLOOSE","(?:".concat(o[u.NUMERICIDENTIFIERLOOSE],"|").concat(o[u.NONNUMERICIDENTIFIER],")")),c("PRERELEASE","(?:-(".concat(o[u.PRERELEASEIDENTIFIER],"(?:\\.").concat(o[u.PRERELEASEIDENTIFIER],")*))")),c("PRERELEASELOOSE","(?:-?(".concat(o[u.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(o[u.PRERELEASEIDENTIFIERLOOSE],")*))")),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD","(?:\\+(".concat(o[u.BUILDIDENTIFIER],"(?:\\.").concat(o[u.BUILDIDENTIFIER],")*))")),c("FULLPLAIN","v?".concat(o[u.MAINVERSION]).concat(o[u.PRERELEASE],"?").concat(o[u.BUILD],"?")),c("FULL","^".concat(o[u.FULLPLAIN],"$")),c("LOOSEPLAIN","[v=\\s]*".concat(o[u.MAINVERSIONLOOSE]).concat(o[u.PRERELEASELOOSE],"?").concat(o[u.BUILD],"?")),c("LOOSE","^".concat(o[u.LOOSEPLAIN],"$")),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE","".concat(o[u.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),c("XRANGEIDENTIFIER","".concat(o[u.NUMERICIDENTIFIER],"|x|X|\\*")),c("XRANGEPLAIN","[v=\\s]*(".concat(o[u.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(o[u.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(o[u.XRANGEIDENTIFIER],")")+"(?:".concat(o[u.PRERELEASE],")?").concat(o[u.BUILD],"?")+")?)?"),c("XRANGEPLAINLOOSE","[v=\\s]*(".concat(o[u.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(o[u.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(o[u.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(o[u.PRERELEASELOOSE],")?").concat(o[u.BUILD],"?")+")?)?"),c("XRANGE","^".concat(o[u.GTLT],"\\s*").concat(o[u.XRANGEPLAIN],"$")),c("XRANGELOOSE","^".concat(o[u.GTLT],"\\s*").concat(o[u.XRANGEPLAINLOOSE],"$")),c("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(r,"})")+"(?:\\.(\\d{1,".concat(r,"}))?")+"(?:\\.(\\d{1,".concat(r,"}))?")+"(?:$|[^\\d])"),c("COERCERTL",o[u.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM","(\\s*)".concat(o[u.LONETILDE],"\\s+"),!0),t.tildeTrimReplace="$1~",c("TILDE","^".concat(o[u.LONETILDE]).concat(o[u.XRANGEPLAIN],"$")),c("TILDELOOSE","^".concat(o[u.LONETILDE]).concat(o[u.XRANGEPLAINLOOSE],"$")),c("LONECARET","(?:\\^)"),c("CARETTRIM","(\\s*)".concat(o[u.LONECARET],"\\s+"),!0),t.caretTrimReplace="$1^",c("CARET","^".concat(o[u.LONECARET]).concat(o[u.XRANGEPLAIN],"$")),c("CARETLOOSE","^".concat(o[u.LONECARET]).concat(o[u.XRANGEPLAINLOOSE],"$")),c("COMPARATORLOOSE","^".concat(o[u.GTLT],"\\s*(").concat(o[u.LOOSEPLAIN],")$|^$")),c("COMPARATOR","^".concat(o[u.GTLT],"\\s*(").concat(o[u.FULLPLAIN],")$|^$")),c("COMPARATORTRIM","(\\s*)".concat(o[u.GTLT],"\\s*(").concat(o[u.LOOSEPLAIN],"|").concat(o[u.XRANGEPLAIN],")"),!0),t.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE","^\\s*(".concat(o[u.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(o[u.XRANGEPLAIN],")")+"\\s*$"),c("HYPHENRANGELOOSE","^\\s*(".concat(o[u.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(o[u.XRANGEPLAINLOOSE],")")+"\\s*$"),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},5414:function(e,t,n){"use strict";var r=n(6690).default,a=n(9728).default,i=n(434),o=Symbol("max"),u=Symbol("length"),s=Symbol("lengthCalculator"),c=Symbol("allowStale"),l=Symbol("maxAge"),f=Symbol("dispose"),d=Symbol("noDisposeOnSet"),h=Symbol("lruList"),p=Symbol("cache"),v=Symbol("updateAgeOnGet"),g=function(){return 1},m=function(){function e(t){if(r(this,e),"number"===typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!==typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[o]=t.max||1/0;var n=t.length||g;if(this[s]="function"!==typeof n?g:n,this[c]=t.stale||!1,t.maxAge&&"number"!==typeof t.maxAge)throw new TypeError("maxAge must be a number");this[l]=t.maxAge||0,this[f]=t.dispose,this[d]=t.noDisposeOnSet||!1,this[v]=t.updateAgeOnGet||!1,this.reset()}return a(e,[{key:"max",get:function(){return this[o]},set:function(e){if("number"!==typeof e||e<0)throw new TypeError("max must be a non-negative number");this[o]=e||1/0,x(this)}},{key:"allowStale",get:function(){return this[c]},set:function(e){this[c]=!!e}},{key:"maxAge",get:function(){return this[l]},set:function(e){if("number"!==typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,x(this)}},{key:"lengthCalculator",get:function(){return this[s]},set:function(e){var t=this;"function"!==typeof e&&(e=g),e!==this[s]&&(this[s]=e,this[u]=0,this[h].forEach((function(e){e.length=t[s](e.value,e.key),t[u]+=e.length}))),x(this)}},{key:"length",get:function(){return this[u]}},{key:"itemCount",get:function(){return this[h].length}},{key:"rforEach",value:function(e,t){t=t||this;for(var n=this[h].tail;null!==n;){var r=n.prev;_(this,e,n,t),n=r}}},{key:"forEach",value:function(e,t){t=t||this;for(var n=this[h].head;null!==n;){var r=n.next;_(this,e,n,t),n=r}}},{key:"keys",value:function(){return this[h].toArray().map((function(e){return e.key}))}},{key:"values",value:function(){return this[h].toArray().map((function(e){return e.value}))}},{key:"reset",value:function(){var e=this;this[f]&&this[h]&&this[h].length&&this[h].forEach((function(t){return e[f](t.key,t.value)})),this[p]=new Map,this[h]=new i,this[u]=0}},{key:"dump",value:function(){var e=this;return this[h].map((function(t){return!b(e,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}})).toArray().filter((function(e){return e}))}},{key:"dumpLru",value:function(){return this[h]}},{key:"set",value:function(e,t,n){if((n=n||this[l])&&"number"!==typeof n)throw new TypeError("maxAge must be a number");var r=n?Date.now():0,a=this[s](t,e);if(this[p].has(e)){if(a>this[o])return k(this,this[p].get(e)),!1;var i=this[p].get(e).value;return this[f]&&(this[d]||this[f](e,i.value)),i.now=r,i.maxAge=n,i.value=t,this[u]+=a-i.length,i.length=a,this.get(e),x(this),!0}var c=new w(e,t,a,r,n);return c.length>this[o]?(this[f]&&this[f](e,t),!1):(this[u]+=c.length,this[h].unshift(c),this[p].set(e,this[h].head),x(this),!0)}},{key:"has",value:function(e){if(!this[p].has(e))return!1;var t=this[p].get(e).value;return!b(this,t)}},{key:"get",value:function(e){return y(this,e,!0)}},{key:"peek",value:function(e){return y(this,e,!1)}},{key:"pop",value:function(){var e=this[h].tail;return e?(k(this,e),e.value):null}},{key:"del",value:function(e){k(this,this[p].get(e))}},{key:"load",value:function(e){this.reset();for(var t=Date.now(),n=e.length-1;n>=0;n--){var r=e[n],a=r.e||0;if(0===a)this.set(r.k,r.v);else{var i=a-t;i>0&&this.set(r.k,r.v,i)}}}},{key:"prune",value:function(){var e=this;this[p].forEach((function(t,n){return y(e,n,!1)}))}}]),e}(),y=function(e,t,n){var r=e[p].get(t);if(r){var a=r.value;if(b(e,a)){if(k(e,r),!e[c])return}else n&&(e[v]&&(r.value.now=Date.now()),e[h].unshiftNode(r));return a.value}},b=function(e,t){if(!t||!t.maxAge&&!e[l])return!1;var n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[l]&&n>e[l]},x=function(e){if(e[u]>e[o])for(var t=e[h].tail;e[u]>e[o]&&null!==t;){var n=t.prev;k(e,t),t=n}},k=function(e,t){if(t){var n=t.value;e[f]&&e[f](n.key,n.value),e[u]-=n.length,e[p].delete(n.key),e[h].removeNode(t)}},w=a((function e(t,n,a,i,o){r(this,e),this.key=t,this.value=n,this.length=a,this.now=i,this.maxAge=o||0})),_=function(e,t,n,r){var a=n.value;b(e,a)&&(k(e,n),e[c]||(a=void 0)),a&&t.call(r,a.value,a.key,e)};e.exports=m},1817:function(e,t,n){"use strict";var r=n(7061).default;e.exports=function(e){e.prototype[Symbol.iterator]=r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.head;case 1:if(!t){e.next=7;break}return e.next=4,t.value;case 4:t=t.next,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))}},434:function(e,t,n){"use strict";function r(e){var t=this;if(t instanceof r||(t=new r),t.tail=null,t.head=null,t.length=0,e&&"function"===typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var n=0,a=arguments.length;n<a;n++)t.push(arguments[n]);return t}function a(e,t,n){var r=t===e.head?new u(n,null,t,e):new u(n,t,t.next,e);return null===r.next&&(e.tail=r),null===r.prev&&(e.head=r),e.length++,r}function i(e,t){e.tail=new u(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function o(e,t){e.head=new u(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function u(e,t,n,r){if(!(this instanceof u))return new u(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}e.exports=r,r.Node=u,r.create=r,r.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},r.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},r.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},r.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)i(this,arguments[e]);return this.length},r.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},r.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},r.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},r.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},r.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},r.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},r.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},r.prototype.map=function(e,t){t=t||this;for(var n=new r,a=this.head;null!==a;)n.push(e.call(t,a.value,this)),a=a.next;return n},r.prototype.mapReverse=function(e,t){t=t||this;for(var n=new r,a=this.tail;null!==a;)n.push(e.call(t,a.value,this)),a=a.prev;return n},r.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var a=0;null!==r;a++)n=e(n,r.value,a),r=r.next;return n},r.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var a=this.length-1;null!==r;a--)n=e(n,r.value,a),r=r.prev;return n},r.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},r.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},r.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var a=0,i=this.head;null!==i&&a<e;a++)i=i.next;for(;null!==i&&a<t;a++,i=i.next)n.push(i.value);return n},r.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var a=this.length,i=this.tail;null!==i&&a>t;a--)i=i.prev;for(;null!==i&&a>e;a--,i=i.prev)n.push(i.value);return n},r.prototype.splice=function(e,t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,r=this.head;null!==r&&n<e;n++)r=r.next;var i=[];for(n=0;r&&n<t;n++)i.push(r.value),r=this.removeNode(r);null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev);for(n=0;n<(arguments.length<=2?0:arguments.length-2);n++)r=a(this,r,n+2<2||arguments.length<=n+2?void 0:arguments[n+2]);return i},r.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{n(1817)(r)}catch(s){}},7281:function(e,t,n){var r=n(2643);e.exports=function(e,t,n){return r(e,t,">",n)}},8772:function(e,t,n){var r=n(487);e.exports=function(e,t,n){return e=new r(e,n),t=new r(t,n),e.intersects(t)}},5675:function(e,t,n){var r=n(2643);e.exports=function(e,t,n){return r(e,t,"<",n)}},2103:function(e,t,n){var r=n(3298),a=n(487);e.exports=function(e,t,n){var i=null,o=null,u=null;try{u=new a(t,n)}catch(s){return null}return e.forEach((function(e){u.test(e)&&(i&&-1!==o.compare(e)||(o=new r(i=e,n)))})),i}},6088:function(e,t,n){var r=n(3298),a=n(487);e.exports=function(e,t,n){var i=null,o=null,u=null;try{u=new a(t,n)}catch(s){return null}return e.forEach((function(e){u.test(e)&&(i&&1!==o.compare(e)||(o=new r(i=e,n)))})),i}},1219:function(e,t,n){var r=n(3298),a=n(487),i=n(4544);e.exports=function(e,t){e=new a(e,t);var n=new r("0.0.0");if(e.test(n))return n;if(n=new r("0.0.0-0"),e.test(n))return n;n=null;for(var o=function(){var t=e.set[u],a=null;t.forEach((function(e){var t=new r(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":a&&!i(t,a)||(a=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: ".concat(e.operator))}})),!a||n&&!i(n,a)||(n=a)},u=0;u<e.set.length;++u)o();return n&&e.test(n)?n:null}},2643:function(e,t,n){var r=n(3298),a=n(8981),i=a.ANY,o=n(487),u=n(2529),s=n(4544),c=n(4562),l=n(7532),f=n(6310);e.exports=function(e,t,n,d){var h,p,v,g,m;switch(e=new r(e,d),t=new o(t,d),n){case">":h=s,p=l,v=c,g=">",m=">=";break;case"<":h=c,p=f,v=s,g="<",m="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(u(e,t,d))return!1;for(var y=function(){var n=t.set[b],r=null,o=null;return n.forEach((function(e){e.semver===i&&(e=new a(">=0.0.0")),r=r||e,o=o||e,h(e.semver,r.semver,d)?r=e:v(e.semver,o.semver,d)&&(o=e)})),r.operator===g||r.operator===m?{v:!1}:o.operator&&o.operator!==g||!p(e,o.semver)?o.operator===m&&v(e,o.semver)?{v:!1}:void 0:{v:!1}},b=0;b<t.set.length;++b){var x=y();if("object"===typeof x)return x.v}return!0}},4934:function(e,t,n){var r=n(7424).default,a=n(4704).default,i=n(2529),o=n(2384);e.exports=function(e,t,n){var u,s=[],c=null,l=null,f=e.sort((function(e,t){return o(e,t,n)})),d=a(f);try{for(d.s();!(u=d.n()).done;){var h=u.value;i(h,t,n)?(l=h,c||(c=h)):(l&&s.push([c,l]),l=null,c=null)}}catch(w){d.e(w)}finally{d.f()}c&&s.push([c,null]);for(var p=[],v=0,g=s;v<g.length;v++){var m=r(g[v],2),y=m[0],b=m[1];y===b?p.push(y):b||y!==f[0]?b?y===f[0]?p.push("<=".concat(b)):p.push("".concat(y," - ").concat(b)):p.push(">=".concat(y)):p.push("*")}var x=p.join(" || "),k="string"===typeof t.raw?t.raw:String(t);return x.length<k.length?x:t}},6669:function(e,t,n){var r=n(4704).default,a=n(487),i=n(8981),o=i.ANY,u=n(2529),s=n(2384),c=function(e,t,n){if(e===t)return!0;if(1===e.length&&e[0].semver===o){if(1===t.length&&t[0].semver===o)return!0;e=n.includePrerelease?[new i(">=0.0.0-0")]:[new i(">=0.0.0")]}if(1===t.length&&t[0].semver===o){if(n.includePrerelease)return!0;t=[new i(">=0.0.0")]}var a,c,d,h,p=new Set,v=r(e);try{for(v.s();!(d=v.n()).done;){var g=d.value;">"===g.operator||">="===g.operator?a=l(a,g,n):"<"===g.operator||"<="===g.operator?c=f(c,g,n):p.add(g.semver)}}catch(I){v.e(I)}finally{v.f()}if(p.size>1)return null;if(a&&c){if((h=s(a.semver,c.semver,n))>0)return null;if(0===h&&(">="!==a.operator||"<="!==c.operator))return null}var m,y,b,x,k,w=r(p);try{for(w.s();!(m=w.n()).done;){var _=m.value;if(a&&!u(_,String(a),n))return null;if(c&&!u(_,String(c),n))return null;var C,S=r(t);try{for(S.s();!(C=S.n()).done;){var A=C.value;if(!u(_,String(A),n))return!1}}catch(I){S.e(I)}finally{S.f()}return!0}}catch(I){w.e(I)}finally{w.f()}var E=!(!c||n.includePrerelease||!c.semver.prerelease.length)&&c.semver,T=!(!a||n.includePrerelease||!a.semver.prerelease.length)&&a.semver;E&&1===E.prerelease.length&&"<"===c.operator&&0===E.prerelease[0]&&(E=!1);var N,D=r(t);try{for(D.s();!(N=D.n()).done;){var F=N.value;if(k=k||">"===F.operator||">="===F.operator,x=x||"<"===F.operator||"<="===F.operator,a)if(T&&F.semver.prerelease&&F.semver.prerelease.length&&F.semver.major===T.major&&F.semver.minor===T.minor&&F.semver.patch===T.patch&&(T=!1),">"===F.operator||">="===F.operator){if((y=l(a,F,n))===F&&y!==a)return!1}else if(">="===a.operator&&!u(a.semver,String(F),n))return!1;if(c)if(E&&F.semver.prerelease&&F.semver.prerelease.length&&F.semver.major===E.major&&F.semver.minor===E.minor&&F.semver.patch===E.patch&&(E=!1),"<"===F.operator||"<="===F.operator){if((b=f(c,F,n))===F&&b!==c)return!1}else if("<="===c.operator&&!u(c.semver,String(F),n))return!1;if(!F.operator&&(c||a)&&0!==h)return!1}}catch(I){D.e(I)}finally{D.f()}return!(a&&x&&!c&&0!==h)&&(!(c&&k&&!a&&0!==h)&&(!T&&!E))},l=function(e,t,n){if(!e)return t;var r=s(e.semver,t.semver,n);return r>0?e:r<0||">"===t.operator&&">="===e.operator?t:e},f=function(e,t,n){if(!e)return t;var r=s(e.semver,t.semver,n);return r<0?e:r>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e===t)return!0;e=new a(e,n),t=new a(t,n);var i,o=!1,u=r(e.set);try{e:for(u.s();!(i=u.n()).done;){var s,l=i.value,f=r(t.set);try{for(f.s();!(s=f.n()).done;){var d=s.value,h=c(l,d,n);if(o=o||null!==h,h)continue e}}catch(p){f.e(p)}finally{f.f()}if(o)return!1}}catch(p){u.e(p)}finally{u.f()}return!0}},7545:function(e,t,n){var r=n(487);e.exports=function(e,t){return new r(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))}},1383:function(e,t,n){var r=n(487);e.exports=function(e,t){try{return new r(e,t).range||"*"}catch(n){return null}}},8240:function(e,t,n){"use strict";n.r(t),n.d(t,{DEFAULT_ACTIONS:function(){return Nme},default:function(){return Vme},guessMode:function(){return zme},vega:function(){return Ame},vegaLite:function(){return Eme}});var r={};n.r(r),n.d(r,{JsonPatchError:function(){return O},_areEquals:function(){return V},applyOperation:function(){return L},applyPatch:function(){return P},applyReducer:function(){return j},deepClone:function(){return R},getValueByPointer:function(){return z},validate:function(){return W},validator:function(){return U}});var a={};n.r(a),n.d(a,{compare:function(){return Q},generate:function(){return K},observe:function(){return Y},unobserve:function(){return X}});var i={};n.r(i),n.d(i,{aggregate:function(){return ff},bin:function(){return df},collect:function(){return pf},compare:function(){return vf},countpattern:function(){return mf},cross:function(){return yf},density:function(){return wf},dotbin:function(){return Ef},expression:function(){return Tf},extent:function(){return Df},facet:function(){return If},field:function(){return Mf},filter:function(){return Rf},flatten:function(){return Zf},fold:function(){return Bf},formula:function(){return zf},generate:function(){return Lf},impute:function(){return Uf},joinaggregate:function(){return Wf},kde:function(){return Vf},key:function(){return Gf},load:function(){return Hf},lookup:function(){return Yf},multiextent:function(){return Kf},multivalues:function(){return Qf},params:function(){return ed},pivot:function(){return td},prefacet:function(){return nd},project:function(){return rd},proxy:function(){return ad},quantile:function(){return id},relay:function(){return od},sample:function(){return ud},sequence:function(){return sd},sieve:function(){return cd},subflow:function(){return Ff},timeunit:function(){return ld},tupleindex:function(){return dd},values:function(){return hd},window:function(){return yd}});var o={};n.r(o),n.d(o,{interpolate:function(){return Tb},interpolateArray:function(){return xb},interpolateBasis:function(){return ub},interpolateBasisClosed:function(){return sb},interpolateCubehelix:function(){return Rk},interpolateCubehelixLong:function(){return Zk},interpolateDate:function(){return wb},interpolateDiscrete:function(){return Lx},interpolateHcl:function(){return bk},interpolateHclLong:function(){return xk},interpolateHsl:function(){return $x},interpolateHslLong:function(){return Qx},interpolateHue:function(){return Px},interpolateLab:function(){return mk},interpolateNumber:function(){return _b},interpolateNumberArray:function(){return yb},interpolateObject:function(){return Cb},interpolateRgb:function(){return pb},interpolateRgbBasis:function(){return gb},interpolateRgbBasisClosed:function(){return mb},interpolateRound:function(){return Nb},interpolateString:function(){return Eb},interpolateTransformCss:function(){return qx},interpolateTransformSvg:function(){return Hx},interpolateZoom:function(){return Yx},piecewise:function(){return kx},quantize:function(){return Bk}});var u={};n.r(u),n.d(u,{bound:function(){return SE},identifier:function(){return TE},mark:function(){return NE},overlap:function(){return DE},render:function(){return BE},viewlayout:function(){return iT}});var s={};n.r(s),n.d(s,{interpolate:function(){return zT},interpolateArray:function(){return DT},interpolateBasis:function(){return mT},interpolateBasisClosed:function(){return yT},interpolateCubehelix:function(){return CF},interpolateCubehelixLong:function(){return SF},interpolateDate:function(){return IT},interpolateDiscrete:function(){return rF},interpolateHcl:function(){return bF},interpolateHclLong:function(){return xF},interpolateHsl:function(){return vF},interpolateHslLong:function(){return gF},interpolateHue:function(){return aF},interpolateLab:function(){return mF},interpolateNumber:function(){return MT},interpolateNumberArray:function(){return TT},interpolateObject:function(){return OT},interpolateRgb:function(){return CT},interpolateRgbBasis:function(){return AT},interpolateRgbBasisClosed:function(){return ET},interpolateRound:function(){return LT},interpolateString:function(){return BT},interpolateTransformCss:function(){return lF},interpolateTransformSvg:function(){return fF},interpolateZoom:function(){return hF},piecewise:function(){return eF},quantize:function(){return AF}});var c={};n.r(c),n.d(c,{axisticks:function(){return UI},datajoin:function(){return WI},encode:function(){return GI},legendentries:function(){return qI},linkpath:function(){return $I},pie:function(){return nM},scale:function(){return iM},sortitems:function(){return cM},stack:function(){return pM}});var l={};n.r(l),n.d(l,{contour:function(){return $Z},geojson:function(){return eB},geopath:function(){return tB},geopoint:function(){return nB},geoshape:function(){return rB},graticule:function(){return aB},heatmap:function(){return iB},isocontour:function(){return jZ},kde2d:function(){return XZ},projection:function(){return uB}});var f={};n.r(f),n.d(f,{force:function(){return rz}});var d={};n.r(d),n.d(d,{nest:function(){return oL},pack:function(){return dL},partition:function(){return pL},stratify:function(){return vL},tree:function(){return yL},treelinks:function(){return bL},treemap:function(){return wL}});var h={};n.r(h),n.d(h,{label:function(){return Jq}});var p={};n.r(p),n.d(p,{loess:function(){return tH},regression:function(){return rH}});var v={};n.r(v),n.d(v,{voronoi:function(){return NH}});var g={};n.r(g),n.d(g,{interpolate:function(){return EX},interpolateArray:function(){return bX},interpolateBasis:function(){return oX},interpolateBasisClosed:function(){return uX},interpolateCubehelix:function(){return BK},interpolateCubehelixLong:function(){return zK},interpolateDate:function(){return kX},interpolateDiscrete:function(){return fK},interpolateHcl:function(){return EK},interpolateHclLong:function(){return TK},interpolateHsl:function(){return _K},interpolateHslLong:function(){return CK},interpolateHue:function(){return dK},interpolateLab:function(){return SK},interpolateNumber:function(){return wX},interpolateNumberArray:function(){return mX},interpolateObject:function(){return _X},interpolateRgb:function(){return hX},interpolateRgbBasis:function(){return vX},interpolateRgbBasisClosed:function(){return gX},interpolateRound:function(){return TX},interpolateString:function(){return AX},interpolateTransformCss:function(){return yK},interpolateTransformSvg:function(){return bK},interpolateZoom:function(){return kK},piecewise:function(){return iK},quantize:function(){return LK}});var m={};n.r(m),n.d(m,{wordcloud:function(){return rQ}});var y={};n.r(y),n.d(y,{crossfilter:function(){return lQ},resolvefilter:function(){return fQ}});var b={};n.r(b),n.d(b,{Bounds:function(){return KU},CanvasHandler:function(){return EG},CanvasRenderer:function(){return IG},DATE:function(){return Vc},DAY:function(){return Gc},DAYOFYEAR:function(){return qc},Dataflow:function(){return vu},Debug:function(){return we},Error:function(){return be},EventStream:function(){return Yo},Gradient:function(){return rU},GroupItem:function(){return QU},HOURS:function(){return Hc},Handler:function(){return cG},Info:function(){return ke},Item:function(){return $U},MILLISECONDS:function(){return Kc},MINUTES:function(){return Xc},MONTH:function(){return Uc},Marks:function(){return HV},MultiPulse:function(){return su},None:function(){return ye},Operator:function(){return qo},Parameters:function(){return Wo},Pulse:function(){return au},QUARTER:function(){return jc},RenderType:function(){return kq},Renderer:function(){return fG},ResourceLoader:function(){return JU},SECONDS:function(){return Yc},SVGHandler:function(){return OG},SVGRenderer:function(){return aq},SVGStringRenderer:function(){return yq},Scenegraph:function(){return tG},TIME_UNITS:function(){return $c},Transform:function(){return mu},View:function(){return p4},WEEK:function(){return Wc},Warn:function(){return xe},YEAR:function(){return Pc},accessor:function(){return ne},accessorFields:function(){return ae},accessorName:function(){return re},array:function(){return Ye},ascending:function(){return Je},bandwidthNRD:function(){return zu},bin:function(){return Lu},bootstrapCI:function(){return Uu},boundClip:function(){return Nq},boundContext:function(){return xW},boundItem:function(){return XV},boundMark:function(){return KV},boundStroke:function(){return nW},changeset:function(){return jo},clampRange:function(){return Ke},codegenExpression:function(){return L9},compare:function(){return Qe},constant:function(){return rt},cumulativeLogNormal:function(){return rs},cumulativeNormal:function(){return $u},cumulativeUniform:function(){return cs},dayofyear:function(){return al},debounce:function(){return at},defaultLocale:function(){return xj},definition:function(){return bu},densityLogNormal:function(){return ns},densityNormal:function(){return Ku},densityUniform:function(){return ss},domChild:function(){return iG},domClear:function(){return oG},domCreate:function(){return rG},domFind:function(){return aG},dotbin:function(){return Wu},error:function(){return se},expressionFunction:function(){return j2},extend:function(){return it},extent:function(){return ot},extentIndex:function(){return ut},falsy:function(){return ge},fastmap:function(){return ft},field:function(){return le},flush:function(){return dt},font:function(){return LV},fontFamily:function(){return zV},fontSize:function(){return MV},format:function(){return Hj},formatLocale:function(){return dj},formats:function(){return Xj},hasOwnProperty:function(){return ct},id:function(){return fe},identity:function(){return de},inferType:function(){return Pj},inferTypes:function(){return jj},ingest:function(){return Ro},inherits:function(){return ht},inrange:function(){return pt},interpolate:function(){return gI},interpolateColors:function(){return hI},interpolateRange:function(){return dI},intersect:function(){return Cq},intersectBoxLine:function(){return FW},intersectPath:function(){return EW},intersectPoint:function(){return TW},intersectRule:function(){return DW},isArray:function(){return Ce},isBoolean:function(){return vt},isDate:function(){return gt},isFunction:function(){return $e},isIterable:function(){return mt},isNumber:function(){return yt},isObject:function(){return Se},isRegExp:function(){return bt},isString:function(){return xt},isTuple:function(){return Io},key:function(){return kt},lerp:function(){return wt},lineHeight:function(){return OV},loader:function(){return $j},locale:function(){return bj},logger:function(){return _e},lruCache:function(){return _t},markup:function(){return $G},merge:function(){return Ct},mergeConfig:function(){return Ee},multiLineOffset:function(){return ZV},one:function(){return pe},pad:function(){return At},panLinear:function(){return ze},panLog:function(){return Le},panPow:function(){return Pe},panSymlog:function(){return je},parse:function(){return x7},parseExpression:function(){return Z9},parseSelector:function(){return q9},pathCurves:function(){return iU},pathEqual:function(){return Fq},pathParse:function(){return sU},pathRectangle:function(){return IU},pathRender:function(){return bU},pathSymbols:function(){return _U},pathTrail:function(){return MU},peek:function(){return De},point:function(){return sG},projection:function(){return EZ},quantileLogNormal:function(){return as},quantileNormal:function(){return Qu},quantileUniform:function(){return ls},quantiles:function(){return Zu},quantizeInterpolator:function(){return pI},quarter:function(){return He},quartiles:function(){return Bu},random:function(){return Pu},randomInteger:function(){return Gu},randomKDE:function(){return es},randomLCG:function(){return Vu},randomLogNormal:function(){return is},randomMixture:function(){return os},randomNormal:function(){return Ju},randomUniform:function(){return fs},read:function(){return Kj},regressionExp:function(){return ys},regressionLinear:function(){return gs},regressionLoess:function(){return _s},regressionLog:function(){return ms},regressionPoly:function(){return ks},regressionPow:function(){return bs},regressionQuad:function(){return xs},renderModule:function(){return _q},repeat:function(){return St},resetDefaultLocale:function(){return kj},resetSVGClipId:function(){return XU},resetSVGDefIds:function(){return Iq},responseType:function(){return Yj},runtimeContext:function(){return m3},sampleCurve:function(){return Es},sampleLogNormal:function(){return ts},sampleNormal:function(){return Yu},sampleUniform:function(){return us},scale:function(){return nI},sceneEqual:function(){return Dq},sceneFromJSON:function(){return JV},scenePickVisit:function(){return UW},sceneToJSON:function(){return QV},sceneVisit:function(){return jW},sceneZOrder:function(){return PW},scheme:function(){return xI},serializeXML:function(){return QG},setRandom:function(){return ju},span:function(){return Et},splitAccessPath:function(){return ce},stringValue:function(){return Tt},textMetrics:function(){return EV},timeBin:function(){return Xl},timeFloor:function(){return xl},timeFormatLocale:function(){return mj},timeInterval:function(){return Al},timeOffset:function(){return Nl},timeSequence:function(){return Il},timeUnitSpecifier:function(){return tl},timeUnits:function(){return Jc},toBoolean:function(){return Nt},toDate:function(){return Ft},toNumber:function(){return Fe},toSet:function(){return Mt},toString:function(){return It},transform:function(){return xu},transforms:function(){return yu},truncate:function(){return Ot},truthy:function(){return ve},tupleid:function(){return Mo},typeParsers:function(){return Bj},utcFloor:function(){return _l},utcInterval:function(){return El},utcOffset:function(){return Dl},utcSequence:function(){return Ml},utcdayofyear:function(){return ll},utcquarter:function(){return Xe},utcweek:function(){return fl},version:function(){return $9},visitArray:function(){return Rt},week:function(){return il},writeConfig:function(){return Te},zero:function(){return he},zoomLinear:function(){return We},zoomLog:function(){return Ve},zoomPow:function(){return Ge},zoomSymlog:function(){return qe}});var x={};n.r(x),n.d(x,{compile:function(){return hge},extractTransforms:function(){return yge},normalize:function(){return qse},version:function(){return bge}});var k={};n.r(k),n.d(k,{dark:function(){return Cge},excel:function(){return Age},fivethirtyeight:function(){return Fge},ggplot2:function(){return Mge},googlecharts:function(){return eme},latimes:function(){return Lge},powerbi:function(){return hme},quartz:function(){return Uge},urbaninstitute:function(){return Kge},version:function(){return pme},vox:function(){return Vge}});var w=n(4165),_=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),C=Object.prototype.hasOwnProperty;function S(e,t){return C.call(e,t)}function A(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var a in e)S(e,a)&&r.push(a);return r}function E(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function T(e){for(var t,n=0,r=e.length;n<r;){if(!((t=e.charCodeAt(n))>=48&&t<=57))return!1;n++}return!0}function N(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function D(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function F(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(F(e[t]))return!0}else if("object"===typeof e)for(var r=A(e),a=r.length,i=0;i<a;i++)if(F(e[r[i]]))return!0;return!1}function I(e,t){var n=[e];for(var r in t){var a="object"===typeof t[r]?JSON.stringify(t[r],null,2):t[r];"undefined"!==typeof a&&n.push(r+": "+a)}return n.join("\n")}var M=function(e){function t(t,n,r,a,i){var o=this.constructor,u=e.call(this,I(t,{name:n,index:r,operation:a,tree:i}))||this;return u.name=n,u.index=r,u.operation=a,u.tree=i,Object.setPrototypeOf(u,o.prototype),u.message=I(t,{name:n,index:r,operation:a,tree:i}),u}return _(t,e),t}(Error),O=M,R=E,Z={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=z(n,this.path);r&&(r=E(r));var a=L(n,{op:"remove",path:this.from}).removed;return L(n,{op:"add",path:this.path,value:a}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=z(n,this.from);return L(n,{op:"add",path:this.path,value:E(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:V(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},B={add:function(e,t,n){return T(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:Z.move,copy:Z.copy,test:Z.test,_get:Z._get};function z(e,t){if(""==t)return e;var n={op:"_get",path:t};return L(e,n),n.value}function L(e,t,n,r,a,i){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===a&&(a=!0),void 0===i&&(i=0),n&&("function"==typeof n?n(t,0,e,t.path):U(t,0)),""===t.path){var o={newDocument:e};if("add"===t.op)return o.newDocument=t.value,o;if("replace"===t.op)return o.newDocument=t.value,o.removed=e,o;if("move"===t.op||"copy"===t.op)return o.newDocument=z(e,t.from),"move"===t.op&&(o.removed=e),o;if("test"===t.op){if(o.test=V(e,t.value),!1===o.test)throw new O("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return o.newDocument=e,o}if("remove"===t.op)return o.removed=e,o.newDocument=null,o;if("_get"===t.op)return t.value=e,o;if(n)throw new O("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,t,e);return o}r||(e=E(e));var u=(t.path||"").split("/"),s=e,c=1,l=u.length,f=void 0,d=void 0,h=void 0;for(h="function"==typeof n?n:U;;){if((d=u[c])&&-1!=d.indexOf("~")&&(d=D(d)),a&&("__proto__"==d||"prototype"==d&&c>0&&"constructor"==u[c-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===f&&(void 0===s[d]?f=u.slice(0,c).join("/"):c==l-1&&(f=t.path),void 0!==f&&h(t,0,e,f)),c++,Array.isArray(s)){if("-"===d)d=s.length;else{if(n&&!T(d))throw new O("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,t,e);T(d)&&(d=~~d)}if(c>=l){if(n&&"add"===t.op&&d>s.length)throw new O("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,t,e);if(!1===(o=B[t.op].call(t,s,d,e)).test)throw new O("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return o}}else if(c>=l){if(!1===(o=Z[t.op].call(t,s,d,e)).test)throw new O("Test operation failed","TEST_OPERATION_FAILED",i,t,e);return o}if(s=s[d],n&&c<l&&(!s||"object"!==typeof s))throw new O("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",i,t,e)}}function P(e,t,n,r,a){if(void 0===r&&(r=!0),void 0===a&&(a=!0),n&&!Array.isArray(t))throw new O("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(e=E(e));for(var i=new Array(t.length),o=0,u=t.length;o<u;o++)i[o]=L(e,t[o],n,!0,a,o),e=i[o].newDocument;return i.newDocument=e,i}function j(e,t,n){var r=L(e,t);if(!1===r.test)throw new O("Test operation failed","TEST_OPERATION_FAILED",n,t,e);return r.newDocument}function U(e,t,n,r){if("object"!==typeof e||null===e||Array.isArray(e))throw new O("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!Z[e.op])throw new O("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!==typeof e.path)throw new O("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new O('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!==typeof e.from)throw new O("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new O("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&F(e.value))throw new O("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var a=e.path.split("/").length,i=r.split("/").length;if(a!==i+1&&a!==i)throw new O("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==r)throw new O("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var o=W([{op:"_get",path:e.from,value:void 0}],n);if(o&&"OPERATION_PATH_UNRESOLVABLE"===o.name)throw new O("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function W(e,t,n){try{if(!Array.isArray(e))throw new O("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)P(E(t),E(e),n||!0);else{n=n||U;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(a){if(a instanceof O)return a;throw a}}function V(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,r,a,i=Array.isArray(e),o=Array.isArray(t);if(i&&o){if((r=e.length)!=t.length)return!1;for(n=r;0!==n--;)if(!V(e[n],t[n]))return!1;return!0}if(i!=o)return!1;var u=Object.keys(e);if((r=u.length)!==Object.keys(t).length)return!1;for(n=r;0!==n--;)if(!t.hasOwnProperty(u[n]))return!1;for(n=r;0!==n--;)if(!V(e[a=u[n]],t[a]))return!1;return!0}return e!==e&&t!==t}var G=new WeakMap,q=function(e){this.observers=new Map,this.obj=e},H=function(e,t){this.callback=e,this.observer=t};function X(e,t){t.unobserve()}function Y(e,t){var n,r=function(e){return G.get(e)}(e);if(r){var a=function(e,t){return e.observers.get(t)}(r,t);n=a&&a.observer}else r=new q(e),G.set(e,r);if(n)return n;if(n={},r.value=E(e),t){n.callback=t,n.next=null;var i=function(){K(n)},o=function(){clearTimeout(n.next),n.next=setTimeout(i)};"undefined"!==typeof window&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return n.patches=[],n.object=e,n.unobserve=function(){K(n),clearTimeout(n.next),function(e,t){e.observers.delete(t.callback)}(r,n),"undefined"!==typeof window&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},r.observers.set(t,new H(t,n)),n}function K(e,t){void 0===t&&(t=!1);var n=G.get(e.object);$(n.value,e.object,e.patches,"",t),e.patches.length&&P(n.value,e.patches);var r=e.patches;return r.length>0&&(e.patches=[],e.callback&&e.callback(r)),r}function $(e,t,n,r,a){if(t!==e){"function"===typeof t.toJSON&&(t=t.toJSON());for(var i=A(t),o=A(e),u=!1,s=o.length-1;s>=0;s--){var c=e[f=o[s]];if(!S(t,f)||void 0===t[f]&&void 0!==c&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(a&&n.push({op:"test",path:r+"/"+N(f),value:E(c)}),n.push({op:"remove",path:r+"/"+N(f)}),u=!0):(a&&n.push({op:"test",path:r,value:e}),n.push({op:"replace",path:r,value:t}),!0);else{var l=t[f];"object"==typeof c&&null!=c&&"object"==typeof l&&null!=l&&Array.isArray(c)===Array.isArray(l)?$(c,l,n,r+"/"+N(f),a):c!==l&&(!0,a&&n.push({op:"test",path:r+"/"+N(f),value:E(c)}),n.push({op:"replace",path:r+"/"+N(f),value:E(l)}))}}if(u||i.length!=o.length)for(s=0;s<i.length;s++){var f;S(e,f=i[s])||void 0===t[f]||n.push({op:"add",path:r+"/"+N(f),value:E(t[f])})}}}function Q(e,t,n){void 0===n&&(n=!1);var r=[];return $(e,t,r,"",n),r}Object.assign({},r,a,{JsonPatchError:M,deepClone:E,escapePathComponent:N,unescapePathComponent:D});var J=n(3333),ee=n.n(J),te=n(724);function ne(e,t,n){return e.fields=t||[],e.fname=n,e}function re(e){return null==e?null:e.fname}function ae(e){return null==e?null:e.fields}function ie(e){return 1===e.length?oe(e[0]):ue(e)}var oe=function(e){return function(t){return t[e]}},ue=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function se(e){throw Error(e)}function ce(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n),s+=e.substring(++n,++n),t=n;else if(r===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&c(),u=t=n+1):"]"===r&&(u||se("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&se("Access path missing closing bracket: "+e),o&&se("Access path missing closing quote: "+e),n>t&&(n++,c()),a}function le(e,t,n){var r=ce(e);return e=1===r.length?r[0]:e,ne((n&&n.get||ie)(r),[e],t||e)}var fe=le("id"),de=ne((function(e){return e}),[],"identity"),he=ne((function(){return 0}),[],"zero"),pe=ne((function(){return 1}),[],"one"),ve=ne((function(){return!0}),[],"true"),ge=ne((function(){return!1}),[],"false");function me(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var ye=0,be=1,xe=2,ke=3,we=4;function _e(e,t){var n=e||ye;return{level:function(e){return arguments.length?(n=+e,this):n},error:function(){return n>=be&&me(t||"error","ERROR",arguments),this},warn:function(){return n>=xe&&me(t||"warn","WARN",arguments),this},info:function(){return n>=ke&&me(t||"log","INFO",arguments),this},debug:function(){return n>=we&&me(t||"log","DEBUG",arguments),this}}}var Ce=Array.isArray;function Se(e){return e===Object(e)}var Ae=function(e){return"__proto__"!==e};function Ee(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){for(var n in t)if("signals"===n)e.signals=Ne(e.signals,t.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;Te(e,n,t[n],r)}return e}),{})}function Te(e,t,n,r){var a,i;if(Ae(t))if(Se(n)&&!Ce(n))for(a in i=Se(e[t])?e[t]:e[t]={},n)r&&(!0===r||r[a])?Te(i,a,n[a]):Ae(a)&&(i[a]=n[a]);else e[t]=n}function Ne(e,t){if(null==e)return t;var n={},r=[];function a(e){n[e.name]||(n[e.name]=1,r.push(e))}return t.forEach(a),e.forEach(a),r}function De(e){return e[e.length-1]}function Fe(e){return null==e||""===e?null:+e}var Ie=function(e){return function(t){return e*Math.exp(t)}},Me=function(e){return function(t){return Math.log(e*t)}},Oe=function(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}},Re=function(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}},Ze=function(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}};function Be(e,t,n,r){var a=n(e[0]),i=n(De(e)),o=(i-a)*t;return[r(a-o),r(i-o)]}function ze(e,t){return Be(e,t,Fe,de)}function Le(e,t){var n=Math.sign(e[0]);return Be(e,t,Me(n),Ie(n))}function Pe(e,t,n){return Be(e,t,Ze(n),Ze(1/n))}function je(e,t,n){return Be(e,t,Oe(n),Re(n))}function Ue(e,t,n,r,a){var i=r(e[0]),o=r(De(e)),u=null!=t?r(t):(i+o)/2;return[a(u+(i-u)*n),a(u+(o-u)*n)]}function We(e,t,n){return Ue(e,t,n,Fe,de)}function Ve(e,t,n){var r=Math.sign(e[0]);return Ue(e,t,n,Me(r),Ie(r))}function Ge(e,t,n,r){return Ue(e,t,n,Ze(r),Ze(1/r))}function qe(e,t,n,r){return Ue(e,t,n,Oe(r),Re(r))}function He(e){return 1+~~(new Date(e).getMonth()/3)}function Xe(e){return 1+~~(new Date(e).getUTCMonth()/3)}function Ye(e){return null!=e?Ce(e)?e:[e]:[]}function Ke(e,t,n){var r,a=e[0],i=e[1];return i<a&&(r=i,i=a,a=r),(r=i-a)>=n-t?[t,n]:[a=Math.min(Math.max(a,t),n-r),a+r]}function $e(e){return"function"===typeof e}function Qe(e,t,n){n=n||{},t=Ye(t)||[];var r=[],a=[],i={},o=n.comparator||et;return Ye(e).forEach((function(e,o){null!=e&&(r.push("descending"===t[o]?-1:1),a.push(e=$e(e)?e:le(e,null,n)),(ae(e)||[]).forEach((function(e){return i[e]=1})))})),0===a.length?null:ne(o(a,r),Object.keys(i))}var Je=function(e,t){return(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0)},et=function(e,t){return 1===e.length?tt(e[0],t[0]):nt(e,t,e.length)},tt=function(e,t){return function(n,r){return Je(e(n),e(r))*t}},nt=function(e,t,n){return t.push(0),function(r,a){for(var i,o=0,u=-1;0===o&&++u<n;)i=e[u],o=Je(i(r),i(a));return o*t[u]}};function rt(e){return $e(e)?e:function(){return e}}function at(e,t){var n;return function(r){n&&clearTimeout(n),n=setTimeout((function(){return t(r),n=null}),e)}}function it(e){for(var t,n,r=1,a=arguments.length;r<a;++r)for(n in t=arguments[r])e[n]=t[n];return e}function ot(e,t){var n,r,a,i,o=0;if(e&&(n=e.length))if(null==t){for(r=e[o];o<n&&(null==r||r!==r);r=e[++o]);for(a=i=r;o<n;++o)null!=(r=e[o])&&(r<a&&(a=r),r>i&&(i=r))}else{for(r=t(e[o]);o<n&&(null==r||r!==r);r=t(e[++o]));for(a=i=r;o<n;++o)null!=(r=t(e[o]))&&(r<a&&(a=r),r>i&&(i=r))}return[a,i]}function ut(e,t){var n,r,a,i,o,u=e.length,s=-1;if(null==t){for(;++s<u;)if(null!=(r=e[s])&&r>=r){n=a=r;break}if(s===u)return[-1,-1];for(i=o=s;++s<u;)null!=(r=e[s])&&(n>r&&(n=r,i=s),a<r&&(a=r,o=s))}else{for(;++s<u;)if(null!=(r=t(e[s],s,e))&&r>=r){n=a=r;break}if(s===u)return[-1,-1];for(i=o=s;++s<u;)null!=(r=t(e[s],s,e))&&(n>r&&(n=r,i=s),a<r&&(a=r,o=s))}return[i,o]}var st=Object.prototype.hasOwnProperty;function ct(e,t){return st.call(e,t)}var lt={};function ft(e){var t,n={};function r(e){return ct(n,e)&&n[e]!==lt}var a={size:0,empty:0,object:n,has:r,get:function(e){return r(e)?n[e]:void 0},set:function(e,t){return r(e)||(++a.size,n[e]===lt&&--a.empty),n[e]=t,this},delete:function(e){return r(e)&&(--a.size,++a.empty,n[e]=lt),this},clear:function(){a.size=a.empty=0,a.object=n={}},test:function(e){return arguments.length?(t=e,a):t},clean:function(){var e={},r=0;for(var i in n){var o=n[i];o===lt||t&&t(o)||(e[i]=o,++r)}a.size=r,a.empty=0,a.object=n=e}};return e&&Object.keys(e).forEach((function(t){a.set(t,e[t])})),a}function dt(e,t,n,r,a,i){if(!n&&0!==n)return i;var o,u=+n,s=e[0],c=De(e);c<s&&(o=s,s=c,c=o),o=Math.abs(t-s);var l=Math.abs(c-t);return o<l&&o<=u?r:l<=u?a:i}function ht(e,t,n){var r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),it(r,n)}function pt(e,t,n,r){var a,i=t[0],o=t[t.length-1];return i>o&&(a=i,i=o,o=a),r=void 0===r||r,((n=void 0===n||n)?i<=e:i<e)&&(r?e<=o:e<o)}function vt(e){return"boolean"===typeof e}function gt(e){return"[object Date]"===Object.prototype.toString.call(e)}function mt(e){return e&&$e(e[Symbol.iterator])}function yt(e){return"number"===typeof e}function bt(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function xt(e){return"string"===typeof e}function kt(e,t,n){e&&(e=t?Ye(e).map((function(e){return e.replace(/\\(.)/g,"$1")})):Ye(e));var r,a=e&&e.length,i=n&&n.get||ie,o=function(e){return i(t?[e]:ce(e))};if(a)if(1===a){var u=o(e[0]);r=function(e){return""+u(e)}}else{var s=e.map(o);r=function(e){for(var t=""+s[0](e),n=0;++n<a;)t+="|"+s[n](e);return t}}else r=function(){return""};return ne(r,e,"key")}function wt(e,t){var n=e[0],r=De(e),a=+t;return a?1===a?r:n+a*(r-n):n}function _t(e){var t,n,r;e=+e||1e4;var a=function(){t={},n={},r=0},i=function(a,i){return++r>e&&(n=t,t={},r=1),t[a]=i};return a(),{clear:a,has:function(e){return ct(t,e)||ct(n,e)},get:function(e){return ct(t,e)?t[e]:ct(n,e)?i(e,n[e]):void 0},set:function(e,n){return ct(t,e)?t[e]=n:i(e,n)}}}function Ct(e,t,n,r){var a=t.length,i=n.length;if(!i)return t;if(!a)return n;for(var o=r||new t.constructor(a+i),u=0,s=0,c=0;u<a&&s<i;++c)o[c]=e(t[u],n[s])>0?n[s++]:t[u++];for(;u<a;++u,++c)o[c]=t[u];for(;s<i;++s,++c)o[c]=n[s];return o}function St(e,t){for(var n="";--t>=0;)n+=e;return n}function At(e,t,n,r){var a=n||" ",i=e+"",o=t-i.length;return o<=0?i:"left"===r?St(a,o)+i:"center"===r?St(a,~~(o/2))+i+St(a,Math.ceil(o/2)):i+St(a,o)}function Et(e){return e&&De(e)-e[0]||0}function Tt(e){return Ce(e)?"["+e.map(Tt)+"]":Se(e)||xt(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Nt(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e)&&!!e}var Dt=function(e){return yt(e)||gt(e)?e:Date.parse(e)};function Ft(e,t){return t=t||Dt,null==e||""===e?null:t(e)}function It(e){return null==e||""===e?null:e+""}function Mt(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return t}function Ot(e,t,n,r){var a=null!=r?r:"\u2026",i=e+"",o=i.length,u=Math.max(0,t-a.length);return o<=t?i:"left"===n?a+i.slice(o-u):"center"===n?i.slice(0,Math.ceil(u/2))+a+i.slice(o-~~(u/2)):i.slice(0,u)+a}function Rt(e,t,n){if(e)if(t)for(var r=e.length,a=0;a<r;++a){var i=t(e[a]);i&&n(i,a,e)}else e.forEach(n)}var Zt=n(7762),Bt=n(5861);function zt(e,t,n){return e.fields=t||[],e.fname=n,e}function Lt(e){return 1===e.length?Pt(e[0]):jt(e)}var Pt=function(e){return function(t){return t[e]}},jt=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function Ut(e){throw Error(e)}function Wt(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n),s+=e.substring(++n,++n),t=n;else if(r===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&c(),u=t=n+1):"]"===r&&(u||Ut("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&Ut("Access path missing closing bracket: "+e),o&&Ut("Access path missing closing quote: "+e),n>t&&(n++,c()),a}function Vt(e,t,n){var r=Wt(e);return e=1===r.length?r[0]:e,zt((n&&n.get||Lt)(r),[e],t||e)}var Gt=Vt("id"),qt=zt((function(e){return e}),[],"identity"),Ht=(zt((function(){return 0}),[],"zero"),zt((function(){return 1}),[],"one"),zt((function(){return!0}),[],"true"));zt((function(){return!1}),[],"false");function Xt(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var Yt=Array.isArray;function Kt(e){return e===Object(e)}function $t(e){return null==e||""===e?null:+e}function Qt(e){return null!=e?Yt(e)?e:[e]:[]}function Jt(e){return"function"===typeof e}function en(e){return Jt(e)?e:function(){return e}}function tn(e){for(var t,n,r=1,a=arguments.length;r<a;++r)for(n in t=arguments[r])e[n]=t[n];return e}var nn=Object.prototype.hasOwnProperty;function rn(e,t){return nn.call(e,t)}function an(e,t,n){var r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),tn(r,n)}function on(e){return"string"===typeof e}function un(e){return Yt(e)?"["+e.map(un)+"]":Kt(e)||on(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}var sn=function(e){return function(e){return"number"===typeof e}(e)||function(e){return"[object Date]"===Object.prototype.toString.call(e)}(e)?e:Date.parse(e)};function cn(e,t,n){if(e)if(t)for(var r=e.length,a=0;a<r;++a){var i=t(e[a]);i&&n(i,a,e)}else e.forEach(n)}var ln=n(3433),fn={},dn={};function hn(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function pn(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function vn(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function gn(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),a=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":function(e){return e<0?"-"+vn(-e,6):e>9999?"+"+vn(e,6):vn(e,4)}(e.getUTCFullYear())+"-"+vn(e.getUTCMonth()+1,2)+"-"+vn(e.getUTCDate(),2)+(a?"T"+vn(t,2)+":"+vn(n,2)+":"+vn(r,2)+"."+vn(a,3)+"Z":r?"T"+vn(t,2)+":"+vn(n,2)+":"+vn(r,2)+"Z":n||t?"T"+vn(t,2)+":"+vn(n,2)+"Z":"")}function mn(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,a=[],i=e.length,o=0,u=0,s=i<=0,c=!1;function l(){if(s)return dn;if(c)return c=!1,fn;var t,r,a=o;if(34===e.charCodeAt(a)){for(;o++<i&&34!==e.charCodeAt(o)||34===e.charCodeAt(++o););return(t=o)>=i?s=!0:10===(r=e.charCodeAt(o++))?c=!0:13===r&&(c=!0,10===e.charCodeAt(o)&&++o),e.slice(a+1,t-1).replace(/""/g,'"')}for(;o<i;){if(10===(r=e.charCodeAt(t=o++)))c=!0;else if(13===r)c=!0,10===e.charCodeAt(o)&&++o;else if(r!==n)continue;return e.slice(a,t)}return s=!0,e.slice(a,i)}for(10===e.charCodeAt(i-1)&&--i,13===e.charCodeAt(i-1)&&--i;(r=l())!==dn;){for(var f=[];r!==fn&&r!==dn;)f.push(r),r=l();t&&null==(f=t(f,u++))||a.push(f)}return a}function a(t,n){return t.map((function(t){return n.map((function(e){return o(t[e])})).join(e)}))}function i(t){return t.map(o).join(e)}function o(e){return null==e?"":e instanceof Date?gn(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,a,i=r(e,(function(e,r){if(n)return n(e,r-1);a=e,n=t?function(e,t){var n=hn(e);return function(r,a){return t(n(r),a,e)}}(e,t):hn(e)}));return i.columns=a||[],i},parseRows:r,format:function(t,n){return null==n&&(n=pn(t)),[n.map(o).join(e)].concat(a(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=pn(e)),a(e,t).join("\n")},formatRows:function(e){return e.map(i).join("\n")},formatRow:i,formatValue:o}}function yn(e){return e}function bn(e,t){return"string"===typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map((function(t){return xn(e,t)}))}:xn(e,t)}function xn(e,t){var n=t.id,r=t.bbox,a=null==t.properties?{}:t.properties,i=kn(e,t);return null==n&&null==r?{type:"Feature",properties:a,geometry:i}:null==r?{type:"Feature",id:n,properties:a,geometry:i}:{type:"Feature",id:n,bbox:r,properties:a,geometry:i}}function kn(e,t){var n=function(e){if(null==e)return yn;var t,n,r=e.scale[0],a=e.scale[1],i=e.translate[0],o=e.translate[1];return function(e,u){u||(t=n=0);var s=2,c=e.length,l=new Array(c);for(l[0]=(t+=e[0])*r+i,l[1]=(n+=e[1])*a+o;s<c;)l[s]=e[s],++s;return l}}(e.transform),r=e.arcs;function a(e,t){t.length&&t.pop();for(var a=r[e<0?~e:e],i=0,o=a.length;i<o;++i)t.push(n(a[i],i));e<0&&function(e,t){for(var n,r=e.length,a=r-t;a<--r;)n=e[a],e[a++]=e[r],e[r]=n}(t,o)}function i(e){return n(e)}function o(e){for(var t=[],n=0,r=e.length;n<r;++n)a(e[n],t);return t.length<2&&t.push(t[0]),t}function u(e){for(var t=o(e);t.length<4;)t.push(t[0]);return t}function s(e){return e.map(u)}return function e(t){var n,r=t.type;switch(r){case"GeometryCollection":return{type:r,geometries:t.geometries.map(e)};case"Point":n=i(t.coordinates);break;case"MultiPoint":n=t.coordinates.map(i);break;case"LineString":n=o(t.arcs);break;case"MultiLineString":n=t.arcs.map(o);break;case"Polygon":n=s(t.arcs);break;case"MultiPolygon":n=t.arcs.map(s);break;default:return null}return{type:r,coordinates:n}}(t)}function wn(e,t){var n={},r={},a={},i=[],o=-1;function u(e,t){for(var r in e){var a=e[r];delete t[a.start],delete a.start,delete a.end,a.forEach((function(e){n[e<0?~e:e]=1})),i.push(a)}}return t.forEach((function(n,r){var a,i=e.arcs[n<0?~n:n];i.length<3&&!i[1][0]&&!i[1][1]&&(a=t[++o],t[o]=n,t[r]=a)})),t.forEach((function(t){var n,i,o=function(t){var n,r=e.arcs[t<0?~t:t],a=r[0];e.transform?(n=[0,0],r.forEach((function(e){n[0]+=e[0],n[1]+=e[1]}))):n=r[r.length-1];return t<0?[n,a]:[a,n]}(t),u=o[0],s=o[1];if(n=a[u])if(delete a[n.end],n.push(t),n.end=s,i=r[s]){delete r[i.start];var c=i===n?n:n.concat(i);r[c.start=n.start]=a[c.end=i.end]=c}else r[n.start]=a[n.end]=n;else if(n=r[s])if(delete r[n.start],n.unshift(t),n.start=u,i=a[u]){delete a[i.end];var l=i===n?n:i.concat(n);r[l.start=i.start]=a[l.end=n.end]=l}else r[n.start]=a[n.end]=n;else r[(n=[t]).start=u]=a[n.end=s]=n})),u(a,r),u(r,a),t.forEach((function(e){n[e<0?~e:e]||i.push([e])})),i}function _n(e){return kn(e,Cn.apply(this,arguments))}function Cn(e,t,n){var r,a,i;if(arguments.length>1)r=Sn(e,t,n);else for(a=0,r=new Array(i=e.arcs.length);a<i;++a)r[a]=a;return{type:"MultiLineString",arcs:wn(e,r)}}function Sn(e,t,n){var r,a=[],i=[];function o(e){var t=e<0?~e:e;(i[t]||(i[t]=[])).push({i:e,g:r})}function u(e){e.forEach(o)}function s(e){e.forEach(u)}return function e(t){switch(r=t,t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"LineString":u(t.arcs);break;case"MultiLineString":case"Polygon":s(t.arcs);break;case"MultiPolygon":!function(e){e.forEach(s)}(t.arcs)}}(t),i.forEach(null==n?function(e){a.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&a.push(e[0].i)}),a}var An=Math.sqrt(50),En=Math.sqrt(10),Tn=Math.sqrt(2);function Nn(e,t,n){var r,a,i,o=(t-e)/Math.max(0,n),u=Math.floor(Math.log10(o)),s=o/Math.pow(10,u),c=s>=An?10:s>=En?5:s>=Tn?2:1;return u<0?(i=Math.pow(10,-u)/c,(r=Math.round(e*i))/i<e&&++r,(a=Math.round(t*i))/i>t&&--a,i=-i):(i=Math.pow(10,u)*c,(r=Math.round(e/i))*i<e&&++r,(a=Math.round(t/i))*i>t&&--a),a<r&&.5<=n&&n<2?Nn(e,t,2*n):[r,a,i]}function Dn(e,t,n){return Nn(e=+e,t=+t,n=+n)[2]}var Fn,In=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Mn(e){if(!(t=In.exec(e)))throw new Error("invalid format: "+e);var t;return new On({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function On(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Rn(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Zn(e){return(e=Rn(Math.abs(e)))?e[1]:NaN}function Bn(e,t){var n=Rn(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}Mn.prototype=On.prototype,On.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var zn={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return Bn(100*e,t)},r:Bn,s:function(e,t){var n=Rn(e,t);if(!n)return e+"";var r=n[0],a=n[1],i=a-(Fn=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+Rn(e,Math.max(0,t+i-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function Ln(e){return e}var Pn,jn,Un,Wn=Array.prototype.map,Vn=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Gn(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?Ln:(t=Wn.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var a=e.length,i=[],o=0,u=t[0],s=0;a>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),i.push(e.substring(a-=u,a+u)),!((s+=u+1)>r));)u=t[o=(o+1)%t.length];return i.reverse().join(n)}),a=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",u=void 0===e.numerals?Ln:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Wn.call(e.numerals,String)),s=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",l=void 0===e.nan?"NaN":e.nan+"";function f(e){var t=(e=Mn(e)).fill,n=e.align,f=e.sign,d=e.symbol,h=e.zero,p=e.width,v=e.comma,g=e.precision,m=e.trim,y=e.type;"n"===y?(v=!0,y="g"):zn[y]||(void 0===g&&(g=12),m=!0,y="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var b="$"===d?a:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===d?i:/[%p]/.test(y)?s:"",k=zn[y],w=/[defgprs%]/.test(y);function _(e){var a,i,s,d=b,_=x;if("c"===y)_=k(e)+_,e="";else{var C=(e=+e)<0||1/e<0;if(e=isNaN(e)?l:k(Math.abs(e),g),m&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),C&&0===+e&&"+"!==f&&(C=!1),d=(C?"("===f?f:c:"-"===f||"("===f?"":f)+d,_=("s"===y?Vn[8+Fn/3]:"")+_+(C&&"("===f?")":""),w)for(a=-1,i=e.length;++a<i;)if(48>(s=e.charCodeAt(a))||s>57){_=(46===s?o+e.slice(a+1):e.slice(a))+_,e=e.slice(0,a);break}}v&&!h&&(e=r(e,1/0));var S=d.length+e.length+_.length,A=S<p?new Array(p-S+1).join(t):"";switch(v&&h&&(e=r(A+e,A.length?p-_.length:1/0),A=""),n){case"<":e=d+e+_+A;break;case"=":e=d+A+e+_;break;case"^":e=A.slice(0,S=A.length>>1)+d+e+_+A.slice(S);break;default:e=A+d+e+_}return u(e)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),_.toString=function(){return e+""},_}return{format:f,formatPrefix:function(e,t){var n=f(((e=Mn(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Zn(t)/3))),a=Math.pow(10,-r),i=Vn[8+r/3];return function(e){return n(a*e)+i}}}}!function(e){Pn=Gn(e),jn=Pn.format,Un=Pn.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});var qn=n(4942),Hn=new Date,Xn=new Date;function Yn(e,t,n,r){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=function(t){return e(t=new Date(+t)),t},a.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},a.round=function(e){var t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},a.range=function(n,r,i){var o,u=[];if(n=a.ceil(n),i=null==i?1:Math.floor(i),!(n<r)||!(i>0))return u;do{u.push(o=new Date(+n)),t(n,i),e(n)}while(o<n&&n<r);return u},a.filter=function(n){return Yn((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(a.count=function(t,r){return Hn.setTime(+t),Xn.setTime(+r),e(Hn),e(Xn),Math.floor(n(Hn,Xn))},a.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?function(t){return r(t)%e===0}:function(t){return a.count(0,t)%e===0}):a:null}),a}var Kn=1e3,$n=6e4,Qn=36e5,Jn=864e5,er=6048e5,tr=Yn((function(e){return e.setHours(0,0,0,0)}),(function(e,t){return e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*$n)/Jn}),(function(e){return e.getDate()-1})),nr=(tr.range,Yn((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/Jn}),(function(e){return e.getUTCDate()-1}))),rr=(nr.range,Yn((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/Jn}),(function(e){return Math.floor(e/Jn)})));rr.range;function ar(e){return Yn((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*$n)/er}))}var ir=ar(0),or=ar(1),ur=ar(2),sr=ar(3),cr=ar(4),lr=ar(5),fr=ar(6);ir.range,or.range,ur.range,sr.range,cr.range,lr.range,fr.range;function dr(e){return Yn((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/er}))}var hr=dr(0),pr=dr(1),vr=dr(2),gr=dr(3),mr=dr(4),yr=dr(5),br=dr(6),xr=(hr.range,pr.range,vr.range,gr.range,mr.range,yr.range,br.range,Yn((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()})));xr.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Yn((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};xr.range;var kr=Yn((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));kr.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Yn((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};kr.range;var wr=Yn((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),_r=(wr.range,Yn((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()}))),Cr=(_r.range,Yn((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Kn-e.getMinutes()*$n)}),(function(e,t){e.setTime(+e+t*Qn)}),(function(e,t){return(t-e)/Qn}),(function(e){return e.getHours()}))),Sr=(Cr.range,Yn((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*Qn)}),(function(e,t){return(t-e)/Qn}),(function(e){return e.getUTCHours()}))),Ar=(Sr.range,Yn((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Kn)}),(function(e,t){e.setTime(+e+t*$n)}),(function(e,t){return(t-e)/$n}),(function(e){return e.getMinutes()}))),Er=(Ar.range,Yn((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*$n)}),(function(e,t){return(t-e)/$n}),(function(e){return e.getUTCMinutes()}))),Tr=(Er.range,Yn((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*Kn)}),(function(e,t){return(t-e)/Kn}),(function(e){return e.getUTCSeconds()}))),Nr=(Tr.range,Yn((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e})));Nr.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?Yn((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):Nr:null};Nr.range;var Dr,Fr,Ir,Mr,Or,Rr,Zr,Br="year",zr="quarter",Lr="month",Pr="week",jr="date",Ur="day",Wr="dayofyear",Vr="hours",Gr="minutes",qr="seconds",Hr="milliseconds";[Br,zr,Lr,Pr,jr,Ur,Wr,Vr,Gr,qr,Hr].reduce((function(e,t,n){return e[t]=1+n,e}),{});Dr={},(0,qn.Z)(Dr,Br,"%Y "),(0,qn.Z)(Dr,zr,"Q%q "),(0,qn.Z)(Dr,Lr,"%b "),(0,qn.Z)(Dr,jr,"%d "),(0,qn.Z)(Dr,Pr,"W%U "),(0,qn.Z)(Dr,Ur,"%a "),(0,qn.Z)(Dr,Wr,"%j "),(0,qn.Z)(Dr,Vr,"%H:00"),(0,qn.Z)(Dr,Gr,"00:%M"),(0,qn.Z)(Dr,qr,":%S"),(0,qn.Z)(Dr,Hr,".%L"),(0,qn.Z)(Dr,"".concat(Br,"-").concat(Lr),"%Y-%m "),(0,qn.Z)(Dr,"".concat(Br,"-").concat(Lr,"-").concat(jr),"%Y-%m-%d "),(0,qn.Z)(Dr,"".concat(Vr,"-").concat(Gr),"%H:%M");var Xr=new Date;function Yr(e){return Xr.setFullYear(e),Xr.setMonth(0),Xr.setDate(1),Xr.setHours(0,0,0,0),Xr}function Kr(e){return tr.count(Yr(e.getFullYear())-1,e)}function $r(e){return ir.count(Yr(e.getFullYear())-1,e)}function Qr(e){return Yr(e).getDay()}function Jr(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return nr.count(t-1,e)}function ea(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return hr.count(t-1,e)}function ta(e){return Xr.setTime(Date.UTC(e,0,1)),Xr.getUTCDay()}function na(e,t,n){return t+7*e-(n+6)%7}Fr={},(0,qn.Z)(Fr,Br,(function(e){return e.getFullYear()})),(0,qn.Z)(Fr,zr,(function(e){return Math.floor(e.getMonth()/3)})),(0,qn.Z)(Fr,Lr,(function(e){return e.getMonth()})),(0,qn.Z)(Fr,jr,(function(e){return e.getDate()})),(0,qn.Z)(Fr,Vr,(function(e){return e.getHours()})),(0,qn.Z)(Fr,Gr,(function(e){return e.getMinutes()})),(0,qn.Z)(Fr,qr,(function(e){return e.getSeconds()})),(0,qn.Z)(Fr,Hr,(function(e){return e.getMilliseconds()})),(0,qn.Z)(Fr,Wr,(function(e){return Kr(e)})),(0,qn.Z)(Fr,Pr,(function(e){return $r(e)})),(0,qn.Z)(Fr,Pr+Ur,(function(e,t){return na($r(e),e.getDay(),Qr(t))})),(0,qn.Z)(Fr,Ur,(function(e,t){return na(1,e.getDay(),Qr(t))})),Ir={},(0,qn.Z)(Ir,zr,(function(e){return 3*e})),(0,qn.Z)(Ir,Pr,(function(e,t){return na(e,0,Qr(t))}));Mr={},(0,qn.Z)(Mr,Br,(function(e){return e.getUTCFullYear()})),(0,qn.Z)(Mr,zr,(function(e){return Math.floor(e.getUTCMonth()/3)})),(0,qn.Z)(Mr,Lr,(function(e){return e.getUTCMonth()})),(0,qn.Z)(Mr,jr,(function(e){return e.getUTCDate()})),(0,qn.Z)(Mr,Vr,(function(e){return e.getUTCHours()})),(0,qn.Z)(Mr,Gr,(function(e){return e.getUTCMinutes()})),(0,qn.Z)(Mr,qr,(function(e){return e.getUTCSeconds()})),(0,qn.Z)(Mr,Hr,(function(e){return e.getUTCMilliseconds()})),(0,qn.Z)(Mr,Wr,(function(e){return Jr(e)})),(0,qn.Z)(Mr,Pr,(function(e){return ea(e)})),(0,qn.Z)(Mr,Ur,(function(e,t){return na(1,e.getUTCDay(),ta(t))})),(0,qn.Z)(Mr,Pr+Ur,(function(e,t){return na(ea(e),e.getUTCDay(),ta(t))})),Or={},(0,qn.Z)(Or,zr,(function(e){return 3*e})),(0,qn.Z)(Or,Pr,(function(e,t){return na(e,0,ta(t))}));var ra=(Rr={},(0,qn.Z)(Rr,Br,xr),(0,qn.Z)(Rr,zr,wr.every(3)),(0,qn.Z)(Rr,Lr,wr),(0,qn.Z)(Rr,Pr,ir),(0,qn.Z)(Rr,jr,tr),(0,qn.Z)(Rr,Ur,tr),(0,qn.Z)(Rr,Wr,tr),(0,qn.Z)(Rr,Vr,Cr),(0,qn.Z)(Rr,Gr,Ar),(0,qn.Z)(Rr,qr,Tr),(0,qn.Z)(Rr,Hr,Nr),Rr),aa=(Zr={},(0,qn.Z)(Zr,Br,kr),(0,qn.Z)(Zr,zr,_r.every(3)),(0,qn.Z)(Zr,Lr,_r),(0,qn.Z)(Zr,Pr,hr),(0,qn.Z)(Zr,jr,nr),(0,qn.Z)(Zr,Ur,nr),(0,qn.Z)(Zr,Wr,nr),(0,qn.Z)(Zr,Vr,Sr),(0,qn.Z)(Zr,Gr,Er),(0,qn.Z)(Zr,qr,Tr),(0,qn.Z)(Zr,Hr,Nr),Zr);function ia(e){return ra[e]}function oa(e){return aa[e]}var ua=[Br,Lr,jr,Vr,Gr,qr,Hr],sa=ua.slice(0,-1),ca=sa.slice(0,-1),la=ca.slice(0,-1);la.slice(0,-1);function fa(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function da(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ha(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function pa(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,i=e.days,o=e.shortDays,u=e.months,s=e.shortMonths,c=Ta(a),l=Na(a),f=Ta(i),d=Na(i),h=Ta(o),p=Na(o),v=Ta(u),g=Na(u),m=Ta(s),y=Na(s),b={a:function(e){return o[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return s[e.getMonth()]},B:function(e){return u[e.getMonth()]},c:null,d:Ka,e:Ka,f:ti,g:di,G:pi,H:$a,I:Qa,j:Ja,L:ei,m:ni,M:ri,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:Bi,s:zi,S:ai,u:ii,U:oi,V:si,w:ci,W:li,x:null,X:null,y:fi,Y:hi,Z:vi,"%":Zi},x={a:function(e){return o[e.getUTCDay()]},A:function(e){return i[e.getUTCDay()]},b:function(e){return s[e.getUTCMonth()]},B:function(e){return u[e.getUTCMonth()]},c:null,d:gi,e:gi,f:ki,g:Ii,G:Oi,H:mi,I:yi,j:bi,L:xi,m:wi,M:_i,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:Bi,s:zi,S:Ci,u:Si,U:Ai,V:Ti,w:Ni,W:Di,x:null,X:null,y:Fi,Y:Mi,Z:Ri,"%":Zi},k={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return C(e,t,n,r)},d:Pa,e:Pa,f:qa,g:Za,G:Ra,H:Ua,I:Ua,j:ja,L:Ga,m:La,M:Wa,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=l.get(r[0].toLowerCase()),n+r[0].length):-1},q:za,Q:Xa,s:Ya,S:Va,u:Fa,U:Ia,V:Ma,w:Da,W:Oa,x:function(e,t,r){return C(e,n,t,r)},X:function(e,t,n){return C(e,r,t,n)},y:Za,Y:Ra,Z:Ba,"%":Ha};function w(e,t){return function(n){var r,a,i,o=[],u=-1,s=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++u<c;)37===e.charCodeAt(u)&&(o.push(e.slice(s,u)),null!=(a=wa[r=e.charAt(++u)])?r=e.charAt(++u):a="e"===r?" ":"0",(i=t[r])&&(r=i(n,a)),o.push(r),s=u+1);return o.push(e.slice(s,u)),o.join("")}}function _(e,t){return function(n){var r,a,i=ha(1900,void 0,1);if(C(i,e,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(1e3*i.s+("L"in i?i.L:0));if(t&&!("Z"in i)&&(i.Z=0),"p"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m="q"in i?i.q:0),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(a=(r=da(ha(i.y,0,1))).getUTCDay(),r=a>4||0===a?pr.ceil(r):pr(r),r=nr.offset(r,7*(i.V-1)),i.y=r.getUTCFullYear(),i.m=r.getUTCMonth(),i.d=r.getUTCDate()+(i.w+6)%7):(a=(r=fa(ha(i.y,0,1))).getDay(),r=a>4||0===a?or.ceil(r):or(r),r=tr.offset(r,7*(i.V-1)),i.y=r.getFullYear(),i.m=r.getMonth(),i.d=r.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),a="Z"in i?da(ha(i.y,0,1)).getUTCDay():fa(ha(i.y,0,1)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(a+5)%7:i.w+7*i.U-(a+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,da(i)):fa(i)}}function C(e,t,n,r){for(var a,i,o=0,u=t.length,s=n.length;o<u;){if(r>=s)return-1;if(37===(a=t.charCodeAt(o++))){if(a=t.charAt(o++),!(i=k[a in wa?t.charAt(o++):a])||(r=i(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return b.x=w(n,b),b.X=w(r,b),b.c=w(t,b),x.x=w(n,x),x.X=w(r,x),x.c=w(t,x),{format:function(e){var t=w(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=_(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=_(e+="",!0);return t.toString=function(){return e},t}}}var va,ga,ma,ya,ba,xa,ka,wa={"-":"",_:" ",0:"0"},_a=/^\s*\d+/,Ca=/^%/,Sa=/[\\^$*+?|[\]().{}]/g;function Aa(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",i=a.length;return r+(i<n?new Array(n-i+1).join(t)+a:a)}function Ea(e){return e.replace(Sa,"\\$&")}function Ta(e){return new RegExp("^(?:"+e.map(Ea).join("|")+")","i")}function Na(e){return new Map(e.map((function(e,t){return[e.toLowerCase(),t]})))}function Da(e,t,n){var r=_a.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Fa(e,t,n){var r=_a.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Ia(e,t,n){var r=_a.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Ma(e,t,n){var r=_a.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Oa(e,t,n){var r=_a.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Ra(e,t,n){var r=_a.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Za(e,t,n){var r=_a.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Ba(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function za(e,t,n){var r=_a.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function La(e,t,n){var r=_a.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Pa(e,t,n){var r=_a.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function ja(e,t,n){var r=_a.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Ua(e,t,n){var r=_a.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Wa(e,t,n){var r=_a.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Va(e,t,n){var r=_a.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Ga(e,t,n){var r=_a.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function qa(e,t,n){var r=_a.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Ha(e,t,n){var r=Ca.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Xa(e,t,n){var r=_a.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function Ya(e,t,n){var r=_a.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Ka(e,t){return Aa(e.getDate(),t,2)}function $a(e,t){return Aa(e.getHours(),t,2)}function Qa(e,t){return Aa(e.getHours()%12||12,t,2)}function Ja(e,t){return Aa(1+tr.count(xr(e),e),t,3)}function ei(e,t){return Aa(e.getMilliseconds(),t,3)}function ti(e,t){return ei(e,t)+"000"}function ni(e,t){return Aa(e.getMonth()+1,t,2)}function ri(e,t){return Aa(e.getMinutes(),t,2)}function ai(e,t){return Aa(e.getSeconds(),t,2)}function ii(e){var t=e.getDay();return 0===t?7:t}function oi(e,t){return Aa(ir.count(xr(e)-1,e),t,2)}function ui(e){var t=e.getDay();return t>=4||0===t?cr(e):cr.ceil(e)}function si(e,t){return e=ui(e),Aa(cr.count(xr(e),e)+(4===xr(e).getDay()),t,2)}function ci(e){return e.getDay()}function li(e,t){return Aa(or.count(xr(e)-1,e),t,2)}function fi(e,t){return Aa(e.getFullYear()%100,t,2)}function di(e,t){return Aa((e=ui(e)).getFullYear()%100,t,2)}function hi(e,t){return Aa(e.getFullYear()%1e4,t,4)}function pi(e,t){var n=e.getDay();return Aa((e=n>=4||0===n?cr(e):cr.ceil(e)).getFullYear()%1e4,t,4)}function vi(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Aa(t/60|0,"0",2)+Aa(t%60,"0",2)}function gi(e,t){return Aa(e.getUTCDate(),t,2)}function mi(e,t){return Aa(e.getUTCHours(),t,2)}function yi(e,t){return Aa(e.getUTCHours()%12||12,t,2)}function bi(e,t){return Aa(1+nr.count(kr(e),e),t,3)}function xi(e,t){return Aa(e.getUTCMilliseconds(),t,3)}function ki(e,t){return xi(e,t)+"000"}function wi(e,t){return Aa(e.getUTCMonth()+1,t,2)}function _i(e,t){return Aa(e.getUTCMinutes(),t,2)}function Ci(e,t){return Aa(e.getUTCSeconds(),t,2)}function Si(e){var t=e.getUTCDay();return 0===t?7:t}function Ai(e,t){return Aa(hr.count(kr(e)-1,e),t,2)}function Ei(e){var t=e.getUTCDay();return t>=4||0===t?mr(e):mr.ceil(e)}function Ti(e,t){return e=Ei(e),Aa(mr.count(kr(e),e)+(4===kr(e).getUTCDay()),t,2)}function Ni(e){return e.getUTCDay()}function Di(e,t){return Aa(pr.count(kr(e)-1,e),t,2)}function Fi(e,t){return Aa(e.getUTCFullYear()%100,t,2)}function Ii(e,t){return Aa((e=Ei(e)).getUTCFullYear()%100,t,2)}function Mi(e,t){return Aa(e.getUTCFullYear()%1e4,t,4)}function Oi(e,t){var n=e.getUTCDay();return Aa((e=n>=4||0===n?mr(e):mr.ceil(e)).getUTCFullYear()%1e4,t,4)}function Ri(){return"+0000"}function Zi(){return"%"}function Bi(e){return+e}function zi(e){return Math.floor(+e/1e3)}function Li(e){var t={};return function(n){return t[n]||(t[n]=e(n))}}function Pi(e){var t=Li(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat:function(e){var n=Mn(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(e,t){return function(n){var r=e(n),a=r.indexOf(t);if(a<0)return r;for(var i=function(e,t){var n,r=e.lastIndexOf("e");if(r>0)return r;for(r=e.length;--r>t;)if((n=e.charCodeAt(r))>=48&&n<=57)return r+1}(r,a),o=i<r.length?r.slice(i):"";--i>a;)if("0"!==r[i]){++i;break}return r.slice(0,i)+o}}(t(n),t(".1f")(1)[1])}return t(n)},formatSpan:function(e,r,a,i){i=Mn(null==i?",f":i);var o,u=function(e,t,n){n=+n;var r=(t=+t)<(e=+e),a=r?Dn(t,e,n):Dn(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}(e,r,a),s=Math.max(Math.abs(e),Math.abs(r));if(null==i.precision)switch(i.type){case"s":return isNaN(o=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Zn(t)/3)))-Zn(Math.abs(e)))}(u,s))||(i.precision=o),n(i,s);case"":case"e":case"g":case"p":case"r":isNaN(o=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Zn(t)-Zn(e))+1}(u,s))||(i.precision=o-("e"===i.type));break;case"f":case"%":isNaN(o=function(e){return Math.max(0,-Zn(Math.abs(e)))}(u))||(i.precision=o-2*("%"===i.type))}return t(i)}}}function ji(){return xa=Pi({format:jn,formatPrefix:Un})}function Ui(e){return Pi(Gn(e))}function Wi(e){return arguments.length?xa=Ui(e):xa}function Vi(e,t,n){Kt(n=n||{})||Ut("Invalid time multi-format specifier: ".concat(n));var r=t(qr),a=t(Gr),i=t(Vr),o=t(jr),u=t(Pr),s=t(Lr),c=t(zr),l=t(Br),f=e(n[Hr]||".%L"),d=e(n[qr]||":%S"),h=e(n[Gr]||"%I:%M"),p=e(n[Vr]||"%I %p"),v=e(n[jr]||n[Ur]||"%a %d"),g=e(n[Pr]||"%b %d"),m=e(n[Lr]||"%B"),y=e(n[zr]||"%B"),b=e(n[Br]||"%Y");return function(e){return(r(e)<e?f:a(e)<e?d:i(e)<e?h:o(e)<e?p:s(e)<e?u(e)<e?v:g:l(e)<e?c(e)<e?m:y:b)(e)}}function Gi(e){var t=Li(e.format),n=Li(e.utcFormat);return{timeFormat:function(e){return on(e)?t(e):Vi(t,ia,e)},utcFormat:function(e){return on(e)?n(e):Vi(n,oa,e)},timeParse:Li(e.parse),utcParse:Li(e.utcParse)}}function qi(){return ka=Gi({format:ga,parse:ma,utcFormat:ya,utcParse:ba})}function Hi(e){return Gi(pa(e))}function Xi(e){return arguments.length?ka=Hi(e):ka}!function(e){va=pa(e),ga=va.format,ma=va.parse,ya=va.utcFormat,ba=va.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),ji(),qi();var Yi=function(e,t){return tn({},e,t)};function Ki(e,t){var n=arguments.length;return n&&2!==n&&Ut("defaultLocale expects either zero or two arguments."),n?Yi(Wi(e),Xi(t)):Yi(Wi(),Xi())}var $i=/^(data:|([A-Za-z]+:)?\/\/)/,Qi=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Ji=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,eo="file://";function to(e,t){return no.apply(this,arguments)}function no(){return(no=(0,Bt.Z)((0,w.Z)().mark((function e(t,n){var r,a;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sanitize(t,n);case 2:return r=e.sent,a=r.href,e.abrupt("return",r.localFile?this.file(a):this.http(a,n));case 5:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function ro(e,t){return ao.apply(this,arguments)}function ao(){return ao=(0,Bt.Z)((0,w.Z)().mark((function e(t,n){var r,a,i,o,u,s,c;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=tn({},this.options,n),r=this.fileAccess,a={href:null},s=Qi.test(t.replace(Ji,"")),null!=t&&"string"===typeof t&&s||Ut("Sanitize failure, invalid URI: "+un(t)),c=$i.test(t),(u=n.baseURL)&&!c&&(t.startsWith("/")||u.endsWith("/")||(t="/"+t),t=u+t),o=(i=t.startsWith(eo))||"file"===n.mode||"http"!==n.mode&&!c&&r,i?t=t.slice(eo.length):t.startsWith("//")&&("file"===n.defaultProtocol?(t=t.slice(2),o=!0):t=(n.defaultProtocol||"http")+":"+t),Object.defineProperty(a,"localFile",{value:!!o}),a.href=t,n.target&&(a.target=n.target+""),n.rel&&(a.rel=n.rel+""),"image"===n.context&&n.crossOrigin&&(a.crossOrigin=n.crossOrigin+""),e.abrupt("return",a);case 14:case"end":return e.stop()}}),e,this)}))),ao.apply(this,arguments)}function io(e){return e?function(t){return new Promise((function(n,r){e.readFile(t,(function(e,t){e?r(e):n(t)}))}))}:oo}function oo(){return uo.apply(this,arguments)}function uo(){return(uo=(0,Bt.Z)((0,w.Z)().mark((function e(){return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ut("No file system access.");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function so(e){return e?function(){var t=(0,Bt.Z)((0,w.Z)().mark((function t(n,r){var a,i,o;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=tn({},this.options.http,r),i=r&&r.response,t.next=4,e(n,a);case 4:return o=t.sent,t.abrupt("return",o.ok?Jt(o[i])?o[i]():o.text():Ut(o.status+""+o.statusText));case 6:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}():co}function co(){return lo.apply(this,arguments)}function lo(){return(lo=(0,Bt.Z)((0,w.Z)().mark((function e(){return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ut("No HTTP fetch method available.");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var fo=function(e){return!Number.isNaN(+e)&&!(e instanceof Date)},ho={boolean:function(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e)&&!!e},integer:$t,number:$t,date:function(e,t){return t=t||sn,null==e||""===e?null:t(e)},string:function(e){return null==e||""===e?null:e+""},unknown:qt},po=[function(e){return"true"===e||"false"===e||!0===e||!1===e},function(e){return fo(e)&&Number.isInteger(+e)},fo,function(e){return!Number.isNaN(Date.parse(e))}],vo=["boolean","integer","number","date"];function go(e,t){return t.reduce((function(t,n){return t[n]=function(e,t){if(!e||!e.length)return"unknown";for(var n,r,a,i=e.length,o=po.length,u=po.map((function(e,t){return t+1})),s=0,c=0;s<i;++s)for(r=t?e[s][t]:e[s],n=0;n<o;++n)if(u[n]&&null!=(a=r)&&a===a&&!po[n](r)&&(u[n]=0,++c===po.length))return"string";return vo[u.reduce((function(e,t){return 0===e?t:e}),0)-1]}(e,n),t}),{})}function mo(e){var t=function(t,n){var r={delimiter:e};return yo(t,n?tn(n,r):r)};return t.responseType="text",t}function yo(e,t){return t.header&&(e=t.header.map(un).join(t.delimiter)+"\n"+e),mn(t.delimiter).parse(e+"")}function bo(e,t){var n,r=t&&t.property?Vt(t.property):qt;return!Kt(e)||(n=e,"function"===typeof Buffer&&Jt(Buffer.isBuffer)&&Buffer.isBuffer(n))?r(JSON.parse(e)):function(e,t){!Yt(e)&&function(e){return e&&Jt(e[Symbol.iterator])}(e)&&(e=(0,ln.Z)(e));return t&&t.copy?JSON.parse(JSON.stringify(e)):e}(r(e),t)}yo.responseType="text",bo.responseType="json";var xo={interior:function(e,t){return e!==t},exterior:function(e,t){return e===t}};function ko(e,t){var n,r,a,i;return e=bo(e,t),t&&t.feature?(n=bn,a=t.feature):t&&t.mesh?(n=_n,a=t.mesh,i=xo[t.filter]):Ut("Missing TopoJSON feature or mesh parameter."),(r=(r=e.objects[a])?n(e,r,i):Ut("Invalid TopoJSON object: "+a))&&r.features||[r]}ko.responseType="json";var wo={dsv:yo,csv:mo(","),tsv:mo("\t"),json:bo,topojson:ko};function _o(e,t){return arguments.length>1?(wo[e]=t,this):rn(wo,e)?wo[e]:null}function Co(e){var t=_o(e);return t&&t.responseType||"text"}function So(e,t,n,r){var a=_o((t=t||{}).type||"json");return a||Ut("Unknown data format type: "+t.type),e=a(e,t),t.parse&&function(e,t,n,r){if(!e.length)return;var a=Xi();n=n||a.timeParse,r=r||a.utcParse;var i,o,u,s,c,l,f=e.columns||Object.keys(e[0]);"auto"===t&&(t=go(e,f));f=Object.keys(t);var d=f.map((function(e){var a,i,o=t[e];if(o&&(o.startsWith("date:")||o.startsWith("utc:")))return("'"===(i=(a=o.split(/:(.+)?/,2))[1])[0]&&"'"===i[i.length-1]||'"'===i[0]&&'"'===i[i.length-1])&&(i=i.slice(1,-1)),("utc"===a[0]?r:n)(i);if(!ho[o])throw Error("Illegal format pattern: "+e+":"+o);return ho[o]}));for(u=0,c=e.length,l=f.length;u<c;++u)for(i=e[u],s=0;s<l;++s)i[o=f[s]]=d[s](i[o])}(e,t.parse,n,r),rn(e,"columns")&&delete e.columns,e}var Ao=function(e,t){return function(n){return{options:n||{},sanitize:ro,load:to,fileAccess:!!t,file:io(t),http:so(e)}}}("undefined"!==typeof fetch&&fetch,null);function Eo(e){var t=e||qt,n=[],r={};return n.add=function(e){var a=t(e);return r[a]||(r[a]=1,n.push(e)),n},n.remove=function(e){var a=t(e);if(r[a]){r[a]=0;var i=n.indexOf(e);i>=0&&n.splice(i,1)}return n},n}function To(e,t){return No.apply(this,arguments)}function No(){return No=(0,Bt.Z)((0,w.Z)().mark((function e(t,n){return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),t.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),No.apply(this,arguments)}var Do=Symbol("vega_id"),Fo=1;function Io(e){return!(!e||!Mo(e))}function Mo(e){return e[Do]}function Oo(e,t){return e[Do]=t,e}function Ro(e){var t=e===Object(e)?e:{data:e};return Mo(t)?t:Oo(t,Fo++)}function Zo(e){return Bo(e,Ro({}))}function Bo(e,t){for(var n in e)t[n]=e[n];return t}function zo(e,t){return Oo(t,Mo(e))}function Lo(e,t){return e?t?function(n,r){return e(n,r)||Mo(t(n))-Mo(t(r))}:function(t,n){return e(t,n)||Mo(t)-Mo(n)}:null}function Po(e){return e&&e.constructor===jo}function jo(){var e=[],t=[],n=[],r=[],a=[],i=null,o=!1;return{constructor:jo,insert:function(t){for(var n=Qt(t),r=n.length,a=0;a<r;++a)e.push(n[a]);return this},remove:function(e){for(var n=Jt(e)?r:t,a=Qt(e),i=a.length,o=0;o<i;++o)n.push(a[o]);return this},modify:function(e,t,r){var i={field:t,value:en(r)};return Jt(e)?(i.filter=e,a.push(i)):(i.tuple=e,n.push(i)),this},encode:function(e,t){return Jt(e)?a.push({filter:e,field:t}):n.push({tuple:e,field:t}),this},clean:function(e){return i=e,this},reflow:function(){return o=!0,this},pulse:function(u,s){var c,l,f,d,h,p,v={},g={};for(c=0,l=s.length;c<l;++c)v[Mo(s[c])]=1;for(c=0,l=t.length;c<l;++c)v[Mo(h=t[c])]=-1;for(c=0,l=r.length;c<l;++c)d=r[c],s.forEach((function(e){d(e)&&(v[Mo(e)]=-1)}));for(c=0,l=e.length;c<l;++c)p=Mo(h=e[c]),v[p]?v[p]=1:u.add.push(Ro(e[c]));for(c=0,l=s.length;c<l;++c)h=s[c],v[Mo(h)]<0&&u.rem.push(h);function m(e,t,n){n?e[t]=n(e):u.encode=t,o||(g[Mo(e)]=e)}for(c=0,l=n.length;c<l;++c)h=(f=n[c]).tuple,d=f.field,(p=v[Mo(h)])>0&&(m(h,d,f.value),u.modifies(d));for(c=0,l=a.length;c<l;++c)f=a[c],d=f.filter,s.forEach((function(e){d(e)&&v[Mo(e)]>0&&m(e,f.field,f.value)})),u.modifies(f.field);if(o)u.mod=t.length||r.length?s.filter((function(e){return v[Mo(e)]>0})):s.slice();else for(p in g)u.mod.push(g[p]);return(i||null==i&&(t.length||r.length))&&u.clean(!0),u}}}var Uo="_:mod:_";function Wo(){Object.defineProperty(this,Uo,{writable:!0,value:{}})}Wo.prototype={set:function(e,t,n,r){var a=this,i=a[e],o=a[Uo];return null!=t&&t>=0?(i[t]!==n||r)&&(i[t]=n,o[t+":"+e]=-1,o[e]=-1):(i!==n||r)&&(a[e]=n,o[e]=Yt(n)?1+n.length:-1),a},modified:function(e,t){var n=this[Uo];if(!arguments.length){for(var r in n)if(n[r])return!0;return!1}if(Yt(e)){for(var a=0;a<e.length;++a)if(n[e[a]])return!0;return!1}return null!=t&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear:function(){return this[Uo]={},this}};var Vo=0,Go=new Wo;function qo(e,t,n,r){this.id=++Vo,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function Ho(e){return function(t){var n=this.flags;return 0===arguments.length?!!(n&e):(this.flags=t?n|e:n&~e,this)}}qo.prototype={targets:function(){return this._targets||(this._targets=Eo(Gt))},set:function(e){return this.value!==e?(this.value=e,1):0},skip:Ho(1),modified:Ho(2),parameters:function(e,t,n){var r=this;t=!1!==t;var a,i,o,u,s=this._argval=this._argval||new Wo,c=this._argops=this._argops||[],l=[],f=function(e,n,a){a instanceof qo?(a!==r&&(t&&a.targets().add(r),l.push(a)),c.push({op:a,name:e,index:n})):s.set(e,n,a)};for(a in e)if(i=e[a],"pulse"===a)Qt(i).forEach((function(e){e instanceof qo?e!==r&&(e.targets().add(r),l.push(e)):Ut("Pulse parameters must be operator instances.")})),this.source=i;else if(Yt(i))for(s.set(a,-1,Array(o=i.length)),u=0;u<o;++u)f(a,u,i[u]);else f(a,-1,i);return this.marshall().clear(),n&&(c.initonly=!0),l},marshall:function(e){var t,n,r,a,i=this._argval||Go,o=this._argops;if(o){var u=o.length;for(n=0;n<u;++n)a=(r=(t=o[n]).op).modified()&&r.stamp===e,i.set(t.name,t.index,r.value,a);if(o.initonly){for(n=0;n<u;++n)(t=o[n]).op.targets().remove(this);this._argops=null,this._update=null}}return i},detach:function(){var e,t,n,r=this._argops;if(r)for(e=0,t=r.length;e<t;++e)(n=r[e].op)._targets&&n._targets.remove(this);this.pulse=null,this.source=null},evaluate:function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run:function(e){return e.stamp<this.stamp?e.StopPropagation:(this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e);var t}};var Xo=0;function Yo(e,t,n){this.id=++Xo,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function Ko(e,t,n){return new Yo(e,t,n)}function $o(){return $o=(0,Bt.Z)((0,w.Z)().mark((function e(t,n){var r,a,i;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this,a=0,e.prev=2,e.next=5,r.loader().load(t,{context:"dataflow",response:Co(n&&n.type)});case 5:i=e.sent;try{i=r.parse(i,n)}catch(o){a=-2,r.warn("Data ingestion failed",t,o)}e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),a=-1,r.warn("Loading failed",t,e.t0);case 13:return e.abrupt("return",{data:i,status:a});case 14:case"end":return e.stop()}}),e,this,[[2,9]])}))),$o.apply(this,arguments)}function Qo(){return Qo=(0,Bt.Z)((0,w.Z)().mark((function e(t,n,r){var a,i,o;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=(a=this)._pending||Jo(a)).requests+=1,e.next=4,a.request(n,r);case 4:return o=e.sent,a.pulse(t,a.changeset().remove(Ht).insert(o.data||[])),i.done(),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e,this)}))),Qo.apply(this,arguments)}function Jo(e){var t,n=new Promise((function(e){return t=e}));return n.requests=0,n.done=function(){0===--n.requests&&(e._pending=null,t(e))},e._pending=n}Yo.prototype={_filter:Ht,_apply:qt,targets:function(){return this._targets||(this._targets=Eo(Gt))},consume:function(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive:function(e){if(this._filter(e)){for(var t=this.value=this._apply(e),n=this._targets,r=n?n.length:0,a=0;a<r;++a)n[a].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter:function(e){var t=Ko(e);return this.targets().add(t),t},apply:function(e){var t=Ko(null,e);return this.targets().add(t),t},merge:function(){var e=Ko();this.targets().add(e);for(var t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle:function(e){var t=-1;return this.filter((function(){var n=Date.now();return n-t>e?(t=n,1):0}))},debounce:function(e){var t=Ko();return this.targets().add(Ko(null,null,function(e,t){var n;return function(r){n&&clearTimeout(n),n=setTimeout((function(){return t(r),n=null}),e)}}(e,(function(e){var n=e.dataflow;t.receive(e),n&&n.run&&n.run()})))),t},between:function(e,t){var n=!1;return e.targets().add(Ko(null,null,(function(){return n=!0}))),t.targets().add(Ko(null,null,(function(){return n=!1}))),this.filter((function(){return n}))},detach:function(){this._filter=Ht,this._targets=null}};var eu={skip:!0};function tu(e,t,n,r,a,i){var o,u,s=tn({},i,eu);Jt(n)||(n=en(n)),void 0===r?o=function(t){return e.touch(n(t))}:Jt(r)?(u=new qo(null,r,a,!1),o=function(t){u.evaluate(t);var r=n(t),a=u.value;Po(a)?e.pulse(r,a,i):e.update(r,a,s)}):o=function(t){return e.update(n(t),r,s)},t.apply(o)}function nu(e,t,n,r,a,i){if(void 0===r)t.targets().add(n);else{var o=i||{},u=new qo(null,function(e,t){return t=Jt(t)?t:en(t),e?function(n,r){var a=t(n,r);return e.skip()||(e.skip(a!==this.value).value=a),a}:t}(n,r),a,!1);u.modified(o.force),u.rank=t.rank,t.targets().add(u),n&&(u.skip(!0),u.value=n.value,u.targets().add(n),e.connect(n,[u]))}}var ru={};function au(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function iu(e,t){var n=[];return cn(e,t,(function(e){return n.push(e)})),n}function ou(e,t){var n={};return e.visit(t,(function(e){n[Mo(e)]=1})),function(e){return n[Mo(e)]?null:e}}function uu(e,t){return e?function(n,r){return e(n,r)&&t(n,r)}:t}function su(e,t,n,r){var a=this,i=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;var o,u=(0,Zt.Z)(n);try{for(u.s();!(o=u.n()).done;){var s=o.value;if(s.stamp===t){if(s.fields){var c=a.fields||(a.fields={});for(var l in s.fields)c[l]=1}s.changed(a.ADD)&&(i|=a.ADD),s.changed(a.REM)&&(i|=a.REM),s.changed(a.MOD)&&(i|=a.MOD)}}}catch(f){u.e(f)}finally{u.f()}this.changes=i}function cu(){return cu=(0,Bt.Z)((0,w.Z)().mark((function e(t,n,r){var a,i,o,u,s,c,l,f,d;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=[],!(a=this)._pulse){e.next=3;break}return e.abrupt("return",fu(a));case 3:if(!a._pending){e.next=6;break}return e.next=6,a._pending;case 6:if(!n){e.next=9;break}return e.next=9,To(a,n);case 9:if(a._touched.length){e.next=12;break}return a.debug("Dataflow invoked, but nothing to do."),e.abrupt("return",a);case 12:o=++a._clock,a._pulse=new au(a,o,t),a._touched.forEach((function(e){return a._enqueue(e,!0)})),a._touched=Eo(Gt),u=0,e.prev=17;case 18:if(!(a._heap.size()>0)){e.next=35;break}if((s=a._heap.pop()).rank===s.qrank){e.next=23;break}return a._enqueue(s,!0),e.abrupt("continue",18);case 23:if(!(c=s.run(a._getPulse(s,t))).then){e.next=30;break}return e.next=27,c;case 27:c=e.sent,e.next=31;break;case 30:c.async&&(i.push(c.async),c=ru);case 31:c!==ru&&s._targets&&s._targets.forEach((function(e){return a._enqueue(e)})),++u,e.next=18;break;case 35:e.next=41;break;case 37:e.prev=37,e.t0=e.catch(17),a._heap.clear(),l=e.t0;case 41:if(a._input={},a._pulse=null,a.debug("Pulse ".concat(o,": ").concat(u," operators")),l&&(a._postrun=[],a.error(l)),!a._postrun.length){e.next=55;break}f=a._postrun.sort((function(e,t){return t.priority-e.priority})),a._postrun=[],d=0;case 49:if(!(d<f.length)){e.next=55;break}return e.next=52,To(a,f[d].callback);case 52:++d,e.next=49;break;case 55:if(!r){e.next=58;break}return e.next=58,To(a,r);case 58:return i.length&&Promise.all(i).then((function(e){return a.runAsync(null,(function(){e.forEach((function(e){try{e(a)}catch(t){a.error(t)}}))}))})),e.abrupt("return",a);case 60:case"end":return e.stop()}}),e,this,[[17,37]])}))),cu.apply(this,arguments)}function lu(){return lu=(0,Bt.Z)((0,w.Z)().mark((function e(t,n,r){var a,i=this;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._running){e.next=5;break}return e.next=3,this._running;case 3:e.next=0;break;case 5:return a=function(){return i._running=null},(this._running=this.evaluate(t,n,r)).then(a,a),e.abrupt("return",this._running);case 8:case"end":return e.stop()}}),e,this)}))),lu.apply(this,arguments)}function fu(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}au.prototype={StopPropagation:ru,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork:function(e){return new au(this.dataflow).init(this,e)},clone:function(){var e=this.fork(7);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(23)},addAll:function(){var e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||((e=new au(this.dataflow).init(this)).add=e.source,e.rem=[]),e},init:function(e,t){var n=this;return n.stamp=e.stamp,n.encode=e.encode,!e.fields||64&t||(n.fields=e.fields),1&t?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),2&t?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),4&t?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),32&t?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter:function(e){this.dataflow.runAfter(e)},changed:function(e){var t=e||7;return 1&t&&this.add.length||2&t&&this.rem.length||4&t&&this.mod.length},reflow:function(e){if(e)return this.fork(7).reflow();var t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(4,ou(this,1))),this},clean:function(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies:function(e){var t=this.fields||(this.fields={});return Yt(e)?e.forEach((function(e){return t[e]=!0})):t[e]=!0,this},modified:function(e,t){var n=this.fields;return!(!t&&!this.mod.length||!n)&&(arguments.length?Yt(e)?e.some((function(e){return n[e]})):n[e]:!!n)},filter:function(e,t){var n=this;return 1&e&&(n.addF=uu(n.addF,t)),2&e&&(n.remF=uu(n.remF,t)),4&e&&(n.modF=uu(n.modF,t)),16&e&&(n.srcF=uu(n.srcF,t)),n},materialize:function(e){var t=this;return 1&(e=e||7)&&t.addF&&(t.add=iu(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=iu(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=iu(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit:function(e,t){var n=this,r=t;if(16&e)return cn(n.source,n.srcF,r),n;1&e&&cn(n.add,n.addF,r),2&e&&cn(n.rem,n.remF,r),4&e&&cn(n.mod,n.modF,r);var a=n.source;if(8&e&&a){var i=n.add.length+n.mod.length;i===a.length||cn(a,i?ou(n,5):n.srcF,r)}return n}},an(su,au,{fork:function(e){var t=new au(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,(function(e){return t.add.push(e)})),e&t.REM&&this.visit(t.REM,(function(e){return t.rem.push(e)})),e&t.MOD&&this.visit(t.MOD,(function(e){return t.mod.push(e)}))),t},changed:function(e){return this.changes&e},modified:function(e){var t=this,n=t.fields;return n&&t.changes&t.MOD?Yt(e)?e.some((function(e){return n[e]})):n[e]:0},filter:function(){Ut("MultiPulse does not support filtering.")},materialize:function(){Ut("MultiPulse does not support materialization.")},visit:function(e,t){var n=this,r=n.pulses,a=r.length,i=0;if(e&n.SOURCE)for(;i<a;++i)r[i].visit(e,t);else for(;i<a;++i)r[i].stamp===n.stamp&&r[i].visit(e,t);return n}});var du={skip:!1,force:!1};function hu(e){var t=[];return{clear:function(){return t=[]},size:function(){return t.length},peek:function(){return t[0]},push:function(n){return t.push(n),pu(t,0,t.length-1,e)},pop:function(){var n,r=t.pop();return t.length?(n=t[0],t[0]=r,function(e,t,n){var r,a=t,i=e.length,o=e[t],u=1+(t<<1);for(;u<i;)(r=u+1)<i&&n(e[u],e[r])>=0&&(u=r),e[t]=e[u],u=1+((t=u)<<1);e[t]=o,pu(e,a,t,n)}(t,0,e)):n=r,n}}}function pu(e,t,n,r){for(var a,i,o=e[n];n>t&&r(o,a=e[i=n-1>>1])<0;)e[n]=a,n=i;return e[n]=o}function vu(){this.logger(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xt,r=e||0;return{level:function(e){return arguments.length?(r=+e,this):r},error:function(){return r>=1&&n(t||"error","ERROR",arguments),this},warn:function(){return r>=2&&n(t||"warn","WARN",arguments),this},info:function(){return r>=3&&n(t||"log","INFO",arguments),this},debug:function(){return r>=4&&n(t||"log","DEBUG",arguments),this}}}()),this.logLevel(1),this._clock=0,this._rank=0,this._locale=Ki();try{this._loader=Ao()}catch(e){}this._touched=Eo(Gt),this._input={},this._pulse=null,this._heap=hu((function(e,t){return e.qrank-t.qrank})),this._postrun=[]}function gu(e){return function(){return this._log[e].apply(this,arguments)}}function mu(e,t){qo.call(this,e,null,t)}vu.prototype={stamp:function(){return this._clock},loader:function(e){return arguments.length?(this._loader=e,this):this._loader},locale:function(e){return arguments.length?(this._locale=e,this):this._locale},logger:function(e){return arguments.length?(this._log=e,this):this._log},error:gu("error"),warn:gu("warn"),info:gu("info"),debug:gu("debug"),logLevel:gu("level"),cleanThreshold:1e4,add:function(e,t,n,r){var a,i=1;return e instanceof qo?a=e:e&&e.prototype instanceof qo?a=new e:Jt(e)?a=new qo(null,e):(i=0,a=new qo(e,t)),this.rank(a),i&&(r=n,n=t),n&&this.connect(a,a.parameters(n,r)),this.touch(a),a},connect:function(e,t){for(var n=e.rank,r=t.length,a=0;a<r;++a)if(n<t[a].rank)return void this.rerank(e)},rank:function(e){e.rank=++this._rank},rerank:function(e){for(var t,n,r,a=[e];a.length;)if(this.rank(t=a.pop()),n=t._targets)for(r=n.length;--r>=0;)a.push(t=n[r]),t===e&&Ut("Cycle detected in dataflow graph.")},pulse:function(e,t,n){this.touch(e,n||du);var r=new au(this,this._clock+(this._pulse?0:1)),a=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,a),this},touch:function(e,t){var n=t||du;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this},update:function(e,t,n){var r=n||du;return(e.set(t)||r.force)&&this.touch(e,r),this},changeset:jo,ingest:function(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))},parse:function(e,t){var n=this.locale();return So(e,t,n.timeParse,n.utcParse)},preload:function(e,t,n){return Qo.apply(this,arguments)},request:function(e,t){return $o.apply(this,arguments)},events:function(e,t,n,r){for(var a,i=this,o=Ko(n,r),u=function(e){e.dataflow=i;try{o.receive(e)}catch(t){i.error(t)}finally{i.run()}},s=(a="string"===typeof e&&"undefined"!==typeof document?document.querySelectorAll(e):Qt(e)).length,c=0;c<s;++c)a[c].addEventListener(t,u);return o},on:function(e,t,n,r,a){return(e instanceof qo?nu:tu)(this,e,t,n,r,a),this},evaluate:function(e,t,n){return cu.apply(this,arguments)},run:function(e,t,n){return this._pulse?fu(this):(this.evaluate(e,t,n),this)},runAsync:function(e,t,n){return lu.apply(this,arguments)},runAfter:function(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(r){this.error(r)}},_enqueue:function(e,t){var n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))},_getPulse:function(e,t){var n=e.source,r=this._clock;return n&&Yt(n)?new su(this,r,n.map((function(e){return e.pulse})),t):this._input[e.id]||function(e,t){if(t&&t.stamp===e.stamp)return t;e=e.fork(),t&&t!==ru&&(e.source=t.source);return e}(this._pulse,n&&n.pulse)}},an(mu,qo,{run:function(e){var t,n=this;return e.stamp<this.stamp?e.StopPropagation:(this.skip()?this.skip(!1):t=this.evaluate(e),(t=t||e).then?t=t.then((function(e){return n.pulse=e})):t!==e.StopPropagation&&(this.pulse=t),t)},evaluate:function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform:function(){}});var yu={};function bu(e){var t=xu(e);return t&&t.Definition||null}function xu(e){return e=e&&e.toLowerCase(),rn(yu,e)?yu[e]:null}var ku=n(9439);function wu(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function _u(e,t){var n;if(void 0===t){var r,a=(0,Zt.Z)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&(n<i||void 0===n&&i>=i)&&(n=i)}}catch(l){a.e(l)}finally{a.f()}}else{var o,u=-1,s=(0,Zt.Z)(e);try{for(s.s();!(o=s.n()).done;){var c=o.value;null!=(c=t(c,++u,e))&&(n<c||void 0===n&&c>=c)&&(n=c)}}catch(l){s.e(l)}finally{s.f()}}return n}function Cu(e,t){var n;if(void 0===t){var r,a=(0,Zt.Z)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&(n>i||void 0===n&&i>=i)&&(n=i)}}catch(l){a.e(l)}finally{a.f()}}else{var o,u=-1,s=(0,Zt.Z)(e);try{for(s.s();!(o=s.n()).done;){var c=o.value;null!=(c=t(c,++u,e))&&(n>c||void 0===n&&c>=c)&&(n=c)}}catch(l){s.e(l)}finally{s.f()}}return n}function Su(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:wu;r>n;){if(r-n>600){var i=r-n+1,o=t-n+1,u=Math.log(i),s=.5*Math.exp(2*u/3),c=.5*Math.sqrt(u*s*(i-s)/i)*(o-i/2<0?-1:1),l=Math.max(n,Math.floor(t-o*s/i+c)),f=Math.min(r,Math.floor(t+(i-o)*s/i+c));Su(e,t,l,f,a)}var d=e[t],h=n,p=r;for(Au(e,n,t),a(e[r],d)>0&&Au(e,n,r);h<p;){for(Au(e,h,p),++h,--p;a(e[h],d)<0;)++h;for(;a(e[p],d)>0;)--p}0===a(e[n],d)?Au(e,n,p):Au(e,++p,r),p<=t&&(n=p+1),t<=p&&(r=p-1)}return e}function Au(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}var Eu=(0,w.Z)().mark(Nu);function Tu(e){return null===e?NaN:+e}function Nu(e,t){var n,r,a,i,o,u,s;return(0,w.Z)().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(void 0!==t){c.next=21;break}n=(0,Zt.Z)(e),c.prev=2,n.s();case 4:if((r=n.n()).done){c.next=11;break}if(!(null!=(a=r.value)&&(a=+a)>=a)){c.next=9;break}return c.next=9,a;case 9:c.next=4;break;case 11:c.next=16;break;case 13:c.prev=13,c.t0=c.catch(2),n.e(c.t0);case 16:return c.prev=16,n.f(),c.finish(16);case 19:c.next=40;break;case 21:i=-1,o=(0,Zt.Z)(e),c.prev=23,o.s();case 25:if((u=o.n()).done){c.next=32;break}if(s=u.value,!(null!=(s=t(s,++i,e))&&(s=+s)>=s)){c.next=30;break}return c.next=30,s;case 30:c.next=25;break;case 32:c.next=37;break;case 34:c.prev=34,c.t1=c.catch(23),o.e(c.t1);case 37:return c.prev=37,o.f(),c.finish(37);case 40:case"end":return c.stop()}}),Eu,null,[[2,13,16,19],[23,34,37,40]])}function Du(e,t,n){if(r=(e=Float64Array.from(Nu(e,n))).length){if((t=+t)<=0||r<2)return Cu(e);if(t>=1)return _u(e);var r,a=(r-1)*t,i=Math.floor(a),o=_u(Su(e,i).subarray(0,i+1));return o+(Cu(e.subarray(i+1))-o)*(a-i)}}function Fu(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Tu;if(r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,i=Math.floor(a),o=+n(e[i],i,e),u=+n(e[i+1],i+1,e);return o+(u-o)*(a-i)}}function Iu(e,t){var n=function(e,t){var n,r=0,a=0,i=0;if(void 0===t){var o,u=(0,Zt.Z)(e);try{for(u.s();!(o=u.n()).done;){var s=o.value;null!=s&&(s=+s)>=s&&(i+=(n=s-a)*(s-(a+=n/++r)))}}catch(h){u.e(h)}finally{u.f()}}else{var c,l=-1,f=(0,Zt.Z)(e);try{for(f.s();!(c=f.n()).done;){var d=c.value;null!=(d=t(d,++l,e))&&(d=+d)>=d&&(i+=(n=d-a)*(d-(a+=n/++r)))}}catch(h){f.e(h)}finally{f.f()}}if(r>1)return i/(r-1)}(e,t);return n?Math.sqrt(n):n}function Mu(e,t){return Du(e,.5,t)}var Ou=(0,w.Z)().mark(Ru);function Ru(e,t){var n,r,a,i,o,u,s;return(0,w.Z)().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(null!=t){c.next=21;break}n=(0,Zt.Z)(e),c.prev=2,n.s();case 4:if((r=n.n()).done){c.next=11;break}if(!(null!=(a=r.value)&&""!==a&&(a=+a)>=a)){c.next=9;break}return c.next=9,a;case 9:c.next=4;break;case 11:c.next=16;break;case 13:c.prev=13,c.t0=c.catch(2),n.e(c.t0);case 16:return c.prev=16,n.f(),c.finish(16);case 19:c.next=41;break;case 21:i=-1,o=(0,Zt.Z)(e),c.prev=23,o.s();case 25:if((u=o.n()).done){c.next=33;break}if(s=u.value,!(null!=(s=t(s,++i,e))&&""!==s&&(s=+s)>=s)){c.next=31;break}return c.next=31,s;case 31:c.next=25;break;case 33:c.next=38;break;case 35:c.prev=35,c.t1=c.catch(23),o.e(c.t1);case 38:return c.prev=38,o.f(),c.finish(38);case 41:case"end":return c.stop()}}),Ou,null,[[2,13,16,19],[23,35,38,41]])}function Zu(e,t,n){var r=Float64Array.from(Ru(e,n));return r.sort(wu),t.map((function(e){return Fu(r,e)}))}function Bu(e,t){return Zu(e,[.25,.5,.75],t)}function zu(e,t){var n=e.length,r=Iu(e,t),a=Bu(e,t),i=(a[2]-a[0])/1.34;return 1.06*(Math.min(r,i)||r||Math.abs(a[0])||1)*Math.pow(n,-.2)}function Lu(e){var t,n,r,a,i,o,u=e.maxbins||20,s=e.base||10,c=Math.log(s),l=e.divide||[5,2],f=e.extent[0],d=e.extent[1],h=e.span||d-f||Math.abs(f)||1;if(e.step)t=e.step;else if(e.steps){for(a=h/u,i=0,o=e.steps.length;i<o&&e.steps[i]<a;++i);t=e.steps[Math.max(0,i-1)]}else{for(n=Math.ceil(Math.log(u)/c),r=e.minstep||0,t=Math.max(r,Math.pow(s,Math.round(Math.log(h)/c)-n));Math.ceil(h/t)>u;)t*=s;for(i=0,o=l.length;i<o;++i)(a=t/l[i])>=r&&h/a<=u&&(t=a)}var p=(a=Math.log(t))>=0?0:1+~~(-a/c),v=Math.pow(s,-p-1);return(e.nice||void 0===e.nice)&&(f=f<(a=Math.floor(f/t+v)*t)?a-t:a,d=Math.ceil(d/t)*t),{start:f,stop:d===f?f+t:d,step:t}}var Pu=Math.random;function ju(e){Pu=e}function Uu(e,t,n,r){if(!e.length)return[void 0,void 0];var a,i,o,u,s=Float64Array.from(Ru(e,r)),c=s.length,l=t;for(o=0,u=Array(l);o<l;++o){for(a=0,i=0;i<c;++i)a+=s[~~(Pu()*c)];u[o]=a/c}return u.sort(wu),[Du(u,n/2),Du(u,1-n/2)]}function Wu(e,t,n,r){r=r||function(e){return e};for(var a,i=e.length,o=new Float64Array(i),u=0,s=1,c=r(e[0]),l=c,f=c+t;s<i;++s){if((a=r(e[s]))>=f){for(l=(c+l)/2;u<s;++u)o[u]=l;f=a+t,c=a}l=a}for(l=(c+l)/2;u<s;++u)o[u]=l;return n?function(e,t){var n,r,a=e.length,i=0,o=1;for(;e[i]===e[o];)++o;for(;o<a;){for(n=o+1;e[o]===e[n];)++n;if(e[o]-e[o-1]<t){for(r=o+(i+n-o-o>>1);r<o;)e[r++]=e[o];for(;r>o;)e[r--]=e[i]}i=o,o=n}return e}(o,t+t/4):o}function Vu(e){return function(){return(e=(1103515245*e+12345)%2147483647)/2147483647}}function Gu(e,t){var n,r,a;null==t&&(t=e,e=0);var i={min:function(e){return arguments.length?(a=r-(n=e||0),i):n},max:function(e){return arguments.length?(a=(r=e||0)-n,i):r},sample:function(){return n+Math.floor(a*Pu())},pdf:function(e){return e===Math.floor(e)&&e>=n&&e<r?1/a:0},cdf:function(e){var t=Math.floor(e);return t<n?0:t>=r?1:(t-n+1)/a},icdf:function(e){return e>=0&&e<=1?n-1+Math.floor(e*a):NaN}};return i.min(e).max(t)}var qu=Math.sqrt(2*Math.PI),Hu=Math.SQRT2,Xu=NaN;function Yu(e,t){e=e||0,t=null==t?1:t;var n,r,a=0,i=0;if(Xu===Xu)a=Xu,Xu=NaN;else{do{n=(a=2*Pu()-1)*a+(i=2*Pu()-1)*i}while(0===n||n>1);a*=r=Math.sqrt(-2*Math.log(n)/n),Xu=i*r}return e+a*t}function Ku(e,t,n){var r=(e-(t||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*qu)}function $u(e,t,n){var r,a=(e-(t=t||0))/(n=null==n?1:n),i=Math.abs(a);if(i>37)r=0;else{var o=Math.exp(-i*i/2);i<7.07106781186547?(r=o*((((((.0352624965998911*i+.700383064443688)*i+6.37396220353165)*i+33.912866078383)*i+112.079291497871)*i+221.213596169931)*i+220.206867912376),r/=((((((.0883883476483184*i+1.75566716318264)*i+16.064177579207)*i+86.7807322029461)*i+296.564248779674)*i+637.333633378831)*i+793.826512519948)*i+440.413735824752):r=o/(i+1/(i+2/(i+3/(i+4/(i+.65)))))/2.506628274631}return a>0?1-r:r}function Qu(e,t,n){return e<0||e>1?NaN:(t||0)+(null==n?1:n)*Hu*function(e){var t,n=-Math.log((1-e)*(1+e));t=n<6.25?1.6536545626831027+(t=.24015818242558962+(t=(t=(t=.00018673420803405714+(t=(t=(t=4.2347877827932404e-7+(t=(t=(t=1.0512122733215323e-9+(t=(t=(t=26335093153082323e-28+(t=(t=(t=6637638134358324e-30+(t=20972767875968562e-33+(t=(t=11157877678025181e-33+(t=128584807152564e-32+(t=(t=-364441206401782e-35)*(n-=3.125)-16850591381820166e-35)*n)*n)*n-1333171662854621e-31)*n)*n)*n-4054566272975207e-29)*n-8151934197605472e-29)*n)*n-12975133253453532e-27)*n-5415412054294628e-26)*n)*n-4.112633980346984e-9)*n-2.9070369957882005e-8)*n)*n-13654692000834679e-22)*n-13882523362786469e-21)*n)*n-.000740702534166267)*n-.006033670871430149)*n)*n:n<16?3.0838856104922208+(t=1.0052589676941592+(t=.005370914553590064+(t=(t=.002491442096107851+(t=(t=.0009532893797373805+(t=(t=24031110387097894e-21+(t=6828485145957318e-20+(t=(t=12475304481671779e-21+(t=29234449089955446e-22+(t=(t=15027403968909828e-22+(t=1.8239629214389228e-8+(t=(t=9.075656193888539e-8+(t=2.2137376921775787e-9)*(n=Math.sqrt(n)-3.25))*n-2.7517406297064545e-7)*n)*n)*n-4013867526981546e-21)*n)*n)*n-47318229009055734e-21)*n)*n)*n-.0003550375203628475)*n)*n-.0016882755560235047)*n)*n-.003751208507569241)*n)*n)*n:Number.isFinite(n)?4.849906401408584+(t=1.0103004648645344+(t=(t=(t=7599527703001776e-20+(t=(t=4526062597223154e-21+(t=(t=2.2900482228026655e-7+(t=(t=2.914795345090108e-8+(t=(t=7.61570120807834e-9+(t=(t=1.5076572693500548e-9+(t=(t=-27109920616438573e-27)*(n=Math.sqrt(n)-5)-2.555641816996525e-10)*n)*n-3.789465440126737e-9)*n)*n-1.496002662714924e-8)*n)*n-6.771199775845234e-8)*n)*n-9.9298272942317e-7)*n)*n-1968177810553167e-20)*n)*n-.00021503011930044477)*n-.00013871931833623122)*n)*n:1/0;return t*e}(2*e-1)}function Ju(e,t){var n,r,a={mean:function(e){return arguments.length?(n=e||0,a):n},stdev:function(e){return arguments.length?(r=null==e?1:e,a):r},sample:function(){return Yu(n,r)},pdf:function(e){return Ku(e,n,r)},cdf:function(e){return $u(e,n,r)},icdf:function(e){return Qu(e,n,r)}};return a.mean(e).stdev(t)}function es(e,t){var n=Ju(),r=0,a={data:function(n){return arguments.length?(e=n,r=n?n.length:0,a.bandwidth(t)):e},bandwidth:function(n){return arguments.length?(!(t=n)&&e&&(t=zu(e)),a):t},sample:function(){return e[~~(Pu()*r)]+t*n.sample()},pdf:function(a){for(var i=0,o=0;o<r;++o)i+=n.pdf((a-e[o])/t);return i/t/r},cdf:function(a){for(var i=0,o=0;o<r;++o)i+=n.cdf((a-e[o])/t);return i/r},icdf:function(){throw Error("KDE icdf not supported.")}};return a.data(e)}function ts(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+Yu()*t)}function ns(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;var r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*qu*e)}function rs(e,t,n){return $u(Math.log(e),t,n)}function as(e,t,n){return Math.exp(Qu(e,t,n))}function is(e,t){var n,r,a={mean:function(e){return arguments.length?(n=e||0,a):n},stdev:function(e){return arguments.length?(r=null==e?1:e,a):r},sample:function(){return ts(n,r)},pdf:function(e){return ns(e,n,r)},cdf:function(e){return rs(e,n,r)},icdf:function(e){return as(e,n,r)}};return a.mean(e).stdev(t)}function os(e,t){var n,r=0;function a(e){var t,n=[],a=0;for(t=0;t<r;++t)a+=n[t]=null==e[t]?1:+e[t];for(t=0;t<r;++t)n[t]/=a;return n}var i={weights:function(e){return arguments.length?(n=a(t=e||[]),i):t},distributions:function(n){return arguments.length?(n?(r=n.length,e=n):(r=0,e=[]),i.weights(t)):e},sample:function(){for(var t=Pu(),a=e[r-1],i=n[0],o=0;o<r-1;i+=n[++o])if(t<i){a=e[o];break}return a.sample()},pdf:function(t){for(var a=0,i=0;i<r;++i)a+=n[i]*e[i].pdf(t);return a},cdf:function(t){for(var a=0,i=0;i<r;++i)a+=n[i]*e[i].cdf(t);return a},icdf:function(){throw Error("Mixture icdf not supported.")}};return i.distributions(e).weights(t)}function us(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*Pu()}function ss(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function cs(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function ls(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function fs(e,t){var n,r,a={min:function(e){return arguments.length?(n=e||0,a):n},max:function(e){return arguments.length?(r=null==e?1:e,a):r},sample:function(){return us(n,r)},pdf:function(e){return ss(e,n,r)},cdf:function(e){return cs(e,n,r)},icdf:function(e){return ls(e,n,r)}};return null==t&&(t=null==e?1:e,e=0),a.min(e).max(t)}function ds(e,t,n,r){var a=r-e*e,i=Math.abs(a)<1e-24?0:(n-e*t)/a;return[t-i*e,i]}function hs(e,t,n,r){e=e.filter((function(e){var r=t(e),a=n(e);return null!=r&&(r=+r)>=r&&null!=a&&(a=+a)>=a})),r&&e.sort((function(e,n){return t(e)-t(n)}));var a,i,o,u,s=e.length,c=new Float64Array(s),l=new Float64Array(s),f=0,d=0,h=0,p=(0,Zt.Z)(e);try{for(p.s();!(u=p.n()).done;)o=u.value,c[f]=a=+t(o),l[f]=i=+n(o),d+=(a-d)/++f,h+=(i-h)/f}catch(v){p.e(v)}finally{p.f()}for(f=0;f<s;++f)c[f]-=d,l[f]-=h;return[c,l,d,h]}function ps(e,t,n,r){var a,i,o,u=-1,s=(0,Zt.Z)(e);try{for(s.s();!(o=s.n()).done;){var c=o.value;a=t(c),i=n(c),null!=a&&(a=+a)>=a&&null!=i&&(i=+i)>=i&&r(a,i,++u)}}catch(l){s.e(l)}finally{s.f()}}function vs(e,t,n,r,a){var i=0,o=0;return ps(e,t,n,(function(e,t){var n=t-a(e),u=t-r;i+=n*n,o+=u*u})),1-i/o}function gs(e,t,n){var r=0,a=0,i=0,o=0,u=0;ps(e,t,n,(function(e,t){++u,r+=(e-r)/u,a+=(t-a)/u,i+=(e*t-i)/u,o+=(e*e-o)/u}));var s=ds(r,a,i,o),c=function(e){return s[0]+s[1]*e};return{coef:s,predict:c,rSquared:vs(e,t,n,a,c)}}function ms(e,t,n){var r=0,a=0,i=0,o=0,u=0;ps(e,t,n,(function(e,t){++u,e=Math.log(e),r+=(e-r)/u,a+=(t-a)/u,i+=(e*t-i)/u,o+=(e*e-o)/u}));var s=ds(r,a,i,o),c=function(e){return s[0]+s[1]*Math.log(e)};return{coef:s,predict:c,rSquared:vs(e,t,n,a,c)}}function ys(e,t,n){var r,a,i,o=hs(e,t,n),u=(0,ku.Z)(o,4),s=u[0],c=(u[1],u[2]),l=u[3],f=0,d=0,h=0,p=0,v=0;ps(e,t,n,(function(e,t){r=s[v++],a=Math.log(t),f+=(t*a-f)/v,d+=((i=r*t)-d)/v,h+=(i*a-h)/v,p+=(r*i-p)/v}));var g=ds(d/l,f/l,h/l,p/l),m=(0,ku.Z)(g,2),y=m[0],b=m[1],x=function(e){return Math.exp(y+b*(e-c))};return{coef:[Math.exp(y-b*c),b],predict:x,rSquared:vs(e,t,n,l,x)}}function bs(e,t,n){var r=0,a=0,i=0,o=0,u=0,s=0;ps(e,t,n,(function(e,t){var n=Math.log(e),c=Math.log(t);++s,r+=(n-r)/s,a+=(c-a)/s,i+=(n*c-i)/s,o+=(n*n-o)/s,u+=(t-u)/s}));var c=ds(r,a,i,o),l=function(e){return c[0]*Math.pow(e,c[1])};return c[0]=Math.exp(c[0]),{coef:c,predict:l,rSquared:vs(e,t,n,u,l)}}function xs(e,t,n){var r,a,i,o,u=hs(e,t,n),s=(0,ku.Z)(u,4),c=s[0],l=s[1],f=s[2],d=s[3],h=c.length,p=0,v=0,g=0,m=0,y=0;for(r=0;r<h;)a=c[r],i=l[r++],p+=((o=a*a)-p)/r,v+=(o*a-v)/r,g+=(o*o-g)/r,m+=(a*i-m)/r,y+=(o*i-y)/r;var b=g-p*p,x=p*b-v*v,k=(y*p-m*v)/x,w=(m*b-y*v)/x,_=-k*p,C=function(e){return k*(e-=f)*e+w*e+_+d};return{coef:[_-w*f+k*f*f+d,w-2*k*f,k],predict:C,rSquared:vs(e,t,n,d,C)}}function ks(e,t,n,r){if(1===r)return gs(e,t,n);if(2===r)return xs(e,t,n);var a,i,o,u,s,c=hs(e,t,n),l=(0,ku.Z)(c,4),f=l[0],d=l[1],h=l[2],p=l[3],v=f.length,g=[],m=[],y=r+1;for(a=0;a<y;++a){for(o=0,u=0;o<v;++o)u+=Math.pow(f[o],a)*d[o];for(g.push(u),s=new Float64Array(y),i=0;i<y;++i){for(o=0,u=0;o<v;++o)u+=Math.pow(f[o],a+i);s[i]=u}m.push(s)}m.push(g);var b=function(e){var t,n,r,a,i,o=e.length-1,u=[];for(t=0;t<o;++t){for(a=t,n=t+1;n<o;++n)Math.abs(e[t][n])>Math.abs(e[t][a])&&(a=n);for(r=t;r<o+1;++r)i=e[r][t],e[r][t]=e[r][a],e[r][a]=i;for(n=t+1;n<o;++n)for(r=o;r>=t;r--)e[r][n]-=e[r][t]*e[t][n]/e[t][t]}for(n=o-1;n>=0;--n){for(i=0,r=n+1;r<o;++r)i+=e[r][n]*u[r];u[n]=(e[o][n]-i)/e[n][n]}return u}(m),x=function(e){e-=h;var t=p+b[0]+b[1]*e+b[2]*e*e;for(a=3;a<y;++a)t+=b[a]*Math.pow(e,a);return t};return{coef:ws(y,b,-h,p),predict:x,rSquared:vs(e,t,n,p,x)}}function ws(e,t,n,r){var a,i,o,u,s=Array(e);for(a=0;a<e;++a)s[a]=0;for(a=e-1;a>=0;--a)for(o=t[a],u=1,s[a]+=o,i=1;i<=a;++i)u*=(a+1-i)/i,s[a-i]+=o*Math.pow(n,i)*u;return s[0]+=r,s}function _s(e,t,n,r){for(var a=hs(e,t,n,!0),i=(0,ku.Z)(a,4),o=i[0],u=i[1],s=i[2],c=i[3],l=o.length,f=Math.max(2,~~(r*l)),d=new Float64Array(l),h=new Float64Array(l),p=new Float64Array(l).fill(1),v=-1;++v<=2;){for(var g=[0,f-1],m=0;m<l;++m){for(var y=o[m],b=g[0],x=g[1],k=y-o[b]>o[x]-y?b:x,w=0,_=0,C=0,S=0,A=0,E=1/Math.abs(o[k]-y||1),T=b;T<=x;++T){var N=o[T],D=u[T],F=Cs(Math.abs(y-N)*E)*p[T],I=N*F;w+=F,_+=I,C+=D*F,S+=D*I,A+=N*I}var M=ds(_/w,C/w,S/w,A/w),O=(0,ku.Z)(M,2),R=O[0],Z=O[1];d[m]=R+Z*y,h[m]=Math.abs(u[m]-d[m]),Ss(o,m+1,g)}if(2===v)break;var B=Mu(h);if(Math.abs(B)<1e-12)break;for(var z,L,P=0;P<l;++P)z=h[P]/(6*B),p[P]=z>=1?1e-12:(L=1-z*z)*L}return function(e,t,n,r){for(var a,i=e.length,o=[],u=0,s=0,c=[];u<i;++u)a=e[u]+n,c[0]===a?c[1]+=(t[u]-c[1])/++s:(s=0,c[1]+=r,c=[a,t[u]],o.push(c));return c[1]+=r,o}(o,d,s,c)}function Cs(e){return(e=1-e*e*e)*e*e}function Ss(e,t,n){var r=e[t],a=n[0],i=n[1]+1;if(!(i>=e.length))for(;t>a&&e[i]-r<=r-e[a];)n[0]=++a,n[1]=i,++i}var As=.5*Math.PI/180;function Es(e,t,n,r){n=n||25,r=Math.max(n,r||200);var a=function(t){return[t,e(t)]},i=t[0],o=t[1],u=o-i,s=u/r,c=[a(i)],l=[];if(n===r){for(var f=1;f<r;++f)c.push(a(i+f/n*u));return c.push(a(o)),c}l.push(a(o));for(var d=n;--d>0;)l.push(a(i+d/n*u));for(var h=c[0],p=l[l.length-1],v=1/u,g=function(e,t){for(var n=e,r=e,a=t.length,i=0;i<a;++i){var o=t[i][1];o<n&&(n=o),o>r&&(r=o)}return 1/(r-n)}(h[1],l);p;){var m=a((h[0]+p[0])/2);m[0]-h[0]>=s&&Ts(h,m,p,v,g)>As?l.push(m):(h=p,c.push(p),l.pop()),p=l[l.length-1]}return c}function Ts(e,t,n,r,a){var i=Math.atan2(a*(n[1]-e[1]),r*(n[0]-e[0])),o=Math.atan2(a*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(i-o)}function Ns(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e+r*n;return i}function Ds(e){var t=e,n=e;function r(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)<0?r=i+1:a=i}return r}return 1===e.length&&(t=function(t,n){return e(t)-n},n=function(e){return function(t,n){return wu(e(t),n)}}(e)),{left:r,center:function(e,n,a,i){null==a&&(a=0),null==i&&(i=e.length);var o=r(e,n,a,i-1);return o>a&&t(e[o-1],n)>-t(e[o],n)?o-1:o},right:function(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)>0?a=i:r=i+1}return r}}}var Fs=new Date,Is=new Date;function Ms(e,t,n,r){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=function(t){return e(t=new Date(+t)),t},a.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},a.round=function(e){var t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},a.range=function(n,r,i){var o,u=[];if(n=a.ceil(n),i=null==i?1:Math.floor(i),!(n<r)||!(i>0))return u;do{u.push(o=new Date(+n)),t(n,i),e(n)}while(o<n&&n<r);return u},a.filter=function(n){return Ms((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(a.count=function(t,r){return Fs.setTime(+t),Is.setTime(+r),e(Fs),e(Is),Math.floor(n(Fs,Is))},a.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?function(t){return r(t)%e===0}:function(t){return a.count(0,t)%e===0}):a:null}),a}var Os=1e3,Rs=6e4,Zs=36e5,Bs=864e5,zs=6048e5,Ls=2592e6,Ps=31536e6,js=Ms((function(e){return e.setHours(0,0,0,0)}),(function(e,t){return e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Rs)/Bs}),(function(e){return e.getDate()-1})),Us=js;js.range;function Ws(e){return Ms((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Rs)/zs}))}var Vs=Ws(0),Gs=Ws(1),qs=Ws(2),Hs=Ws(3),Xs=Ws(4),Ys=Ws(5),Ks=Ws(6),$s=(Vs.range,Gs.range,qs.range,Hs.range,Xs.range,Ys.range,Ks.range,Ms((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/Bs}),(function(e){return e.getUTCDate()-1}))),Qs=$s;$s.range;function Js(e){return Ms((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/zs}))}var ec=Js(0),tc=Js(1),nc=Js(2),rc=Js(3),ac=Js(4),ic=Js(5),oc=Js(6),uc=(ec.range,tc.range,nc.range,rc.range,ac.range,ic.range,oc.range,Ms((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()})));uc.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Ms((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var sc=uc,cc=(uc.range,Ms((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()}))),lc=cc,fc=(cc.range,Ms((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Os-e.getMinutes()*Rs)}),(function(e,t){e.setTime(+e+t*Zs)}),(function(e,t){return(t-e)/Zs}),(function(e){return e.getHours()}))),dc=fc,hc=(fc.range,Ms((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Os)}),(function(e,t){e.setTime(+e+t*Rs)}),(function(e,t){return(t-e)/Rs}),(function(e){return e.getMinutes()}))),pc=hc,vc=(hc.range,Ms((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*Os)}),(function(e,t){return(t-e)/Os}),(function(e){return e.getUTCSeconds()}))),gc=vc,mc=(vc.range,Ms((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e})));mc.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?Ms((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):mc:null};var yc=mc,bc=(mc.range,Ms((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()})));bc.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Ms((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var xc,kc,wc,_c,Cc,Sc,Ac,Ec=bc,Tc=(bc.range,Ms((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()}))),Nc=Tc,Dc=(Tc.range,Ms((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*Zs)}),(function(e,t){return(t-e)/Zs}),(function(e){return e.getUTCHours()}))),Fc=Dc,Ic=(Dc.range,Ms((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*Rs)}),(function(e,t){return(t-e)/Rs}),(function(e){return e.getUTCMinutes()}))),Mc=Ic,Oc=(Ic.range,Math.sqrt(50)),Rc=Math.sqrt(10),Zc=Math.sqrt(2);function Bc(e,t,n){var r,a,i,o,u=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];if((r=t<e)&&(a=e,e=t,t=a),0===(o=zc(e,t,n))||!isFinite(o))return[];if(o>0){var s=Math.round(e/o),c=Math.round(t/o);for(s*o<e&&++s,c*o>t&&--c,i=new Array(a=c-s+1);++u<a;)i[u]=(s+u)*o}else{o=-o;var l=Math.round(e*o),f=Math.round(t*o);for(l/o<e&&++l,f/o>t&&--f,i=new Array(a=f-l+1);++u<a;)i[u]=(l+u)/o}return r&&i.reverse(),i}function zc(e,t,n){var r=(t-e)/Math.max(0,n),a=Math.floor(Math.log(r)/Math.LN10),i=r/Math.pow(10,a);return a>=0?(i>=Oc?10:i>=Rc?5:i>=Zc?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(i>=Oc?10:i>=Rc?5:i>=Zc?2:1)}function Lc(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/a;return i>=Oc?a*=10:i>=Rc?a*=5:i>=Zc&&(a*=2),t<e?-a:a}var Pc="year",jc="quarter",Uc="month",Wc="week",Vc="date",Gc="day",qc="dayofyear",Hc="hours",Xc="minutes",Yc="seconds",Kc="milliseconds",$c=[Pc,jc,Uc,Wc,Vc,Gc,qc,Hc,Xc,Yc,Kc],Qc=$c.reduce((function(e,t,n){return e[t]=1+n,e}),{});function Jc(e){var t=Ye(e).slice(),n={};return t.length||se("Missing time unit."),t.forEach((function(e){ct(Qc,e)?n[e]=1:se("Invalid time unit: ".concat(e,"."))})),(n[Wc]||n[Gc]?1:0)+(n[jc]||n[Uc]||n[Vc]?1:0)+(n[qc]?1:0)>1&&se("Incompatible time units: ".concat(e)),t.sort((function(e,t){return Qc[e]-Qc[t]})),t}var el=(xc={},(0,qn.Z)(xc,Pc,"%Y "),(0,qn.Z)(xc,jc,"Q%q "),(0,qn.Z)(xc,Uc,"%b "),(0,qn.Z)(xc,Vc,"%d "),(0,qn.Z)(xc,Wc,"W%U "),(0,qn.Z)(xc,Gc,"%a "),(0,qn.Z)(xc,qc,"%j "),(0,qn.Z)(xc,Hc,"%H:00"),(0,qn.Z)(xc,Xc,"00:%M"),(0,qn.Z)(xc,Yc,":%S"),(0,qn.Z)(xc,Kc,".%L"),(0,qn.Z)(xc,"".concat(Pc,"-").concat(Uc),"%Y-%m "),(0,qn.Z)(xc,"".concat(Pc,"-").concat(Uc,"-").concat(Vc),"%Y-%m-%d "),(0,qn.Z)(xc,"".concat(Hc,"-").concat(Xc),"%H:%M"),xc);function tl(e,t){var n,r,a=it({},el,t),i=Jc(e),o=i.length,u="",s=0;for(s=0;s<o;)for(n=i.length;n>s;--n)if(null!=a[r=i.slice(s,n).join("-")]){u+=a[r],s=n;break}return u.trim()}var nl=new Date;function rl(e){return nl.setFullYear(e),nl.setMonth(0),nl.setDate(1),nl.setHours(0,0,0,0),nl}function al(e){return ol(new Date(e))}function il(e){return ul(new Date(e))}function ol(e){return Us.count(rl(e.getFullYear())-1,e)}function ul(e){return Vs.count(rl(e.getFullYear())-1,e)}function sl(e){return rl(e).getDay()}function cl(e,t,n,r,a,i,o){if(0<=e&&e<100){var u=new Date(-1,t,n,r,a,i,o);return u.setFullYear(e),u}return new Date(e,t,n,r,a,i,o)}function ll(e){return dl(new Date(e))}function fl(e){return hl(new Date(e))}function dl(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return Qs.count(t-1,e)}function hl(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return ec.count(t-1,e)}function pl(e){return nl.setTime(Date.UTC(e,0,1)),nl.getUTCDay()}function vl(e,t,n,r,a,i,o){if(0<=e&&e<100){var u=new Date(Date.UTC(-1,t,n,r,a,i,o));return u.setUTCFullYear(n.y),u}return new Date(Date.UTC(e,t,n,r,a,i,o))}function gl(e,t,n,r,a){var i=t||1,o=De(e),u=function(e,t,a){return function(e,t,n,r){var a=n<=1?e:r?function(t,a){return r+n*Math.floor((e(t,a)-r)/n)}:function(t,r){return n*Math.floor(e(t,r)/n)};return t?function(e,n){return t(a(e,n),n)}:a}(n[a=a||e],r[a],e===o&&i,t)},s=new Date,c=Mt(e),l=c[Pc]?u(Pc):rt(2012),f=c[Uc]?u(Uc):c[jc]?u(jc):he,d=c[Wc]&&c[Gc]?u(Gc,1,Wc+Gc):c[Wc]?u(Wc,1):c[Gc]?u(Gc,1):c[Vc]?u(Vc,1):c[qc]?u(qc,1):pe,h=c[Hc]?u(Hc):he,p=c[Xc]?u(Xc):he,v=c[Yc]?u(Yc):he,g=c[Kc]?u(Kc):he;return function(e){s.setTime(+e);var t=l(s);return a(t,f(s),d(s,t),h(s),p(s),v(s),g(s))}}function ml(e,t,n){return t+7*e-(n+6)%7}var yl=(kc={},(0,qn.Z)(kc,Pc,(function(e){return e.getFullYear()})),(0,qn.Z)(kc,jc,(function(e){return Math.floor(e.getMonth()/3)})),(0,qn.Z)(kc,Uc,(function(e){return e.getMonth()})),(0,qn.Z)(kc,Vc,(function(e){return e.getDate()})),(0,qn.Z)(kc,Hc,(function(e){return e.getHours()})),(0,qn.Z)(kc,Xc,(function(e){return e.getMinutes()})),(0,qn.Z)(kc,Yc,(function(e){return e.getSeconds()})),(0,qn.Z)(kc,Kc,(function(e){return e.getMilliseconds()})),(0,qn.Z)(kc,qc,(function(e){return ol(e)})),(0,qn.Z)(kc,Wc,(function(e){return ul(e)})),(0,qn.Z)(kc,Wc+Gc,(function(e,t){return ml(ul(e),e.getDay(),sl(t))})),(0,qn.Z)(kc,Gc,(function(e,t){return ml(1,e.getDay(),sl(t))})),kc),bl=(wc={},(0,qn.Z)(wc,jc,(function(e){return 3*e})),(0,qn.Z)(wc,Wc,(function(e,t){return ml(e,0,sl(t))})),wc);function xl(e,t){return gl(e,t||1,yl,bl,cl)}var kl=(_c={},(0,qn.Z)(_c,Pc,(function(e){return e.getUTCFullYear()})),(0,qn.Z)(_c,jc,(function(e){return Math.floor(e.getUTCMonth()/3)})),(0,qn.Z)(_c,Uc,(function(e){return e.getUTCMonth()})),(0,qn.Z)(_c,Vc,(function(e){return e.getUTCDate()})),(0,qn.Z)(_c,Hc,(function(e){return e.getUTCHours()})),(0,qn.Z)(_c,Xc,(function(e){return e.getUTCMinutes()})),(0,qn.Z)(_c,Yc,(function(e){return e.getUTCSeconds()})),(0,qn.Z)(_c,Kc,(function(e){return e.getUTCMilliseconds()})),(0,qn.Z)(_c,qc,(function(e){return dl(e)})),(0,qn.Z)(_c,Wc,(function(e){return hl(e)})),(0,qn.Z)(_c,Gc,(function(e,t){return ml(1,e.getUTCDay(),pl(t))})),(0,qn.Z)(_c,Wc+Gc,(function(e,t){return ml(hl(e),e.getUTCDay(),pl(t))})),_c),wl=(Cc={},(0,qn.Z)(Cc,jc,(function(e){return 3*e})),(0,qn.Z)(Cc,Wc,(function(e,t){return ml(e,0,pl(t))})),Cc);function _l(e,t){return gl(e,t||1,kl,wl,vl)}var Cl=(Sc={},(0,qn.Z)(Sc,Pc,sc),(0,qn.Z)(Sc,jc,lc.every(3)),(0,qn.Z)(Sc,Uc,lc),(0,qn.Z)(Sc,Wc,Vs),(0,qn.Z)(Sc,Vc,Us),(0,qn.Z)(Sc,Gc,Us),(0,qn.Z)(Sc,qc,Us),(0,qn.Z)(Sc,Hc,dc),(0,qn.Z)(Sc,Xc,pc),(0,qn.Z)(Sc,Yc,gc),(0,qn.Z)(Sc,Kc,yc),Sc),Sl=(Ac={},(0,qn.Z)(Ac,Pc,Ec),(0,qn.Z)(Ac,jc,Nc.every(3)),(0,qn.Z)(Ac,Uc,Nc),(0,qn.Z)(Ac,Wc,ec),(0,qn.Z)(Ac,Vc,Qs),(0,qn.Z)(Ac,Gc,Qs),(0,qn.Z)(Ac,qc,Qs),(0,qn.Z)(Ac,Hc,Fc),(0,qn.Z)(Ac,Xc,Mc),(0,qn.Z)(Ac,Yc,gc),(0,qn.Z)(Ac,Kc,yc),Ac);function Al(e){return Cl[e]}function El(e){return Sl[e]}function Tl(e,t,n){return e?e.offset(t,n):void 0}function Nl(e,t,n){return Tl(Al(e),t,n)}function Dl(e,t,n){return Tl(El(e),t,n)}function Fl(e,t,n,r){return e?e.range(t,n,r):void 0}function Il(e,t,n,r){return Fl(Al(e),t,n,r)}function Ml(e,t,n,r){return Fl(El(e),t,n,r)}var Ol=1e3,Rl=6e4,Zl=36e5,Bl=864e5,zl=2592e6,Ll=31536e6,Pl=[Pc,Uc,Vc,Hc,Xc,Yc,Kc],jl=Pl.slice(0,-1),Ul=jl.slice(0,-1),Wl=Ul.slice(0,-1),Vl=Wl.slice(0,-1),Gl=[Pc,Uc],ql=[Pc],Hl=[[jl,1,Ol],[jl,5,5e3],[jl,15,15e3],[jl,30,3e4],[Ul,1,Rl],[Ul,5,3e5],[Ul,15,9e5],[Ul,30,18e5],[Wl,1,Zl],[Wl,3,108e5],[Wl,6,216e5],[Wl,12,432e5],[Vl,1,Bl],[[Pc,Wc],1,6048e5],[Gl,1,zl],[Gl,3,7776e6],[ql,1,Ll]];function Xl(e){var t,n,r=e.extent,a=e.maxbins||40,i=Math.abs(Et(r))/a,o=Ds((function(e){return e[2]})).right(Hl,i);return o===Hl.length?(t=ql,n=Lc(r[0]/Ll,r[1]/Ll,a)):o?(t=(o=Hl[i/Hl[o-1][2]<Hl[o][2]/i?o-1:o])[0],n=o[1]):(t=Pl,n=Math.max(Lc(r[0],r[1],a),1)),{units:t,step:n}}function Yl(e){return e&&e.length?1===e.length?e[0]:(t=e,function(e){for(var n=t.length,r=1,a=String(t[0](e));r<n;++r)a+="|"+t[r](e);return a}):function(){return""};var t}function Kl(e,t,n){return n||e+(t?"_"+t:"")}var $l=function(){},Ql={init:$l,add:$l,rem:$l,idx:0},Jl={values:{init:function(e){return e.cell.store=!0},value:function(e){return e.cell.data.values()},idx:-1},count:{value:function(e){return e.cell.num}},__count__:{value:function(e){return e.missing+e.valid}},missing:{value:function(e){return e.missing}},valid:{value:function(e){return e.valid}},sum:{init:function(e){return e.sum=0},value:function(e){return e.sum},add:function(e,t){return e.sum+=+t},rem:function(e,t){return e.sum-=t}},product:{init:function(e){return e.product=1},value:function(e){return e.valid?e.product:void 0},add:function(e,t){return e.product*=t},rem:function(e,t){return e.product/=t}},mean:{init:function(e){return e.mean=0},value:function(e){return e.valid?e.mean:void 0},add:function(e,t){return e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid},rem:function(e,t){return e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean}},average:{value:function(e){return e.valid?e.mean:void 0},req:["mean"],idx:1},variance:{init:function(e){return e.dev=0},value:function(e){return e.valid>1?e.dev/(e.valid-1):void 0},add:function(e,t){return e.dev+=e.mean_d*(t-e.mean)},rem:function(e,t){return e.dev-=e.mean_d*(t-e.mean)},req:["mean"],idx:1},variancep:{value:function(e){return e.valid>1?e.dev/e.valid:void 0},req:["variance"],idx:2},stdev:{value:function(e){return e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0},req:["variance"],idx:2},stdevp:{value:function(e){return e.valid>1?Math.sqrt(e.dev/e.valid):void 0},req:["variance"],idx:2},stderr:{value:function(e){return e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0},req:["variance"],idx:2},distinct:{value:function(e){return e.cell.data.distinct(e.get)},req:["values"],idx:3},ci0:{value:function(e){return e.cell.data.ci0(e.get)},req:["values"],idx:3},ci1:{value:function(e){return e.cell.data.ci1(e.get)},req:["values"],idx:3},median:{value:function(e){return e.cell.data.q2(e.get)},req:["values"],idx:3},q1:{value:function(e){return e.cell.data.q1(e.get)},req:["values"],idx:3},q3:{value:function(e){return e.cell.data.q3(e.get)},req:["values"],idx:3},min:{init:function(e){return e.min=void 0},value:function(e){return e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min},add:function(e,t){(t<e.min||void 0===e.min)&&(e.min=t)},rem:function(e,t){t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:function(e){return e.max=void 0},value:function(e){return e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max},add:function(e,t){(t>e.max||void 0===e.max)&&(e.max=t)},rem:function(e,t){t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:function(e){return e.argmin=void 0},value:function(e){return e.argmin||e.cell.data.argmin(e.get)},add:function(e,t,n){t<e.min&&(e.argmin=n)},rem:function(e,t){t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:function(e){return e.argmax=void 0},value:function(e){return e.argmax||e.cell.data.argmax(e.get)},add:function(e,t,n){t>e.max&&(e.argmax=n)},rem:function(e,t){t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},ef=Object.keys(Jl);function tf(e,t){return Jl[e](t)}function nf(e,t){return e.idx-t.idx}function rf(){var e=this;this.valid=0,this.missing=0,this._ops.forEach((function(t){return t.init(e)}))}function af(e,t){var n=this;null!=e&&""!==e?e===e&&(++this.valid,this._ops.forEach((function(r){return r.add(n,e,t)}))):++this.missing}function of(e,t){var n=this;null!=e&&""!==e?e===e&&(--this.valid,this._ops.forEach((function(r){return r.rem(n,e,t)}))):--this.missing}function uf(e){var t=this;return this._out.forEach((function(n){return e[n.out]=n.value(t)})),e}function sf(e,t){var n=t||de,r=function(e){var t={};return e.forEach((function(e){return t[e.name]=e})),e.forEach((function e(n){n.req&&n.req.forEach((function(n){t[n]||e(t[n]=Jl[n]())}))})),Object.values(t).sort(nf)}(e),a=e.slice().sort(nf);function i(e){this._ops=r,this._out=a,this.cell=e,this.init()}return i.prototype.init=rf,i.prototype.add=af,i.prototype.rem=of,i.prototype.set=uf,i.prototype.get=n,i.fields=e.map((function(e){return e.out})),i}function cf(e){this._key=e?le(e):Mo,this.reset()}ef.forEach((function(e){Jl[e]=function(e,t){return function(n){return it({name:e,out:n||e},Ql,t)}}(e,Jl[e])}));var lf=cf.prototype;function ff(e){mu.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}lf.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},lf.add=function(e){this._add.push(e)},lf.rem=function(e){this._rem.push(e)},lf.values=function(){if(this._get=null,0===this._rem.length)return this._add;var e,t,n,r=this._add,a=this._rem,i=this._key,o=r.length,u=a.length,s=Array(o-u),c={};for(e=0;e<u;++e)c[i(a[e])]=1;for(e=0,t=0;e<o;++e)c[i(n=r[e])]?c[i(n)]=0:s[t++]=n;return this._rem=[],this._add=s},lf.distinct=function(e){for(var t,n=this.values(),r={},a=n.length,i=0;--a>=0;)ct(r,t=e(n[a])+"")||(r[t]=1,++i);return i},lf.extent=function(e){if(this._get!==e||!this._ext){var t=this.values(),n=ut(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},lf.argmin=function(e){return this.extent(e)[0]||{}},lf.argmax=function(e){return this.extent(e)[1]||{}},lf.min=function(e){var t=this.extent(e)[0];return null!=t?e(t):void 0},lf.max=function(e){var t=this.extent(e)[1];return null!=t?e(t):void 0},lf.quartile=function(e){return this._get===e&&this._q||(this._q=Bu(this.values(),e),this._get=e),this._q},lf.q1=function(e){return this.quartile(e)[0]},lf.q2=function(e){return this.quartile(e)[1]},lf.q3=function(e){return this.quartile(e)[2]},lf.ci=function(e){return this._get===e&&this._ci||(this._ci=Uu(this.values(),1e3,.05,e),this._get=e),this._ci},lf.ci0=function(e){return this.ci(e)[0]},lf.ci1=function(e){return this.ci(e)[1]},ff.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:ef},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},ht(ff,mu,{transform:function(e,t){var n=this,r=this,a=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return r.stamp=a.stamp,r.value&&(i||t.modified(r._inputs,!0))?(r._prev=r.value,r.value=i?r.init(e):{},t.visit(t.SOURCE,(function(e){return r.add(e)}))):(r.value=r.value||r.init(e),t.visit(t.REM,(function(e){return r.rem(e)})),t.visit(t.ADD,(function(e){return r.add(e)}))),a.modifies(r._outputs),r._drop=!1!==e.drop,e.cross&&r._dims.length>1&&(r._drop=!1,r.cross()),t.clean()&&r._drop&&a.clean(!0).runAfter((function(){return n.clean()})),r.changes(a)},cross:function(){var e=this,t=e.value,n=e._dnames,r=n.map((function(){return{}})),a=n.length;function i(e){var t,i,o,u;for(t in e)for(o=e[t].tuple,i=0;i<a;++i)r[i][u=o[n[i]]]=u}i(e._prev),i(t),function i(o,u,s){var c=n[s],l=r[s++];for(var f in l){var d=o?o+"|"+f:f;u[c]=l[f],s<a?i(d,u,s):t[d]||e.cell(d,u)}}("",{},0)},init:function(e){var t=this._inputs=[],n=this._outputs=[],r={};function a(e){for(var n,a=Ye(ae(e)),i=a.length,o=0;o<i;++o)r[n=a[o]]||(r[n]=1,t.push(n))}this._dims=Ye(e.groupby),this._dnames=this._dims.map((function(e){var t=re(e);return a(e),n.push(t),t})),this.cellkey=e.key?e.key:Yl(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];var i,o,u,s,c,l,f=e.fields||[null],d=e.ops||["count"],h=e.as||[],p=f.length,v={};for(p!==d.length&&se("Unmatched number of fields and aggregate ops."),l=0;l<p;++l)i=f[l],o=d[l],null==i&&"count"!==o&&se("Null aggregate field specified."),c=Kl(o,s=re(i),h[l]),n.push(c),"count"!==o?((u=v[s])||(a(i),(u=v[s]=[]).field=i,this._measures.push(u)),"count"!==o&&(this._countOnly=!1),u.push(tf(o,c))):this._counts.push(c);return this._measures=this._measures.map((function(e){return sf(e,e.field)})),{}},cellkey:Yl(),cell:function(e,t){var n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell:function(e,t){var n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){var r=this._measures,a=r.length;n.agg=Array(a);for(var i=0;i<a;++i)n.agg[i]=new r[i](n)}return n.store&&(n.data=new cf),n},newtuple:function(e,t){for(var n=this._dnames,r=this._dims,a=r.length,i={},o=0;o<a;++o)i[n[o]]=r[o](e);return t?zo(t.tuple,i):Ro(i)},clean:function(){var e=this.value;for(var t in e)0===e[t].num&&delete e[t]},add:function(e){var t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,!this._countOnly){n.store&&n.data.add(e);for(var r=n.agg,a=0,i=r.length;a<i;++a)r[a].add(r[a].get(e),e)}},rem:function(e){var t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,!this._countOnly){n.store&&n.data.rem(e);for(var r=n.agg,a=0,i=r.length;a<i;++a)r[a].rem(r[a].get(e),e)}},celltuple:function(e){var t=e.tuple,n=this._counts;e.store&&e.data.values();for(var r=0,a=n.length;r<a;++r)t[n[r]]=e.num;if(!this._countOnly)for(var i=e.agg,o=0,u=i.length;o<u;++o)i[o].set(t);return t},changes:function(e){var t,n,r,a,i=this._adds,o=this._mods,u=this._prev,s=this._drop,c=e.add,l=e.rem,f=e.mod;if(u)for(n in u)t=u[n],s&&!t.num||l.push(t.tuple);for(r=0,a=this._alen;r<a;++r)c.push(this.celltuple(i[r])),i[r]=null;for(r=0,a=this._mlen;r<a;++r)(0===(t=o[r]).num&&s?l:f).push(this.celltuple(t)),o[r]=null;return this._alen=this._mlen=0,this._prev=null,e}});function df(e){mu.call(this,null,e)}function hf(e,t,n){var r=e,a=t||[],i=n||[],o={},u=0;return{add:function(e){return i.push(e)},remove:function(e){return o[r(e)]=++u},size:function(){return a.length},data:function(e,t){return u&&(a=a.filter((function(e){return!o[r(e)]})),o={},u=0),t&&e&&a.sort(e),i.length&&(a=e?Ct(e,a,i.sort(e)):a.concat(i),i=[]),a}}}function pf(e){mu.call(this,[],e)}function vf(e){qo.call(this,null,gf,e)}function gf(e){return this.value&&!e.modified()?this.value:Qe(e.fields,e.orders)}function mf(e){mu.call(this,null,e)}function yf(e){mu.call(this,null,e)}df.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},ht(df,mu,{transform:function(e,t){var n,r=!1!==e.interval,a=this._bins(e),i=a.start,o=a.step,u=e.as||["bin0","bin1"],s=u[0],c=u[1];return n=e.modified()?(t=t.reflow(!0)).SOURCE:t.modified(ae(e.field))?t.ADD_MOD:t.ADD,t.visit(n,r?function(e){var t=a(e);e[s]=t,e[c]=null==t?null:i+o*(1+(t-i)/o)}:function(e){return e[s]=a(e)}),t.modifies(r?u:s)},_bins:function(e){if(this.value&&!e.modified())return this.value;var t,n,r=e.field,a=Lu(e),i=a.step,o=a.start,u=o+Math.ceil((a.stop-o)/i)*i;null!=(t=e.anchor)&&(n=t-(o+i*Math.floor((t-o)/i)),o+=n,u+=n);var s=function(e){var t=Fe(r(e));return null==t?null:t<o?-1/0:t>u?1/0:(t=Math.max(o,Math.min(t,u-i)),o+i*Math.floor(1e-14+(t-o)/i))};return s.start=o,s.stop=a.stop,s.step=i,this.value=ne(s,ae(r),e.name||"bin_"+re(r))}}),pf.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},ht(pf,mu,{transform:function(e,t){var n=t.fork(t.ALL),r=hf(Mo,this.value,n.materialize(n.ADD).add),a=e.sort,i=t.changed()||a&&(e.modified("sort")||t.modified(a.fields));return n.visit(n.REM,r.remove),this.modified(i),this.value=n.source=r.data(Lo(a),i),t.source&&t.source.root&&(this.value.root=t.source.root),n}}),ht(vf,qo),mf.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},ht(mf,mu,{transform:function(e,t){var n=function(t){return function(n){for(var r,a=function(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e.match(n)}(u(n),e.case,i)||[],s=0,c=a.length;s<c;++s)o.test(r=a[s])||t(r)}},r=this._parameterCheck(e,t),a=this._counts,i=this._match,o=this._stop,u=e.field,s=e.as||["text","count"],c=n((function(e){return a[e]=1+(a[e]||0)})),l=n((function(e){return a[e]-=1}));return r?t.visit(t.SOURCE,c):(t.visit(t.ADD,c),t.visit(t.REM,l)),this._finish(t,s)},_parameterCheck:function(e,t){var n=!1;return!e.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),!e.modified("pattern")&&this._match||(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish:function(e,t){var n,r,a,i=this._counts,o=this._tuples||(this._tuples={}),u=t[0],s=t[1],c=e.fork(e.NO_SOURCE|e.NO_FIELDS);for(n in i)r=o[n],a=i[n]||0,!r&&a?(o[n]=r=Ro({}),r[u]=n,r[s]=a,c.add.push(r)):0===a?(r&&c.rem.push(r),i[n]=null,o[n]=null):r[s]!==a&&(r[s]=a,c.mod.push(r));return c.modifies(t)}}),yf.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},ht(yf,mu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],a=r[0],i=r[1],o=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter"),u=this.value;return o?(u&&(n.rem=u),u=t.materialize(t.SOURCE).source,n.add=this.value=function(e,t,n,r){for(var a,i,o=[],u={},s=e.length,c=0;c<s;++c)for(u[t]=i=e[c],a=0;a<s;++a)u[n]=e[a],r(u)&&(o.push(Ro(u)),(u={})[t]=i);return o}(u,a,i,e.filter||ve)):n.mod=u,n.source=this.value,n.modifies(r)}});var bf={kde:es,mixture:os,normal:Ju,lognormal:is,uniform:fs},xf="function";function kf(e,t){var n=e[xf];ct(bf,n)||se("Unknown distribution function: "+n);var r=bf[n]();for(var a in e)"field"===a?r.data((e.from||t()).map(e[a])):"distributions"===a?r[a](e[a].map((function(e){return kf(e,t)}))):typeof r[a]===xf&&r[a](e[a]);return r}function wf(e){mu.call(this,null,e)}var _f=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Cf={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:_f},{name:"weights",type:"number",array:!0}]};function Sf(e,t){return e?e.map((function(e,n){return t[n]||re(e)})):null}function Af(e,t,n){var r,a,i,o,u,s,c=[],l=function(e){return e(o)};if(null==t)c.push(e.map(n));else for(r={},a=0,i=e.length;a<i;++a)o=e[a],(s=r[u=t.map(l)])||(r[u]=s=[],s.dims=u,c.push(s)),s.push(n(o));return c}wf.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:_f.concat(Cf)},{name:"as",type:"string",array:!0,default:["value","density"]}]},ht(wf,mu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=kf(e.distribution,function(e){return function(){return e.materialize(e.SOURCE).source}}(t)),a=e.steps||e.minsteps||25,i=e.steps||e.maxsteps||200,o=e.method||"pdf";"pdf"!==o&&"cdf"!==o&&se("Invalid density method: "+o),e.extent||r.data||se("Missing density extent parameter."),o=r[o];var u=e.as||["value","density"],s=Es(o,e.extent||ot(r.data()),a,i).map((function(e){var t={};return t[u[0]]=e[0],t[u[1]]=e[1],Ro(t)}));this.value&&(n.rem=this.value),this.value=n.add=n.source=s}return n}});function Ef(e){mu.call(this,null,e)}Ef.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]};function Tf(e){qo.call(this,null,Nf,e),this.modified(!0)}function Nf(e){var t=e.expr;return this.value&&!e.modified("expr")?this.value:ne((function(n){return t(n,e)}),ae(t),re(t))}function Df(e){mu.call(this,[void 0,void 0],e)}function Ff(e,t){qo.call(this,e),this.parent=t,this.count=0}function If(e){mu.call(this,{},e),this._keys=ft();var t=this._targets=[];t.active=0,t.forEach=function(e){for(var n=0,r=t.active;n<r;++n)e(t[n],n,t)}}function Mf(e){qo.call(this,null,Of,e)}function Of(e){return this.value&&!e.modified()?this.value:Ce(e.name)?Ye(e.name).map((function(e){return le(e)})):le(e.name,e.as)}function Rf(e){mu.call(this,ft(),e)}function Zf(e){mu.call(this,[],e)}function Bf(e){mu.call(this,[],e)}function zf(e){mu.call(this,null,e)}function Lf(e){mu.call(this,[],e)}ht(Ef,mu,{transform:function(e,t){if(this.value&&!e.modified()&&!t.changed())return t;for(var n,r=t.materialize(t.SOURCE).source,a=Af(t.source,e.groupby,de),i=e.smooth||!1,o=e.field,u=e.step||function(e,t){return Et(ot(e,t))/30}(r,o),s=Lo((function(e,t){return o(e)-o(t)})),c=e.as||"bin",l=a.length,f=1/0,d=-1/0,h=0;h<l;++h){var p=a[h].sort(s);n=-1;var v,g=(0,Zt.Z)(Wu(p,u,i,o));try{for(g.s();!(v=g.n()).done;){var m=v.value;m<f&&(f=m),m>d&&(d=m),p[++n][c]=m}}catch(y){g.e(y)}finally{g.f()}}return this.value={start:f,stop:d,step:u},t.reflow(!0).modifies(c)}}),ht(Tf,qo),Df.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},ht(Df,mu,{transform:function(e,t){var n=this.value,r=e.field,a=t.changed()||t.modified(r.fields)||e.modified("field"),i=n[0],o=n[1];if((a||null==i)&&(i=1/0,o=-1/0),t.visit(a?t.SOURCE:t.ADD,(function(e){var t=Fe(r(e));null!=t&&(t<i&&(i=t),t>o&&(o=t))})),!Number.isFinite(i)||!Number.isFinite(o)){var u=re(r);u&&(u=' for field "'.concat(u,'"')),t.dataflow.warn("Infinite extent".concat(u,": [").concat(i,", ").concat(o,"]")),i=o=void 0}this.value=[i,o]}}),ht(Ff,qo,{connect:function(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add:function(e){this.count+=1,this.value.add.push(e)},rem:function(e){this.count-=1,this.value.rem.push(e)},mod:function(e){this.value.mod.push(e)},init:function(e){this.value.init(e,e.NO_SOURCE)},evaluate:function(){return this.value}}),ht(If,mu,{activate:function(e){this._targets[this._targets.active++]=e},subflow:function(e,t,n,r){var a,i,o=this.value,u=ct(o,e)&&o[e];return u?u.value.stamp<n.stamp&&(u.init(n),this.activate(u)):(i=r||(i=this._group[e])&&i.tuple,a=n.dataflow,u=new Ff(n.fork(n.NO_SOURCE),this),a.add(u).connect(t(a,e,i)),o[e]=u,this.activate(u)),u},clean:function(){var e=this.value,t=0;for(var n in e)if(0===e[n].count){var r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){var a=this._targets.filter((function(e){return e&&e.count>0}));this.initTargets(a)}},initTargets:function(e){for(var t=this._targets,n=t.length,r=e?e.length:0,a=0;a<r;++a)t[a]=e[a];for(;a<n&&null!=t[a];++a)t[a]=null;t.active=r},transform:function(e,t){var n=this,r=t.dataflow,a=e.key,i=e.subflow,o=this._keys,u=e.modified("key"),s=function(e){return n.subflow(e,i,t)};return this._group=e.group||{},this.initTargets(),t.visit(t.REM,(function(e){var t=Mo(e),n=o.get(t);void 0!==n&&(o.delete(t),s(n).rem(e))})),t.visit(t.ADD,(function(e){var t=a(e);o.set(Mo(e),t),s(t).add(e)})),u||t.modified(a.fields)?t.visit(t.MOD,(function(e){var t=Mo(e),n=o.get(t),r=a(e);n===r?s(r).mod(e):(o.set(t,r),s(n).rem(e),s(r).add(e))})):t.changed(t.MOD)&&t.visit(t.MOD,(function(e){s(o.get(Mo(e))).mod(e)})),u&&t.visit(t.REFLOW,(function(e){var t=Mo(e),n=o.get(t),r=a(e);n!==r&&(o.set(t,r),s(n).rem(e),s(r).add(e))})),t.clean()?r.runAfter((function(){n.clean(),o.clean()})):o.empty>r.cleanThreshold&&r.runAfter(o.clean),t}}),ht(Mf,qo),Rf.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},ht(Rf,mu,{transform:function(e,t){var n=t.dataflow,r=this.value,a=t.fork(),i=a.add,o=a.rem,u=a.mod,s=e.expr,c=!0;function l(t){var n=Mo(t),a=s(t,e),l=r.get(n);a&&l?(r.delete(n),i.push(t)):a||l?c&&a&&!l&&u.push(t):(r.set(n,1),o.push(t))}return t.visit(t.REM,(function(e){var t=Mo(e);r.has(t)?r.delete(t):o.push(e)})),t.visit(t.ADD,(function(t){s(t,e)?i.push(t):r.set(Mo(t),1)})),t.visit(t.MOD,l),e.modified()&&(c=!1,t.visit(t.REFLOW,l)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),a}}),Zf.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},ht(Zf,mu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,a=Sf(r,e.as||[]),i=e.index||null,o=a.length;return n.rem=this.value,t.visit(t.SOURCE,(function(e){for(var t,u,s,c=r.map((function(t){return t(e)})),l=c.reduce((function(e,t){return Math.max(e,t.length)}),0),f=0;f<l;++f){for(u=Zo(e),t=0;t<o;++t)u[a[t]]=null==(s=c[t][f])?null:s;i&&(u[i]=f),n.add.push(u)}})),this.value=n.source=n.add,i&&n.modifies(i),n.modifies(a)}}),Bf.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},ht(Bf,mu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,a=r.map(re),i=e.as||["key","value"],o=i[0],u=i[1],s=r.length;return n.rem=this.value,t.visit(t.SOURCE,(function(e){for(var t,i=0;i<s;++i)(t=Zo(e))[o]=a[i],t[u]=r[i](e),n.add.push(t)})),this.value=n.source=n.add,n.modifies(i)}}),zf.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},ht(zf,mu,{transform:function(e,t){var n=e.expr,r=e.as,a=e.modified(),i=e.initonly?t.ADD:a?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return a&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(i,(function(t){return t[r]=n(t,e)}))}}),ht(Lf,mu,{transform:function(e,t){var n,r,a,i=t.fork(t.ALL),o=e.generator,u=this.value,s=e.size-u.length;if(s>0){for(n=[];--s>=0;)n.push(a=Ro(o(e))),u.push(a);i.add=i.add.length?i.materialize(i.ADD).add.concat(n):n}else r=u.slice(0,-s),i.rem=i.rem.length?i.materialize(i.REM).rem.concat(r):r,u=u.slice(-s);return i.source=this.value=u,i}});var Pf={value:"value",median:Mu,mean:function(e,t){var n=0,r=0;if(void 0===t){var a,i=(0,Zt.Z)(e);try{for(i.s();!(a=i.n()).done;){var o=a.value;null!=o&&(o=+o)>=o&&(++n,r+=o)}}catch(f){i.e(f)}finally{i.f()}}else{var u,s=-1,c=(0,Zt.Z)(e);try{for(c.s();!(u=c.n()).done;){var l=u.value;null!=(l=t(l,++s,e))&&(l=+l)>=l&&(++n,r+=l)}}catch(f){c.e(f)}finally{c.f()}}if(n)return r/n},min:Cu,max:_u},jf=[];function Uf(e){mu.call(this,[],e)}function Wf(e){ff.call(this,e)}function Vf(e){mu.call(this,null,e)}function Gf(e){qo.call(this,null,qf,e)}function qf(e){return this.value&&!e.modified()?this.value:kt(e.fields,e.flat)}function Hf(e){mu.call(this,[],e),this._pending=null}function Xf(e,t,n){n.forEach(Ro);var r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function Yf(e){mu.call(this,{},e)}function Kf(e){qo.call(this,null,$f,e)}function $f(e){if(this.value&&!e.modified())return this.value;var t,n,r=e.extents,a=r.length,i=1/0,o=-1/0;for(t=0;t<a;++t)(n=r[t])[0]<i&&(i=n[0]),n[1]>o&&(o=n[1]);return[i,o]}function Qf(e){qo.call(this,null,Jf,e)}function Jf(e){return this.value&&!e.modified()?this.value:e.values.reduce((function(e,t){return e.concat(t)}),[])}function ed(e){mu.call(this,null,e)}function td(e){ff.call(this,e)}function nd(e){If.call(this,e)}function rd(e){mu.call(this,null,e)}function ad(e){mu.call(this,null,e)}function id(e){mu.call(this,null,e)}Uf.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},ht(Uf,mu,{transform:function(e,t){var n,r,a,i,o,u,s,c,l,f,d=t.fork(t.ALL),h=function(e){var t,n=e.method||Pf.value;if(null!=Pf[n])return n===Pf.value?(t=void 0!==e.value?e.value:0,function(){return t}):Pf[n];se("Unrecognized imputation method: "+n)}(e),p=function(e){var t=e.field;return function(e){return e?t(e):NaN}}(e),v=re(e.field),g=re(e.key),m=(e.groupby||[]).map(re),y=function(e,t,n,r){var a,i,o,u,s,c,l,f,d=function(e){return e(f)},h=[],p=r?r.slice():[],v={},g={};for(p.forEach((function(e,t){return v[e]=t+1})),u=0,l=e.length;u<l;++u)c=n(f=e[u]),s=v[c]||(v[c]=p.push(c)),(o=g[i=(a=t?t.map(d):jf)+""])||(o=g[i]=[],h.push(o),o.values=a),o[s-1]=f;return h.domain=p,h}(t.source,e.groupby,e.key,e.keyvals),b=[],x=this.value,k=y.domain.length;for(o=0,c=y.length;o<c;++o)for(a=(n=y[o]).values,r=NaN,s=0;s<k;++s)if(null==n[s]){for(i=y.domain[s],f={_impute:!0},u=0,l=a.length;u<l;++u)f[m[u]]=a[u];f[g]=i,f[v]=Number.isNaN(r)?r=h(n,p):r,b.push(Ro(f))}return b.length&&(d.add=d.materialize(d.ADD).add.concat(b)),x.length&&(d.rem=d.materialize(d.REM).rem.concat(x)),this.value=b,d}}),Wf.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:ef},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},ht(Wf,ff,{transform:function(e,t){var n,r=this,a=e.modified();return r.value&&(a||t.modified(r._inputs,!0))?(n=r.value=a?r.init(e):{},t.visit(t.SOURCE,(function(e){return r.add(e)}))):(n=r.value=r.value||this.init(e),t.visit(t.REM,(function(e){return r.rem(e)})),t.visit(t.ADD,(function(e){return r.add(e)}))),r.changes(),t.visit(t.SOURCE,(function(e){it(e,n[r.cellkey(e)].tuple)})),t.reflow(a).modifies(this._outputs)},changes:function(){var e,t,n=this._adds,r=this._mods;for(e=0,t=this._alen;e<t;++e)this.celltuple(n[e]),n[e]=null;for(e=0,t=this._mlen;e<t;++e)this.celltuple(r[e]),r[e]=null;this._alen=this._mlen=0}}),Vf.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},ht(Vf,mu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=t.materialize(t.SOURCE).source,a=Af(r,e.groupby,e.field),i=(e.groupby||[]).map(re),o=e.bandwidth,u=e.cumulative?"cdf":"pdf",s=e.as||["value","density"],c=[],l=e.extent,f=e.steps||e.minsteps||25,d=e.steps||e.maxsteps||200;"pdf"!==u&&"cdf"!==u&&se("Invalid density method: "+u),"shared"===e.resolve&&(l||(l=ot(r,e.field)),f=d=e.steps||d),a.forEach((function(t){var n=es(t,o)[u],r=e.counts?t.length:1;Es(n,l||ot(t),f,d).forEach((function(e){for(var n={},a=0;a<i.length;++a)n[i[a]]=t.dims[a];n[s[0]]=e[0],n[s[1]]=e[1]*r,c.push(Ro(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}}),ht(Gf,qo),ht(Hf,mu,{transform:function(e,t){var n=this,r=t.dataflow;if(this._pending)return Xf(this,t,this._pending);if(function(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}(e))return t.StopPropagation;if(e.values)return Xf(this,t,r.parse(e.values,e.format));if(e.async){var a=r.request(e.url,e.format).then((function(e){return n._pending=Ye(e.data),function(e){return e.touch(n)}}));return{async:a}}return r.request(e.url,e.format).then((function(e){return Xf(n,t,Ye(e.data))}))}}),Yf.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},ht(Yf,mu,{transform:function(e,t){var n,r,a,i=e.fields,o=e.index,u=e.values,s=null==e.default?null:e.default,c=e.modified(),l=i.length,f=c?t.SOURCE:t.ADD,d=t,h=e.as;return u?(r=u.length,l>1&&!h&&se('Multi-field lookup requires explicit "as" parameter.'),h&&h.length!==l*r&&se('The "as" parameter has too few output field names.'),h=h||u.map(re),n=function(e){for(var t,n,a=0,c=0;a<l;++a)if(null==(n=o.get(i[a](e))))for(t=0;t<r;++t,++c)e[h[c]]=s;else for(t=0;t<r;++t,++c)e[h[c]]=u[t](n)}):(h||se("Missing output field names."),n=function(e){for(var t,n=0;n<l;++n)t=o.get(i[n](e)),e[h[n]]=null==t?s:t}),c?d=t.reflow(!0):(a=i.some((function(e){return t.modified(e.fields)})),f|=a?t.MOD:0),t.visit(f,n),d.modifies(h)}}),ht(Kf,qo),ht(Qf,qo),ht(ed,mu,{transform:function(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),td.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:ef,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},ht(td,ff,{_transform:ff.prototype.transform,transform:function(e,t){return this._transform(function(e,t){var n=e.field,r=e.value,a=("count"===e.op?"__count__":e.op)||"sum",i=ae(n).concat(ae(r)),o=function(e,t,n){var r={},a=[];return n.visit(n.SOURCE,(function(t){var n=e(t);r[n]||(r[n]=1,a.push(n))})),a.sort(Je),t?a.slice(0,t):a}(n,e.limit||0,t);t.changed()&&e.set("__pivot__",null,null,!0);return{key:e.key,groupby:e.groupby,ops:o.map((function(){return a})),fields:o.map((function(e){return function(e,t,n,r){return ne((function(r){return t(r)===e?n(r):NaN}),r,e+"")}(e,n,r,i)})),as:o.map((function(e){return e+""})),modified:e.modified.bind(e)}}(e,t),t)}}),ht(nd,If,{transform:function(e,t){var n=this,r=e.subflow,a=e.field,i=function(e){return n.subflow(Mo(e),r,t,e)};return(e.modified("field")||a&&t.modified(ae(a)))&&se("PreFacet does not support field modification."),this.initTargets(),a?(t.visit(t.MOD,(function(e){var t=i(e);a(e).forEach((function(e){return t.mod(e)}))})),t.visit(t.ADD,(function(e){var t=i(e);a(e).forEach((function(e){return t.add(Ro(e))}))})),t.visit(t.REM,(function(e){var t=i(e);a(e).forEach((function(e){return t.rem(e)}))}))):(t.visit(t.MOD,(function(e){return i(e).mod(e)})),t.visit(t.ADD,(function(e){return i(e).add(e)})),t.visit(t.REM,(function(e){return i(e).rem(e)}))),t.clean()&&t.runAfter((function(){return n.clean()})),t}}),rd.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},ht(rd,mu,{transform:function(e,t){var n,r=t.fork(t.NO_SOURCE),a=e.fields,i=Sf(e.fields,e.as||[]),o=a?function(e,t){return function(e,t,n,r){for(var a=0,i=n.length;a<i;++a)t[r[a]]=n[a](e);return t}(e,t,a,i)}:Bo;return this.value?n=this.value:(t=t.addAll(),n=this.value={}),t.visit(t.REM,(function(e){var t=Mo(e);r.rem.push(n[t]),n[t]=null})),t.visit(t.ADD,(function(e){var t=o(e,Ro({}));n[Mo(e)]=t,r.add.push(t)})),t.visit(t.MOD,(function(e){r.mod.push(o(e,n[Mo(e)]))})),r}}),ht(ad,mu,{transform:function(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}}),id.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};function od(e){mu.call(this,null,e)}function ud(e){mu.call(this,[],e),this.count=0}function sd(e){mu.call(this,null,e)}function cd(e){mu.call(this,null,e),this.modified(!0)}function ld(e){mu.call(this,null,e)}ht(id,mu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;var a=Af(t.materialize(t.SOURCE).source,e.groupby,e.field),i=(e.groupby||[]).map(re),o=[],u=e.step||.01,s=e.probs||Ns(u/2,1-1e-14,u),c=s.length;return a.forEach((function(e){for(var t=Zu(e,s),n=0;n<c;++n){for(var a={},u=0;u<i.length;++u)a[i[u]]=e.dims[u];a[r[0]]=s[n],a[r[1]]=t[n],o.push(Ro(a))}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=o,n}}),ht(od,mu,{transform:function(e,t){var n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,(function(e){var t=Mo(e);n.rem.push(r[t]),r[t]=null})),t.visit(t.ADD,(function(e){var t=Zo(e);r[Mo(e)]=t,n.add.push(t)})),t.visit(t.MOD,(function(e){var t=r[Mo(e)];for(var a in e)t[a]=e[a],n.modifies(a);n.mod.push(t)}))),n}}),ud.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},ht(ud,mu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.modified("size"),a=e.size,i=this.value.reduce((function(e,t){return e[Mo(t)]=1,e}),{}),o=this.value,u=this.count,s=0;function c(e){var t,r;o.length<a?o.push(e):(r=~~((u+1)*Pu()))<o.length&&r>=s&&(t=o[r],i[Mo(t)]&&n.rem.push(t),o[r]=e),++u}if(t.rem.length&&(t.visit(t.REM,(function(e){var t=Mo(e);i[t]&&(i[t]=-1,n.rem.push(e)),--u})),o=o.filter((function(e){return-1!==i[Mo(e)]}))),(t.rem.length||r)&&o.length<a&&t.source&&(s=u=o.length,t.visit(t.SOURCE,(function(e){i[Mo(e)]||c(e)})),s=-1),r&&o.length>a){for(var l=o.length-a,f=0;f<l;++f)i[Mo(o[f])]=-1,n.rem.push(o[f]);o=o.slice(l)}return t.mod.length&&t.visit(t.MOD,(function(e){i[Mo(e)]&&n.mod.push(e)})),t.add.length&&t.visit(t.ADD,c),(t.add.length||s<0)&&(n.add=o.filter((function(e){return!i[Mo(e)]}))),this.count=u,this.value=n.source=o,n}}),sd.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},ht(sd,mu,{transform:function(e,t){if(!this.value||e.modified()){var n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Ns(e.start,e.stop,e.step||1).map((function(e){var t={};return t[r]=e,Ro(t)})),n.add=t.add.concat(this.value),n}}}),ht(cd,mu,{transform:function(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});var fd=["unit0","unit1"];function dd(e){mu.call(this,ft(),e)}function hd(e){mu.call(this,null,e)}ld.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:$c,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:fd}]},ht(ld,mu,{transform:function(e,t){var n=e.field,r=!1!==e.interval,a="utc"===e.timezone,i=this._floor(e,t),o=(a?El:Al)(i.unit).offset,u=e.as||fd,s=u[0],c=u[1],l=i.step,f=i.start||1/0,d=i.stop||-1/0,h=t.ADD;return(e.modified()||t.modified(ae(n)))&&(h=(t=t.reflow(!0)).SOURCE,f=1/0,d=-1/0),t.visit(h,(function(e){var t,a,u=n(e);null==u?(e[s]=null,r&&(e[c]=null)):(e[s]=t=a=i(u),r&&(e[c]=a=o(t,l)),t<f&&(f=t),a>d&&(d=a))})),i.start=f,i.stop=d,t.modifies(r?u:s)},_floor:function(e,t){var n="utc"===e.timezone,r=e.units?{units:e.units,step:e.step||1}:Xl({extent:e.extent||ot(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),a=r.units,i=r.step,o=Jc(a),u=this.value||{},s=(n?_l:xl)(o,i);return s.unit=De(o),s.units=o,s.step=i,s.start=u.start,s.stop=u.stop,this.value=s}}),ht(dd,mu,{transform:function(e,t){var n=t.dataflow,r=e.field,a=this.value,i=function(e){return a.set(r(e),e)},o=!0;return e.modified("field")||t.modified(r.fields)?(a.clear(),t.visit(t.SOURCE,i)):t.changed()?(t.visit(t.REM,(function(e){return a.delete(r(e))})),t.visit(t.ADD,i)):o=!1,this.modified(o),a.empty>n.cleanThreshold&&n.runAfter(a.clean),t.fork()}}),ht(hd,mu,{transform:function(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(Lo(e.sort)):t.source).map(e.field))}});var pd={row_number:function(){return{next:function(e){return e.index+1}}},rank:function(){var e;return{init:function(){return e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){var e;return{init:function(){return e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){var e=pd.rank(),t=e.next;return{init:e.init,next:function(e){return(t(e)-1)/(e.data.length-1)}}},cume_dist:function(){var e;return{init:function(){return e=0},next:function(t){var n=t.data,r=t.compare,a=t.index;if(e<a){for(;a+1<n.length&&!r(n[a],n[a+1]);)++a;e=a}return(1+e)/n.length}}},ntile:function(e,t){(t=+t)>0||se("ntile num must be greater than zero.");var n=pd.cume_dist(),r=n.next;return{init:n.init,next:function(e){return Math.ceil(t*r(e))}}},lag:function(e,t){return t=+t||1,{next:function(n){var r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:function(n){var r=n.index+t,a=n.data;return r<a.length?e(a[r]):null}}},first_value:function(e){return{next:function(t){return e(t.data[t.i0])}}},last_value:function(e){return{next:function(t){return e(t.data[t.i1-1])}}},nth_value:function(e,t){return(t=+t)>0||se("nth_value nth must be greater than zero."),{next:function(n){var r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){var t;return{init:function(){return t=null},next:function(n){var r=e(n.data[n.index]);return null!=r?t=r:t}}},next_value:function(e){var t,n;return{init:function(){return t=null,n=-1},next:function(r){var a=r.data;return r.index<=n?t:(n=function(e,t,n){for(var r=t.length;n<r;++n){if(null!=e(t[n]))return n}return-1}(e,a,r.index))<0?(n=a.length,t=null):t=e(a[n])}}}};var vd=Object.keys(pd);function gd(e){var t=Ye(e.ops),n=Ye(e.fields),r=Ye(e.params),a=Ye(e.as),i=this.outputs=[],o=this.windows=[],u={},s={},c=[],l=[],f=!0;function d(e){Ye(ae(e)).forEach((function(e){return u[e]=1}))}d(e.sort),t.forEach((function(e,t){var u=n[t],h=re(u),p=Kl(e,h,a[t]);if(d(u),i.push(p),ct(pd,e))o.push(function(e,t,n,r){var a=pd[e](t,n);return{init:a.init||he,update:function(e,t){t[r]=a.next(e)}}}(e,n[t],r[t],p));else{if(null==u&&"count"!==e&&se("Null aggregate field specified."),"count"===e)return void c.push(p);f=!1;var v=s[h];v||((v=s[h]=[]).field=u,l.push(v)),v.push(tf(e,p))}})),(c.length||l.length)&&(this.cell=function(e,t,n){e=e.map((function(e){return sf(e,e.field)}));var r={num:0,agg:null,store:!1,count:t};if(!n)for(var a=e.length,i=r.agg=Array(a),o=0;o<a;++o)i[o]=new e[o](r);if(r.store)var u=r.data=new cf;return r.add=function(e){if(r.num+=1,!n){u&&u.add(e);for(var t=0;t<a;++t)i[t].add(i[t].get(e),e)}},r.rem=function(e){if(r.num-=1,!n){u&&u.rem(e);for(var t=0;t<a;++t)i[t].rem(i[t].get(e),e)}},r.set=function(e){var a,o;for(u&&u.values(),a=0,o=t.length;a<o;++a)e[t[a]]=r.num;if(!n)for(a=0,o=i.length;a<o;++a)i[a].set(e)},r.init=function(){r.num=0,u&&u.reset();for(var e=0;e<a;++e)i[e].init()},r}(l,c,f)),this.inputs=Object.keys(u)}var md=gd.prototype;function yd(e){mu.call(this,{},e),this._mlen=0,this._mods=[]}function bd(e,t,n,r){var a=r.sort,i=a&&!r.ignorePeers,o=r.frame||[null,0],u=e.data(n),s=u.length,c=i?Ds(a):null,l={i0:0,i1:0,p0:0,p1:0,index:0,data:u,compare:a||rt(-1)};t.init();for(var f=0;f<s;++f)xd(l,o,f,s),i&&kd(l,c),t.update(l,u[f])}function xd(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,n-Math.abs(t[0])),e.i1=null==t[1]?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function kd(e,t){var n=e.i0,r=e.i1-1,a=e.compare,i=e.data,o=i.length-1;n>0&&!a(i[n],i[n-1])&&(e.i0=t.left(i,i[n])),r<o&&!a(i[r],i[r+1])&&(e.i1=t.right(i,i[r]))}function wd(e,t,n){return e.fields=t||[],e.fname=n,e}function _d(e){return 1===e.length?Cd(e[0]):Sd(e)}md.init=function(){this.windows.forEach((function(e){return e.init()})),this.cell&&this.cell.init()},md.update=function(e,t){var n,r=this.cell,a=this.windows,i=e.data,o=a&&a.length;if(r){for(n=e.p0;n<e.i0;++n)r.rem(i[n]);for(n=e.p1;n<e.i1;++n)r.add(i[n]);r.set(t)}for(n=0;n<o;++n)a[n].update(e,t)},yd.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:vd.concat(ef)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},ht(yd,mu,{transform:function(e,t){var n=this;this.stamp=t.stamp;var r=e.modified(),a=Lo(e.sort),i=Yl(e.groupby),o=function(e){return n.group(i(e))},u=this.state;u&&!r||(u=this.state=new gd(e)),r||t.modified(u.inputs)?(this.value={},t.visit(t.SOURCE,(function(e){return o(e).add(e)}))):(t.visit(t.REM,(function(e){return o(e).remove(e)})),t.visit(t.ADD,(function(e){return o(e).add(e)})));for(var s=0,c=this._mlen;s<c;++s)bd(this._mods[s],u,a,e);return this._mlen=0,this._mods=[],t.reflow(r).modifies(u.outputs)},group:function(e){var t=this.value[e];return t||(t=this.value[e]=hf(Mo),t.stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}});var Cd=function(e){return function(t){return t[e]}},Sd=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function Ad(e){throw Error(e)}function Ed(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n),s+=e.substring(++n,++n),t=n;else if(r===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&c(),u=t=n+1):"]"===r&&(u||Ad("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&Ad("Access path missing closing bracket: "+e),o&&Ad("Access path missing closing quote: "+e),n>t&&(n++,c()),a}function Td(e,t,n){var r=Ed(e);return e=1===r.length?r[0]:e,wd((n&&n.get||_d)(r),[e],t||e)}Td("id");var Nd=wd((function(e){return e}),[],"identity"),Dd=(wd((function(){return 0}),[],"zero"),wd((function(){return 1}),[],"one"),wd((function(){return!0}),[],"true"));wd((function(){return!1}),[],"false");var Fd=Array.isArray;function Id(e){return e===Object(e)}function Md(e){return e[e.length-1]}function Od(e){return null==e||""===e?null:+e}function Rd(e){return null!=e?Fd(e)?e:[e]:[]}function Zd(e){return"function"===typeof e}function Bd(e){for(var t,n,r=1,a=arguments.length;r<a;++r)for(n in t=arguments[r])e[n]=t[n];return e}var zd=Object.prototype.hasOwnProperty;function Ld(e,t){return zd.call(e,t)}function Pd(e,t,n){var r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),Bd(r,n)}function jd(e){return"string"===typeof e}function Ud(e){return Fd(e)?"["+e.map(Ud)+"]":Id(e)||jd(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Wd(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return t}function Vd(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Gd(e){this._context=e}function qd(){}function Hd(e){this._context=e}function Xd(e){this._context=e}function Yd(e,t){this._basis=new Gd(e),this._beta=t}Gd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Vd(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Vd(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Hd.prototype={areaStart:qd,areaEnd:qd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Vd(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Xd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Vd(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Yd.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,a=e[0],i=t[0],o=e[n]-a,u=t[n]-i,s=-1;++s<=n;)r=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(a+r*o),this._beta*t[s]+(1-this._beta)*(i+r*u));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var Kd=function e(t){function n(e){return 1===t?new Gd(e):new Yd(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function $d(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Qd(e,t){this._context=e,this._k=(1-t)/6}Qd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:$d(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:$d(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Jd=function e(t){function n(e){return new Qd(e,t)}return n.tension=function(t){return e(+t)},n}(0);function eh(e,t){this._context=e,this._k=(1-t)/6}eh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:$d(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var th=function e(t){function n(e){return new eh(e,t)}return n.tension=function(t){return e(+t)},n}(0);function nh(e,t){this._context=e,this._k=(1-t)/6}nh.prototype={areaStart:qd,areaEnd:qd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:$d(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var rh=function e(t){function n(e){return new nh(e,t)}return n.tension=function(t){return e(+t)},n}(0),ah=Math.abs,ih=Math.atan2,oh=Math.cos,uh=Math.max,sh=Math.min,ch=Math.sin,lh=Math.sqrt,fh=1e-12,dh=Math.PI,hh=dh/2,ph=2*dh;function vh(e){return e>1?0:e<-1?dh:Math.acos(e)}function gh(e){return e>=1?hh:e<=-1?-hh:Math.asin(e)}function mh(e,t,n){var r=e._x1,a=e._y1,i=e._x2,o=e._y2;if(e._l01_a>fh){var u=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,s=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*u-e._x0*e._l12_2a+e._x2*e._l01_2a)/s,a=(a*u-e._y0*e._l12_2a+e._y2*e._l01_2a)/s}if(e._l23_a>fh){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,l=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*c+e._x1*e._l23_2a-t*e._l12_2a)/l,o=(o*c+e._y1*e._l23_2a-n*e._l12_2a)/l}e._context.bezierCurveTo(r,a,i,o,e._x2,e._y2)}function yh(e,t){this._context=e,this._alpha=t}yh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:mh(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var bh=function e(t){function n(e){return t?new yh(e,t):new Qd(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function xh(e,t){this._context=e,this._alpha=t}xh.prototype={areaStart:qd,areaEnd:qd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:mh(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var kh=function e(t){function n(e){return t?new xh(e,t):new nh(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function wh(e,t){this._context=e,this._alpha=t}wh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:mh(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var _h=function e(t){function n(e){return t?new wh(e,t):new eh(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Ch(e){this._context=e}function Sh(e){return new Ch(e)}function Ah(e){this._context=e}function Eh(e){return e<0?-1:1}function Th(e,t,n){var r=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(r||a<0&&-0),o=(n-e._y1)/(a||r<0&&-0),u=(i*a+o*r)/(r+a);return(Eh(i)+Eh(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(u))||0}function Nh(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Dh(e,t,n){var r=e._x0,a=e._y0,i=e._x1,o=e._y1,u=(i-r)/3;e._context.bezierCurveTo(r+u,a+u*t,i-u,o-u*n,i,o)}function Fh(e){this._context=e}function Ih(e){this._context=new Mh(e)}function Mh(e){this._context=e}function Oh(e){this._context=e}function Rh(e){var t,n,r=e.length-1,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function Zh(e,t){this._context=e,this._t=t}function Bh(e){return function(){return e}}function zh(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}Ch.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},Ah.prototype={areaStart:qd,areaEnd:qd,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},Fh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Dh(this,this._t0,Nh(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Dh(this,Nh(this,n=Th(this,e,t)),n);break;default:Dh(this,this._t0,n=Th(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(Ih.prototype=Object.create(Fh.prototype)).point=function(e,t){Fh.prototype.point.call(this,t,e)},Mh.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,i){this._context.bezierCurveTo(t,e,r,n,i,a)}},Oh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=Rh(e),a=Rh(t),i=0,o=1;o<n;++i,++o)this._context.bezierCurveTo(r[0][i],a[0][i],r[1][i],a[1][i],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},Zh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var Lh,Ph,jh,Uh,Wh,Vh,Gh,qh,Hh,Xh,Yh,Kh,$h,Qh,Jh=n(5671),ep=n(3144),tp=Math.PI,np=2*tp,rp=1e-6,ap=np-rp;function ip(e){this._+=e[0];for(var t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}var op=function(){function e(t){(0,Jh.Z)(this,e),this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?ip:function(e){var t=Math.floor(e);if(!(t>=0))throw new Error("invalid digits: ".concat(e));if(t>15)return ip;var n=Math.pow(10,t);return function(e){this._+=e[0];for(var t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(t)}return(0,ep.Z)(e,[{key:"moveTo",value:function(e,t){this._append(Lh||(Lh=zh(["M",",",""])),this._x0=this._x1=+e,this._y0=this._y1=+t)}},{key:"closePath",value:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(Ph||(Ph=zh(["Z"]))))}},{key:"lineTo",value:function(e,t){this._append(jh||(jh=zh(["L",",",""])),this._x1=+e,this._y1=+t)}},{key:"quadraticCurveTo",value:function(e,t,n,r){this._append(Uh||(Uh=zh(["Q",",",",",",",""])),+e,+t,this._x1=+n,this._y1=+r)}},{key:"bezierCurveTo",value:function(e,t,n,r,a,i){this._append(Wh||(Wh=zh(["C",",",",",",",",",",",""])),+e,+t,+n,+r,this._x1=+a,this._y1=+i)}},{key:"arcTo",value:function(e,t,n,r,a){if(e=+e,t=+t,n=+n,r=+r,(a=+a)<0)throw new Error("negative radius: ".concat(a));var i=this._x1,o=this._y1,u=n-e,s=r-t,c=i-e,l=o-t,f=c*c+l*l;if(null===this._x1)this._append(Vh||(Vh=zh(["M",",",""])),this._x1=e,this._y1=t);else if(f>rp)if(Math.abs(l*u-s*c)>rp&&a){var d=n-i,h=r-o,p=u*u+s*s,v=d*d+h*h,g=Math.sqrt(p),m=Math.sqrt(f),y=a*Math.tan((tp-Math.acos((p+f-v)/(2*g*m)))/2),b=y/m,x=y/g;Math.abs(b-1)>rp&&this._append(qh||(qh=zh(["L",",",""])),e+b*c,t+b*l),this._append(Hh||(Hh=zh(["A",",",",0,0,",",",",",""])),a,a,+(l*d>c*h),this._x1=e+x*u,this._y1=t+x*s)}else this._append(Gh||(Gh=zh(["L",",",""])),this._x1=e,this._y1=t);else;}},{key:"arc",value:function(e,t,n,r,a,i){if(e=+e,t=+t,i=!!i,(n=+n)<0)throw new Error("negative radius: ".concat(n));var o=n*Math.cos(r),u=n*Math.sin(r),s=e+o,c=t+u,l=1^i,f=i?r-a:a-r;null===this._x1?this._append(Xh||(Xh=zh(["M",",",""])),s,c):(Math.abs(this._x1-s)>rp||Math.abs(this._y1-c)>rp)&&this._append(Yh||(Yh=zh(["L",",",""])),s,c),n&&(f<0&&(f=f%np+np),f>ap?this._append(Kh||(Kh=zh(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,l,e-o,t-u,n,n,l,this._x1=s,this._y1=c):f>rp&&this._append($h||($h=zh(["A",",",",0,",",",",",",",""])),n,n,+(f>=tp),l,this._x1=e+n*Math.cos(a),this._y1=t+n*Math.sin(a)))}},{key:"rect",value:function(e,t,n,r){this._append(Qh||(Qh=zh(["M",",","h","v","h","Z"])),this._x0=this._x1=+e,this._y0=this._y1=+t,n=+n,+r,-n)}},{key:"toString",value:function(){return this._}}]),e}();function up(){return new op}function sp(e){var t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{var r=Math.floor(n);if(!(r>=0))throw new RangeError("invalid digits: ".concat(n));t=r}return e},function(){return new op(t)}}function cp(e){return e.innerRadius}function lp(e){return e.outerRadius}function fp(e){return e.startAngle}function dp(e){return e.endAngle}function hp(e){return e&&e.padAngle}function pp(e,t,n,r,a,i,o,u){var s=n-e,c=r-t,l=o-a,f=u-i,d=f*s-l*c;if(!(d*d<fh))return[e+(d=(l*(t-i)-f*(e-a))/d)*s,t+d*c]}function vp(e,t,n,r,a,i,o){var u=e-n,s=t-r,c=(o?i:-i)/lh(u*u+s*s),l=c*s,f=-c*u,d=e+l,h=t+f,p=n+l,v=r+f,g=(d+p)/2,m=(h+v)/2,y=p-d,b=v-h,x=y*y+b*b,k=a-i,w=d*v-p*h,_=(b<0?-1:1)*lh(uh(0,k*k*x-w*w)),C=(w*b-y*_)/x,S=(-w*y-b*_)/x,A=(w*b+y*_)/x,E=(-w*y+b*_)/x,T=C-g,N=S-m,D=A-g,F=E-m;return T*T+N*N>D*D+F*F&&(C=A,S=E),{cx:C,cy:S,x01:-l,y01:-f,x11:C*(a/k-1),y11:S*(a/k-1)}}up.prototype=op.prototype;Array.prototype.slice;function gp(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function mp(e){return e[0]}function yp(e){return e[1]}function bp(e,t){var n=Bh(!0),r=null,a=Sh,i=null,o=sp(u);function u(u){var s,c,l,f=(u=gp(u)).length,d=!1;for(null==r&&(i=a(l=o())),s=0;s<=f;++s)!(s<f&&n(c=u[s],s,u))===d&&((d=!d)?i.lineStart():i.lineEnd()),d&&i.point(+e(c,s,u),+t(c,s,u));if(l)return i=null,l+""||null}return e="function"===typeof e?e:void 0===e?mp:Bh(e),t="function"===typeof t?t:void 0===t?yp:Bh(t),u.x=function(t){return arguments.length?(e="function"===typeof t?t:Bh(+t),u):e},u.y=function(e){return arguments.length?(t="function"===typeof e?e:Bh(+e),u):t},u.defined=function(e){return arguments.length?(n="function"===typeof e?e:Bh(!!e),u):n},u.curve=function(e){return arguments.length?(a=e,null!=r&&(i=a(r)),u):a},u.context=function(e){return arguments.length?(null==e?r=i=null:i=a(r=e),u):r},u}function xp(e,t,n){var r=null,a=Bh(!0),i=null,o=Sh,u=null,s=sp(c);function c(c){var l,f,d,h,p,v=(c=gp(c)).length,g=!1,m=new Array(v),y=new Array(v);for(null==i&&(u=o(p=s())),l=0;l<=v;++l){if(!(l<v&&a(h=c[l],l,c))===g)if(g=!g)f=l,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),d=l-1;d>=f;--d)u.point(m[d],y[d]);u.lineEnd(),u.areaEnd()}g&&(m[l]=+e(h,l,c),y[l]=+t(h,l,c),u.point(r?+r(h,l,c):m[l],n?+n(h,l,c):y[l]))}if(p)return u=null,p+""||null}function l(){return bp().defined(a).curve(o).context(i)}return e="function"===typeof e?e:void 0===e?mp:Bh(+e),t="function"===typeof t?t:Bh(void 0===t?0:+t),n="function"===typeof n?n:void 0===n?yp:Bh(+n),c.x=function(t){return arguments.length?(e="function"===typeof t?t:Bh(+t),r=null,c):e},c.x0=function(t){return arguments.length?(e="function"===typeof t?t:Bh(+t),c):e},c.x1=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:Bh(+e),c):r},c.y=function(e){return arguments.length?(t="function"===typeof e?e:Bh(+e),n=null,c):t},c.y0=function(e){return arguments.length?(t="function"===typeof e?e:Bh(+e),c):t},c.y1=function(e){return arguments.length?(n=null==e?null:"function"===typeof e?e:Bh(+e),c):n},c.lineX0=c.lineY0=function(){return l().x(e).y(t)},c.lineY1=function(){return l().x(e).y(n)},c.lineX1=function(){return l().x(r).y(t)},c.defined=function(e){return arguments.length?(a="function"===typeof e?e:Bh(!!e),c):a},c.curve=function(e){return arguments.length?(o=e,null!=i&&(u=o(i)),c):o},c.context=function(e){return arguments.length?(null==e?i=u=null:u=o(i=e),c):i},c}lh(3);var kp={draw:function(e,t){var n=lh(t/dh);e.moveTo(n,0),e.arc(0,0,n,0,ph)}},wp=(lh(1/3),ch(dh/10)/ch(7*dh/10));ch(ph/10),oh(ph/10),lh(3),lh(3),lh(3),lh(12);function _p(e,t){if("undefined"!==typeof document&&document.createElement){var n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}var Cp=function(){return"undefined"!==typeof Image?Image:null},Sp={},Ap={};function Ep(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function Tp(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function Np(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function Dp(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),a=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":function(e){return e<0?"-"+Np(-e,6):e>9999?"+"+Np(e,6):Np(e,4)}(e.getUTCFullYear())+"-"+Np(e.getUTCMonth()+1,2)+"-"+Np(e.getUTCDate(),2)+(a?"T"+Np(t,2)+":"+Np(n,2)+":"+Np(r,2)+"."+Np(a,3)+"Z":r?"T"+Np(t,2)+":"+Np(n,2)+":"+Np(r,2)+"Z":n||t?"T"+Np(t,2)+":"+Np(n,2)+"Z":"")}function Fp(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,a=[],i=e.length,o=0,u=0,s=i<=0,c=!1;function l(){if(s)return Ap;if(c)return c=!1,Sp;var t,r,a=o;if(34===e.charCodeAt(a)){for(;o++<i&&34!==e.charCodeAt(o)||34===e.charCodeAt(++o););return(t=o)>=i?s=!0:10===(r=e.charCodeAt(o++))?c=!0:13===r&&(c=!0,10===e.charCodeAt(o)&&++o),e.slice(a+1,t-1).replace(/""/g,'"')}for(;o<i;){if(10===(r=e.charCodeAt(t=o++)))c=!0;else if(13===r)c=!0,10===e.charCodeAt(o)&&++o;else if(r!==n)continue;return e.slice(a,t)}return s=!0,e.slice(a,i)}for(10===e.charCodeAt(i-1)&&--i,13===e.charCodeAt(i-1)&&--i;(r=l())!==Ap;){for(var f=[];r!==Sp&&r!==Ap;)f.push(r),r=l();t&&null==(f=t(f,u++))||a.push(f)}return a}function a(t,n){return t.map((function(t){return n.map((function(e){return o(t[e])})).join(e)}))}function i(t){return t.map(o).join(e)}function o(e){return null==e?"":e instanceof Date?Dp(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,a,i=r(e,(function(e,r){if(n)return n(e,r-1);a=e,n=t?function(e,t){var n=Ep(e);return function(r,a){return t(n(r),a,e)}}(e,t):Ep(e)}));return i.columns=a||[],i},parseRows:r,format:function(t,n){return null==n&&(n=Tp(t)),[n.map(o).join(e)].concat(a(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=Tp(e)),a(e,t).join("\n")},formatRows:function(e){return e.map(i).join("\n")},formatRow:i,formatValue:o}}var Ip=Math.sqrt(50),Mp=Math.sqrt(10),Op=Math.sqrt(2);function Rp(e,t,n){var r,a,i,o=(t-e)/Math.max(0,n),u=Math.floor(Math.log10(o)),s=o/Math.pow(10,u),c=s>=Ip?10:s>=Mp?5:s>=Op?2:1;return u<0?(i=Math.pow(10,-u)/c,(r=Math.round(e*i))/i<e&&++r,(a=Math.round(t*i))/i>t&&--a,i=-i):(i=Math.pow(10,u)*c,(r=Math.round(e/i))*i<e&&++r,(a=Math.round(t/i))*i>t&&--a),a<r&&.5<=n&&n<2?Rp(e,t,2*n):[r,a,i]}function Zp(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];var r=t<e,a=r?Rp(t,e,n):Rp(e,t,n),i=(0,ku.Z)(a,3),o=i[0],u=i[1],s=i[2];if(!(u>=o))return[];var c=u-o+1,l=new Array(c);if(r)if(s<0)for(var f=0;f<c;++f)l[f]=(u-f)/-s;else for(var d=0;d<c;++d)l[d]=(u-d)*s;else if(s<0)for(var h=0;h<c;++h)l[h]=(o+h)/-s;else for(var p=0;p<c;++p)l[p]=(o+p)*s;return l}function Bp(e,t,n){return Rp(e=+e,t=+t,n=+n)[2]}function zp(e,t,n){n=+n;var r=(t=+t)<(e=+e),a=r?Bp(t,e,n):Bp(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}var Lp,Pp=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function jp(e){if(!(t=Pp.exec(e)))throw new Error("invalid format: "+e);var t;return new Up({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Up(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Wp(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Vp(e){return(e=Wp(Math.abs(e)))?e[1]:NaN}function Gp(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Vp(t)/3)))-Vp(Math.abs(e)))}function qp(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Vp(t)-Vp(e))+1}function Hp(e){return Math.max(0,-Vp(Math.abs(e)))}function Xp(e,t){var n=Wp(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}jp.prototype=Up.prototype,Up.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Yp={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return Xp(100*e,t)},r:Xp,s:function(e,t){var n=Wp(e,t);if(!n)return e+"";var r=n[0],a=n[1],i=a-(Lp=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+Wp(e,Math.max(0,t+i-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function Kp(e){return e}var $p,Qp,Jp,ev=Array.prototype.map,tv=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function nv(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?Kp:(t=ev.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var a=e.length,i=[],o=0,u=t[0],s=0;a>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),i.push(e.substring(a-=u,a+u)),!((s+=u+1)>r));)u=t[o=(o+1)%t.length];return i.reverse().join(n)}),a=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",u=void 0===e.numerals?Kp:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(ev.call(e.numerals,String)),s=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",l=void 0===e.nan?"NaN":e.nan+"";function f(e){var t=(e=jp(e)).fill,n=e.align,f=e.sign,d=e.symbol,h=e.zero,p=e.width,v=e.comma,g=e.precision,m=e.trim,y=e.type;"n"===y?(v=!0,y="g"):Yp[y]||(void 0===g&&(g=12),m=!0,y="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var b="$"===d?a:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===d?i:/[%p]/.test(y)?s:"",k=Yp[y],w=/[defgprs%]/.test(y);function _(e){var a,i,s,d=b,_=x;if("c"===y)_=k(e)+_,e="";else{var C=(e=+e)<0||1/e<0;if(e=isNaN(e)?l:k(Math.abs(e),g),m&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),C&&0===+e&&"+"!==f&&(C=!1),d=(C?"("===f?f:c:"-"===f||"("===f?"":f)+d,_=("s"===y?tv[8+Lp/3]:"")+_+(C&&"("===f?")":""),w)for(a=-1,i=e.length;++a<i;)if(48>(s=e.charCodeAt(a))||s>57){_=(46===s?o+e.slice(a+1):e.slice(a))+_,e=e.slice(0,a);break}}v&&!h&&(e=r(e,1/0));var S=d.length+e.length+_.length,A=S<p?new Array(p-S+1).join(t):"";switch(v&&h&&(e=r(A+e,A.length?p-_.length:1/0),A=""),n){case"<":e=d+e+_+A;break;case"=":e=d+A+e+_;break;case"^":e=A.slice(0,S=A.length>>1)+d+e+_+A.slice(S);break;default:e=A+d+e+_}return u(e)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),_.toString=function(){return e+""},_}return{format:f,formatPrefix:function(e,t){var n=f(((e=jp(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Vp(t)/3))),a=Math.pow(10,-r),i=tv[8+r/3];return function(e){return n(a*e)+i}}}}!function(e){$p=nv(e),Qp=$p.format,Jp=$p.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});var rv=new Date,av=new Date;function iv(e,t,n,r){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=function(t){return e(t=new Date(+t)),t},a.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},a.round=function(e){var t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},a.range=function(n,r,i){var o,u=[];if(n=a.ceil(n),i=null==i?1:Math.floor(i),!(n<r)||!(i>0))return u;do{u.push(o=new Date(+n)),t(n,i),e(n)}while(o<n&&n<r);return u},a.filter=function(n){return iv((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(a.count=function(t,r){return rv.setTime(+t),av.setTime(+r),e(rv),e(av),Math.floor(n(rv,av))},a.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?function(t){return r(t)%e===0}:function(t){return a.count(0,t)%e===0}):a:null}),a}var ov=1e3,uv=6e4,sv=36e5,cv=864e5,lv=6048e5,fv=2592e6,dv=31536e6,hv=iv((function(e){return e.setHours(0,0,0,0)}),(function(e,t){return e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*uv)/cv}),(function(e){return e.getDate()-1})),pv=(hv.range,iv((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/cv}),(function(e){return e.getUTCDate()-1}))),vv=(pv.range,iv((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/cv}),(function(e){return Math.floor(e/cv)})));vv.range;function gv(e){return iv((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*uv)/lv}))}var mv=gv(0),yv=gv(1),bv=gv(2),xv=gv(3),kv=gv(4),wv=gv(5),_v=gv(6);mv.range,yv.range,bv.range,xv.range,kv.range,wv.range,_v.range;function Cv(e){return iv((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/lv}))}var Sv=Cv(0),Av=Cv(1),Ev=Cv(2),Tv=Cv(3),Nv=Cv(4),Dv=Cv(5),Fv=Cv(6),Iv=(Sv.range,Av.range,Ev.range,Tv.range,Nv.range,Dv.range,Fv.range,iv((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()})));Iv.every=function(e){return isFinite(e=Math.floor(e))&&e>0?iv((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};Iv.range;var Mv=iv((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));Mv.every=function(e){return isFinite(e=Math.floor(e))&&e>0?iv((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};Mv.range;var Ov=iv((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),Rv=(Ov.range,iv((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()}))),Zv=(Rv.range,iv((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*ov-e.getMinutes()*uv)}),(function(e,t){e.setTime(+e+t*sv)}),(function(e,t){return(t-e)/sv}),(function(e){return e.getHours()}))),Bv=(Zv.range,iv((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*sv)}),(function(e,t){return(t-e)/sv}),(function(e){return e.getUTCHours()}))),zv=(Bv.range,iv((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*ov)}),(function(e,t){e.setTime(+e+t*uv)}),(function(e,t){return(t-e)/uv}),(function(e){return e.getMinutes()}))),Lv=(zv.range,iv((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*uv)}),(function(e,t){return(t-e)/uv}),(function(e){return e.getUTCMinutes()}))),Pv=(Lv.range,iv((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*ov)}),(function(e,t){return(t-e)/ov}),(function(e){return e.getUTCSeconds()}))),jv=(Pv.range,iv((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e})));jv.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?iv((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):jv:null};jv.range;var Uv,Wv,Vv,Gv,qv,Hv,Xv,Yv="year",Kv="quarter",$v="month",Qv="week",Jv="date",eg="day",tg="dayofyear",ng="hours",rg="minutes",ag="seconds",ig="milliseconds";[Yv,Kv,$v,Qv,Jv,eg,tg,ng,rg,ag,ig].reduce((function(e,t,n){return e[t]=1+n,e}),{});Uv={},(0,qn.Z)(Uv,Yv,"%Y "),(0,qn.Z)(Uv,Kv,"Q%q "),(0,qn.Z)(Uv,$v,"%b "),(0,qn.Z)(Uv,Jv,"%d "),(0,qn.Z)(Uv,Qv,"W%U "),(0,qn.Z)(Uv,eg,"%a "),(0,qn.Z)(Uv,tg,"%j "),(0,qn.Z)(Uv,ng,"%H:00"),(0,qn.Z)(Uv,rg,"00:%M"),(0,qn.Z)(Uv,ag,":%S"),(0,qn.Z)(Uv,ig,".%L"),(0,qn.Z)(Uv,"".concat(Yv,"-").concat($v),"%Y-%m "),(0,qn.Z)(Uv,"".concat(Yv,"-").concat($v,"-").concat(Jv),"%Y-%m-%d "),(0,qn.Z)(Uv,"".concat(ng,"-").concat(rg),"%H:%M");var og=new Date;function ug(e){return og.setFullYear(e),og.setMonth(0),og.setDate(1),og.setHours(0,0,0,0),og}function sg(e){return hv.count(ug(e.getFullYear())-1,e)}function cg(e){return mv.count(ug(e.getFullYear())-1,e)}function lg(e){return ug(e).getDay()}function fg(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return pv.count(t-1,e)}function dg(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return Sv.count(t-1,e)}function hg(e){return og.setTime(Date.UTC(e,0,1)),og.getUTCDay()}function pg(e,t,n){return t+7*e-(n+6)%7}Wv={},(0,qn.Z)(Wv,Yv,(function(e){return e.getFullYear()})),(0,qn.Z)(Wv,Kv,(function(e){return Math.floor(e.getMonth()/3)})),(0,qn.Z)(Wv,$v,(function(e){return e.getMonth()})),(0,qn.Z)(Wv,Jv,(function(e){return e.getDate()})),(0,qn.Z)(Wv,ng,(function(e){return e.getHours()})),(0,qn.Z)(Wv,rg,(function(e){return e.getMinutes()})),(0,qn.Z)(Wv,ag,(function(e){return e.getSeconds()})),(0,qn.Z)(Wv,ig,(function(e){return e.getMilliseconds()})),(0,qn.Z)(Wv,tg,(function(e){return sg(e)})),(0,qn.Z)(Wv,Qv,(function(e){return cg(e)})),(0,qn.Z)(Wv,Qv+eg,(function(e,t){return pg(cg(e),e.getDay(),lg(t))})),(0,qn.Z)(Wv,eg,(function(e,t){return pg(1,e.getDay(),lg(t))})),Vv={},(0,qn.Z)(Vv,Kv,(function(e){return 3*e})),(0,qn.Z)(Vv,Qv,(function(e,t){return pg(e,0,lg(t))}));Gv={},(0,qn.Z)(Gv,Yv,(function(e){return e.getUTCFullYear()})),(0,qn.Z)(Gv,Kv,(function(e){return Math.floor(e.getUTCMonth()/3)})),(0,qn.Z)(Gv,$v,(function(e){return e.getUTCMonth()})),(0,qn.Z)(Gv,Jv,(function(e){return e.getUTCDate()})),(0,qn.Z)(Gv,ng,(function(e){return e.getUTCHours()})),(0,qn.Z)(Gv,rg,(function(e){return e.getUTCMinutes()})),(0,qn.Z)(Gv,ag,(function(e){return e.getUTCSeconds()})),(0,qn.Z)(Gv,ig,(function(e){return e.getUTCMilliseconds()})),(0,qn.Z)(Gv,tg,(function(e){return fg(e)})),(0,qn.Z)(Gv,Qv,(function(e){return dg(e)})),(0,qn.Z)(Gv,eg,(function(e,t){return pg(1,e.getUTCDay(),hg(t))})),(0,qn.Z)(Gv,Qv+eg,(function(e,t){return pg(dg(e),e.getUTCDay(),hg(t))})),qv={},(0,qn.Z)(qv,Kv,(function(e){return 3*e})),(0,qn.Z)(qv,Qv,(function(e,t){return pg(e,0,hg(t))}));var vg=(Hv={},(0,qn.Z)(Hv,Yv,Iv),(0,qn.Z)(Hv,Kv,Ov.every(3)),(0,qn.Z)(Hv,$v,Ov),(0,qn.Z)(Hv,Qv,mv),(0,qn.Z)(Hv,Jv,hv),(0,qn.Z)(Hv,eg,hv),(0,qn.Z)(Hv,tg,hv),(0,qn.Z)(Hv,ng,Zv),(0,qn.Z)(Hv,rg,zv),(0,qn.Z)(Hv,ag,Pv),(0,qn.Z)(Hv,ig,jv),Hv),gg=(Xv={},(0,qn.Z)(Xv,Yv,Mv),(0,qn.Z)(Xv,Kv,Rv.every(3)),(0,qn.Z)(Xv,$v,Rv),(0,qn.Z)(Xv,Qv,Sv),(0,qn.Z)(Xv,Jv,pv),(0,qn.Z)(Xv,eg,pv),(0,qn.Z)(Xv,tg,pv),(0,qn.Z)(Xv,ng,Bv),(0,qn.Z)(Xv,rg,Lv),(0,qn.Z)(Xv,ag,Pv),(0,qn.Z)(Xv,ig,jv),Xv);function mg(e){return vg[e]}function yg(e){return gg[e]}var bg=[Yv,$v,Jv,ng,rg,ag,ig],xg=bg.slice(0,-1),kg=xg.slice(0,-1),wg=kg.slice(0,-1);wg.slice(0,-1);function _g(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Cg(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Sg(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var Ag,Eg,Tg,Ng,Dg,Fg={"-":"",_:" ",0:"0"},Ig=/^\s*\d+/,Mg=/^%/,Og=/[\\^$*+?|[\]().{}]/g;function Rg(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",i=a.length;return r+(i<n?new Array(n-i+1).join(t)+a:a)}function Zg(e){return e.replace(Og,"\\$&")}function Bg(e){return new RegExp("^(?:"+e.map(Zg).join("|")+")","i")}function zg(e){return new Map(e.map((function(e,t){return[e.toLowerCase(),t]})))}function Lg(e,t,n){var r=Ig.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Pg(e,t,n){var r=Ig.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function jg(e,t,n){var r=Ig.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Ug(e,t,n){var r=Ig.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Wg(e,t,n){var r=Ig.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Vg(e,t,n){var r=Ig.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Gg(e,t,n){var r=Ig.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function qg(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Hg(e,t,n){var r=Ig.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function Xg(e,t,n){var r=Ig.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Yg(e,t,n){var r=Ig.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Kg(e,t,n){var r=Ig.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function $g(e,t,n){var r=Ig.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Qg(e,t,n){var r=Ig.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Jg(e,t,n){var r=Ig.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function em(e,t,n){var r=Ig.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function tm(e,t,n){var r=Ig.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function nm(e,t,n){var r=Mg.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function rm(e,t,n){var r=Ig.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function am(e,t,n){var r=Ig.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function im(e,t){return Rg(e.getDate(),t,2)}function om(e,t){return Rg(e.getHours(),t,2)}function um(e,t){return Rg(e.getHours()%12||12,t,2)}function sm(e,t){return Rg(1+hv.count(Iv(e),e),t,3)}function cm(e,t){return Rg(e.getMilliseconds(),t,3)}function lm(e,t){return cm(e,t)+"000"}function fm(e,t){return Rg(e.getMonth()+1,t,2)}function dm(e,t){return Rg(e.getMinutes(),t,2)}function hm(e,t){return Rg(e.getSeconds(),t,2)}function pm(e){var t=e.getDay();return 0===t?7:t}function vm(e,t){return Rg(mv.count(Iv(e)-1,e),t,2)}function gm(e){var t=e.getDay();return t>=4||0===t?kv(e):kv.ceil(e)}function mm(e,t){return e=gm(e),Rg(kv.count(Iv(e),e)+(4===Iv(e).getDay()),t,2)}function ym(e){return e.getDay()}function bm(e,t){return Rg(yv.count(Iv(e)-1,e),t,2)}function xm(e,t){return Rg(e.getFullYear()%100,t,2)}function km(e,t){return Rg((e=gm(e)).getFullYear()%100,t,2)}function wm(e,t){return Rg(e.getFullYear()%1e4,t,4)}function _m(e,t){var n=e.getDay();return Rg((e=n>=4||0===n?kv(e):kv.ceil(e)).getFullYear()%1e4,t,4)}function Cm(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Rg(t/60|0,"0",2)+Rg(t%60,"0",2)}function Sm(e,t){return Rg(e.getUTCDate(),t,2)}function Am(e,t){return Rg(e.getUTCHours(),t,2)}function Em(e,t){return Rg(e.getUTCHours()%12||12,t,2)}function Tm(e,t){return Rg(1+pv.count(Mv(e),e),t,3)}function Nm(e,t){return Rg(e.getUTCMilliseconds(),t,3)}function Dm(e,t){return Nm(e,t)+"000"}function Fm(e,t){return Rg(e.getUTCMonth()+1,t,2)}function Im(e,t){return Rg(e.getUTCMinutes(),t,2)}function Mm(e,t){return Rg(e.getUTCSeconds(),t,2)}function Om(e){var t=e.getUTCDay();return 0===t?7:t}function Rm(e,t){return Rg(Sv.count(Mv(e)-1,e),t,2)}function Zm(e){var t=e.getUTCDay();return t>=4||0===t?Nv(e):Nv.ceil(e)}function Bm(e,t){return e=Zm(e),Rg(Nv.count(Mv(e),e)+(4===Mv(e).getUTCDay()),t,2)}function zm(e){return e.getUTCDay()}function Lm(e,t){return Rg(Av.count(Mv(e)-1,e),t,2)}function Pm(e,t){return Rg(e.getUTCFullYear()%100,t,2)}function jm(e,t){return Rg((e=Zm(e)).getUTCFullYear()%100,t,2)}function Um(e,t){return Rg(e.getUTCFullYear()%1e4,t,4)}function Wm(e,t){var n=e.getUTCDay();return Rg((e=n>=4||0===n?Nv(e):Nv.ceil(e)).getUTCFullYear()%1e4,t,4)}function Vm(){return"+0000"}function Gm(){return"%"}function qm(e){return+e}function Hm(e){return Math.floor(+e/1e3)}function Xm(e){var t={};return function(n){return t[n]||(t[n]=e(n))}}function Ym(e){var t=Xm(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat:function(e){var n=jp(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(e,t){return function(n){var r=e(n),a=r.indexOf(t);if(a<0)return r;for(var i=function(e,t){var n,r=e.lastIndexOf("e");if(r>0)return r;for(r=e.length;--r>t;)if((n=e.charCodeAt(r))>=48&&n<=57)return r+1}(r,a),o=i<r.length?r.slice(i):"";--i>a;)if("0"!==r[i]){++i;break}return r.slice(0,i)+o}}(t(n),t(".1f")(1)[1])}return t(n)},formatSpan:function(e,r,a,i){i=jp(null==i?",f":i);var o,u=zp(e,r,a),s=Math.max(Math.abs(e),Math.abs(r));if(null==i.precision)switch(i.type){case"s":return isNaN(o=Gp(u,s))||(i.precision=o),n(i,s);case"":case"e":case"g":case"p":case"r":isNaN(o=qp(u,s))||(i.precision=o-("e"===i.type));break;case"f":case"%":isNaN(o=Hp(u))||(i.precision=o-2*("%"===i.type))}return t(i)}}}function Km(){return Ym({format:Qp,formatPrefix:Jp})}function $m(e,t,n){Id(n=n||{})||Ad("Invalid time multi-format specifier: ".concat(n));var r=t(ag),a=t(rg),i=t(ng),o=t(Jv),u=t(Qv),s=t($v),c=t(Kv),l=t(Yv),f=e(n[ig]||".%L"),d=e(n[ag]||":%S"),h=e(n[rg]||"%I:%M"),p=e(n[ng]||"%I %p"),v=e(n[Jv]||n[eg]||"%a %d"),g=e(n[Qv]||"%b %d"),m=e(n[$v]||"%B"),y=e(n[Kv]||"%B"),b=e(n[Yv]||"%Y");return function(e){return(r(e)<e?f:a(e)<e?d:i(e)<e?h:o(e)<e?p:s(e)<e?u(e)<e?v:g:l(e)<e?c(e)<e?m:y:b)(e)}}function Qm(e){var t=Xm(e.format),n=Xm(e.utcFormat);return{timeFormat:function(e){return jd(e)?t(e):$m(t,mg,e)},utcFormat:function(e){return jd(e)?n(e):$m(n,yg,e)},timeParse:Xm(e.parse),utcParse:Xm(e.utcParse)}}function Jm(){return Qm({format:Eg,parse:Tg,utcFormat:Ng,utcParse:Dg})}!function(e){Ag=function(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,i=e.days,o=e.shortDays,u=e.months,s=e.shortMonths,c=Bg(a),l=zg(a),f=Bg(i),d=zg(i),h=Bg(o),p=zg(o),v=Bg(u),g=zg(u),m=Bg(s),y=zg(s),b={a:function(e){return o[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return s[e.getMonth()]},B:function(e){return u[e.getMonth()]},c:null,d:im,e:im,f:lm,g:km,G:_m,H:om,I:um,j:sm,L:cm,m:fm,M:dm,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:qm,s:Hm,S:hm,u:pm,U:vm,V:mm,w:ym,W:bm,x:null,X:null,y:xm,Y:wm,Z:Cm,"%":Gm},x={a:function(e){return o[e.getUTCDay()]},A:function(e){return i[e.getUTCDay()]},b:function(e){return s[e.getUTCMonth()]},B:function(e){return u[e.getUTCMonth()]},c:null,d:Sm,e:Sm,f:Dm,g:jm,G:Wm,H:Am,I:Em,j:Tm,L:Nm,m:Fm,M:Im,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:qm,s:Hm,S:Mm,u:Om,U:Rm,V:Bm,w:zm,W:Lm,x:null,X:null,y:Pm,Y:Um,Z:Vm,"%":Gm},k={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return C(e,t,n,r)},d:Yg,e:Yg,f:tm,g:Gg,G:Vg,H:$g,I:$g,j:Kg,L:em,m:Xg,M:Qg,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=l.get(r[0].toLowerCase()),n+r[0].length):-1},q:Hg,Q:rm,s:am,S:Jg,u:Pg,U:jg,V:Ug,w:Lg,W:Wg,x:function(e,t,r){return C(e,n,t,r)},X:function(e,t,n){return C(e,r,t,n)},y:Gg,Y:Vg,Z:qg,"%":nm};function w(e,t){return function(n){var r,a,i,o=[],u=-1,s=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++u<c;)37===e.charCodeAt(u)&&(o.push(e.slice(s,u)),null!=(a=Fg[r=e.charAt(++u)])?r=e.charAt(++u):a="e"===r?" ":"0",(i=t[r])&&(r=i(n,a)),o.push(r),s=u+1);return o.push(e.slice(s,u)),o.join("")}}function _(e,t){return function(n){var r,a,i=Sg(1900,void 0,1);if(C(i,e,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(1e3*i.s+("L"in i?i.L:0));if(t&&!("Z"in i)&&(i.Z=0),"p"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m="q"in i?i.q:0),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(a=(r=Cg(Sg(i.y,0,1))).getUTCDay(),r=a>4||0===a?Av.ceil(r):Av(r),r=pv.offset(r,7*(i.V-1)),i.y=r.getUTCFullYear(),i.m=r.getUTCMonth(),i.d=r.getUTCDate()+(i.w+6)%7):(a=(r=_g(Sg(i.y,0,1))).getDay(),r=a>4||0===a?yv.ceil(r):yv(r),r=hv.offset(r,7*(i.V-1)),i.y=r.getFullYear(),i.m=r.getMonth(),i.d=r.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),a="Z"in i?Cg(Sg(i.y,0,1)).getUTCDay():_g(Sg(i.y,0,1)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(a+5)%7:i.w+7*i.U-(a+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,Cg(i)):_g(i)}}function C(e,t,n,r){for(var a,i,o=0,u=t.length,s=n.length;o<u;){if(r>=s)return-1;if(37===(a=t.charCodeAt(o++))){if(a=t.charAt(o++),!(i=k[a in Fg?t.charAt(o++):a])||(r=i(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return b.x=w(n,b),b.X=w(r,b),b.c=w(t,b),x.x=w(n,x),x.X=w(r,x),x.c=w(t,x),{format:function(e){var t=w(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=_(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=_(e+="",!0);return t.toString=function(){return e},t}}}(e),Eg=Ag.format,Tg=Ag.parse,Ng=Ag.utcFormat,Dg=Ag.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Km(),Jm();var ey=/^(data:|([A-Za-z]+:)?\/\/)/,ty=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,ny=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,ry="file://";function ay(e,t){return iy.apply(this,arguments)}function iy(){return(iy=(0,Bt.Z)((0,w.Z)().mark((function e(t,n){var r,a;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sanitize(t,n);case 2:return r=e.sent,a=r.href,e.abrupt("return",r.localFile?this.file(a):this.http(a,n));case 5:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function oy(e,t){return uy.apply(this,arguments)}function uy(){return uy=(0,Bt.Z)((0,w.Z)().mark((function e(t,n){var r,a,i,o,u,s,c;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Bd({},this.options,n),r=this.fileAccess,a={href:null},s=ty.test(t.replace(ny,"")),null!=t&&"string"===typeof t&&s||Ad("Sanitize failure, invalid URI: "+Ud(t)),c=ey.test(t),(u=n.baseURL)&&!c&&(t.startsWith("/")||u.endsWith("/")||(t="/"+t),t=u+t),o=(i=t.startsWith(ry))||"file"===n.mode||"http"!==n.mode&&!c&&r,i?t=t.slice(ry.length):t.startsWith("//")&&("file"===n.defaultProtocol?(t=t.slice(2),o=!0):t=(n.defaultProtocol||"http")+":"+t),Object.defineProperty(a,"localFile",{value:!!o}),a.href=t,n.target&&(a.target=n.target+""),n.rel&&(a.rel=n.rel+""),"image"===n.context&&n.crossOrigin&&(a.crossOrigin=n.crossOrigin+""),e.abrupt("return",a);case 14:case"end":return e.stop()}}),e,this)}))),uy.apply(this,arguments)}function sy(e){return e?function(t){return new Promise((function(n,r){e.readFile(t,(function(e,t){e?r(e):n(t)}))}))}:cy}function cy(){return ly.apply(this,arguments)}function ly(){return(ly=(0,Bt.Z)((0,w.Z)().mark((function e(){return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ad("No file system access.");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fy(e){return e?function(){var t=(0,Bt.Z)((0,w.Z)().mark((function t(n,r){var a,i,o;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Bd({},this.options.http,r),i=r&&r.response,t.next=4,e(n,a);case 4:return o=t.sent,t.abrupt("return",o.ok?Zd(o[i])?o[i]():o.text():Ad(o.status+""+o.statusText));case 6:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}():dy}function dy(){return hy.apply(this,arguments)}function hy(){return(hy=(0,Bt.Z)((0,w.Z)().mark((function e(){return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ad("No HTTP fetch method available.");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function py(e){var t=function(t,n){var r={delimiter:e};return vy(t,n?Bd(n,r):r)};return t.responseType="text",t}function vy(e,t){return t.header&&(e=t.header.map(Ud).join(t.delimiter)+"\n"+e),Fp(t.delimiter).parse(e+"")}function gy(e,t){var n,r=t&&t.property?Td(t.property):Nd;return!Id(e)||(n=e,"function"===typeof Buffer&&Zd(Buffer.isBuffer)&&Buffer.isBuffer(n))?r(JSON.parse(e)):function(e,t){!Fd(e)&&function(e){return e&&Zd(e[Symbol.iterator])}(e)&&(e=(0,ln.Z)(e));return t&&t.copy?JSON.parse(JSON.stringify(e)):e}(r(e),t)}vy.responseType="text",gy.responseType="json";var my={interior:function(e,t){return e!==t},exterior:function(e,t){return e===t}};function yy(e,t){var n,r,a,i;return e=gy(e,t),t&&t.feature?(n=bn,a=t.feature):t&&t.mesh?(n=_n,a=t.mesh,i=my[t.filter]):Ad("Missing TopoJSON feature or mesh parameter."),(r=(r=e.objects[a])?n(e,r,i):Ad("Invalid TopoJSON object: "+a))&&r.features||[r]}yy.responseType="json";py(","),py("\t");var by=function(e,t){return function(n){return{options:n||{},sanitize:oy,load:ay,fileAccess:!!t,file:sy(t),http:fy(e)}}}("undefined"!==typeof fetch&&fetch,null);function xy(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ky(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function wy(e){var t,n,r;function a(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<i){if(0!==t(r,r))return i;do{var o=a+i>>>1;n(e[o],r)<0?a=o+1:i=o}while(a<i)}return a}return 2!==e.length?(t=xy,n=function(t,n){return xy(e(t),n)},r=function(t,n){return e(t)-n}):(t=e===xy||e===ky?e:_y,n=e,r=e),{left:a,center:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,o=a(e,t,n,i-1);return o>n&&r(e[o-1],t)>-r(e[o],t)?o-1:o},right:function(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<i){if(0!==t(r,r))return i;do{var o=a+i>>>1;n(e[o],r)<=0?a=o+1:i=o}while(a<i)}return a}}}function _y(){return 0}function Cy(e){return null===e?NaN:+e}var Sy=wy(xy),Ay=Sy.right,Ey=(Sy.left,wy(Cy).center,Ay);function Ty(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ny(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Dy(){}var Fy=.7,Iy=1/Fy,My="\\s*([+-]?\\d+)\\s*",Oy="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ry="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Zy=/^#([0-9a-f]{3,8})$/,By=new RegExp("^rgb\\("+[My,My,My]+"\\)$"),zy=new RegExp("^rgb\\("+[Ry,Ry,Ry]+"\\)$"),Ly=new RegExp("^rgba\\("+[My,My,My,Oy]+"\\)$"),Py=new RegExp("^rgba\\("+[Ry,Ry,Ry,Oy]+"\\)$"),jy=new RegExp("^hsl\\("+[Oy,Ry,Ry]+"\\)$"),Uy=new RegExp("^hsla\\("+[Oy,Ry,Ry,Oy]+"\\)$"),Wy={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Vy(){return this.rgb().formatHex()}function Gy(){return this.rgb().formatRgb()}function qy(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Zy.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Hy(t):3===n?new $y(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Xy(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Xy(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=By.exec(e))?new $y(t[1],t[2],t[3],1):(t=zy.exec(e))?new $y(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Ly.exec(e))?Xy(t[1],t[2],t[3],t[4]):(t=Py.exec(e))?Xy(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=jy.exec(e))?tb(t[1],t[2]/100,t[3]/100,1):(t=Uy.exec(e))?tb(t[1],t[2]/100,t[3]/100,t[4]):Wy.hasOwnProperty(e)?Hy(Wy[e]):"transparent"===e?new $y(NaN,NaN,NaN,0):null}function Hy(e){return new $y(e>>16&255,e>>8&255,255&e,1)}function Xy(e,t,n,r){return r<=0&&(e=t=n=NaN),new $y(e,t,n,r)}function Yy(e){return e instanceof Dy||(e=qy(e)),e?new $y((e=e.rgb()).r,e.g,e.b,e.opacity):new $y}function Ky(e,t,n,r){return 1===arguments.length?Yy(e):new $y(e,t,n,null==r?1:r)}function $y(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function Qy(){return"#"+eb(this.r)+eb(this.g)+eb(this.b)}function Jy(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function eb(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function tb(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ab(e,t,n,r)}function nb(e){if(e instanceof ab)return new ab(e.h,e.s,e.l,e.opacity);if(e instanceof Dy||(e=qy(e)),!e)return new ab;if(e instanceof ab)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,a=Math.min(t,n,r),i=Math.max(t,n,r),o=NaN,u=i-a,s=(i+a)/2;return u?(o=t===i?(n-r)/u+6*(n<r):n===i?(r-t)/u+2:(t-n)/u+4,u/=s<.5?i+a:2-i-a,o*=60):u=s>0&&s<1?0:o,new ab(o,u,s,e.opacity)}function rb(e,t,n,r){return 1===arguments.length?nb(e):new ab(e,t,n,null==r?1:r)}function ab(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function ib(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function ob(e,t,n,r,a){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*n+(1+3*e+3*i-3*o)*r+o*a)/6}function ub(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),a=e[r],i=e[r+1],o=r>0?e[r-1]:2*a-i,u=r<t-1?e[r+2]:2*i-a;return ob((n-r/t)*t,o,a,i,u)}}function sb(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),a=e[(r+t-1)%t],i=e[r%t],o=e[(r+1)%t],u=e[(r+2)%t];return ob((n-r/t)*t,a,i,o,u)}}Ty(Dy,qy,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Vy,formatHex:Vy,formatHsl:function(){return nb(this).formatHsl()},formatRgb:Gy,toString:Gy}),Ty($y,Ky,Ny(Dy,{brighter:function(e){return e=null==e?Iy:Math.pow(Iy,e),new $y(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?Fy:Math.pow(Fy,e),new $y(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Qy,formatHex:Qy,formatRgb:Jy,toString:Jy})),Ty(ab,rb,Ny(Dy,{brighter:function(e){return e=null==e?Iy:Math.pow(Iy,e),new ab(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?Fy:Math.pow(Fy,e),new ab(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new $y(ib(e>=240?e-240:e+120,a,r),ib(e,a,r),ib(e<120?e+240:e-120,a,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var cb=function(e){return function(){return e}};function lb(e,t){return function(n){return e+n*t}}function fb(e,t){var n=t-e;return n?lb(e,n>180||n<-180?n-360*Math.round(n/360):n):cb(isNaN(e)?t:e)}function db(e){return 1===(e=+e)?hb:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):cb(isNaN(t)?n:t)}}function hb(e,t){var n=t-e;return n?lb(e,n):cb(isNaN(e)?t:e)}var pb=function e(t){var n=db(t);function r(e,t){var r=n((e=Ky(e)).r,(t=Ky(t)).r),a=n(e.g,t.g),i=n(e.b,t.b),o=hb(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=a(t),e.b=i(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function vb(e){return function(t){var n,r,a=t.length,i=new Array(a),o=new Array(a),u=new Array(a);for(n=0;n<a;++n)r=Ky(t[n]),i[n]=r.r||0,o[n]=r.g||0,u[n]=r.b||0;return i=e(i),o=e(o),u=e(u),r.opacity=1,function(e){return r.r=i(e),r.g=o(e),r.b=u(e),r+""}}}var gb=vb(ub),mb=vb(sb);function yb(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}}function bb(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function xb(e,t){return(bb(t)?yb:kb)(e,t)}function kb(e,t){var n,r=t?t.length:0,a=e?Math.min(r,e.length):0,i=new Array(a),o=new Array(r);for(n=0;n<a;++n)i[n]=Tb(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<a;++n)o[n]=i[n](e);return o}}function wb(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function _b(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Cb(e,t){var n,r={},a={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=Tb(e[n],t[n]):a[n]=t[n];return function(e){for(n in r)a[n]=r[n](e);return a}}var Sb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ab=new RegExp(Sb.source,"g");function Eb(e,t){var n,r,a,i=Sb.lastIndex=Ab.lastIndex=0,o=-1,u=[],s=[];for(e+="",t+="";(n=Sb.exec(e))&&(r=Ab.exec(t));)(a=r.index)>i&&(a=t.slice(i,a),u[o]?u[o]+=a:u[++o]=a),(n=n[0])===(r=r[0])?u[o]?u[o]+=r:u[++o]=r:(u[++o]=null,s.push({i:o,x:_b(n,r)})),i=Ab.lastIndex;return i<t.length&&(a=t.slice(i),u[o]?u[o]+=a:u[++o]=a),u.length<2?s[0]?function(e){return function(t){return e(t)+""}}(s[0].x):function(e){return function(){return e}}(t):(t=s.length,function(e){for(var n,r=0;r<t;++r)u[(n=s[r]).i]=n.x(e);return u.join("")})}function Tb(e,t){var n,r=typeof t;return null==t||"boolean"===r?cb(t):("number"===r?_b:"string"===r?(n=qy(t))?(t=n,pb):Eb:t instanceof qy?pb:t instanceof Date?wb:bb(t)?yb:Array.isArray(t)?kb:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?Cb:_b)(e,t)}function Nb(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function Db(e){return+e}var Fb=[0,1];function Ib(e){return e}function Mb(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function Ob(e,t,n){var r=e[0],a=e[1],i=t[0],o=t[1];return a<r?(r=Mb(a,r),i=n(o,i)):(r=Mb(r,a),i=n(i,o)),function(e){return i(r(e))}}function Rb(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),i=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)a[o]=Mb(e[o],e[o+1]),i[o]=n(t[o],t[o+1]);return function(t){var n=Ey(e,t,1,r)-1;return i[n](a[n](t))}}function Zb(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Bb(){var e,t,n,r,a,i,o=Fb,u=Fb,s=Tb,c=Ib;function l(){var e=Math.min(o.length,u.length);return c!==Ib&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(o[0],o[e-1])),r=e>2?Rb:Ob,a=i=null,f}function f(t){return null==t||isNaN(t=+t)?n:(a||(a=r(o.map(e),u,s)))(e(c(t)))}return f.invert=function(n){return c(t((i||(i=r(u,o.map(e),_b)))(n)))},f.domain=function(e){return arguments.length?(o=Array.from(e,Db),l()):o.slice()},f.range=function(e){return arguments.length?(u=Array.from(e),l()):u.slice()},f.rangeRound=function(e){return u=Array.from(e),s=Nb,l()},f.clamp=function(e){return arguments.length?(c=!!e||Ib,l()):c!==Ib},f.interpolate=function(e){return arguments.length?(s=e,l()):s},f.unknown=function(e){return arguments.length?(n=e,f):n},function(n,r){return e=n,t=r,l()}}function zb(){return Bb()(Ib,Ib)}function Lb(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function Pb(e,t){switch(arguments.length){case 0:break;case 1:"function"===typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"===typeof t?this.interpolator(t):this.range(t)}return this}function jb(e,t,n,r){var a,i=zp(e,t,n);switch((r=jp(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(a=Gp(i,o))||(r.precision=a),Jp(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=qp(i,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=Hp(i))||(r.precision=a-2*("%"===r.type))}return Qp(r)}function Ub(e){var t=e.domain;return e.ticks=function(e){var n=t();return Zp(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return jb(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,a,i=t(),o=0,u=i.length-1,s=i[o],c=i[u],l=10;for(c<s&&(a=s,s=c,c=a,a=o,o=u,u=a);l-- >0;){if((a=Bp(s,c,n))===r)return i[o]=s,i[u]=c,t(i);if(a>0)s=Math.floor(s/a)*a,c=Math.ceil(c/a)*a;else{if(!(a<0))break;s=Math.ceil(s*a)/a,c=Math.floor(c*a)/a}r=a}return e},e}function Wb(e,t){var n,r=0,a=(e=e.slice()).length-1,i=e[r],o=e[a];return o<i&&(n=r,r=a,a=n,n=i,i=o,o=n),e[r]=t.floor(i),e[a]=t.ceil(o),e}function Vb(e){return Math.log(e)}function Gb(e){return Math.exp(e)}function qb(e){return-Math.log(-e)}function Hb(e){return-Math.exp(-e)}function Xb(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Yb(e){return function(t,n){return-e(-t,n)}}function Kb(e){var t,n,r=e(Vb,Gb),a=r.domain,i=10;function o(){return t=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(i),n=function(e){return 10===e?Xb:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(i),a()[0]<0?(t=Yb(t),n=Yb(n),e(qb,Hb)):e(Vb,Gb),r}return r.base=function(e){return arguments.length?(i=+e,o()):i},r.domain=function(e){return arguments.length?(a(e),o()):a()},r.ticks=function(e){var r=a(),o=r[0],u=r[r.length-1],s=u<o;if(s){var c=[u,o];o=c[0],u=c[1]}var l,f,d=t(o),h=t(u),p=null==e?10:+e,v=[];if(!(i%1)&&h-d<p){if(d=Math.floor(d),h=Math.ceil(h),o>0){for(;d<=h;++d)for(l=1;l<i;++l)if(!((f=d<0?l/n(-d):l*n(d))<o)){if(f>u)break;v.push(f)}}else for(;d<=h;++d)for(l=i-1;l>=1;--l)if(!((f=d>0?l/n(-d):l*n(d))<o)){if(f>u)break;v.push(f)}2*v.length<p&&(v=Zp(o,u,p))}else v=Zp(d,h,Math.min(h-d,p)).map(n);return s?v.reverse():v},r.tickFormat=function(e,a){if(null==e&&(e=10),null==a&&(a=10===i?"s":","),"function"!==typeof a&&(i%1||null!=(a=jp(a)).precision||(a.trim=!0),a=Qp(a)),e===1/0)return a;var o=Math.max(1,i*e/r.ticks().length);return function(e){var r=e/n(Math.round(t(e)));return r*i<i-.5&&(r*=i),r<=o?a(e):""}},r.nice=function(){return a(Wb(a(),{floor:function(e){return n(Math.floor(t(e)))},ceil:function(e){return n(Math.ceil(t(e)))}}))},r}function $b(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Qb(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Jb(e){return e<0?-e*e:e*e}function ex(e){var t=e(Ib,Ib),n=1;function r(){return 1===n?e(Ib,Ib):.5===n?e(Qb,Jb):e($b(n),$b(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,r()):n},Ub(t)}function tx(){var e=ex(Bb());return e.copy=function(){return Zb(e,tx()).exponent(e.exponent())},Lb.apply(e,arguments),e}function nx(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function rx(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function ax(e){var t=1,n=e(nx(t),rx(t));return n.constant=function(n){return arguments.length?e(nx(t=+n),rx(t)):t},Ub(n)}function ix(e,t,n,r,a,i){var o=[[Pv,1,ov],[Pv,5,5e3],[Pv,15,15e3],[Pv,30,3e4],[i,1,uv],[i,5,3e5],[i,15,9e5],[i,30,18e5],[a,1,sv],[a,3,108e5],[a,6,216e5],[a,12,432e5],[r,1,cv],[r,2,1728e5],[n,1,lv],[t,1,fv],[t,3,7776e6],[e,1,dv]];function u(t,n,r){var a=Math.abs(n-t)/r,i=wy((function(e){return(0,ku.Z)(e,3)[2]})).right(o,a);if(i===o.length)return e.every(zp(t/dv,n/dv,r));if(0===i)return jv.every(Math.max(zp(t,n,r),1));var u=(0,ku.Z)(o[a/o[i-1][2]<o[i][2]/a?i-1:i],2),s=u[0],c=u[1];return s.every(c)}return[function(e,t,n){var r=t<e;if(r){var a=[t,e];e=a[0],t=a[1]}var i=n&&"function"===typeof n.range?n:u(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},u]}var ox=ix(Mv,Rv,Sv,vv,Bv,Lv),ux=(0,ku.Z)(ox,2),sx=ux[0],cx=ux[1],lx=ix(Iv,Ov,mv,hv,Zv,zv),fx=(0,ku.Z)(lx,2),dx=fx[0],hx=fx[1];function px(e){return new Date(e)}function vx(e){return e instanceof Date?+e:+new Date(+e)}function gx(e,t,n,r,a,i,o,u,s,c){var l=zb(),f=l.invert,d=l.domain,h=c(".%L"),p=c(":%S"),v=c("%I:%M"),g=c("%I %p"),m=c("%a %d"),y=c("%b %d"),b=c("%B"),x=c("%Y");function k(e){return(s(e)<e?h:u(e)<e?p:o(e)<e?v:i(e)<e?g:r(e)<e?a(e)<e?m:y:n(e)<e?b:x)(e)}return l.invert=function(e){return new Date(f(e))},l.domain=function(e){return arguments.length?d(Array.from(e,vx)):d().map(px)},l.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},l.tickFormat=function(e,t){return null==t?k:c(t)},l.nice=function(e){var n=d();return e&&"function"===typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(Wb(n,e)):l},l.copy=function(){return Zb(l,gx(e,t,n,r,a,i,o,u,s,c))},l}function mx(){var e,t,n,r,a,i=0,o=1,u=Ib,s=!1;function c(t){return null==t||isNaN(t=+t)?a:u(0===n?.5:(t=(r(t)-e)*n,s?Math.max(0,Math.min(1,t)):t))}function l(e){return function(t){var n,r,a;return arguments.length?(r=(n=(0,ku.Z)(t,2))[0],a=n[1],u=e(r,a),c):[u(0),u(1)]}}return c.domain=function(a){var u;return arguments.length?(u=(0,ku.Z)(a,2),i=u[0],o=u[1],e=r(i=+i),t=r(o=+o),n=e===t?0:1/(t-e),c):[i,o]},c.clamp=function(e){return arguments.length?(s=!!e,c):s},c.interpolator=function(e){return arguments.length?(u=e,c):u},c.range=l(Tb),c.rangeRound=l(Nb),c.unknown=function(e){return arguments.length?(a=e,c):a},function(a){return r=a,e=a(i),t=a(o),n=e===t?0:1/(t-e),c}}function yx(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function bx(){var e=Ub(mx()(Ib));return e.copy=function(){return yx(e,bx())},Pb.apply(e,arguments)}function xx(){var e=ex(mx());return e.copy=function(){return yx(e,xx()).exponent(e.exponent())},Pb.apply(e,arguments)}function kx(e,t){void 0===t&&(t=e,e=Tb);for(var n=0,r=t.length-1,a=t[0],i=new Array(r<0?0:r);n<r;)i[n]=e(a,a=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return i[t](e-t)}}function wx(){var e,t,n,r,a,i,o,u=0,s=.5,c=1,l=1,f=Ib,d=!1;function h(e){return isNaN(e=+e)?o:(e=.5+((e=+i(e))-t)*(l*e<l*t?r:a),f(d?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,r,a,i;return arguments.length?(r=(n=(0,ku.Z)(t,3))[0],a=n[1],i=n[2],f=kx(e,[r,a,i]),h):[f(0),f(.5),f(1)]}}return h.domain=function(o){var f;return arguments.length?(f=(0,ku.Z)(o,3),u=f[0],s=f[1],c=f[2],e=i(u=+u),t=i(s=+s),n=i(c=+c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),l=t<e?-1:1,h):[u,s,c]},h.clamp=function(e){return arguments.length?(d=!!e,h):d},h.interpolator=function(e){return arguments.length?(f=e,h):f},h.range=p(Tb),h.rangeRound=p(Nb),h.unknown=function(e){return arguments.length?(o=e,h):o},function(o){return i=o,e=o(u),t=o(s),n=o(c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),l=t<e?-1:1,h}}function _x(){var e=ex(wx());return e.copy=function(){return yx(e,_x()).exponent(e.exponent())},Pb.apply(e,arguments)}function Cx(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Cy;if((r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,i=Math.floor(a),o=+n(e[i],i,e),u=+n(e[i+1],i+1,e);return o+(u-o)*(a-i)}}var Sx=n(7326),Ax=n(1752),Ex=n(1120),Tx=n(136),Nx=n(7277),Dx=n(8664),Fx=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zx;if((0,Jh.Z)(this,n),r=t.call(this),Object.defineProperties((0,Sx.Z)(r),{_intern:{value:new Map},_key:{value:a}}),null!=e){var i,o=(0,Zt.Z)(e);try{for(o.s();!(i=o.n()).done;){var u=(0,ku.Z)(i.value,2),s=u[0],c=u[1];r.set(s,c)}}catch(l){o.e(l)}finally{o.f()}}return r}return(0,ep.Z)(n,[{key:"get",value:function(e){return(0,Ax.Z)((0,Ex.Z)(n.prototype),"get",this).call(this,Mx(this,e))}},{key:"has",value:function(e){return(0,Ax.Z)((0,Ex.Z)(n.prototype),"has",this).call(this,Mx(this,e))}},{key:"set",value:function(e,t){return(0,Ax.Z)((0,Ex.Z)(n.prototype),"set",this).call(this,Ox(this,e),t)}},{key:"delete",value:function(e){return(0,Ax.Z)((0,Ex.Z)(n.prototype),"delete",this).call(this,Rx(this,e))}}]),n}((0,Dx.Z)(Map)),Ix=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zx;if((0,Jh.Z)(this,n),r=t.call(this),Object.defineProperties((0,Sx.Z)(r),{_intern:{value:new Map},_key:{value:a}}),null!=e){var i,o=(0,Zt.Z)(e);try{for(o.s();!(i=o.n()).done;){var u=i.value;r.add(u)}}catch(s){o.e(s)}finally{o.f()}}return r}return(0,ep.Z)(n,[{key:"has",value:function(e){return(0,Ax.Z)((0,Ex.Z)(n.prototype),"has",this).call(this,Mx(this,e))}},{key:"add",value:function(e){return(0,Ax.Z)((0,Ex.Z)(n.prototype),"add",this).call(this,Ox(this,e))}},{key:"delete",value:function(e){return(0,Ax.Z)((0,Ex.Z)(n.prototype),"delete",this).call(this,Rx(this,e))}}]),n}((0,Dx.Z)(Set));function Mx(e,t){var n=e._intern,r=(0,e._key)(t);return n.has(r)?n.get(r):t}function Ox(e,t){var n=e._intern,r=(0,e._key)(t);return n.has(r)?n.get(r):(n.set(r,t),t)}function Rx(e,t){var n=e._intern,r=(0,e._key)(t);return n.has(r)&&(t=n.get(t),n.delete(r)),t}function Zx(e){return null!==e&&"object"===typeof e?e.valueOf():e}var Bx=Symbol("implicit");function zx(){var e=new Fx,t=[],n=[],r=Bx;function a(a){var i=e.get(a);if(void 0===i){if(r!==Bx)return r;e.set(a,i=t.push(a)-1)}return n[i%n.length]}return a.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Fx;var r,i=(0,Zt.Z)(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;e.has(o)||e.set(o,t.push(o)-1)}}catch(u){i.e(u)}finally{i.f()}return a},a.range=function(e){return arguments.length?(n=Array.from(e),a):n.slice()},a.unknown=function(e){return arguments.length?(r=e,a):r},a.copy=function(){return zx(t,n).unknown(r)},Lb.apply(a,arguments),a}function Lx(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function Px(e,t){var n=fb(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}}var jx,Ux=180/Math.PI,Wx={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Vx(e,t,n,r,a,i){var o,u,s;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(s=e*n+t*r)&&(n-=e*s,r-=t*s),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,s/=u),e*r<t*n&&(e=-e,t=-t,s=-s,o=-o),{translateX:a,translateY:i,rotate:Math.atan2(t,e)*Ux,skewX:Math.atan(s)*Ux,scaleX:o,scaleY:u}}function Gx(e,t,n,r){function a(e){return e.length?e.pop()+" ":""}return function(i,o){var u=[],s=[];return i=e(i),o=e(o),function(e,r,a,i,o,u){if(e!==a||r!==i){var s=o.push("translate(",null,t,null,n);u.push({i:s-4,x:_b(e,a)},{i:s-2,x:_b(r,i)})}else(a||i)&&o.push("translate("+a+t+i+n)}(i.translateX,i.translateY,o.translateX,o.translateY,u,s),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(a(n)+"rotate(",null,r)-2,x:_b(e,t)})):t&&n.push(a(n)+"rotate("+t+r)}(i.rotate,o.rotate,u,s),function(e,t,n,i){e!==t?i.push({i:n.push(a(n)+"skewX(",null,r)-2,x:_b(e,t)}):t&&n.push(a(n)+"skewX("+t+r)}(i.skewX,o.skewX,u,s),function(e,t,n,r,i,o){if(e!==n||t!==r){var u=i.push(a(i)+"scale(",null,",",null,")");o.push({i:u-4,x:_b(e,n)},{i:u-2,x:_b(t,r)})}else 1===n&&1===r||i.push(a(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,o.scaleX,o.scaleY,u,s),i=o=null,function(e){for(var t,n=-1,r=s.length;++n<r;)u[(t=s[n]).i]=t.x(e);return u.join("")}}}var qx=Gx((function(e){var t=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Wx:Vx(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),Hx=Gx((function(e){return null==e?Wx:(jx||(jx=document.createElementNS("http://www.w3.org/2000/svg","g")),jx.setAttribute("transform",e),(e=jx.transform.baseVal.consolidate())?Vx((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):Wx)}),", ",")",")");function Xx(e){return((e=Math.exp(e))+1/e)/2}var Yx=function e(t,n,r){function a(e,a){var i,o,u=e[0],s=e[1],c=e[2],l=a[0],f=a[1],d=a[2],h=l-u,p=f-s,v=h*h+p*p;if(v<1e-12)o=Math.log(d/c)/t,i=function(e){return[u+e*h,s+e*p,c*Math.exp(t*e*o)]};else{var g=Math.sqrt(v),m=(d*d-c*c+r*v)/(2*c*n*g),y=(d*d-c*c-r*v)/(2*d*n*g),b=Math.log(Math.sqrt(m*m+1)-m),x=Math.log(Math.sqrt(y*y+1)-y);o=(x-b)/t,i=function(e){var r=e*o,a=Xx(b),i=c/(n*g)*(a*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*r+b)-function(e){return((e=Math.exp(e))-1/e)/2}(b));return[u+i*h,s+i*p,c*a/Xx(t*r+b)]}}return i.duration=1e3*o*t/Math.SQRT2,i}return a.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},a}(Math.SQRT2,2,4);function Kx(e){return function(t,n){var r=e((t=rb(t)).h,(n=rb(n)).h),a=hb(t.s,n.s),i=hb(t.l,n.l),o=hb(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=a(e),t.l=i(e),t.opacity=o(e),t+""}}}var $x=Kx(fb),Qx=Kx(hb),Jx=Math.PI/180,ek=180/Math.PI,tk=.96422,nk=.82521,rk=4/29,ak=6/29,ik=3*ak*ak;function ok(e){if(e instanceof sk)return new sk(e.l,e.a,e.b,e.opacity);if(e instanceof vk)return gk(e);e instanceof $y||(e=Yy(e));var t,n,r=dk(e.r),a=dk(e.g),i=dk(e.b),o=ck((.2225045*r+.7168786*a+.0606169*i)/1);return r===a&&a===i?t=n=o:(t=ck((.4360747*r+.3850649*a+.1430804*i)/tk),n=ck((.0139322*r+.0971045*a+.7141733*i)/nk)),new sk(116*o-16,500*(t-o),200*(o-n),e.opacity)}function uk(e,t,n,r){return 1===arguments.length?ok(e):new sk(e,t,n,null==r?1:r)}function sk(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function ck(e){return e>.008856451679035631?Math.pow(e,1/3):e/ik+rk}function lk(e){return e>ak?e*e*e:ik*(e-rk)}function fk(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function dk(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function hk(e){if(e instanceof vk)return new vk(e.h,e.c,e.l,e.opacity);if(e instanceof sk||(e=ok(e)),0===e.a&&0===e.b)return new vk(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*ek;return new vk(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function pk(e,t,n,r){return 1===arguments.length?hk(e):new vk(e,t,n,null==r?1:r)}function vk(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function gk(e){if(isNaN(e.h))return new sk(e.l,0,0,e.opacity);var t=e.h*Jx;return new sk(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}function mk(e,t){var n=hb((e=uk(e)).l,(t=uk(t)).l),r=hb(e.a,t.a),a=hb(e.b,t.b),i=hb(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=a(t),e.opacity=i(t),e+""}}function yk(e){return function(t,n){var r=e((t=pk(t)).h,(n=pk(n)).h),a=hb(t.c,n.c),i=hb(t.l,n.l),o=hb(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=a(e),t.l=i(e),t.opacity=o(e),t+""}}}Ty(sk,uk,Ny(Dy,{brighter:function(e){return new sk(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new sk(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new $y(fk(3.1338561*(t=tk*lk(t))-1.6168667*(e=1*lk(e))-.4906146*(n=nk*lk(n))),fk(-.9787684*t+1.9161415*e+.033454*n),fk(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),Ty(vk,pk,Ny(Dy,{brighter:function(e){return new vk(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new vk(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return gk(this).rgb()}}));var bk=yk(fb),xk=yk(hb),kk=-.14861,wk=1.78277,_k=-.29227,Ck=-.90649,Sk=1.97294,Ak=Sk*Ck,Ek=Sk*wk,Tk=wk*_k-Ck*kk;function Nk(e){if(e instanceof Fk)return new Fk(e.h,e.s,e.l,e.opacity);e instanceof $y||(e=Yy(e));var t=e.r/255,n=e.g/255,r=e.b/255,a=(Tk*r+Ak*t-Ek*n)/(Tk+Ak-Ek),i=r-a,o=(Sk*(n-a)-_k*i)/Ck,u=Math.sqrt(o*o+i*i)/(Sk*a*(1-a)),s=u?Math.atan2(o,i)*ek-120:NaN;return new Fk(s<0?s+360:s,u,a,e.opacity)}function Dk(e,t,n,r){return 1===arguments.length?Nk(e):new Fk(e,t,n,null==r?1:r)}function Fk(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function Ik(e){return function t(n){function r(t,r){var a=e((t=Dk(t)).h,(r=Dk(r)).h),i=hb(t.s,r.s),o=hb(t.l,r.l),u=hb(t.opacity,r.opacity);return function(e){return t.h=a(e),t.s=i(e),t.l=o(Math.pow(e,n)),t.opacity=u(e),t+""}}return n=+n,r.gamma=t,r}(1)}Ty(Fk,Dk,Ny(Dy,{brighter:function(e){return e=null==e?Iy:Math.pow(Iy,e),new Fk(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?Fy:Math.pow(Fy,e),new Fk(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*Jx,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),a=Math.sin(e);return new $y(255*(t+n*(kk*r+wk*a)),255*(t+n*(_k*r+Ck*a)),255*(t+n*(Sk*r)),this.opacity)}}));var Mk,Ok,Rk=Ik(fb),Zk=Ik(hb);function Bk(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var zk="linear",Lk="log",Pk="pow",jk="sqrt",Uk="symlog",Wk="time",Vk="utc",Gk="sequential",qk="diverging",Hk="quantile",Xk="quantize",Yk="threshold",Kk="continuous",$k="discrete",Qk="discretizing",Jk="interpolating",ew="temporal";function tw(){var e,t,n=zx().unknown(void 0),r=n.domain,a=n.range,i=[0,1],o=!1,u=0,s=0,c=.5;function l(){var n=r().length,l=i[1]<i[0],f=i[1-l],d=function(e,t,n){var r=e-t+2*n;return e?r>0?r:1:0}(n,u,s),h=i[l-0];e=(f-h)/(d||1),o&&(e=Math.floor(e)),h+=(f-h-e*(n-u))*c,t=e*(1-u),o&&(h=Math.round(h),t=Math.round(t));var p=function(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e+r*n;return i}(n).map((function(t){return h+e*t}));return a(l?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),l()):r()},n.range=function(e){return arguments.length?(i=[+e[0],+e[1]],l()):i.slice()},n.rangeRound=function(e){return i=[+e[0],+e[1]],o=!0,l()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(o=!!e,l()):o},n.padding=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),u=s,l()):u},n.paddingInner=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),l()):u},n.paddingOuter=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),l()):s},n.align=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),l()):c},n.invertRange=function(e){if(null!=e[0]&&null!=e[1]){var n,o,u,s=i[1]<i[0],c=s?a().reverse():a(),l=c.length-1,f=+e[0],d=+e[1];if(f===f&&d===d&&(d<f&&(u=f,f=d,d=u),!(d<c[0]||f>i[1-s])))return n=Math.max(0,Ay(c,f)-1),o=f===d?n:Ay(c,d)-1,f-c[n]>t+1e-10&&++n,s&&(u=n,n=l-o,o=l-u),n>o?void 0:r().slice(n,o+1)}},n.invert=function(e){var t=n.invertRange([e,e]);return t?t[0]:t},n.copy=function(){return tw().domain(r()).range(i).round(o).paddingInner(u).paddingOuter(s).align(c)},l()}function nw(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return nw(t())},e}var rw=Array.prototype.map;function aw(e){return rw.call(e,Od)}var iw=Array.prototype.slice;var ow=new Map,uw=Symbol("vega_scale");function sw(e,t,n){var r=function(){var n=t();return n.invertRange||(n.invertRange=n.invert?function(e){return function(t){var n,r=t[0],a=t[1];return a<r&&(n=r,r=a,a=n),[e.invert(r),e.invert(a)]}}(n):n.invertExtent?function(e){return function(t){var n,r,a,i,o=e.range(),u=t[0],s=t[1],c=-1;for(s<u&&(r=u,u=s,s=r),a=0,i=o.length;a<i;++a)o[a]>=u&&o[a]<=s&&(c<0&&(c=a),n=a);if(!(c<0))return u=e.invertExtent(o[c]),s=e.invertExtent(o[n]),[void 0===u[0]?u[1]:u[0],void 0===s[1]?s[0]:s[1]]}}(n):void 0),n.type=e,function(e){return e[uw]=!0,e}(n)};return r.metadata=Wd(Rd(n)),r}function cw(e,t,n){return arguments.length>1?(ow.set(e,sw(e,t,n)),this):lw(e)?ow.get(e):void 0}function lw(e){return ow.has(e)}function fw(e,t){var n=ow.get(e);return n&&n.metadata[t]}function dw(e){return fw(e,$k)}cw("identity",(function e(t){var n;function r(e){return null==e||isNaN(e=+e)?n:e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=Array.from(e,Db),r):t.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,Db):[0,1],Ub(r)})),cw(zk,(function e(){var t=zb();return t.copy=function(){return Zb(t,e())},Lb.apply(t,arguments),Ub(t)}),Kk),cw(Lk,(function e(){var t=Kb(Bb()).domain([1,10]);return t.copy=function(){return Zb(t,e()).base(t.base())},Lb.apply(t,arguments),t}),[Kk,Lk]),cw(Pk,tx,Kk),cw(jk,(function(){return tx.apply(null,arguments).exponent(.5)}),Kk),cw(Uk,(function e(){var t=ax(Bb());return t.copy=function(){return Zb(t,e()).constant(t.constant())},Lb.apply(t,arguments)}),Kk),cw(Wk,(function(){return Lb.apply(gx(dx,hx,Iv,Ov,mv,hv,Zv,zv,Pv,Eg).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[Kk,ew]),cw(Vk,(function(){return Lb.apply(gx(sx,cx,Mv,Rv,Sv,pv,Bv,Lv,Pv,Ng).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[Kk,ew]),cw(Gk,bx,[Kk,Jk]),cw("".concat(Gk,"-").concat(zk),bx,[Kk,Jk]),cw("".concat(Gk,"-").concat(Lk),(function e(){var t=Kb(mx()).domain([1,10]);return t.copy=function(){return yx(t,e()).base(t.base())},Pb.apply(t,arguments)}),[Kk,Jk,Lk]),cw("".concat(Gk,"-").concat(Pk),xx,[Kk,Jk]),cw("".concat(Gk,"-").concat(jk),(function(){return xx.apply(null,arguments).exponent(.5)}),[Kk,Jk]),cw("".concat(Gk,"-").concat(Uk),(function e(){var t=ax(mx());return t.copy=function(){return yx(t,e()).constant(t.constant())},Pb.apply(t,arguments)}),[Kk,Jk]),cw("".concat(qk,"-").concat(zk),(function e(){var t=Ub(wx()(Ib));return t.copy=function(){return yx(t,e())},Pb.apply(t,arguments)}),[Kk,Jk]),cw("".concat(qk,"-").concat(Lk),(function e(){var t=Kb(wx()).domain([.1,1,10]);return t.copy=function(){return yx(t,e()).base(t.base())},Pb.apply(t,arguments)}),[Kk,Jk,Lk]),cw("".concat(qk,"-").concat(Pk),_x,[Kk,Jk]),cw("".concat(qk,"-").concat(jk),(function(){return _x.apply(null,arguments).exponent(.5)}),[Kk,Jk]),cw("".concat(qk,"-").concat(Uk),(function e(){var t=ax(wx());return t.copy=function(){return yx(t,e()).constant(t.constant())},Pb.apply(t,arguments)}),[Kk,Jk]),cw(Hk,(function e(){var t,n=[],r=[],a=[];function i(){var e=0,t=Math.max(1,r.length);for(a=new Array(t-1);++e<t;)a[e-1]=Cx(n,e/t);return o}function o(e){return null==e||isNaN(e=+e)?t:r[Ey(a,e)]}return o.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?a[t-1]:n[0],t<a.length?a[t]:n[n.length-1]]},o.domain=function(e){if(!arguments.length)return n.slice();n=[];var t,r=(0,Zt.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;null==a||isNaN(a=+a)||n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n.sort(xy),i()},o.range=function(e){return arguments.length?(r=Array.from(e),i()):r.slice()},o.unknown=function(e){return arguments.length?(t=e,o):t},o.quantiles=function(){return a.slice()},o.copy=function(){return e().domain(n).range(r).unknown(t)},Lb.apply(o,arguments)}),[Qk,Hk]),cw(Xk,(function e(){var t,n=0,r=1,a=1,i=[.5],o=[0,1];function u(e){return null!=e&&e<=e?o[Ey(i,e,0,a)]:t}function s(){var e=-1;for(i=new Array(a);++e<a;)i[e]=((e+1)*r-(e-a)*n)/(a+1);return u}return u.domain=function(e){var t;return arguments.length?(t=(0,ku.Z)(e,2),n=t[0],r=t[1],n=+n,r=+r,s()):[n,r]},u.range=function(e){return arguments.length?(a=(o=Array.from(e)).length-1,s()):o.slice()},u.invertExtent=function(e){var t=o.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,i[0]]:t>=a?[i[a-1],r]:[i[t-1],i[t]]},u.unknown=function(e){return arguments.length?(t=e,u):u},u.thresholds=function(){return i.slice()},u.copy=function(){return e().domain([n,r]).range(o).unknown(t)},Lb.apply(Ub(u),arguments)}),Qk),cw(Yk,(function e(){var t,n=[.5],r=[0,1],a=1;function i(e){return null!=e&&e<=e?r[Ey(n,e,0,a)]:t}return i.domain=function(e){return arguments.length?(n=Array.from(e),a=Math.min(n.length,r.length-1),i):n.slice()},i.range=function(e){return arguments.length?(r=Array.from(e),a=Math.min(n.length,r.length-1),i):r.slice()},i.invertExtent=function(e){var t=r.indexOf(e);return[n[t-1],n[t]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return e().domain(n).range(r).unknown(t)},Lb.apply(i,arguments)}),Qk),cw("bin-ordinal",(function e(){var t=[],n=[];function r(e){return null==e||e!==e?void 0:n[(Ey(t,e)-1)%n.length]}return r.domain=function(e){return arguments.length?(t=aw(e),r):t.slice()},r.range=function(e){return arguments.length?(n=iw.call(e),r):n.slice()},r.tickFormat=function(e,n){return jb(t[0],Md(t),null==e?10:e,n)},r.copy=function(){return e().domain(r.domain()).range(r.range())},r}),[$k,Qk]),cw("ordinal",zx,$k),cw("band",tw,$k),cw("point",(function(){return nw(tw().paddingInner(1))}),$k);function hw(e,t,n){return kx(function(e,t){var n=o[function(e){return"interpolate"+e.toLowerCase().split("-").map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}(t||"rgb",n),e)}function pw(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}function vw(e,t){for(var n in e)mw(n,t(e[n]))}var gw={};function mw(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(gw[e]=t,this):gw[e]}vw({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},pw),vw({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(function(e){return hw(pw(e))}));var yw=function(e){return Fd(e)?e.map((function(e){return String(e)})):String(e)},bw=function(e,t){return e[1]-t[1]},xw=function(e,t){return t[1]-e[1]};function kw(e,t){return e.bins?function(e,t,n){var r=e.range(),a=r[0],i=Md(r),o=bw;if(a>i&&(r=i,i=a,a=r,o=xw),a=Math.floor(a),i=Math.ceil(i),t=t.map((function(t){return[t,e(t)]})).filter((function(e){return a<=e[1]&&e[1]<=i})).sort(o).map((function(e){return e[0]})),n>0&&t.length>1){for(var u=[t[0],Md(t)];t.length>n&&t.length>=3;)t=t.filter((function(e,t){return!(t%2)}));t.length<3&&(t=u)}return t}(e,e.bins):e.ticks?e.ticks(t):e.domain()}function ww(e,t,n,r,a,i){var o=t.type,u=yw;if(o===Wk||a===Wk)u=e.timeFormat(r);else if(o===Vk||a===Vk)u=e.utcFormat(r);else if(function(e){return fw(e,Lk)}(o)){var s=e.formatFloat(r);if(i||t.bins)u=s;else{var c=_w(t,n,!1);u=function(e){return c(e)?s(e):""}}}else if(t.tickFormat){var l=t.domain();u=e.formatSpan(l[0],l[l.length-1],n,r)}else r&&(u=e.format(r));return u}function _w(e,t,n){var r=kw(e,t),a=e.base(),i=Math.log(a),o=Math.max(1,a*t/r.length),u=function(e){var t=e/Math.pow(a,Math.round(Math.log(e)/i));return t*a<a-.5&&(t*=a),t<=o};return n?r.filter(u):u}var Cw=(Mk={},(0,qn.Z)(Mk,Hk,"quantiles"),(0,qn.Z)(Mk,Xk,"thresholds"),(0,qn.Z)(Mk,Yk,"domain"),Mk),Sw=(Ok={},(0,qn.Z)(Ok,Hk,"quantiles"),(0,qn.Z)(Ok,Xk,"domain"),Ok);function Aw(e,t){return e.bins?function(e){var t=e.slice(0,-1);return t.max=Md(e),t}(e.bins):e.type===Lk?_w(e,t,!0):Cw[e.type]?function(e){var t=[-1/0].concat(e);return t.max=1/0,t}(e[Cw[e.type]]()):kw(e,t)}function Ew(e,t,n,r,a,i,o){var u=Sw[t.type]&&i!==Wk&&i!==Vk?function(e,t,n){var r,a=t[Sw[t.type]](),i=a.length,o=i>1?a[1]-a[0]:a[0];for(r=1;r<i;++r)o=Math.min(o,a[r]-a[r-1]);return e.formatSpan(0,o,30,n)}(e,t,a):ww(e,t,n,a,i,o);return"symbol"===r&&function(e){return Cw[e.type]||e.bins}(t)?Tw(u):"discrete"===r?Dw(u):Fw(u)}var Tw=function(e){return function(t,n,r){var a=Nw(r[n+1],Nw(r.max,1/0)),i=Iw(t,e),o=Iw(a,e);return i&&o?i+" \u2013 "+o:o?"< "+o:"\u2265 "+i}},Nw=function(e,t){return null!=e?e:t},Dw=function(e){return function(t,n){return n?e(t):null}},Fw=function(e){return function(t){return e(t)}},Iw=function(e,t){return Number.isFinite(e)?t(e):null};function Mw(e,t,n,r){var a=r||t.type;return jd(n)&&function(e){return fw(e,ew)}(a)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||a!==Wk?n||a!==Vk?Ew(e,t,5,null,n,r,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}function Ow(e,t,n){n=n||{};var r=Math.max(3,n.maxlen||7),a=Mw(e,t,n.format,n.formatType);if(function(e){return fw(e,Qk)}(t.type)){var i=Aw(t).slice(1).map(a),o=i.length;return"".concat(o," boundar").concat(1===o?"y":"ies",": ").concat(i.join(", "))}if(dw(t.type)){var u=t.domain(),s=u.length,c=s>r?u.slice(0,r-2).map(a).join(", ")+", ending with "+u.slice(-1).map(a):u.map(a).join(", ");return"".concat(s," value").concat(1===s?"":"s",": ").concat(c)}var l=t.domain();return"values from ".concat(a(l[0])," to ").concat(a(Md(l)))}var Rw=0;var Zw="p_";function Bw(e){return e&&e.gradient}function zw(e,t,n){var r=e.gradient,a=e.id,i="radial"===r?Zw:"";return a||(a=e.id="gradient_"+Rw++,"radial"===r?(e.x1=Lw(e.x1,.5),e.y1=Lw(e.y1,.5),e.r1=Lw(e.r1,0),e.x2=Lw(e.x2,.5),e.y2=Lw(e.y2,.5),e.r2=Lw(e.r2,.5),i=Zw):(e.x1=Lw(e.x1,0),e.y1=Lw(e.y1,0),e.x2=Lw(e.x2,1),e.y2=Lw(e.y2,0))),t[a]=e,"url("+(n||"")+"#"+i+a+")"}function Lw(e,t){return null!=e?e:t}var Pw={basis:{curve:function(e){return new Gd(e)}},"basis-closed":{curve:function(e){return new Hd(e)}},"basis-open":{curve:function(e){return new Xd(e)}},bundle:{curve:Kd,tension:"beta",value:.85},cardinal:{curve:Jd,tension:"tension",value:0},"cardinal-open":{curve:th,tension:"tension",value:0},"cardinal-closed":{curve:rh,tension:"tension",value:0},"catmull-rom":{curve:bh,tension:"alpha",value:.5},"catmull-rom-closed":{curve:kh,tension:"alpha",value:.5},"catmull-rom-open":{curve:_h,tension:"alpha",value:.5},linear:{curve:Sh},"linear-closed":{curve:function(e){return new Ah(e)}},monotone:{horizontal:function(e){return new Ih(e)},vertical:function(e){return new Fh(e)}},natural:{curve:function(e){return new Oh(e)}},step:{curve:function(e){return new Zh(e,.5)}},"step-after":{curve:function(e){return new Zh(e,1)}},"step-before":{curve:function(e){return new Zh(e,0)}}};function jw(e,t,n){var r=Ld(Pw,e)&&Pw[e],a=null;return r&&(a=r.curve||r[t||"vertical"],r.tension&&null!=n&&(a=a[r.tension](n))),a}var Uw={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},Ww=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,Vw=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,Gw=/^((\s+,?\s*)|(,\s*))/,qw=/^[01]/;function Hw(e){var t=[];return(e.match(Ww)||[]).forEach((function(e){var n=e[0],r=n.toLowerCase(),a=Uw[r],i=function(e,t,n){for(var r=[],a=0;t&&a<n.length;)for(var i=0;i<t;++i){var o="a"!==e||3!==i&&4!==i?Vw:qw,u=n.slice(a).match(o);if(null===u)throw Error("Invalid SVG path, incorrect parameter type");a+=u[0].length,r.push(+u[0]);var s=n.slice(a).match(Gw);null!==s&&(a+=s[0].length)}return r}(r,a,e.slice(1).trim()),o=i.length;if(o<a||o&&o%a!==0)throw Error("Invalid SVG path, incorrect parameter count");if(t.push([n].concat((0,ln.Z)(i.slice(0,a)))),o!==a){"m"===r&&(n="M"===n?"L":"l");for(var u=a;u<o;u+=a)t.push([n].concat((0,ln.Z)(i.slice(u,u+a))))}})),t}var Xw=Math.PI/180,Yw=Math.PI/2,Kw=2*Math.PI,$w=Math.sqrt(3)/2,Qw={},Jw={},e_=[].join;function t_(e){var t=e_.call(e);if(Jw[t])return Jw[t];var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],s=e[6],c=e[7],l=c*o,f=-s*u,d=s*o,h=c*u,p=Math.cos(a),v=Math.sin(a),g=Math.cos(i),m=Math.sin(i),y=.5*(i-a),b=Math.sin(.5*y),x=8/3*b*b/Math.sin(y),k=n+p-x*v,w=r+v+x*p,_=n+g,C=r+m,S=_+x*m,A=C-x*g;return Jw[t]=[l*k+f*w,d*k+h*w,l*S+f*A,d*S+h*A,l*_+f*C,d*_+h*C]}var n_=["l",0,0,0,0,0,0,0];function r_(e,t,n){var r=n_[0]=e[0];if("a"===r||"A"===r)n_[1]=t*e[1],n_[2]=n*e[2],n_[3]=e[3],n_[4]=e[4],n_[5]=e[5],n_[6]=t*e[6],n_[7]=n*e[7];else if("h"===r||"H"===r)n_[1]=t*e[1];else if("v"===r||"V"===r)n_[1]=n*e[1];else for(var a=1,i=e.length;a<i;++a)n_[a]=(a%2==1?t:n)*e[a];return n_}function a_(e,t,n,r,a,i){var o,u,s,c,l,f=null,d=0,h=0,p=0,v=0,g=0,m=0;null==n&&(n=0),null==r&&(r=0),null==a&&(a=1),null==i&&(i=a),e.beginPath&&e.beginPath();for(var y=0,b=t.length;y<b;++y){switch(o=t[y],1===a&&1===i||(o=r_(o,a,i)),o[0]){case"l":d+=o[1],h+=o[2],e.lineTo(d+n,h+r);break;case"L":d=o[1],h=o[2],e.lineTo(d+n,h+r);break;case"h":d+=o[1],e.lineTo(d+n,h+r);break;case"H":d=o[1],e.lineTo(d+n,h+r);break;case"v":h+=o[1],e.lineTo(d+n,h+r);break;case"V":h=o[1],e.lineTo(d+n,h+r);break;case"m":g=d+=o[1],m=h+=o[2],e.moveTo(d+n,h+r);break;case"M":g=d=o[1],m=h=o[2],e.moveTo(d+n,h+r);break;case"c":u=d+o[5],s=h+o[6],p=d+o[3],v=h+o[4],e.bezierCurveTo(d+o[1]+n,h+o[2]+r,p+n,v+r,u+n,s+r),d=u,h=s;break;case"C":d=o[5],h=o[6],p=o[3],v=o[4],e.bezierCurveTo(o[1]+n,o[2]+r,p+n,v+r,d+n,h+r);break;case"s":u=d+o[3],s=h+o[4],p=2*d-p,v=2*h-v,e.bezierCurveTo(p+n,v+r,d+o[1]+n,h+o[2]+r,u+n,s+r),p=d+o[1],v=h+o[2],d=u,h=s;break;case"S":u=o[3],s=o[4],p=2*d-p,v=2*h-v,e.bezierCurveTo(p+n,v+r,o[1]+n,o[2]+r,u+n,s+r),d=u,h=s,p=o[1],v=o[2];break;case"q":u=d+o[3],s=h+o[4],p=d+o[1],v=h+o[2],e.quadraticCurveTo(p+n,v+r,u+n,s+r),d=u,h=s;break;case"Q":u=o[3],s=o[4],e.quadraticCurveTo(o[1]+n,o[2]+r,u+n,s+r),d=u,h=s,p=o[1],v=o[2];break;case"t":u=d+o[1],s=h+o[2],null===f[0].match(/[QqTt]/)?(p=d,v=h):"t"===f[0]?(p=2*d-c,v=2*h-l):"q"===f[0]&&(p=2*d-p,v=2*h-v),c=p,l=v,e.quadraticCurveTo(p+n,v+r,u+n,s+r),h=s,p=(d=u)+o[1],v=h+o[2];break;case"T":u=o[1],s=o[2],p=2*d-p,v=2*h-v,e.quadraticCurveTo(p+n,v+r,u+n,s+r),d=u,h=s;break;case"a":i_(e,d+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+d+n,o[7]+h+r]),d+=o[6],h+=o[7];break;case"A":i_(e,d+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),d=o[6],h=o[7];break;case"z":case"Z":d=g,h=m,e.closePath()}f=o}}function i_(e,t,n,r){for(var a=function(e,t,n,r,a,i,o,u,s){var c=e_.call(arguments);if(Qw[c])return Qw[c];var l=o*Xw,f=Math.sin(l),d=Math.cos(l),h=d*(u-e)*.5+f*(s-t)*.5,p=d*(s-t)*.5-f*(u-e)*.5,v=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);v>1&&(n*=v=Math.sqrt(v),r*=v);var g=d/n,m=f/n,y=-f/r,b=d/r,x=g*u+m*s,k=y*u+b*s,w=g*e+m*t,_=y*e+b*t,C=(w-x)*(w-x)+(_-k)*(_-k),S=1/C-.25;S<0&&(S=0);var A=Math.sqrt(S);i==a&&(A=-A);var E=.5*(x+w)-A*(_-k),T=.5*(k+_)+A*(w-x),N=Math.atan2(k-T,x-E),D=Math.atan2(_-T,w-E),F=D-N;F<0&&1===i?F+=Kw:F>0&&0===i&&(F-=Kw);for(var I=Math.ceil(Math.abs(F/(Yw+.001))),M=[],O=0;O<I;++O){var R=N+O*F/I,Z=N+(O+1)*F/I;M[O]=[E,T,R,Z,n,r,f,d]}return Qw[c]=M}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n),i=0;i<a.length;++i){var o=t_(a[i]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var o_=.5773502691896257,u_={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,Kw)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,a=n/2.5,i=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-i),e.lineTo(a,-i),e.lineTo(0,-n),e.lineTo(-a,-i),e.lineTo(-r,-i),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=$w*n,a=r-n*o_,i=n/4;e.moveTo(0,-r-a),e.lineTo(-i,r-a),e.lineTo(i,r-a),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=$w*n,a=r-n*o_;e.moveTo(0,-r-a),e.lineTo(-n,r-a),e.lineTo(n,r-a),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=$w*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=$w*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=$w*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=$w*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function s_(e){return Ld(u_,e)?u_[e]:function(e){if(!Ld(c_,e)){var t=Hw(e);c_[e]={draw:function(e,n){a_(e,t,0,0,Math.sqrt(n)/2)}}}return c_[e]}(e)}var c_={};var l_=.448084975506;function f_(e){return e.x}function d_(e){return e.y}function h_(e){return e.width}function p_(e){return e.height}function v_(e){return"function"===typeof e?e:function(){return+e}}function g_(e,t,n){return Math.max(t,Math.min(e,n))}function m_(e,t){return null!=e?e:t}var y_=function(e){return e.x||0},b_=function(e){return e.y||0},x_=function(e){return!(!1===e.defined)},k_=function(){var e=cp,t=lp,n=Bh(0),r=null,a=fp,i=dp,o=hp,u=null,s=sp(c);function c(){var c,l,f=+e.apply(this,arguments),d=+t.apply(this,arguments),h=a.apply(this,arguments)-hh,p=i.apply(this,arguments)-hh,v=ah(p-h),g=p>h;if(u||(u=c=s()),d<f&&(l=d,d=f,f=l),d>fh)if(v>ph-fh)u.moveTo(d*oh(h),d*ch(h)),u.arc(0,0,d,h,p,!g),f>fh&&(u.moveTo(f*oh(p),f*ch(p)),u.arc(0,0,f,p,h,g));else{var m,y,b=h,x=p,k=h,w=p,_=v,C=v,S=o.apply(this,arguments)/2,A=S>fh&&(r?+r.apply(this,arguments):lh(f*f+d*d)),E=sh(ah(d-f)/2,+n.apply(this,arguments)),T=E,N=E;if(A>fh){var D=gh(A/f*ch(S)),F=gh(A/d*ch(S));(_-=2*D)>fh?(k+=D*=g?1:-1,w-=D):(_=0,k=w=(h+p)/2),(C-=2*F)>fh?(b+=F*=g?1:-1,x-=F):(C=0,b=x=(h+p)/2)}var I=d*oh(b),M=d*ch(b),O=f*oh(w),R=f*ch(w);if(E>fh){var Z,B=d*oh(x),z=d*ch(x),L=f*oh(k),P=f*ch(k);if(v<dh)if(Z=pp(I,M,L,P,B,z,O,R)){var j=I-Z[0],U=M-Z[1],W=B-Z[0],V=z-Z[1],G=1/ch(vh((j*W+U*V)/(lh(j*j+U*U)*lh(W*W+V*V)))/2),q=lh(Z[0]*Z[0]+Z[1]*Z[1]);T=sh(E,(f-q)/(G-1)),N=sh(E,(d-q)/(G+1))}else T=N=0}C>fh?N>fh?(m=vp(L,P,I,M,d,N,g),y=vp(B,z,O,R,d,N,g),u.moveTo(m.cx+m.x01,m.cy+m.y01),N<E?u.arc(m.cx,m.cy,N,ih(m.y01,m.x01),ih(y.y01,y.x01),!g):(u.arc(m.cx,m.cy,N,ih(m.y01,m.x01),ih(m.y11,m.x11),!g),u.arc(0,0,d,ih(m.cy+m.y11,m.cx+m.x11),ih(y.cy+y.y11,y.cx+y.x11),!g),u.arc(y.cx,y.cy,N,ih(y.y11,y.x11),ih(y.y01,y.x01),!g))):(u.moveTo(I,M),u.arc(0,0,d,b,x,!g)):u.moveTo(I,M),f>fh&&_>fh?T>fh?(m=vp(O,R,B,z,f,-T,g),y=vp(I,M,L,P,f,-T,g),u.lineTo(m.cx+m.x01,m.cy+m.y01),T<E?u.arc(m.cx,m.cy,T,ih(m.y01,m.x01),ih(y.y01,y.x01),!g):(u.arc(m.cx,m.cy,T,ih(m.y01,m.x01),ih(m.y11,m.x11),!g),u.arc(0,0,f,ih(m.cy+m.y11,m.cx+m.x11),ih(y.cy+y.y11,y.cx+y.x11),g),u.arc(y.cx,y.cy,T,ih(y.y11,y.x11),ih(y.y01,y.x01),!g))):u.arc(0,0,f,w,k,g):u.lineTo(O,R)}else u.moveTo(0,0);if(u.closePath(),c)return u=null,c+""||null}return c.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+a.apply(this,arguments)+ +i.apply(this,arguments))/2-dh/2;return[oh(r)*n,ch(r)*n]},c.innerRadius=function(t){return arguments.length?(e="function"===typeof t?t:Bh(+t),c):e},c.outerRadius=function(e){return arguments.length?(t="function"===typeof e?e:Bh(+e),c):t},c.cornerRadius=function(e){return arguments.length?(n="function"===typeof e?e:Bh(+e),c):n},c.padRadius=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:Bh(+e),c):r},c.startAngle=function(e){return arguments.length?(a="function"===typeof e?e:Bh(+e),c):a},c.endAngle=function(e){return arguments.length?(i="function"===typeof e?e:Bh(+e),c):i},c.padAngle=function(e){return arguments.length?(o="function"===typeof e?e:Bh(+e),c):o},c.context=function(e){return arguments.length?(u=null==e?null:e,c):u},c}().startAngle((function(e){return e.startAngle||0})).endAngle((function(e){return e.endAngle||0})).padAngle((function(e){return e.padAngle||0})).innerRadius((function(e){return e.innerRadius||0})).outerRadius((function(e){return e.outerRadius||0})).cornerRadius((function(e){return e.cornerRadius||0})),w_=xp().x(y_).y1(b_).y0((function(e){return(e.y||0)+(e.height||0)})).defined(x_),__=xp().y(b_).x1(y_).x0((function(e){return(e.x||0)+(e.width||0)})).defined(x_),C_=bp().x(y_).y(b_).defined(x_),S_=function(){var e=f_,t=d_,n=h_,r=p_,a=v_(0),i=a,o=a,u=a,s=null;function c(c,l,f){var d,h=null!=l?l:+e.call(this,c),p=null!=f?f:+t.call(this,c),v=+n.call(this,c),g=+r.call(this,c),m=Math.min(v,g)/2,y=g_(+a.call(this,c),0,m),b=g_(+i.call(this,c),0,m),x=g_(+o.call(this,c),0,m),k=g_(+u.call(this,c),0,m);if(s||(s=d=up()),y<=0&&b<=0&&x<=0&&k<=0)s.rect(h,p,v,g);else{var w=h+v,_=p+g;s.moveTo(h+y,p),s.lineTo(w-b,p),s.bezierCurveTo(w-l_*b,p,w,p+l_*b,w,p+b),s.lineTo(w,_-k),s.bezierCurveTo(w,_-l_*k,w-l_*k,_,w-k,_),s.lineTo(h+x,_),s.bezierCurveTo(h+l_*x,_,h,_-l_*x,h,_-x),s.lineTo(h,p+y),s.bezierCurveTo(h,p+l_*y,h+l_*y,p,h+y,p),s.closePath()}if(d)return s=null,d+""||null}return c.x=function(t){return arguments.length?(e=v_(t),c):e},c.y=function(e){return arguments.length?(t=v_(e),c):t},c.width=function(e){return arguments.length?(n=v_(e),c):n},c.height=function(e){return arguments.length?(r=v_(e),c):r},c.cornerRadius=function(e,t,n,r){return arguments.length?(a=v_(e),i=null!=t?v_(t):a,u=null!=n?v_(n):a,o=null!=r?v_(r):i,c):a},c.context=function(e){return arguments.length?(s=null==e?null:e,c):s},c}().x(y_).y(b_).width((function(e){return e.width||0})).height((function(e){return e.height||0})).cornerRadius((function(e){return m_(e.cornerRadiusTopLeft,e.cornerRadius)||0}),(function(e){return m_(e.cornerRadiusTopRight,e.cornerRadius)||0}),(function(e){return m_(e.cornerRadiusBottomRight,e.cornerRadius)||0}),(function(e){return m_(e.cornerRadiusBottomLeft,e.cornerRadius)||0})),A_=function(e,t){var n=null,r=sp(a);function a(){var a;if(n||(n=a=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),a)return n=null,a+""||null}return e="function"===typeof e?e:Bh(e||kp),t="function"===typeof t?t:Bh(void 0===t?64:+t),a.type=function(t){return arguments.length?(e="function"===typeof t?t:Bh(t),a):e},a.size=function(e){return arguments.length?(t="function"===typeof e?e:Bh(+e),a):t},a.context=function(e){return arguments.length?(n=null==e?null:e,a):n},a}().type((function(e){return s_(e.shape||"circle")})).size((function(e){return m_(e.size,64)})),E_=function(){var e,t,n,r,a,i,o,u,s=null;function c(e,t,n){var r=n/2;if(a){var c=o-t,l=e-i;if(c||l){var f=Math.sqrt(c*c+l*l),d=(c/=f)*u,h=(l/=f)*u,p=Math.atan2(l,c);s.moveTo(i-d,o-h),s.lineTo(e-c*r,t-l*r),s.arc(e,t,r,p-Math.PI,p),s.lineTo(i+d,o+h),s.arc(i,o,u,p,p+Math.PI)}else s.arc(e,t,r,0,Kw);s.closePath()}else a=1;i=e,o=t,u=r}function l(i){var o,u,l,f=i.length,d=!1;for(null==s&&(s=l=up()),o=0;o<=f;++o)!(o<f&&r(u=i[o],o,i))===d&&(d=!d)&&(a=0),d&&c(+e(u,o,i),+t(u,o,i),+n(u,o,i));if(l)return s=null,l+""||null}return l.x=function(t){return arguments.length?(e=t,l):e},l.y=function(e){return arguments.length?(t=e,l):t},l.size=function(e){return arguments.length?(n=e,l):n},l.defined=function(e){return arguments.length?(r=e,l):r},l.context=function(e){return arguments.length?(s=null==e?null:e,l):s},l}().x(y_).y(b_).defined(x_).size((function(e){return e.size||1}));function T_(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function N_(e,t,n,r){return S_.context(e)(t,n,r)}var D_=1;function F_(e,t,n){var r=t.clip,a=e._defs,i=t.clip_id||(t.clip_id="clip"+D_++),o=a.clipping[i]||(a.clipping[i]={id:i});return Zd(r)?o.path=r(null):T_(n)?o.path=N_(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+i+")"}function I_(e){this.clear(),e&&this.union(e)}function M_(e){this.mark=e,this.bounds=this.bounds||new I_}function O_(e){M_.call(this,e),this.items=this.items||[]}function R_(e){this._pending=0,this._loader=e||by()}function Z_(e){e._pending+=1}function B_(e){e._pending-=1}function z_(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){var r=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(r+(n?function(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,r):0))}return e}I_.prototype={clone:function(){return new I_(this)},clear:function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty:function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals:function(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set:function(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add:function(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand:function(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round:function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale:function(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate:function(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate:function(e,t,n){var r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints:function(e,t,n){var r=this.x1,a=this.y1,i=this.x2,o=this.y2,u=Math.cos(e),s=Math.sin(e),c=t-t*u+n*s,l=n-t*s-n*u;return[u*r-s*a+c,s*r+u*a+l,u*r-s*o+c,s*r+u*o+l,u*i-s*a+c,s*i+u*a+l,u*i-s*o+c,s*i+u*o+l]},union:function(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect:function(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses:function(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith:function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects:function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains:function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width:function(){return this.x2-this.x1},height:function(){return this.y2-this.y1}},Pd(O_,M_),R_.prototype={pending:function(){return this._pending},sanitizeURL:function(e){var t=this;return Z_(t),t._loader.sanitize(e,{context:"href"}).then((function(e){return B_(t),e})).catch((function(){return B_(t),null}))},loadImage:function(e){var t=this,n=Cp();return Z_(t),t._loader.sanitize(e,{context:"image"}).then((function(e){var r=e.href;if(!r||!n)throw{url:r};var a=new n,i=Ld(e,"crossOrigin")?e.crossOrigin:"anonymous";return null!=i&&(a.crossOrigin=i),a.onload=function(){return B_(t)},a.onerror=function(){return B_(t)},a.src=r,a})).catch((function(e){return B_(t),{complete:!1,width:0,height:0,src:e&&e.url||""}}))},ready:function(){var e=this;return new Promise((function(t){!function n(r){e.pending()?setTimeout((function(){n(!0)}),10):t(r)}(!1)}))}};var L_,P_,j_,U_,W_,V_,G_,q_,H_=Kw-1e-8,X_=function(e,t){return L_.add(e,t)},Y_=function(e,t){return X_(P_=e,j_=t)},K_=function(e){return X_(e,L_.y1)},$_=function(e){return X_(L_.x1,e)},Q_=function(e,t){return W_*e+G_*t},J_=function(e,t){return V_*e+q_*t},eC=function(e,t){return X_(Q_(e,t),J_(e,t))},tC=function(e,t){return Y_(Q_(e,t),J_(e,t))};function nC(e,t){return L_=e,t?(U_=t*Xw,W_=q_=Math.cos(U_),V_=Math.sin(U_),G_=-V_):(W_=q_=1,U_=V_=G_=0),rC}var rC={beginPath:function(){},closePath:function(){},moveTo:tC,lineTo:tC,rect:function(e,t,n,r){U_?(eC(e+n,t),eC(e+n,t+r),eC(e,t+r),tC(e,t)):(X_(e+n,t+r),Y_(e,t))},quadraticCurveTo:function(e,t,n,r){var a=Q_(e,t),i=J_(e,t),o=Q_(n,r),u=J_(n,r);aC(P_,a,o,K_),aC(j_,i,u,$_),Y_(o,u)},bezierCurveTo:function(e,t,n,r,a,i){var o=Q_(e,t),u=J_(e,t),s=Q_(n,r),c=J_(n,r),l=Q_(a,i),f=J_(a,i);iC(P_,o,s,l,K_),iC(j_,u,c,f,$_),Y_(l,f)},arc:function(e,t,n,r,a,i){if(r+=U_,a+=U_,P_=n*Math.cos(a)+e,j_=n*Math.sin(a)+t,Math.abs(a-r)>H_)X_(e-n,t-n),X_(e+n,t+n);else{var o,u,s=function(r){return X_(n*Math.cos(r)+e,n*Math.sin(r)+t)};if(s(r),s(a),a!==r)if((r%=Kw)<0&&(r+=Kw),(a%=Kw)<0&&(a+=Kw),a<r&&(i=!i,o=r,r=a,a=o),i)for(a-=Kw,o=r-r%Yw,u=0;u<4&&o>a;++u,o-=Yw)s(o);else for(o=r-r%Yw+Yw,u=0;u<4&&o<a;++u,o+=Yw)s(o)}}};function aC(e,t,n,r){var a=(e-t)/(e+n-2*t);0<a&&a<1&&r(e+(t-e)*a)}function iC(e,t,n,r,a){var i,o=r-e+3*t-3*n,u=e+n-2*t,s=e-t,c=0,l=0;Math.abs(o)>1e-14?(i=u*u+s*o)>=0&&(c=(-u+(i=Math.sqrt(i)))/o,l=(-u-i)/o):c=.5*s/u,0<c&&c<1&&a(oC(c,e,t,n,r)),0<l&&l<1&&a(oC(l,e,t,n,r))}function oC(e,t,n,r,a){var i=1-e,o=i*i,u=e*e;return o*i*t+3*o*e*n+3*i*u*r+u*e*a}var uC=(uC=_p(1,1))?uC.getContext("2d"):null,sC=new I_;function cC(e){return function(t,n){if(!uC)return!0;e(uC,t),sC.clear().union(t.bounds).intersect(n).round();for(var r=sC.x1,a=sC.y1,i=sC.x2,o=sC.y2,u=a;u<=o;++u)for(var s=r;s<=i;++s)if(uC.isPointInPath(s,u))return!0;return!1}}function lC(e,t){return t.contains(e.x||0,e.y||0)}function fC(e,t){var n=e.x||0,r=e.y||0,a=e.width||0,i=e.height||0;return t.intersects(sC.set(n,r,n+a,r+i))}function dC(e,t,n,r,a){var i,o,u,s,c=e.x1,l=e.y1,f=e.x2,d=e.y2,h=r-t,p=a-n,v=0,g=1;for(s=0;s<4;++s){if(0===s&&(i=-h,o=-(c-t)),1===s&&(i=h,o=f-t),2===s&&(i=-p,o=-(l-n)),3===s&&(i=p,o=d-n),Math.abs(i)<1e-10&&o<0)return!1;if(u=o/i,i<0){if(u>g)return!1;u>v&&(v=u)}else if(i>0){if(u<v)return!1;u<g&&(g=u)}}return!0}function hC(e,t){e.globalCompositeOperation=t.blend||"source-over"}function pC(e,t){return null==e?t:e}function vC(e,t){for(var n=t.length,r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function gC(e,t,n){return Bw(n)?function(e,t,n){var r,a=n.width(),i=n.height();if("radial"===t.gradient)r=e.createRadialGradient(n.x1+pC(t.x1,.5)*a,n.y1+pC(t.y1,.5)*i,Math.max(a,i)*pC(t.r1,0),n.x1+pC(t.x2,.5)*a,n.y1+pC(t.y2,.5)*i,Math.max(a,i)*pC(t.r2,.5));else{var o=pC(t.x1,0),u=pC(t.y1,0),s=pC(t.x2,1),c=pC(t.y2,0);if(o!==s&&u!==c&&a!==i){var l=_p(Math.ceil(a),Math.ceil(i)),f=l.getContext("2d");return f.scale(a,i),f.fillStyle=vC(f.createLinearGradient(o,u,s,c),t.stops),f.fillRect(0,0,a,i),e.createPattern(l,"no-repeat")}r=e.createLinearGradient(n.x1+o*a,n.y1+u*i,n.x1+s*a,n.y1+c*i)}return vC(r,t.stops)}(e,n,t.bounds):n}function mC(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=gC(e,t,t.fill),!0)}var yC=[];function bC(e,t,n){var r=null!=(r=t.strokeWidth)?r:1;return!(r<=0)&&((n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=gC(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||yC),e.lineDashOffset=t.strokeDashOffset||0),!0))}function xC(e,t){return e.zindex-t.zindex||e.index-t.index}function kC(e){if(!e.zdirty)return e.zitems;var t,n,r,a=e.items,i=[];for(n=0,r=a.length;n<r;++n)(t=a[n]).index=n,t.zindex&&i.push(t);return e.zdirty=!1,e.zitems=i.sort(xC)}function wC(e,t){var n,r,a=e.items;if(a&&a.length){var i=kC(e);if(i&&i.length){for(n=0,r=a.length;n<r;++n)a[n].zindex||t(a[n]);a=i}for(n=0,r=a.length;n<r;++n)t(a[n])}}function _C(e,t){var n,r,a=e.items;if(!a||!a.length)return null;var i=kC(e);for(i&&i.length&&(a=i),r=a.length;--r>=0;)if(n=t(a[r]))return n;if(a===i)for(r=(a=e.items).length;--r>=0;)if(!a[r].zindex&&(n=t(a[r])))return n;return null}function CC(e){return function(t,n,r){wC(n,(function(n){r&&!r.intersects(n.bounds)||AC(e,t,n,n)}))}}function SC(e){return function(t,n,r){!n.items.length||r&&!r.intersects(n.bounds)||AC(e,t,n.items[0],n.items)}}function AC(e,t,n,r){var a=null==n.opacity?1:n.opacity;0!==a&&(e(t,r)||(hC(t,n),n.fill&&mC(t,n,a)&&t.fill(),n.stroke&&bC(t,n,a)&&t.stroke()))}function EC(e){return e=e||Dd,function(t,n,r,a,i,o){return r*=t.pixelRatio,a*=t.pixelRatio,_C(n,(function(n){var u=n.bounds;if((!u||u.contains(i,o))&&u)return e(t,n,r,a,i,o)?n:void 0}))}}function TC(e,t){return function(n,r,a,i){var o,u,s=Array.isArray(r)?r[0]:r,c=null==t?s.fill:t,l=s.stroke&&n.isPointInStroke;return l&&(o=s.strokeWidth,u=s.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=u?u:"butt"),!e(n,r)&&(c&&n.isPointInPath(a,i)||l&&n.isPointInStroke(a,i))}}function NC(e){return EC(TC(e))}function DC(e,t){return"translate("+e+","+t+")"}function FC(e){return"rotate("+e+")"}function IC(e){return DC(e.x||0,e.y||0)}function MC(e,t,n){function r(e,n){var r=n.x||0,a=n.y||0,i=n.angle||0;e.translate(r,a),i&&e.rotate(i*=Xw),e.beginPath(),t(e,n),i&&e.rotate(-i),e.translate(-r,-a)}return{type:e,tag:"path",nested:!1,attr:function(e,n){e("transform",function(e){return DC(e.x||0,e.y||0)+(e.angle?" "+FC(e.angle):"")}(n)),e("d",t(null,n))},bound:function(e,n){return t(nC(e,n.angle),n),z_(e,n).translate(n.x||0,n.y||0)},draw:CC(r),pick:NC(r),isect:n||cC(r)}}var OC=MC("arc",(function(e,t){return k_.context(e)(t)}));function RC(e,t,n){function r(e,n){e.beginPath(),t(e,n)}var a=TC(r);return{type:e,tag:"path",nested:!0,attr:function(e,n){var r=n.mark.items;r.length&&e("d",t(null,r))},bound:function(e,n){var r=n.items;return 0===r.length?e:(t(nC(e),r),z_(e,r[0]))},draw:SC(r),pick:function(e,t,n,r,i,o){var u=t.items,s=t.bounds;return!u||!u.length||s&&!s.contains(i,o)?null:(n*=e.pixelRatio,r*=e.pixelRatio,a(e,u,n,r)?u[0]:null)},isect:lC,tip:n}}var ZC=RC("area",(function(e,t){var n=t[0],r=n.interpolate||"linear";return("horizontal"===n.orient?__:w_).curve(jw(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,a="horizontal"===e[0].orient?t[1]:t[0],i="horizontal"===e[0].orient?"y":"x",o=e.length,u=1/0;--o>=0;)!1!==e[o].defined&&(r=Math.abs(e[o][i]-a))<u&&(u=r,n=e[o]);return n}));function BC(e,t){e.beginPath(),T_(t)?N_(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function zC(e){var t=pC(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function LC(e,t){var n=zC(t);e("d",N_(null,t,n,n))}function PC(e,t,n,r){var a=zC(t);e.beginPath(),N_(e,t,(n||0)+a,(r||0)+a)}var jC=TC(PC),UC=TC(PC,!1),WC=TC(PC,!0);var VC={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",IC(t))},bound:function(e,t){if(!t.clip&&t.items)for(var n=t.items,r=n.length,a=0;a<r;++a)e.union(n[a].bounds);return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),z_(e,t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n){var r=this;wC(t,(function(t){var a=t.x||0,i=t.y||0,o=t.strokeForeground,u=null==t.opacity?1:t.opacity;(t.stroke||t.fill)&&u&&(PC(e,t,a,i),hC(e,t),t.fill&&mC(e,t,u)&&e.fill(),t.stroke&&!o&&bC(e,t,u)&&e.stroke()),e.save(),e.translate(a,i),t.clip&&BC(e,t),n&&n.translate(-a,-i),wC(t,(function(t){r.draw(e,t,n)})),n&&n.translate(a,i),e.restore(),o&&t.stroke&&u&&(PC(e,t,a,i),hC(e,t),bC(e,t,u)&&e.stroke())}))},pick:function(e,t,n,r,a,i){var o=this;if(t.bounds&&!t.bounds.contains(a,i)||!t.items)return null;var u=n*e.pixelRatio,s=r*e.pixelRatio;return _C(t,(function(c){var l,f,d,h=c.bounds;if(!h||h.contains(a,i)){f=c.x||0,d=c.y||0;var p=f+(c.width||0),v=d+(c.height||0),g=c.clip;if(!g||!(a<f||a>p||i<d||i>v)){if(e.save(),e.translate(f,d),f=a-f,d=i-d,g&&T_(c)&&!WC(e,c,u,s))return e.restore(),null;var m=c.strokeForeground,y=!1!==t.interactive;return y&&m&&c.stroke&&UC(e,c,u,s)?(e.restore(),c):(!(l=_C(c,(function(e){return function(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(e,f,d)?o.pick(e,n,r,f,d):null})))&&y&&(c.fill||!m&&c.stroke)&&jC(e,c,u,s)&&(l=c),e.restore(),l||null)}}}))},isect:fC,content:function(e,t,n){e("clip-path",t.clip?F_(n,t,t):null)},background:function(e,t){e("class","background"),e("aria-hidden",!0),LC(e,t)},foreground:function(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?LC(e,t):e("d","")}},GC={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function qC(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then((function(t){e.image=t,e.image.url=e.url}))),n}function HC(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function XC(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function YC(e,t){return"center"===e?t/2:"right"===e?t:0}function KC(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var $C={type:"image",tag:"image",nested:!1,attr:function(e,t,n){var r=qC(t,n),a=HC(t,r),i=XC(t,r),o=(t.x||0)-YC(t.align,a),u=(t.y||0)-KC(t.baseline,i);e("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",GC["xmlns:xlink"],"xlink:href"),e("transform",DC(o,u)),e("width",a),e("height",i),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function(e,t){var n=t.image,r=HC(t,n),a=XC(t,n),i=(t.x||0)-YC(t.align,r),o=(t.y||0)-KC(t.baseline,a);return e.set(i,o,i+r,o+a)},draw:function(e,t,n){var r=this;wC(t,(function(t){if(!n||n.intersects(t.bounds)){var a=qC(t,r),i=HC(t,a),o=XC(t,a);if(0!==i&&0!==o){var u,s,c,l,f=(t.x||0)-YC(t.align,i),d=(t.y||0)-KC(t.baseline,o);!1!==t.aspect&&(s=a.width/a.height,c=t.width/t.height,s===s&&c===c&&s!==c&&(c<s?(d+=(o-(l=i/s))/2,o=l):(f+=(i-(l=o*s))/2,i=l))),(a.complete||a.toDataURL)&&(hC(e,t),e.globalAlpha=null!=(u=t.opacity)?u:1,e.imageSmoothingEnabled=!1!==t.smooth,e.drawImage(a,f,d,i,o))}}}))},pick:EC(),isect:Dd,get:qC,xOffset:YC,yOffset:KC},QC=RC("line",(function(e,t){var n=t[0],r=n.interpolate||"linear";return C_.curve(jw(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,a=Math.pow(e[0].strokeWidth||1,2),i=e.length;--i>=0;)if(!1!==e[i].defined&&(n=e[i].x-t[0])*n+(r=e[i].y-t[1])*r<a)return e[i];return null}));function JC(e,t){var n=t.path;if(null==n)return!0;var r=t.x||0,a=t.y||0,i=t.scaleX||1,o=t.scaleY||1,u=(t.angle||0)*Xw,s=t.pathCache;s&&s.path===n||((t.pathCache=s=Hw(n)).path=n),u&&e.rotate&&e.translate?(e.translate(r,a),e.rotate(u),a_(e,s,0,0,i,o),e.rotate(-u),e.translate(-r,-a)):a_(e,s,r,a,i,o)}var eS={type:"path",tag:"path",nested:!1,attr:function(e,t){var n=t.scaleX||1,r=t.scaleY||1;1===n&&1===r||e("vector-effect","non-scaling-stroke"),e("transform",function(e){return DC(e.x||0,e.y||0)+(e.angle?" "+FC(e.angle):"")+(e.scaleX||e.scaleY?" "+function(e,t){return"scale("+e+","+t+")"}(e.scaleX||1,e.scaleY||1):"")}(t)),e("d",t.path)},bound:function(e,t){return JC(nC(e,t.angle),t)?e.set(0,0,0,0):z_(e,t,!0)},draw:CC(JC),pick:NC(JC),isect:cC(JC)};function tS(e,t){e.beginPath(),N_(e,t)}var nS={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",N_(null,t))},bound:function(e,t){var n,r;return z_(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)},draw:CC(tS),pick:NC(tS),isect:fC};function rS(e,t,n){var r,a,i,o;return!(!t.stroke||!bC(e,t,n))&&(r=t.x||0,a=t.y||0,i=null!=t.x2?t.x2:r,o=null!=t.y2?t.y2:a,e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),!0)}var aS={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",IC(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var n,r;return z_(e.set(n=t.x||0,r=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r),t)},draw:function(e,t,n){wC(t,(function(t){if(!n||n.intersects(t.bounds)){var r=null==t.opacity?1:t.opacity;r&&rS(e,t,r)&&(hC(e,t),e.stroke())}}))},pick:EC((function(e,t,n,r){return!!e.isPointInStroke&&(rS(e,t,1)&&e.isPointInStroke(n,r))})),isect:function(e,t){var n=e.x||0,r=e.y||0;return dC(t,n,r,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r)}},iS=MC("shape",(function(e,t){return(t.mark.shape||t.shape).context(e)(t)})),oS=MC("symbol",(function(e,t){return A_.context(e)(t)}),lC),uS=function(e){var t,n,r;e=+e||1e4;var a=function(){t={},n={},r=0},i=function(a,i){return++r>e&&(n=t,t={},r=1),t[a]=i};return a(),{clear:a,has:function(e){return Ld(t,e)||Ld(n,e)},get:function(e){return Ld(t,e)?t[e]:Ld(n,e)?i(e,n[e]):void 0},set:function(e,n){return Ld(t,e)?t[e]=n:i(e,n)}}}(),sS={height:pS,measureWidth:dS,estimateWidth:lS,width:lS,canvas:cS};function cS(e){sS.width=e&&uC?dS:lS}function lS(e,t){return fS(yS(e,t),pS(e))}function fS(e,t){return~~(.8*e.length*t)}function dS(e,t){return pS(e)<=0||!(t=yS(e,t))?0:hS(t,xS(e))}function hS(e,t){var n="(".concat(t,") ").concat(e),r=uS.get(n);return void 0===r&&(uC.font=t,r=uC.measureText(e).width,uS.set(n,r)),r}function pS(e){return null!=e.fontSize?+e.fontSize||0:11}function vS(e){return null!=e.lineHeight?e.lineHeight:pS(e)+2}function gS(e){return t=e.lineBreak&&e.text&&!Fd(e.text)?e.text.split(e.lineBreak):e.text,Fd(t)?t.length>1?t:t[0]:t;var t}function mS(e){var t=gS(e);return(Fd(t)?t.length-1:0)*vS(e)}function yS(e,t){var n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function(e,t){var n=+e.limit,r=function(e){if(sS.width===dS){var t=xS(e);return function(e){return hS(e,t)}}var n=pS(e);return function(e){return fS(e,n)}}(e);if(r(t)<n)return t;var a,i=e.ellipsis||"\u2026",o="rtl"===e.dir,u=0,s=t.length;if(n-=r(i),o){for(;u<s;)a=u+s>>>1,r(t.slice(a))>n?u=a+1:s=a;return i+t.slice(u)}for(;u<s;)a=1+(u+s>>>1),r(t.slice(0,a))<n?u=a:s=a-1;return t.slice(0,u)+i}(e,n):n}function bS(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function xS(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+pS(e)+"px "+bS(e,t)}function kS(e){var t=e.baseline,n=pS(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*vS(e):"line-bottom"===t?.29*n-.5*vS(e):0)}cS(!0);var wS={left:"start",center:"middle",right:"end"},_S=new I_;function CS(e){var t,n=e.x||0,r=e.y||0,a=e.radius||0;return a&&(t=(e.theta||0)-Yw,n+=a*Math.cos(t),r+=a*Math.sin(t)),_S.x1=n,_S.y1=r,_S}function SS(e,t,n){var r,a=sS.height(t),i=t.align,o=CS(t),u=o.x1,s=o.y1,c=t.dx||0,l=(t.dy||0)+kS(t)-Math.round(.8*a),f=gS(t);if(Fd(f)?(a+=vS(t)*(f.length-1),r=f.reduce((function(e,n){return Math.max(e,sS.width(t,n))}),0)):r=sS.width(t,f),"center"===i?c-=r/2:"right"===i&&(c-=r),e.set(c+=u,l+=s,c+r,l+a),t.angle&&!n)e.rotate(t.angle*Xw,u,s);else if(2===n)return e.rotatedPoints(t.angle*Xw,u,s);return e}var AS={type:"text",tag:"text",nested:!1,attr:function(e,t){var n,r=t.dx||0,a=(t.dy||0)+kS(t),i=CS(t),o=i.x1,u=i.y1,s=t.angle||0;e("text-anchor",wS[t.align]||"start"),s?(n=DC(o,u)+" "+FC(s),(r||a)&&(n+=" "+DC(r,a))):n=DC(o+r,u+a),e("transform",n)},bound:SS,draw:function(e,t,n){wC(t,(function(t){var r,a,i,o,u,s,c,l=null==t.opacity?1:t.opacity;if(!(n&&!n.intersects(t.bounds)||0===l||t.fontSize<=0||null==t.text||0===t.text.length)){if(e.font=xS(t),e.textAlign=t.align||"left",a=(r=CS(t)).x1,i=r.y1,t.angle&&(e.save(),e.translate(a,i),e.rotate(t.angle*Xw),a=i=0),a+=t.dx||0,i+=(t.dy||0)+kS(t),s=gS(t),hC(e,t),Fd(s))for(u=vS(t),o=0;o<s.length;++o)c=yS(t,s[o]),t.fill&&mC(e,t,l)&&e.fillText(c,a,i),t.stroke&&bC(e,t,l)&&e.strokeText(c,a,i),i+=u;else c=yS(t,s),t.fill&&mC(e,t,l)&&e.fillText(c,a,i),t.stroke&&bC(e,t,l)&&e.strokeText(c,a,i);t.angle&&e.restore()}}))},pick:EC((function(e,t,n,r,a,i){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=CS(t),u=o.x1,s=o.y1,c=SS(_S,t,1),l=-t.angle*Xw,f=Math.cos(l),d=Math.sin(l),h=f*a-d*i+(u-f*u+d*s),p=d*a+f*i+(s-d*u-f*s);return c.contains(h,p)})),isect:function(e,t){var n=SS(_S,e,2);return dC(t,n[0],n[1],n[2],n[3])||dC(t,n[0],n[1],n[4],n[5])||dC(t,n[4],n[5],n[6],n[7])||dC(t,n[2],n[3],n[6],n[7])}},ES=RC("trail",(function(e,t){return E_.context(e)(t)}),(function(e,t){for(var n,r,a=e.length;--a>=0;)if(!1!==e[a].defined&&(n=e[a].x-t[0])*n+(r=e[a].y-t[1])*r<(n=e[a].size||1)*n)return e[a];return null})),TS={arc:OC,area:ZC,group:VC,image:$C,line:QC,path:eS,rect:nS,rule:aS,shape:iS,symbol:oS,text:AS,trail:ES};function NS(e,t,n){return!e&&"undefined"!==typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function DS(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,a=n.length;r<a;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function FS(e,t,n,r){var a,i=e.childNodes[t];return i&&i.tagName.toLowerCase()===n.toLowerCase()||(a=i||null,i=NS(e.ownerDocument,n,r),e.insertBefore(i,a)),i}function IS(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function MS(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function OS(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function RS(e,t){this._active=null,this._handlers={},this._loader=e||by(),this._tooltip=t||ZS}function ZS(e,t,n,r){e.element().setAttribute("title",r||"")}function BS(e){this._el=null,this._bgcolor=null,this._loader=new R_(e)}RS.prototype={initialize:function(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element:function(){return this._el},canvas:function(){return this._el&&this._el.firstChild},origin:function(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene:function(e){return arguments.length?(this._scene=e,this):this._scene},on:function(){},off:function(){},_handlerIndex:function(e,t,n){for(var r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers:function(e){var t=this._handlers,n=[];if(e)n.push.apply(n,(0,ln.Z)(t[this.eventName(e)]));else for(var r in t)n.push.apply(n,(0,ln.Z)(t[r]));return n},eventName:function(e){var t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref:function(e,t,n){this._loader.sanitize(n,{context:"href"}).then((function(t){var n=new MouseEvent(e.type,e),r=NS(null,"a");for(var a in t)r.setAttribute(a,t[a]);r.dispatchEvent(n)})).catch((function(){}))},handleTooltip:function(e,t,n){if(t&&null!=t.tooltip){t=function(e,t,n,r){var a,i,o=e&&e.mark;if(o&&(a=TS[o.marktype]).tip){for((i=OS(t,n))[0]-=r[0],i[1]-=r[1];e=e.mark.group;)i[0]-=e.x||0,i[1]-=e.y||0;e=a.tip(o.items,i)}return e}(t,e,this.canvas(),this._origin);var r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect:function(e){var t=this.canvas();if(t){for(var n=t.getBoundingClientRect(),r=this._origin,a=e.bounds,i=a.width(),o=a.height(),u=a.x1+r[0]+n.left,s=a.y1+r[1]+n.top;e.mark&&(e=e.mark.group);)u+=e.x||0,s+=e.y||0;return{x:u,y:s,width:i,height:o,left:u,top:s,right:u+i,bottom:s+o}}}},BS.prototype={initialize:function(e,t,n,r,a){return this._el=e,this.resize(t,n,r,a)},element:function(){return this._el},canvas:function(){return this._el&&this._el.firstChild},background:function(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize:function(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty:function(){},render:function(e){var t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render:function(){},renderAsync:function(e){var t=this.render(e);return this._ready?this._ready.then((function(){return t})):Promise.resolve(t)},_load:function(e,t){var n=this,r=n._loader[e](t);if(!n._ready){var a=n._call;n._ready=n._loader.ready().then((function(e){e&&a(),n._ready=null}))}return r},sanitizeURL:function(e){return this._load("sanitizeURL",e)},loadImage:function(e){return this._load("loadImage",e)}};var zS="dragenter",LS="dragleave",PS="dragover",jS="mousedown",US="mousemove",WS="mouseout",VS="mouseover",GS="click",qS="mousewheel",HS="touchstart",XS="touchmove",YS="touchend",KS=US,$S=WS,QS=GS;function JS(e,t){RS.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function eA(e,t){(function(e){return e===HS||e===XS||e===YS?[HS,XS,YS]:[e]})(t).forEach((function(t){return function(e,t){var n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?function(n){return e[t](n)}:function(n){return e.fire(t,n)}))}(e,t)}))}function tA(e,t,n){return function(r){var a=this._active,i=this.pickEvent(r);i===a||(a&&a.exit||this.fire(n,r),this._active=i,this.fire(t,r)),this.fire(e,r)}}function nA(e){return function(t){this.fire(e,t),this._active=null}}Pd(JS,RS,{initialize:function(e,t,n){var r=this;return this._canvas=e&&DS(e,"canvas"),[GS,jS,US,WS,LS].forEach((function(e){return eA(r,e)})),RS.prototype.initialize.call(this,e,t,n)},canvas:function(){return this._canvas},context:function(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",zS,LS,PS,jS,"mouseup",US,WS,VS,GS,"dblclick","wheel",qS,HS,XS,YS],DOMMouseScroll:function(e){this.fire(qS,e)},mousemove:tA(US,VS,WS),dragover:tA(PS,zS,LS),mouseout:nA(WS),dragleave:nA(LS),mousedown:function(e){this._down=this._active,this.fire(jS,e)},click:function(e){this._down===this._active&&(this.fire(GS,e),this._down=null)},touchstart:function(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(HS,e,!0)},touchmove:function(e){this.fire(XS,e,!0)},touchend:function(e){this.fire(YS,e,!0),this._touch=null},fire:function(e,t,n){var r=n?this._touch:this._active,a=this._handlers[e];if(t.vegaType=e,e===QS&&r&&r.href?this.handleHref(t,r,r.href):e!==KS&&e!==$S||this.handleTooltip(t,r,e!==$S),a)for(var i=0,o=a.length;i<o;++i)a[i].handler.call(this._obj,t,r)},on:function(e,t){var n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(eA(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off:function(e,t){var n=this.eventName(e),r=this._handlers[n],a=this._handlerIndex(r,e,t);return a>=0&&r.splice(a,1),this},pickEvent:function(e){var t=OS(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick:function(e,t,n,r,a){var i=this.context();return TS[e.marktype].pick.call(this,i,e,t,n,r,a)}});var rA="undefined"!==typeof window&&window.devicePixelRatio||1;function aA(e){BS.call(this,e),this._options={},this._redraw=!1,this._dirty=new I_,this._tempb=new I_}var iA=BS.prototype;function oA(e,t){RS.call(this,e,t);var n=this;n._hrefHandler=uA(n,(function(e,t){t&&t.href&&n.handleHref(e,t,t.href)})),n._tooltipHandler=uA(n,(function(e,t){n.handleTooltip(e,t,e.type!==$S)}))}Pd(aA,BS,{initialize:function(e,t,n,r,a,i){return this._options=i||{},this._canvas=this._options.externalContext?null:_p(1,1,this._options.type),e&&this._canvas&&(IS(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),iA.initialize.call(this,e,t,n,r,a)},resize:function(e,t,n,r){if(iA.resize.call(this,e,t,n,r),this._canvas)!function(e,t,n,r,a,i){var o="undefined"!==typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,u=e.getContext("2d"),s=o?rA:a;for(var c in e.width=t*s,e.height=n*s,i)u[c]=i[c];o&&1!==s&&(e.style.width=t+"px",e.style.height=n+"px"),u.pixelRatio=s,u.setTransform(s,0,0,s,s*r[0],s*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{var a=this._options.externalContext;a||Ad("CanvasRenderer is missing a valid canvas or context"),a.scale(this._scale,this._scale),a.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas:function(){return this._canvas},context:function(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty:function(e){for(var t=this._tempb.clear().union(e.bounds),n=e.mark.group;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render:function(e){var t=this.context(),n=this._origin,r=this._width,a=this._height,i=this._dirty,o=function(e,t,n){return(new I_).set(0,0,t,n).translate(-e[0],-e[1])}(n,r,a);t.save();var u=this._redraw||i.empty()?(this._redraw=!1,o.expand(1)):function(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(t,o.intersect(i),n);return this.clear(-n[0],-n[1],r,a),this.draw(t,e,u),t.restore(),i.clear(),this},draw:function(e,t,n){var r=TS[t.marktype];t.clip&&function(e,t){var n=t.clip;e.save(),Zd(n)?(e.beginPath(),n(e),e.clip()):BC(e,t.group)}(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear:function(e,t,n,r){var a=this._options,i=this.context();"pdf"===a.type||a.externalContext||i.clearRect(e,t,n,r),null!=this._bgcolor&&(i.fillStyle=this._bgcolor,i.fillRect(e,t,n,r))}});var uA=function(e,t){return function(n){var r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)}};Pd(oA,RS,{initialize:function(e,t,n){var r=this._svg;return r&&(r.removeEventListener(QS,this._hrefHandler),r.removeEventListener(KS,this._tooltipHandler),r.removeEventListener($S,this._tooltipHandler)),this._svg=r=e&&DS(e,"svg"),r&&(r.addEventListener(QS,this._hrefHandler),r.addEventListener(KS,this._tooltipHandler),r.addEventListener($S,this._tooltipHandler)),RS.prototype.initialize.call(this,e,t,n)},canvas:function(){return this._svg},on:function(e,t){var n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){var a={type:e,handler:t,listener:uA(this,t)};(r[n]||(r[n]=[])).push(a),this._svg&&this._svg.addEventListener(n,a.listener)}return this},off:function(e,t){var n=this.eventName(e),r=this._handlers[n],a=this._handlerIndex(r,e,t);return a>=0&&(this._svg&&this._svg.removeEventListener(n,r[a].listener),r.splice(a,1)),this}});var sA="aria-hidden",cA="aria-label",lA="role",fA="aria-roledescription",dA="graphics-object",hA="graphics-symbol",pA=function(e,t,n){var r;return r={},(0,qn.Z)(r,lA,e),(0,qn.Z)(r,fA,t),(0,qn.Z)(r,cA,n||void 0),r},vA=Wd(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),gA={axis:{desc:"axis",caption:function(e){var t=e.datum,n=e.orient,r=t.title?kA(e):null,a=e.context,i=a.scales[t.scale].value,o=a.dataflow.locale(),u=i.type,s="left"===n||"right"===n?"Y":"X";return"".concat(s,"-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(dw(u)?"discrete":u," scale")+" with ".concat(Ow(o,i,e))}},legend:{desc:"legend",caption:function(e){var t=e.datum,n=t.title?kA(e):null,r="".concat(t.type||""," legend").trim(),a=t.scales,i=Object.keys(a),o=e.context,u=o.scales[a[i[0]]].value,s=o.dataflow.locale();return function(e){return e.length?e[0].toUpperCase()+e.slice(1):e}(r)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(e){return e=e.map((function(e){return e+("fill"===e||"stroke"===e?" color":"")})),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+Md(e)}(i))+" with ".concat(Ow(s,u,e))}},"title-text":{desc:"title",caption:function(e){return"Title text '".concat(xA(e),"'")}},"title-subtitle":{desc:"subtitle",caption:function(e){return"Subtitle text '".concat(xA(e),"'")}}},mA={ariaRole:lA,ariaRoleDescription:fA,description:cA};function yA(e,t){var n=!1===t.aria;if(e(sA,n||void 0),n||null==t.description)for(var r in mA)e(mA[r],void 0);else{var a=t.mark.marktype;e(cA,t.description),e(lA,t.ariaRole||("group"===a?dA:hA)),e(fA,t.ariaRoleDescription||"".concat(a," mark"))}}function bA(e){return!1===e.aria?(0,qn.Z)({},sA,!0):vA[e.role]?null:gA[e.role]?function(e,t){try{var n=e.items[0],r=t.caption||function(){return""};return pA(t.role||hA,t.desc,n.description||r(n))}catch(a){return null}}(e,gA[e.role]):function(e){var t=e.marktype,n="group"===t||"text"===t||e.items.some((function(e){return null!=e.description&&!1!==e.aria}));return pA(n?dA:hA,"".concat(t," mark container"),e.description)}(e)}function xA(e){return Rd(e.text).join(" ")}function kA(e){try{return Rd(Md(e.items).items[0].text).join(" ")}catch(t){return null}}var wA=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};function _A(){var e="",t="",n="",r=[],a=function(){return t=n=""},i=function(i){t&&(e+="".concat(t,">").concat(n),a()),r.push(i)},o=function(e,n){return null!=n&&(t+=" ".concat(e,'="').concat(wA(n).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"),'"')),u},u={open:function(e){i(e),t="<"+e;for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];for(var s=0,c=r;s<c.length;s++){var l=c[s];for(var f in l)o(f,l[f])}return u},close:function(){var i=r.pop();return e+=t?t+(n?">".concat(n,"</").concat(i,">"):"/>"):"</".concat(i,">"),a(),u},attr:o,text:function(e){return n+=wA(e),u},toString:function(){return e}};return u}var CA=function(e){return SA(_A(),e)+""};function SA(e,t){if(e.open(t.tagName),t.hasAttributes())for(var n=t.attributes,r=n.length,a=0;a<r;++a)e.attr(n[a].name,n[a].value);if(t.hasChildNodes()){var i,o=t.childNodes,u=(0,Zt.Z)(o);try{for(u.s();!(i=u.n()).done;){var s=i.value;3===s.nodeType?e.text(s.nodeValue):SA(e,s)}}catch(c){u.e(c)}finally{u.f()}}return e.close()}var AA={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},EA={blend:"mix-blend-mode"},TA={fill:"none","stroke-miterlimit":10},NA="http://www.w3.org/2000/xmlns/",DA=GC.xmlns;function FA(e){BS.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var IA=BS.prototype;function MA(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function OA(e,t,n){var r,a,i;if("radial"===t.gradient){var o=FS(e,n++,"pattern",DA);UA(o,{id:Zw+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),UA(o=FS(o,0,"rect",DA),{width:1,height:1,fill:"url(".concat(VA(),"#").concat(t.id,")")}),UA(e=FS(e,n++,"radialGradient",DA),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else UA(e=FS(e,n++,"linearGradient",DA),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,a=t.stops.length;r<a;++r)(i=FS(e,r,"stop",DA)).setAttribute("offset",t.stops[r].offset),i.setAttribute("stop-color",t.stops[r].color);return IS(e,r),n}function RA(e,t,n){return(e=FS(e,n,"clipPath",DA)).setAttribute("id",t.id),t.path?FS(e,0,"path",DA).setAttribute("d",t.path):UA(FS(e,0,"rect",DA),{x:0,y:0,width:t.width,height:t.height}),IS(e,1),n+1}function ZA(e,t,n,r,a){var i,o=e._svg;if(!o&&(o=NS(i=t.ownerDocument,r,DA),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},"g"===r))){var u=NS(i,"path",DA);o.appendChild(u),u.__data__=e;var s=NS(i,"g",DA);o.appendChild(s),s.__data__=e;var c=NS(i,"path",DA);o.appendChild(c),c.__data__=e,c.__values__={fill:"default"}}return(o.ownerSVGElement!==a||function(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}Pd(FA,BS,{initialize:function(e,t,n,r,a){return this._defs={},this._clearDefs(),e&&(this._svg=FS(e,0,"svg",DA),this._svg.setAttributeNS(NA,"xmlns",DA),this._svg.setAttributeNS(NA,"xmlns:xlink",GC["xmlns:xlink"]),this._svg.setAttribute("version",GC.version),this._svg.setAttribute("class","marks"),IS(e,1),this._root=FS(this._svg,0,"g",DA),UA(this._root,TA),IS(this._svg,1)),this.background(this._bgcolor),IA.initialize.call(this,e,t,n,r,a)},background:function(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),IA.background.apply(this,arguments)},resize:function(e,t,n,r){return IA.resize.call(this,e,t,n,r),this._svg&&(UA(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas:function(){return this._svg},svg:function(){var e,t=this._svg,n=this._bgcolor;if(!t)return null;n&&(t.removeAttribute("style"),UA(e=FS(t,0,"rect",DA),{width:this._width,height:this._height,fill:n}));var r=CA(t);return n&&(t.removeChild(e),this._svg.style.setProperty("background-color",n)),r},_render:function(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),IS(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty:function(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty:function(e){return this._dirtyAll||!e._svg||!e._svg.ownerSVGElement||e.dirty===this._dirtyID},_dirtyCheck:function(){this._dirtyAll=!0;var e=this._dirty;if(!e.length||!this._dirtyID)return!0;var t,n,r,a,i,o,u,s=++this._dirtyID;for(i=0,o=e.length;i<o;++i)(n=(t=e[i]).mark).marktype!==r&&(r=n.marktype,a=TS[r]),n.zdirty&&n.dirty!==s&&(this._dirtyAll=!1,MA(t,s),n.items.forEach((function(e){e.dirty=s}))),n.zdirty||(t.exit?(a.nested&&n.items.length?(u=n.items[0])._svg&&this._update(a,u._svg,u):t._svg&&(u=t._svg.parentNode)&&u.removeChild(t._svg),t._svg=null):(t=a.nested?n.items[0]:t)._update!==s&&(t._svg&&t._svg.ownerSVGElement?this._update(a,t._svg,t):(this._dirtyAll=!1,MA(t,s)),t._update=s));return!this._dirtyAll},mark:function(e,t,n){var r=this;if(!this.isDirty(t))return t._svg;var a=this._svg,i=TS[t.marktype],o=!1===t.interactive?"none":null,u="g"===i.tag,s=ZA(t,e,n,"g",a);s.setAttribute("class",MS(t));var c=bA(t);for(var l in c)WA(s,l,c[l]);u||WA(s,"pointer-events",o),WA(s,"clip-path",t.clip?F_(this,t,t.group):null);var f=null,d=0,h=function(e){var t=r.isDirty(e),n=ZA(e,s,f,i.tag,a);t&&(r._update(i,n,e),u&&function(e,t,n){t=t.lastChild.previousSibling;var r,a=0;wC(n,(function(n){r=e.mark(t,n,r),++a})),IS(t,1+a)}(r,n,e)),f=n,++d};return i.nested?t.items.length&&h(t.items[0]):wC(t,h),IS(s,d),s},_update:function(e,t,n){BA=t,zA=t.__values__,yA(PA,n),e.attr(PA,n,this);var r=LA[e.type];r&&r.call(this,e,t,n),BA&&this.style(BA,n)},style:function(e,t){if(null!=t){for(var n in AA){var r="font"===n?bS(t):t[n];if(r!==zA[n]){var a=AA[n];null==r?e.removeAttribute(a):(Bw(r)&&(r=zw(r,this._defs.gradient,VA())),e.setAttribute(a,r+"")),zA[n]=r}}for(var i in EA)jA(e,EA[i],t[i])}},defs:function(){var e=this._svg,t=this._defs,n=t.el,r=0;for(var a in t.gradient)n||(t.el=n=FS(e,1,"defs",DA)),r=OA(n,t.gradient[a],r);for(var i in t.clipping)n||(t.el=n=FS(e,1,"defs",DA)),r=RA(n,t.clipping[i],r);n&&(0===r?(e.removeChild(n),t.el=null):IS(n,r))},_clearDefs:function(){var e=this._defs;e.gradient={},e.clipping={}}});var BA=null,zA=null,LA={group:function(e,t,n){var r=BA=t.childNodes[2];zA=r.__values__,e.foreground(PA,n,this),zA=t.__values__,BA=t.childNodes[1],e.content(PA,n,this);var a=BA=t.childNodes[0];e.background(PA,n,this);var i=!1===n.mark.interactive?"none":null;if(i!==zA.events&&(WA(r,"pointer-events",i),WA(a,"pointer-events",i),zA.events=i),n.strokeForeground&&n.stroke){var o=n.fill;WA(r,"display",null),this.style(a,n),WA(a,"stroke",null),o&&(n.fill=null),zA=r.__values__,this.style(r,n),o&&(n.fill=o),BA=null}else WA(r,"display","none")},image:function(e,t,n){!1===n.smooth?(jA(t,"image-rendering","optimizeSpeed"),jA(t,"image-rendering","pixelated")):jA(t,"image-rendering",null)},text:function(e,t,n){var r,a,i,o,u=gS(n);Fd(u)?(r=(a=u.map((function(e){return yS(n,e)}))).join("\n"))!==zA.text&&(IS(t,0),i=t.ownerDocument,o=vS(n),a.forEach((function(e,r){var a=NS(i,"tspan",DA);a.__data__=n,a.textContent=e,r&&(a.setAttribute("x",0),a.setAttribute("dy",o)),t.appendChild(a)})),zA.text=r):(a=yS(n,u))!==zA.text&&(t.textContent=a,zA.text=a),WA(t,"font-family",bS(n)),WA(t,"font-size",pS(n)+"px"),WA(t,"font-style",n.fontStyle),WA(t,"font-variant",n.fontVariant),WA(t,"font-weight",n.fontWeight)}};function PA(e,t,n){t!==zA[e]&&(n?function(e,t,n,r){null!=n?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}(BA,e,t,n):WA(BA,e,t),zA[e]=t)}function jA(e,t,n){n!==zA[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),zA[t]=n)}function UA(e,t){for(var n in t)WA(e,n,t[n])}function WA(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function VA(){var e;return"undefined"===typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function GA(e){BS.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}Pd(GA,BS,{svg:function(){return this._text},_render:function(e){var t=_A();t.open("svg",Bd({},GC,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));var n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",TA,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark:function(e,t){var n=this,r=TS[t.marktype],a=r.tag,i=[yA,r.attr];e.open("g",{class:MS(t),"clip-path":t.clip?F_(this,t,t.group):null},bA(t),{"pointer-events":"g"!==a&&!1===t.interactive?"none":null});var o=function(o){var u=n.href(o);if(u&&e.open("a",u),e.open(a,n.attr(t,o,i,"g"!==a?a:null)),"text"===a){var s=gS(o);if(Fd(s))for(var c={x:0,dy:vS(o)},l=0;l<s.length;++l)e.open("tspan",l?c:null).text(yS(o,s[l])).close();else e.text(yS(o,s))}else if("g"===a){var f=o.strokeForeground,d=o.fill,h=o.stroke;f&&h&&(o.stroke=null),e.open("path",n.attr(t,o,r.background,"bgrect")).close(),e.open("g",n.attr(t,o,r.content)),wC(o,(function(t){return n.mark(e,t)})),e.close(),f&&h?(d&&(o.fill=null),o.stroke=h,e.open("path",n.attr(t,o,r.foreground,"bgrect")).close(),d&&(o.fill=d)):e.open("path",n.attr(t,o,r.foreground,"bgfore")).close()}e.close(),u&&e.close()};return r.nested?t.items&&t.items.length&&o(t.items[0]):wC(t,o),e.close()},href:function(e){var t,n=this,r=e.href;if(r){if(t=this._hrefs&&this._hrefs[r])return t;this.sanitizeURL(r).then((function(e){e["xlink:href"]=e.href,e.href=null,(n._hrefs||(n._hrefs={}))[r]=e}))}return null},attr:function(e,t,n,r){var a=this,i={},o=function(e,t,n,r){i[r||e]=t};return Array.isArray(n)?n.forEach((function(e){return e(o,t,a)})):n(o,t,this),r&&function(e,t,n,r,a){var i;if(null==t)return e;"bgrect"===r&&!1===n.interactive&&(e["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill))return e;"image"===r&&!1===t.smooth&&(i=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]);"text"===r&&(e["font-family"]=bS(t),e["font-size"]=pS(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(var o in AA){var u=t[o],s=AA[o];("transparent"!==u||"fill"!==s&&"stroke"!==s)&&null!=u&&(Bw(u)&&(u=zw(u,a.gradient,"")),e[s]=u)}for(var c in EA){var l=t[c];null!=l&&(i=i||[]).push("".concat(EA[c],": ").concat(l,";"))}i&&(e.style=i.join(" "))}(i,t,e,r,this._defs),i},defs:function(e){var t=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(t).length+Object.keys(n).length){for(var r in e.open("defs"),t){var a=t[r],i=a.stops;"radial"===a.gradient?(e.open("pattern",{id:Zw+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),e.close(),e.open("radialGradient",{id:r,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})):e.open("linearGradient",{id:r,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2});for(var o=0;o<i.length;++o)e.open("stop",{offset:i[o].offset,"stop-color":i[o].color}).close();e.close()}for(var u in n){var s=n[u];e.open("clipPath",{id:u}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});var qA="canvas",HA="none",XA={};XA[qA]=XA.png={renderer:aA,headless:aA,handler:JS},XA.svg={renderer:FA,headless:GA,handler:oA},XA[HA]={};var YA=new I_;var KA="top",$A="left",QA="right",JA="bottom",eE="start",tE="middle",nE="end",rE="group",aE="axis",iE="title",oE="frame",uE="scope",sE="legend",cE="row-header",lE="row-footer",fE="row-title",dE="column-header",hE="column-footer",pE="column-title",vE="padding",gE="fit",mE="fit-x",yE="fit-y",bE="none",xE="all",kE="each",wE="flush",_E="column",CE="row";function SE(e){mu.call(this,null,e)}function AE(e,t,n){return t(e.bounds.clear(),e,n)}Pd(SE,mu,{transform:function(e,t){var n,r=t.dataflow,a=e.mark,i=a.marktype,o=TS[i],u=o.bound,s=a.bounds;if(o.nested)a.items.length&&r.dirty(a.items[0]),s=AE(a,u),a.items.forEach((function(e){e.bounds.clear().union(s)}));else if(i===rE||e.modified())switch(t.visit(t.MOD,(function(e){return r.dirty(e)})),s.clear(),a.items.forEach((function(e){return s.union(AE(e,u))})),a.role){case aE:case sE:case iE:t.reflow()}else n=t.changed(t.REM),t.visit(t.ADD,(function(e){s.union(AE(e,u))})),t.visit(t.MOD,(function(e){n=n||s.alignsWith(e.bounds),r.dirty(e),s.union(AE(e,u))})),n&&(s.clear(),a.items.forEach((function(e){return s.union(e.bounds)})));return function(e){var t=e.clip;if(Zd(t))t(nC(YA.clear()));else{if(!t)return;YA.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(YA)}(a),t.modifies("bounds")}});var EE=":vega_identifier:";function TE(e){mu.call(this,0,e)}function NE(e){mu.call(this,null,e)}function DE(e){mu.call(this,null,e)}TE.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},Pd(TE,mu,{transform:function(e,t){var n,r=(n=t.dataflow)._signals[EE]||(n._signals[EE]=n.add(0)),a=e.as,i=r.value;return t.visit(t.ADD,(function(e){return e[a]=e[a]||++i})),r.set(this.value=i),t}}),Pd(NE,mu,{transform:function(e,t){var n=this.value;n||((n=t.dataflow.scenegraph().mark(e.markdef,function(e){var t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}(e),e.index)).group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);var r=n.marktype===rE?O_:M_;return t.visit(t.ADD,(function(e){return r.call(e,n)})),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});var FE={parity:function(e){return e.filter((function(e,t){return t%2?e.opacity=0:1}))},greedy:function(e,t){var n;return e.filter((function(e,r){return r&&IE(n.bounds,e.bounds,t)?e.opacity=0:(n=e,1)}))}},IE=function(e,t,n){return n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2)},ME=function(e,t){for(var n,r=1,a=e.length,i=e[0].bounds;r<a;i=n,++r)if(IE(i,n=e[r].bounds,t))return!0},OE=function(e){var t=e.bounds;return t.width()>1&&t.height()>1},RE=function(e){return e.forEach((function(e){return e.opacity=1})),e},ZE=function(e,t){return e.reflow(t.modified()).modifies("opacity")};function BE(e){mu.call(this,null,e)}Pd(DE,mu,{transform:function(e,t){var n,r,a=FE[e.method]||FE.parity,i=e.separation||0,o=t.materialize(t.SOURCE).source;if(o&&o.length){if(!e.method)return e.modified("method")&&(RE(o),t=ZE(t,e)),t;if((o=o.filter(OE)).length){if(e.sort&&(o=o.slice().sort(e.sort)),n=RE(o),t=ZE(t,e),n.length>=3&&ME(n,i)){do{n=a(n,i)}while(n.length>=3&&ME(n,i));n.length<3&&!Md(o).opacity&&(n.length>1&&(Md(n).opacity=0),Md(o).opacity=1)}e.boundScale&&e.boundTolerance>=0&&(r=function(e,t,n){var r=e.range(),a=new I_;return t===KA||t===JA?a.set(r[0],-1/0,r[1],1/0):a.set(-1/0,r[0],1/0,r[1]),a.expand(n||1),function(e){return a.encloses(e.bounds)}}(e.boundScale,e.boundOrient,+e.boundTolerance),o.forEach((function(e){r(e)||(e.opacity=0)})));var u=n[0].mark.bounds.clear();return o.forEach((function(e){e.opacity&&u.union(e.bounds)})),t}}}}),Pd(BE,mu,{transform:function(e,t){var n=t.dataflow;if(t.visit(t.ALL,(function(e){return n.dirty(e)})),t.fields&&t.fields.zindex){var r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});var zE=new I_;function LE(e,t,n){return e[t]===n?0:(e[t]=n,1)}function PE(e){var t=e.items[0].orient;return t===$A||t===QA}function jE(e,t,n,r){var a,i,o=t.items[0],u=o.datum,s=null!=o.translate?o.translate:.5,c=o.orient,l=function(e){var t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}(u),f=o.range,d=o.offset,h=o.position,p=o.minExtent,v=o.maxExtent,g=u.title&&o.items[l[2]].items[0],m=o.titlePadding,y=o.bounds,b=g&&mS(g),x=0,k=0;switch(zE.clear().union(y),y.clear(),(a=l[0])>-1&&y.union(o.items[a].bounds),(a=l[1])>-1&&y.union(o.items[a].bounds),c){case KA:x=h||0,k=-d,i=Math.max(p,Math.min(v,-y.y1)),y.add(0,-i).add(f,0),g&&UE(e,g,i,m,b,0,-1,y);break;case $A:x=-d,k=h||0,i=Math.max(p,Math.min(v,-y.x1)),y.add(-i,0).add(0,f),g&&UE(e,g,i,m,b,1,-1,y);break;case QA:x=n+d,k=h||0,i=Math.max(p,Math.min(v,y.x2)),y.add(0,0).add(i,f),g&&UE(e,g,i,m,b,1,1,y);break;case JA:x=h||0,k=r+d,i=Math.max(p,Math.min(v,y.y2)),y.add(0,0).add(f,i),g&&UE(e,g,i,m,0,0,1,y);break;default:x=o.x,k=o.y}return z_(y.translate(x,k),o),LE(o,"x",x+s)|LE(o,"y",k+s)&&(o.bounds=zE,e.dirty(o),o.bounds=y,e.dirty(o)),o.mark.bounds.clear().union(y)}function UE(e,t,n,r,a,i,o,u){var s=t.bounds;if(t.auto){var c=o*(n+a+r),l=0,f=0;e.dirty(t),i?l=(t.x||0)-(t.x=c):f=(t.y||0)-(t.y=c),t.mark.bounds.clear().union(s.translate(-l,-f)),e.dirty(t)}u.union(s)}var WE=function(e,t){return Math.floor(Math.min(e,t))},VE=function(e,t){return Math.ceil(Math.max(e,t))};function GE(e){return(new I_).set(0,0,e.width||0,e.height||0)}function qE(e){var t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function HE(e,t,n){var r=Id(e)?e[t]:e;return null!=r?r:void 0!==n?n:0}function XE(e){return e<0?Math.ceil(-e):0}function YE(e,t,n){var r,a,i,o,u,s,c,l,f,d,h,p=!n.nodirty,v=n.bounds===wE?GE:qE,g=zE.set(0,0,0,0),m=HE(n.align,_E),y=HE(n.align,CE),b=HE(n.padding,_E),x=HE(n.padding,CE),k=n.columns||t.length,w=k<=0?1:Math.ceil(t.length/k),_=t.length,C=Array(_),S=Array(k),A=0,E=Array(_),T=Array(w),N=0,D=Array(_),F=Array(_),I=Array(_);for(a=0;a<k;++a)S[a]=0;for(a=0;a<w;++a)T[a]=0;for(a=0;a<_;++a)s=t[a],u=I[a]=v(s),s.x=s.x||0,D[a]=0,s.y=s.y||0,F[a]=0,i=a%k,o=~~(a/k),A=Math.max(A,c=Math.ceil(u.x2)),N=Math.max(N,l=Math.ceil(u.y2)),S[i]=Math.max(S[i],c),T[o]=Math.max(T[o],l),C[a]=b+XE(u.x1),E[a]=x+XE(u.y1),p&&e.dirty(t[a]);for(a=0;a<_;++a)a%k===0&&(C[a]=0),a<k&&(E[a]=0);if(m===kE)for(i=1;i<k;++i){for(h=0,a=i;a<_;a+=k)h<C[a]&&(h=C[a]);for(a=i;a<_;a+=k)C[a]=h+S[i-1]}else if(m===xE){for(h=0,a=0;a<_;++a)a%k&&h<C[a]&&(h=C[a]);for(a=0;a<_;++a)a%k&&(C[a]=h+A)}else for(m=!1,i=1;i<k;++i)for(a=i;a<_;a+=k)C[a]+=S[i-1];if(y===kE)for(o=1;o<w;++o){for(h=0,r=(a=o*k)+k;a<r;++a)h<E[a]&&(h=E[a]);for(a=o*k;a<r;++a)E[a]=h+T[o-1]}else if(y===xE){for(h=0,a=k;a<_;++a)h<E[a]&&(h=E[a]);for(a=k;a<_;++a)E[a]=h+N}else for(y=!1,o=1;o<w;++o)for(r=(a=o*k)+k;a<r;++a)E[a]+=T[o-1];for(f=0,a=0;a<_;++a)f=C[a]+(a%k?f:0),D[a]+=f-t[a].x;for(i=0;i<k;++i)for(d=0,a=i;a<_;a+=k)d+=E[a],F[a]+=d-t[a].y;if(m&&HE(n.center,_E)&&w>1)for(a=0;a<_;++a)(f=(u=m===xE?A:S[a%k])-I[a].x2-t[a].x-D[a])>0&&(D[a]+=f/2);if(y&&HE(n.center,CE)&&1!==k)for(a=0;a<_;++a)(d=(u=y===xE?N:T[~~(a/k)])-I[a].y2-t[a].y-F[a])>0&&(F[a]+=d/2);for(a=0;a<_;++a)g.union(I[a].translate(D[a],F[a]));switch(f=HE(n.anchor,"x"),d=HE(n.anchor,"y"),HE(n.anchor,_E)){case nE:f-=g.width();break;case tE:f-=g.width()/2}switch(HE(n.anchor,CE)){case nE:d-=g.height();break;case tE:d-=g.height()/2}for(f=Math.round(f),d=Math.round(d),g.clear(),a=0;a<_;++a)t[a].mark.bounds.clear();for(a=0;a<_;++a)(s=t[a]).x+=D[a]+=f,s.y+=F[a]+=d,g.union(s.mark.bounds.union(s.bounds.translate(D[a],F[a]))),p&&e.dirty(s);return g}function KE(e,t,n){var r,a,i,o,u,s,c,l=function(e){for(var t,n,r,a,i,o,u,s=e.items,c=s.length,l=0,f={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};l<c;++l)if(u=(o=s[l]).items,o.marktype===rE)switch(o.role){case aE:case sE:case iE:break;case cE:(t=f.rowheaders).push.apply(t,(0,ln.Z)(u));break;case lE:(n=f.rowfooters).push.apply(n,(0,ln.Z)(u));break;case dE:(r=f.colheaders).push.apply(r,(0,ln.Z)(u));break;case hE:(a=f.colfooters).push.apply(a,(0,ln.Z)(u));break;case fE:f.rowtitle=u[0];break;case pE:f.coltitle=u[0];break;default:(i=f.marks).push.apply(i,(0,ln.Z)(u))}return f}(t),f=l.marks,d=n.bounds===wE?$E:QE,h=n.offset,p=n.columns||f.length,v=p<=0?1:Math.ceil(f.length/p),g=v*p,m=YE(e,f,n);m.empty()&&m.set(0,0,0,0),l.rowheaders&&(s=HE(n.headerBand,CE,null),r=JE(e,l.rowheaders,f,p,v,-HE(h,"rowHeader"),WE,0,d,"x1",0,p,1,s)),l.colheaders&&(s=HE(n.headerBand,_E,null),a=JE(e,l.colheaders,f,p,p,-HE(h,"columnHeader"),WE,1,d,"y1",0,1,p,s)),l.rowfooters&&(s=HE(n.footerBand,CE,null),i=JE(e,l.rowfooters,f,p,v,HE(h,"rowFooter"),VE,0,d,"x2",p-1,p,1,s)),l.colfooters&&(s=HE(n.footerBand,_E,null),o=JE(e,l.colfooters,f,p,p,HE(h,"columnFooter"),VE,1,d,"y2",g-p,1,p,s)),l.rowtitle&&(u=HE(n.titleAnchor,CE),c=HE(h,"rowTitle"),c=u===nE?i+c:r-c,s=HE(n.titleBand,CE,.5),eT(e,l.rowtitle,c,0,m,s)),l.coltitle&&(u=HE(n.titleAnchor,_E),c=HE(h,"columnTitle"),c=u===nE?o+c:a-c,s=HE(n.titleBand,_E,.5),eT(e,l.coltitle,c,1,m,s))}function $E(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function QE(e,t){return e.bounds[t]}function JE(e,t,n,r,a,i,o,u,s,c,l,f,d,h){var p,v,g,m,y,b,x,k,w,_=n.length,C=0,S=0;if(!_)return C;for(p=l;p<_;p+=f)n[p]&&(C=o(C,s(n[p],c)));if(!t.length)return C;for(t.length>a&&(e.warn("Grid headers exceed limit: "+a),t=t.slice(0,a)),C+=i,v=0,m=t.length;v<m;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(p=l,v=0,m=t.length;v<m;++v,p+=f){for(y=(b=t[v]).mark.bounds,g=p;g>=0&&null==(x=n[g]);g-=d);u?(k=null==h?x.x:Math.round(x.bounds.x1+h*x.bounds.width()),w=C):(k=C,w=null==h?x.y:Math.round(x.bounds.y1+h*x.bounds.height())),y.union(b.bounds.translate(k-(b.x||0),w-(b.y||0))),b.x=k,b.y=w,e.dirty(b),S=o(S,y[c])}return S}function eT(e,t,n,r,a,i){if(t){e.dirty(t);var o=n,u=n;r?o=Math.round(a.x1+i*a.width()):u=Math.round(a.y1+i*a.height()),t.bounds.translate(o-(t.x||0),u-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=u,e.dirty(t)}}function tT(e,t,n,r,a,i,o){var u=function(e,t){var n=e[t]||{};return function(t,r){return null!=n[t]?n[t]:null!=e[t]?e[t]:r}}(n,t),s=function(e,t){var n=-1/0;return e.forEach((function(e){null!=e.offset&&(n=Math.max(n,e.offset))})),n>-1/0?n:t}(e,u("offset",0)),c=u("anchor",eE),l=c===nE?1:c===tE?.5:0,f={align:kE,bounds:u("bounds",wE),columns:"vertical"===u("direction")?1:e.length,padding:u("margin",8),center:u("center"),nodirty:!0};switch(t){case $A:f.anchor={x:Math.floor(r.x1)-s,column:nE,y:l*(o||r.height()+2*r.y1),row:c};break;case QA:f.anchor={x:Math.ceil(r.x2)+s,y:l*(o||r.height()+2*r.y1),row:c};break;case KA:f.anchor={y:Math.floor(a.y1)-s,row:nE,x:l*(i||a.width()+2*a.x1),column:c};break;case JA:f.anchor={y:Math.ceil(a.y2)+s,x:l*(i||a.width()+2*a.x1),column:c};break;case"top-left":f.anchor={x:s,y:s};break;case"top-right":f.anchor={x:i-s,y:s,column:nE};break;case"bottom-left":f.anchor={x:s,y:o-s,row:nE};break;case"bottom-right":f.anchor={x:i-s,y:o-s,column:nE,row:nE}}return f}function nT(e,t){var n,r,a=t.items[0],i=a.datum,o=a.orient,u=a.bounds,s=a.x,c=a.y;return a._bounds?a._bounds.clear().union(u):a._bounds=u.clone(),u.clear(),function(e,t,n){var r=t.padding,a=r-n.x,i=r-n.y;if(t.datum.title){var o=t.items[1].items[0],u=o.anchor,s=t.titlePadding||0,c=r-o.x,l=r-o.y;switch(o.orient){case $A:a+=Math.ceil(o.bounds.width())+s;break;case QA:case JA:break;default:i+=o.bounds.height()+s}switch((a||i)&&aT(e,n,a,i),o.orient){case $A:l+=rT(t,n,o,u,1,1);break;case QA:c+=rT(t,n,o,nE,0,0)+s,l+=rT(t,n,o,u,1,1);break;case JA:c+=rT(t,n,o,u,0,0),l+=rT(t,n,o,nE,-1,0,1)+s;break;default:c+=rT(t,n,o,u,0,0)}(c||l)&&aT(e,o,c,l),(c=Math.round(o.bounds.x1-r))<0&&(aT(e,n,-c,0),aT(e,o,-c,0))}else(a||i)&&aT(e,n,a,i)}(e,a,a.items[0].items[0]),u=function(e,t){return e.items.forEach((function(e){return t.union(e.bounds)})),t.x1=e.padding,t.y1=e.padding,t}(a,u),n=2*a.padding,r=2*a.padding,u.empty()||(n=Math.ceil(u.width()+n),r=Math.ceil(u.height()+r)),"symbol"===i.type&&function(e){var t=e.reduce((function(e,t){return e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0),e}),{});e.forEach((function(e){e.width=t[e.column],e.height=e.bounds.y2-e.y}))}(a.items[0].items[0].items[0].items),o!==bE&&(a.x=s=0,a.y=c=0),a.width=n,a.height=r,z_(u.set(s,c,s+n,c+r),a),a.mark.bounds.clear().union(u),a}function rT(e,t,n,r,a,i,o){var u="symbol"!==e.datum.type,s=n.datum.vgrad,c=(!u||!i&&s||o?t:t.items[0]).bounds[a?"y2":"x2"]-e.padding,l=s&&i?c:0,f=s&&i?0:c,d=a<=0?0:mS(n);return Math.round(r===eE?l:r===nE?f-d:.5*(c-d))}function aT(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function iT(e){mu.call(this,null,e)}Pd(iT,mu,{transform:function(e,t){var n=t.dataflow;return e.mark.items.forEach((function(t){e.layout&&KE(n,t,e.layout),function(e,t,n){var r,a,i,o,u,s=t.items,c=Math.max(0,t.width||0),l=Math.max(0,t.height||0),f=(new I_).set(0,0,c,l),d=f.clone(),h=f.clone(),p=[];for(o=0,u=s.length;o<u;++o)switch((a=s[o]).role){case aE:(PE(a)?d:h).union(jE(e,a,c,l));break;case iE:r=a;break;case sE:p.push(nT(e,a));break;case oE:case uE:case cE:case lE:case fE:case dE:case hE:case pE:d.union(a.bounds),h.union(a.bounds);break;default:f.union(a.bounds)}if(p.length){var v={};for(var g in p.forEach((function(e){(i=e.orient||QA)!==bE&&(v[i]||(v[i]=[])).push(e)})),v){var m=v[g];YE(e,m,tT(m,g,n.legends,d,h,c,l))}p.forEach((function(t){var r=t.bounds;if(r.equals(t._bounds)||(t.bounds=t._bounds,e.dirty(t),t.bounds=r,e.dirty(t)),!n.autosize||n.autosize.type!==gE&&n.autosize.type!==mE&&n.autosize.type!==yE)f.union(r);else switch(t.orient){case $A:case QA:f.add(r.x1,0).add(r.x2,0);break;case KA:case JA:f.add(0,r.y1).add(0,r.y2)}}))}f.union(d).union(h),r&&f.union(function(e,t,n,r,a){var i,o=t.items[0],u=o.frame,s=o.orient,c=o.anchor,l=o.offset,f=o.padding,d=o.items[0].items[0],h=o.items[1]&&o.items[1].items[0],p=s===$A||s===QA?r:n,v=0,g=0,m=0,y=0,b=0;if(u!==rE?s===$A?(v=a.y2,p=a.y1):s===QA?(v=a.y1,p=a.y2):(v=a.x1,p=a.x2):s===$A&&(v=r,p=0),i=c===eE?v:c===nE?p:(v+p)/2,h&&h.text){switch(s){case KA:case JA:b=d.bounds.height()+f;break;case $A:y=d.bounds.width()+f;break;case QA:y=-d.bounds.width()-f}zE.clear().union(h.bounds),zE.translate(y-(h.x||0),b-(h.y||0)),LE(h,"x",y)|LE(h,"y",b)&&(e.dirty(h),h.bounds.clear().union(zE),h.mark.bounds.clear().union(zE),e.dirty(h)),zE.clear().union(h.bounds)}else zE.clear();switch(zE.union(d.bounds),s){case KA:g=i,m=a.y1-zE.height()-l;break;case $A:g=a.x1-zE.width()-l,m=i;break;case QA:g=a.x2+zE.width()+l,m=i;break;case JA:g=i,m=a.y2+l;break;default:g=o.x,m=o.y}return LE(o,"x",g)|LE(o,"y",m)&&(zE.translate(g,m),e.dirty(o),o.bounds.clear().union(zE),t.bounds.clear().union(zE),e.dirty(o)),o.bounds}(e,r,c,l,f));t.clip&&f.set(0,0,t.width||0,t.height||0);!function(e,t,n,r){var a=r.autosize||{},i=a.type;if(e._autosize<1||!i)return;var o=e._width,u=e._height,s=Math.max(0,t.width||0),c=Math.max(0,Math.ceil(-n.x1)),l=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1)),d=Math.max(0,Math.ceil(n.x2-s)),h=Math.max(0,Math.ceil(n.y2-l));if(a.contains===vE){var p=e.padding();o-=p.left+p.right,u-=p.top+p.bottom}i===bE?(c=0,f=0,s=o,l=u):i===gE?(s=Math.max(0,o-c-d),l=Math.max(0,u-f-h)):i===mE?(s=Math.max(0,o-c-d),u=l+f+h):i===yE?(o=s+c+d,l=Math.max(0,u-f-h)):"pad"===i&&(o=s+c+d,u=l+f+h);e._resizeView(o,u,s,l,[c,f],a.resize)}(e,t,f,n)}(n,t,e)})),function(e){return e&&"legend-entry"!==e.mark.role}(e.mark.group)?t.reflow():t}});var oT=Ds(wu),uT=oT.right,sT=oT.left,cT=(Ds(Tu).center,uT);function lT(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function fT(e,t){switch(arguments.length){case 0:break;case 1:"function"===typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"===typeof t?this.interpolator(t):this.range(t)}return this}var dT=Symbol("implicit");function hT(){var e=new Map,t=[],n=[],r=dT;function a(a){var i=a+"",o=e.get(i);if(!o){if(r!==dT)return r;e.set(i,o=t.push(a))}return n[(o-1)%n.length]}return a.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Map;var r,i=(0,Zt.Z)(n);try{for(i.s();!(r=i.n()).done;){var o=r.value,u=o+"";e.has(u)||e.set(u,t.push(o))}}catch(s){i.e(s)}finally{i.f()}return a},a.range=function(e){return arguments.length?(n=Array.from(e),a):n.slice()},a.unknown=function(e){return arguments.length?(r=e,a):r},a.copy=function(){return hT(t,n).unknown(r)},lT.apply(a,arguments),a}var pT=n(1848);function vT(e,t,n,r){var a,i=Lc(e,t,n);switch((r=(0,pT.formatSpecifier)(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(a=(0,pT.precisionPrefix)(i,o))||(r.precision=a),(0,pT.formatPrefix)(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=(0,pT.precisionRound)(i,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=(0,pT.precisionFixed)(i))||(r.precision=a-2*("%"===r.type))}return(0,pT.format)(r)}function gT(e,t,n,r,a){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*n+(1+3*e+3*i-3*o)*r+o*a)/6}function mT(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),a=e[r],i=e[r+1],o=r>0?e[r-1]:2*a-i,u=r<t-1?e[r+2]:2*i-a;return gT((n-r/t)*t,o,a,i,u)}}function yT(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),a=e[(r+t-1)%t],i=e[r%t],o=e[(r+1)%t],u=e[(r+2)%t];return gT((n-r/t)*t,a,i,o,u)}}var bT=function(e){return function(){return e}};function xT(e,t){return function(n){return e+n*t}}function kT(e,t){var n=t-e;return n?xT(e,n>180||n<-180?n-360*Math.round(n/360):n):bT(isNaN(e)?t:e)}function wT(e){return 1===(e=+e)?_T:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):bT(isNaN(t)?n:t)}}function _T(e,t){var n=t-e;return n?xT(e,n):bT(isNaN(e)?t:e)}var CT=function e(t){var n=wT(t);function r(e,t){var r=n((e=Ky(e)).r,(t=Ky(t)).r),a=n(e.g,t.g),i=n(e.b,t.b),o=_T(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=a(t),e.b=i(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function ST(e){return function(t){var n,r,a=t.length,i=new Array(a),o=new Array(a),u=new Array(a);for(n=0;n<a;++n)r=Ky(t[n]),i[n]=r.r||0,o[n]=r.g||0,u[n]=r.b||0;return i=e(i),o=e(o),u=e(u),r.opacity=1,function(e){return r.r=i(e),r.g=o(e),r.b=u(e),r+""}}}var AT=ST(mT),ET=ST(yT);function TT(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}}function NT(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function DT(e,t){return(NT(t)?TT:FT)(e,t)}function FT(e,t){var n,r=t?t.length:0,a=e?Math.min(r,e.length):0,i=new Array(a),o=new Array(r);for(n=0;n<a;++n)i[n]=zT(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<a;++n)o[n]=i[n](e);return o}}function IT(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function MT(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function OT(e,t){var n,r={},a={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=zT(e[n],t[n]):a[n]=t[n];return function(e){for(n in r)a[n]=r[n](e);return a}}var RT=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ZT=new RegExp(RT.source,"g");function BT(e,t){var n,r,a,i=RT.lastIndex=ZT.lastIndex=0,o=-1,u=[],s=[];for(e+="",t+="";(n=RT.exec(e))&&(r=ZT.exec(t));)(a=r.index)>i&&(a=t.slice(i,a),u[o]?u[o]+=a:u[++o]=a),(n=n[0])===(r=r[0])?u[o]?u[o]+=r:u[++o]=r:(u[++o]=null,s.push({i:o,x:MT(n,r)})),i=ZT.lastIndex;return i<t.length&&(a=t.slice(i),u[o]?u[o]+=a:u[++o]=a),u.length<2?s[0]?function(e){return function(t){return e(t)+""}}(s[0].x):function(e){return function(){return e}}(t):(t=s.length,function(e){for(var n,r=0;r<t;++r)u[(n=s[r]).i]=n.x(e);return u.join("")})}function zT(e,t){var n,r=typeof t;return null==t||"boolean"===r?bT(t):("number"===r?MT:"string"===r?(n=qy(t))?(t=n,CT):BT:t instanceof qy?CT:t instanceof Date?IT:NT(t)?TT:Array.isArray(t)?FT:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?OT:MT)(e,t)}function LT(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function PT(e){return+e}var jT=[0,1];function UT(e){return e}function WT(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function VT(e,t,n){var r=e[0],a=e[1],i=t[0],o=t[1];return a<r?(r=WT(a,r),i=n(o,i)):(r=WT(r,a),i=n(i,o)),function(e){return i(r(e))}}function GT(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),i=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)a[o]=WT(e[o],e[o+1]),i[o]=n(t[o],t[o+1]);return function(t){var n=cT(e,t,1,r)-1;return i[n](a[n](t))}}function qT(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function HT(){var e,t,n,r,a,i,o=jT,u=jT,s=zT,c=UT;function l(){var e=Math.min(o.length,u.length);return c!==UT&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(o[0],o[e-1])),r=e>2?GT:VT,a=i=null,f}function f(t){return null==t||isNaN(t=+t)?n:(a||(a=r(o.map(e),u,s)))(e(c(t)))}return f.invert=function(n){return c(t((i||(i=r(u,o.map(e),MT)))(n)))},f.domain=function(e){return arguments.length?(o=Array.from(e,PT),l()):o.slice()},f.range=function(e){return arguments.length?(u=Array.from(e),l()):u.slice()},f.rangeRound=function(e){return u=Array.from(e),s=LT,l()},f.clamp=function(e){return arguments.length?(c=!!e||UT,l()):c!==UT},f.interpolate=function(e){return arguments.length?(s=e,l()):s},f.unknown=function(e){return arguments.length?(n=e,f):n},function(n,r){return e=n,t=r,l()}}function XT(){return HT()(UT,UT)}function YT(e){var t=e.domain;return e.ticks=function(e){var n=t();return Bc(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return vT(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,a,i=t(),o=0,u=i.length-1,s=i[o],c=i[u],l=10;for(c<s&&(a=s,s=c,c=a,a=o,o=u,u=a);l-- >0;){if((a=zc(s,c,n))===r)return i[o]=s,i[u]=c,t(i);if(a>0)s=Math.floor(s/a)*a,c=Math.ceil(c/a)*a;else{if(!(a<0))break;s=Math.ceil(s*a)/a,c=Math.floor(c*a)/a}r=a}return e},e}function KT(e,t){var n,r=0,a=(e=e.slice()).length-1,i=e[r],o=e[a];return o<i&&(n=r,r=a,a=n,n=i,i=o,o=n),e[r]=t.floor(i),e[a]=t.ceil(o),e}function $T(e){return Math.log(e)}function QT(e){return Math.exp(e)}function JT(e){return-Math.log(-e)}function eN(e){return-Math.exp(-e)}function tN(e){return isFinite(e)?+("1e"+e):e<0?0:e}function nN(e){return function(t){return-e(-t)}}function rN(e){var t,n,r=e($T,QT),a=r.domain,i=10;function o(){return t=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(i),n=function(e){return 10===e?tN:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(i),a()[0]<0?(t=nN(t),n=nN(n),e(JT,eN)):e($T,QT),r}return r.base=function(e){return arguments.length?(i=+e,o()):i},r.domain=function(e){return arguments.length?(a(e),o()):a()},r.ticks=function(e){var r,o=a(),u=o[0],s=o[o.length-1];(r=s<u)&&(d=u,u=s,s=d);var c,l,f,d=t(u),h=t(s),p=null==e?10:+e,v=[];if(!(i%1)&&h-d<p){if(d=Math.floor(d),h=Math.ceil(h),u>0){for(;d<=h;++d)for(l=1,c=n(d);l<i;++l)if(!((f=c*l)<u)){if(f>s)break;v.push(f)}}else for(;d<=h;++d)for(l=i-1,c=n(d);l>=1;--l)if(!((f=c*l)<u)){if(f>s)break;v.push(f)}2*v.length<p&&(v=Bc(u,s,p))}else v=Bc(d,h,Math.min(h-d,p)).map(n);return r?v.reverse():v},r.tickFormat=function(e,a){if(null==a&&(a=10===i?".0e":","),"function"!==typeof a&&(a=(0,pT.format)(a)),e===1/0)return a;null==e&&(e=10);var o=Math.max(1,i*e/r.ticks().length);return function(e){var r=e/n(Math.round(t(e)));return r*i<i-.5&&(r*=i),r<=o?a(e):""}},r.nice=function(){return a(KT(a(),{floor:function(e){return n(Math.floor(t(e)))},ceil:function(e){return n(Math.ceil(t(e)))}}))},r}function aN(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function iN(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function oN(e){return e<0?-e*e:e*e}function uN(e){var t=e(UT,UT),n=1;function r(){return 1===n?e(UT,UT):.5===n?e(iN,oN):e(aN(n),aN(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,r()):n},YT(t)}function sN(){var e=uN(HT());return e.copy=function(){return qT(e,sN()).exponent(e.exponent())},lT.apply(e,arguments),e}function cN(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function lN(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function fN(e){var t=1,n=e(cN(t),lN(t));return n.constant=function(n){return arguments.length?e(cN(t=+n),lN(t)):t},YT(n)}function dN(e,t,n,r,a,i){var o=[[gc,1,Os],[gc,5,5e3],[gc,15,15e3],[gc,30,3e4],[i,1,Rs],[i,5,3e5],[i,15,9e5],[i,30,18e5],[a,1,Zs],[a,3,108e5],[a,6,216e5],[a,12,432e5],[r,1,Bs],[r,2,1728e5],[n,1,zs],[t,1,Ls],[t,3,7776e6],[e,1,Ps]];function u(t,n,r){var a=Math.abs(n-t)/r,i=Ds((function(e){return(0,ku.Z)(e,3)[2]})).right(o,a);if(i===o.length)return e.every(Lc(t/Ps,n/Ps,r));if(0===i)return yc.every(Math.max(Lc(t,n,r),1));var u=(0,ku.Z)(o[a/o[i-1][2]<o[i][2]/a?i-1:i],2),s=u[0],c=u[1];return s.every(c)}return[function(e,t,n){var r=t<e;if(r){var a=[t,e];e=a[0],t=a[1]}var i=n&&"function"===typeof n.range?n:u(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},u]}var hN=dN(Ec,Nc,ec,Qs,Fc,Mc),pN=(0,ku.Z)(hN,2),vN=pN[0],gN=pN[1],mN=dN(sc,lc,Vs,Us,dc,pc),yN=(0,ku.Z)(mN,2),bN=yN[0],xN=yN[1];function kN(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function wN(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function _N(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function CN(e){var t=e.dateTime,n=e.date,r=e.time,a=e.periods,i=e.days,o=e.shortDays,u=e.months,s=e.shortMonths,c=ZN(a),l=BN(a),f=ZN(i),d=BN(i),h=ZN(o),p=BN(o),v=ZN(u),g=BN(u),m=ZN(s),y=BN(s),b={a:function(e){return o[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return s[e.getMonth()]},B:function(e){return u[e.getMonth()]},c:null,d:aD,e:aD,f:cD,g:xD,G:wD,H:iD,I:oD,j:uD,L:sD,m:lD,M:fD,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:GD,s:qD,S:dD,u:hD,U:pD,V:gD,w:mD,W:yD,x:null,X:null,y:bD,Y:kD,Z:_D,"%":VD},x={a:function(e){return o[e.getUTCDay()]},A:function(e){return i[e.getUTCDay()]},b:function(e){return s[e.getUTCMonth()]},B:function(e){return u[e.getUTCMonth()]},c:null,d:CD,e:CD,f:ND,g:PD,G:UD,H:SD,I:AD,j:ED,L:TD,m:DD,M:FD,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:GD,s:qD,S:ID,u:MD,U:OD,V:ZD,w:BD,W:zD,x:null,X:null,y:LD,Y:jD,Z:WD,"%":VD},k={a:function(e,t,n){var r=h.exec(t.slice(n));return r?(e.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=y.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=v.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return C(e,t,n,r)},d:XN,e:XN,f:eD,g:VN,G:WN,H:KN,I:KN,j:YN,L:JN,m:HN,M:$N,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=l.get(r[0].toLowerCase()),n+r[0].length):-1},q:qN,Q:nD,s:rD,S:QN,u:LN,U:PN,V:jN,w:zN,W:UN,x:function(e,t,r){return C(e,n,t,r)},X:function(e,t,n){return C(e,r,t,n)},y:VN,Y:WN,Z:GN,"%":tD};function w(e,t){return function(n){var r,a,i,o=[],u=-1,s=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++u<c;)37===e.charCodeAt(u)&&(o.push(e.slice(s,u)),null!=(a=DN[r=e.charAt(++u)])?r=e.charAt(++u):a="e"===r?" ":"0",(i=t[r])&&(r=i(n,a)),o.push(r),s=u+1);return o.push(e.slice(s,u)),o.join("")}}function _(e,t){return function(n){var r,a,i=_N(1900,void 0,1);if(C(i,e,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("s"in i)return new Date(1e3*i.s+("L"in i?i.L:0));if(t&&!("Z"in i)&&(i.Z=0),"p"in i&&(i.H=i.H%12+12*i.p),void 0===i.m&&(i.m="q"in i?i.q:0),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(a=(r=wN(_N(i.y,0,1))).getUTCDay(),r=a>4||0===a?tc.ceil(r):tc(r),r=Qs.offset(r,7*(i.V-1)),i.y=r.getUTCFullYear(),i.m=r.getUTCMonth(),i.d=r.getUTCDate()+(i.w+6)%7):(a=(r=kN(_N(i.y,0,1))).getDay(),r=a>4||0===a?Gs.ceil(r):Gs(r),r=Us.offset(r,7*(i.V-1)),i.y=r.getFullYear(),i.m=r.getMonth(),i.d=r.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),a="Z"in i?wN(_N(i.y,0,1)).getUTCDay():kN(_N(i.y,0,1)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(a+5)%7:i.w+7*i.U-(a+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,wN(i)):kN(i)}}function C(e,t,n,r){for(var a,i,o=0,u=t.length,s=n.length;o<u;){if(r>=s)return-1;if(37===(a=t.charCodeAt(o++))){if(a=t.charAt(o++),!(i=k[a in DN?t.charAt(o++):a])||(r=i(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return b.x=w(n,b),b.X=w(r,b),b.c=w(t,b),x.x=w(n,x),x.X=w(r,x),x.c=w(t,x),{format:function(e){var t=w(e+="",b);return t.toString=function(){return e},t},parse:function(e){var t=_(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=w(e+="",x);return t.toString=function(){return e},t},utcParse:function(e){var t=_(e+="",!0);return t.toString=function(){return e},t}}}var SN,AN,EN,TN,NN,DN={"-":"",_:" ",0:"0"},FN=/^\s*\d+/,IN=/^%/,MN=/[\\^$*+?|[\]().{}]/g;function ON(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",i=a.length;return r+(i<n?new Array(n-i+1).join(t)+a:a)}function RN(e){return e.replace(MN,"\\$&")}function ZN(e){return new RegExp("^(?:"+e.map(RN).join("|")+")","i")}function BN(e){return new Map(e.map((function(e,t){return[e.toLowerCase(),t]})))}function zN(e,t,n){var r=FN.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function LN(e,t,n){var r=FN.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function PN(e,t,n){var r=FN.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function jN(e,t,n){var r=FN.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function UN(e,t,n){var r=FN.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function WN(e,t,n){var r=FN.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function VN(e,t,n){var r=FN.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function GN(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function qN(e,t,n){var r=FN.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function HN(e,t,n){var r=FN.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function XN(e,t,n){var r=FN.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function YN(e,t,n){var r=FN.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function KN(e,t,n){var r=FN.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function $N(e,t,n){var r=FN.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function QN(e,t,n){var r=FN.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function JN(e,t,n){var r=FN.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function eD(e,t,n){var r=FN.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function tD(e,t,n){var r=IN.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function nD(e,t,n){var r=FN.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function rD(e,t,n){var r=FN.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function aD(e,t){return ON(e.getDate(),t,2)}function iD(e,t){return ON(e.getHours(),t,2)}function oD(e,t){return ON(e.getHours()%12||12,t,2)}function uD(e,t){return ON(1+Us.count(sc(e),e),t,3)}function sD(e,t){return ON(e.getMilliseconds(),t,3)}function cD(e,t){return sD(e,t)+"000"}function lD(e,t){return ON(e.getMonth()+1,t,2)}function fD(e,t){return ON(e.getMinutes(),t,2)}function dD(e,t){return ON(e.getSeconds(),t,2)}function hD(e){var t=e.getDay();return 0===t?7:t}function pD(e,t){return ON(Vs.count(sc(e)-1,e),t,2)}function vD(e){var t=e.getDay();return t>=4||0===t?Xs(e):Xs.ceil(e)}function gD(e,t){return e=vD(e),ON(Xs.count(sc(e),e)+(4===sc(e).getDay()),t,2)}function mD(e){return e.getDay()}function yD(e,t){return ON(Gs.count(sc(e)-1,e),t,2)}function bD(e,t){return ON(e.getFullYear()%100,t,2)}function xD(e,t){return ON((e=vD(e)).getFullYear()%100,t,2)}function kD(e,t){return ON(e.getFullYear()%1e4,t,4)}function wD(e,t){var n=e.getDay();return ON((e=n>=4||0===n?Xs(e):Xs.ceil(e)).getFullYear()%1e4,t,4)}function _D(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ON(t/60|0,"0",2)+ON(t%60,"0",2)}function CD(e,t){return ON(e.getUTCDate(),t,2)}function SD(e,t){return ON(e.getUTCHours(),t,2)}function AD(e,t){return ON(e.getUTCHours()%12||12,t,2)}function ED(e,t){return ON(1+Qs.count(Ec(e),e),t,3)}function TD(e,t){return ON(e.getUTCMilliseconds(),t,3)}function ND(e,t){return TD(e,t)+"000"}function DD(e,t){return ON(e.getUTCMonth()+1,t,2)}function FD(e,t){return ON(e.getUTCMinutes(),t,2)}function ID(e,t){return ON(e.getUTCSeconds(),t,2)}function MD(e){var t=e.getUTCDay();return 0===t?7:t}function OD(e,t){return ON(ec.count(Ec(e)-1,e),t,2)}function RD(e){var t=e.getUTCDay();return t>=4||0===t?ac(e):ac.ceil(e)}function ZD(e,t){return e=RD(e),ON(ac.count(Ec(e),e)+(4===Ec(e).getUTCDay()),t,2)}function BD(e){return e.getUTCDay()}function zD(e,t){return ON(tc.count(Ec(e)-1,e),t,2)}function LD(e,t){return ON(e.getUTCFullYear()%100,t,2)}function PD(e,t){return ON((e=RD(e)).getUTCFullYear()%100,t,2)}function jD(e,t){return ON(e.getUTCFullYear()%1e4,t,4)}function UD(e,t){var n=e.getUTCDay();return ON((e=n>=4||0===n?ac(e):ac.ceil(e)).getUTCFullYear()%1e4,t,4)}function WD(){return"+0000"}function VD(){return"%"}function GD(e){return+e}function qD(e){return Math.floor(+e/1e3)}function HD(e){return new Date(e)}function XD(e){return e instanceof Date?+e:+new Date(+e)}function YD(e,t,n,r,a,i,o,u,s,c){var l=XT(),f=l.invert,d=l.domain,h=c(".%L"),p=c(":%S"),v=c("%I:%M"),g=c("%I %p"),m=c("%a %d"),y=c("%b %d"),b=c("%B"),x=c("%Y");function k(e){return(s(e)<e?h:u(e)<e?p:o(e)<e?v:i(e)<e?g:r(e)<e?a(e)<e?m:y:n(e)<e?b:x)(e)}return l.invert=function(e){return new Date(f(e))},l.domain=function(e){return arguments.length?d(Array.from(e,XD)):d().map(HD)},l.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},l.tickFormat=function(e,t){return null==t?k:c(t)},l.nice=function(e){var n=d();return e&&"function"===typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(KT(n,e)):l},l.copy=function(){return qT(l,YD(e,t,n,r,a,i,o,u,s,c))},l}function KD(){var e,t,n,r,a,i=0,o=1,u=UT,s=!1;function c(t){return null==t||isNaN(t=+t)?a:u(0===n?.5:(t=(r(t)-e)*n,s?Math.max(0,Math.min(1,t)):t))}function l(e){return function(t){var n,r,a;return arguments.length?(r=(n=(0,ku.Z)(t,2))[0],a=n[1],u=e(r,a),c):[u(0),u(1)]}}return c.domain=function(a){var u;return arguments.length?(u=(0,ku.Z)(a,2),i=u[0],o=u[1],e=r(i=+i),t=r(o=+o),n=e===t?0:1/(t-e),c):[i,o]},c.clamp=function(e){return arguments.length?(s=!!e,c):s},c.interpolator=function(e){return arguments.length?(u=e,c):u},c.range=l(zT),c.rangeRound=l(LT),c.unknown=function(e){return arguments.length?(a=e,c):a},function(a){return r=a,e=a(i),t=a(o),n=e===t?0:1/(t-e),c}}function $D(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function QD(){var e=YT(KD()(UT));return e.copy=function(){return $D(e,QD())},fT.apply(e,arguments)}function JD(){var e=uN(KD());return e.copy=function(){return $D(e,JD()).exponent(e.exponent())},fT.apply(e,arguments)}function eF(e,t){void 0===t&&(t=e,e=zT);for(var n=0,r=t.length-1,a=t[0],i=new Array(r<0?0:r);n<r;)i[n]=e(a,a=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return i[t](e-t)}}function tF(){var e,t,n,r,a,i,o,u=0,s=.5,c=1,l=1,f=UT,d=!1;function h(e){return isNaN(e=+e)?o:(e=.5+((e=+i(e))-t)*(l*e<l*t?r:a),f(d?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,r,a,i;return arguments.length?(r=(n=(0,ku.Z)(t,3))[0],a=n[1],i=n[2],f=eF(e,[r,a,i]),h):[f(0),f(.5),f(1)]}}return h.domain=function(o){var f;return arguments.length?(f=(0,ku.Z)(o,3),u=f[0],s=f[1],c=f[2],e=i(u=+u),t=i(s=+s),n=i(c=+c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),l=t<e?-1:1,h):[u,s,c]},h.clamp=function(e){return arguments.length?(d=!!e,h):d},h.interpolator=function(e){return arguments.length?(f=e,h):f},h.range=p(zT),h.rangeRound=p(LT),h.unknown=function(e){return arguments.length?(o=e,h):o},function(o){return i=o,e=o(u),t=o(s),n=o(c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),l=t<e?-1:1,h}}function nF(){var e=uN(tF());return e.copy=function(){return $D(e,nF()).exponent(e.exponent())},fT.apply(e,arguments)}function rF(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function aF(e,t){var n=kT(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}}!function(e){SN=CN(e),AN=SN.format,EN=SN.parse,TN=SN.utcFormat,NN=SN.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var iF,oF=180/Math.PI,uF={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function sF(e,t,n,r,a,i){var o,u,s;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(s=e*n+t*r)&&(n-=e*s,r-=t*s),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,s/=u),e*r<t*n&&(e=-e,t=-t,s=-s,o=-o),{translateX:a,translateY:i,rotate:Math.atan2(t,e)*oF,skewX:Math.atan(s)*oF,scaleX:o,scaleY:u}}function cF(e,t,n,r){function a(e){return e.length?e.pop()+" ":""}return function(i,o){var u=[],s=[];return i=e(i),o=e(o),function(e,r,a,i,o,u){if(e!==a||r!==i){var s=o.push("translate(",null,t,null,n);u.push({i:s-4,x:MT(e,a)},{i:s-2,x:MT(r,i)})}else(a||i)&&o.push("translate("+a+t+i+n)}(i.translateX,i.translateY,o.translateX,o.translateY,u,s),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(a(n)+"rotate(",null,r)-2,x:MT(e,t)})):t&&n.push(a(n)+"rotate("+t+r)}(i.rotate,o.rotate,u,s),function(e,t,n,i){e!==t?i.push({i:n.push(a(n)+"skewX(",null,r)-2,x:MT(e,t)}):t&&n.push(a(n)+"skewX("+t+r)}(i.skewX,o.skewX,u,s),function(e,t,n,r,i,o){if(e!==n||t!==r){var u=i.push(a(i)+"scale(",null,",",null,")");o.push({i:u-4,x:MT(e,n)},{i:u-2,x:MT(t,r)})}else 1===n&&1===r||i.push(a(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,o.scaleX,o.scaleY,u,s),i=o=null,function(e){for(var t,n=-1,r=s.length;++n<r;)u[(t=s[n]).i]=t.x(e);return u.join("")}}}var lF=cF((function(e){var t=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?uF:sF(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),fF=cF((function(e){return null==e?uF:(iF||(iF=document.createElementNS("http://www.w3.org/2000/svg","g")),iF.setAttribute("transform",e),(e=iF.transform.baseVal.consolidate())?sF((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):uF)}),", ",")",")");function dF(e){return((e=Math.exp(e))+1/e)/2}var hF=function e(t,n,r){function a(e,a){var i,o,u=e[0],s=e[1],c=e[2],l=a[0],f=a[1],d=a[2],h=l-u,p=f-s,v=h*h+p*p;if(v<1e-12)o=Math.log(d/c)/t,i=function(e){return[u+e*h,s+e*p,c*Math.exp(t*e*o)]};else{var g=Math.sqrt(v),m=(d*d-c*c+r*v)/(2*c*n*g),y=(d*d-c*c-r*v)/(2*d*n*g),b=Math.log(Math.sqrt(m*m+1)-m),x=Math.log(Math.sqrt(y*y+1)-y);o=(x-b)/t,i=function(e){var r=e*o,a=dF(b),i=c/(n*g)*(a*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*r+b)-function(e){return((e=Math.exp(e))-1/e)/2}(b));return[u+i*h,s+i*p,c*a/dF(t*r+b)]}}return i.duration=1e3*o*t/Math.SQRT2,i}return a.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},a}(Math.SQRT2,2,4);function pF(e){return function(t,n){var r=e((t=rb(t)).h,(n=rb(n)).h),a=_T(t.s,n.s),i=_T(t.l,n.l),o=_T(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=a(e),t.l=i(e),t.opacity=o(e),t+""}}}var vF=pF(kT),gF=pF(_T);function mF(e,t){var n=_T((e=uk(e)).l,(t=uk(t)).l),r=_T(e.a,t.a),a=_T(e.b,t.b),i=_T(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=a(t),e.opacity=i(t),e+""}}function yF(e){return function(t,n){var r=e((t=pk(t)).h,(n=pk(n)).h),a=_T(t.c,n.c),i=_T(t.l,n.l),o=_T(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=a(e),t.l=i(e),t.opacity=o(e),t+""}}}var bF=yF(kT),xF=yF(_T);function kF(e){return function t(n){function r(t,r){var a=e((t=Dk(t)).h,(r=Dk(r)).h),i=_T(t.s,r.s),o=_T(t.l,r.l),u=_T(t.opacity,r.opacity);return function(e){return t.h=a(e),t.s=i(e),t.l=o(Math.pow(e,n)),t.opacity=u(e),t+""}}return n=+n,r.gamma=t,r}(1)}var wF,_F,CF=kF(kT),SF=kF(_T);function AF(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}function EF(e,t,n){var r=e-t+2*n;return e?r>0?r:1:0}var TF="linear",NF="log",DF="pow",FF="sqrt",IF="symlog",MF="time",OF="utc",RF="sequential",ZF="diverging",BF="quantile",zF="quantize",LF="threshold",PF="ordinal",jF="point",UF="band",WF="bin-ordinal",VF="continuous",GF="discrete",qF="discretizing",HF="interpolating",XF="temporal";function YF(){var e,t,n=hT().unknown(void 0),r=n.domain,a=n.range,i=[0,1],o=!1,u=0,s=0,c=.5;function l(){var n=r().length,l=i[1]<i[0],f=i[1-l],d=EF(n,u,s),h=i[l-0];e=(f-h)/(d||1),o&&(e=Math.floor(e)),h+=(f-h-e*(n-u))*c,t=e*(1-u),o&&(h=Math.round(h),t=Math.round(t));var p=Ns(n).map((function(t){return h+e*t}));return a(l?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),l()):r()},n.range=function(e){return arguments.length?(i=[+e[0],+e[1]],l()):i.slice()},n.rangeRound=function(e){return i=[+e[0],+e[1]],o=!0,l()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(o=!!e,l()):o},n.padding=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),u=s,l()):u},n.paddingInner=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),l()):u},n.paddingOuter=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),l()):s},n.align=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),l()):c},n.invertRange=function(e){if(null!=e[0]&&null!=e[1]){var n,o,u,s=i[1]<i[0],c=s?a().reverse():a(),l=c.length-1,f=+e[0],d=+e[1];if(f===f&&d===d&&(d<f&&(u=f,f=d,d=u),!(d<c[0]||f>i[1-s])))return n=Math.max(0,uT(c,f)-1),o=f===d?n:uT(c,d)-1,f-c[n]>t+1e-10&&++n,s&&(u=n,n=l-o,o=l-u),n>o?void 0:r().slice(n,o+1)}},n.invert=function(e){var t=n.invertRange([e,e]);return t?t[0]:t},n.copy=function(){return YF().domain(r()).range(i).round(o).paddingInner(u).paddingOuter(s).align(c)},l()}function KF(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return KF(t())},e}var $F=Array.prototype.map;function QF(e){return $F.call(e,Fe)}var JF=Array.prototype.slice;var eI={};function tI(e,t,n){var r=function(){var n=t();return n.invertRange||(n.invertRange=n.invert?function(e){return function(t){var n,r=t[0],a=t[1];return a<r&&(n=r,r=a,a=n),[e.invert(r),e.invert(a)]}}(n):n.invertExtent?function(e){return function(t){var n,r,a,i,o=e.range(),u=t[0],s=t[1],c=-1;for(s<u&&(r=u,u=s,s=r),a=0,i=o.length;a<i;++a)o[a]>=u&&o[a]<=s&&(c<0&&(c=a),n=a);if(!(c<0))return u=e.invertExtent(o[c]),s=e.invertExtent(o[n]),[void 0===u[0]?u[1]:u[0],void 0===s[1]?s[0]:s[1]]}}(n):void 0),n.type=e,n};return r.metadata=Mt(Ye(n)),r}function nI(e,t,n){return arguments.length>1?(eI[e]=tI(e,t,n),this):rI(e)?eI[e]:void 0}function rI(e){return ct(eI,e)}function aI(e,t){var n=eI[e];return n&&n.metadata[t]}function iI(e){return aI(e,VF)}function oI(e){return aI(e,GF)}function uI(e){return aI(e,qF)}function sI(e){return aI(e,NF)}function cI(e){return aI(e,HF)}function lI(e){return aI(e,BF)}nI("identity",(function e(t){var n;function r(e){return null==e||isNaN(e=+e)?n:e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=Array.from(e,PT),r):t.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,PT):[0,1],YT(r)})),nI(TF,(function e(){var t=XT();return t.copy=function(){return qT(t,e())},lT.apply(t,arguments),YT(t)}),VF),nI(NF,(function e(){var t=rN(HT()).domain([1,10]);return t.copy=function(){return qT(t,e()).base(t.base())},lT.apply(t,arguments),t}),[VF,NF]),nI(DF,sN,VF),nI(FF,(function(){return sN.apply(null,arguments).exponent(.5)}),VF),nI(IF,(function e(){var t=fN(HT());return t.copy=function(){return qT(t,e()).constant(t.constant())},lT.apply(t,arguments)}),VF),nI(MF,(function(){return lT.apply(YD(bN,xN,sc,lc,Vs,Us,dc,pc,gc,AN).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[VF,XF]),nI(OF,(function(){return lT.apply(YD(vN,gN,Ec,Nc,ec,Qs,Fc,Mc,gc,TN).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[VF,XF]),nI(RF,QD,[VF,HF]),nI("".concat(RF,"-").concat(TF),QD,[VF,HF]),nI("".concat(RF,"-").concat(NF),(function e(){var t=rN(KD()).domain([1,10]);return t.copy=function(){return $D(t,e()).base(t.base())},fT.apply(t,arguments)}),[VF,HF,NF]),nI("".concat(RF,"-").concat(DF),JD,[VF,HF]),nI("".concat(RF,"-").concat(FF),(function(){return JD.apply(null,arguments).exponent(.5)}),[VF,HF]),nI("".concat(RF,"-").concat(IF),(function e(){var t=fN(KD());return t.copy=function(){return $D(t,e()).constant(t.constant())},fT.apply(t,arguments)}),[VF,HF]),nI("".concat(ZF,"-").concat(TF),(function e(){var t=YT(tF()(UT));return t.copy=function(){return $D(t,e())},fT.apply(t,arguments)}),[VF,HF]),nI("".concat(ZF,"-").concat(NF),(function e(){var t=rN(tF()).domain([.1,1,10]);return t.copy=function(){return $D(t,e()).base(t.base())},fT.apply(t,arguments)}),[VF,HF,NF]),nI("".concat(ZF,"-").concat(DF),nF,[VF,HF]),nI("".concat(ZF,"-").concat(FF),(function(){return nF.apply(null,arguments).exponent(.5)}),[VF,HF]),nI("".concat(ZF,"-").concat(IF),(function e(){var t=fN(tF());return t.copy=function(){return $D(t,e()).constant(t.constant())},fT.apply(t,arguments)}),[VF,HF]),nI(BF,(function e(){var t,n=[],r=[],a=[];function i(){var e=0,t=Math.max(1,r.length);for(a=new Array(t-1);++e<t;)a[e-1]=Fu(n,e/t);return o}function o(e){return null==e||isNaN(e=+e)?t:r[cT(a,e)]}return o.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?a[t-1]:n[0],t<a.length?a[t]:n[n.length-1]]},o.domain=function(e){if(!arguments.length)return n.slice();n=[];var t,r=(0,Zt.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;null==a||isNaN(a=+a)||n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n.sort(wu),i()},o.range=function(e){return arguments.length?(r=Array.from(e),i()):r.slice()},o.unknown=function(e){return arguments.length?(t=e,o):t},o.quantiles=function(){return a.slice()},o.copy=function(){return e().domain(n).range(r).unknown(t)},lT.apply(o,arguments)}),[qF,BF]),nI(zF,(function e(){var t,n=0,r=1,a=1,i=[.5],o=[0,1];function u(e){return null!=e&&e<=e?o[cT(i,e,0,a)]:t}function s(){var e=-1;for(i=new Array(a);++e<a;)i[e]=((e+1)*r-(e-a)*n)/(a+1);return u}return u.domain=function(e){var t;return arguments.length?(t=(0,ku.Z)(e,2),n=t[0],r=t[1],n=+n,r=+r,s()):[n,r]},u.range=function(e){return arguments.length?(a=(o=Array.from(e)).length-1,s()):o.slice()},u.invertExtent=function(e){var t=o.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,i[0]]:t>=a?[i[a-1],r]:[i[t-1],i[t]]},u.unknown=function(e){return arguments.length?(t=e,u):u},u.thresholds=function(){return i.slice()},u.copy=function(){return e().domain([n,r]).range(o).unknown(t)},lT.apply(YT(u),arguments)}),qF),nI(LF,(function e(){var t,n=[.5],r=[0,1],a=1;function i(e){return null!=e&&e<=e?r[cT(n,e,0,a)]:t}return i.domain=function(e){return arguments.length?(n=Array.from(e),a=Math.min(n.length,r.length-1),i):n.slice()},i.range=function(e){return arguments.length?(r=Array.from(e),a=Math.min(n.length,r.length-1),i):r.slice()},i.invertExtent=function(e){var t=r.indexOf(e);return[n[t-1],n[t]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return e().domain(n).range(r).unknown(t)},lT.apply(i,arguments)}),qF),nI(WF,(function e(){var t=[],n=[];function r(e){return null==e||e!==e?void 0:n[(cT(t,e)-1)%n.length]}return r.domain=function(e){return arguments.length?(t=QF(e),r):t.slice()},r.range=function(e){return arguments.length?(n=JF.call(e),r):n.slice()},r.tickFormat=function(e,n){return vT(t[0],De(t),null==e?10:e,n)},r.copy=function(){return e().domain(r.domain()).range(r.range())},r}),[GF,qF]),nI(PF,hT,GF),nI(UF,YF,GF),nI(jF,(function(){return KF(YF().paddingInner(1))}),GF);var fI=["clamp","base","constant","exponent"];function dI(e,t){var n=t[0],r=De(t)-n;return function(t){return e(n+t*r)}}function hI(e,t,n){return eF(gI(t||"rgb",n),e)}function pI(e,t){for(var n=new Array(t),r=t+1,a=0;a<t;)n[a]=e(++a/r);return n}function vI(e,t,n){var r,a,i,o=n-t;return o&&Number.isFinite(o)?(r=(a=e.type).indexOf("-"),a=r<0?a:a.slice(r+1),i=nI(a)().domain([t,n]).range([0,1]),fI.forEach((function(t){return e[t]?i[t](e[t]()):0})),i):rt(.5)}function gI(e,t){var n=s[function(e){return"interpolate"+e.toLowerCase().split("-").map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function mI(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}function yI(e,t){for(var n in e)xI(n,t(e[n]))}var bI={};function xI(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(bI[e]=t,this):bI[e]}yI({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},mI),yI({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(function(e){return hI(mI(e))}));var kI="symbol",wI=function(e){return Ce(e)?e.map((function(e){return String(e)})):String(e)},_I=function(e,t){return e[1]-t[1]},CI=function(e,t){return t[1]-e[1]};function SI(e,t,n){var r;return yt(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),null!=n&&(t=Math.min(t,Math.floor(Et(e.domain())/n||1)))),Se(t)&&(r=t.step,t=t.interval),xt(t)&&(t=e.type===MF?Al(t):e.type==OF?El(t):se("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function AI(e,t,n){var r=e.range(),a=r[0],i=De(r),o=_I;if(a>i&&(r=i,i=a,a=r,o=CI),a=Math.floor(a),i=Math.ceil(i),t=t.map((function(t){return[t,e(t)]})).filter((function(e){return a<=e[1]&&e[1]<=i})).sort(o).map((function(e){return e[0]})),n>0&&t.length>1){for(var u=[t[0],De(t)];t.length>n&&t.length>=3;)t=t.filter((function(e,t){return!(t%2)}));t.length<3&&(t=u)}return t}function EI(e,t){return e.bins?AI(e,e.bins):e.ticks?e.ticks(t):e.domain()}function TI(e,t,n,r,a,i){var o=t.type,u=wI;if(o===MF||a===MF)u=e.timeFormat(r);else if(o===OF||a===OF)u=e.utcFormat(r);else if(sI(o)){var s=e.formatFloat(r);if(i||t.bins)u=s;else{var c=NI(t,n,!1);u=function(e){return c(e)?s(e):""}}}else if(t.tickFormat){var l=t.domain();u=e.formatSpan(l[0],l[l.length-1],n,r)}else r&&(u=e.format(r));return u}function NI(e,t,n){var r=EI(e,t),a=e.base(),i=Math.log(a),o=Math.max(1,a*t/r.length),u=function(e){var t=e/Math.pow(a,Math.round(Math.log(e)/i));return t*a<a-.5&&(t*=a),t<=o};return n?r.filter(u):u}var DI=(wF={},(0,qn.Z)(wF,BF,"quantiles"),(0,qn.Z)(wF,zF,"thresholds"),(0,qn.Z)(wF,LF,"domain"),wF),FI=(_F={},(0,qn.Z)(_F,BF,"quantiles"),(0,qn.Z)(_F,zF,"domain"),_F);function II(e,t){return e.bins?function(e){var t=e.slice(0,-1);return t.max=De(e),t}(e.bins):e.type===NF?NI(e,t,!0):DI[e.type]?function(e){var t=[-1/0].concat(e);return t.max=1/0,t}(e[DI[e.type]]()):EI(e,t)}function MI(e,t,n,r,a,i,o){var u=FI[t.type]&&i!==MF&&i!==OF?function(e,t,n){var r,a=t[FI[t.type]](),i=a.length,o=i>1?a[1]-a[0]:a[0];for(r=1;r<i;++r)o=Math.min(o,a[r]-a[r-1]);return e.formatSpan(0,o,30,n)}(e,t,a):TI(e,t,n,a,i,o);return r===kI&&function(e){return DI[e.type]||e.bins}(t)?OI(u):"discrete"===r?ZI(u):BI(u)}var OI=function(e){return function(t,n,r){var a=RI(r[n+1],RI(r.max,1/0)),i=zI(t,e),o=zI(a,e);return i&&o?i+" \u2013 "+o:o?"< "+o:"\u2265 "+i}},RI=function(e,t){return null!=e?e:t},ZI=function(e){return function(t,n){return n?e(t):null}},BI=function(e){return function(t){return e(t)}},zI=function(e,t){return Number.isFinite(e)?t(e):null};function LI(e,t,n,r){var a=r||t.type;return xt(n)&&function(e){return aI(e,XF)}(a)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||a!==MF?n||a!==OF?MI(e,t,5,null,n,r,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}function PI(e,t,n){n=n||{};var r=Math.max(3,n.maxlen||7),a=LI(e,t,n.format,n.formatType);if(uI(t.type)){var i=II(t).slice(1).map(a),o=i.length;return"".concat(o," boundar").concat(1===o?"y":"ies",": ").concat(i.join(", "))}if(oI(t.type)){var u=t.domain(),s=u.length,c=s>r?u.slice(0,r-2).map(a).join(", ")+", ending with "+u.slice(-1).map(a):u.map(a).join(", ");return"".concat(s," value").concat(1===s?"":"s",": ").concat(c)}var l=t.domain();return"values from ".concat(a(l[0])," to ").concat(a(De(l)))}function jI(e,t){var n=0;if(void 0===t){var r,a=(0,Zt.Z)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;(i=+i)&&(n+=i)}}catch(l){a.e(l)}finally{a.f()}}else{var o,u=-1,s=(0,Zt.Z)(e);try{for(s.s();!(o=s.n()).done;){var c=o.value;(c=+t(c,++u,e))&&(n+=c)}}catch(l){s.e(l)}finally{s.f()}}return n}function UI(e){mu.call(this,null,e)}function WI(e){mu.call(this,null,e)}function VI(){return Ro({})}function GI(e){mu.call(this,null,e)}function qI(e){mu.call(this,[],e)}ht(UI,mu,{transform:function(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),r=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=this.value,i=e.scale,o=SI(i,null==e.count?e.values?e.values.length:10:e.count,e.minstep),u=e.format||TI(n,i,o,e.formatSpecifier,e.formatType,!!e.values),s=e.values?AI(i,e.values,o):EI(i,o);return a&&(r.rem=a),a=s.map((function(e,t){return Ro({index:t/(s.length-1||1),value:e,label:u(e)})})),e.extra&&a.length&&a.push(Ro({index:-1,extra:{value:a[0].value},label:""})),r.source=a,r.add=a,this.value=a,r}}),ht(WI,mu,{transform:function(e,t){var n=t.dataflow,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=e.item||VI,i=e.key||Mo,o=this.value;return Ce(r.encode)&&(r.encode=null),o&&(e.modified("key")||t.modified(i))&&se("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=function(e){var t=ft().test((function(e){return e.exit}));return t.lookup=function(n){return t.get(e(n))},t}(i)),t.visit(t.ADD,(function(e){var t=i(e),n=o.get(t);n?n.exit?(o.empty--,r.add.push(n)):r.mod.push(n):(n=a(e),o.set(t,n),r.add.push(n)),n.datum=e,n.exit=!1})),t.visit(t.MOD,(function(e){var t=i(e),n=o.get(t);n&&(n.datum=e,r.mod.push(n))})),t.visit(t.REM,(function(e){var t=i(e),n=o.get(t);e!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++o.empty)})),t.changed(t.ADD_MOD)&&r.modifies("datum"),(t.clean()||e.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),r}}),ht(GI,mu,{transform:function(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,a=e.encoders,i=t.encode;if(Ce(i)){if(!n.changed()&&!i.every((function(e){return a[e]})))return t.StopPropagation;i=i[0],n.encode=null}var o="enter"===i,u=a.update||ge,s=a.enter||ge,c=a.exit||ge,l=(i&&!o?a[i]:u)||ge;if(t.changed(t.ADD)&&(t.visit(t.ADD,(function(t){s(t,e),u(t,e)})),n.modifies(s.output),n.modifies(u.output),l!==ge&&l!==u&&(t.visit(t.ADD,(function(t){l(t,e)})),n.modifies(l.output))),t.changed(t.REM)&&c!==ge&&(t.visit(t.REM,(function(t){c(t,e)})),n.modifies(c.output)),o||l!==ge){var f=t.MOD|(e.modified()?t.REFLOW:0);o?(t.visit(f,(function(t){var a=s(t,e)||r;(l(t,e)||a)&&n.mod.push(t)})),n.mod.length&&n.modifies(s.output)):t.visit(f,(function(t){(l(t,e)||r)&&n.mod.push(t)})),n.mod.length&&n.modifies(l.output)}return n.changed()?n:t.StopPropagation}}),ht(qI,mu,{transform:function(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var n,r,a,i,o,u=t.dataflow.locale(),s=t.fork(t.NO_SOURCE|t.NO_FIELDS),c=this.value,l=e.type||kI,f=e.scale,d=+e.limit,h=SI(f,null==e.count?5:e.count,e.minstep),p=!!e.values||l===kI,v=e.format||MI(u,f,h,l,e.formatSpecifier,e.formatType,p),g=e.values||II(f,h);return c&&(s.rem=c),l===kI?(d&&g.length>d?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),c=g.slice(0,d-1),o=!0):c=g,$e(a=e.size)?(e.values||0!==f(c[0])||(c=c.slice(1)),i=c.reduce((function(t,n){return Math.max(t,a(n,e))}),0)):a=rt(i=a||8),c=c.map((function(t,n){return Ro({index:n,label:v(t,n,c),value:t,offset:i,size:a(t,e)})})),o&&(o=g[c.length],c.push(Ro({index:c.length,label:"\u2026".concat(g.length-c.length," entries"),value:o,offset:i,size:a(o,e)})))):"gradient"===l?(n=f.domain(),r=vI(f,n[0],De(n)),g.length<3&&!e.values&&n[0]!==De(n)&&(g=[n[0],De(n)]),c=g.map((function(e,t){return Ro({index:t,label:v(e,t,g),value:e,perc:r(e)})}))):(a=g.length-1,r=function(e){var t=e.domain(),n=t.length-1,r=+t[0],a=+De(t),i=a-r;if(e.type===LF){var o=n?i/n:.1;i=(a+=o)-(r-=o)}return function(e){return(e-r)/i}}(f),c=g.map((function(e,t){return Ro({index:t,label:v(e,t,g),value:e,perc:t?r(e):0,perc2:t===a?1:r(g[t+1])})}))),s.source=c,s.add=c,this.value=c,s}});var HI=function(e){return e.source.x},XI=function(e){return e.source.y},YI=function(e){return e.target.x},KI=function(e){return e.target.y};function $I(e){mu.call(this,{},e)}$I.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},ht($I,mu,{transform:function(e,t){var n=e.sourceX||HI,r=e.sourceY||XI,a=e.targetX||YI,i=e.targetY||KI,o=e.as||"path",u=e.orient||"vertical",s=e.shape||"line",c=tM.get(s+"-"+u)||tM.get(s);return c||se("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,(function(e){e[o]=c(n(e),r(e),a(e),i(e))})),t.reflow(e.modified()).modifies(o)}});var QI=function(e,t,n,r){return"M"+e+","+t+"L"+n+","+r},JI=function(e,t,n,r){var a=n-e,i=r-t,o=Math.sqrt(a*a+i*i)/2;return"M"+e+","+t+"A"+o+","+o+" "+180*Math.atan2(i,a)/Math.PI+" 0 1 "+n+","+r},eM=function(e,t,n,r){var a=n-e,i=r-t,o=.2*(a+i),u=.2*(i-a);return"M"+e+","+t+"C"+(e+o)+","+(t+u)+" "+(n+u)+","+(r-o)+" "+n+","+r},tM=ft({line:QI,"line-radial":function(e,t,n,r){return QI(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},arc:JI,"arc-radial":function(e,t,n,r){return JI(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},curve:eM,"curve-radial":function(e,t,n,r){return eM(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},"orthogonal-horizontal":function(e,t,n,r){return"M"+e+","+t+"V"+r+"H"+n},"orthogonal-vertical":function(e,t,n,r){return"M"+e+","+t+"H"+n+"V"+r},"orthogonal-radial":function(e,t,n,r){var a=Math.cos(e),i=Math.sin(e),o=Math.cos(n),u=Math.sin(n);return"M"+t*a+","+t*i+"A"+t+","+t+" 0 0,"+((Math.abs(n-e)>Math.PI?n<=e:n>e)?1:0)+" "+t*o+","+t*u+"L"+r*o+","+r*u},"diagonal-horizontal":function(e,t,n,r){var a=(e+n)/2;return"M"+e+","+t+"C"+a+","+t+" "+a+","+r+" "+n+","+r},"diagonal-vertical":function(e,t,n,r){var a=(t+r)/2;return"M"+e+","+t+"C"+e+","+a+" "+n+","+a+" "+n+","+r},"diagonal-radial":function(e,t,n,r){var a=Math.cos(e),i=Math.sin(e),o=Math.cos(n),u=Math.sin(n),s=(t+r)/2;return"M"+t*a+","+t*i+"C"+s*a+","+s*i+" "+s*o+","+s*u+" "+r*o+","+r*u}});function nM(e){mu.call(this,null,e)}nM.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},ht(nM,mu,{transform:function(e,t){var n,r,a,i=e.as||["startAngle","endAngle"],o=i[0],u=i[1],s=e.field||pe,c=e.startAngle||0,l=null!=e.endAngle?e.endAngle:2*Math.PI,f=t.source,d=f.map(s),h=d.length,p=c,v=(l-c)/jI(d),g=Ns(h);for(e.sort&&g.sort((function(e,t){return d[e]-d[t]})),n=0;n<h;++n)a=d[g[n]],(r=f[g[n]])[o]=p,r[u]=p+=a*v;return this.value=d,t.reflow(e.modified()).modifies(i)}});function rM(e){return iI(e)&&e!==RF}var aM=Mt(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function iM(e){mu.call(this,null,e),this.modified(!0)}function oM(e,t,n){sI(e)&&(Math.abs(t.reduce((function(e,t){return e+(t<0?-1:t>0?1:0)}),0))!==t.length&&n.warn("Log scale domain includes zero: "+Tt(t)));return t}function uM(e,t,n){return $e(e)&&(t||n)?dI(e,sM(t||[0,1],n)):e}function sM(e,t){return t?e.slice().reverse():e}function cM(e){mu.call(this,null,e)}ht(iM,mu,{transform:function(e,t){var n=t.dataflow,r=this.value,a=function(e){var t,n=e.type,r="";if(n===RF)return RF+"-"+TF;(function(e){var t=e.type;return iI(t)&&t!==MF&&t!==OF&&(e.scheme||e.range&&e.range.length&&e.range.every(xt))})(e)&&(r=2===(t=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0)?RF+"-":3===t?ZF+"-":"");return(r+n||TF).toLowerCase()}(e);for(a in r&&a===r.type||(this.value=r=nI(a)()),e)if(!aM[a]){if("padding"===a&&rM(r.type))continue;$e(r[a])?r[a](e[a]):n.warn("Unsupported scale property: "+a)}return function(e,t,n){var r=e.type,a=t.round||!1,i=t.range;if(null!=t.rangeStep)i=function(e,t,n){e!==UF&&e!==jF&&se("Only band and point scales support rangeStep.");var r=(null!=t.paddingOuter?t.paddingOuter:t.padding)||0,a=e===jF?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0;return[0,t.rangeStep*EF(n,a,r)]}(r,t,n);else if(t.scheme&&(i=function(e,t,n){var r,a=t.schemeExtent;Ce(t.scheme)?r=hI(t.scheme,t.interpolate,t.interpolateGamma):(r=xI(t.scheme.toLowerCase()))||se("Unrecognized scheme name: ".concat(t.scheme));return n=e===LF?n+1:e===WF?n-1:e===BF||e===zF?+t.schemeCount||5:n,cI(e)?uM(r,a,t.reverse):$e(r)?pI(uM(r,a),n):e===PF?r:r.slice(0,n)}(r,t,n),$e(i))){if(e.interpolator)return e.interpolator(i);se("Scale type ".concat(r," does not support interpolating color schemes."))}if(i&&cI(r))return e.interpolator(hI(sM(i,t.reverse),t.interpolate,t.interpolateGamma));i&&t.interpolate&&e.interpolate?e.interpolate(gI(t.interpolate,t.interpolateGamma)):$e(e.round)?e.round(a):$e(e.rangeRound)&&e.interpolate(a?LT:zT);i&&e.range(sM(i,t.reverse))}(r,e,function(e,t,n){var r=t.bins;if(r&&!Ce(r)){var a=e.domain(),i=a[0],o=De(a),u=r.step,s=null==r.start?i:r.start,c=null==r.stop?o:r.stop;u||se("Scale bins parameter missing step property."),s<i&&(s=u*Math.ceil(i/u)),c>o&&(c=u*Math.floor(o/u)),r=Ns(s,c+u/2,u)}r?e.bins=r:e.bins&&delete e.bins;e.type===WF&&(r?t.domain||t.domainRaw||(e.domain(r),n=r.length):e.bins=e.domain());return n}(r,e,function(e,t,n){var r=function(e,t,n){return t?(e.domain(oM(e.type,t,n)),t.length):-1}(e,t.domainRaw,n);if(r>-1)return r;var a,i,o=t.domain,u=e.type,s=t.zero||void 0===t.zero&&function(e){var t=e.type;return!e.bins&&(t===TF||t===DF||t===FF)}(e);if(!o)return 0;rM(u)&&t.padding&&o[0]!==De(o)&&(o=function(e,t,n,r,a,i){var o=Math.abs(De(n)-n[0]),u=o/(o-2*r),s=e===NF?Ve(t,null,u):e===FF?Ge(t,null,u,.5):e===DF?Ge(t,null,u,a||1):e===IF?qe(t,null,u,i||1):We(t,null,u);return t=t.slice(),t[0]=s[0],t[t.length-1]=s[1],t}(u,o,t.range,t.padding,t.exponent,t.constant));if((s||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(a=(o=o.slice()).length-1||1,s&&(o[0]>0&&(o[0]=0),o[a]<0&&(o[a]=0)),null!=t.domainMin&&(o[0]=t.domainMin),null!=t.domainMax&&(o[a]=t.domainMax),null!=t.domainMid)){var c=(i=t.domainMid)>o[a]?a+1:i<o[0]?0:a;c!==a&&n.warn("Scale domainMid exceeds domain min or max.",i),o.splice(c,0,i)}e.domain(oM(u,o,n)),u===PF&&e.unknown(t.domainImplicit?dT:void 0);t.nice&&e.nice&&e.nice(!0!==t.nice&&SI(e,t.nice)||null);return o.length}(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),ht(cM,mu,{transform:function(e,t){var n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(Lo(e.sort)),this.modified(n),t}});var lM="zero",fM="center",dM="normalize",hM=["y0","y1"];function pM(e){mu.call(this,null,e)}function vM(e,t,n,r,a){for(var i,o=(t-e.sum)/2,u=e.length,s=0;s<u;++s)(i=e[s])[r]=o,i[a]=o+=Math.abs(n(i))}function gM(e,t,n,r,a){for(var i,o=1/e.sum,u=0,s=e.length,c=0,l=0;c<s;++c)(i=e[c])[r]=u,i[a]=u=o*(l+=Math.abs(n(i)))}function mM(e,t,n,r,a){for(var i,o,u=0,s=0,c=e.length,l=0;l<c;++l)(i=+n(o=e[l]))<0?(o[r]=s,o[a]=s+=i):(o[r]=u,o[a]=u+=i)}pM.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:lM,values:[lM,fM,dM]},{name:"as",type:"string",array:!0,length:2,default:hM}]},ht(pM,mu,{transform:function(e,t){var n,r,a,i,o=e.as||hM,u=o[0],s=o[1],c=Lo(e.sort),l=e.field||pe,f=e.offset===fM?vM:e.offset===dM?gM:mM;for(n=function(e,t,n,r){var a,i,o,u,s,c,l,f,d,h=[],p=function(e){return e(s)};if(null==t)h.push(e.slice());else for(a={},i=0,o=e.length;i<o;++i)s=e[i],(l=a[c=t.map(p)])||(a[c]=l=[],h.push(l)),l.push(s);for(c=0,d=0,u=h.length;c<u;++c){for(i=0,f=0,o=(l=h[c]).length;i<o;++i)f+=Math.abs(r(l[i]));l.sum=f,f>d&&(d=f),n&&l.sort(n)}return h.max=d,h}(t.source,e.groupby,c,l),r=0,a=n.length,i=n.max;r<a;++r)f(n[r],i,l,u,s);return t.reflow(e.modified()).modifies(o)}});var yM=function(e){return e};function bM(e,t){e&&kM.hasOwnProperty(e.type)&&kM[e.type](e,t)}var xM={Feature:function(e,t){bM(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,a=n.length;++r<a;)bM(n[r].geometry,t)}},kM={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){wM(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)wM(n[r],t,0)},Polygon:function(e,t){_M(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)_M(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,a=n.length;++r<a;)bM(n[r],t)}};function wM(e,t,n){var r,a=-1,i=e.length-n;for(t.lineStart();++a<i;)r=e[a],t.point(r[0],r[1],r[2]);t.lineEnd()}function _M(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)wM(e[n],t,1);t.polygonEnd()}function CM(e,t){e&&xM.hasOwnProperty(e.type)?xM[e.type](e,t):bM(e,t)}var SM=function(){function e(){(0,Jh.Z)(this,e),this._partials=new Float64Array(32),this._n=0}return(0,ep.Z)(e,[{key:"add",value:function(e){for(var t=this._partials,n=0,r=0;r<this._n&&r<32;r++){var a=t[r],i=e+a,o=Math.abs(e)<Math.abs(a)?e-(i-a):a-(i-e);o&&(t[n++]=o),e=i}return t[n]=e,this._n=n+1,this}},{key:"valueOf",value:function(){var e,t,n,r=this._partials,a=this._n,i=0;if(a>0){for(i=r[--a];a>0&&(e=i,!(n=(t=r[--a])-((i=e+t)-e))););a>0&&(n<0&&r[a-1]<0||n>0&&r[a-1]>0)&&(t=2*n)==(e=i+t)-i&&(i=e)}return i}}]),e}();var AM=1e-6,EM=1e-12,TM=Math.PI,NM=TM/2,DM=TM/4,FM=2*TM,IM=180/TM,MM=TM/180,OM=Math.abs,RM=Math.atan,ZM=Math.atan2,BM=Math.cos,zM=Math.ceil,LM=Math.exp,PM=(Math.floor,Math.hypot),jM=Math.log,UM=Math.pow,WM=Math.sin,VM=Math.sign||function(e){return e>0?1:e<0?-1:0},GM=Math.sqrt,qM=Math.tan;function HM(e){return e>1?0:e<-1?TM:Math.acos(e)}function XM(e){return e>1?NM:e<-1?-NM:Math.asin(e)}function YM(){}var KM,$M,QM,JM,eO=new SM,tO=new SM,nO={point:YM,lineStart:YM,lineEnd:YM,polygonStart:function(){nO.lineStart=rO,nO.lineEnd=oO},polygonEnd:function(){nO.lineStart=nO.lineEnd=nO.point=YM,eO.add(OM(tO)),tO=new SM},result:function(){var e=eO/2;return eO=new SM,e}};function rO(){nO.point=aO}function aO(e,t){nO.point=iO,KM=QM=e,$M=JM=t}function iO(e,t){tO.add(JM*e-QM*t),QM=e,JM=t}function oO(){iO(KM,$M)}var uO=nO,sO=1/0,cO=sO,lO=-sO,fO=lO,dO={point:function(e,t){e<sO&&(sO=e);e>lO&&(lO=e);t<cO&&(cO=t);t>fO&&(fO=t)},lineStart:YM,lineEnd:YM,polygonStart:YM,polygonEnd:YM,result:function(){var e=[[sO,cO],[lO,fO]];return lO=fO=-(cO=sO=1/0),e}};var hO,pO,vO,gO,mO=dO,yO=0,bO=0,xO=0,kO=0,wO=0,_O=0,CO=0,SO=0,AO=0,EO={point:TO,lineStart:NO,lineEnd:IO,polygonStart:function(){EO.lineStart=MO,EO.lineEnd=OO},polygonEnd:function(){EO.point=TO,EO.lineStart=NO,EO.lineEnd=IO},result:function(){var e=AO?[CO/AO,SO/AO]:_O?[kO/_O,wO/_O]:xO?[yO/xO,bO/xO]:[NaN,NaN];return yO=bO=xO=kO=wO=_O=CO=SO=AO=0,e}};function TO(e,t){yO+=e,bO+=t,++xO}function NO(){EO.point=DO}function DO(e,t){EO.point=FO,TO(vO=e,gO=t)}function FO(e,t){var n=e-vO,r=t-gO,a=GM(n*n+r*r);kO+=a*(vO+e)/2,wO+=a*(gO+t)/2,_O+=a,TO(vO=e,gO=t)}function IO(){EO.point=TO}function MO(){EO.point=RO}function OO(){ZO(hO,pO)}function RO(e,t){EO.point=ZO,TO(hO=vO=e,pO=gO=t)}function ZO(e,t){var n=e-vO,r=t-gO,a=GM(n*n+r*r);kO+=a*(vO+e)/2,wO+=a*(gO+t)/2,_O+=a,CO+=(a=gO*e-vO*t)*(vO+e),SO+=a*(gO+t),AO+=3*a,TO(vO=e,gO=t)}var BO=EO;function zO(e){this._context=e}zO.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,FM)}},result:YM};var LO,PO,jO,UO,WO,VO=new SM,GO={point:YM,lineStart:function(){GO.point=qO},lineEnd:function(){LO&&HO(PO,jO),GO.point=YM},polygonStart:function(){LO=!0},polygonEnd:function(){LO=null},result:function(){var e=+VO;return VO=new SM,e}};function qO(e,t){GO.point=HO,PO=UO=e,jO=WO=t}function HO(e,t){UO-=e,WO-=t,VO.add(GM(UO*UO+WO*WO)),UO=e,WO=t}var XO=GO;function YO(){this._string=[]}function KO(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function $O(e,t){var n,r,a=4.5;function i(e){return e&&("function"===typeof a&&r.pointRadius(+a.apply(this,arguments)),CM(e,n(r))),r.result()}return i.area=function(e){return CM(e,n(uO)),uO.result()},i.measure=function(e){return CM(e,n(XO)),XO.result()},i.bounds=function(e){return CM(e,n(mO)),mO.result()},i.centroid=function(e){return CM(e,n(BO)),BO.result()},i.projection=function(t){return arguments.length?(n=null==t?(e=null,yM):(e=t).stream,i):e},i.context=function(e){return arguments.length?(r=null==e?(t=null,new YO):new zO(t=e),"function"!==typeof a&&r.pointRadius(a),i):t},i.pointRadius=function(e){return arguments.length?(a="function"===typeof e?e:(r.pointRadius(+e),+e),i):a},i.projection(e).context(t)}function QO(){var e,t=[];return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){t.push(e=[])},lineEnd:YM,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function JO(e,t){return OM(e[0]-t[0])<AM&&OM(e[1]-t[1])<AM}function eR(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function tR(e,t,n,r,a){var i,o,u=[],s=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,r=e[0],o=e[t];if(JO(r,o)){if(!r[2]&&!o[2]){for(a.lineStart(),i=0;i<t;++i)a.point((r=e[i])[0],r[1]);return void a.lineEnd()}o[0]+=2e-6}u.push(n=new eR(r,e,null,!0)),s.push(n.o=new eR(r,null,n,!1)),u.push(n=new eR(o,e,null,!1)),s.push(n.o=new eR(o,null,n,!0))}})),u.length){for(s.sort(t),nR(u),nR(s),i=0,o=s.length;i<o;++i)s[i].e=n=!n;for(var c,l,f=u[0];;){for(var d=f,h=!0;d.v;)if((d=d.n)===f)return;c=d.z,a.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(i=0,o=c.length;i<o;++i)a.point((l=c[i])[0],l[1]);else r(d.x,d.n.x,1,a);d=d.n}else{if(h)for(c=d.p.z,i=c.length-1;i>=0;--i)a.point((l=c[i])[0],l[1]);else r(d.x,d.p.x,-1,a);d=d.p}c=(d=d.o).z,h=!h}while(!d.v);a.lineEnd()}}}function nR(e){if(t=e.length){for(var t,n,r=0,a=e[0];++r<t;)a.n=n=e[r],n.p=a,a=n;a.n=n=e[0],n.p=a}}function rR(e){return[ZM(e[1],e[0]),XM(e[2])]}function aR(e){var t=e[0],n=e[1],r=BM(n);return[r*BM(t),r*WM(t),WM(n)]}function iR(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function oR(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function uR(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function sR(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function cR(e){var t=GM(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function lR(e){return OM(e[0])<=TM?e[0]:VM(e[0])*((OM(e[0])+TM)%FM-TM)}YO.prototype={_radius:4.5,_circle:KO(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=KO(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}};var fR=(0,w.Z)().mark(dR);function dR(e){var t,n,r;return(0,w.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:t=(0,Zt.Z)(e),a.prev=1,t.s();case 3:if((n=t.n()).done){a.next=8;break}return r=n.value,a.delegateYield(r,"t0",6);case 6:a.next=3;break;case 8:a.next=13;break;case 10:a.prev=10,a.t1=a.catch(1),t.e(a.t1);case 13:return a.prev=13,t.f(),a.finish(13);case 16:case"end":return a.stop()}}),fR,null,[[1,10,13,16]])}function hR(e){return Array.from(dR(e))}function pR(e,t,n,r){return function(a){var i,o,u,s=t(a),c=QO(),l=t(c),f=!1,d={point:h,lineStart:v,lineEnd:g,polygonStart:function(){d.point=m,d.lineStart=y,d.lineEnd=b,o=[],i=[]},polygonEnd:function(){d.point=h,d.lineStart=v,d.lineEnd=g,o=hR(o);var e=function(e,t){var n=lR(t),r=t[1],a=WM(r),i=[WM(n),-BM(n),0],o=0,u=0,s=new SM;1===a?r=NM+AM:-1===a&&(r=-NM-AM);for(var c=0,l=e.length;c<l;++c)if(d=(f=e[c]).length)for(var f,d,h=f[d-1],p=lR(h),v=h[1]/2+DM,g=WM(v),m=BM(v),y=0;y<d;++y,p=x,g=w,m=_,h=b){var b=f[y],x=lR(b),k=b[1]/2+DM,w=WM(k),_=BM(k),C=x-p,S=C>=0?1:-1,A=S*C,E=A>TM,T=g*w;if(s.add(ZM(T*S*WM(A),m*_+T*BM(A))),o+=E?C+S*FM:C,E^p>=n^x>=n){var N=oR(aR(h),aR(b));cR(N);var D=oR(i,N);cR(D);var F=(E^C>=0?-1:1)*XM(D[2]);(r>F||r===F&&(N[0]||N[1]))&&(u+=E^C>=0?1:-1)}}return(o<-1e-6||o<AM&&s<-1e-12)^1&u}(i,r);o.length?(f||(a.polygonStart(),f=!0),tR(o,gR,e,n,a)):e&&(f||(a.polygonStart(),f=!0),a.lineStart(),n(null,null,1,a),a.lineEnd()),f&&(a.polygonEnd(),f=!1),o=i=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function h(t,n){e(t,n)&&a.point(t,n)}function p(e,t){s.point(e,t)}function v(){d.point=p,s.lineStart()}function g(){d.point=h,s.lineEnd()}function m(e,t){u.push([e,t]),l.point(e,t)}function y(){l.lineStart(),u=[]}function b(){m(u[0][0],u[0][1]),l.lineEnd();var e,t,n,r,s=l.clean(),d=c.result(),h=d.length;if(u.pop(),i.push(u),u=null,h)if(1&s){if((t=(n=d[0]).length-1)>0){for(f||(a.polygonStart(),f=!0),a.lineStart(),e=0;e<t;++e)a.point((r=n[e])[0],r[1]);a.lineEnd()}}else h>1&&2&s&&d.push(d.pop().concat(d.shift())),o.push(d.filter(vR))}return d}}function vR(e){return e.length>1}function gR(e,t){return((e=e.x)[0]<0?e[1]-NM-AM:NM-e[1])-((t=t.x)[0]<0?t[1]-NM-AM:NM-t[1])}var mR=pR((function(){return!0}),(function(e){var t,n=NaN,r=NaN,a=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(i,o){var u=i>0?TM:-TM,s=OM(i-n);OM(s-TM)<AM?(e.point(n,r=(r+o)/2>0?NM:-NM),e.point(a,r),e.lineEnd(),e.lineStart(),e.point(u,r),e.point(i,r),t=0):a!==u&&s>=TM&&(OM(n-a)<AM&&(n-=a*AM),OM(i-u)<AM&&(i-=u*AM),r=function(e,t,n,r){var a,i,o=WM(e-n);return OM(o)>AM?RM((WM(t)*(i=BM(r))*WM(n)-WM(r)*(a=BM(t))*WM(e))/(a*i*o)):(t+r)/2}(n,r,i,o),e.point(a,r),e.lineEnd(),e.lineStart(),e.point(u,r),t=0),e.point(n=i,r=o),a=u},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}),(function(e,t,n,r){var a;if(null==e)a=n*NM,r.point(-TM,a),r.point(0,a),r.point(TM,a),r.point(TM,0),r.point(TM,-a),r.point(0,-a),r.point(-TM,-a),r.point(-TM,0),r.point(-TM,a);else if(OM(e[0]-t[0])>AM){var i=e[0]<t[0]?TM:-TM;a=n*i/2,r.point(-i,a),r.point(0,a),r.point(i,a)}else r.point(t[0],t[1])}),[-TM,-NM]);function yR(e,t,n,r,a,i){if(n){var o=BM(t),u=WM(t),s=r*n;null==a?(a=t+r*FM,i=t-s/2):(a=bR(o,a),i=bR(o,i),(r>0?a<i:a>i)&&(a+=r*FM));for(var c,l=a;r>0?l>i:l<i;l-=s)c=rR([o,-u*BM(l),-u*WM(l)]),e.point(c[0],c[1])}}function bR(e,t){(t=aR(t))[0]-=e,cR(t);var n=HM(-t[1]);return((-t[2]<0?-n:n)+FM-AM)%FM}function xR(e){var t=BM(e),n=6*MM,r=t>0,a=OM(t)>AM;function i(e,n){return BM(e)*BM(n)>t}function o(e,n,r){var a=[1,0,0],i=oR(aR(e),aR(n)),o=iR(i,i),u=i[0],s=o-u*u;if(!s)return!r&&e;var c=t*o/s,l=-t*u/s,f=oR(a,i),d=sR(a,c);uR(d,sR(i,l));var h=f,p=iR(d,h),v=iR(h,h),g=p*p-v*(iR(d,d)-1);if(!(g<0)){var m=GM(g),y=sR(h,(-p-m)/v);if(uR(y,d),y=rR(y),!r)return y;var b,x=e[0],k=n[0],w=e[1],_=n[1];k<x&&(b=x,x=k,k=b);var C=k-x,S=OM(C-TM)<AM;if(!S&&_<w&&(b=w,w=_,_=b),S||C<AM?S?w+_>0^y[1]<(OM(y[0]-x)<AM?w:_):w<=y[1]&&y[1]<=_:C>TM^(x<=y[0]&&y[0]<=k)){var A=sR(h,(-p+m)/v);return uR(A,d),[y,rR(A)]}}}function u(t,n){var a=r?e:TM-e,i=0;return t<-a?i|=1:t>a&&(i|=2),n<-a?i|=4:n>a&&(i|=8),i}return pR(i,(function(e){var t,n,s,c,l;return{lineStart:function(){c=s=!1,l=1},point:function(f,d){var h,p=[f,d],v=i(f,d),g=r?v?0:u(f,d):v?u(f+(f<0?TM:-TM),d):0;if(!t&&(c=s=v)&&e.lineStart(),v!==s&&(!(h=o(t,p))||JO(t,h)||JO(p,h))&&(p[2]=1),v!==s)l=0,v?(e.lineStart(),h=o(p,t),e.point(h[0],h[1])):(h=o(t,p),e.point(h[0],h[1],2),e.lineEnd()),t=h;else if(a&&t&&r^v){var m;g&n||!(m=o(p,t,!0))||(l=0,r?(e.lineStart(),e.point(m[0][0],m[0][1]),e.point(m[1][0],m[1][1]),e.lineEnd()):(e.point(m[1][0],m[1][1]),e.lineEnd(),e.lineStart(),e.point(m[0][0],m[0][1],3)))}!v||t&&JO(t,p)||e.point(p[0],p[1]),t=p,s=v,n=g},lineEnd:function(){s&&e.lineEnd(),t=null},clean:function(){return l|(c&&s)<<1}}}),(function(t,r,a,i){yR(i,e,n,a,t,r)}),r?[0,-e]:[-TM,e-TM])}var kR=1e9,wR=-kR;function _R(e,t,n,r){function a(a,i){return e<=a&&a<=n&&t<=i&&i<=r}function i(a,i,u,c){var l=0,f=0;if(null==a||(l=o(a,u))!==(f=o(i,u))||s(a,i)<0^u>0)do{c.point(0===l||3===l?e:n,l>1?r:t)}while((l=(l+u+4)%4)!==f);else c.point(i[0],i[1])}function o(r,a){return OM(r[0]-e)<AM?a>0?0:3:OM(r[0]-n)<AM?a>0?2:1:OM(r[1]-t)<AM?a>0?1:0:a>0?3:2}function u(e,t){return s(e.x,t.x)}function s(e,t){var n=o(e,1),r=o(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(o){var s,c,l,f,d,h,p,v,g,m,y,b=o,x=QO(),k={point:w,lineStart:function(){k.point=_,c&&c.push(l=[]);m=!0,g=!1,p=v=NaN},lineEnd:function(){s&&(_(f,d),h&&g&&x.rejoin(),s.push(x.result()));k.point=w,g&&b.lineEnd()},polygonStart:function(){b=x,s=[],c=[],y=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,a=c.length;n<a;++n)for(var i,o,u=c[n],s=1,l=u.length,f=u[0],d=f[0],h=f[1];s<l;++s)i=d,o=h,d=(f=u[s])[0],h=f[1],o<=r?h>r&&(d-i)*(r-o)>(h-o)*(e-i)&&++t:h<=r&&(d-i)*(r-o)<(h-o)*(e-i)&&--t;return t}(),n=y&&t,a=(s=hR(s)).length;(n||a)&&(o.polygonStart(),n&&(o.lineStart(),i(null,null,1,o),o.lineEnd()),a&&tR(s,u,t,i,o),o.polygonEnd());b=o,s=c=l=null}};function w(e,t){a(e,t)&&b.point(e,t)}function _(i,o){var u=a(i,o);if(c&&l.push([i,o]),m)f=i,d=o,h=u,m=!1,u&&(b.lineStart(),b.point(i,o));else if(u&&g)b.point(i,o);else{var s=[p=Math.max(wR,Math.min(kR,p)),v=Math.max(wR,Math.min(kR,v))],x=[i=Math.max(wR,Math.min(kR,i)),o=Math.max(wR,Math.min(kR,o))];!function(e,t,n,r,a,i){var o,u=e[0],s=e[1],c=0,l=1,f=t[0]-u,d=t[1]-s;if(o=n-u,f||!(o>0)){if(o/=f,f<0){if(o<c)return;o<l&&(l=o)}else if(f>0){if(o>l)return;o>c&&(c=o)}if(o=a-u,f||!(o<0)){if(o/=f,f<0){if(o>l)return;o>c&&(c=o)}else if(f>0){if(o<c)return;o<l&&(l=o)}if(o=r-s,d||!(o>0)){if(o/=d,d<0){if(o<c)return;o<l&&(l=o)}else if(d>0){if(o>l)return;o>c&&(c=o)}if(o=i-s,d||!(o<0)){if(o/=d,d<0){if(o>l)return;o>c&&(c=o)}else if(d>0){if(o<c)return;o<l&&(l=o)}return c>0&&(e[0]=u+c*f,e[1]=s+c*d),l<1&&(t[0]=u+l*f,t[1]=s+l*d),!0}}}}}(s,x,e,t,n,r)?u&&(b.lineStart(),b.point(i,o),y=!1):(g||(b.lineStart(),b.point(s[0],s[1])),b.point(x[0],x[1]),u||b.lineEnd(),y=!1)}p=i,v=o,g=u}return k}}function CR(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n}function SR(e,t){return[OM(e)>TM?e+Math.round(-e/FM)*FM:e,t]}function AR(e,t,n){return(e%=FM)?t||n?CR(TR(e),NR(t,n)):TR(e):t||n?NR(t,n):SR}function ER(e){return function(t,n){return[(t+=e)>TM?t-FM:t<-TM?t+FM:t,n]}}function TR(e){var t=ER(e);return t.invert=ER(-e),t}function NR(e,t){var n=BM(e),r=WM(e),a=BM(t),i=WM(t);function o(e,t){var o=BM(t),u=BM(e)*o,s=WM(e)*o,c=WM(t),l=c*n+u*r;return[ZM(s*a-l*i,u*n-c*r),XM(l*a+s*i)]}return o.invert=function(e,t){var o=BM(t),u=BM(e)*o,s=WM(e)*o,c=WM(t),l=c*a-s*i;return[ZM(s*a+c*i,u*n+l*r),XM(l*n-u*r)]},o}function DR(e){return function(t){var n=new FR;for(var r in e)n[r]=e[r];return n.stream=t,n}}function FR(){}function IR(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=r&&e.clipExtent(null),CM(n,e.stream(mO)),t(mO.result()),null!=r&&e.clipExtent(r),e}function MR(e,t,n){return IR(e,(function(n){var r=t[1][0]-t[0][0],a=t[1][1]-t[0][1],i=Math.min(r/(n[1][0]-n[0][0]),a/(n[1][1]-n[0][1])),o=+t[0][0]+(r-i*(n[1][0]+n[0][0]))/2,u=+t[0][1]+(a-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([o,u])}),n)}function OR(e,t,n){return MR(e,[[0,0],t],n)}function RR(e,t,n){return IR(e,(function(n){var r=+t,a=r/(n[1][0]-n[0][0]),i=(r-a*(n[1][0]+n[0][0]))/2,o=-a*n[0][1];e.scale(150*a).translate([i,o])}),n)}function ZR(e,t,n){return IR(e,(function(n){var r=+t,a=r/(n[1][1]-n[0][1]),i=-a*n[0][0],o=(r-a*(n[1][1]+n[0][1]))/2;e.scale(150*a).translate([i,o])}),n)}SR.invert=SR,FR.prototype={constructor:FR,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var BR=BM(30*MM);function zR(e,t){return+t?function(e,t){function n(r,a,i,o,u,s,c,l,f,d,h,p,v,g){var m=c-r,y=l-a,b=m*m+y*y;if(b>4*t&&v--){var x=o+d,k=u+h,w=s+p,_=GM(x*x+k*k+w*w),C=XM(w/=_),S=OM(OM(w)-1)<AM||OM(i-f)<AM?(i+f)/2:ZM(k,x),A=e(S,C),E=A[0],T=A[1],N=E-r,D=T-a,F=y*N-m*D;(F*F/b>t||OM((m*N+y*D)/b-.5)>.3||o*d+u*h+s*p<BR)&&(n(r,a,i,o,u,s,E,T,S,x/=_,k/=_,w,v,g),g.point(E,T),n(E,T,S,x,k,w,c,l,f,d,h,p,v,g))}}return function(t){var r,a,i,o,u,s,c,l,f,d,h,p,v={point:g,lineStart:m,lineEnd:b,polygonStart:function(){t.polygonStart(),v.lineStart=x},polygonEnd:function(){t.polygonEnd(),v.lineStart=m}};function g(n,r){n=e(n,r),t.point(n[0],n[1])}function m(){l=NaN,v.point=y,t.lineStart()}function y(r,a){var i=aR([r,a]),o=e(r,a);n(l,f,c,d,h,p,l=o[0],f=o[1],c=r,d=i[0],h=i[1],p=i[2],16,t),t.point(l,f)}function b(){v.point=g,t.lineEnd()}function x(){m(),v.point=k,v.lineEnd=w}function k(e,t){y(r=e,t),a=l,i=f,o=d,u=h,s=p,v.point=y}function w(){n(l,f,c,d,h,p,a,i,r,o,u,s,16,t),v.lineEnd=b,b()}return v}}(e,t):function(e){return DR({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)}var LR=DR({point:function(e,t){this.stream.point(e*MM,t*MM)}});function PR(e,t,n,r,a,i){if(!i)return function(e,t,n,r,a){function i(i,o){return[t+e*(i*=r),n-e*(o*=a)]}return i.invert=function(i,o){return[(i-t)/e*r,(n-o)/e*a]},i}(e,t,n,r,a);var o=BM(i),u=WM(i),s=o*e,c=u*e,l=o/e,f=u/e,d=(u*n-o*t)/e,h=(u*t+o*n)/e;function p(e,i){return[s*(e*=r)-c*(i*=a)+t,n-c*e-s*i]}return p.invert=function(e,t){return[r*(l*e-f*t+d),a*(h-f*e-l*t)]},p}function jR(e){return UR((function(){return e}))()}function UR(e){var t,n,r,a,i,o,u,s,c,l,f=150,d=480,h=250,p=0,v=0,g=0,m=0,y=0,b=0,x=1,k=1,w=null,_=mR,C=null,S=yM,A=.5;function E(e){return s(e[0]*MM,e[1]*MM)}function T(e){return(e=s.invert(e[0],e[1]))&&[e[0]*IM,e[1]*IM]}function N(){var e=PR(f,0,0,x,k,b).apply(null,t(p,v)),r=PR(f,d-e[0],h-e[1],x,k,b);return n=AR(g,m,y),u=CR(t,r),s=CR(n,u),o=zR(u,A),D()}function D(){return c=l=null,E}return E.stream=function(e){return c&&l===e?c:c=LR(function(e){return DR({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(n)(_(o(S(l=e)))))},E.preclip=function(e){return arguments.length?(_=e,w=void 0,D()):_},E.postclip=function(e){return arguments.length?(S=e,C=r=a=i=null,D()):S},E.clipAngle=function(e){return arguments.length?(_=+e?xR(w=e*MM):(w=null,mR),D()):w*IM},E.clipExtent=function(e){return arguments.length?(S=null==e?(C=r=a=i=null,yM):_R(C=+e[0][0],r=+e[0][1],a=+e[1][0],i=+e[1][1]),D()):null==C?null:[[C,r],[a,i]]},E.scale=function(e){return arguments.length?(f=+e,N()):f},E.translate=function(e){return arguments.length?(d=+e[0],h=+e[1],N()):[d,h]},E.center=function(e){return arguments.length?(p=e[0]%360*MM,v=e[1]%360*MM,N()):[p*IM,v*IM]},E.rotate=function(e){return arguments.length?(g=e[0]%360*MM,m=e[1]%360*MM,y=e.length>2?e[2]%360*MM:0,N()):[g*IM,m*IM,y*IM]},E.angle=function(e){return arguments.length?(b=e%360*MM,N()):b*IM},E.reflectX=function(e){return arguments.length?(x=e?-1:1,N()):x<0},E.reflectY=function(e){return arguments.length?(k=e?-1:1,N()):k<0},E.precision=function(e){return arguments.length?(o=zR(u,A=e*e),D()):GM(A)},E.fitExtent=function(e,t){return MR(E,e,t)},E.fitSize=function(e,t){return OR(E,e,t)},E.fitWidth=function(e,t){return RR(E,e,t)},E.fitHeight=function(e,t){return ZR(E,e,t)},function(){return t=e.apply(this,arguments),E.invert=t.invert&&T,N()}}function WR(e){var t=0,n=TM/3,r=UR(e),a=r(t,n);return a.parallels=function(e){return arguments.length?r(t=e[0]*MM,n=e[1]*MM):[t*IM,n*IM]},a}function VR(e,t){var n=WM(e),r=(n+WM(t))/2;if(OM(r)<AM)return function(e){var t=BM(e);function n(e,n){return[e*t,WM(n)/t]}return n.invert=function(e,n){return[e/t,XM(n*t)]},n}(e);var a=1+n*(2*r-n),i=GM(a)/r;function o(e,t){var n=GM(a-2*r*WM(t))/r;return[n*WM(e*=r),i-n*BM(e)]}return o.invert=function(e,t){var n=i-t,o=ZM(e,OM(n))*VM(n);return n*r<0&&(o-=TM*VM(e)*VM(n)),[o/r,XM((a-(e*e+n*n)*r*r)/(2*r))]},o}function GR(){return WR(VR).scale(155.424).center([0,33.6442])}function qR(){return GR().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function HR(e){return function(t,n){var r=BM(t),a=BM(n),i=e(r*a);return i===1/0?[2,0]:[i*a*WM(t),i*WM(n)]}}function XR(e){return function(t,n){var r=GM(t*t+n*n),a=e(r),i=WM(a),o=BM(a);return[ZM(t*i,r*o),XM(r&&n*i/r)]}}var YR=HR((function(e){return GM(2/(1+e))}));YR.invert=XR((function(e){return 2*XM(e/2)}));var KR=HR((function(e){return(e=HM(e))&&e/WM(e)}));function $R(e,t){return[e,jM(qM((NM+t)/2))]}function QR(e){var t,n,r,a=jR(e),i=a.center,o=a.scale,u=a.translate,s=a.clipExtent,c=null;function l(){var i=TM*o(),u=a(function(e){function t(t){return(t=e(t[0]*MM,t[1]*MM))[0]*=IM,t[1]*=IM,t}return e=AR(e[0]*MM,e[1]*MM,e.length>2?e[2]*MM:0),t.invert=function(t){return(t=e.invert(t[0]*MM,t[1]*MM))[0]*=IM,t[1]*=IM,t},t}(a.rotate()).invert([0,0]));return s(null==c?[[u[0]-i,u[1]-i],[u[0]+i,u[1]+i]]:e===$R?[[Math.max(u[0]-i,c),t],[Math.min(u[0]+i,n),r]]:[[c,Math.max(u[1]-i,t)],[n,Math.min(u[1]+i,r)]])}return a.scale=function(e){return arguments.length?(o(e),l()):o()},a.translate=function(e){return arguments.length?(u(e),l()):u()},a.center=function(e){return arguments.length?(i(e),l()):i()},a.clipExtent=function(e){return arguments.length?(null==e?c=t=n=r=null:(c=+e[0][0],t=+e[0][1],n=+e[1][0],r=+e[1][1]),l()):null==c?null:[[c,t],[n,r]]},l()}function JR(e){return qM((NM+e)/2)}function eZ(e,t){var n=BM(e),r=e===t?WM(e):jM(n/BM(t))/jM(JR(t)/JR(e)),a=n*UM(JR(e),r)/r;if(!r)return $R;function i(e,t){a>0?t<-NM+AM&&(t=-NM+AM):t>NM-AM&&(t=NM-AM);var n=a/UM(JR(t),r);return[n*WM(r*e),a-n*BM(r*e)]}return i.invert=function(e,t){var n=a-t,i=VM(r)*GM(e*e+n*n),o=ZM(e,OM(n))*VM(n);return n*r<0&&(o-=TM*VM(e)*VM(n)),[o/r,2*RM(UM(a/i,1/r))-NM]},i}function tZ(e,t){return[e,t]}function nZ(e,t){var n=BM(e),r=e===t?WM(e):(n-BM(t))/(t-e),a=n/r+e;if(OM(r)<AM)return tZ;function i(e,t){var n=a-t,i=r*e;return[n*WM(i),a-n*BM(i)]}return i.invert=function(e,t){var n=a-t,i=ZM(e,OM(n))*VM(n);return n*r<0&&(i-=TM*VM(e)*VM(n)),[i/r,a-VM(r)*GM(e*e+n*n)]},i}KR.invert=XR((function(e){return e})),$R.invert=function(e,t){return[e,2*RM(LM(t))-NM]},tZ.invert=tZ;var rZ=1.340264,aZ=-.081106,iZ=893e-6,oZ=.003796,uZ=GM(3)/2;function sZ(e,t){var n=XM(uZ*WM(t)),r=n*n,a=r*r*r;return[e*BM(n)/(uZ*(rZ+3*aZ*r+a*(7*iZ+9*oZ*r))),n*(rZ+aZ*r+a*(iZ+oZ*r))]}function cZ(e,t){var n=BM(t),r=BM(e)*n;return[n*WM(e)/r,WM(t)/r]}function lZ(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),t*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function fZ(e,t){return[BM(t)*WM(e),WM(t)]}function dZ(e,t){var n=BM(t),r=1+BM(e)*n;return[n*WM(e)/r,WM(t)/r]}function hZ(e,t){return[jM(qM((NM+t)/2)),-e]}sZ.invert=function(e,t){for(var n,r=t,a=r*r,i=a*a*a,o=0;o<12&&(i=(a=(r-=n=(r*(rZ+aZ*a+i*(iZ+oZ*a))-t)/(rZ+3*aZ*a+i*(7*iZ+9*oZ*a)))*r)*a*a,!(OM(n)<EM));++o);return[uZ*e*(rZ+3*aZ*a+i*(7*iZ+9*oZ*a))/BM(r),XM(WM(r)/uZ)]},cZ.invert=XR(RM),lZ.invert=function(e,t){var n,r=t,a=25;do{var i=r*r,o=i*i;r-=n=(r*(1.007226+i*(.015085+o*(.028874*i-.044475-.005916*o)))-t)/(1.007226+i*(.045255+o*(.259866*i-.311325-.005916*11*o)))}while(OM(n)>AM&&--a>0);return[e/(.8707+(i=r*r)*(i*(i*i*i*(.003971-.001529*i)-.013791)-.131979)),r]},fZ.invert=XR(XM),dZ.invert=XR((function(e){return 2*RM(e)})),hZ.invert=function(e,t){return[-t,2*RM(LM(e))-NM]};var pZ=Math.abs,vZ=(Math.atan,Math.atan2,Math.ceil,Math.cos),gZ=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),mZ=(Math.tan,Math.PI),yZ=mZ/2,bZ=(Math.SQRT1_2,kZ(2));kZ(mZ);function xZ(e){return e>1?yZ:e<-1?-yZ:Math.asin(e)}function kZ(e){return e>0?Math.sqrt(e):0}function wZ(e,t){var n,r=e*gZ(t),a=30;do{t-=n=(t+gZ(t)-r)/(1+vZ(t))}while(pZ(n)>1e-6&&--a>0);return t/2}var _Z=function(e,t,n){function r(r,a){return[e*r*vZ(a=wZ(n,a)),t*gZ(a)]}return r.invert=function(r,a){return a=xZ(a/t),[r/(e*vZ(a)),xZ((2*a+gZ(2*a))/n)]},r}(bZ/yZ,bZ,mZ);var CZ=$O(),SZ=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function AZ(e,t){return function n(){var r=t();return r.type=e,r.path=$O().projection(r),r.copy=r.copy||function(){var e=n();return SZ.forEach((function(t){r[t]&&e[t](r[t]())})),e.path.pointRadius(r.path.pointRadius()),e},r}}function EZ(e,t){if(!e||"string"!==typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(NZ[e]=AZ(e,t),this):NZ[e]||null}function TZ(e){return e&&e.path||CZ}var NZ={albers:qR,albersusa:function(){var e,t,n,r,a,i,o=qR(),u=GR().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=GR().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(e,t){i=[e,t]}};function l(e){var t=e[0],o=e[1];return i=null,n.point(t,o),i||(r.point(t,o),i)||(a.point(t,o),i)}function f(){return e=t=null,l}return l.invert=function(e){var t=o.scale(),n=o.translate(),r=(e[0]-n[0])/t,a=(e[1]-n[1])/t;return(a>=.12&&a<.234&&r>=-.425&&r<-.214?u:a>=.166&&a<.234&&r>=-.214&&r<-.115?s:o).invert(e)},l.stream=function(n){return e&&t===n?e:e=function(e){var t=e.length;return{point:function(n,r){for(var a=-1;++a<t;)e[a].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}([o.stream(t=n),u.stream(n),s.stream(n)])},l.precision=function(e){return arguments.length?(o.precision(e),u.precision(e),s.precision(e),f()):o.precision()},l.scale=function(e){return arguments.length?(o.scale(e),u.scale(.35*e),s.scale(e),l.translate(o.translate())):o.scale()},l.translate=function(e){if(!arguments.length)return o.translate();var t=o.scale(),i=+e[0],l=+e[1];return n=o.translate(e).clipExtent([[i-.455*t,l-.238*t],[i+.455*t,l+.238*t]]).stream(c),r=u.translate([i-.307*t,l+.201*t]).clipExtent([[i-.425*t+AM,l+.12*t+AM],[i-.214*t-AM,l+.234*t-AM]]).stream(c),a=s.translate([i-.205*t,l+.212*t]).clipExtent([[i-.214*t+AM,l+.166*t+AM],[i-.115*t-AM,l+.234*t-AM]]).stream(c),f()},l.fitExtent=function(e,t){return MR(l,e,t)},l.fitSize=function(e,t){return OR(l,e,t)},l.fitWidth=function(e,t){return RR(l,e,t)},l.fitHeight=function(e,t){return ZR(l,e,t)},l.scale(1070)},azimuthalequalarea:function(){return jR(YR).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return jR(KR).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return WR(eZ).scale(109.5).parallels([30,30])},conicequalarea:GR,conicequidistant:function(){return WR(nZ).scale(131.154).center([0,13.9389])},equalEarth:function(){return jR(sZ).scale(177.158)},equirectangular:function(){return jR(tZ).scale(152.63)},gnomonic:function(){return jR(cZ).scale(144.049).clipAngle(60)},identity:function(){var e,t,n,r,a,i,o,u=1,s=0,c=0,l=1,f=1,d=0,h=null,p=1,v=1,g=DR({point:function(e,t){var n=b([e,t]);this.stream.point(n[0],n[1])}}),m=yM;function y(){return p=u*l,v=u*f,i=o=null,b}function b(n){var r=n[0]*p,a=n[1]*v;if(d){var i=a*e-r*t;r=r*e+a*t,a=i}return[r+s,a+c]}return b.invert=function(n){var r=n[0]-s,a=n[1]-c;if(d){var i=a*e+r*t;r=r*e-a*t,a=i}return[r/p,a/v]},b.stream=function(e){return i&&o===e?i:i=g(m(o=e))},b.postclip=function(e){return arguments.length?(m=e,h=n=r=a=null,y()):m},b.clipExtent=function(e){return arguments.length?(m=null==e?(h=n=r=a=null,yM):_R(h=+e[0][0],n=+e[0][1],r=+e[1][0],a=+e[1][1]),y()):null==h?null:[[h,n],[r,a]]},b.scale=function(e){return arguments.length?(u=+e,y()):u},b.translate=function(e){return arguments.length?(s=+e[0],c=+e[1],y()):[s,c]},b.angle=function(n){return arguments.length?(t=WM(d=n%360*MM),e=BM(d),y()):d*IM},b.reflectX=function(e){return arguments.length?(l=e?-1:1,y()):l<0},b.reflectY=function(e){return arguments.length?(f=e?-1:1,y()):f<0},b.fitExtent=function(e,t){return MR(b,e,t)},b.fitSize=function(e,t){return OR(b,e,t)},b.fitWidth=function(e,t){return RR(b,e,t)},b.fitHeight=function(e,t){return ZR(b,e,t)},b},mercator:function(){return QR($R).scale(961/FM)},mollweide:function(){return jR(_Z).scale(169.529)},naturalEarth1:function(){return jR(lZ).scale(175.295)},orthographic:function(){return jR(fZ).scale(249.5).clipAngle(90.000001)},stereographic:function(){return jR(dZ).scale(250).clipAngle(142)},transversemercator:function(){var e=QR(hZ),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):[(e=n())[0],e[1],e[2]-90]},n([0,0,90]).scale(159.155)}};for(var DZ in NZ)EZ(DZ,NZ[DZ]);function FZ(e,t,n){var r=Ns(e,t-AM,n).concat(t);return function(e){return r.map((function(t){return[e,t]}))}}function IZ(e,t,n){var r=Ns(e,t-AM,n).concat(t);return function(e){return r.map((function(t){return[t,e]}))}}function MZ(){var e,t,n,r,a,i,o,u,s,c,l,f,d=10,h=d,p=90,v=360,g=2.5;function m(){return{type:"MultiLineString",coordinates:y()}}function y(){return Ns(zM(r/p)*p,n,p).map(l).concat(Ns(zM(u/v)*v,o,v).map(f)).concat(Ns(zM(t/d)*d,e,d).filter((function(e){return OM(e%p)>AM})).map(s)).concat(Ns(zM(i/h)*h,a,h).filter((function(e){return OM(e%v)>AM})).map(c))}return m.lines=function(){return y().map((function(e){return{type:"LineString",coordinates:e}}))},m.outline=function(){return{type:"Polygon",coordinates:[l(r).concat(f(o).slice(1),l(n).reverse().slice(1),f(u).reverse().slice(1))]}},m.extent=function(e){return arguments.length?m.extentMajor(e).extentMinor(e):m.extentMinor()},m.extentMajor=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],u=+e[0][1],o=+e[1][1],r>n&&(e=r,r=n,n=e),u>o&&(e=u,u=o,o=e),m.precision(g)):[[r,u],[n,o]]},m.extentMinor=function(n){return arguments.length?(t=+n[0][0],e=+n[1][0],i=+n[0][1],a=+n[1][1],t>e&&(n=t,t=e,e=n),i>a&&(n=i,i=a,a=n),m.precision(g)):[[t,i],[e,a]]},m.step=function(e){return arguments.length?m.stepMajor(e).stepMinor(e):m.stepMinor()},m.stepMajor=function(e){return arguments.length?(p=+e[0],v=+e[1],m):[p,v]},m.stepMinor=function(e){return arguments.length?(d=+e[0],h=+e[1],m):[d,h]},m.precision=function(d){return arguments.length?(g=+d,s=FZ(i,a,90),c=IZ(t,e,g),l=FZ(u,o,90),f=IZ(r,n,g),m):g},m.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function OZ(){}var RZ=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function ZZ(){var e=1,t=1,n=o;function r(e,t){return t.map((function(t){return a(e,t)}))}function a(r,a){var o=[],u=[];return function(n,r,a){var o,u,s,c,l,f,d=new Array,h=new Array;o=u=-1,c=n[0]>=r,RZ[c<<1].forEach(p);for(;++o<e-1;)s=c,c=n[o+1]>=r,RZ[s|c<<1].forEach(p);RZ[c<<0].forEach(p);for(;++u<t-1;){for(o=-1,c=n[u*e+e]>=r,l=n[u*e]>=r,RZ[c<<1|l<<2].forEach(p);++o<e-1;)s=c,c=n[u*e+e+o+1]>=r,f=l,l=n[u*e+o+1]>=r,RZ[s|c<<1|l<<2|f<<3].forEach(p);RZ[c|l<<3].forEach(p)}o=-1,l=n[u*e]>=r,RZ[l<<2].forEach(p);for(;++o<e-1;)f=l,l=n[u*e+o+1]>=r,RZ[l<<2|f<<3].forEach(p);function p(e){var t,n,r=[e[0][0]+o,e[0][1]+u],s=[e[1][0]+o,e[1][1]+u],c=i(r),l=i(s);(t=h[c])?(n=d[l])?(delete h[t.end],delete d[n.start],t===n?(t.ring.push(s),a(t.ring)):d[t.start]=h[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete h[t.end],t.ring.push(s),h[t.end=l]=t):(t=d[l])?(n=h[c])?(delete d[t.start],delete h[n.end],t===n?(t.ring.push(s),a(t.ring)):d[n.start]=h[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete d[t.start],t.ring.unshift(r),d[t.start=c]=t):d[c]=h[l]={start:c,end:l,ring:[r,s]}}RZ[l<<3].forEach(p)}(r,a,(function(e){n(e,r,a),function(e){var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];for(;++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}(e)>0?o.push([e]):u.push(e)})),u.forEach((function(e){for(var t,n=0,r=o.length;n<r;++n)if(-1!==BZ((t=o[n])[0],e))return void t.push(e)})),{type:"MultiPolygon",value:a,coordinates:o}}function i(t){return 2*t[0]+t[1]*(e+1)*4}function o(n,r,a){n.forEach((function(n){var i,o=n[0],u=n[1],s=0|o,c=0|u,l=r[c*e+s];o>0&&o<e&&s===o&&(i=r[c*e+s-1],n[0]=o+(a-i)/(l-i)-.5),u>0&&u<t&&c===u&&(i=r[(c-1)*e+s],n[1]=u+(a-i)/(l-i)-.5)}))}return r.contour=a,r.size=function(n){if(!arguments.length)return[e,t];var a=Math.floor(n[0]),i=Math.floor(n[1]);return a>=0&&i>=0||se("invalid size"),e=a,t=i,r},r.smooth=function(e){return arguments.length?(n=e?o:OZ,r):n===o},r}function BZ(e,t){for(var n,r=-1,a=t.length;++r<a;)if(n=zZ(e,t[r]))return n;return 0}function zZ(e,t){for(var n=t[0],r=t[1],a=-1,i=0,o=e.length,u=o-1;i<o;u=i++){var s=e[i],c=s[0],l=s[1],f=e[u],d=f[0],h=f[1];if(LZ(s,f,t))return 0;l>r!==h>r&&n<(d-c)*(r-l)/(h-l)+c&&(a=-a)}return a}function LZ(e,t,n){var r,a,i,o;return function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&(a=e[r=+(e[0]===t[0])],i=n[r],o=t[r],a<=i&&i<=o||o<=i&&i<=a)}function PZ(e,t,n){return function(r){var a=ot(r),i=n?Math.min(a[0],0):a[0],o=a[1],u=o-i,s=t?Lc(i,o,e):u/(e+1);return Ns(i+s,o,s)}}function jZ(e){mu.call(this,null,e)}function UZ(e,t,n,r,a){var i=e.x1||0,o=e.y1||0,u=t*n<0;function s(e){e.forEach(c)}function c(e){u&&e.reverse(),e.forEach(l)}function l(e){e[0]=(e[0]-i)*t+r,e[1]=(e[1]-o)*n+a}return function(e){return e.coordinates.forEach(s),e}}function WZ(e,t,n){var r=e>=0?e:zu(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function VZ(e){return $e(e)?e:rt(+e)}function GZ(){var e=function(e){return e[0]},t=function(e){return e[1]},n=pe,r=[-1,-1],a=960,i=500,o=2;function u(u,s){var c=WZ(r[0],u,e)>>o,l=WZ(r[1],u,t)>>o,f=c?c+2:0,d=l?l+2:0,h=2*f+(a>>o),p=2*d+(i>>o),v=new Float32Array(h*p),g=new Float32Array(h*p),m=v;u.forEach((function(r){var a=f+(+e(r)>>o),i=d+(+t(r)>>o);a>=0&&a<h&&i>=0&&i<p&&(v[a+i*h]+=+n(r))})),c>0&&l>0?(qZ(h,p,v,g,c),HZ(h,p,g,v,l),qZ(h,p,v,g,c),HZ(h,p,g,v,l),qZ(h,p,v,g,c),HZ(h,p,g,v,l)):c>0?(qZ(h,p,v,g,c),qZ(h,p,g,v,c),qZ(h,p,v,g,c),m=g):l>0&&(HZ(h,p,v,g,l),HZ(h,p,g,v,l),HZ(h,p,v,g,l),m=g);for(var y=s?Math.pow(2,-2*o):1/jI(m),b=0,x=h*p;b<x;++b)m[b]*=y;return{values:m,scale:1<<o,width:h,height:p,x1:f,y1:d,x2:f+(a>>o),y2:d+(i>>o)}}return u.x=function(t){return arguments.length?(e=VZ(t),u):e},u.y=function(e){return arguments.length?(t=VZ(e),u):t},u.weight=function(e){return arguments.length?(n=VZ(e),u):n},u.size=function(e){if(!arguments.length)return[a,i];var t=+e[0],n=+e[1];return t>=0&&n>=0||se("invalid size"),a=t,i=n,u},u.cellSize=function(e){return arguments.length?((e=+e)>=1||se("invalid cell size"),o=Math.floor(Math.log(e)/Math.LN2),u):1<<o},u.bandwidth=function(e){return arguments.length?(1===(e=Ye(e)).length&&(e=[+e[0],+e[0]]),2!==e.length&&se("invalid bandwidth"),r=e,u):r},u}function qZ(e,t,n,r,a){for(var i=1+(a<<1),o=0;o<t;++o)for(var u=0,s=0;u<e+a;++u)u<e&&(s+=n[u+o*e]),u>=a&&(u>=i&&(s-=n[u-i+o*e]),r[u-a+o*e]=s/Math.min(u+1,e-1+i-u,i))}function HZ(e,t,n,r,a){for(var i=1+(a<<1),o=0;o<e;++o)for(var u=0,s=0;u<t+a;++u)u<t&&(s+=n[o+u*e]),u>=a&&(u>=i&&(s-=n[o+(u-i)*e]),r[o+(u-a)*e]=s/Math.min(u+1,t-1+i-u,i))}function XZ(e){mu.call(this,null,e)}jZ.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},ht(jZ,mu,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=t.materialize(t.SOURCE).source,a=e.field||de,i=ZZ().smooth(!1!==e.smooth),o=e.thresholds||function(e,t,n){var r=PZ(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(e.map((function(e){return _u(t(e).values)})))}(r,a,e),u=null===e.as?null:e.as||"contour",s=[];return r.forEach((function(t){var n=a(t),r=i.size([n.width,n.height])(n.values,Ce(o)?o:o(n.values));!function(e,t,n,r){var a=r.scale||t.scale,i=r.translate||t.translate;$e(a)&&(a=a(n,r));$e(i)&&(i=i(n,r));if((1===a||null==a)&&!i)return;var o=(yt(a)?a:a[0])||1,u=(yt(a)?a:a[1])||1,s=i&&i[0]||0,c=i&&i[1]||0;e.forEach(UZ(t,o,u,s,c))}(r,n,t,e),r.forEach((function(e){s.push(Bo(t,Ro(null!=u?(0,qn.Z)({},u,e):e)))}))})),this.value&&(n.rem=this.value),this.value=n.source=n.add=s,n}}),XZ.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};var YZ=["x","y","weight","size","cellSize","bandwidth"];function KZ(e,t){return YZ.forEach((function(n){return null!=t[n]?e[n](t[n]):0})),e}function $Z(e){mu.call(this,null,e)}ht(XZ,mu,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,r=t.fork(t.NO_SOURCE|t.NO_FIELDS),a=function(e,t){var n,r,a,i,o,u,s=[],c=function(e){return e(i)};if(null==t)s.push(e);else for(n={},r=0,a=e.length;r<a;++r)i=e[r],(u=n[o=t.map(c)])||(n[o]=u=[],u.dims=o,s.push(u)),u.push(i);return s}(t.materialize(t.SOURCE).source,e.groupby),i=(e.groupby||[]).map(re),o=KZ(GZ(),e),u=e.as||"grid";return n=a.map((function(t){return Ro(function(e,t){for(var n=0;n<i.length;++n)e[i[n]]=t[n];return e}((0,qn.Z)({},u,o(t,e.counts)),t.dims))})),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),$Z.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},ht($Z,mu,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,r,a=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=ZZ().smooth(!1!==e.smooth),o=e.values,u=e.thresholds||PZ(e.count||10,e.nice,!!o),s=e.size;return o||(o=t.materialize(t.SOURCE).source,r=UZ(n=KZ(GZ(),e)(o,!0),n.scale||1,n.scale||1,0,0),s=[n.width,n.height],o=n.values),u=Ce(u)?u:u(o),o=i.size(s)(o,u),r&&o.forEach(r),this.value&&(a.rem=this.value),this.value=a.source=a.add=(o||[]).map(Ro),a}});var QZ="Feature",JZ="FeatureCollection";function eB(e){mu.call(this,null,e)}function tB(e){mu.call(this,null,e)}function nB(e){mu.call(this,null,e)}function rB(e){mu.call(this,null,e)}function aB(e){mu.call(this,[],e),this.generator=MZ()}function iB(e){mu.call(this,null,e)}function oB(e){if(!$e(e))return!1;var t=Mt(ae(e));return t.$x||t.$y||t.$value||t.$max}function uB(e){mu.call(this,null,e),this.modified(!0)}function sB(e,t,n){$e(e[t])&&e[t](n)}function cB(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var a,i,o,u,s,c,l,f,d,h=e._root,p={data:r},v=e._x0,g=e._y0,m=e._x1,y=e._y1;if(!h)return e._root=p,e;for(;h.length;)if((c=t>=(i=(v+m)/2))?v=i:m=i,(l=n>=(o=(g+y)/2))?g=o:y=o,a=h,!(h=h[f=l<<1|c]))return a[f]=p,e;if(u=+e._x.call(null,h.data),s=+e._y.call(null,h.data),t===u&&n===s)return p.next=h,a?a[f]=p:e._root=p,e;do{a=a?a[f]=new Array(4):e._root=new Array(4),(c=t>=(i=(v+m)/2))?v=i:m=i,(l=n>=(o=(g+y)/2))?g=o:y=o}while((f=l<<1|c)===(d=(s>=o)<<1|u>=i));return a[d]=h,a[f]=p,e}function lB(e,t,n,r,a){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=a}function fB(e){return e[0]}function dB(e){return e[1]}function hB(e,t,n){var r=new pB(null==t?fB:t,null==n?dB:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function pB(e,t,n,r,a,i){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=a,this._y1=i,this._root=void 0}function vB(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}eB.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},ht(eB,mu,{transform:function(e,t){var n,r=this._features,a=this._points,i=e.fields,o=i&&i[0],u=i&&i[1],s=e.geojson||!i&&de,c=t.ADD;n=e.modified()||t.changed(t.REM)||t.modified(ae(s))||o&&t.modified(ae(o))||u&&t.modified(ae(u)),this.value&&!n||(c=t.SOURCE,this._features=r=[],this._points=a=[]),s&&t.visit(c,(function(e){return r.push(s(e))})),o&&u&&(t.visit(c,(function(e){var t=o(e),n=u(e);null!=t&&null!=n&&(t=+t)===t&&(n=+n)===n&&a.push([t,n])})),r=r.concat({type:QZ,geometry:{type:"MultiPoint",coordinates:a}})),this.value={type:JZ,features:r}}}),tB.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},ht(tB,mu,{transform:function(e,t){var n=t.fork(t.ALL),r=this.value,a=e.field||de,i=e.as||"path",o=n.SOURCE;!r||e.modified()?(this.value=r=TZ(e.projection),n.materialize().reflow()):o=a===de||t.modified(a.fields)?n.ADD_MOD:n.ADD;var u=function(e,t){var n=e.pointRadius();e.context(null),null!=t&&e.pointRadius(t);return n}(r,e.pointRadius);return n.visit(o,(function(e){return e[i]=r(a(e))})),r.pointRadius(u),n.modifies(i)}}),nB.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},ht(nB,mu,{transform:function(e,t){var n,r=e.projection,a=e.fields[0],i=e.fields[1],o=e.as||["x","y"],u=o[0],s=o[1];function c(e){var t=r([a(e),i(e)]);t?(e[u]=t[0],e[s]=t[1]):(e[u]=void 0,e[s]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,c):(n=t.modified(a.fields)||t.modified(i.fields),t.visit(n?t.ADD_MOD:t.ADD,c)),t.modifies(o)}}),rB.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},ht(rB,mu,{transform:function(e,t){var n=t.fork(t.ALL),r=this.value,a=e.as||"shape",i=n.ADD;return r&&!e.modified()||(this.value=r=function(e,t,n){var r=null==n?function(n){return e(t(n))}:function(r){var a=e.pointRadius(),i=e.pointRadius(n)(t(r));return e.pointRadius(a),i};return r.context=function(t){return e.context(t),r},r}(TZ(e.projection),e.field||le("datum"),e.pointRadius),n.materialize().reflow(),i=n.SOURCE),n.visit(i,(function(e){return e[a]=r})),n.modifies(a)}}),aB.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},ht(aB,mu,{transform:function(e,t){var n,r=this.value,a=this.generator;if(!r.length||e.modified())for(var i in e)$e(a[i])&&a[i](e[i]);return n=a(),r.length?t.mod.push(zo(r[0],n)):t.add.push(Ro(n)),r[0]=n,t}}),iB.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},ht(iB,mu,{transform:function(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r="shared"===e.resolve,a=e.field||de,i=function(e,t){var n;$e(e)?(n=function(n){return e(n,t)},n.dep=oB(e)):e?n=rt(e):(n=function(e){return e.$value/e.$max||0},n.dep=!0);return n}(e.opacity,e),o=function(e,t){var n;$e(e)?(n=function(n){return Ky(e(n,t))},n.dep=oB(e)):n=rt(Ky(e||"#888"));return n}(e.color,e),u=e.as||"image",s={$x:0,$y:0,$value:0,$max:r?_u(n.map((function(e){return _u(a(e).values)}))):0};return n.forEach((function(e){var t=a(e),n=it({},e,s);r||(n.$max=_u(t.values||[])),e[u]=function(e,t,n,r){for(var a=e.width,i=e.height,o=e.x1||0,u=e.y1||0,s=e.x2||a,c=e.y2||i,l=e.values,f=l?function(e){return l[e]}:he,d=_p(s-o,c-u),h=d.getContext("2d"),p=h.getImageData(0,0,s-o,c-u),v=p.data,g=u,m=0;g<c;++g){t.$y=g-u;for(var y=o,b=g*a;y<s;++y,m+=4){t.$x=y-o,t.$value=f(y+b);var x=n(t);v[m+0]=x.r,v[m+1]=x.g,v[m+2]=x.b,v[m+3]=~~(255*r(t))}}return h.putImageData(p,0,0),d}(t,n,o.dep?o:rt(o(n)),i.dep?i:rt(i(n)))})),t.reflow(!0).modifies(u)}}),ht(uB,mu,{transform:function(e,t){var n=this.value;return!n||e.modified("type")?(this.value=n=function(e){var t=EZ((e||"mercator").toLowerCase());t||se("Unrecognized projection type: "+e);return t()}(e.type),SZ.forEach((function(t){null!=e[t]&&sB(n,t,e[t])}))):SZ.forEach((function(t){e.modified(t)&&sB(n,t,e[t])})),null!=e.pointRadius&&n.path.pointRadius(e.pointRadius),e.fit&&function(e,t){var n=function(e){return e=Ye(e),1===e.length?e[0]:{type:JZ,features:e.reduce((function(e,t){return e.concat(function(e){return e.type===JZ?e.features:Ye(e).filter((function(e){return null!=e})).map((function(e){return e.type===QZ?e:{type:QZ,geometry:e}}))}(t))}),[])}}(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}});var gB=hB.prototype=pB.prototype;function mB(e){return function(){return e}}function yB(e){return 1e-6*(e()-.5)}function bB(e){return e.x+e.vx}function xB(e){return e.y+e.vy}gB.copy=function(){var e,t,n=new pB(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=vB(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var a=0;a<4;++a)(t=r.source[a])&&(t.length?e.push({source:t,target:r.target[a]=new Array(4)}):r.target[a]=vB(t));return n},gB.add=function(e){var t=+this._x.call(null,e),n=+this._y.call(null,e);return cB(this.cover(t,n),t,n,e)},gB.addAll=function(e){var t,n,r,a,i=e.length,o=new Array(i),u=new Array(i),s=1/0,c=1/0,l=-1/0,f=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(a=+this._y.call(null,t))||(o[n]=r,u[n]=a,r<s&&(s=r),r>l&&(l=r),a<c&&(c=a),a>f&&(f=a));if(s>l||c>f)return this;for(this.cover(s,c).cover(l,f),n=0;n<i;++n)cB(this,o[n],u[n],e[n]);return this},gB.cover=function(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,a=this._x1,i=this._y1;if(isNaN(n))a=(n=Math.floor(e))+1,i=(r=Math.floor(t))+1;else{for(var o,u,s=a-n||1,c=this._root;n>e||e>=a||r>t||t>=i;)switch(u=(t<r)<<1|e<n,(o=new Array(4))[u]=c,c=o,s*=2,u){case 0:a=n+s,i=r+s;break;case 1:n=a-s,i=r+s;break;case 2:a=n+s,r=i-s;break;case 3:n=a-s,r=i-s}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=a,this._y1=i,this},gB.data=function(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e},gB.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},gB.find=function(e,t,n){var r,a,i,o,u,s,c,l=this._x0,f=this._y0,d=this._x1,h=this._y1,p=[],v=this._root;for(v&&p.push(new lB(v,l,f,d,h)),null==n?n=1/0:(l=e-n,f=t-n,d=e+n,h=t+n,n*=n);s=p.pop();)if(!(!(v=s.node)||(a=s.x0)>d||(i=s.y0)>h||(o=s.x1)<l||(u=s.y1)<f))if(v.length){var g=(a+o)/2,m=(i+u)/2;p.push(new lB(v[3],g,m,o,u),new lB(v[2],a,m,g,u),new lB(v[1],g,i,o,m),new lB(v[0],a,i,g,m)),(c=(t>=m)<<1|e>=g)&&(s=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=s)}else{var y=e-+this._x.call(null,v.data),b=t-+this._y.call(null,v.data),x=y*y+b*b;if(x<n){var k=Math.sqrt(n=x);l=e-k,f=t-k,d=e+k,h=t+k,r=v.data}}return r},gB.remove=function(e){if(isNaN(i=+this._x.call(null,e))||isNaN(o=+this._y.call(null,e)))return this;var t,n,r,a,i,o,u,s,c,l,f,d,h=this._root,p=this._x0,v=this._y0,g=this._x1,m=this._y1;if(!h)return this;if(h.length)for(;;){if((c=i>=(u=(p+g)/2))?p=u:g=u,(l=o>=(s=(v+m)/2))?v=s:m=s,t=h,!(h=h[f=l<<1|c]))return this;if(!h.length)break;(t[f+1&3]||t[f+2&3]||t[f+3&3])&&(n=t,d=f)}for(;h.data!==e;)if(r=h,!(h=h.next))return this;return(a=h.next)&&delete h.next,r?(a?r.next=a:delete r.next,this):t?(a?t[f]=a:delete t[f],(h=t[0]||t[1]||t[2]||t[3])&&h===(t[3]||t[2]||t[1]||t[0])&&!h.length&&(n?n[d]=h:this._root=h),this):(this._root=a,this)},gB.removeAll=function(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this},gB.root=function(){return this._root},gB.size=function(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e},gB.visit=function(e){var t,n,r,a,i,o,u=[],s=this._root;for(s&&u.push(new lB(s,this._x0,this._y0,this._x1,this._y1));t=u.pop();)if(!e(s=t.node,r=t.x0,a=t.y0,i=t.x1,o=t.y1)&&s.length){var c=(r+i)/2,l=(a+o)/2;(n=s[3])&&u.push(new lB(n,c,l,i,o)),(n=s[2])&&u.push(new lB(n,r,l,c,o)),(n=s[1])&&u.push(new lB(n,c,a,i,l)),(n=s[0])&&u.push(new lB(n,r,a,c,l))}return this},gB.visitAfter=function(e){var t,n=[],r=[];for(this._root&&n.push(new lB(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var a=t.node;if(a.length){var i,o=t.x0,u=t.y0,s=t.x1,c=t.y1,l=(o+s)/2,f=(u+c)/2;(i=a[0])&&n.push(new lB(i,o,u,l,f)),(i=a[1])&&n.push(new lB(i,l,u,s,f)),(i=a[2])&&n.push(new lB(i,o,f,l,c)),(i=a[3])&&n.push(new lB(i,l,f,s,c))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this},gB.x=function(e){return arguments.length?(this._x=e,this):this._x},gB.y=function(e){return arguments.length?(this._y=e,this):this._y};var kB={value:function(){}};function wB(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new _B(r)}function _B(e){this._=e}function CB(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function SB(e,t){for(var n,r=0,a=e.length;r<a;++r)if((n=e[r]).name===t)return n.value}function AB(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===t){e[r]=kB,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}_B.prototype=wB.prototype={constructor:_B,on:function(e,t){var n,r=this._,a=CB(e+"",r),i=-1,o=a.length;if(!(arguments.length<2)){if(null!=t&&"function"!==typeof t)throw new Error("invalid callback: "+t);for(;++i<o;)if(n=(e=a[i]).type)r[n]=AB(r[n],e.name,t);else if(null==t)for(n in r)r[n]=AB(r[n],e.name,null);return this}for(;++i<o;)if((n=(e=a[i]).type)&&(n=SB(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new _B(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,a=new Array(n),i=0;i<n;++i)a[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(r=this._[e]).length;i<n;++i)r[i].value.apply(t,a)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,i=r.length;a<i;++a)r[a].value.apply(t,n)}};var EB,TB,NB=wB,DB=0,FB=0,IB=0,MB=0,OB=0,RB=0,ZB="object"===typeof performance&&performance.now?performance:Date,BB="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function zB(){return OB||(BB(LB),OB=ZB.now()+RB)}function LB(){OB=0}function PB(){this._call=this._time=this._next=null}function jB(e,t,n){var r=new PB;return r.restart(e,t,n),r}function UB(){OB=(MB=ZB.now())+RB,DB=FB=0;try{!function(){zB(),++DB;for(var e,t=EB;t;)(e=OB-t._time)>=0&&t._call.call(null,e),t=t._next;--DB}()}finally{DB=0,function(){var e,t,n=EB,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:EB=t);TB=e,VB(r)}(),OB=0}}function WB(){var e=ZB.now(),t=e-MB;t>1e3&&(RB-=t,MB=e)}function VB(e){DB||(FB&&(FB=clearTimeout(FB)),e-OB>24?(e<1/0&&(FB=setTimeout(UB,e-ZB.now()-RB)),IB&&(IB=clearInterval(IB))):(IB||(MB=ZB.now(),IB=setInterval(WB,1e3)),DB=1,BB(UB)))}PB.prototype=jB.prototype={constructor:PB,restart:function(e,t,n){if("function"!==typeof e)throw new TypeError("callback is not a function");n=(null==n?zB():+n)+(null==t?0:+t),this._next||TB===this||(TB?TB._next=this:EB=this,TB=this),this._call=e,this._time=n,VB()},stop:function(){this._call&&(this._call=null,this._time=1/0,VB())}};var GB=4294967296;function qB(e){return e.x}function HB(e){return e.y}var XB=Math.PI*(3-Math.sqrt(5));function YB(e){var t,n=1,r=.001,a=1-Math.pow(r,1/300),i=0,o=.6,u=new Map,s=jB(f),c=NB("tick","end"),l=function(){var e=1;return function(){return(e=(1664525*e+1013904223)%GB)/GB}}();function f(){d(),c.call("tick",t),n<r&&(s.stop(),c.call("end",t))}function d(r){var s,c,l=e.length;void 0===r&&(r=1);for(var f=0;f<r;++f)for(n+=(i-n)*a,u.forEach((function(e){e(n)})),s=0;s<l;++s)null==(c=e[s]).fx?c.x+=c.vx*=o:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=o:(c.y=c.fy,c.vy=0);return t}function h(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var a=10*Math.sqrt(.5+n),i=n*XB;t.x=a*Math.cos(i),t.y=a*Math.sin(i)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function p(t){return t.initialize&&t.initialize(e,l),t}return null==e&&(e=[]),h(),t={tick:d,restart:function(){return s.restart(f),t},stop:function(){return s.stop(),t},nodes:function(n){return arguments.length?(e=n,h(),u.forEach(p),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(r=+e,t):r},alphaDecay:function(e){return arguments.length?(a=+e,t):+a},alphaTarget:function(e){return arguments.length?(i=+e,t):i},velocityDecay:function(e){return arguments.length?(o=1-e,t):1-o},randomSource:function(e){return arguments.length?(l=e,u.forEach(p),t):l},force:function(e,n){return arguments.length>1?(null==n?u.delete(e):u.set(e,p(n)),t):u.get(e)},find:function(t,n,r){var a,i,o,u,s,c=0,l=e.length;for(null==r?r=1/0:r*=r,c=0;c<l;++c)(o=(a=t-(u=e[c]).x)*a+(i=n-u.y)*i)<r&&(s=u,r=o);return s},on:function(e,n){return arguments.length>1?(c.on(e,n),t):c.on(e)}}}function KB(e){return e.index}function $B(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}var QB={center:function(e,t){var n,r=1;function a(){var a,i,o=n.length,u=0,s=0;for(a=0;a<o;++a)u+=(i=n[a]).x,s+=i.y;for(u=(u/o-e)*r,s=(s/o-t)*r,a=0;a<o;++a)(i=n[a]).x-=u,i.y-=s}return null==e&&(e=0),null==t&&(t=0),a.initialize=function(e){n=e},a.x=function(t){return arguments.length?(e=+t,a):e},a.y=function(e){return arguments.length?(t=+e,a):t},a.strength=function(e){return arguments.length?(r=+e,a):r},a},collide:function(e){var t,n,r,a=1,i=1;function o(){for(var e,o,s,c,l,f,d,h=t.length,p=0;p<i;++p)for(o=hB(t,bB,xB).visitAfter(u),e=0;e<h;++e)s=t[e],f=n[s.index],d=f*f,c=s.x+s.vx,l=s.y+s.vy,o.visit(v);function v(e,t,n,i,o){var u=e.data,h=e.r,p=f+h;if(!u)return t>c+p||i<c-p||n>l+p||o<l-p;if(u.index>s.index){var v=c-u.x-u.vx,g=l-u.y-u.vy,m=v*v+g*g;m<p*p&&(0===v&&(m+=(v=yB(r))*v),0===g&&(m+=(g=yB(r))*g),m=(p-(m=Math.sqrt(m)))/m*a,s.vx+=(v*=m)*(p=(h*=h)/(d+h)),s.vy+=(g*=m)*p,u.vx-=v*(p=1-p),u.vy-=g*p)}}}function u(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function s(){if(t){var r,a,i=t.length;for(n=new Array(i),r=0;r<i;++r)a=t[r],n[a.index]=+e(a,r,t)}}return"function"!==typeof e&&(e=mB(null==e?1:+e)),o.initialize=function(e,n){t=e,r=n,s()},o.iterations=function(e){return arguments.length?(i=+e,o):i},o.strength=function(e){return arguments.length?(a=+e,o):a},o.radius=function(t){return arguments.length?(e="function"===typeof t?t:mB(+t),s(),o):e},o},nbody:function(){var e,t,n,r,a,i=mB(-30),o=1,u=1/0,s=.81;function c(n){var a,i=e.length,o=hB(e,qB,HB).visitAfter(f);for(r=n,a=0;a<i;++a)t=e[a],o.visit(d)}function l(){if(e){var t,n,r=e.length;for(a=new Array(r),t=0;t<r;++t)n=e[t],a[n.index]=+i(n,t,e)}}function f(e){var t,n,r,i,o,u=0,s=0;if(e.length){for(r=i=o=0;o<4;++o)(t=e[o])&&(n=Math.abs(t.value))&&(u+=t.value,s+=n,r+=n*t.x,i+=n*t.y);e.x=r/s,e.y=i/s}else{(t=e).x=t.data.x,t.y=t.data.y;do{u+=a[t.data.index]}while(t=t.next)}e.value=u}function d(e,i,c,l){if(!e.value)return!0;var f=e.x-t.x,d=e.y-t.y,h=l-i,p=f*f+d*d;if(h*h/s<p)return p<u&&(0===f&&(p+=(f=yB(n))*f),0===d&&(p+=(d=yB(n))*d),p<o&&(p=Math.sqrt(o*p)),t.vx+=f*e.value*r/p,t.vy+=d*e.value*r/p),!0;if(!(e.length||p>=u)){(e.data!==t||e.next)&&(0===f&&(p+=(f=yB(n))*f),0===d&&(p+=(d=yB(n))*d),p<o&&(p=Math.sqrt(o*p)));do{e.data!==t&&(h=a[e.data.index]*r/p,t.vx+=f*h,t.vy+=d*h)}while(e=e.next)}}return c.initialize=function(t,r){e=t,n=r,l()},c.strength=function(e){return arguments.length?(i="function"===typeof e?e:mB(+e),l(),c):i},c.distanceMin=function(e){return arguments.length?(o=e*e,c):Math.sqrt(o)},c.distanceMax=function(e){return arguments.length?(u=e*e,c):Math.sqrt(u)},c.theta=function(e){return arguments.length?(s=e*e,c):Math.sqrt(s)},c},link:function(e){var t,n,r,a,i,o,u=KB,s=function(e){return 1/Math.min(a[e.source.index],a[e.target.index])},c=mB(30),l=1;function f(r){for(var a=0,u=e.length;a<l;++a)for(var s,c,f,d,h,p,v,g=0;g<u;++g)c=(s=e[g]).source,d=(f=s.target).x+f.vx-c.x-c.vx||yB(o),h=f.y+f.vy-c.y-c.vy||yB(o),d*=p=((p=Math.sqrt(d*d+h*h))-n[g])/p*r*t[g],h*=p,f.vx-=d*(v=i[g]),f.vy-=h*v,c.vx+=d*(v=1-v),c.vy+=h*v}function d(){if(r){var o,s,c=r.length,l=e.length,f=new Map(r.map((function(e,t){return[u(e,t,r),e]})));for(o=0,a=new Array(c);o<l;++o)(s=e[o]).index=o,"object"!==typeof s.source&&(s.source=$B(f,s.source)),"object"!==typeof s.target&&(s.target=$B(f,s.target)),a[s.source.index]=(a[s.source.index]||0)+1,a[s.target.index]=(a[s.target.index]||0)+1;for(o=0,i=new Array(l);o<l;++o)s=e[o],i[o]=a[s.source.index]/(a[s.source.index]+a[s.target.index]);t=new Array(l),h(),n=new Array(l),p()}}function h(){if(r)for(var n=0,a=e.length;n<a;++n)t[n]=+s(e[n],n,e)}function p(){if(r)for(var t=0,a=e.length;t<a;++t)n[t]=+c(e[t],t,e)}return null==e&&(e=[]),f.initialize=function(e,t){r=e,o=t,d()},f.links=function(t){return arguments.length?(e=t,d(),f):e},f.id=function(e){return arguments.length?(u=e,f):u},f.iterations=function(e){return arguments.length?(l=+e,f):l},f.strength=function(e){return arguments.length?(s="function"===typeof e?e:mB(+e),h(),f):s},f.distance=function(e){return arguments.length?(c="function"===typeof e?e:mB(+e),p(),f):c},f},x:function(e){var t,n,r,a=mB(.1);function i(e){for(var a,i=0,o=t.length;i<o;++i)(a=t[i]).vx+=(r[i]-a.x)*n[i]*e}function o(){if(t){var i,o=t.length;for(n=new Array(o),r=new Array(o),i=0;i<o;++i)n[i]=isNaN(r[i]=+e(t[i],i,t))?0:+a(t[i],i,t)}}return"function"!==typeof e&&(e=mB(null==e?0:+e)),i.initialize=function(e){t=e,o()},i.strength=function(e){return arguments.length?(a="function"===typeof e?e:mB(+e),o(),i):a},i.x=function(t){return arguments.length?(e="function"===typeof t?t:mB(+t),o(),i):e},i},y:function(e){var t,n,r,a=mB(.1);function i(e){for(var a,i=0,o=t.length;i<o;++i)(a=t[i]).vy+=(r[i]-a.y)*n[i]*e}function o(){if(t){var i,o=t.length;for(n=new Array(o),r=new Array(o),i=0;i<o;++i)n[i]=isNaN(r[i]=+e(t[i],i,t))?0:+a(t[i],i,t)}}return"function"!==typeof e&&(e=mB(null==e?0:+e)),i.initialize=function(e){t=e,o()},i.strength=function(e){return arguments.length?(a="function"===typeof e?e:mB(+e),o(),i):a},i.y=function(t){return arguments.length?(e="function"===typeof t?t:mB(+t),o(),i):e},i}},JB="forces",ez=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],tz=["static","iterations"],nz=["x","y","vx","vy"];function rz(e){mu.call(this,null,e)}function az(e,t,n,r){var a,i,o,u,s=Ye(t.forces);for(a=0,i=ez.length;a<i;++a)(o=ez[a])!==JB&&t.modified(o)&&e[o](t[o]);for(a=0,i=s.length;a<i;++a)u=JB+a,(o=n||t.modified(JB,a)?oz(s[a]):r&&iz(s[a],r)?e.force(u):null)&&e.force(u,o);for(i=e.numForces||0;a<i;++a)e.force(JB+a,null);return e.numForces=s.length,e}function iz(e,t){var n,r;for(n in e)if($e(r=e[n])&&t.modified(ae(r)))return 1;return 0}function oz(e){var t,n;for(n in ct(QB,e.force)||se("Unrecognized force: "+e.force),t=QB[e.force](),e)$e(t[n])&&uz(t[n],e[n],e);return t}function uz(e,t,n){e($e(t)?function(e){return t(e,n)}:t)}function sz(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}rz.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:nz}]},ht(rz,mu,{transform:function(e,t){var n,r,a=this.value,i=t.changed(t.ADD_REM),o=e.modified(ez),u=e.iterations||300;if(a?(i&&(t.modifies("index"),a.nodes(t.source)),(o||t.changed(t.MOD))&&az(a,e,0,t)):(this.value=a=function(e,t){var n=YB(e),r=n.stop,a=n.restart,i=!1;return n.stopped=function(){return i},n.restart=function(){return i=!1,a()},n.stop=function(){return i=!0,r()},az(n,t,!0).on("end",(function(){return i=!0}))}(t.source,e),a.on("tick",(n=t.dataflow,r=this,function(){return n.touch(r).run()})),e.static||(i=!0,a.tick()),t.modifies("index")),o||i||e.modified(tz)||t.changed()&&e.restart)if(a.alpha(Math.max(a.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(a.alphaMin(),1/u)),e.static)for(a.stop();--u>=0;)a.tick();else if(a.stopped()&&a.restart(),!i)return t.StopPropagation;return this.finish(e,t)},finish:function(e,t){for(var n,r=t.dataflow,a=this._argops,i=0,o=a.length;i<o;++i)if((n=a[i]).name===JB&&"link"===n.op._argval.force)for(var u,s=n.op._argops,c=0,l=s.length;c<l;++c)if("links"===s[c].name&&(u=s[c].op.source)){r.pulse(u,r.changeset().reflow());break}return t.reflow(e.modified()).modifies(nz)}});var cz=(0,w.Z)().mark(lz);function lz(){var e,t,n,r,a,i;return(0,w.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:n=[e=this];case 1:t=n.reverse(),n=[];case 2:if(!(e=t.pop())){o.next=8;break}return o.next=5,e;case 5:if(r=e.children)for(a=0,i=r.length;a<i;++a)n.push(r[a]);o.next=2;break;case 8:if(n.length){o.next=1;break}case 9:case"end":return o.stop()}}),cz,this)}function fz(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=hz)):void 0===t&&(t=dz);for(var n,r,a,i,o,u=new gz(e),s=[u];n=s.pop();)if((a=t(n.data))&&(o=(a=Array.from(a)).length))for(n.children=a,i=o-1;i>=0;--i)s.push(r=a[i]=new gz(a[i])),r.parent=n,r.depth=n.depth+1;return u.eachBefore(vz)}function dz(e){return e.children}function hz(e){return Array.isArray(e)?e[1]:null}function pz(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function vz(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function gz(e){this.data=e,this.depth=this.height=0,this.parent=null}function mz(e){for(var t,n,r=0,a=(e=function(e){for(var t,n,r=e.length;r;)n=Math.random()*r--|0,t=e[r],e[r]=e[n],e[n]=t;return e}(Array.from(e))).length,i=[];r<a;)t=e[r],n&&xz(n,t)?++r:(n=wz(i=yz(i,t)),r=0);return n}function yz(e,t){var n,r;if(kz(t,e))return[t];for(n=0;n<e.length;++n)if(bz(t,e[n])&&kz(_z(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(bz(_z(e[n],e[r]),t)&&bz(_z(e[n],t),e[r])&&bz(_z(e[r],t),e[n])&&kz(Cz(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function bz(e,t){var n=e.r-t.r,r=t.x-e.x,a=t.y-e.y;return n<0||n*n<r*r+a*a}function xz(e,t){var n=e.r-t.r+1e-9*Math.max(e.r,t.r,1),r=t.x-e.x,a=t.y-e.y;return n>0&&n*n>r*r+a*a}function kz(e,t){for(var n=0;n<t.length;++n)if(!xz(e,t[n]))return!1;return!0}function wz(e){switch(e.length){case 1:return function(e){return{x:e.x,y:e.y,r:e.r}}(e[0]);case 2:return _z(e[0],e[1]);case 3:return Cz(e[0],e[1],e[2])}}function _z(e,t){var n=e.x,r=e.y,a=e.r,i=t.x,o=t.y,u=t.r,s=i-n,c=o-r,l=u-a,f=Math.sqrt(s*s+c*c);return{x:(n+i+s/f*l)/2,y:(r+o+c/f*l)/2,r:(f+a+u)/2}}function Cz(e,t,n){var r=e.x,a=e.y,i=e.r,o=t.x,u=t.y,s=t.r,c=n.x,l=n.y,f=n.r,d=r-o,h=r-c,p=a-u,v=a-l,g=s-i,m=f-i,y=r*r+a*a-i*i,b=y-o*o-u*u+s*s,x=y-c*c-l*l+f*f,k=h*p-d*v,w=(p*x-v*b)/(2*k)-r,_=(v*g-p*m)/k,C=(h*b-d*x)/(2*k)-a,S=(d*m-h*g)/k,A=_*_+S*S-1,E=2*(i+w*_+C*S),T=w*w+C*C-i*i,N=-(A?(E+Math.sqrt(E*E-4*A*T))/(2*A):T/E);return{x:r+w+_*N,y:a+C+S*N,r:N}}function Sz(e,t,n){var r,a,i,o,u=e.x-t.x,s=e.y-t.y,c=u*u+s*s;c?(a=t.r+n.r,a*=a,o=e.r+n.r,a>(o*=o)?(r=(c+o-a)/(2*c),i=Math.sqrt(Math.max(0,o/c-r*r)),n.x=e.x-r*u-i*s,n.y=e.y-r*s+i*u):(r=(c+a-o)/(2*c),i=Math.sqrt(Math.max(0,a/c-r*r)),n.x=t.x+r*u-i*s,n.y=t.y+r*s+i*u)):(n.x=t.x+n.r,n.y=t.y)}function Az(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,a=t.y-e.y;return n>0&&n*n>r*r+a*a}function Ez(e){var t=e._,n=e.next._,r=t.r+n.r,a=(t.x*n.r+n.x*t.r)/r,i=(t.y*n.r+n.y*t.r)/r;return a*a+i*i}function Tz(e){this._=e,this.next=null,this.previous=null}function Nz(e){if(!(a=(e=function(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}(e)).length))return 0;var t,n,r,a,i,o,u,s,c,l,f;if((t=e[0]).x=0,t.y=0,!(a>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(a>2))return t.r+n.r;Sz(n,t,r=e[2]),t=new Tz(t),n=new Tz(n),r=new Tz(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(u=3;u<a;++u){Sz(t._,n._,r=e[u]),r=new Tz(r),s=n.next,c=t.previous,l=n._.r,f=t._.r;do{if(l<=f){if(Az(s._,r._)){n=s,t.next=n,n.previous=t,--u;continue e}l+=s._.r,s=s.next}else{if(Az(c._,r._)){(t=c).next=n,n.previous=t,--u;continue e}f+=c._.r,c=c.previous}}while(s!==c.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,i=Ez(t);(r=r.next)!==n;)(o=Ez(r))<i&&(t=r,i=o);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=mz(t),u=0;u<a;++u)(t=e[u]).x-=r.x,t.y-=r.y;return r.r}function Dz(e){return null==e?null:Fz(e)}function Fz(e){if("function"!==typeof e)throw new Error;return e}function Iz(){return 0}function Mz(e){return function(){return e}}function Oz(e){return Math.sqrt(e.value)}function Rz(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function Zz(e,t){return function(n){if(r=n.children){var r,a,i,o=r.length,u=e(n)*t||0;if(u)for(a=0;a<o;++a)r[a].r+=u;if(i=Nz(r),u)for(a=0;a<o;++a)r[a].r-=u;n.r=i+u}}}function Bz(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function zz(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Lz(e,t,n,r,a){for(var i,o=e.children,u=-1,s=o.length,c=e.value&&(r-t)/e.value;++u<s;)(i=o[u]).y0=n,i.y1=a,i.x0=t,i.x1=t+=i.value*c}gz.prototype=fz.prototype=(0,qn.Z)({constructor:gz,count:function(){return this.eachAfter(sz)},each:function(e,t){var n,r=-1,a=(0,Zt.Z)(this);try{for(a.s();!(n=a.n()).done;){var i=n.value;e.call(t,i,++r,this)}}catch(o){a.e(o)}finally{a.f()}return this},eachAfter:function(e,t){for(var n,r,a,i=this,o=[i],u=[],s=-1;i=o.pop();)if(u.push(i),n=i.children)for(r=0,a=n.length;r<a;++r)o.push(n[r]);for(;i=u.pop();)e.call(t,i,++s,this);return this},eachBefore:function(e,t){for(var n,r,a=this,i=[a],o=-1;a=i.pop();)if(e.call(t,a,++o,this),n=a.children)for(r=n.length-1;r>=0;--r)i.push(n[r]);return this},find:function(e,t){var n,r=-1,a=(0,Zt.Z)(this);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(e.call(t,i,++r,this))return i}}catch(o){a.e(o)}finally{a.f()}},sum:function(e){return this.eachAfter((function(t){for(var n=+e(t.data)||0,r=t.children,a=r&&r.length;--a>=0;)n+=r[a].value;t.value=n}))},sort:function(e){return this.eachBefore((function(t){t.children&&t.children.sort(e)}))},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),a=null;e=n.pop(),t=r.pop();for(;e===t;)a=e,e=n.pop(),t=r.pop();return a}(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var a=r.length;e!==n;)r.splice(a,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore((function(t){t.children||e.push(t)})),e},links:function(){var e=this,t=[];return e.each((function(n){n!==e&&t.push({source:n.parent,target:n})})),t},copy:function(){return fz(this).eachBefore(pz)}},Symbol.iterator,lz);var Pz={depth:-1},jz={};function Uz(e){return e.id}function Wz(e){return e.parentId}function Vz(){var e=Uz,t=Wz;function n(n){var r,a,i,o,u,s,c,l=Array.from(n),f=l.length,d=new Map;for(a=0;a<f;++a)r=l[a],u=l[a]=new gz(r),null!=(s=e(r,a,n))&&(s+="")&&(c=u.id=s,d.set(c,d.has(c)?jz:u)),null!=(s=t(r,a,n))&&(s+="")&&(u.parent=s);for(a=0;a<f;++a)if(s=(u=l[a]).parent){if(!(o=d.get(s)))throw new Error("missing: "+s);if(o===jz)throw new Error("ambiguous: "+s);o.children?o.children.push(u):o.children=[u],u.parent=o}else{if(i)throw new Error("multiple roots");i=u}if(!i)throw new Error("no root");if(i.parent=Pz,i.eachBefore((function(e){e.depth=e.parent.depth+1,--f})).eachBefore(vz),i.parent=null,f>0)throw new Error("cycle");return i}return n.id=function(t){return arguments.length?(e=Fz(t),n):e},n.parentId=function(e){return arguments.length?(t=Fz(e),n):t},n}function Gz(e,t){return e.parent===t.parent?1:2}function qz(e){var t=e.children;return t?t[0]:e.t}function Hz(e){var t=e.children;return t?t[t.length-1]:e.t}function Xz(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function Yz(e,t,n){return e.a.parent===t.parent?e.a:n}function Kz(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function $z(e,t){return e.parent===t.parent?1:2}function Qz(e,t){return e+t.x}function Jz(e,t){return Math.max(e,t.y)}function eL(e,t,n,r,a){for(var i,o=e.children,u=-1,s=o.length,c=e.value&&(a-n)/e.value;++u<s;)(i=o[u]).x0=t,i.x1=r,i.y0=n,i.y1=n+=i.value*c}Kz.prototype=Object.create(gz.prototype);var tL=(1+Math.sqrt(5))/2;function nL(e,t,n,r,a,i){for(var o,u,s,c,l,f,d,h,p,v,g,m=[],y=t.children,b=0,x=0,k=y.length,w=t.value;b<k;){s=a-n,c=i-r;do{l=y[x++].value}while(!l&&x<k);for(f=d=l,g=l*l*(v=Math.max(c/s,s/c)/(w*e)),p=Math.max(d/g,g/f);x<k;++x){if(l+=u=y[x].value,u<f&&(f=u),u>d&&(d=u),g=l*l*v,(h=Math.max(d/g,g/f))>p){l-=u;break}p=h}m.push(o={value:l,dice:s<c,children:y.slice(b,x)}),o.dice?Lz(o,n,r,a,w?r+=c*l/w:i):eL(o,n,r,w?n+=s*l/w:a,i),w-=l,b=x}return m}var rL=function e(t){function n(e,n,r,a,i){nL(t,e,n,r,a,i)}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(tL),aL=function e(t){function n(e,n,r,a,i){if((o=e._squarify)&&o.ratio===t)for(var o,u,s,c,l,f=-1,d=o.length,h=e.value;++f<d;){for(s=(u=o[f]).children,c=u.value=0,l=s.length;c<l;++c)u.value+=s[c].value;u.dice?Lz(u,n,r,a,h?r+=(i-r)*u.value/h:i):eL(u,n,r,h?n+=(a-n)*u.value/h:a,i),h-=u.value}else e._squarify=o=nL(t,e,n,r,a,i),o.ratio=t}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(tL);function iL(e,t,n){var r={};return e.each((function(e){var a=e.data;n(a)&&(r[t(a)]=e)})),e.lookup=r,e}function oL(e){mu.call(this,null,e)}oL.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};var uL=function(e){return e.values};function sL(){var e=[],t={entries:function(e){return r(n(e,0),0)},key:function(n){return e.push(n),t}};function n(t,r){if(r>=e.length)return t;for(var a,i,o,u=t.length,s=e[r++],c={},l={},f=-1;++f<u;)(o=c[a=s(i=t[f])+""])?o.push(i):c[a]=[i];for(a in c)l[a]=n(c[a],r);return l}function r(t,n){if(++n>e.length)return t;var a=[];for(var i in t)a.push({key:i,values:r(t[i],n)});return a}return t}function cL(e){mu.call(this,null,e)}ht(oL,mu,{transform:function(e,t){t.source||se("Nest transform requires an upstream data source.");var n=e.generate,r=e.modified(),a=t.clone(),i=this.value;return(!i||r||t.changed())&&(i&&i.each((function(e){e.children&&Io(e.data)&&a.rem.push(e.data)})),this.value=i=fz({values:Ye(e.keys).reduce((function(e,t){return e.key(t),e}),sL()).entries(a.source)},uL),n&&i.each((function(e){e.children&&(e=Ro(e.data),a.add.push(e),a.source.push(e))})),iL(i,Mo,Mo)),a.source.root=i,a}});var lL=function(e,t){return e.parent===t.parent?1:2};ht(cL,mu,{transform:function(e,t){t.source&&t.source.root||se(this.constructor.name+" transform requires a backing tree data source.");var n=this.layout(e.method),r=this.fields,a=t.source.root,i=e.as||r;e.field?a.sum(e.field):a.count(),e.sort&&a.sort(Lo(e.sort,(function(e){return e.data}))),function(e,t,n){for(var r,a=0,i=t.length;a<i;++a)(r=t[a])in n&&e[r](n[r])}(n,this.params,e),n.separation&&n.separation(!1!==e.separation?lL:pe);try{this.value=n(a)}catch(o){se(o)}return a.each((function(e){return function(e,t,n){for(var r=e.data,a=t.length-1,i=0;i<a;++i)r[n[i]]=e[t[i]];r[n[a]]=e.children?e.children.length:0}(e,r,i)})),t.reflow(e.modified()).modifies(i).modifies("leaf")}});var fL=["x","y","r","depth","children"];function dL(e){cL.call(this,e)}dL.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:fL.length,default:fL}]},ht(dL,cL,{layout:function(){var e=null,t=1,n=1,r=Iz;function a(a){return a.x=t/2,a.y=n/2,e?a.eachBefore(Rz(e)).eachAfter(Zz(r,.5)).eachBefore(Bz(1)):a.eachBefore(Rz(Oz)).eachAfter(Zz(Iz,1)).eachAfter(Zz(r,a.r/Math.min(t,n))).eachBefore(Bz(Math.min(t,n)/(2*a.r))),a}return a.radius=function(t){return arguments.length?(e=Dz(t),a):e},a.size=function(e){return arguments.length?(t=+e[0],n=+e[1],a):[t,n]},a.padding=function(e){return arguments.length?(r="function"===typeof e?e:Mz(+e),a):r},a},params:["radius","size","padding"],fields:fL});var hL=["x0","y0","x1","y1","depth","children"];function pL(e){cL.call(this,e)}function vL(e){mu.call(this,null,e)}pL.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:hL.length,default:hL}]},ht(pL,cL,{layout:function(){var e=1,t=1,n=0,r=!1;function a(a){var i=a.height+1;return a.x0=a.y0=n,a.x1=e,a.y1=t/i,a.eachBefore(function(e,t){return function(r){r.children&&Lz(r,r.x0,e*(r.depth+1)/t,r.x1,e*(r.depth+2)/t);var a=r.x0,i=r.y0,o=r.x1-n,u=r.y1-n;o<a&&(a=o=(a+o)/2),u<i&&(i=u=(i+u)/2),r.x0=a,r.y0=i,r.x1=o,r.y1=u}}(t,i)),r&&a.eachBefore(zz),a}return a.round=function(e){return arguments.length?(r=!!e,a):r},a.size=function(n){return arguments.length?(e=+n[0],t=+n[1],a):[e,t]},a.padding=function(e){return arguments.length?(n=+e,a):n},a},params:["size","round","padding"],fields:hL}),vL.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},ht(vL,mu,{transform:function(e,t){t.source||se("Stratify transform requires an upstream data source.");var n=this.value,r=e.modified(),a=t.fork(t.ALL).materialize(t.SOURCE),i=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return a.source=a.source.slice(),i&&(n=a.source.length?iL(Vz().id(e.key).parentId(e.parentKey)(a.source),e.key,ve):iL(Vz()([{}]),e.key,e.key)),a.source.root=this.value=n,a}});var gL={tidy:function(){var e=Gz,t=1,n=1,r=null;function a(a){var s=function(e){for(var t,n,r,a,i,o=new Kz(e,0),u=[o];t=u.pop();)if(r=t._.children)for(t.children=new Array(i=r.length),a=i-1;a>=0;--a)u.push(n=t.children[a]=new Kz(r[a],a)),n.parent=t;return(o.parent=new Kz(null,0)).children=[o],o}(a);if(s.eachAfter(i),s.parent.m=-s.z,s.eachBefore(o),r)a.eachBefore(u);else{var c=a,l=a,f=a;a.eachBefore((function(e){e.x<c.x&&(c=e),e.x>l.x&&(l=e),e.depth>f.depth&&(f=e)}));var d=c===l?1:e(c,l)/2,h=d-c.x,p=t/(l.x+d+h),v=n/(f.depth||1);a.eachBefore((function(e){e.x=(e.x+h)*p,e.y=e.depth*v}))}return a}function i(t){var n=t.children,r=t.parent.children,a=t.i?r[t.i-1]:null;if(n){!function(e){for(var t,n=0,r=0,a=e.children,i=a.length;--i>=0;)(t=a[i]).z+=n,t.m+=n,n+=t.s+(r+=t.c)}(t);var i=(n[0].z+n[n.length-1].z)/2;a?(t.z=a.z+e(t._,a._),t.m=t.z-i):t.z=i}else a&&(t.z=a.z+e(t._,a._));t.parent.A=function(t,n,r){if(n){for(var a,i=t,o=t,u=n,s=i.parent.children[0],c=i.m,l=o.m,f=u.m,d=s.m;u=Hz(u),i=qz(i),u&&i;)s=qz(s),(o=Hz(o)).a=t,(a=u.z+f-i.z-c+e(u._,i._))>0&&(Xz(Yz(u,t,r),t,a),c+=a,l+=a),f+=u.m,c+=i.m,d+=s.m,l+=o.m;u&&!Hz(o)&&(o.t=u,o.m+=f-l),i&&!qz(s)&&(s.t=i,s.m+=c-d,r=t)}return r}(t,a,t.parent.A||r[0])}function o(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function u(e){e.x*=t,e.y=e.depth*n}return a.separation=function(t){return arguments.length?(e=t,a):e},a.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],a):r?null:[t,n]},a.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],a):r?[t,n]:null},a},cluster:function(){var e=$z,t=1,n=1,r=!1;function a(a){var i,o=0;a.eachAfter((function(t){var n=t.children;n?(t.x=function(e){return e.reduce(Qz,0)/e.length}(n),t.y=function(e){return 1+e.reduce(Jz,0)}(n)):(t.x=i?o+=e(t,i):0,t.y=0,i=t)}));var u=function(e){for(var t;t=e.children;)e=t[0];return e}(a),s=function(e){for(var t;t=e.children;)e=t[t.length-1];return e}(a),c=u.x-e(u,s)/2,l=s.x+e(s,u)/2;return a.eachAfter(r?function(e){e.x=(e.x-a.x)*t,e.y=(a.y-e.y)*n}:function(e){e.x=(e.x-c)/(l-c)*t,e.y=(1-(a.y?e.y/a.y:1))*n})}return a.separation=function(t){return arguments.length?(e=t,a):e},a.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],a):r?null:[t,n]},a.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],a):r?[t,n]:null},a}},mL=["x","y","depth","children"];function yL(e){cL.call(this,e)}function bL(e){mu.call(this,[],e)}yL.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:mL.length,default:mL}]},ht(yL,cL,{layout:function(e){var t=e||"tidy";if(ct(gL,t))return gL[t]();se("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:mL}),bL.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},ht(bL,mu,{transform:function(e,t){var n=this.value,r=t.source&&t.source.root,a=t.fork(t.NO_SOURCE),i={};return r||se("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(a.rem=n,t.visit(t.SOURCE,(function(e){return i[Mo(e)]=1})),r.each((function(e){var t=e.data,n=e.parent&&e.parent.data;n&&i[Mo(t)]&&i[Mo(n)]&&a.add.push(Ro({source:n,target:t}))})),this.value=a.add):t.changed(t.MOD)&&(t.visit(t.MOD,(function(e){return i[Mo(e)]=1})),n.forEach((function(e){(i[Mo(e.source)]||i[Mo(e.target)])&&a.mod.push(e)}))),a}});var xL={binary:function(e,t,n,r,a){var i,o,u=e.children,s=u.length,c=new Array(s+1);for(c[0]=o=i=0;i<s;++i)c[i+1]=o+=u[i].value;!function e(t,n,r,a,i,o,s){if(t>=n-1){var l=u[t];return l.x0=a,l.y0=i,l.x1=o,void(l.y1=s)}var f=c[t],d=r/2+f,h=t+1,p=n-1;for(;h<p;){var v=h+p>>>1;c[v]<d?h=v+1:p=v}d-c[h-1]<c[h]-d&&t+1<h&&--h;var g=c[h]-f,m=r-g;if(o-a>s-i){var y=r?(a*m+o*g)/r:o;e(t,h,g,a,i,y,s),e(h,n,m,y,i,o,s)}else{var b=r?(i*m+s*g)/r:s;e(t,h,g,a,i,o,b),e(h,n,m,a,b,o,s)}}(0,s,e.value,t,n,r,a)},dice:Lz,slice:eL,slicedice:function(e,t,n,r,a){(1&e.depth?eL:Lz)(e,t,n,r,a)},squarify:rL,resquarify:aL},kL=["x0","y0","x1","y1","depth","children"];function wL(e){cL.call(this,e)}function _L(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function CL(e){this._context=e}function SL(){}function AL(e){this._context=e}function EL(e){this._context=e}function TL(e,t){this._basis=new CL(e),this._beta=t}wL.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:kL.length,default:kL}]},ht(wL,cL,{layout:function(){var e=function(){var e=rL,t=!1,n=1,r=1,a=[0],i=Iz,o=Iz,u=Iz,s=Iz,c=Iz;function l(e){return e.x0=e.y0=0,e.x1=n,e.y1=r,e.eachBefore(f),a=[0],t&&e.eachBefore(zz),e}function f(t){var n=a[t.depth],r=t.x0+n,l=t.y0+n,f=t.x1-n,d=t.y1-n;f<r&&(r=f=(r+f)/2),d<l&&(l=d=(l+d)/2),t.x0=r,t.y0=l,t.x1=f,t.y1=d,t.children&&(n=a[t.depth+1]=i(t)/2,r+=c(t)-n,l+=o(t)-n,(f-=u(t)-n)<r&&(r=f=(r+f)/2),(d-=s(t)-n)<l&&(l=d=(l+d)/2),e(t,r,l,f,d))}return l.round=function(e){return arguments.length?(t=!!e,l):t},l.size=function(e){return arguments.length?(n=+e[0],r=+e[1],l):[n,r]},l.tile=function(t){return arguments.length?(e=Fz(t),l):e},l.padding=function(e){return arguments.length?l.paddingInner(e).paddingOuter(e):l.paddingInner()},l.paddingInner=function(e){return arguments.length?(i="function"===typeof e?e:Mz(+e),l):i},l.paddingOuter=function(e){return arguments.length?l.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):l.paddingTop()},l.paddingTop=function(e){return arguments.length?(o="function"===typeof e?e:Mz(+e),l):o},l.paddingRight=function(e){return arguments.length?(u="function"===typeof e?e:Mz(+e),l):u},l.paddingBottom=function(e){return arguments.length?(s="function"===typeof e?e:Mz(+e),l):s},l.paddingLeft=function(e){return arguments.length?(c="function"===typeof e?e:Mz(+e),l):c},l}();return e.ratio=function(t){var n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=function(t){ct(xL,t)?e.tile(xL[t]):se("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:kL}),CL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:_L(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:_L(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},AL.prototype={areaStart:SL,areaEnd:SL,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:_L(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},EL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:_L(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},TL.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,a=e[0],i=t[0],o=e[n]-a,u=t[n]-i,s=-1;++s<=n;)r=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(a+r*o),this._beta*t[s]+(1-this._beta)*(i+r*u));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var NL=function e(t){function n(e){return 1===t?new CL(e):new TL(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function DL(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function FL(e,t){this._context=e,this._k=(1-t)/6}FL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:DL(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:DL(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var IL=function e(t){function n(e){return new FL(e,t)}return n.tension=function(t){return e(+t)},n}(0);function ML(e,t){this._context=e,this._k=(1-t)/6}ML.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:DL(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var OL=function e(t){function n(e){return new ML(e,t)}return n.tension=function(t){return e(+t)},n}(0);function RL(e,t){this._context=e,this._k=(1-t)/6}RL.prototype={areaStart:SL,areaEnd:SL,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:DL(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var ZL=function e(t){function n(e){return new RL(e,t)}return n.tension=function(t){return e(+t)},n}(0),BL=Math.abs,zL=Math.atan2,LL=Math.cos,PL=Math.max,jL=Math.min,UL=Math.sin,WL=Math.sqrt,VL=1e-12,GL=Math.PI,qL=GL/2,HL=2*GL;function XL(e){return e>1?0:e<-1?GL:Math.acos(e)}function YL(e){return e>=1?qL:e<=-1?-qL:Math.asin(e)}function KL(e,t,n){var r=e._x1,a=e._y1,i=e._x2,o=e._y2;if(e._l01_a>VL){var u=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,s=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*u-e._x0*e._l12_2a+e._x2*e._l01_2a)/s,a=(a*u-e._y0*e._l12_2a+e._y2*e._l01_2a)/s}if(e._l23_a>VL){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,l=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*c+e._x1*e._l23_2a-t*e._l12_2a)/l,o=(o*c+e._y1*e._l23_2a-n*e._l12_2a)/l}e._context.bezierCurveTo(r,a,i,o,e._x2,e._y2)}function $L(e,t){this._context=e,this._alpha=t}$L.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:KL(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var QL=function e(t){function n(e){return t?new $L(e,t):new FL(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function JL(e,t){this._context=e,this._alpha=t}JL.prototype={areaStart:SL,areaEnd:SL,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:KL(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var eP=function e(t){function n(e){return t?new JL(e,t):new RL(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function tP(e,t){this._context=e,this._alpha=t}tP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:KL(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var nP=function e(t){function n(e){return t?new tP(e,t):new ML(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function rP(e){this._context=e}function aP(e){return new rP(e)}function iP(e){this._context=e}function oP(e){return e<0?-1:1}function uP(e,t,n){var r=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(r||a<0&&-0),o=(n-e._y1)/(a||r<0&&-0),u=(i*a+o*r)/(r+a);return(oP(i)+oP(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(u))||0}function sP(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function cP(e,t,n){var r=e._x0,a=e._y0,i=e._x1,o=e._y1,u=(i-r)/3;e._context.bezierCurveTo(r+u,a+u*t,i-u,o-u*n,i,o)}function lP(e){this._context=e}function fP(e){this._context=new dP(e)}function dP(e){this._context=e}function hP(e){this._context=e}function pP(e){var t,n,r=e.length-1,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function vP(e,t){this._context=e,this._t=t}rP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},iP.prototype={areaStart:SL,areaEnd:SL,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},lP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:cP(this,this._t0,sP(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,cP(this,sP(this,n=uP(this,e,t)),n);break;default:cP(this,this._t0,n=uP(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(fP.prototype=Object.create(lP.prototype)).point=function(e,t){lP.prototype.point.call(this,t,e)},dP.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,i){this._context.bezierCurveTo(t,e,r,n,i,a)}},hP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=pP(e),a=pP(t),i=0,o=1;o<n;++i,++o)this._context.bezierCurveTo(r[0][i],a[0][i],r[1][i],a[1][i],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},vP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var gP=Math.PI,mP=2*gP,yP=1e-6,bP=mP-yP;function xP(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function kP(){return new xP}xP.prototype=kP.prototype={constructor:xP,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,a,i){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+a)+","+(this._y1=+i)},arcTo:function(e,t,n,r,a){e=+e,t=+t,n=+n,r=+r,a=+a;var i=this._x1,o=this._y1,u=n-e,s=r-t,c=i-e,l=o-t,f=c*c+l*l;if(a<0)throw new Error("negative radius: "+a);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>yP)if(Math.abs(l*u-s*c)>yP&&a){var d=n-i,h=r-o,p=u*u+s*s,v=d*d+h*h,g=Math.sqrt(p),m=Math.sqrt(f),y=a*Math.tan((gP-Math.acos((p+f-v)/(2*g*m)))/2),b=y/m,x=y/g;Math.abs(b-1)>yP&&(this._+="L"+(e+b*c)+","+(t+b*l)),this._+="A"+a+","+a+",0,0,"+ +(l*d>c*h)+","+(this._x1=e+x*u)+","+(this._y1=t+x*s)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function(e,t,n,r,a,i){e=+e,t=+t,i=!!i;var o=(n=+n)*Math.cos(r),u=n*Math.sin(r),s=e+o,c=t+u,l=1^i,f=i?r-a:a-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+s+","+c:(Math.abs(this._x1-s)>yP||Math.abs(this._y1-c)>yP)&&(this._+="L"+s+","+c),n&&(f<0&&(f=f%mP+mP),f>bP?this._+="A"+n+","+n+",0,1,"+l+","+(e-o)+","+(t-u)+"A"+n+","+n+",0,1,"+l+","+(this._x1=s)+","+(this._y1=c):f>yP&&(this._+="A"+n+","+n+",0,"+ +(f>=gP)+","+l+","+(this._x1=e+n*Math.cos(a))+","+(this._y1=t+n*Math.sin(a))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var wP=kP;function _P(e){return function(){return e}}function CP(e){return e.innerRadius}function SP(e){return e.outerRadius}function AP(e){return e.startAngle}function EP(e){return e.endAngle}function TP(e){return e&&e.padAngle}function NP(e,t,n,r,a,i,o,u){var s=n-e,c=r-t,l=o-a,f=u-i,d=f*s-l*c;if(!(d*d<VL))return[e+(d=(l*(t-i)-f*(e-a))/d)*s,t+d*c]}function DP(e,t,n,r,a,i,o){var u=e-n,s=t-r,c=(o?i:-i)/WL(u*u+s*s),l=c*s,f=-c*u,d=e+l,h=t+f,p=n+l,v=r+f,g=(d+p)/2,m=(h+v)/2,y=p-d,b=v-h,x=y*y+b*b,k=a-i,w=d*v-p*h,_=(b<0?-1:1)*WL(PL(0,k*k*x-w*w)),C=(w*b-y*_)/x,S=(-w*y-b*_)/x,A=(w*b+y*_)/x,E=(-w*y+b*_)/x,T=C-g,N=S-m,D=A-g,F=E-m;return T*T+N*N>D*D+F*F&&(C=A,S=E),{cx:C,cy:S,x01:-l,y01:-f,x11:C*(a/k-1),y11:S*(a/k-1)}}Array.prototype.slice;function FP(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function IP(e){return e[0]}function MP(e){return e[1]}function OP(e,t){var n=_P(!0),r=null,a=aP,i=null;function o(o){var u,s,c,l=(o=FP(o)).length,f=!1;for(null==r&&(i=a(c=wP())),u=0;u<=l;++u)!(u<l&&n(s=o[u],u,o))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+e(s,u,o),+t(s,u,o));if(c)return i=null,c+""||null}return e="function"===typeof e?e:void 0===e?IP:_P(e),t="function"===typeof t?t:void 0===t?MP:_P(t),o.x=function(t){return arguments.length?(e="function"===typeof t?t:_P(+t),o):e},o.y=function(e){return arguments.length?(t="function"===typeof e?e:_P(+e),o):t},o.defined=function(e){return arguments.length?(n="function"===typeof e?e:_P(!!e),o):n},o.curve=function(e){return arguments.length?(a=e,null!=r&&(i=a(r)),o):a},o.context=function(e){return arguments.length?(null==e?r=i=null:i=a(r=e),o):r},o}function RP(e,t,n){var r=null,a=_P(!0),i=null,o=aP,u=null;function s(s){var c,l,f,d,h,p=(s=FP(s)).length,v=!1,g=new Array(p),m=new Array(p);for(null==i&&(u=o(h=wP())),c=0;c<=p;++c){if(!(c<p&&a(d=s[c],c,s))===v)if(v=!v)l=c,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),f=c-1;f>=l;--f)u.point(g[f],m[f]);u.lineEnd(),u.areaEnd()}v&&(g[c]=+e(d,c,s),m[c]=+t(d,c,s),u.point(r?+r(d,c,s):g[c],n?+n(d,c,s):m[c]))}if(h)return u=null,h+""||null}function c(){return OP().defined(a).curve(o).context(i)}return e="function"===typeof e?e:void 0===e?IP:_P(+e),t="function"===typeof t?t:_P(void 0===t?0:+t),n="function"===typeof n?n:void 0===n?MP:_P(+n),s.x=function(t){return arguments.length?(e="function"===typeof t?t:_P(+t),r=null,s):e},s.x0=function(t){return arguments.length?(e="function"===typeof t?t:_P(+t),s):e},s.x1=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:_P(+e),s):r},s.y=function(e){return arguments.length?(t="function"===typeof e?e:_P(+e),n=null,s):t},s.y0=function(e){return arguments.length?(t="function"===typeof e?e:_P(+e),s):t},s.y1=function(e){return arguments.length?(n=null==e?null:"function"===typeof e?e:_P(+e),s):n},s.lineX0=s.lineY0=function(){return c().x(e).y(t)},s.lineY1=function(){return c().x(e).y(n)},s.lineX1=function(){return c().x(r).y(t)},s.defined=function(e){return arguments.length?(a="function"===typeof e?e:_P(!!e),s):a},s.curve=function(e){return arguments.length?(o=e,null!=i&&(u=o(i)),s):o},s.context=function(e){return arguments.length?(null==e?i=u=null:u=o(i=e),s):i},s}var ZP={draw:function(e,t){var n=Math.sqrt(t/GL);e.moveTo(n,0),e.arc(0,0,n,0,HL)}},BP=(Math.sqrt(1/3),Math.sin(GL/10)/Math.sin(7*GL/10));Math.sin(HL/10),Math.cos(HL/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12);var zP={},LP={};function PP(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function jP(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function UP(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function WP(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),a=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":function(e){return e<0?"-"+UP(-e,6):e>9999?"+"+UP(e,6):UP(e,4)}(e.getUTCFullYear())+"-"+UP(e.getUTCMonth()+1,2)+"-"+UP(e.getUTCDate(),2)+(a?"T"+UP(t,2)+":"+UP(n,2)+":"+UP(r,2)+"."+UP(a,3)+"Z":r?"T"+UP(t,2)+":"+UP(n,2)+":"+UP(r,2)+"Z":n||t?"T"+UP(t,2)+":"+UP(n,2)+"Z":"")}function VP(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,a=[],i=e.length,o=0,u=0,s=i<=0,c=!1;function l(){if(s)return LP;if(c)return c=!1,zP;var t,r,a=o;if(34===e.charCodeAt(a)){for(;o++<i&&34!==e.charCodeAt(o)||34===e.charCodeAt(++o););return(t=o)>=i?s=!0:10===(r=e.charCodeAt(o++))?c=!0:13===r&&(c=!0,10===e.charCodeAt(o)&&++o),e.slice(a+1,t-1).replace(/""/g,'"')}for(;o<i;){if(10===(r=e.charCodeAt(t=o++)))c=!0;else if(13===r)c=!0,10===e.charCodeAt(o)&&++o;else if(r!==n)continue;return e.slice(a,t)}return s=!0,e.slice(a,i)}for(10===e.charCodeAt(i-1)&&--i,13===e.charCodeAt(i-1)&&--i;(r=l())!==LP;){for(var f=[];r!==zP&&r!==LP;)f.push(r),r=l();t&&null==(f=t(f,u++))||a.push(f)}return a}function a(t,n){return t.map((function(t){return n.map((function(e){return o(t[e])})).join(e)}))}function i(t){return t.map(o).join(e)}function o(e){return null==e?"":e instanceof Date?WP(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,a,i=r(e,(function(e,r){if(n)return n(e,r-1);a=e,n=t?function(e,t){var n=PP(e);return function(r,a){return t(n(r),a,e)}}(e,t):PP(e)}));return i.columns=a||[],i},parseRows:r,format:function(t,n){return null==n&&(n=jP(t)),[n.map(o).join(e)].concat(a(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=jP(e)),a(e,t).join("\n")},formatRows:function(e){return e.map(i).join("\n")},formatRow:i,formatValue:o}}var GP,qP=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function HP(e){if(!(t=qP.exec(e)))throw new Error("invalid format: "+e);var t;return new XP({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function XP(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function YP(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function KP(e){return(e=YP(Math.abs(e)))?e[1]:NaN}function $P(e,t){var n=YP(e,t);if(!n)return e+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}HP.prototype=XP.prototype,XP.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var QP={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return $P(100*e,t)},r:$P,s:function(e,t){var n=YP(e,t);if(!n)return e+"";var r=n[0],a=n[1],i=a-(GP=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+YP(e,Math.max(0,t+i-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function JP(e){return e}var ej,tj,nj,rj,aj,ij=Array.prototype.map,oj=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function uj(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?JP:(t=ij.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var a=e.length,i=[],o=0,u=t[0],s=0;a>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),i.push(e.substring(a-=u,a+u)),!((s+=u+1)>r));)u=t[o=(o+1)%t.length];return i.reverse().join(n)}),a=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",u=void 0===e.numerals?JP:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(ij.call(e.numerals,String)),s=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",l=void 0===e.nan?"NaN":e.nan+"";function f(e){var t=(e=HP(e)).fill,n=e.align,f=e.sign,d=e.symbol,h=e.zero,p=e.width,v=e.comma,g=e.precision,m=e.trim,y=e.type;"n"===y?(v=!0,y="g"):QP[y]||(void 0===g&&(g=12),m=!0,y="g"),(h||"0"===t&&"="===n)&&(h=!0,t="0",n="=");var b="$"===d?a:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",x="$"===d?i:/[%p]/.test(y)?s:"",k=QP[y],w=/[defgprs%]/.test(y);function _(e){var a,i,s,d=b,_=x;if("c"===y)_=k(e)+_,e="";else{var C=(e=+e)<0||1/e<0;if(e=isNaN(e)?l:k(Math.abs(e),g),m&&(e=function(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}(e)),C&&0===+e&&"+"!==f&&(C=!1),d=(C?"("===f?f:c:"-"===f||"("===f?"":f)+d,_=("s"===y?oj[8+GP/3]:"")+_+(C&&"("===f?")":""),w)for(a=-1,i=e.length;++a<i;)if(48>(s=e.charCodeAt(a))||s>57){_=(46===s?o+e.slice(a+1):e.slice(a))+_,e=e.slice(0,a);break}}v&&!h&&(e=r(e,1/0));var S=d.length+e.length+_.length,A=S<p?new Array(p-S+1).join(t):"";switch(v&&h&&(e=r(A+e,A.length?p-_.length:1/0),A=""),n){case"<":e=d+e+_+A;break;case"=":e=d+A+e+_;break;case"^":e=A.slice(0,S=A.length>>1)+d+e+_+A.slice(S);break;default:e=A+d+e+_}return u(e)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),_.toString=function(){return e+""},_}return{format:f,formatPrefix:function(e,t){var n=f(((e=HP(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(KP(t)/3))),a=Math.pow(10,-r),i=oj[8+r/3];return function(e){return n(a*e)+i}}}}function sj(e){var t={};return function(n){return t[n]||(t[n]=e(n))}}function cj(e){var t=sj(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat:function(e){var n=HP(e||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(e,t){return function(n){var r=e(n),a=r.indexOf(t);if(a<0)return r;for(var i=function(e,t){var n,r=e.lastIndexOf("e");if(r>0)return r;for(r=e.length;--r>t;)if((n=e.charCodeAt(r))>=48&&n<=57)return r+1}(r,a),o=i<r.length?r.slice(i):"";--i>a;)if("0"!==r[i]){++i;break}return r.slice(0,i)+o}}(t(n),t(".1f")(1)[1])}return t(n)},formatSpan:function(e,r,a,i){i=HP(null==i?",f":i);var o,u=Lc(e,r,a),s=Math.max(Math.abs(e),Math.abs(r));if(null==i.precision)switch(i.type){case"s":return isNaN(o=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(KP(t)/3)))-KP(Math.abs(e)))}(u,s))||(i.precision=o),n(i,s);case"":case"e":case"g":case"p":case"r":isNaN(o=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,KP(t)-KP(e))+1}(u,s))||(i.precision=o-("e"===i.type));break;case"f":case"%":isNaN(o=function(e){return Math.max(0,-KP(Math.abs(e)))}(u))||(i.precision=o-2*("%"===i.type))}return t(i)}}}function lj(){return rj=cj({format:tj,formatPrefix:nj})}function fj(e){return cj(uj(e))}function dj(e){return arguments.length?rj=fj(e):rj}function hj(e,t,n){Se(n=n||{})||se("Invalid time multi-format specifier: ".concat(n));var r=t(Yc),a=t(Xc),i=t(Hc),o=t(Vc),u=t(Wc),s=t(Uc),c=t(jc),l=t(Pc),f=e(n[Kc]||".%L"),d=e(n[Yc]||":%S"),h=e(n[Xc]||"%I:%M"),p=e(n[Hc]||"%I %p"),v=e(n[Vc]||n[Gc]||"%a %d"),g=e(n[Wc]||"%b %d"),m=e(n[Uc]||"%B"),y=e(n[jc]||"%B"),b=e(n[Pc]||"%Y");return function(e){return(r(e)<e?f:a(e)<e?d:i(e)<e?h:o(e)<e?p:s(e)<e?u(e)<e?v:g:l(e)<e?c(e)<e?m:y:b)(e)}}function pj(e){var t=sj(e.format),n=sj(e.utcFormat);return{timeFormat:function(e){return xt(e)?t(e):hj(t,Al,e)},utcFormat:function(e){return xt(e)?n(e):hj(n,El,e)},timeParse:sj(e.parse),utcParse:sj(e.utcParse)}}function vj(){return aj=pj({format:AN,parse:EN,utcFormat:TN,utcParse:NN})}function gj(e){return pj(CN(e))}function mj(e){return arguments.length?aj=gj(e):aj}!function(e){ej=uj(e),tj=ej.format,nj=ej.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]}),lj(),vj();var yj=function(e,t){return it({},e,t)};function bj(e,t){var n=e?fj(e):dj(),r=t?gj(t):mj();return yj(n,r)}function xj(e,t){var n=arguments.length;return n&&2!==n&&se("defaultLocale expects either zero or two arguments."),n?yj(dj(e),mj(t)):yj(dj(),mj())}function kj(){return lj(),vj(),xj()}var wj=/^(data:|([A-Za-z]+:)?\/\/)/,_j=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Cj=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Sj="file://";function Aj(e,t){return Ej.apply(this,arguments)}function Ej(){return(Ej=(0,Bt.Z)((0,w.Z)().mark((function e(t,n){var r,a;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sanitize(t,n);case 2:return r=e.sent,a=r.href,e.abrupt("return",r.localFile?this.file(a):this.http(a,n));case 5:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function Tj(e,t){return Nj.apply(this,arguments)}function Nj(){return Nj=(0,Bt.Z)((0,w.Z)().mark((function e(t,n){var r,a,i,o,u,s,c;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=it({},this.options,n),r=this.fileAccess,a={href:null},s=_j.test(t.replace(Cj,"")),null!=t&&"string"===typeof t&&s||se("Sanitize failure, invalid URI: "+Tt(t)),c=wj.test(t),(u=n.baseURL)&&!c&&(t.startsWith("/")||u.endsWith("/")||(t="/"+t),t=u+t),o=(i=t.startsWith(Sj))||"file"===n.mode||"http"!==n.mode&&!c&&r,i?t=t.slice(Sj.length):t.startsWith("//")&&("file"===n.defaultProtocol?(t=t.slice(2),o=!0):t=(n.defaultProtocol||"http")+":"+t),Object.defineProperty(a,"localFile",{value:!!o}),a.href=t,n.target&&(a.target=n.target+""),n.rel&&(a.rel=n.rel+""),"image"===n.context&&n.crossOrigin&&(a.crossOrigin=n.crossOrigin+""),e.abrupt("return",a);case 14:case"end":return e.stop()}}),e,this)}))),Nj.apply(this,arguments)}function Dj(e){return e?function(t){return new Promise((function(n,r){e.readFile(t,(function(e,t){e?r(e):n(t)}))}))}:Fj}function Fj(){return Ij.apply(this,arguments)}function Ij(){return(Ij=(0,Bt.Z)((0,w.Z)().mark((function e(){return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:se("No file system access.");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Mj(e){return e?function(){var t=(0,Bt.Z)((0,w.Z)().mark((function t(n,r){var a,i,o;return(0,w.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=it({},this.options.http,r),i=r&&r.response,t.next=4,e(n,a);case 4:return o=t.sent,t.abrupt("return",o.ok?$e(o[i])?o[i]():o.text():se(o.status+""+o.statusText));case 6:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}():Oj}function Oj(){return Rj.apply(this,arguments)}function Rj(){return(Rj=(0,Bt.Z)((0,w.Z)().mark((function e(){return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:se("No HTTP fetch method available.");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Zj=function(e){return!Number.isNaN(+e)&&!(e instanceof Date)},Bj={boolean:Nt,integer:Fe,number:Fe,date:Ft,string:It,unknown:de},zj=[function(e){return"true"===e||"false"===e||!0===e||!1===e},function(e){return Zj(e)&&Number.isInteger(+e)},Zj,function(e){return!Number.isNaN(Date.parse(e))}],Lj=["boolean","integer","number","date"];function Pj(e,t){if(!e||!e.length)return"unknown";for(var n,r,a,i=e.length,o=zj.length,u=zj.map((function(e,t){return t+1})),s=0,c=0;s<i;++s)for(r=t?e[s][t]:e[s],n=0;n<o;++n)if(u[n]&&(null!=(a=r)&&a===a)&&!zj[n](r)&&(u[n]=0,++c===zj.length))return"string";return Lj[u.reduce((function(e,t){return 0===e?t:e}),0)-1]}function jj(e,t){return t.reduce((function(t,n){return t[n]=Pj(e,n),t}),{})}function Uj(e){var t=function(t,n){var r={delimiter:e};return Wj(t,n?it(n,r):r)};return t.responseType="text",t}function Wj(e,t){return t.header&&(e=t.header.map(Tt).join(t.delimiter)+"\n"+e),VP(t.delimiter).parse(e+"")}function Vj(e,t){var n,r=t&&t.property?le(t.property):de;return!Se(e)||(n=e,"function"===typeof Buffer&&$e(Buffer.isBuffer)&&Buffer.isBuffer(n))?r(JSON.parse(e)):function(e,t){!Ce(e)&&mt(e)&&(e=(0,ln.Z)(e));return t&&t.copy?JSON.parse(JSON.stringify(e)):e}(r(e),t)}Wj.responseType="text",Vj.responseType="json";var Gj={interior:function(e,t){return e!==t},exterior:function(e,t){return e===t}};function qj(e,t){var n,r,a,i;return e=Vj(e,t),t&&t.feature?(n=bn,a=t.feature):t&&t.mesh?(n=_n,a=t.mesh,i=Gj[t.filter]):se("Missing TopoJSON feature or mesh parameter."),(r=(r=e.objects[a])?n(e,r,i):se("Invalid TopoJSON object: "+a))&&r.features||[r]}qj.responseType="json";var Hj={dsv:Wj,csv:Uj(","),tsv:Uj("\t"),json:Vj,topojson:qj};function Xj(e,t){return arguments.length>1?(Hj[e]=t,this):ct(Hj,e)?Hj[e]:null}function Yj(e){var t=Xj(e);return t&&t.responseType||"text"}function Kj(e,t,n,r){var a=Xj((t=t||{}).type||"json");return a||se("Unknown data format type: "+t.type),e=a(e,t),t.parse&&function(e,t,n,r){if(!e.length)return;var a=mj();n=n||a.timeParse,r=r||a.utcParse;var i,o,u,s,c,l,f=e.columns||Object.keys(e[0]);"auto"===t&&(t=jj(e,f));f=Object.keys(t);var d=f.map((function(e){var a,i,o=t[e];if(o&&(o.startsWith("date:")||o.startsWith("utc:")))return("'"===(i=(a=o.split(/:(.+)?/,2))[1])[0]&&"'"===i[i.length-1]||'"'===i[0]&&'"'===i[i.length-1])&&(i=i.slice(1,-1)),("utc"===a[0]?r:n)(i);if(!Bj[o])throw Error("Illegal format pattern: "+e+":"+o);return Bj[o]}));for(u=0,c=e.length,l=f.length;u<c;++u)for(i=e[u],s=0;s<l;++s)i[o=f[s]]=d[s](i[o])}(e,t.parse,n,r),ct(e,"columns")&&delete e.columns,e}var $j=function(e,t){return function(n){return{options:n||{},sanitize:Tj,load:Aj,fileAccess:!!t,file:Dj(t),http:Mj(e)}}}("undefined"!==typeof fetch&&fetch,null),Qj=0;var Jj="p_";function eU(e){return e&&e.gradient}function tU(e,t,n){var r=e.gradient,a=e.id,i="radial"===r?Jj:"";return a||(a=e.id="gradient_"+Qj++,"radial"===r?(e.x1=nU(e.x1,.5),e.y1=nU(e.y1,.5),e.r1=nU(e.r1,0),e.x2=nU(e.x2,.5),e.y2=nU(e.y2,.5),e.r2=nU(e.r2,.5),i=Jj):(e.x1=nU(e.x1,0),e.y1=nU(e.y1,0),e.x2=nU(e.x2,1),e.y2=nU(e.y2,0))),t[a]=e,"url("+(n||"")+"#"+i+a+")"}function nU(e,t){return null!=e?e:t}function rU(e,t){var n,r=[];return n={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:r,stop:function(e,t){return r.push({offset:e,color:t}),n}}}var aU={basis:{curve:function(e){return new CL(e)}},"basis-closed":{curve:function(e){return new AL(e)}},"basis-open":{curve:function(e){return new EL(e)}},bundle:{curve:NL,tension:"beta",value:.85},cardinal:{curve:IL,tension:"tension",value:0},"cardinal-open":{curve:OL,tension:"tension",value:0},"cardinal-closed":{curve:ZL,tension:"tension",value:0},"catmull-rom":{curve:QL,tension:"alpha",value:.5},"catmull-rom-closed":{curve:eP,tension:"alpha",value:.5},"catmull-rom-open":{curve:nP,tension:"alpha",value:.5},linear:{curve:aP},"linear-closed":{curve:function(e){return new iP(e)}},monotone:{horizontal:function(e){return new fP(e)},vertical:function(e){return new lP(e)}},natural:{curve:function(e){return new hP(e)}},step:{curve:function(e){return new vP(e,.5)}},"step-after":{curve:function(e){return new vP(e,1)}},"step-before":{curve:function(e){return new vP(e,0)}}};function iU(e,t,n){var r=ct(aU,e)&&aU[e],a=null;return r&&(a=r.curve||r[t||"vertical"],r.tension&&null!=n&&(a=a[r.tension](n))),a}var oU={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},uU=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function sU(e){var t,n,r,a,i,o,u,s,c,l,f=[],d=e.slice().replace(uU[0],"###$1").split(uU[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=(t=d[u]).slice(1).trim().replace(uU[2],"$1###$2").replace(uU[3],"$1###$2").split(uU[4]),r=[i=t.charAt(0)],s=0,l=n.length;s<l;++s)(a=+n[s])===a&&r.push(a);if(o=oU[i.toLowerCase()],r.length-1>o){var h=r.length;for(s=1,f.push([i].concat(r.slice(s,s+=o))),i="M"===i?"L":"m"===i?"l":i;s<h;s+=o)f.push([i].concat(r.slice(s,s+o)))}else f.push(r)}return f}var cU=Math.PI/180,lU=Math.PI/2,fU=2*Math.PI,dU=Math.sqrt(3)/2,hU={},pU={},vU=[].join;function gU(e){var t=vU.call(e);if(pU[t])return pU[t];var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],s=e[6],c=e[7],l=c*o,f=-s*u,d=s*o,h=c*u,p=Math.cos(a),v=Math.sin(a),g=Math.cos(i),m=Math.sin(i),y=.5*(i-a),b=Math.sin(.5*y),x=8/3*b*b/Math.sin(y),k=n+p-x*v,w=r+v+x*p,_=n+g,C=r+m,S=_+x*m,A=C-x*g;return pU[t]=[l*k+f*w,d*k+h*w,l*S+f*A,d*S+h*A,l*_+f*C,d*_+h*C]}var mU=["l",0,0,0,0,0,0,0];function yU(e,t,n){var r=mU[0]=e[0];if("a"===r||"A"===r)mU[1]=t*e[1],mU[2]=n*e[2],mU[3]=e[3],mU[4]=e[4],mU[5]=e[5],mU[6]=t*e[6],mU[7]=n*e[7];else if("h"===r||"H"===r)mU[1]=t*e[1];else if("v"===r||"V"===r)mU[1]=n*e[1];else for(var a=1,i=e.length;a<i;++a)mU[a]=(a%2==1?t:n)*e[a];return mU}function bU(e,t,n,r,a,i){var o,u,s,c,l,f=null,d=0,h=0,p=0,v=0;null==n&&(n=0),null==r&&(r=0),null==a&&(a=1),null==i&&(i=a),e.beginPath&&e.beginPath();for(var g=0,m=t.length;g<m;++g){switch(o=t[g],1===a&&1===i||(o=yU(o,a,i)),o[0]){case"l":d+=o[1],h+=o[2],e.lineTo(d+n,h+r);break;case"L":d=o[1],h=o[2],e.lineTo(d+n,h+r);break;case"h":d+=o[1],e.lineTo(d+n,h+r);break;case"H":d=o[1],e.lineTo(d+n,h+r);break;case"v":h+=o[1],e.lineTo(d+n,h+r);break;case"V":h=o[1],e.lineTo(d+n,h+r);break;case"m":d+=o[1],h+=o[2],e.moveTo(d+n,h+r);break;case"M":d=o[1],h=o[2],e.moveTo(d+n,h+r);break;case"c":u=d+o[5],s=h+o[6],p=d+o[3],v=h+o[4],e.bezierCurveTo(d+o[1]+n,h+o[2]+r,p+n,v+r,u+n,s+r),d=u,h=s;break;case"C":d=o[5],h=o[6],p=o[3],v=o[4],e.bezierCurveTo(o[1]+n,o[2]+r,p+n,v+r,d+n,h+r);break;case"s":u=d+o[3],s=h+o[4],p=2*d-p,v=2*h-v,e.bezierCurveTo(p+n,v+r,d+o[1]+n,h+o[2]+r,u+n,s+r),p=d+o[1],v=h+o[2],d=u,h=s;break;case"S":u=o[3],s=o[4],p=2*d-p,v=2*h-v,e.bezierCurveTo(p+n,v+r,o[1]+n,o[2]+r,u+n,s+r),d=u,h=s,p=o[1],v=o[2];break;case"q":u=d+o[3],s=h+o[4],p=d+o[1],v=h+o[2],e.quadraticCurveTo(p+n,v+r,u+n,s+r),d=u,h=s;break;case"Q":u=o[3],s=o[4],e.quadraticCurveTo(o[1]+n,o[2]+r,u+n,s+r),d=u,h=s,p=o[1],v=o[2];break;case"t":u=d+o[1],s=h+o[2],null===f[0].match(/[QqTt]/)?(p=d,v=h):"t"===f[0]?(p=2*d-c,v=2*h-l):"q"===f[0]&&(p=2*d-p,v=2*h-v),c=p,l=v,e.quadraticCurveTo(p+n,v+r,u+n,s+r),h=s,p=(d=u)+o[1],v=h+o[2];break;case"T":u=o[1],s=o[2],p=2*d-p,v=2*h-v,e.quadraticCurveTo(p+n,v+r,u+n,s+r),d=u,h=s;break;case"a":xU(e,d+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+d+n,o[7]+h+r]),d+=o[6],h+=o[7];break;case"A":xU(e,d+n,h+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),d=o[6],h=o[7];break;case"z":case"Z":e.closePath()}f=o}}function xU(e,t,n,r){for(var a=function(e,t,n,r,a,i,o,u,s){var c=vU.call(arguments);if(hU[c])return hU[c];var l=o*cU,f=Math.sin(l),d=Math.cos(l),h=d*(u-e)*.5+f*(s-t)*.5,p=d*(s-t)*.5-f*(u-e)*.5,v=h*h/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);v>1&&(n*=v=Math.sqrt(v),r*=v);var g=d/n,m=f/n,y=-f/r,b=d/r,x=g*u+m*s,k=y*u+b*s,w=g*e+m*t,_=y*e+b*t,C=(w-x)*(w-x)+(_-k)*(_-k),S=1/C-.25;S<0&&(S=0);var A=Math.sqrt(S);i==a&&(A=-A);var E=.5*(x+w)-A*(_-k),T=.5*(k+_)+A*(w-x),N=Math.atan2(k-T,x-E),D=Math.atan2(_-T,w-E),F=D-N;F<0&&1===i?F+=fU:F>0&&0===i&&(F-=fU);for(var I=Math.ceil(Math.abs(F/(lU+.001))),M=[],O=0;O<I;++O){var R=N+O*F/I,Z=N+(O+1)*F/I;M[O]=[E,T,R,Z,n,r,f,d]}return hU[c]=M}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n),i=0;i<a.length;++i){var o=gU(a[i]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var kU=.5773502691896257,wU={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,fU)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,a=n/2.5,i=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-i),e.lineTo(a,-i),e.lineTo(0,-n),e.lineTo(-a,-i),e.lineTo(-r,-i),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=dU*n,a=r-n*kU,i=n/4;e.moveTo(0,-r-a),e.lineTo(-i,r-a),e.lineTo(i,r-a),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=dU*n,a=r-n*kU;e.moveTo(0,-r-a),e.lineTo(-n,r-a),e.lineTo(n,r-a),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=dU*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=dU*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=dU*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=dU*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function _U(e){return ct(wU,e)?wU[e]:function(e){if(!ct(CU,e)){var t=sU(e);CU[e]={draw:function(e,n){bU(e,t,0,0,Math.sqrt(n)/2)}}}return CU[e]}(e)}var CU={};var SU=.448084975506;function AU(e){return e.x}function EU(e){return e.y}function TU(e){return e.width}function NU(e){return e.height}function DU(e){return"function"===typeof e?e:function(){return+e}}function FU(e,t,n){return Math.max(t,Math.min(e,n))}function IU(){var e=AU,t=EU,n=TU,r=NU,a=DU(0),i=a,o=a,u=a,s=null;function c(c,l,f){var d,h=null!=l?l:+e.call(this,c),p=null!=f?f:+t.call(this,c),v=+n.call(this,c),g=+r.call(this,c),m=Math.min(v,g)/2,y=FU(+a.call(this,c),0,m),b=FU(+i.call(this,c),0,m),x=FU(+o.call(this,c),0,m),k=FU(+u.call(this,c),0,m);if(s||(s=d=wP()),y<=0&&b<=0&&x<=0&&k<=0)s.rect(h,p,v,g);else{var w=h+v,_=p+g;s.moveTo(h+y,p),s.lineTo(w-b,p),s.bezierCurveTo(w-SU*b,p,w,p+SU*b,w,p+b),s.lineTo(w,_-k),s.bezierCurveTo(w,_-SU*k,w-SU*k,_,w-k,_),s.lineTo(h+x,_),s.bezierCurveTo(h+SU*x,_,h,_-SU*x,h,_-x),s.lineTo(h,p+y),s.bezierCurveTo(h,p+SU*y,h+SU*y,p,h+y,p),s.closePath()}if(d)return s=null,d+""||null}return c.x=function(t){return arguments.length?(e=DU(t),c):e},c.y=function(e){return arguments.length?(t=DU(e),c):t},c.width=function(e){return arguments.length?(n=DU(e),c):n},c.height=function(e){return arguments.length?(r=DU(e),c):r},c.cornerRadius=function(e,t,n,r){return arguments.length?(a=DU(e),i=null!=t?DU(t):a,u=null!=n?DU(n):a,o=null!=r?DU(r):i,c):a},c.context=function(e){return arguments.length?(s=null==e?null:e,c):s},c}function MU(){var e,t,n,r,a,i,o,u,s=null;function c(e,t,n){var r=n/2;if(a){var c=o-t,l=e-i;if(c||l){var f=Math.sqrt(c*c+l*l),d=(c/=f)*u,h=(l/=f)*u,p=Math.atan2(l,c);s.moveTo(i-d,o-h),s.lineTo(e-c*r,t-l*r),s.arc(e,t,r,p-Math.PI,p),s.lineTo(i+d,o+h),s.arc(i,o,u,p,p+Math.PI)}else s.arc(e,t,r,0,fU);s.closePath()}else a=1;i=e,o=t,u=r}function l(i){var o,u,l,f=i.length,d=!1;for(null==s&&(s=l=wP()),o=0;o<=f;++o)!(o<f&&r(u=i[o],o,i))===d&&(d=!d)&&(a=0),d&&c(+e(u,o,i),+t(u,o,i),+n(u,o,i));if(l)return s=null,l+""||null}return l.x=function(t){return arguments.length?(e=t,l):e},l.y=function(e){return arguments.length?(t=e,l):t},l.size=function(e){return arguments.length?(n=e,l):n},l.defined=function(e){return arguments.length?(r=e,l):r},l.context=function(e){return arguments.length?(s=null==e?null:e,l):s},l}function OU(e,t){return null!=e?e:t}var RU=function(e){return e.x||0},ZU=function(e){return e.y||0},BU=function(e){return!(!1===e.defined)},zU=function(){var e=CP,t=SP,n=_P(0),r=null,a=AP,i=EP,o=TP,u=null;function s(){var s,c,l=+e.apply(this,arguments),f=+t.apply(this,arguments),d=a.apply(this,arguments)-qL,h=i.apply(this,arguments)-qL,p=BL(h-d),v=h>d;if(u||(u=s=wP()),f<l&&(c=f,f=l,l=c),f>VL)if(p>HL-VL)u.moveTo(f*LL(d),f*UL(d)),u.arc(0,0,f,d,h,!v),l>VL&&(u.moveTo(l*LL(h),l*UL(h)),u.arc(0,0,l,h,d,v));else{var g,m,y=d,b=h,x=d,k=h,w=p,_=p,C=o.apply(this,arguments)/2,S=C>VL&&(r?+r.apply(this,arguments):WL(l*l+f*f)),A=jL(BL(f-l)/2,+n.apply(this,arguments)),E=A,T=A;if(S>VL){var N=YL(S/l*UL(C)),D=YL(S/f*UL(C));(w-=2*N)>VL?(x+=N*=v?1:-1,k-=N):(w=0,x=k=(d+h)/2),(_-=2*D)>VL?(y+=D*=v?1:-1,b-=D):(_=0,y=b=(d+h)/2)}var F=f*LL(y),I=f*UL(y),M=l*LL(k),O=l*UL(k);if(A>VL){var R,Z=f*LL(b),B=f*UL(b),z=l*LL(x),L=l*UL(x);if(p<GL&&(R=NP(F,I,z,L,Z,B,M,O))){var P=F-R[0],j=I-R[1],U=Z-R[0],W=B-R[1],V=1/UL(XL((P*U+j*W)/(WL(P*P+j*j)*WL(U*U+W*W)))/2),G=WL(R[0]*R[0]+R[1]*R[1]);E=jL(A,(l-G)/(V-1)),T=jL(A,(f-G)/(V+1))}}_>VL?T>VL?(g=DP(z,L,F,I,f,T,v),m=DP(Z,B,M,O,f,T,v),u.moveTo(g.cx+g.x01,g.cy+g.y01),T<A?u.arc(g.cx,g.cy,T,zL(g.y01,g.x01),zL(m.y01,m.x01),!v):(u.arc(g.cx,g.cy,T,zL(g.y01,g.x01),zL(g.y11,g.x11),!v),u.arc(0,0,f,zL(g.cy+g.y11,g.cx+g.x11),zL(m.cy+m.y11,m.cx+m.x11),!v),u.arc(m.cx,m.cy,T,zL(m.y11,m.x11),zL(m.y01,m.x01),!v))):(u.moveTo(F,I),u.arc(0,0,f,y,b,!v)):u.moveTo(F,I),l>VL&&w>VL?E>VL?(g=DP(M,O,Z,B,l,-E,v),m=DP(F,I,z,L,l,-E,v),u.lineTo(g.cx+g.x01,g.cy+g.y01),E<A?u.arc(g.cx,g.cy,E,zL(g.y01,g.x01),zL(m.y01,m.x01),!v):(u.arc(g.cx,g.cy,E,zL(g.y01,g.x01),zL(g.y11,g.x11),!v),u.arc(0,0,l,zL(g.cy+g.y11,g.cx+g.x11),zL(m.cy+m.y11,m.cx+m.x11),v),u.arc(m.cx,m.cy,E,zL(m.y11,m.x11),zL(m.y01,m.x01),!v))):u.arc(0,0,l,k,x,v):u.lineTo(M,O)}else u.moveTo(0,0);if(u.closePath(),s)return u=null,s+""||null}return s.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+a.apply(this,arguments)+ +i.apply(this,arguments))/2-GL/2;return[LL(r)*n,UL(r)*n]},s.innerRadius=function(t){return arguments.length?(e="function"===typeof t?t:_P(+t),s):e},s.outerRadius=function(e){return arguments.length?(t="function"===typeof e?e:_P(+e),s):t},s.cornerRadius=function(e){return arguments.length?(n="function"===typeof e?e:_P(+e),s):n},s.padRadius=function(e){return arguments.length?(r=null==e?null:"function"===typeof e?e:_P(+e),s):r},s.startAngle=function(e){return arguments.length?(a="function"===typeof e?e:_P(+e),s):a},s.endAngle=function(e){return arguments.length?(i="function"===typeof e?e:_P(+e),s):i},s.padAngle=function(e){return arguments.length?(o="function"===typeof e?e:_P(+e),s):o},s.context=function(e){return arguments.length?(u=null==e?null:e,s):u},s}().startAngle((function(e){return e.startAngle||0})).endAngle((function(e){return e.endAngle||0})).padAngle((function(e){return e.padAngle||0})).innerRadius((function(e){return e.innerRadius||0})).outerRadius((function(e){return e.outerRadius||0})).cornerRadius((function(e){return e.cornerRadius||0})),LU=RP().x(RU).y1(ZU).y0((function(e){return(e.y||0)+(e.height||0)})).defined(BU),PU=RP().y(ZU).x1(RU).x0((function(e){return(e.x||0)+(e.width||0)})).defined(BU),jU=OP().x(RU).y(ZU).defined(BU),UU=IU().x(RU).y(ZU).width((function(e){return e.width||0})).height((function(e){return e.height||0})).cornerRadius((function(e){return OU(e.cornerRadiusTopLeft,e.cornerRadius)||0}),(function(e){return OU(e.cornerRadiusTopRight,e.cornerRadius)||0}),(function(e){return OU(e.cornerRadiusBottomRight,e.cornerRadius)||0}),(function(e){return OU(e.cornerRadiusBottomLeft,e.cornerRadius)||0})),WU=function(e,t){var n=null;function r(){var r;if(n||(n=r=wP()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return e="function"===typeof e?e:_P(e||ZP),t="function"===typeof t?t:_P(void 0===t?64:+t),r.type=function(t){return arguments.length?(e="function"===typeof t?t:_P(t),r):e},r.size=function(e){return arguments.length?(t="function"===typeof e?e:_P(+e),r):t},r.context=function(e){return arguments.length?(n=null==e?null:e,r):n},r}().type((function(e){return _U(e.shape||"circle")})).size((function(e){return OU(e.size,64)})),VU=MU().x(RU).y(ZU).defined(BU).size((function(e){return e.size||1}));function GU(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function qU(e,t,n,r){return UU.context(e)(t,n,r)}var HU=1;function XU(){HU=1}function YU(e,t,n){var r=t.clip,a=e._defs,i=t.clip_id||(t.clip_id="clip"+HU++),o=a.clipping[i]||(a.clipping[i]={id:i});return $e(r)?o.path=r(null):GU(n)?o.path=qU(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+i+")"}function KU(e){this.clear(),e&&this.union(e)}function $U(e){this.mark=e,this.bounds=this.bounds||new KU}function QU(e){$U.call(this,e),this.items=this.items||[]}function JU(e){this._pending=0,this._loader=e||$j()}function eW(e){e._pending+=1}function tW(e){e._pending-=1}function nW(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){var r=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(r+(n?function(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,r):0))}return e}KU.prototype={clone:function(){return new KU(this)},clear:function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty:function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals:function(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set:function(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add:function(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand:function(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round:function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale:function(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate:function(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate:function(e,t,n){var r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints:function(e,t,n){var r=this.x1,a=this.y1,i=this.x2,o=this.y2,u=Math.cos(e),s=Math.sin(e),c=t-t*u+n*s,l=n-t*s-n*u;return[u*r-s*a+c,s*r+u*a+l,u*r-s*o+c,s*r+u*o+l,u*i-s*a+c,s*i+u*a+l,u*i-s*o+c,s*i+u*o+l]},union:function(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect:function(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses:function(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith:function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects:function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains:function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width:function(){return this.x2-this.x1},height:function(){return this.y2-this.y1}},ht(QU,$U),JU.prototype={pending:function(){return this._pending},sanitizeURL:function(e){var t=this;return eW(t),t._loader.sanitize(e,{context:"href"}).then((function(e){return tW(t),e})).catch((function(){return tW(t),null}))},loadImage:function(e){var t=this,n=Cp();return eW(t),t._loader.sanitize(e,{context:"image"}).then((function(e){var r=e.href;if(!r||!n)throw{url:r};var a=new n,i=ct(e,"crossOrigin")?e.crossOrigin:"anonymous";return null!=i&&(a.crossOrigin=i),a.onload=function(){return tW(t)},a.onerror=function(){return tW(t)},a.src=r,a})).catch((function(e){return tW(t),{complete:!1,width:0,height:0,src:e&&e.url||""}}))},ready:function(){var e=this;return new Promise((function(t){!function n(r){e.pending()?setTimeout((function(){n(!0)}),10):t(r)}(!1)}))}};var rW,aW,iW,oW,uW,sW,cW,lW,fW=fU-1e-8,dW=function(e,t){return rW.add(e,t)},hW=function(e,t){return dW(aW=e,iW=t)},pW=function(e){return dW(e,rW.y1)},vW=function(e){return dW(rW.x1,e)},gW=function(e,t){return uW*e+cW*t},mW=function(e,t){return sW*e+lW*t},yW=function(e,t){return dW(gW(e,t),mW(e,t))},bW=function(e,t){return hW(gW(e,t),mW(e,t))};function xW(e,t){return rW=e,t?(oW=t*cU,uW=lW=Math.cos(oW),sW=Math.sin(oW),cW=-sW):(uW=lW=1,oW=sW=cW=0),kW}var kW={beginPath:function(){},closePath:function(){},moveTo:bW,lineTo:bW,rect:function(e,t,n,r){oW?(yW(e+n,t),yW(e+n,t+r),yW(e,t+r),bW(e,t)):(dW(e+n,t+r),hW(e,t))},quadraticCurveTo:function(e,t,n,r){var a=gW(e,t),i=mW(e,t),o=gW(n,r),u=mW(n,r);wW(aW,a,o,pW),wW(iW,i,u,vW),hW(o,u)},bezierCurveTo:function(e,t,n,r,a,i){var o=gW(e,t),u=mW(e,t),s=gW(n,r),c=mW(n,r),l=gW(a,i),f=mW(a,i);_W(aW,o,s,l,pW),_W(iW,u,c,f,vW),hW(l,f)},arc:function(e,t,n,r,a,i){if(r+=oW,a+=oW,aW=n*Math.cos(a)+e,iW=n*Math.sin(a)+t,Math.abs(a-r)>fW)dW(e-n,t-n),dW(e+n,t+n);else{var o,u,s=function(r){return dW(n*Math.cos(r)+e,n*Math.sin(r)+t)};if(s(r),s(a),a!==r)if((r%=fU)<0&&(r+=fU),(a%=fU)<0&&(a+=fU),a<r&&(i=!i,o=r,r=a,a=o),i)for(a-=fU,o=r-r%lU,u=0;u<4&&o>a;++u,o-=lU)s(o);else for(o=r-r%lU+lU,u=0;u<4&&o<a;++u,o+=lU)s(o)}}};function wW(e,t,n,r){var a=(e-t)/(e+n-2*t);0<a&&a<1&&r(e+(t-e)*a)}function _W(e,t,n,r,a){var i,o=r-e+3*t-3*n,u=e+n-2*t,s=e-t,c=0,l=0;Math.abs(o)>1e-14?(i=u*u+s*o)>=0&&(c=(-u+(i=Math.sqrt(i)))/o,l=(-u-i)/o):c=.5*s/u,0<c&&c<1&&a(CW(c,e,t,n,r)),0<l&&l<1&&a(CW(l,e,t,n,r))}function CW(e,t,n,r,a){var i=1-e,o=i*i,u=e*e;return o*i*t+3*o*e*n+3*i*u*r+u*e*a}var SW=(SW=_p(1,1))?SW.getContext("2d"):null,AW=new KU;function EW(e){return function(t,n){if(!SW)return!0;e(SW,t),AW.clear().union(t.bounds).intersect(n).round();for(var r=AW.x1,a=AW.y1,i=AW.x2,o=AW.y2,u=a;u<=o;++u)for(var s=r;s<=i;++s)if(SW.isPointInPath(s,u))return!0;return!1}}function TW(e,t){return t.contains(e.x||0,e.y||0)}function NW(e,t){var n=e.x||0,r=e.y||0,a=e.width||0,i=e.height||0;return t.intersects(AW.set(n,r,n+a,r+i))}function DW(e,t){var n=e.x||0,r=e.y||0;return FW(t,n,r,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r)}function FW(e,t,n,r,a){var i,o,u,s,c=e.x1,l=e.y1,f=e.x2,d=e.y2,h=r-t,p=a-n,v=0,g=1;for(s=0;s<4;++s){if(0===s&&(i=-h,o=-(c-t)),1===s&&(i=h,o=f-t),2===s&&(i=-p,o=-(l-n)),3===s&&(i=p,o=d-n),Math.abs(i)<1e-10&&o<0)return!1;if(u=o/i,i<0){if(u>g)return!1;u>v&&(v=u)}else if(i>0){if(u<v)return!1;u<g&&(g=u)}}return!0}function IW(e,t){e.globalCompositeOperation=t.blend||"source-over"}function MW(e,t){return null==e?t:e}function OW(e,t){for(var n=t.length,r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function RW(e,t,n){return eU(n)?function(e,t,n){var r,a=n.width(),i=n.height();if("radial"===t.gradient)r=e.createRadialGradient(n.x1+MW(t.x1,.5)*a,n.y1+MW(t.y1,.5)*i,Math.max(a,i)*MW(t.r1,0),n.x1+MW(t.x2,.5)*a,n.y1+MW(t.y2,.5)*i,Math.max(a,i)*MW(t.r2,.5));else{var o=MW(t.x1,0),u=MW(t.y1,0),s=MW(t.x2,1),c=MW(t.y2,0);if(o!==s&&u!==c&&a!==i){var l=_p(Math.ceil(a),Math.ceil(i)),f=l.getContext("2d");return f.scale(a,i),f.fillStyle=OW(f.createLinearGradient(o,u,s,c),t.stops),f.fillRect(0,0,a,i),e.createPattern(l,"no-repeat")}r=e.createLinearGradient(n.x1+o*a,n.y1+u*i,n.x1+s*a,n.y1+c*i)}return OW(r,t.stops)}(e,n,t.bounds):n}function ZW(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=RW(e,t,t.fill),!0)}var BW=[];function zW(e,t,n){var r=null!=(r=t.strokeWidth)?r:1;return!(r<=0)&&((n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=RW(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||BW),e.lineDashOffset=t.strokeDashOffset||0),!0))}function LW(e,t){return e.zindex-t.zindex||e.index-t.index}function PW(e){if(!e.zdirty)return e.zitems;var t,n,r,a=e.items,i=[];for(n=0,r=a.length;n<r;++n)(t=a[n]).index=n,t.zindex&&i.push(t);return e.zdirty=!1,e.zitems=i.sort(LW)}function jW(e,t){var n,r,a=e.items;if(a&&a.length){var i=PW(e);if(i&&i.length){for(n=0,r=a.length;n<r;++n)a[n].zindex||t(a[n]);a=i}for(n=0,r=a.length;n<r;++n)t(a[n])}}function UW(e,t){var n,r,a=e.items;if(!a||!a.length)return null;var i=PW(e);for(i&&i.length&&(a=i),r=a.length;--r>=0;)if(n=t(a[r]))return n;if(a===i)for(r=(a=e.items).length;--r>=0;)if(!a[r].zindex&&(n=t(a[r])))return n;return null}function WW(e){return function(t,n,r){jW(n,(function(n){r&&!r.intersects(n.bounds)||GW(e,t,n,n)}))}}function VW(e){return function(t,n,r){!n.items.length||r&&!r.intersects(n.bounds)||GW(e,t,n.items[0],n.items)}}function GW(e,t,n,r){var a=null==n.opacity?1:n.opacity;0!==a&&(e(t,r)||(IW(t,n),n.fill&&ZW(t,n,a)&&t.fill(),n.stroke&&zW(t,n,a)&&t.stroke()))}function qW(e){return e=e||ve,function(t,n,r,a,i,o){return r*=t.pixelRatio,a*=t.pixelRatio,UW(n,(function(n){var u=n.bounds;if((!u||u.contains(i,o))&&u)return e(t,n,r,a,i,o)?n:void 0}))}}function HW(e,t){return function(n,r,a,i){var o,u,s=Array.isArray(r)?r[0]:r,c=null==t?s.fill:t,l=s.stroke&&n.isPointInStroke;return l&&(o=s.strokeWidth,u=s.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=u?u:"butt"),!e(n,r)&&(c&&n.isPointInPath(a,i)||l&&n.isPointInStroke(a,i))}}function XW(e){return qW(HW(e))}function YW(e,t){return"translate("+e+","+t+")"}function KW(e){return"rotate("+e+")"}function $W(e){return YW(e.x||0,e.y||0)}function QW(e,t,n){function r(e,n){var r=n.x||0,a=n.y||0,i=n.angle||0;e.translate(r,a),i&&e.rotate(i*=cU),e.beginPath(),t(e,n),i&&e.rotate(-i),e.translate(-r,-a)}return{type:e,tag:"path",nested:!1,attr:function(e,n){e("transform",function(e){return YW(e.x||0,e.y||0)+(e.angle?" "+KW(e.angle):"")}(n)),e("d",t(null,n))},bound:function(e,n){return t(xW(e,n.angle),n),nW(e,n).translate(n.x||0,n.y||0)},draw:WW(r),pick:XW(r),isect:n||EW(r)}}var JW=QW("arc",(function(e,t){return zU.context(e)(t)}));function eV(e,t,n){function r(e,n){e.beginPath(),t(e,n)}var a=HW(r);return{type:e,tag:"path",nested:!0,attr:function(e,n){var r=n.mark.items;r.length&&e("d",t(null,r))},bound:function(e,n){var r=n.items;return 0===r.length?e:(t(xW(e),r),nW(e,r[0]))},draw:VW(r),pick:function(e,t,n,r,i,o){var u=t.items,s=t.bounds;return!u||!u.length||s&&!s.contains(i,o)?null:(n*=e.pixelRatio,r*=e.pixelRatio,a(e,u,n,r)?u[0]:null)},isect:TW,tip:n}}var tV=eV("area",(function(e,t){var n=t[0],r=n.interpolate||"linear";return("horizontal"===n.orient?PU:LU).curve(iU(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,a="horizontal"===e[0].orient?t[1]:t[0],i="horizontal"===e[0].orient?"y":"x",o=e.length,u=1/0;--o>=0;)!1!==e[o].defined&&(r=Math.abs(e[o][i]-a))<u&&(u=r,n=e[o]);return n}));function nV(e,t){e.beginPath(),GU(t)?qU(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function rV(e){var t=MW(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function aV(e,t){var n=rV(t);e("d",qU(null,t,n,n))}function iV(e,t,n,r){var a=rV(t);e.beginPath(),qU(e,t,(n||0)+a,(r||0)+a)}var oV=HW(iV),uV=HW(iV,!1),sV=HW(iV,!0);var cV={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",$W(t))},bound:function(e,t){if(!t.clip&&t.items)for(var n=t.items,r=n.length,a=0;a<r;++a)e.union(n[a].bounds);return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),nW(e,t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n){var r=this;jW(t,(function(t){var a=t.x||0,i=t.y||0,o=t.strokeForeground,u=null==t.opacity?1:t.opacity;(t.stroke||t.fill)&&u&&(iV(e,t,a,i),IW(e,t),t.fill&&ZW(e,t,u)&&e.fill(),t.stroke&&!o&&zW(e,t,u)&&e.stroke()),e.save(),e.translate(a,i),t.clip&&nV(e,t),n&&n.translate(-a,-i),jW(t,(function(t){r.draw(e,t,n)})),n&&n.translate(a,i),e.restore(),o&&t.stroke&&u&&(iV(e,t,a,i),IW(e,t),zW(e,t,u)&&e.stroke())}))},pick:function(e,t,n,r,a,i){var o=this;if(t.bounds&&!t.bounds.contains(a,i)||!t.items)return null;var u=n*e.pixelRatio,s=r*e.pixelRatio;return UW(t,(function(c){var l,f,d,h=c.bounds;if(!h||h.contains(a,i)){f=c.x||0,d=c.y||0;var p=f+(c.width||0),v=d+(c.height||0),g=c.clip;if(!g||!(a<f||a>p||i<d||i>v)){if(e.save(),e.translate(f,d),f=a-f,d=i-d,g&&GU(c)&&!sV(e,c,u,s))return e.restore(),null;var m=c.strokeForeground,y=!1!==t.interactive;return y&&m&&c.stroke&&uV(e,c,u,s)?(e.restore(),c):(!(l=UW(c,(function(e){return function(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(e,f,d)?o.pick(e,n,r,f,d):null})))&&y&&(c.fill||!m&&c.stroke)&&oV(e,c,u,s)&&(l=c),e.restore(),l||null)}}}))},isect:NW,content:function(e,t,n){e("clip-path",t.clip?YU(n,t,t):null)},background:function(e,t){e("class","background"),e("aria-hidden",!0),aV(e,t)},foreground:function(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?aV(e,t):e("d","")}},lV={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function fV(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then((function(t){e.image=t,e.image.url=e.url}))),n}function dV(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function hV(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function pV(e,t){return"center"===e?t/2:"right"===e?t:0}function vV(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var gV={type:"image",tag:"image",nested:!1,attr:function(e,t,n){var r=fV(t,n),a=dV(t,r),i=hV(t,r),o=(t.x||0)-pV(t.align,a),u=(t.y||0)-vV(t.baseline,i);e("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",lV["xmlns:xlink"],"xlink:href"),e("transform",YW(o,u)),e("width",a),e("height",i),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function(e,t){var n=t.image,r=dV(t,n),a=hV(t,n),i=(t.x||0)-pV(t.align,r),o=(t.y||0)-vV(t.baseline,a);return e.set(i,o,i+r,o+a)},draw:function(e,t,n){var r=this;jW(t,(function(t){if(!n||n.intersects(t.bounds)){var a=fV(t,r),i=dV(t,a),o=hV(t,a);if(0!==i&&0!==o){var u,s,c,l,f=(t.x||0)-pV(t.align,i),d=(t.y||0)-vV(t.baseline,o);!1!==t.aspect&&(s=a.width/a.height,c=t.width/t.height,s===s&&c===c&&s!==c&&(c<s?(d+=(o-(l=i/s))/2,o=l):(f+=(i-(l=o*s))/2,i=l))),(a.complete||a.toDataURL)&&(IW(e,t),e.globalAlpha=null!=(u=t.opacity)?u:1,e.imageSmoothingEnabled=!1!==t.smooth,e.drawImage(a,f,d,i,o))}}}))},pick:qW(),isect:ve,get:fV,xOffset:pV,yOffset:vV},mV=eV("line",(function(e,t){var n=t[0],r=n.interpolate||"linear";return jU.curve(iU(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,a=Math.pow(e[0].strokeWidth||1,2),i=e.length;--i>=0;)if(!1!==e[i].defined&&(n=e[i].x-t[0])*n+(r=e[i].y-t[1])*r<a)return e[i];return null}));function yV(e,t){var n=t.path;if(null==n)return!0;var r=t.x||0,a=t.y||0,i=t.scaleX||1,o=t.scaleY||1,u=(t.angle||0)*cU,s=t.pathCache;s&&s.path===n||((t.pathCache=s=sU(n)).path=n),u&&e.rotate&&e.translate?(e.translate(r,a),e.rotate(u),bU(e,s,0,0,i,o),e.rotate(-u),e.translate(-r,-a)):bU(e,s,r,a,i,o)}var bV={type:"path",tag:"path",nested:!1,attr:function(e,t){var n=t.scaleX||1,r=t.scaleY||1;1===n&&1===r||e("vector-effect","non-scaling-stroke"),e("transform",function(e){return YW(e.x||0,e.y||0)+(e.angle?" "+KW(e.angle):"")+(e.scaleX||e.scaleY?" "+function(e,t){return"scale("+e+","+t+")"}(e.scaleX||1,e.scaleY||1):"")}(t)),e("d",t.path)},bound:function(e,t){return yV(xW(e,t.angle),t)?e.set(0,0,0,0):nW(e,t,!0)},draw:WW(yV),pick:XW(yV),isect:EW(yV)};function xV(e,t){e.beginPath(),qU(e,t)}var kV={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",qU(null,t))},bound:function(e,t){var n,r;return nW(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)},draw:WW(xV),pick:XW(xV),isect:NW};function wV(e,t,n){var r,a,i,o;return!(!t.stroke||!zW(e,t,n))&&(r=t.x||0,a=t.y||0,i=null!=t.x2?t.x2:r,o=null!=t.y2?t.y2:a,e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),!0)}var _V={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",$W(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var n,r;return nW(e.set(n=t.x||0,r=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r),t)},draw:function(e,t,n){jW(t,(function(t){if(!n||n.intersects(t.bounds)){var r=null==t.opacity?1:t.opacity;r&&wV(e,t,r)&&(IW(e,t),e.stroke())}}))},pick:qW((function(e,t,n,r){return!!e.isPointInStroke&&(wV(e,t,1)&&e.isPointInStroke(n,r))})),isect:DW},CV=QW("shape",(function(e,t){return(t.mark.shape||t.shape).context(e)(t)})),SV=QW("symbol",(function(e,t){return WU.context(e)(t)}),TW),AV=_t(),EV={height:MV,measureWidth:FV,estimateWidth:NV,width:NV,canvas:TV};function TV(e){EV.width=e&&SW?FV:NV}function NV(e,t){return DV(BV(e,t),MV(e))}function DV(e,t){return~~(.8*e.length*t)}function FV(e,t){return MV(e)<=0||!(t=BV(e,t))?0:IV(t,LV(e))}function IV(e,t){var n="(".concat(t,") ").concat(e),r=AV.get(n);return void 0===r&&(SW.font=t,r=SW.measureText(e).width,AV.set(n,r)),r}function MV(e){return null!=e.fontSize?+e.fontSize||0:11}function OV(e){return null!=e.lineHeight?e.lineHeight:MV(e)+2}function RV(e){return t=e.lineBreak&&e.text&&!Ce(e.text)?e.text.split(e.lineBreak):e.text,Ce(t)?t.length>1?t:t[0]:t;var t}function ZV(e){var t=RV(e);return(Ce(t)?t.length-1:0)*OV(e)}function BV(e,t){var n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function(e,t){var n=+e.limit,r=function(e){if(EV.width===FV){var t=LV(e);return function(e){return IV(e,t)}}var n=MV(e);return function(e){return DV(e,n)}}(e);if(r(t)<n)return t;var a,i=e.ellipsis||"\u2026",o="rtl"===e.dir,u=0,s=t.length;if(n-=r(i),o){for(;u<s;)a=u+s>>>1,r(t.slice(a))>n?u=a+1:s=a;return i+t.slice(u)}for(;u<s;)a=1+(u+s>>>1),r(t.slice(0,a))<n?u=a:s=a-1;return t.slice(0,u)+i}(e,n):n}function zV(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function LV(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+MV(e)+"px "+zV(e,t)}function PV(e){var t=e.baseline,n=MV(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*OV(e):"line-bottom"===t?.29*n-.5*OV(e):0)}TV(!0);var jV={left:"start",center:"middle",right:"end"},UV=new KU;function WV(e){var t,n=e.x||0,r=e.y||0,a=e.radius||0;return a&&(t=(e.theta||0)-lU,n+=a*Math.cos(t),r+=a*Math.sin(t)),UV.x1=n,UV.y1=r,UV}function VV(e,t,n){var r,a=EV.height(t),i=t.align,o=WV(t),u=o.x1,s=o.y1,c=t.dx||0,l=(t.dy||0)+PV(t)-Math.round(.8*a),f=RV(t);if(Ce(f)?(a+=OV(t)*(f.length-1),r=f.reduce((function(e,n){return Math.max(e,EV.width(t,n))}),0)):r=EV.width(t,f),"center"===i?c-=r/2:"right"===i&&(c-=r),e.set(c+=u,l+=s,c+r,l+a),t.angle&&!n)e.rotate(t.angle*cU,u,s);else if(2===n)return e.rotatedPoints(t.angle*cU,u,s);return e}var GV={type:"text",tag:"text",nested:!1,attr:function(e,t){var n,r=t.dx||0,a=(t.dy||0)+PV(t),i=WV(t),o=i.x1,u=i.y1,s=t.angle||0;e("text-anchor",jV[t.align]||"start"),s?(n=YW(o,u)+" "+KW(s),(r||a)&&(n+=" "+YW(r,a))):n=YW(o+r,u+a),e("transform",n)},bound:VV,draw:function(e,t,n){jW(t,(function(t){var r,a,i,o,u,s,c,l=null==t.opacity?1:t.opacity;if(!(n&&!n.intersects(t.bounds)||0===l||t.fontSize<=0||null==t.text||0===t.text.length)){if(e.font=LV(t),e.textAlign=t.align||"left",a=(r=WV(t)).x1,i=r.y1,t.angle&&(e.save(),e.translate(a,i),e.rotate(t.angle*cU),a=i=0),a+=t.dx||0,i+=(t.dy||0)+PV(t),s=RV(t),IW(e,t),Ce(s))for(u=OV(t),o=0;o<s.length;++o)c=BV(t,s[o]),t.fill&&ZW(e,t,l)&&e.fillText(c,a,i),t.stroke&&zW(e,t,l)&&e.strokeText(c,a,i),i+=u;else c=BV(t,s),t.fill&&ZW(e,t,l)&&e.fillText(c,a,i),t.stroke&&zW(e,t,l)&&e.strokeText(c,a,i);t.angle&&e.restore()}}))},pick:qW((function(e,t,n,r,a,i){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=WV(t),u=o.x1,s=o.y1,c=VV(UV,t,1),l=-t.angle*cU,f=Math.cos(l),d=Math.sin(l),h=f*a-d*i+(u-f*u+d*s),p=d*a+f*i+(s-d*u-f*s);return c.contains(h,p)})),isect:function(e,t){var n=VV(UV,e,2);return FW(t,n[0],n[1],n[2],n[3])||FW(t,n[0],n[1],n[4],n[5])||FW(t,n[4],n[5],n[6],n[7])||FW(t,n[2],n[3],n[6],n[7])}},qV=eV("trail",(function(e,t){return VU.context(e)(t)}),(function(e,t){for(var n,r,a=e.length;--a>=0;)if(!1!==e[a].defined&&(n=e[a].x-t[0])*n+(r=e[a].y-t[1])*r<(n=e[a].size||1)*n)return e[a];return null})),HV={arc:JW,area:tV,group:cV,image:gV,line:mV,path:bV,rect:kV,rule:_V,shape:CV,symbol:SV,text:GV,trail:qV};function XV(e,t,n){var r=HV[e.mark.marktype],a=t||r.bound;return r.nested&&(e=e.mark),a(e.bounds||(e.bounds=new KU),e,n)}var YV={mark:null};function KV(e,t,n){var r,a,i,o,u=HV[e.marktype],s=u.bound,c=e.items,l=c&&c.length;if(u.nested)return l?i=c[0]:(YV.mark=e,i=YV),o=XV(i,s,n),t=t&&t.union(o)||o;if(t=t||e.bounds&&e.bounds.clear()||new KU,l)for(r=0,a=c.length;r<a;++r)t.union(XV(c[r],s,n));return e.bounds=t}var $V=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function QV(e,t){return JSON.stringify(e,$V,t)}function JV(e){return eG("string"===typeof e?JSON.parse(e):e)}function eG(e){var t,n,r,a=e.marktype,i=e.items;if(i)for(n=0,r=i.length;n<r;++n)t=a?"mark":"group",i[n][t]=e,i[n].zindex&&(i[n][t].zdirty=!0),"group"===(a||t)&&eG(i[n]);return a&&KV(e),e}function tG(e){arguments.length?this.root=JV(e):(this.root=nG({marktype:"group",name:"root",role:"frame"}),this.root.items=[new QU(this.root)])}function nG(e,t){var n={bounds:new KU,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return null!=e.aria&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function rG(e,t,n){return!e&&"undefined"!==typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function aG(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,a=n.length;r<a;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function iG(e,t,n,r){var a,i=e.childNodes[t];return i&&i.tagName.toLowerCase()===n.toLowerCase()||(a=i||null,i=rG(e.ownerDocument,n,r),e.insertBefore(i,a)),i}function oG(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function uG(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function sG(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function cG(e,t){this._active=null,this._handlers={},this._loader=e||$j(),this._tooltip=t||lG}function lG(e,t,n,r){e.element().setAttribute("title",r||"")}function fG(e){this._el=null,this._bgcolor=null,this._loader=new JU(e)}tG.prototype={toJSON:function(e){return QV(this.root,e||0)},mark:function(e,t,n){var r=nG(e,t=t||this.root.items[0]);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},cG.prototype={initialize:function(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element:function(){return this._el},canvas:function(){return this._el&&this._el.firstChild},origin:function(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene:function(e){return arguments.length?(this._scene=e,this):this._scene},on:function(){},off:function(){},_handlerIndex:function(e,t,n){for(var r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers:function(e){var t=this._handlers,n=[];if(e)n.push.apply(n,(0,ln.Z)(t[this.eventName(e)]));else for(var r in t)n.push.apply(n,(0,ln.Z)(t[r]));return n},eventName:function(e){var t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref:function(e,t,n){this._loader.sanitize(n,{context:"href"}).then((function(t){var n=new MouseEvent(e.type,e),r=rG(null,"a");for(var a in t)r.setAttribute(a,t[a]);r.dispatchEvent(n)})).catch((function(){}))},handleTooltip:function(e,t,n){if(t&&null!=t.tooltip){t=function(e,t,n,r){var a,i,o=e&&e.mark;if(o&&(a=HV[o.marktype]).tip){for((i=sG(t,n))[0]-=r[0],i[1]-=r[1];e=e.mark.group;)i[0]-=e.x||0,i[1]-=e.y||0;e=a.tip(o.items,i)}return e}(t,e,this.canvas(),this._origin);var r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect:function(e){var t=this.canvas();if(t){for(var n=t.getBoundingClientRect(),r=this._origin,a=e.bounds,i=a.width(),o=a.height(),u=a.x1+r[0]+n.left,s=a.y1+r[1]+n.top;e.mark&&(e=e.mark.group);)u+=e.x||0,s+=e.y||0;return{x:u,y:s,width:i,height:o,left:u,top:s,right:u+i,bottom:s+o}}}},fG.prototype={initialize:function(e,t,n,r,a){return this._el=e,this.resize(t,n,r,a)},element:function(){return this._el},canvas:function(){return this._el&&this._el.firstChild},background:function(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize:function(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty:function(){},render:function(e){var t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render:function(){},renderAsync:function(e){var t=this.render(e);return this._ready?this._ready.then((function(){return t})):Promise.resolve(t)},_load:function(e,t){var n=this,r=n._loader[e](t);if(!n._ready){var a=n._call;n._ready=n._loader.ready().then((function(e){e&&a(),n._ready=null}))}return r},sanitizeURL:function(e){return this._load("sanitizeURL",e)},loadImage:function(e){return this._load("loadImage",e)}};var dG="dragenter",hG="dragleave",pG="dragover",vG="mousedown",gG="mousemove",mG="mouseout",yG="mouseover",bG="click",xG="mousewheel",kG="touchstart",wG="touchmove",_G="touchend",CG=gG,SG=mG,AG=bG;function EG(e,t){cG.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function TG(e,t){(function(e){return e===kG||e===wG||e===_G?[kG,wG,_G]:[e]})(t).forEach((function(t){return function(e,t){var n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?function(n){return e[t](n)}:function(n){return e.fire(t,n)}))}(e,t)}))}function NG(e,t,n){return function(r){var a=this._active,i=this.pickEvent(r);i===a||(a&&a.exit||this.fire(n,r),this._active=i,this.fire(t,r)),this.fire(e,r)}}function DG(e){return function(t){this.fire(e,t),this._active=null}}ht(EG,cG,{initialize:function(e,t,n){var r=this;return this._canvas=e&&aG(e,"canvas"),[bG,vG,gG,mG,hG].forEach((function(e){return TG(r,e)})),cG.prototype.initialize.call(this,e,t,n)},canvas:function(){return this._canvas},context:function(){return this._canvas.getContext("2d")},events:["keydown","keypress","keyup",dG,hG,pG,vG,"mouseup",gG,mG,yG,bG,"dblclick","wheel",xG,kG,wG,_G],DOMMouseScroll:function(e){this.fire(xG,e)},mousemove:NG(gG,yG,mG),dragover:NG(pG,dG,hG),mouseout:DG(mG),dragleave:DG(hG),mousedown:function(e){this._down=this._active,this.fire(vG,e)},click:function(e){this._down===this._active&&(this.fire(bG,e),this._down=null)},touchstart:function(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(kG,e,!0)},touchmove:function(e){this.fire(wG,e,!0)},touchend:function(e){this.fire(_G,e,!0),this._touch=null},fire:function(e,t,n){var r=n?this._touch:this._active,a=this._handlers[e];if(t.vegaType=e,e===AG&&r&&r.href?this.handleHref(t,r,r.href):e!==CG&&e!==SG||this.handleTooltip(t,r,e!==SG),a)for(var i=0,o=a.length;i<o;++i)a[i].handler.call(this._obj,t,r)},on:function(e,t){var n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(TG(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off:function(e,t){var n=this.eventName(e),r=this._handlers[n],a=this._handlerIndex(r,e,t);return a>=0&&r.splice(a,1),this},pickEvent:function(e){var t=sG(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick:function(e,t,n,r,a){var i=this.context();return HV[e.marktype].pick.call(this,i,e,t,n,r,a)}});var FG="undefined"!==typeof window&&window.devicePixelRatio||1;function IG(e){fG.call(this,e),this._options={},this._redraw=!1,this._dirty=new KU,this._tempb=new KU}var MG=fG.prototype;function OG(e,t){cG.call(this,e,t);var n=this;n._hrefHandler=RG(n,(function(e,t){t&&t.href&&n.handleHref(e,t,t.href)})),n._tooltipHandler=RG(n,(function(e,t){n.handleTooltip(e,t,e.type!==SG)}))}ht(IG,fG,{initialize:function(e,t,n,r,a,i){return this._options=i||{},this._canvas=this._options.externalContext?null:_p(1,1,this._options.type),e&&this._canvas&&(oG(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),MG.initialize.call(this,e,t,n,r,a)},resize:function(e,t,n,r){if(MG.resize.call(this,e,t,n,r),this._canvas)!function(e,t,n,r,a,i){var o="undefined"!==typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,u=e.getContext("2d"),s=o?FG:a;for(var c in e.width=t*s,e.height=n*s,i)u[c]=i[c];o&&1!==s&&(e.style.width=t+"px",e.style.height=n+"px"),u.pixelRatio=s,u.setTransform(s,0,0,s,s*r[0],s*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{var a=this._options.externalContext;a||se("CanvasRenderer is missing a valid canvas or context"),a.scale(this._scale,this._scale),a.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas:function(){return this._canvas},context:function(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty:function(e){for(var t=this._tempb.clear().union(e.bounds),n=e.mark.group;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render:function(e){var t=this.context(),n=this._origin,r=this._width,a=this._height,i=this._dirty,o=function(e,t,n){return(new KU).set(0,0,t,n).translate(-e[0],-e[1])}(n,r,a);t.save();var u=this._redraw||i.empty()?(this._redraw=!1,o.expand(1)):function(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(t,o.intersect(i),n);return this.clear(-n[0],-n[1],r,a),this.draw(t,e,u),t.restore(),i.clear(),this},draw:function(e,t,n){var r=HV[t.marktype];t.clip&&function(e,t){var n=t.clip;e.save(),$e(n)?(e.beginPath(),n(e),e.clip()):nV(e,t.group)}(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear:function(e,t,n,r){var a=this._options,i=this.context();"pdf"===a.type||a.externalContext||i.clearRect(e,t,n,r),null!=this._bgcolor&&(i.fillStyle=this._bgcolor,i.fillRect(e,t,n,r))}});var RG=function(e,t){return function(n){var r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)}};ht(OG,cG,{initialize:function(e,t,n){var r=this._svg;return r&&(r.removeEventListener(AG,this._hrefHandler),r.removeEventListener(CG,this._tooltipHandler),r.removeEventListener(SG,this._tooltipHandler)),this._svg=r=e&&aG(e,"svg"),r&&(r.addEventListener(AG,this._hrefHandler),r.addEventListener(CG,this._tooltipHandler),r.addEventListener(SG,this._tooltipHandler)),cG.prototype.initialize.call(this,e,t,n)},canvas:function(){return this._svg},on:function(e,t){var n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){var a={type:e,handler:t,listener:RG(this,t)};(r[n]||(r[n]=[])).push(a),this._svg&&this._svg.addEventListener(n,a.listener)}return this},off:function(e,t){var n=this.eventName(e),r=this._handlers[n],a=this._handlerIndex(r,e,t);return a>=0&&(this._svg&&this._svg.removeEventListener(n,r[a].listener),r.splice(a,1)),this}});var ZG="aria-hidden",BG="aria-label",zG="role",LG="aria-roledescription",PG="graphics-object",jG="graphics-symbol",UG=function(e,t,n){var r;return r={},(0,qn.Z)(r,zG,e),(0,qn.Z)(r,LG,t),(0,qn.Z)(r,BG,n||void 0),r},WG=Mt(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),VG={axis:{desc:"axis",caption:function(e){var t=e.datum,n=e.orient,r=t.title?YG(e):null,a=e.context,i=a.scales[t.scale].value,o=a.dataflow.locale(),u=i.type,s="left"===n||"right"===n?"Y":"X";return"".concat(s,"-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(oI(u)?"discrete":u," scale")+" with ".concat(PI(o,i,e))}},legend:{desc:"legend",caption:function(e){var t=e.datum,n=t.title?YG(e):null,r="".concat(t.type||""," legend").trim(),a=t.scales,i=Object.keys(a),o=e.context,u=o.scales[a[i[0]]].value,s=o.dataflow.locale();return function(e){return e.length?e[0].toUpperCase()+e.slice(1):e}(r)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(e){return e=e.map((function(e){return e+("fill"===e||"stroke"===e?" color":"")})),e.length<2?e[0]:e.slice(0,-1).join(", ")+" and "+De(e)}(i))+" with ".concat(PI(s,u,e))}},"title-text":{desc:"title",caption:function(e){return"Title text '".concat(XG(e),"'")}},"title-subtitle":{desc:"subtitle",caption:function(e){return"Subtitle text '".concat(XG(e),"'")}}},GG={ariaRole:zG,ariaRoleDescription:LG,description:BG};function qG(e,t){var n=!1===t.aria;if(e(ZG,n||void 0),n||null==t.description)for(var r in GG)e(GG[r],void 0);else{var a=t.mark.marktype;e(BG,t.description),e(zG,t.ariaRole||("group"===a?PG:jG)),e(LG,t.ariaRoleDescription||"".concat(a," mark"))}}function HG(e){return!1===e.aria?(0,qn.Z)({},ZG,!0):WG[e.role]?null:VG[e.role]?function(e,t){try{var n=e.items[0],r=t.caption||function(){return""};return UG(t.role||jG,t.desc,n.description||r(n))}catch(a){return null}}(e,VG[e.role]):function(e){var t=e.marktype,n="group"===t||"text"===t||e.items.some((function(e){return null!=e.description&&!1!==e.aria}));return UG(n?PG:jG,"".concat(t," mark container"),e.description)}(e)}function XG(e){return Ye(e.text).join(" ")}function YG(e){try{return Ye(De(e.items).items[0].text).join(" ")}catch(t){return null}}var KG=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};function $G(){var e="",t="",n="",r=[],a=function(){return t=n=""},i=function(i){t&&(e+="".concat(t,">").concat(n),a()),r.push(i)},o=function(e,n){return null!=n&&(t+=" ".concat(e,'="').concat(KG(n).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"),'"')),u},u={open:function(e){i(e),t="<"+e;for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];for(var s=0,c=r;s<c.length;s++){var l=c[s];for(var f in l)o(f,l[f])}return u},close:function(){var i=r.pop();return e+=t?t+(n?">".concat(n,"</").concat(i,">"):"/>"):"</".concat(i,">"),a(),u},attr:o,text:function(e){return n+=KG(e),u},toString:function(){return e}};return u}var QG=function(e){return JG($G(),e)+""};function JG(e,t){if(e.open(t.tagName),t.hasAttributes())for(var n=t.attributes,r=n.length,a=0;a<r;++a)e.attr(n[a].name,n[a].value);if(t.hasChildNodes())for(var i=t.childNodes,o=i.length,u=0;u<o;u++){var s=i[u];3===s.nodeType?e.text(s.nodeValue):JG(e,s)}return e.close()}var eq={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},tq={fill:"none","stroke-miterlimit":10},nq="http://www.w3.org/2000/xmlns/",rq=lV.xmlns;function aq(e){fG.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var iq=fG.prototype;function oq(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function uq(e,t,n){var r,a,i;if("radial"===t.gradient){var o=iG(e,n++,"pattern",rq);vq(o,{id:Jj+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),vq(o=iG(o,0,"rect",rq),{width:1,height:1,fill:"url(".concat(mq(),"#").concat(t.id,")")}),vq(e=iG(e,n++,"radialGradient",rq),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else vq(e=iG(e,n++,"linearGradient",rq),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,a=t.stops.length;r<a;++r)(i=iG(e,r,"stop",rq)).setAttribute("offset",t.stops[r].offset),i.setAttribute("stop-color",t.stops[r].color);return oG(e,r),n}function sq(e,t,n){return(e=iG(e,n,"clipPath",rq)).setAttribute("id",t.id),t.path?iG(e,0,"path",rq).setAttribute("d",t.path):vq(iG(e,0,"rect",rq),{x:0,y:0,width:t.width,height:t.height}),oG(e,1),n+1}function cq(e,t,n,r,a){var i,o=e._svg;if(!o&&(o=rG(i=t.ownerDocument,r,rq),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},"g"===r))){var u=rG(i,"path",rq);o.appendChild(u),u.__data__=e;var s=rG(i,"g",rq);o.appendChild(s),s.__data__=e;var c=rG(i,"path",rq);o.appendChild(c),c.__data__=e,c.__values__={fill:"default"}}return(o.ownerSVGElement!==a||function(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}ht(aq,fG,{initialize:function(e,t,n,r,a){return this._defs={},this._clearDefs(),e&&(this._svg=iG(e,0,"svg",rq),this._svg.setAttributeNS(nq,"xmlns",rq),this._svg.setAttributeNS(nq,"xmlns:xlink",lV["xmlns:xlink"]),this._svg.setAttribute("version",lV.version),this._svg.setAttribute("class","marks"),oG(e,1),this._root=iG(this._svg,0,"g",rq),vq(this._root,tq),oG(this._svg,1)),this.background(this._bgcolor),iq.initialize.call(this,e,t,n,r,a)},background:function(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),iq.background.apply(this,arguments)},resize:function(e,t,n,r){return iq.resize.call(this,e,t,n,r),this._svg&&(vq(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas:function(){return this._svg},svg:function(){var e,t=this._svg,n=this._bgcolor;if(!t)return null;n&&(t.removeAttribute("style"),vq(e=iG(t,0,"rect",rq),{width:this._width,height:this._height,fill:n}));var r=QG(t);return n&&(t.removeChild(e),this._svg.style.setProperty("background-color",n)),r},_render:function(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),oG(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty:function(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty:function(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck:function(){this._dirtyAll=!0;var e=this._dirty;if(!e.length||!this._dirtyID)return!0;var t,n,r,a,i,o,u,s=++this._dirtyID;for(i=0,o=e.length;i<o;++i)(n=(t=e[i]).mark).marktype!==r&&(r=n.marktype,a=HV[r]),n.zdirty&&n.dirty!==s&&(this._dirtyAll=!1,oq(t,s),n.items.forEach((function(e){e.dirty=s}))),n.zdirty||(t.exit?(a.nested&&n.items.length?(u=n.items[0])._svg&&this._update(a,u._svg,u):t._svg&&(u=t._svg.parentNode)&&u.removeChild(t._svg),t._svg=null):(t=a.nested?n.items[0]:t)._update!==s&&(t._svg&&t._svg.ownerSVGElement?this._update(a,t._svg,t):(this._dirtyAll=!1,oq(t,s)),t._update=s));return!this._dirtyAll},mark:function(e,t,n){var r=this;if(!this.isDirty(t))return t._svg;var a=this._svg,i=HV[t.marktype],o=!1===t.interactive?"none":null,u="g"===i.tag,s=null,c=0,l=cq(t,e,n,"g",a);l.setAttribute("class",uG(t));var f=HG(t);for(var d in f)gq(l,d,f[d]);u||gq(l,"pointer-events",o),gq(l,"clip-path",t.clip?YU(this,t,t.group):null);var h=function(e){var t=r.isDirty(e),n=cq(e,l,s,i.tag,a);t&&(r._update(i,n,e),u&&function(e,t,n){t=t.lastChild.previousSibling;var r,a=0;jW(n,(function(n){r=e.mark(t,n,r),++a})),oG(t,1+a)}(r,n,e)),s=n,++c};return i.nested?t.items.length&&h(t.items[0]):jW(t,h),oG(l,c),l},_update:function(e,t,n){lq=t,fq=t.__values__,qG(hq,n),e.attr(hq,n,this);var r=dq[e.type];r&&r.call(this,e,t,n),lq&&this.style(lq,n)},style:function(e,t){if(null!=t)for(var n in eq){var r="font"===n?zV(t):t[n];if(r!==fq[n]){var a=eq[n];null==r?e.removeAttribute(a):(eU(r)&&(r=tU(r,this._defs.gradient,mq())),e.setAttribute(a,r+"")),fq[n]=r}}},defs:function(){var e=this._svg,t=this._defs,n=t.el,r=0;for(var a in t.gradient)n||(t.el=n=iG(e,1,"defs",rq)),r=uq(n,t.gradient[a],r);for(var i in t.clipping)n||(t.el=n=iG(e,1,"defs",rq)),r=sq(n,t.clipping[i],r);n&&(0===r?(e.removeChild(n),t.el=null):oG(n,r))},_clearDefs:function(){var e=this._defs;e.gradient={},e.clipping={}}});var lq=null,fq=null,dq={group:function(e,t,n){var r=lq=t.childNodes[2];fq=r.__values__,e.foreground(hq,n,this),fq=t.__values__,lq=t.childNodes[1],e.content(hq,n,this);var a=lq=t.childNodes[0];e.background(hq,n,this);var i=!1===n.mark.interactive?"none":null;if(i!==fq.events&&(gq(r,"pointer-events",i),gq(a,"pointer-events",i),fq.events=i),n.strokeForeground&&n.stroke){var o=n.fill;gq(r,"display",null),this.style(a,n),gq(a,"stroke",null),o&&(n.fill=null),fq=r.__values__,this.style(r,n),o&&(n.fill=o),lq=null}else gq(r,"display","none")},image:function(e,t,n){!1===n.smooth?(pq(t,"image-rendering","optimizeSpeed"),pq(t,"image-rendering","pixelated")):pq(t,"image-rendering",null)},text:function(e,t,n){var r,a,i,o,u=RV(n);Ce(u)?(r=(a=u.map((function(e){return BV(n,e)}))).join("\n"))!==fq.text&&(oG(t,0),i=t.ownerDocument,o=OV(n),a.forEach((function(e,r){var a=rG(i,"tspan",rq);a.__data__=n,a.textContent=e,r&&(a.setAttribute("x",0),a.setAttribute("dy",o)),t.appendChild(a)})),fq.text=r):(a=BV(n,u))!==fq.text&&(t.textContent=a,fq.text=a),gq(t,"font-family",zV(n)),gq(t,"font-size",MV(n)+"px"),gq(t,"font-style",n.fontStyle),gq(t,"font-variant",n.fontVariant),gq(t,"font-weight",n.fontWeight)}};function hq(e,t,n){t!==fq[e]&&(n?function(e,t,n,r){null!=n?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}(lq,e,t,n):gq(lq,e,t),fq[e]=t)}function pq(e,t,n){n!==fq[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),fq[t]=n)}function vq(e,t){for(var n in t)gq(e,n,t[n])}function gq(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function mq(){var e;return"undefined"===typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function yq(e){fG.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}ht(yq,fG,{svg:function(){return this._text},_render:function(e){var t=$G();t.open("svg",it({},lV,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));var n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",tq,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark:function(e,t){var n=this,r=HV[t.marktype],a=r.tag,i=[qG,r.attr];e.open("g",{class:uG(t),"clip-path":t.clip?YU(this,t,t.group):null},HG(t),{"pointer-events":"g"!==a&&!1===t.interactive?"none":null});var o=function(o){var u=n.href(o);if(u&&e.open("a",u),e.open(a,n.attr(t,o,i,"g"!==a?a:null)),"text"===a){var s=RV(o);if(Ce(s))for(var c={x:0,dy:OV(o)},l=0;l<s.length;++l)e.open("tspan",l?c:null).text(BV(o,s[l])).close();else e.text(BV(o,s))}else if("g"===a){var f=o.strokeForeground,d=o.fill,h=o.stroke;f&&h&&(o.stroke=null),e.open("path",n.attr(t,o,r.background,"bgrect")).close(),e.open("g",n.attr(t,o,r.content)),jW(o,(function(t){return n.mark(e,t)})),e.close(),f&&h?(d&&(o.fill=null),o.stroke=h,e.open("path",n.attr(t,o,r.foreground,"bgrect")).close(),d&&(o.fill=d)):e.open("path",n.attr(t,o,r.foreground,"bgfore")).close()}e.close(),u&&e.close()};return r.nested?t.items&&t.items.length&&o(t.items[0]):jW(t,o),e.close()},href:function(e){var t,n=this,r=e.href;if(r){if(t=this._hrefs&&this._hrefs[r])return t;this.sanitizeURL(r).then((function(e){e["xlink:href"]=e.href,e.href=null,(n._hrefs||(n._hrefs={}))[r]=e}))}return null},attr:function(e,t,n,r){var a=this,i={},o=function(e,t,n,r){i[r||e]=t};return Array.isArray(n)?n.forEach((function(e){return e(o,t,a)})):n(o,t,this),r&&function(e,t,n,r,a){if(null==t)return e;"bgrect"===r&&!1===n.interactive&&(e["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill))return e;"image"===r&&!1===t.smooth&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;");"text"===r&&(e["font-family"]=zV(t),e["font-size"]=MV(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(var i in eq){var o=t[i],u=eq[i];("transparent"!==o||"fill"!==u&&"stroke"!==u)&&null!=o&&(eU(o)&&(o=tU(o,a.gradient,"")),e[u]=o)}}(i,t,e,r,this._defs),i},defs:function(e){var t=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(t).length+Object.keys(n).length){for(var r in e.open("defs"),t){var a=t[r],i=a.stops;"radial"===a.gradient?(e.open("pattern",{id:Jj+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),e.close(),e.open("radialGradient",{id:r,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})):e.open("linearGradient",{id:r,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2});for(var o=0;o<i.length;++o)e.open("stop",{offset:i[o].offset,"stop-color":i[o].color}).close();e.close()}for(var u in n){var s=n[u];e.open("clipPath",{id:u}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});var bq="canvas",xq="none",kq={Canvas:bq,PNG:"png",SVG:"svg",None:xq},wq={};function _q(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(wq[e]=t,this):wq[e]}function Cq(e,t,n){var r=[],a=(new KU).union(t),i=e.marktype;return i?Sq(e,a,n,r):"group"===i?Aq(e,a,n,r):se("Intersect scene must be mark node or group item.")}function Sq(e,t,n,r){if(function(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}(e,t,n)){var a=e.items,i=e.marktype,o=a.length,u=0;if("group"===i)for(;u<o;++u)Aq(a[u],t,n,r);else for(var s=HV[i].isect;u<o;++u){var c=a[u];Eq(c,t,s)&&r.push(c)}}return r}function Aq(e,t,n,r){n&&n(e.mark)&&Eq(e,t,HV.group.isect)&&r.push(e);var a=e.items,i=a&&a.length;if(i){var o=e.x||0,u=e.y||0;t.translate(-o,-u);for(var s=0;s<i;++s)Sq(a[s],t,n,r);t.translate(o,u)}return r}function Eq(e,t,n){var r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}wq[bq]=wq.png={renderer:IG,headless:IG,handler:EG},wq.svg={renderer:aq,headless:yq,handler:OG},wq[xq]={};var Tq=new KU;function Nq(e){var t=e.clip;if($e(t))t(xW(Tq.clear()));else{if(!t)return;Tq.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(Tq)}function Dq(e,t,n){return e===t||("path"===n?Fq(e,t):e instanceof Date&&t instanceof Date?+e===+t:yt(e)&&yt(t)?Math.abs(e-t)<=1e-9:e&&t&&(Se(e)||Se(t))?function(e,t){var n,r,a=Object.keys(e),i=Object.keys(t);if(a.length!==i.length)return!1;for(a.sort(),i.sort(),r=a.length-1;r>=0;r--)if(a[r]!=i[r])return!1;for(r=a.length-1;r>=0;r--)if(!Dq(e[n=a[r]],t[n],n))return!1;return typeof e===typeof t}(e,t):e==t)}function Fq(e,t){return Dq(sU(e),sU(t))}function Iq(){XU(),Qj=0}function Mq(e,t,n,r){var a=e.width,i=e.height,o=n||r,u=_p(a,i).getContext("2d");t.forEach((function(e){return Oq(u,e,o)}));var s,c,l,f,d,h=new Uint32Array(u.getImageData(0,0,a,i).data.buffer),p=e.bitmap(),v=o&&e.bitmap();for(c=0;c<i;++c)for(s=0;s<a;++s)(d=4278190080&h[c*a+s])&&(l=e(s),f=e(c),r||p.set(l,f),o&&268435456^d&&v.set(l,f));return[p,v]}function Oq(e,t,n){if(t.length){var r=t[0].mark.marktype;"group"===r?t.forEach((function(t){t.items.forEach((function(t){return Oq(e,t.items,n)}))})):HV[r].draw(e,{items:n?t.map(Rq):t})}}function Rq(e){var t=Bo(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=.0625,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}var Zq=31,Bq=new Uint32Array(33),zq=new Uint32Array(33);zq[0]=0,Bq[0]=~zq[0];for(var Lq=1;Lq<=32;++Lq)zq[Lq]=zq[Lq-1]<<1|1,Bq[Lq]=~zq[Lq];function Pq(e,t,n){var r=Math.max(1,Math.sqrt(e*t/1e6)),a=~~((e+2*n+r)/r),i=~~((t+2*n+r)/r),o=function(e){return~~((e+n)/r)};return o.invert=function(e){return e*r-n},o.bitmap=function(){return function(e,t){var n=new Uint32Array(~~((e*t+32)/32));function r(e,t){n[e]|=t}function a(e,t){n[e]&=t}return{array:n,get:function(t,r){var a=r*e+t;return n[a>>>5]&1<<(a&Zq)},set:function(t,n){var a=n*e+t;r(a>>>5,1<<(a&Zq))},clear:function(t,n){var r=n*e+t;a(r>>>5,~(1<<(r&Zq)))},getRange:function(t,r,a,i){for(var o,u,s,c,l=i;l>=r;--l)if((s=(o=l*e+t)>>>5)===(c=(u=l*e+a)>>>5)){if(n[s]&Bq[o&Zq]&zq[1+(u&Zq)])return!0}else{if(n[s]&Bq[o&Zq])return!0;if(n[c]&zq[1+(u&Zq)])return!0;for(var f=s+1;f<c;++f)if(n[f])return!0}return!1},setRange:function(t,n,a,i){for(var o,u,s,c,l;n<=i;++n)if((s=(o=n*e+t)>>>5)===(c=(u=n*e+a)>>>5))r(s,Bq[o&Zq]&zq[1+(u&Zq)]);else for(r(s,Bq[o&Zq]),r(c,zq[1+(u&Zq)]),l=s+1;l<c;++l)r(l,4294967295)},clearRange:function(t,n,r,i){for(var o,u,s,c,l;n<=i;++n)if((s=(o=n*e+t)>>>5)===(c=(u=n*e+r)>>>5))a(s,zq[o&Zq]|Bq[1+(u&Zq)]);else for(a(s,zq[o&Zq]),a(c,Bq[1+(u&Zq)]),l=s+1;l<c;++l)a(l,0)},outOfBounds:function(n,r,a,i){return n<0||r<0||i>=t||a>=e}}}(a,i)},o.ratio=r,o.padding=n,o.width=e,o.height=t,o}function jq(e,t,n,r,a,i){var o=n/2;return e-o<0||e+o>a||t-(o=r/2)<0||t+o>i}function Uq(e,t,n,r,a,i,o,u){var s=a*i/(2*r),c=e(t-s),l=e(t+s),f=e(n-(i/=2)),d=e(n+i);return o.outOfBounds(c,f,l,d)||o.getRange(c,f,l,d)||u&&u.getRange(c,f,l,d)}var Wq=[-1,-1,1,1],Vq=[-1,1,-1,1];var Gq=["right","center","left"],qq=["bottom","middle","top"];function Hq(e,t,n,r,a,i,o,u,s,c,l,f){return!(a.outOfBounds(e,n,t,r)||(f&&i?i.getRange(e,n,t,r)||!function(e,t,n,r,a){return a[0]<=e&&n<=a[2]&&a[3]<=t&&r<=a[5]}(o,s,u,c,l):a.getRange(e,n,t,r)))}var Xq={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},Yq={naive:function(e,t,n,r){var a=e.width,i=e.height;return function(e){for(var t,n,o,u,s,c,l,f=e.datum.datum.items[r].items,d=f.length,h=e.datum.fontSize,p=EV.width(e.datum,e.datum.text),v=0,g=0;g<d;++g)t=f[g].x,o=f[g].y,s=(t+(n=void 0===f[g].x2?t:f[g].x2))/2,c=(o+(u=void 0===f[g].y2?o:f[g].y2))/2,(l=Math.abs(n-t+u-o))>=v&&(v=l,e.x=s,e.y=c);return s=p/2,c=h/2,t=e.x-s,n=e.x+s,o=e.y-c,u=e.y+c,e.align="center",t<0&&n<=a?e.align="left":0<=t&&a<n&&(e.align="right"),e.baseline="middle",o<0&&u<=i?e.baseline="top":0<=o&&i<u&&(e.baseline="bottom"),!0}},"reduced-search":function(e,t,n,r){var a=e.width,i=e.height,o=t[0],u=t[1];function s(t,n,r,s,c){var l,f=e.invert(t),d=e.invert(n),h=r,p=i;if(!jq(f,d,s,c,a,i)&&!Uq(e,f,d,c,s,h,o,u)&&!Uq(e,f,d,c,s,c,o,null)){for(;p-h>=1;)Uq(e,f,d,c,s,l=(h+p)/2,o,u)?p=l:h=l;if(h>r)return[f,d,h,!0]}}return function(t){for(var u,c,l,f,d,h,p,v,g,m,y,b,x,k,w,_,C,S=t.datum.datum.items[r].items,A=S.length,E=t.datum.fontSize,T=EV.width(t.datum,t.datum.text),N=n?E:0,D=!1,F=!1,I=0,M=0;M<A;++M){for(u=S[M].x,l=S[M].y,u>(c=void 0===S[M].x2?u:S[M].x2)&&(C=u,u=c,c=C),l>(f=void 0===S[M].y2?l:S[M].y2)&&(C=l,l=f,f=C),m=~~(((g=e(u))+(y=e(c)))/2),x=~~(((b=e(l))+(k=e(f)))/2),p=m;p>=g;--p)for(v=x;v>=b;--v)if(_=s(p,v,N,T,E)){var O=_,R=(0,ku.Z)(O,4);t.x=R[0],t.y=R[1],N=R[2],D=R[3]}for(p=m;p<=y;++p)for(v=x;v<=k;++v)if(_=s(p,v,N,T,E)){var Z=_,B=(0,ku.Z)(Z,4);t.x=B[0],t.y=B[1],N=B[2],D=B[3]}D||n||(d=(u+c)/2,h=(l+f)/2,(w=Math.abs(c-u+f-l))>=I&&!jq(d,h,T,E,a,i)&&!Uq(e,d,h,E,T,E,o,null)&&(I=w,t.x=d,t.y=h,F=!0))}return!(!D&&!F)&&(d=T/2,h=E/2,o.setRange(e(t.x-d),e(t.y-h),e(t.x+d),e(t.y+h)),t.align="center",t.baseline="middle",!0)}},floodfill:function(e,t,n,r){var a=e.width,i=e.height,o=t[0],u=t[1],s=e.bitmap();return function(t){for(var c,l,f,d,h,p,v,g,m,y,b,x,k=t.datum.datum.items[r].items,w=k.length,_=t.datum.fontSize,C=EV.width(t.datum,t.datum.text),S=[],A=n?_:0,E=!1,T=!1,N=0,D=0;D<w;++D){for(c=k[D].x,f=k[D].y,l=void 0===k[D].x2?c:k[D].x2,d=void 0===k[D].y2?f:k[D].y2,S.push([e((c+l)/2),e((f+d)/2)]);S.length;){var F=S.pop(),I=(0,ku.Z)(F,2);if(v=I[0],g=I[1],!(o.get(v,g)||u.get(v,g)||s.get(v,g))){s.set(v,g);for(var M=0;M<4;++M)h=v+Wq[M],p=g+Vq[M],s.outOfBounds(h,p,h,p)||S.push([h,p]);if(h=e.invert(v),p=e.invert(g),m=A,y=i,!jq(h,p,C,_,a,i)&&!Uq(e,h,p,_,C,m,o,u)&&!Uq(e,h,p,_,C,_,o,null)){for(;y-m>=1;)Uq(e,h,p,_,C,b=(m+y)/2,o,u)?y=b:m=b;m>A&&(t.x=h,t.y=p,A=m,E=!0)}}}E||n||(h=(c+l)/2,p=(f+d)/2,(x=Math.abs(l-c+d-f))>=N&&!jq(h,p,C,_,a,i)&&!Uq(e,h,p,_,C,_,o,null)&&(N=x,t.x=h,t.y=p,T=!0))}return!(!E&&!T)&&(h=C/2,p=_/2,o.setRange(e(t.x-h),e(t.y-p),e(t.x+h),e(t.y+p)),t.align="center",t.baseline="middle",!0)}}};function Kq(e,t,n,r,a,i,o,u,s,c,l){if(!e.length)return e;var f,d,h=Math.max(r.length,a.length),p=function(e,t){for(var n=new Float64Array(t),r=e.length,a=0;a<r;++a)n[a]=e[a]||0;for(var i=r;i<t;++i)n[i]=n[r-1];return n}(r,h),v=function(e,t){for(var n=new Int8Array(t),r=e.length,a=0;a<r;++a)n[a]|=Xq[e[a]];for(var i=r;i<t;++i)n[i]=n[r-1];return n}(a,h),g=(f=e[0].datum)&&f.mark&&f.mark.marktype,m="group"===g&&e[0].datum.items[s].marktype,y="area"===m,b=function(e,t,n,r){var a=function(e){return[e.x,e.x,e.x,e.y,e.y,e.y]};return e?"line"===e||"area"===e?function(e){return a(e.datum)}:"line"===t?function(e){var t=e.datum.items[r].items;return a(t.length?t["start"===n?0:t.length-1]:{x:NaN,y:NaN})}:function(e){var t=e.datum.bounds;return[t.x1,(t.x1+t.x2)/2,t.x2,t.y1,(t.y1+t.y2)/2,t.y2]}:a}(g,m,u,s),x=Pq(t[0],t[1],c),k=y&&"naive"===l,w=e.map((function(e){return{datum:e,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:b(e)}}));if(!k){n&&w.sort((function(e,t){return n(e.datum,t.datum)}));for(var _=!1,C=0;C<v.length&&!_;++C)_=5===v[C]||p[C]<0;g&&(o||y)&&(i=[e.map((function(e){return e.datum}))].concat(i)),d=i.length?Mq(x,i,_,y):function(e,t){var n=e.bitmap();return(t||[]).forEach((function(t){return n.set(e(t.boundary[0]),e(t.boundary[3]))})),[n,void 0]}(x,o&&w)}var S=y?Yq[l](x,d,o,s):function(e,t,n,r){var a=e.width,i=e.height,o=t[0],u=t[1],s=r.length;return function(t){var c=t.boundary,l=t.datum.fontSize;if(c[2]<0||c[5]<0||c[0]>a||c[3]>i)return!1;for(var f,d,h,p,v,g,m,y,b,x,k,w,_,C,S,A=0,E=0;E<s;++E){if(f=(3&n[E])-1,d=(n[E]>>>2&3)-1,h=0===f&&0===d||r[E]<0,p=f&&d?Math.SQRT1_2:1,v=r[E]<0?-1:1,g=c[1+f]+r[E]*f*p,y=(k=c[4+d]+v*l*d/2+r[E]*d*p)-l/2,b=k+l/2,w=e(g),C=e(y),S=e(b),!A){if(!Hq(w,w,C,S,o,u,g,g,y,b,c,h))continue;A=EV.width(t.datum,t.datum.text)}if(m=(x=g+v*A*f/2)+A/2,Hq(w=e(g=x-A/2),_=e(m),C,S,o,u,g,m,y,b,c,h))return t.x=f?f*v<0?m:g:x,t.y=d?d*v<0?b:y:k,t.align=Gq[f*v+1],t.baseline=qq[d*v+1],o.setRange(w,C,_,S),!0}return!1}}(x,d,v,p);return w.forEach((function(e){return e.opacity=+S(e)})),w}var $q=["x","y","opacity","align","baseline"],Qq=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function Jq(e){mu.call(this,null,e)}function eH(e,t){var n,r,a,i,o,u,s=[],c=function(e){return e(i)};if(null==t)s.push(e);else for(n={},r=0,a=e.length;r<a;++r)i=e[r],(u=n[o=t.map(c)])||(n[o]=u=[],u.dims=o,s.push(u)),u.push(i);return s}function tH(e){mu.call(this,null,e)}Jq.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:Qq},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:$q.length,default:$q}]},ht(Jq,mu,{transform:function(e,t){var n=e.modified();if(n||t.changed(t.ADD_REM)||function(n){var r=e[n];return $e(r)&&t.modified(r.fields)}("sort")){e.size&&2===e.size.length||se("Size parameter should be specified as a [width, height] array.");var r=e.as||$q;return Kq(t.materialize(t.SOURCE).source,e.size,e.sort,Ye(e.offset||1),Ye(e.anchor||Qq),e.avoidMarks||[],!1!==e.avoidBaseMark,e.lineAnchor||"end",e.markIndex||0,e.padding||0,e.method||"naive").forEach((function(e){var t=e.datum;t[r[0]]=e.x,t[r[1]]=e.y,t[r[2]]=e.opacity,t[r[3]]=e.align,t[r[4]]=e.baseline})),t.reflow(n).modifies(r)}}}),tH.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},ht(tH,mu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=eH(t.materialize(t.SOURCE).source,e.groupby),a=(e.groupby||[]).map(re),i=a.length,o=e.as||[re(e.x),re(e.y)],u=[];r.forEach((function(t){_s(t,e.x,e.y,e.bandwidth||.3).forEach((function(e){for(var n={},r=0;r<i;++r)n[a[r]]=t.dims[r];n[o[0]]=e[0],n[o[1]]=e[1],u.push(Ro(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});var nH={linear:gs,log:ms,exp:ys,pow:bs,quad:xs,poly:ks};function rH(e){mu.call(this,null,e)}rH.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(nH)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},ht(rH,mu,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=eH(t.materialize(t.SOURCE).source,e.groupby),a=(e.groupby||[]).map(re),i=e.method||"linear",o=e.order||3,u=function(e,t){return"poly"===e?t:"quad"===e?2:1}(i,o),s=e.as||[re(e.x),re(e.y)],c=nH[i],l=[],f=e.extent;ct(nH,i)||se("Invalid regression method: "+i),null!=f&&"log"===i&&f[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),f=null),r.forEach((function(n){if(n.length<=u)t.dataflow.warn("Skipping regression with more parameters than data points.");else{var r=c(n,e.x,e.y,o);if(e.params)l.push(Ro({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));else{var d=f||ot(n,e.x),h=function(e){for(var t={},r=0;r<a.length;++r)t[a[r]]=n.dims[r];t[s[0]]=e[0],t[s[1]]=e[1],l.push(Ro(t))};"linear"===i?d.forEach((function(e){return h([e,r.predict(e)])})):Es(r.predict,d,25,200).forEach(h)}}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});var aH=Math.pow(2,-52),iH=new Uint32Array(512),oH=function(){function e(t){(0,Jh.Z)(this,e);var n=t.length>>1;if(n>0&&"number"!==typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;var r=Math.max(2*n-5,0);this._triangles=new Uint32Array(3*r),this._halfedges=new Int32Array(3*r),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}return(0,ep.Z)(e,[{key:"update",value:function(){for(var e=this.coords,t=this._hullPrev,n=this._hullNext,r=this._hullTri,a=this._hullHash,i=e.length>>1,o=1/0,u=1/0,s=-1/0,c=-1/0,l=0;l<i;l++){var f=e[2*l],d=e[2*l+1];f<o&&(o=f),d<u&&(u=d),f>s&&(s=f),d>c&&(c=d),this._ids[l]=l}for(var h,p,v,g=(o+s)/2,m=(u+c)/2,y=1/0,b=0;b<i;b++){var x=uH(g,m,e[2*b],e[2*b+1]);x<y&&(h=b,y=x)}var k=e[2*h],w=e[2*h+1];y=1/0;for(var _=0;_<i;_++)if(_!==h){var C=uH(k,w,e[2*_],e[2*_+1]);C<y&&C>0&&(p=_,y=C)}for(var S=e[2*p],A=e[2*p+1],E=1/0,T=0;T<i;T++)if(T!==h&&T!==p){var N=fH(k,w,S,A,e[2*T],e[2*T+1]);N<E&&(v=T,E=N)}var D=e[2*v],F=e[2*v+1];if(E===1/0){for(var I=0;I<i;I++)this._dists[I]=e[2*I]-e[0]||e[2*I+1]-e[1];dH(this._ids,this._dists,0,i-1);for(var M=new Uint32Array(i),O=0,R=0,Z=-1/0;R<i;R++){var B=this._ids[R];this._dists[B]>Z&&(M[O++]=B,Z=this._dists[B])}return this.hull=M.subarray(0,O),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(cH(k,w,S,A,D,F)){var z=p,L=S,P=A;p=v,S=D,A=F,v=z,D=L,F=P}var j=function(e,t,n,r,a,i){var o=n-e,u=r-t,s=a-e,c=i-t,l=o*o+u*u,f=s*s+c*c,d=.5/(o*c-u*s),h=e+(c*l-u*f)*d,p=t+(o*f-s*l)*d;return{x:h,y:p}}(k,w,S,A,D,F);this._cx=j.x,this._cy=j.y;for(var U=0;U<i;U++)this._dists[U]=uH(e[2*U],e[2*U+1],j.x,j.y);dH(this._ids,this._dists,0,i-1),this._hullStart=h;var W=3;n[h]=t[v]=p,n[p]=t[h]=v,n[v]=t[p]=h,r[h]=0,r[p]=1,r[v]=2,a.fill(-1),a[this._hashKey(k,w)]=h,a[this._hashKey(S,A)]=p,a[this._hashKey(D,F)]=v,this.trianglesLen=0,this._addTriangle(h,p,v,-1,-1,-1);for(var V,G,q=0;q<this._ids.length;q++){var H=this._ids[q],X=e[2*H],Y=e[2*H+1];if(!(q>0&&Math.abs(X-V)<=aH&&Math.abs(Y-G)<=aH)&&(V=X,G=Y,H!==h&&H!==p&&H!==v)){for(var K=0,$=0,Q=this._hashKey(X,Y);$<this._hashSize&&(-1===(K=a[(Q+$)%this._hashSize])||K===n[K]);$++);for(var J=K=t[K],ee=void 0;ee=n[J],!cH(X,Y,e[2*J],e[2*J+1],e[2*ee],e[2*ee+1]);)if((J=ee)===K){J=-1;break}if(-1!==J){var te=this._addTriangle(J,H,n[J],-1,-1,r[J]);r[H]=this._legalize(te+2),r[J]=te,W++;for(var ne=n[J];ee=n[ne],cH(X,Y,e[2*ne],e[2*ne+1],e[2*ee],e[2*ee+1]);)te=this._addTriangle(ne,H,ee,r[H],-1,r[ne]),r[H]=this._legalize(te+2),n[ne]=ne,W--,ne=ee;if(J===K)for(;cH(X,Y,e[2*(ee=t[J])],e[2*ee+1],e[2*J],e[2*J+1]);)te=this._addTriangle(ee,H,J,-1,r[J],r[ee]),this._legalize(te+2),r[ee]=te,n[J]=J,W--,J=ee;this._hullStart=t[H]=J,n[J]=t[ne]=H,n[H]=ne,a[this._hashKey(X,Y)]=H,a[this._hashKey(e[2*J],e[2*J+1])]=J}}}this.hull=new Uint32Array(W);for(var re=0,ae=this._hullStart;re<W;re++)this.hull[re]=ae,ae=n[ae];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}},{key:"_hashKey",value:function(e,t){return Math.floor(function(e,t){var n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}},{key:"_legalize",value:function(e){for(var t=this._triangles,n=this._halfedges,r=this.coords,a=0,i=0;;){var o=n[e],u=e-e%3;if(i=u+(e+2)%3,-1!==o){var s=o-o%3,c=u+(e+1)%3,l=s+(o+2)%3,f=t[i],d=t[e],h=t[c],p=t[l];if(lH(r[2*f],r[2*f+1],r[2*d],r[2*d+1],r[2*h],r[2*h+1],r[2*p],r[2*p+1])){t[e]=p,t[o]=f;var v=n[l];if(-1===v){var g=this._hullStart;do{if(this._hullTri[g]===l){this._hullTri[g]=e;break}g=this._hullPrev[g]}while(g!==this._hullStart)}this._link(e,v),this._link(o,n[i]),this._link(i,l);var m=s+(o+1)%3;a<iH.length&&(iH[a++]=m)}else{if(0===a)break;e=iH[--a]}}else{if(0===a)break;e=iH[--a]}}return i}},{key:"_link",value:function(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}},{key:"_addTriangle",value:function(e,t,n,r,a,i){var o=this.trianglesLen;return this._triangles[o]=e,this._triangles[o+1]=t,this._triangles[o+2]=n,this._link(o,r),this._link(o+1,a),this._link(o+2,i),this.trianglesLen+=3,o}}],[{key:"from",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pH,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vH,a=t.length,i=new Float64Array(2*a),o=0;o<a;o++){var u=t[o];i[2*o]=n(u),i[2*o+1]=r(u)}return new e(i)}}]),e}();function uH(e,t,n,r){var a=e-n,i=t-r;return a*a+i*i}function sH(e,t,n,r,a,i){var o=(r-t)*(a-e),u=(n-e)*(i-t);return Math.abs(o-u)>=33306690738754716e-32*Math.abs(o+u)?o-u:0}function cH(e,t,n,r,a,i){return(sH(a,i,e,t,n,r)||sH(e,t,n,r,a,i)||sH(n,r,a,i,e,t))<0}function lH(e,t,n,r,a,i,o,u){var s=e-o,c=t-u,l=n-o,f=r-u,d=a-o,h=i-u,p=l*l+f*f,v=d*d+h*h;return s*(f*v-p*h)-c*(l*v-p*d)+(s*s+c*c)*(l*h-f*d)<0}function fH(e,t,n,r,a,i){var o=n-e,u=r-t,s=a-e,c=i-t,l=o*o+u*u,f=s*s+c*c,d=.5/(o*c-u*s),h=(c*l-u*f)*d,p=(o*f-s*l)*d;return h*h+p*p}function dH(e,t,n,r){if(r-n<=20)for(var a=n+1;a<=r;a++){for(var i=e[a],o=t[i],u=a-1;u>=n&&t[e[u]]>o;)e[u+1]=e[u--];e[u+1]=i}else{var s=n+1,c=r;hH(e,n+r>>1,s),t[e[n]]>t[e[r]]&&hH(e,n,r),t[e[s]]>t[e[r]]&&hH(e,s,r),t[e[n]]>t[e[s]]&&hH(e,n,s);for(var l=e[s],f=t[l];;){do{s++}while(t[e[s]]<f);do{c--}while(t[e[c]]>f);if(c<s)break;hH(e,s,c)}e[n+1]=e[c],e[c]=l,r-s+1>=c-n?(dH(e,t,s,r),dH(e,t,n,c-1)):(dH(e,t,n,c-1),dH(e,t,s,r))}}function hH(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function pH(e){return e[0]}function vH(e){return e[1]}var gH=1e-6,mH=function(){function e(){(0,Jh.Z)(this,e),this._x0=this._y0=this._x1=this._y1=null,this._=""}return(0,ep.Z)(e,[{key:"moveTo",value:function(e,t){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t)}},{key:"closePath",value:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}},{key:"lineTo",value:function(e,t){this._+="L".concat(this._x1=+e,",").concat(this._y1=+t)}},{key:"arc",value:function(e,t,n){var r=(e=+e)+(n=+n),a=t=+t;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(a):(Math.abs(this._x1-r)>gH||Math.abs(this._y1-a)>gH)&&(this._+="L"+r+","+a),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(e-n,",").concat(t,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=a))}},{key:"rect",value:function(e,t,n,r){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")}},{key:"value",value:function(){return this._||null}}]),e}(),yH=function(){function e(){(0,Jh.Z)(this,e),this._=[]}return(0,ep.Z)(e,[{key:"moveTo",value:function(e,t){this._.push([e,t])}},{key:"closePath",value:function(){this._.push(this._[0].slice())}},{key:"lineTo",value:function(e,t){this._.push([e,t])}},{key:"value",value:function(){return this._.length?this._:null}}]),e}(),bH=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500],r=(0,ku.Z)(n,4),a=r[0],i=r[1],o=r[2],u=r[3];if((0,Jh.Z)(this,e),!((o=+o)>=(a=+a))||!((u=+u)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=o,this.xmin=a,this.ymax=u,this.ymin=i,this._init()}return(0,ep.Z)(e,[{key:"update",value:function(){return this.delaunay.update(),this._init(),this}},{key:"_init",value:function(){for(var e,t,n=this.delaunay,r=n.points,a=n.hull,i=n.triangles,o=this.vectors,u=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2),s=0,c=0,l=i.length;s<l;s+=3,c+=2){var f=2*i[s],d=2*i[s+1],h=2*i[s+2],p=r[f],v=r[f+1],g=r[d],m=r[d+1],y=r[h],b=r[h+1],x=g-p,k=m-v,w=y-p,_=b-v,C=x*x+k*k,S=w*w+_*_,A=2*(x*_-k*w);if(A)if(Math.abs(A)<1e-8)e=(p+y)/2,t=(v+b)/2;else{var E=1/A;e=p+(_*C-k*S)*E,t=v+(x*S-w*C)*E}else e=(p+y)/2-1e8*_,t=(v+b)/2+1e8*w;u[c]=e,u[c+1]=t}var T,N,D,F=a[a.length-1],I=4*F,M=r[2*F],O=r[2*F+1];o.fill(0);for(var R=0;R<a.length;++R)T=I,N=M,D=O,I=4*(F=a[R]),M=r[2*F],O=r[2*F+1],o[T+2]=o[I]=D-O,o[T+3]=o[I+1]=M-N}},{key:"render",value:function(e){var t=null==e?e=new mH:void 0,n=this.delaunay,r=n.halfedges,a=n.inedges,i=n.hull,o=this.circumcenters,u=this.vectors;if(i.length<=1)return null;for(var s=0,c=r.length;s<c;++s){var l=r[s];if(!(l<s)){var f=2*Math.floor(s/3),d=2*Math.floor(l/3),h=o[f],p=o[f+1],v=o[d],g=o[d+1];this._renderSegment(h,p,v,g,e)}}for(var m,y=i[i.length-1],b=0;b<i.length;++b){m=y,y=i[b];var x=2*Math.floor(a[y]/3),k=o[x],w=o[x+1],_=4*m,C=this._project(k,w,u[_+2],u[_+3]);C&&this._renderSegment(k,w,C[0],C[1],e)}return t&&t.value()}},{key:"renderBounds",value:function(e){var t=null==e?e=new mH:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}},{key:"renderCell",value:function(e,t){var n=null==t?t=new mH:void 0,r=this._clip(e);if(null!==r&&r.length){t.moveTo(r[0],r[1]);for(var a=r.length;r[0]===r[a-2]&&r[1]===r[a-1]&&a>1;)a-=2;for(var i=2;i<a;i+=2)r[i]===r[i-2]&&r[i+1]===r[i-1]||t.lineTo(r[i],r[i+1]);return t.closePath(),n&&n.value()}}},{key:"cellPolygons",value:(0,w.Z)().mark((function e(){var t,n,r,a;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.delaunay.points,n=0,r=t.length/2;case 2:if(!(n<r)){e.next=11;break}if(!(a=this.cellPolygon(n))){e.next=8;break}return a.index=n,e.next=8,a;case 8:++n,e.next=2;break;case 11:case"end":return e.stop()}}),e,this)}))},{key:"cellPolygon",value:function(e){var t=new yH;return this.renderCell(e,t),t.value()}},{key:"_renderSegment",value:function(e,t,n,r,a){var i,o=this._regioncode(e,t),u=this._regioncode(n,r);0===o&&0===u?(a.moveTo(e,t),a.lineTo(n,r)):(i=this._clipSegment(e,t,n,r,o,u))&&(a.moveTo(i[0],i[1]),a.lineTo(i[2],i[3]))}},{key:"contains",value:function(e,t,n){return(t=+t)===t&&(n=+n)===n&&this.delaunay._step(e,t,n)===e}},{key:"neighbors",value:(0,w.Z)().mark((function e(t){var n,r,a,i,o,u,s,c,l;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this._clip(t))){e.next=33;break}r=(0,Zt.Z)(this.delaunay.neighbors(t)),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=25;break}if(i=a.value,!(o=this._clip(i))){e.next=23;break}u=0,s=n.length;case 10:if(!(u<s)){e.next=23;break}c=0,l=o.length;case 12:if(!(c<l)){e.next=20;break}if(n[u]!=o[c]||n[u+1]!=o[c+1]||n[(u+2)%s]!=o[(c+l-2)%l]||n[(u+3)%s]!=o[(c+l-1)%l]){e.next=17;break}return e.next=16,i;case 16:return e.abrupt("break",23);case 17:c+=2,e.next=12;break;case 20:u+=2,e.next=10;break;case 23:e.next=5;break;case 25:e.next=30;break;case 27:e.prev=27,e.t0=e.catch(3),r.e(e.t0);case 30:return e.prev=30,r.f(),e.finish(30);case 33:case"end":return e.stop()}}),e,this,[[3,27,30,33]])}))},{key:"_cell",value:function(e){var t=this.circumcenters,n=this.delaunay,r=n.inedges,a=n.halfedges,i=n.triangles,o=r[e];if(-1===o)return null;var u=[],s=o;do{var c=Math.floor(s/3);if(u.push(t[2*c],t[2*c+1]),i[s=s%3===2?s-2:s+1]!==e)break;s=a[s]}while(s!==o&&-1!==s);return u}},{key:"_clip",value:function(e){if(0===e&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];var t=this._cell(e);if(null===t)return null;var n=this.vectors,r=4*e;return n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t)}},{key:"_clipFinite",value:function(e,t){for(var n,r,a,i,o,u=t.length,s=null,c=t[u-2],l=t[u-1],f=this._regioncode(c,l),d=0;d<u;d+=2)if(n=c,r=l,c=t[d],l=t[d+1],a=f,f=this._regioncode(c,l),0===a&&0===f)i=o,o=0,s?s.push(c,l):s=[c,l];else{var h=void 0,p=void 0,v=void 0,g=void 0,m=void 0;if(0===a){if(null===(h=this._clipSegment(n,r,c,l,a,f)))continue;var y=h,b=(0,ku.Z)(y,4);p=b[0],v=b[1],g=b[2],m=b[3]}else{if(null===(h=this._clipSegment(c,l,n,r,f,a)))continue;var x=h,k=(0,ku.Z)(x,4);g=k[0],m=k[1],p=k[2],v=k[3],i=o,o=this._edgecode(p,v),i&&o&&this._edge(e,i,o,s,s.length),s?s.push(p,v):s=[p,v]}i=o,o=this._edgecode(g,m),i&&o&&this._edge(e,i,o,s,s.length),s?s.push(g,m):s=[g,m]}if(s)i=o,o=this._edgecode(s[0],s[1]),i&&o&&this._edge(e,i,o,s,s.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}},{key:"_clipSegment",value:function(e,t,n,r,a,i){for(;;){if(0===a&&0===i)return[e,t,n,r];if(a&i)return null;var o=void 0,u=void 0,s=a||i;8&s?(o=e+(n-e)*(this.ymax-t)/(r-t),u=this.ymax):4&s?(o=e+(n-e)*(this.ymin-t)/(r-t),u=this.ymin):2&s?(u=t+(r-t)*(this.xmax-e)/(n-e),o=this.xmax):(u=t+(r-t)*(this.xmin-e)/(n-e),o=this.xmin),a?(e=o,t=u,a=this._regioncode(e,t)):(n=o,r=u,i=this._regioncode(n,r))}}},{key:"_clipInfinite",value:function(e,t,n,r,a,i){var o,u=Array.from(t);if((o=this._project(u[0],u[1],n,r))&&u.unshift(o[0],o[1]),(o=this._project(u[u.length-2],u[u.length-1],a,i))&&u.push(o[0],o[1]),u=this._clipFinite(e,u))for(var s,c=0,l=u.length,f=this._edgecode(u[l-2],u[l-1]);c<l;c+=2)s=f,f=this._edgecode(u[c],u[c+1]),s&&f&&(c=this._edge(e,s,f,u,c),l=u.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(u=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return u}},{key:"_edge",value:function(e,t,n,r,a){for(;t!==n;){var i=void 0,o=void 0;switch(t){case 5:t=4;continue;case 4:t=6,i=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,i=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,i=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,i=this.xmin,o=this.ymin}r[a]===i&&r[a+1]===o||!this.contains(e,i,o)||(r.splice(a,0,i,o),a+=2)}if(r.length>4)for(var u=0;u<r.length;u+=2){var s=(u+2)%r.length,c=(u+4)%r.length;(r[u]===r[s]&&r[s]===r[c]||r[u+1]===r[s+1]&&r[s+1]===r[c+1])&&(r.splice(s,2),u-=2)}return a}},{key:"_project",value:function(e,t,n,r){var a,i,o,u=1/0;if(r<0){if(t<=this.ymin)return null;(a=(this.ymin-t)/r)<u&&(o=this.ymin,i=e+(u=a)*n)}else if(r>0){if(t>=this.ymax)return null;(a=(this.ymax-t)/r)<u&&(o=this.ymax,i=e+(u=a)*n)}if(n>0){if(e>=this.xmax)return null;(a=(this.xmax-e)/n)<u&&(i=this.xmax,o=t+(u=a)*r)}else if(n<0){if(e<=this.xmin)return null;(a=(this.xmin-e)/n)<u&&(i=this.xmin,o=t+(u=a)*r)}return[i,o]}},{key:"_edgecode",value:function(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}},{key:"_regioncode",value:function(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}}]),e}(),xH=(0,w.Z)().mark(TH),kH=2*Math.PI,wH=Math.pow;function _H(e){return e[0]}function CH(e){return e[1]}function SH(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}var AH=function(){function e(t){(0,Jh.Z)(this,e),this._delaunator=new oH(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}return(0,ep.Z)(e,[{key:"update",value:function(){return this._delaunator.update(),this._init(),this}},{key:"_init",value:function(){var e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&function(e){for(var t=e.triangles,n=e.coords,r=0;r<t.length;r+=3){var a=2*t[r],i=2*t[r+1],o=2*t[r+2];if((n[o]-n[a])*(n[i+1]-n[a+1])-(n[i]-n[a])*(n[o+1]-n[a+1])>1e-10)return!1}return!0}(e)){this.collinear=Int32Array.from({length:t.length/2},(function(e,t){return t})).sort((function(e,n){return t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]}));for(var n=this.collinear[0],r=this.collinear[this.collinear.length-1],a=[t[2*n],t[2*n+1],t[2*r],t[2*r+1]],i=1e-8*Math.hypot(a[3]-a[1],a[2]-a[0]),o=0,u=t.length/2;o<u;++o){var s=SH(t[2*o],t[2*o+1],i);t[2*o]=s[0],t[2*o+1]=s[1]}this._delaunator=new oH(t)}else delete this.collinear;for(var c=this.halfedges=this._delaunator.halfedges,l=this.hull=this._delaunator.hull,f=this.triangles=this._delaunator.triangles,d=this.inedges.fill(-1),h=this._hullIndex.fill(-1),p=0,v=c.length;p<v;++p){var g=f[p%3===2?p-2:p+1];-1!==c[p]&&-1!==d[g]||(d[g]=p)}for(var m=0,y=l.length;m<y;++m)h[l[m]]=m;l.length<=2&&l.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=l[0],this.triangles[1]=l[1],this.triangles[2]=l[1],d[l[0]]=1,2===l.length&&(d[l[1]]=0))}},{key:"voronoi",value:function(e){return new bH(this,e)}},{key:"neighbors",value:(0,w.Z)().mark((function e(t){var n,r,a,i,o,u,s,c,l,f,d;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.inedges,r=this.hull,a=this._hullIndex,i=this.halfedges,o=this.triangles,!(u=this.collinear)){e.next=10;break}if(!((s=u.indexOf(t))>0)){e.next=6;break}return e.next=6,u[s-1];case 6:if(!(s<u.length-1)){e.next=9;break}return e.next=9,u[s+1];case 9:return e.abrupt("return");case 10:if(-1!==(c=n[t])){e.next=13;break}return e.abrupt("return");case 13:l=c,f=-1;case 14:return e.next=16,f=o[l];case 16:if(o[l=l%3===2?l-2:l+1]===t){e.next=19;break}return e.abrupt("return");case 19:if(-1!==(l=i[l])){e.next=26;break}if((d=r[(a[t]+1)%r.length])===f){e.next=25;break}return e.next=25,d;case 25:return e.abrupt("return");case 26:if(l!==c){e.next=14;break}case 27:case"end":return e.stop()}}),e,this)}))},{key:"find",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((e=+e)!==e||(t=+t)!==t)return-1;for(var r,a=n;(r=this._step(n,e,t))>=0&&r!==n&&r!==a;)n=r;return r}},{key:"_step",value:function(e,t,n){var r=this.inedges,a=this.hull,i=this._hullIndex,o=this.halfedges,u=this.triangles,s=this.points;if(-1===r[e]||!s.length)return(e+1)%(s.length>>1);var c=e,l=wH(t-s[2*e],2)+wH(n-s[2*e+1],2),f=r[e],d=f;do{var h=u[d],p=wH(t-s[2*h],2)+wH(n-s[2*h+1],2);if(p<l&&(l=p,c=h),u[d=d%3===2?d-2:d+1]!==e)break;if(-1===(d=o[d])){if((d=a[(i[e]+1)%a.length])!==h&&wH(t-s[2*d],2)+wH(n-s[2*d+1],2)<l)return d;break}}while(d!==f);return c}},{key:"render",value:function(e){for(var t=null==e?e=new mH:void 0,n=this.points,r=this.halfedges,a=this.triangles,i=0,o=r.length;i<o;++i){var u=r[i];if(!(u<i)){var s=2*a[i],c=2*a[u];e.moveTo(n[s],n[s+1]),e.lineTo(n[c],n[c+1])}}return this.renderHull(e),t&&t.value()}},{key:"renderPoints",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=null==e?e=new mH:void 0,r=this.points,a=0,i=r.length;a<i;a+=2){var o=r[a],u=r[a+1];e.moveTo(o+t,u),e.arc(o,u,t,0,kH)}return n&&n.value()}},{key:"renderHull",value:function(e){var t=null==e?e=new mH:void 0,n=this.hull,r=this.points,a=2*n[0],i=n.length;e.moveTo(r[a],r[a+1]);for(var o=1;o<i;++o){var u=2*n[o];e.lineTo(r[u],r[u+1])}return e.closePath(),t&&t.value()}},{key:"hullPolygon",value:function(){var e=new yH;return this.renderHull(e),e.value()}},{key:"renderTriangle",value:function(e,t){var n=null==t?t=new mH:void 0,r=this.points,a=this.triangles,i=2*a[e*=3],o=2*a[e+1],u=2*a[e+2];return t.moveTo(r[i],r[i+1]),t.lineTo(r[o],r[o+1]),t.lineTo(r[u],r[u+1]),t.closePath(),n&&n.value()}},{key:"trianglePolygons",value:(0,w.Z)().mark((function e(){var t,n,r;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.triangles,n=0,r=t.length/3;case 2:if(!(n<r)){e.next=8;break}return e.next=5,this.trianglePolygon(n);case 5:++n,e.next=2;break;case 8:case"end":return e.stop()}}),e,this)}))},{key:"trianglePolygon",value:function(e){var t=new yH;return this.renderTriangle(e,t),t.value()}}],[{key:"from",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_H,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:CH,a=arguments.length>3?arguments[3]:void 0;return new e("length"in t?EH(t,n,r,a):Float64Array.from(TH(t,n,r,a)))}}]),e}();function EH(e,t,n,r){for(var a=e.length,i=new Float64Array(2*a),o=0;o<a;++o){var u=e[o];i[2*o]=t.call(r,u,o,e),i[2*o+1]=n.call(r,u,o,e)}return i}function TH(e,t,n,r){var a,i,o,u;return(0,w.Z)().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:a=0,i=(0,Zt.Z)(e),s.prev=2,i.s();case 4:if((o=i.n()).done){s.next=13;break}return u=o.value,s.next=8,t.call(r,u,a,e);case 8:return s.next=10,n.call(r,u,a,e);case 10:++a;case 11:s.next=4;break;case 13:s.next=18;break;case 15:s.prev=15,s.t0=s.catch(2),i.e(s.t0);case 18:return s.prev=18,i.f(),s.finish(18);case 21:case"end":return s.stop()}}),xH,null,[[2,15,18,21]])}function NH(e){mu.call(this,null,e)}NH.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};var DH=[-1e5,-1e5,1e5,1e5];function FH(e){for(var t=e[0][0],n=e[0][1],r=e.length-1;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}function IH(e,t,n){return e.fields=t||[],e.fname=n,e}function MH(e){return 1===e.length?OH(e[0]):RH(e)}ht(NH,mu,{transform:function(e,t){var n=e.as||"path",r=t.source;if(!r||!r.length)return t;var a=e.size;a=a?[0,0,a[0],a[1]]:(a=e.extent)?[a[0][0],a[0][1],a[1][0],a[1][1]]:DH;for(var i=this.value=AH.from(r,e.x,e.y).voronoi(a),o=0,u=r.length;o<u;++o){var s=i.cellPolygon(o);r[o][n]=s?FH(s):null}return t.reflow(e.modified()).modifies(n)}});var OH=function(e){return function(t){return t[e]}},RH=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function ZH(e){throw Error(e)}function BH(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n),s+=e.substring(++n,++n),t=n;else if(r===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&c(),u=t=n+1):"]"===r&&(u||ZH("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&ZH("Access path missing closing bracket: "+e),o&&ZH("Access path missing closing quote: "+e),n>t&&(n++,c()),a}function zH(e,t,n){var r=BH(e);return e=1===r.length?r[0]:e,IH((n&&n.get||MH)(r),[e],t||e)}zH("id"),IH((function(e){return e}),[],"identity"),IH((function(){return 0}),[],"zero"),IH((function(){return 1}),[],"one"),IH((function(){return!0}),[],"true"),IH((function(){return!1}),[],"false");var LH=Array.isArray;function PH(e){return e[e.length-1]}function jH(e){return null==e||""===e?null:+e}function UH(e){return null!=e?LH(e)?e:[e]:[]}function WH(e){return"function"===typeof e}Object.prototype.hasOwnProperty;function VH(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function GH(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function qH(e){var t,n,r;function a(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<i){if(0!==t(r,r))return i;do{var o=a+i>>>1;n(e[o],r)<0?a=o+1:i=o}while(a<i)}return a}return 2!==e.length?(t=VH,n=function(t,n){return VH(e(t),n)},r=function(t,n){return e(t)-n}):(t=e===VH||e===GH?e:HH,n=e,r=e),{left:a,center:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,o=a(e,t,n,i-1);return o>n&&r(e[o-1],t)>-r(e[o],t)?o-1:o},right:function(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<i){if(0!==t(r,r))return i;do{var o=a+i>>>1;n(e[o],r)<=0?a=o+1:i=o}while(a<i)}return a}}}function HH(){return 0}function XH(e){return null===e?NaN:+e}var YH=qH(VH),KH=YH.right,$H=(YH.left,qH(XH).center,KH),QH=Math.sqrt(50),JH=Math.sqrt(10),eX=Math.sqrt(2);function tX(e,t,n){var r,a,i,o=(t-e)/Math.max(0,n),u=Math.floor(Math.log10(o)),s=o/Math.pow(10,u),c=s>=QH?10:s>=JH?5:s>=eX?2:1;return u<0?(i=Math.pow(10,-u)/c,(r=Math.round(e*i))/i<e&&++r,(a=Math.round(t*i))/i>t&&--a,i=-i):(i=Math.pow(10,u)*c,(r=Math.round(e/i))*i<e&&++r,(a=Math.round(t/i))*i>t&&--a),a<r&&.5<=n&&n<2?tX(e,t,2*n):[r,a,i]}function nX(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];var r=t<e,a=r?tX(t,e,n):tX(e,t,n),i=(0,ku.Z)(a,3),o=i[0],u=i[1],s=i[2];if(!(u>=o))return[];var c=u-o+1,l=new Array(c);if(r)if(s<0)for(var f=0;f<c;++f)l[f]=(u-f)/-s;else for(var d=0;d<c;++d)l[d]=(u-d)*s;else if(s<0)for(var h=0;h<c;++h)l[h]=(o+h)/-s;else for(var p=0;p<c;++p)l[p]=(o+p)*s;return l}function rX(e,t,n){return tX(e=+e,t=+t,n=+n)[2]}function aX(e,t,n){n=+n;var r=(t=+t)<(e=+e),a=r?rX(t,e,n):rX(e,t,n);return(r?-1:1)*(a<0?1/-a:a)}function iX(e,t,n,r,a){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*n+(1+3*e+3*i-3*o)*r+o*a)/6}function oX(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),a=e[r],i=e[r+1],o=r>0?e[r-1]:2*a-i,u=r<t-1?e[r+2]:2*i-a;return iX((n-r/t)*t,o,a,i,u)}}function uX(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),a=e[(r+t-1)%t],i=e[r%t],o=e[(r+1)%t],u=e[(r+2)%t];return iX((n-r/t)*t,a,i,o,u)}}var sX=function(e){return function(){return e}};function cX(e,t){return function(n){return e+n*t}}function lX(e,t){var n=t-e;return n?cX(e,n>180||n<-180?n-360*Math.round(n/360):n):sX(isNaN(e)?t:e)}function fX(e){return 1===(e=+e)?dX:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):sX(isNaN(t)?n:t)}}function dX(e,t){var n=t-e;return n?cX(e,n):sX(isNaN(e)?t:e)}var hX=function e(t){var n=fX(t);function r(e,t){var r=n((e=Ky(e)).r,(t=Ky(t)).r),a=n(e.g,t.g),i=n(e.b,t.b),o=dX(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=a(t),e.b=i(t),e.opacity=o(t),e+""}}return r.gamma=e,r}(1);function pX(e){return function(t){var n,r,a=t.length,i=new Array(a),o=new Array(a),u=new Array(a);for(n=0;n<a;++n)r=Ky(t[n]),i[n]=r.r||0,o[n]=r.g||0,u[n]=r.b||0;return i=e(i),o=e(o),u=e(u),r.opacity=1,function(e){return r.r=i(e),r.g=o(e),r.b=u(e),r+""}}}var vX=pX(oX),gX=pX(uX);function mX(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}}function yX(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function bX(e,t){return(yX(t)?mX:xX)(e,t)}function xX(e,t){var n,r=t?t.length:0,a=e?Math.min(r,e.length):0,i=new Array(a),o=new Array(r);for(n=0;n<a;++n)i[n]=EX(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<a;++n)o[n]=i[n](e);return o}}function kX(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function wX(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function _X(e,t){var n,r={},a={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=EX(e[n],t[n]):a[n]=t[n];return function(e){for(n in r)a[n]=r[n](e);return a}}var CX=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,SX=new RegExp(CX.source,"g");function AX(e,t){var n,r,a,i=CX.lastIndex=SX.lastIndex=0,o=-1,u=[],s=[];for(e+="",t+="";(n=CX.exec(e))&&(r=SX.exec(t));)(a=r.index)>i&&(a=t.slice(i,a),u[o]?u[o]+=a:u[++o]=a),(n=n[0])===(r=r[0])?u[o]?u[o]+=r:u[++o]=r:(u[++o]=null,s.push({i:o,x:wX(n,r)})),i=SX.lastIndex;return i<t.length&&(a=t.slice(i),u[o]?u[o]+=a:u[++o]=a),u.length<2?s[0]?function(e){return function(t){return e(t)+""}}(s[0].x):function(e){return function(){return e}}(t):(t=s.length,function(e){for(var n,r=0;r<t;++r)u[(n=s[r]).i]=n.x(e);return u.join("")})}function EX(e,t){var n,r=typeof t;return null==t||"boolean"===r?sX(t):("number"===r?wX:"string"===r?(n=qy(t))?(t=n,hX):AX:t instanceof qy?hX:t instanceof Date?kX:yX(t)?mX:Array.isArray(t)?xX:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?_X:wX)(e,t)}function TX(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function NX(e){return+e}var DX=[0,1];function FX(e){return e}function IX(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function MX(e,t,n){var r=e[0],a=e[1],i=t[0],o=t[1];return a<r?(r=IX(a,r),i=n(o,i)):(r=IX(r,a),i=n(i,o)),function(e){return i(r(e))}}function OX(e,t,n){var r=Math.min(e.length,t.length)-1,a=new Array(r),i=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)a[o]=IX(e[o],e[o+1]),i[o]=n(t[o],t[o+1]);return function(t){var n=$H(e,t,1,r)-1;return i[n](a[n](t))}}function RX(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function ZX(){var e,t,n,r,a,i,o=DX,u=DX,s=EX,c=FX;function l(){var e=Math.min(o.length,u.length);return c!==FX&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(o[0],o[e-1])),r=e>2?OX:MX,a=i=null,f}function f(t){return null==t||isNaN(t=+t)?n:(a||(a=r(o.map(e),u,s)))(e(c(t)))}return f.invert=function(n){return c(t((i||(i=r(u,o.map(e),wX)))(n)))},f.domain=function(e){return arguments.length?(o=Array.from(e,NX),l()):o.slice()},f.range=function(e){return arguments.length?(u=Array.from(e),l()):u.slice()},f.rangeRound=function(e){return u=Array.from(e),s=TX,l()},f.clamp=function(e){return arguments.length?(c=!!e||FX,l()):c!==FX},f.interpolate=function(e){return arguments.length?(s=e,l()):s},f.unknown=function(e){return arguments.length?(n=e,f):n},function(n,r){return e=n,t=r,l()}}function BX(){return ZX()(FX,FX)}function zX(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function LX(e,t){switch(arguments.length){case 0:break;case 1:"function"===typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"===typeof t?this.interpolator(t):this.range(t)}return this}function PX(e,t,n,r){var a,i=aX(e,t,n);switch((r=(0,pT.formatSpecifier)(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(a=(0,pT.precisionPrefix)(i,o))||(r.precision=a),(0,pT.formatPrefix)(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=(0,pT.precisionRound)(i,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=(0,pT.precisionFixed)(i))||(r.precision=a-2*("%"===r.type))}return(0,pT.format)(r)}function jX(e){var t=e.domain;return e.ticks=function(e){var n=t();return nX(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return PX(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,a,i=t(),o=0,u=i.length-1,s=i[o],c=i[u],l=10;for(c<s&&(a=s,s=c,c=a,a=o,o=u,u=a);l-- >0;){if((a=rX(s,c,n))===r)return i[o]=s,i[u]=c,t(i);if(a>0)s=Math.floor(s/a)*a,c=Math.ceil(c/a)*a;else{if(!(a<0))break;s=Math.ceil(s*a)/a,c=Math.floor(c*a)/a}r=a}return e},e}function UX(e,t){var n,r=0,a=(e=e.slice()).length-1,i=e[r],o=e[a];return o<i&&(n=r,r=a,a=n,n=i,i=o,o=n),e[r]=t.floor(i),e[a]=t.ceil(o),e}function WX(e){return Math.log(e)}function VX(e){return Math.exp(e)}function GX(e){return-Math.log(-e)}function qX(e){return-Math.exp(-e)}function HX(e){return isFinite(e)?+("1e"+e):e<0?0:e}function XX(e){return function(t,n){return-e(-t,n)}}function YX(e){var t,n,r=e(WX,VX),a=r.domain,i=10;function o(){return t=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(i),n=function(e){return 10===e?HX:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(i),a()[0]<0?(t=XX(t),n=XX(n),e(GX,qX)):e(WX,VX),r}return r.base=function(e){return arguments.length?(i=+e,o()):i},r.domain=function(e){return arguments.length?(a(e),o()):a()},r.ticks=function(e){var r=a(),o=r[0],u=r[r.length-1],s=u<o;if(s){var c=[u,o];o=c[0],u=c[1]}var l,f,d=t(o),h=t(u),p=null==e?10:+e,v=[];if(!(i%1)&&h-d<p){if(d=Math.floor(d),h=Math.ceil(h),o>0){for(;d<=h;++d)for(l=1;l<i;++l)if(!((f=d<0?l/n(-d):l*n(d))<o)){if(f>u)break;v.push(f)}}else for(;d<=h;++d)for(l=i-1;l>=1;--l)if(!((f=d>0?l/n(-d):l*n(d))<o)){if(f>u)break;v.push(f)}2*v.length<p&&(v=nX(o,u,p))}else v=nX(d,h,Math.min(h-d,p)).map(n);return s?v.reverse():v},r.tickFormat=function(e,a){if(null==e&&(e=10),null==a&&(a=10===i?"s":","),"function"!==typeof a&&(i%1||null!=(a=(0,pT.formatSpecifier)(a)).precision||(a.trim=!0),a=(0,pT.format)(a)),e===1/0)return a;var o=Math.max(1,i*e/r.ticks().length);return function(e){var r=e/n(Math.round(t(e)));return r*i<i-.5&&(r*=i),r<=o?a(e):""}},r.nice=function(){return a(UX(a(),{floor:function(e){return n(Math.floor(t(e)))},ceil:function(e){return n(Math.ceil(t(e)))}}))},r}function KX(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function $X(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function QX(e){return e<0?-e*e:e*e}function JX(e){var t=e(FX,FX),n=1;function r(){return 1===n?e(FX,FX):.5===n?e($X,QX):e(KX(n),KX(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,r()):n},jX(t)}function eY(){var e=JX(ZX());return e.copy=function(){return RX(e,eY()).exponent(e.exponent())},zX.apply(e,arguments),e}function tY(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function nY(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function rY(e){var t=1,n=e(tY(t),nY(t));return n.constant=function(n){return arguments.length?e(tY(t=+n),nY(t)):t},jX(n)}var aY=1e3,iY=6e4,oY=36e5,uY=864e5,sY=6048e5,cY=2592e6,lY=31536e6,fY=new Date,dY=new Date;function hY(e,t,n,r){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=function(t){return e(t=new Date(+t)),t},a.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},a.round=function(e){var t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},a.range=function(n,r,i){var o,u=[];if(n=a.ceil(n),i=null==i?1:Math.floor(i),!(n<r)||!(i>0))return u;do{u.push(o=new Date(+n)),t(n,i),e(n)}while(o<n&&n<r);return u},a.filter=function(n){return hY((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(a.count=function(t,r){return fY.setTime(+t),dY.setTime(+r),e(fY),e(dY),Math.floor(n(fY,dY))},a.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(r?function(t){return r(t)%e===0}:function(t){return a.count(0,t)%e===0}):a:null}),a}var pY=hY((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));pY.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?hY((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):pY:null};pY.range;var vY=hY((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*aY)}),(function(e,t){return(t-e)/aY}),(function(e){return e.getUTCSeconds()})),gY=(vY.range,hY((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*aY)}),(function(e,t){e.setTime(+e+t*iY)}),(function(e,t){return(t-e)/iY}),(function(e){return e.getMinutes()}))),mY=(gY.range,hY((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*iY)}),(function(e,t){return(t-e)/iY}),(function(e){return e.getUTCMinutes()}))),yY=(mY.range,hY((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*aY-e.getMinutes()*iY)}),(function(e,t){e.setTime(+e+t*oY)}),(function(e,t){return(t-e)/oY}),(function(e){return e.getHours()}))),bY=(yY.range,hY((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*oY)}),(function(e,t){return(t-e)/oY}),(function(e){return e.getUTCHours()}))),xY=(bY.range,hY((function(e){return e.setHours(0,0,0,0)}),(function(e,t){return e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*iY)/uY}),(function(e){return e.getDate()-1}))),kY=(xY.range,hY((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/uY}),(function(e){return e.getUTCDate()-1}))),wY=(kY.range,hY((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/uY}),(function(e){return Math.floor(e/uY)})));wY.range;function _Y(e){return hY((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*iY)/sY}))}var CY=_Y(0),SY=_Y(1),AY=_Y(2),EY=_Y(3),TY=_Y(4),NY=_Y(5),DY=_Y(6);CY.range,SY.range,AY.range,EY.range,TY.range,NY.range,DY.range;function FY(e){return hY((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/sY}))}var IY=FY(0),MY=FY(1),OY=FY(2),RY=FY(3),ZY=FY(4),BY=FY(5),zY=FY(6),LY=(IY.range,MY.range,OY.range,RY.range,ZY.range,BY.range,zY.range,hY((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()}))),PY=(LY.range,hY((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()}))),jY=(PY.range,hY((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()})));jY.every=function(e){return isFinite(e=Math.floor(e))&&e>0?hY((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};jY.range;var UY=hY((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));UY.every=function(e){return isFinite(e=Math.floor(e))&&e>0?hY((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};UY.range;function WY(e,t,n,r,a,i){var o=[[vY,1,aY],[vY,5,5e3],[vY,15,15e3],[vY,30,3e4],[i,1,iY],[i,5,3e5],[i,15,9e5],[i,30,18e5],[a,1,oY],[a,3,108e5],[a,6,216e5],[a,12,432e5],[r,1,uY],[r,2,1728e5],[n,1,sY],[t,1,cY],[t,3,7776e6],[e,1,lY]];function u(t,n,r){var a=Math.abs(n-t)/r,i=qH((function(e){return(0,ku.Z)(e,3)[2]})).right(o,a);if(i===o.length)return e.every(aX(t/lY,n/lY,r));if(0===i)return pY.every(Math.max(aX(t,n,r),1));var u=(0,ku.Z)(o[a/o[i-1][2]<o[i][2]/a?i-1:i],2),s=u[0],c=u[1];return s.every(c)}return[function(e,t,n){var r=t<e;if(r){var a=[t,e];e=a[0],t=a[1]}var i=n&&"function"===typeof n.range?n:u(e,t,n),o=i?i.range(e,+t+1):[];return r?o.reverse():o},u]}var VY=WY(UY,PY,IY,wY,bY,mY),GY=(0,ku.Z)(VY,2),qY=GY[0],HY=GY[1],XY=WY(jY,LY,CY,xY,yY,gY),YY=(0,ku.Z)(XY,2),KY=YY[0],$Y=YY[1];function QY(e){return new Date(e)}function JY(e){return e instanceof Date?+e:+new Date(+e)}function eK(e,t,n,r,a,i,o,u,s,c){var l=BX(),f=l.invert,d=l.domain,h=c(".%L"),p=c(":%S"),v=c("%I:%M"),g=c("%I %p"),m=c("%a %d"),y=c("%b %d"),b=c("%B"),x=c("%Y");function k(e){return(s(e)<e?h:u(e)<e?p:o(e)<e?v:i(e)<e?g:r(e)<e?a(e)<e?m:y:n(e)<e?b:x)(e)}return l.invert=function(e){return new Date(f(e))},l.domain=function(e){return arguments.length?d(Array.from(e,JY)):d().map(QY)},l.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},l.tickFormat=function(e,t){return null==t?k:c(t)},l.nice=function(e){var n=d();return e&&"function"===typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(UX(n,e)):l},l.copy=function(){return RX(l,eK(e,t,n,r,a,i,o,u,s,c))},l}function tK(){var e,t,n,r,a,i=0,o=1,u=FX,s=!1;function c(t){return null==t||isNaN(t=+t)?a:u(0===n?.5:(t=(r(t)-e)*n,s?Math.max(0,Math.min(1,t)):t))}function l(e){return function(t){var n,r,a;return arguments.length?(r=(n=(0,ku.Z)(t,2))[0],a=n[1],u=e(r,a),c):[u(0),u(1)]}}return c.domain=function(a){var u;return arguments.length?(u=(0,ku.Z)(a,2),i=u[0],o=u[1],e=r(i=+i),t=r(o=+o),n=e===t?0:1/(t-e),c):[i,o]},c.clamp=function(e){return arguments.length?(s=!!e,c):s},c.interpolator=function(e){return arguments.length?(u=e,c):u},c.range=l(EX),c.rangeRound=l(TX),c.unknown=function(e){return arguments.length?(a=e,c):a},function(a){return r=a,e=a(i),t=a(o),n=e===t?0:1/(t-e),c}}function nK(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function rK(){var e=jX(tK()(FX));return e.copy=function(){return nK(e,rK())},LX.apply(e,arguments)}function aK(){var e=JX(tK());return e.copy=function(){return nK(e,aK()).exponent(e.exponent())},LX.apply(e,arguments)}function iK(e,t){void 0===t&&(t=e,e=EX);for(var n=0,r=t.length-1,a=t[0],i=new Array(r<0?0:r);n<r;)i[n]=e(a,a=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return i[t](e-t)}}function oK(){var e,t,n,r,a,i,o,u=0,s=.5,c=1,l=1,f=FX,d=!1;function h(e){return isNaN(e=+e)?o:(e=.5+((e=+i(e))-t)*(l*e<l*t?r:a),f(d?Math.max(0,Math.min(1,e)):e))}function p(e){return function(t){var n,r,a,i;return arguments.length?(r=(n=(0,ku.Z)(t,3))[0],a=n[1],i=n[2],f=iK(e,[r,a,i]),h):[f(0),f(.5),f(1)]}}return h.domain=function(o){var f;return arguments.length?(f=(0,ku.Z)(o,3),u=f[0],s=f[1],c=f[2],e=i(u=+u),t=i(s=+s),n=i(c=+c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),l=t<e?-1:1,h):[u,s,c]},h.clamp=function(e){return arguments.length?(d=!!e,h):d},h.interpolator=function(e){return arguments.length?(f=e,h):f},h.range=p(EX),h.rangeRound=p(TX),h.unknown=function(e){return arguments.length?(o=e,h):o},function(o){return i=o,e=o(u),t=o(s),n=o(c),r=e===t?0:.5/(t-e),a=t===n?0:.5/(n-t),l=t<e?-1:1,h}}function uK(){var e=JX(oK());return e.copy=function(){return nK(e,uK()).exponent(e.exponent())},LX.apply(e,arguments)}function sK(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:XH;if((r=e.length)&&!isNaN(t=+t)){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,i=Math.floor(a),o=+n(e[i],i,e),u=+n(e[i+1],i+1,e);return o+(u-o)*(a-i)}}var cK=Symbol("implicit");function lK(){var e=new Fx,t=[],n=[],r=cK;function a(a){var i=e.get(a);if(void 0===i){if(r!==cK)return r;e.set(a,i=t.push(a)-1)}return n[i%n.length]}return a.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Fx;var r,i=(0,Zt.Z)(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;e.has(o)||e.set(o,t.push(o)-1)}}catch(u){i.e(u)}finally{i.f()}return a},a.range=function(e){return arguments.length?(n=Array.from(e),a):n.slice()},a.unknown=function(e){return arguments.length?(r=e,a):r},a.copy=function(){return lK(t,n).unknown(r)},zX.apply(a,arguments),a}function fK(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function dK(e,t){var n=lX(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}}var hK,pK=180/Math.PI,vK={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function gK(e,t,n,r,a,i){var o,u,s;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(s=e*n+t*r)&&(n-=e*s,r-=t*s),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,s/=u),e*r<t*n&&(e=-e,t=-t,s=-s,o=-o),{translateX:a,translateY:i,rotate:Math.atan2(t,e)*pK,skewX:Math.atan(s)*pK,scaleX:o,scaleY:u}}function mK(e,t,n,r){function a(e){return e.length?e.pop()+" ":""}return function(i,o){var u=[],s=[];return i=e(i),o=e(o),function(e,r,a,i,o,u){if(e!==a||r!==i){var s=o.push("translate(",null,t,null,n);u.push({i:s-4,x:wX(e,a)},{i:s-2,x:wX(r,i)})}else(a||i)&&o.push("translate("+a+t+i+n)}(i.translateX,i.translateY,o.translateX,o.translateY,u,s),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(a(n)+"rotate(",null,r)-2,x:wX(e,t)})):t&&n.push(a(n)+"rotate("+t+r)}(i.rotate,o.rotate,u,s),function(e,t,n,i){e!==t?i.push({i:n.push(a(n)+"skewX(",null,r)-2,x:wX(e,t)}):t&&n.push(a(n)+"skewX("+t+r)}(i.skewX,o.skewX,u,s),function(e,t,n,r,i,o){if(e!==n||t!==r){var u=i.push(a(i)+"scale(",null,",",null,")");o.push({i:u-4,x:wX(e,n)},{i:u-2,x:wX(t,r)})}else 1===n&&1===r||i.push(a(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,o.scaleX,o.scaleY,u,s),i=o=null,function(e){for(var t,n=-1,r=s.length;++n<r;)u[(t=s[n]).i]=t.x(e);return u.join("")}}}var yK=mK((function(e){var t=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?vK:gK(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),bK=mK((function(e){return null==e?vK:(hK||(hK=document.createElementNS("http://www.w3.org/2000/svg","g")),hK.setAttribute("transform",e),(e=hK.transform.baseVal.consolidate())?gK((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):vK)}),", ",")",")");function xK(e){return((e=Math.exp(e))+1/e)/2}var kK=function e(t,n,r){function a(e,a){var i,o,u=e[0],s=e[1],c=e[2],l=a[0],f=a[1],d=a[2],h=l-u,p=f-s,v=h*h+p*p;if(v<1e-12)o=Math.log(d/c)/t,i=function(e){return[u+e*h,s+e*p,c*Math.exp(t*e*o)]};else{var g=Math.sqrt(v),m=(d*d-c*c+r*v)/(2*c*n*g),y=(d*d-c*c-r*v)/(2*d*n*g),b=Math.log(Math.sqrt(m*m+1)-m),x=Math.log(Math.sqrt(y*y+1)-y);o=(x-b)/t,i=function(e){var r=e*o,a=xK(b),i=c/(n*g)*(a*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*r+b)-function(e){return((e=Math.exp(e))-1/e)/2}(b));return[u+i*h,s+i*p,c*a/xK(t*r+b)]}}return i.duration=1e3*o*t/Math.SQRT2,i}return a.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},a}(Math.SQRT2,2,4);function wK(e){return function(t,n){var r=e((t=rb(t)).h,(n=rb(n)).h),a=dX(t.s,n.s),i=dX(t.l,n.l),o=dX(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=a(e),t.l=i(e),t.opacity=o(e),t+""}}}var _K=wK(lX),CK=wK(dX);function SK(e,t){var n=dX((e=uk(e)).l,(t=uk(t)).l),r=dX(e.a,t.a),a=dX(e.b,t.b),i=dX(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=a(t),e.opacity=i(t),e+""}}function AK(e){return function(t,n){var r=e((t=pk(t)).h,(n=pk(n)).h),a=dX(t.c,n.c),i=dX(t.l,n.l),o=dX(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=a(e),t.l=i(e),t.opacity=o(e),t+""}}}var EK=AK(lX),TK=AK(dX);function NK(e){return function t(n){function r(t,r){var a=e((t=Dk(t)).h,(r=Dk(r)).h),i=dX(t.s,r.s),o=dX(t.l,r.l),u=dX(t.opacity,r.opacity);return function(e){return t.h=a(e),t.s=i(e),t.l=o(Math.pow(e,n)),t.opacity=u(e),t+""}}return n=+n,r.gamma=t,r}(1)}var DK,FK,IK,MK,OK,RK,ZK,BK=NK(lX),zK=NK(dX);function LK(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var PK="year",jK="quarter",UK="month",WK="week",VK="date",GK="day",qK="dayofyear",HK="hours",XK="minutes",YK="seconds",KK="milliseconds";[PK,jK,UK,WK,VK,GK,qK,HK,XK,YK,KK].reduce((function(e,t,n){return e[t]=1+n,e}),{});DK={},(0,qn.Z)(DK,PK,"%Y "),(0,qn.Z)(DK,jK,"Q%q "),(0,qn.Z)(DK,UK,"%b "),(0,qn.Z)(DK,VK,"%d "),(0,qn.Z)(DK,WK,"W%U "),(0,qn.Z)(DK,GK,"%a "),(0,qn.Z)(DK,qK,"%j "),(0,qn.Z)(DK,HK,"%H:00"),(0,qn.Z)(DK,XK,"00:%M"),(0,qn.Z)(DK,YK,":%S"),(0,qn.Z)(DK,KK,".%L"),(0,qn.Z)(DK,"".concat(PK,"-").concat(UK),"%Y-%m "),(0,qn.Z)(DK,"".concat(PK,"-").concat(UK,"-").concat(VK),"%Y-%m-%d "),(0,qn.Z)(DK,"".concat(HK,"-").concat(XK),"%H:%M");var $K=new Date;function QK(e){return $K.setFullYear(e),$K.setMonth(0),$K.setDate(1),$K.setHours(0,0,0,0),$K}function JK(e){return xY.count(QK(e.getFullYear())-1,e)}function e$(e){return CY.count(QK(e.getFullYear())-1,e)}function t$(e){return QK(e).getDay()}function n$(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return kY.count(t-1,e)}function r$(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return IY.count(t-1,e)}function a$(e){return $K.setTime(Date.UTC(e,0,1)),$K.getUTCDay()}function i$(e,t,n){return t+7*e-(n+6)%7}FK={},(0,qn.Z)(FK,PK,(function(e){return e.getFullYear()})),(0,qn.Z)(FK,jK,(function(e){return Math.floor(e.getMonth()/3)})),(0,qn.Z)(FK,UK,(function(e){return e.getMonth()})),(0,qn.Z)(FK,VK,(function(e){return e.getDate()})),(0,qn.Z)(FK,HK,(function(e){return e.getHours()})),(0,qn.Z)(FK,XK,(function(e){return e.getMinutes()})),(0,qn.Z)(FK,YK,(function(e){return e.getSeconds()})),(0,qn.Z)(FK,KK,(function(e){return e.getMilliseconds()})),(0,qn.Z)(FK,qK,(function(e){return JK(e)})),(0,qn.Z)(FK,WK,(function(e){return e$(e)})),(0,qn.Z)(FK,WK+GK,(function(e,t){return i$(e$(e),e.getDay(),t$(t))})),(0,qn.Z)(FK,GK,(function(e,t){return i$(1,e.getDay(),t$(t))})),IK={},(0,qn.Z)(IK,jK,(function(e){return 3*e})),(0,qn.Z)(IK,WK,(function(e,t){return i$(e,0,t$(t))}));MK={},(0,qn.Z)(MK,PK,(function(e){return e.getUTCFullYear()})),(0,qn.Z)(MK,jK,(function(e){return Math.floor(e.getUTCMonth()/3)})),(0,qn.Z)(MK,UK,(function(e){return e.getUTCMonth()})),(0,qn.Z)(MK,VK,(function(e){return e.getUTCDate()})),(0,qn.Z)(MK,HK,(function(e){return e.getUTCHours()})),(0,qn.Z)(MK,XK,(function(e){return e.getUTCMinutes()})),(0,qn.Z)(MK,YK,(function(e){return e.getUTCSeconds()})),(0,qn.Z)(MK,KK,(function(e){return e.getUTCMilliseconds()})),(0,qn.Z)(MK,qK,(function(e){return n$(e)})),(0,qn.Z)(MK,WK,(function(e){return r$(e)})),(0,qn.Z)(MK,GK,(function(e,t){return i$(1,e.getUTCDay(),a$(t))})),(0,qn.Z)(MK,WK+GK,(function(e,t){return i$(r$(e),e.getUTCDay(),a$(t))})),OK={},(0,qn.Z)(OK,jK,(function(e){return 3*e})),(0,qn.Z)(OK,WK,(function(e,t){return i$(e,0,a$(t))}));RK={},(0,qn.Z)(RK,PK,jY),(0,qn.Z)(RK,jK,LY.every(3)),(0,qn.Z)(RK,UK,LY),(0,qn.Z)(RK,WK,CY),(0,qn.Z)(RK,VK,xY),(0,qn.Z)(RK,GK,xY),(0,qn.Z)(RK,qK,xY),(0,qn.Z)(RK,HK,yY),(0,qn.Z)(RK,XK,gY),(0,qn.Z)(RK,YK,vY),(0,qn.Z)(RK,KK,pY),ZK={},(0,qn.Z)(ZK,PK,UY),(0,qn.Z)(ZK,jK,PY.every(3)),(0,qn.Z)(ZK,UK,PY),(0,qn.Z)(ZK,WK,IY),(0,qn.Z)(ZK,VK,kY),(0,qn.Z)(ZK,GK,kY),(0,qn.Z)(ZK,qK,kY),(0,qn.Z)(ZK,HK,bY),(0,qn.Z)(ZK,XK,mY),(0,qn.Z)(ZK,YK,vY),(0,qn.Z)(ZK,KK,pY);var o$,u$,s$=[PK,UK,VK,HK,XK,YK,KK],c$=s$.slice(0,-1),l$=c$.slice(0,-1),f$=l$.slice(0,-1);f$.slice(0,-1);var d$="linear",h$="log",p$="pow",v$="sqrt",g$="symlog",m$="time",y$="utc",b$="sequential",x$="diverging",k$="quantile",w$="quantize",_$="threshold",C$="continuous",S$="discrete",A$="discretizing",E$="interpolating",T$="temporal";function N$(){var e,t,n=lK().unknown(void 0),r=n.domain,a=n.range,i=[0,1],o=!1,u=0,s=0,c=.5;function l(){var n=r().length,l=i[1]<i[0],f=i[1-l],d=function(e,t,n){var r=e-t+2*n;return e?r>0?r:1:0}(n,u,s),h=i[l-0];e=(f-h)/(d||1),o&&(e=Math.floor(e)),h+=(f-h-e*(n-u))*c,t=e*(1-u),o&&(h=Math.round(h),t=Math.round(t));var p=function(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e+r*n;return i}(n).map((function(t){return h+e*t}));return a(l?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),l()):r()},n.range=function(e){return arguments.length?(i=[+e[0],+e[1]],l()):i.slice()},n.rangeRound=function(e){return i=[+e[0],+e[1]],o=!0,l()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(o=!!e,l()):o},n.padding=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),u=s,l()):u},n.paddingInner=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),l()):u},n.paddingOuter=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),l()):s},n.align=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),l()):c},n.invertRange=function(e){if(null!=e[0]&&null!=e[1]){var n,o,u,s=i[1]<i[0],c=s?a().reverse():a(),l=c.length-1,f=+e[0],d=+e[1];if(f===f&&d===d&&(d<f&&(u=f,f=d,d=u),!(d<c[0]||f>i[1-s])))return n=Math.max(0,KH(c,f)-1),o=f===d?n:KH(c,d)-1,f-c[n]>t+1e-10&&++n,s&&(u=n,n=l-o,o=l-u),n>o?void 0:r().slice(n,o+1)}},n.invert=function(e){var t=n.invertRange([e,e]);return t?t[0]:t},n.copy=function(){return N$().domain(r()).range(i).round(o).paddingInner(u).paddingOuter(s).align(c)},l()}function D$(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return D$(t())},e}var F$=Array.prototype.map;function I$(e){return F$.call(e,jH)}var M$=Array.prototype.slice;var O$=new Map,R$=Symbol("vega_scale");function Z$(e,t,n){var r=function(){var n=t();return n.invertRange||(n.invertRange=n.invert?function(e){return function(t){var n,r=t[0],a=t[1];return a<r&&(n=r,r=a,a=n),[e.invert(r),e.invert(a)]}}(n):n.invertExtent?function(e){return function(t){var n,r,a,i,o=e.range(),u=t[0],s=t[1],c=-1;for(s<u&&(r=u,u=s,s=r),a=0,i=o.length;a<i;++a)o[a]>=u&&o[a]<=s&&(c<0&&(c=a),n=a);if(!(c<0))return u=e.invertExtent(o[c]),s=e.invertExtent(o[n]),[void 0===u[0]?u[1]:u[0],void 0===s[1]?s[0]:s[1]]}}(n):void 0),n.type=e,function(e){return e[R$]=!0,e}(n)};return r.metadata=function(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return t}(UH(n)),r}function B$(e,t,n){return arguments.length>1?(O$.set(e,Z$(e,t,n)),this):z$(e)?O$.get(e):void 0}function z$(e){return O$.has(e)}B$("identity",(function e(t){var n;function r(e){return null==e||isNaN(e=+e)?n:e}return r.invert=r,r.domain=r.range=function(e){return arguments.length?(t=Array.from(e,NX),r):t.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return e(t).unknown(n)},t=arguments.length?Array.from(t,NX):[0,1],jX(r)})),B$(d$,(function e(){var t=BX();return t.copy=function(){return RX(t,e())},zX.apply(t,arguments),jX(t)}),C$),B$(h$,(function e(){var t=YX(ZX()).domain([1,10]);return t.copy=function(){return RX(t,e()).base(t.base())},zX.apply(t,arguments),t}),[C$,h$]),B$(p$,eY,C$),B$(v$,(function(){return eY.apply(null,arguments).exponent(.5)}),C$),B$(g$,(function e(){var t=rY(ZX());return t.copy=function(){return RX(t,e()).constant(t.constant())},zX.apply(t,arguments)}),C$),B$(m$,(function(){return zX.apply(eK(KY,$Y,jY,LY,CY,xY,yY,gY,vY,AN).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[C$,T$]),B$(y$,(function(){return zX.apply(eK(qY,HY,UY,PY,IY,kY,bY,mY,vY,TN).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[C$,T$]),B$(b$,rK,[C$,E$]),B$("".concat(b$,"-").concat(d$),rK,[C$,E$]),B$("".concat(b$,"-").concat(h$),(function e(){var t=YX(tK()).domain([1,10]);return t.copy=function(){return nK(t,e()).base(t.base())},LX.apply(t,arguments)}),[C$,E$,h$]),B$("".concat(b$,"-").concat(p$),aK,[C$,E$]),B$("".concat(b$,"-").concat(v$),(function(){return aK.apply(null,arguments).exponent(.5)}),[C$,E$]),B$("".concat(b$,"-").concat(g$),(function e(){var t=rY(tK());return t.copy=function(){return nK(t,e()).constant(t.constant())},LX.apply(t,arguments)}),[C$,E$]),B$("".concat(x$,"-").concat(d$),(function e(){var t=jX(oK()(FX));return t.copy=function(){return nK(t,e())},LX.apply(t,arguments)}),[C$,E$]),B$("".concat(x$,"-").concat(h$),(function e(){var t=YX(oK()).domain([.1,1,10]);return t.copy=function(){return nK(t,e()).base(t.base())},LX.apply(t,arguments)}),[C$,E$,h$]),B$("".concat(x$,"-").concat(p$),uK,[C$,E$]),B$("".concat(x$,"-").concat(v$),(function(){return uK.apply(null,arguments).exponent(.5)}),[C$,E$]),B$("".concat(x$,"-").concat(g$),(function e(){var t=rY(oK());return t.copy=function(){return nK(t,e()).constant(t.constant())},LX.apply(t,arguments)}),[C$,E$]),B$(k$,(function e(){var t,n=[],r=[],a=[];function i(){var e=0,t=Math.max(1,r.length);for(a=new Array(t-1);++e<t;)a[e-1]=sK(n,e/t);return o}function o(e){return null==e||isNaN(e=+e)?t:r[$H(a,e)]}return o.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?a[t-1]:n[0],t<a.length?a[t]:n[n.length-1]]},o.domain=function(e){if(!arguments.length)return n.slice();n=[];var t,r=(0,Zt.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;null==a||isNaN(a=+a)||n.push(a)}}catch(o){r.e(o)}finally{r.f()}return n.sort(VH),i()},o.range=function(e){return arguments.length?(r=Array.from(e),i()):r.slice()},o.unknown=function(e){return arguments.length?(t=e,o):t},o.quantiles=function(){return a.slice()},o.copy=function(){return e().domain(n).range(r).unknown(t)},zX.apply(o,arguments)}),[A$,k$]),B$(w$,(function e(){var t,n=0,r=1,a=1,i=[.5],o=[0,1];function u(e){return null!=e&&e<=e?o[$H(i,e,0,a)]:t}function s(){var e=-1;for(i=new Array(a);++e<a;)i[e]=((e+1)*r-(e-a)*n)/(a+1);return u}return u.domain=function(e){var t;return arguments.length?(t=(0,ku.Z)(e,2),n=t[0],r=t[1],n=+n,r=+r,s()):[n,r]},u.range=function(e){return arguments.length?(a=(o=Array.from(e)).length-1,s()):o.slice()},u.invertExtent=function(e){var t=o.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,i[0]]:t>=a?[i[a-1],r]:[i[t-1],i[t]]},u.unknown=function(e){return arguments.length?(t=e,u):u},u.thresholds=function(){return i.slice()},u.copy=function(){return e().domain([n,r]).range(o).unknown(t)},zX.apply(jX(u),arguments)}),A$),B$(_$,(function e(){var t,n=[.5],r=[0,1],a=1;function i(e){return null!=e&&e<=e?r[$H(n,e,0,a)]:t}return i.domain=function(e){return arguments.length?(n=Array.from(e),a=Math.min(n.length,r.length-1),i):n.slice()},i.range=function(e){return arguments.length?(r=Array.from(e),a=Math.min(n.length,r.length-1),i):r.slice()},i.invertExtent=function(e){var t=r.indexOf(e);return[n[t-1],n[t]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return e().domain(n).range(r).unknown(t)},zX.apply(i,arguments)}),A$),B$("bin-ordinal",(function e(){var t=[],n=[];function r(e){return null==e||e!==e?void 0:n[($H(t,e)-1)%n.length]}return r.domain=function(e){return arguments.length?(t=I$(e),r):t.slice()},r.range=function(e){return arguments.length?(n=M$.call(e),r):n.slice()},r.tickFormat=function(e,n){return PX(t[0],PH(t),null==e?10:e,n)},r.copy=function(){return e().domain(r.domain()).range(r.range())},r}),[S$,A$]),B$("ordinal",lK,S$),B$("band",N$,S$),B$("point",(function(){return D$(N$().paddingInner(1))}),S$);function L$(e,t,n){return iK(function(e,t){var n=g[function(e){return"interpolate"+e.toLowerCase().split("-").map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}(t||"rgb",n),e)}function P$(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}function j$(e,t){for(var n in e)W$(n,t(e[n]))}var U$={};function W$(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(U$[e]=t,this):U$[e]}j$({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},P$),j$({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(function(e){return L$(P$(e))}));o$={},(0,qn.Z)(o$,k$,"quantiles"),(0,qn.Z)(o$,w$,"thresholds"),(0,qn.Z)(o$,_$,"domain"),u$={},(0,qn.Z)(u$,k$,"quantiles"),(0,qn.Z)(u$,w$,"domain");var V$=Math.random;Math.sqrt(2*Math.PI),Math.SQRT2;Math.PI;var G$=Math.PI/180,q$=2048;function H$(){var e,t,n,r,a,i,o,u=[256,256],s=Q$,c=[],l=Math.random,f={};function d(e,t,n){for(var r,a,i,o=t.x,c=t.y,f=Math.sqrt(u[0]*u[0]+u[1]*u[1]),d=s(u),h=l()<.5?1:-1,p=-h;(r=d(p+=h))&&(a=~~r[0],i=~~r[1],!(Math.min(Math.abs(a),Math.abs(i))>=f));)if(t.x=o+a,t.y=c+i,!(t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>u[0]||t.y+t.y1>u[1])&&(!n||!Y$(t,e,u[0]))&&(!n||$$(t,n))){for(var v,g=t.sprite,m=t.width>>5,y=u[0]>>5,b=t.x-(m<<4),x=127&b,k=32-x,w=t.y1-t.y0,_=(t.y+t.y0)*y+(b>>5),C=0;C<w;C++){v=0;for(var S=0;S<=m;S++)e[_+S]|=v<<k|(S<m?(v=g[C*m+S])>>>x:0);_+=y}return t.sprite=null,!0}return!1}return f.layout=function(){for(var s=function(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=2048/t,e.height=q$/t;var n=e.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:t}}(_p()),f=function(e){var t=[],n=-1;for(;++n<e;)t[n]=0;return t}((u[0]>>5)*u[1]),h=null,p=c.length,v=-1,g=[],m=c.map((function(u){return{text:e(u),font:t(u),style:r(u),weight:a(u),rotate:i(u),size:~~(n(u)+1e-14),padding:o(u),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:u}})).sort((function(e,t){return t.size-e.size}));++v<p;){var y=m[v];y.x=u[0]*(l()+.5)>>1,y.y=u[1]*(l()+.5)>>1,X$(s,y,m,v),y.hasText&&d(f,y,h)&&(g.push(y),h?K$(h,y):h=[{x:y.x+y.x0,y:y.y+y.y0},{x:y.x+y.x1,y:y.y+y.y1}],y.x-=u[0]>>1,y.y-=u[1]>>1)}return g},f.words=function(e){return arguments.length?(c=e,f):c},f.size=function(e){return arguments.length?(u=[+e[0],+e[1]],f):u},f.font=function(e){return arguments.length?(t=J$(e),f):t},f.fontStyle=function(e){return arguments.length?(r=J$(e),f):r},f.fontWeight=function(e){return arguments.length?(a=J$(e),f):a},f.rotate=function(e){return arguments.length?(i=J$(e),f):i},f.text=function(t){return arguments.length?(e=J$(t),f):e},f.spiral=function(e){return arguments.length?(s=eQ[e]||e,f):s},f.fontSize=function(e){return arguments.length?(n=J$(e),f):n},f.padding=function(e){return arguments.length?(o=J$(e),f):o},f.random=function(e){return arguments.length?(l=e,f):l},f}function X$(e,t,n,r){if(!t.sprite){var a=e.context,i=e.ratio;a.clearRect(0,0,2048/i,q$/i);var o,u,s,c,l,f=0,d=0,h=0,p=n.length;for(--r;++r<p;){if(t=n[r],a.save(),a.font=t.style+" "+t.weight+" "+~~((t.size+1)/i)+"px "+t.font,o=a.measureText(t.text+"m").width*i,s=t.size<<1,t.rotate){var v=Math.sin(t.rotate*G$),g=Math.cos(t.rotate*G$),m=o*g,y=o*v,b=s*g,x=s*v;o=Math.max(Math.abs(m+x),Math.abs(m-x))+31>>5<<5,s=~~Math.max(Math.abs(y+b),Math.abs(y-b))}else o=o+31>>5<<5;if(s>h&&(h=s),f+o>=2048&&(f=0,d+=h,h=0),d+s>=q$)break;a.translate((f+(o>>1))/i,(d+(s>>1))/i),t.rotate&&a.rotate(t.rotate*G$),a.fillText(t.text,0,0),t.padding&&(a.lineWidth=2*t.padding,a.strokeText(t.text,0,0)),a.restore(),t.width=o,t.height=s,t.xoff=f,t.yoff=d,t.x1=o>>1,t.y1=s>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,f+=o}for(var k=a.getImageData(0,0,2048/i,q$/i).data,w=[];--r>=0;)if((t=n[r]).hasText){for(u=(o=t.width)>>5,s=t.y1-t.y0,c=0;c<s*u;c++)w[c]=0;if(null==(f=t.xoff))return;d=t.yoff;var _=0,C=-1;for(l=0;l<s;l++){for(c=0;c<o;c++){var S=u*l+(c>>5),A=k[2048*(d+l)+(f+c)<<2]?1<<31-c%32:0;w[S]|=A,_|=A}_?C=l:(t.y0++,s--,l--,d++)}t.y1=t.y0+C,t.sprite=w.slice(0,(t.y1-t.y0)*u)}}}function Y$(e,t,n){n>>=5;for(var r,a=e.sprite,i=e.width>>5,o=e.x-(i<<4),u=127&o,s=32-u,c=e.y1-e.y0,l=(e.y+e.y0)*n+(o>>5),f=0;f<c;f++){r=0;for(var d=0;d<=i;d++)if((r<<s|(d<i?(r=a[f*i+d])>>>u:0))&t[l+d])return!0;l+=n}return!1}function K$(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function $$(e,t){return e.x+e.x1>t[0].x&&e.x+e.x0<t[1].x&&e.y+e.y1>t[0].y&&e.y+e.y0<t[1].y}function Q$(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function J$(e){return"function"===typeof e?e:function(){return e}}var eQ={archimedean:Q$,rectangular:function(e){var t=4*e[0]/e[1],n=0,r=0;return function(e){var a=e<0?-1:1;switch(Math.sqrt(1+4*a*e)-a&3){case 0:n+=t;break;case 1:r+=4;break;case 2:n-=t;break;default:r-=4}return[n,r]}}},tQ=["x","y","font","fontSize","fontStyle","fontWeight","angle"],nQ=["text","font","rotate","fontSize","fontStyle","fontWeight"];function rQ(e){mu.call(this,H$(),e)}rQ.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:tQ}]},function(e,t,n){var r=e.prototype=Object.create(t.prototype);Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),function(e){for(var t,n,r=1,a=arguments.length;r<a;++r)for(n in t=arguments[r])e[n]=t[n]}(r,n)}(rQ,mu,{transform:function(e,t){!e.size||e.size[0]&&e.size[1]||ZH("Wordcloud size dimensions must be non-zero.");var n=e.modified();if(n||t.changed(t.ADD_REM)||nQ.some((function(n){var r=e[n];return WH(r)&&t.modified(r.fields)}))){var r,a=t.materialize(t.SOURCE).source,i=this.value,o=e.as||tQ,u=e.fontSize||14;if(WH(u)?r=e.fontSizeRange:u=function(e){return WH(e)?e:function(){return e}}(u),r){var s=u,c=B$("sqrt")().domain(function(e,t){var n,r,a,i,o=0;if(e&&(n=e.length))if(null==t){for(r=e[o];o<n&&(null==r||r!==r);r=e[++o]);for(a=i=r;o<n;++o)null!=(r=e[o])&&(r<a&&(a=r),r>i&&(i=r))}else{for(r=t(e[o]);o<n&&(null==r||r!==r);r=t(e[++o]));for(a=i=r;o<n;++o)null!=(r=t(e[o]))&&(r<a&&(a=r),r>i&&(i=r))}return[a,i]}(a,s)).range(r);u=function(e){return c(s(e))}}a.forEach((function(e){e[o[0]]=NaN,e[o[1]]=NaN,e[o[3]]=0}));for(var l,f,d=i.words(a).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(u).random(V$).layout(),h=i.size(),p=h[0]>>1,v=h[1]>>1,g=d.length,m=0;m<g;++m)(f=(l=d[m]).datum)[o[0]]=l.x+p,f[o[1]]=l.y+v,f[o[2]]=l.font,f[o[3]]=l.size,f[o[4]]=l.style,f[o[5]]=l.weight,f[o[6]]=l.rotate;return t.reflow(n).modifies(o)}}});var aQ=function(e){return new Uint8Array(e)},iQ=function(e){return new Uint16Array(e)},oQ=function(e){return new Uint32Array(e)};function uQ(e,t,n){var r=(t<257?aQ:t<65537?iQ:oQ)(e);return n&&r.set(n),r}function sQ(e,t,n){var r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd:function(e,t){var n,a=this,i=a.bisect(a.range,e.value),o=e.index,u=i[0],s=i[1],c=o.length;for(n=0;n<u;++n)t[o[n]]|=r;for(n=s;n<c;++n)t[o[n]]|=r;return a}}}function cQ(){var e=oQ(0),t=[],n=0;return{insert:function(r,a,i){if(!a.length)return[];var o,u,s,c=n,l=a.length,f=oQ(l),d=Array(l);for(s=0;s<l;++s)d[s]=r(a[s]),f[s]=s;if(d=function(e,t){return e.sort.call(t,(function(t,n){var r=e[t],a=e[n];return r<a?-1:r>a?1:0})),function(e,t){return Array.from(t,(function(t){return e[t]}))}(e,t)}(d,f),c)o=t,u=e,t=Array(c+l),e=oQ(c+l),function(e,t,n,r,a,i,o,u,s){var c,l=0,f=0;for(c=0;l<r&&f<o;++c)t[l]<a[f]?(u[c]=t[l],s[c]=n[l++]):(u[c]=a[f],s[c]=i[f++]+e);for(;l<r;++l,++c)u[c]=t[l],s[c]=n[l];for(;f<o;++f,++c)u[c]=a[f],s[c]=i[f]+e}(i,o,u,c,d,f,l,t,e);else{if(i>0)for(s=0;s<l;++s)f[s]+=i;t=d,e=f}return n=c+l,{index:f,value:d}},remove:function(r,a){var i,o,u,s=n;for(o=0;!a[e[o]]&&o<s;++o);for(u=o;o<s;++o)a[i=e[o]]||(e[u]=i,t[u]=t[o],++u);n=s-r},bisect:function(e,r){var a;return r?a=r.length:(r=t,a=n),[sT(r,e[0],0,a),uT(r,e[1],0,a)]},reindex:function(t){for(var r=0,a=n;r<a;++r)e[r]=t[e[r]]},index:function(){return e},size:function(){return n}}}function lQ(e){mu.call(this,function(){var e=8,t=[],n=oQ(0),r=uQ(0,e),a=uQ(0,e);return{data:function(){return t},seen:function(){return n=function(e,t,n){return e.length>=t?e:((n=n||new e.constructor(t)).set(e),n)}(n,t.length)},add:function(e){for(var n,r=0,a=t.length,i=e.length;r<i;++r)(n=e[r])._index=a++,t.push(n)},remove:function(e,n){var i,o,u,s=t.length,c=Array(s-e),l=t;for(o=0;!n[o]&&o<s;++o)c[o]=t[o],l[o]=o;for(u=o;o<s;++o)i=t[o],n[o]?l[o]=-1:(l[o]=u,r[u]=r[o],a[u]=a[o],c[u]=i,i._index=u++),r[o]=0;return t=c,l},size:function(){return t.length},curr:function(){return r},prev:function(){return a},reset:function(e){return a[e]=r[e]},all:function(){return e<257?255:e<65537?65535:4294967295},set:function(e,t){r[e]|=t},clear:function(e,t){r[e]&=~t},resize:function(t,n){(t>r.length||n>e)&&(e=Math.max(n,e),r=uQ(t,e,r),a=uQ(t,e))}}}(),e),this._indices=null,this._dims=null}function fQ(e){mu.call(this,null,e)}function dQ(e,t,n){return e.fields=t||[],e.fname=n,e}function hQ(e){return 1===e.length?pQ(e[0]):vQ(e)}lQ.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},ht(lQ,mu,{transform:function(e,t){return this._dims?e.modified("fields")||e.fields.some((function(e){return t.modified(e.fields)}))?this.reinit(e,t):this.eval(e,t):this.init(e,t)},init:function(e,t){for(var n,r,a=e.fields,i=e.query,o=this._indices={},u=this._dims=[],s=i.length,c=0;c<s;++c)r=o[n=a[c].fname]||(o[n]=cQ()),u.push(sQ(r,c,i[c]));return this.eval(e,t)},reinit:function(e,t){var n,r,a,i,o,u,s,c,l,f=t.materialize().fork(),d=e.fields,h=e.query,p=this._indices,v=this._dims,g=this.value,m=g.curr(),y=g.prev(),b=g.all(),x=f.rem=f.add,k=f.mod,w=h.length,_={};if(y.set(m),t.rem.length&&(o=this.remove(e,t,f)),t.add.length&&g.add(t.add),t.mod.length)for(u={},s=0,c=(i=t.mod).length;s<c;++s)u[i[s]._index]=1;for(s=0;s<w;++s)l=d[s],(!v[s]||e.modified("fields",s)||t.modified(l.fields))&&((n=_[a=l.fname])||(p[a]=r=cQ(),_[a]=n=r.insert(l,t.source,0)),v[s]=sQ(r,s,h[s]).onAdd(n,m));for(s=0,c=g.data().length;s<c;++s)o[s]||(y[s]!==m[s]?x.push(s):u[s]&&m[s]!==b&&k.push(s));return g.mask=(1<<w)-1,f},eval:function(e,t){var n=t.materialize().fork(),r=this._dims.length,a=0;return t.rem.length&&(this.remove(e,t,n),a|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(a|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),a|=(1<<r)-1),t.mod.length&&(this.modify(t,n),a|=(1<<r)-1),this.value.mask=a,n},insert:function(e,t,n){var r,a,i,o=t.add,u=this.value,s=this._dims,c=this._indices,l=e.fields,f={},d=n.add,h=u.size()+o.length,p=s.length,v=u.size();u.resize(h,p),u.add(o);var g=u.curr(),m=u.prev(),y=u.all();for(r=0;r<p;++r)i=f[a=l[r].fname]||(f[a]=c[a].insert(l[r],o,v)),s[r].onAdd(i,g);for(;v<h;++v)m[v]=y,g[v]!==y&&d.push(v)},modify:function(e,t){var n,r,a,i=t.mod,o=this.value,u=o.curr(),s=o.all(),c=e.mod;for(n=0,r=c.length;n<r;++n)u[a=c[n]._index]!==s&&i.push(a)},remove:function(e,t,n){var r,a,i,o,u=this._indices,s=this.value,c=s.curr(),l=s.prev(),f=s.all(),d={},h=n.rem,p=t.rem;for(r=0,a=p.length;r<a;++r)d[i=p[r]._index]=1,l[i]=o=c[i],c[i]=f,o!==f&&h.push(i);for(i in u)u[i].remove(a,d);return this.reindex(t,a,d),d},reindex:function(e,t,n){var r=this._indices,a=this.value;e.runAfter((function(){var e=a.remove(t,n);for(var i in r)r[i].reindex(e)}))},update:function(e,t,n){var r,a,i=this._dims,o=e.query,u=t.stamp,s=i.length,c=0;for(n.filters=0,a=0;a<s;++a)e.modified("query",a)&&(r=a,++c);if(1===c)c=i[r].one,this.incrementOne(i[r],o[r],n.add,n.rem);else for(a=0,c=0;a<s;++a)e.modified("query",a)&&(c|=i[a].one,this.incrementAll(i[a],o[a],u,n.add),n.rem=n.add);return c},incrementAll:function(e,t,n,r){var a,i,o,u=this.value,s=u.seen(),c=u.curr(),l=u.prev(),f=e.index(),d=e.bisect(e.range),h=e.bisect(t),p=h[0],v=h[1],g=d[0],m=d[1],y=e.one;if(p<g)for(a=p,i=Math.min(g,v);a<i;++a)s[o=f[a]]!==n&&(l[o]=c[o],s[o]=n,r.push(o)),c[o]^=y;else if(p>g)for(a=g,i=Math.min(p,m);a<i;++a)s[o=f[a]]!==n&&(l[o]=c[o],s[o]=n,r.push(o)),c[o]^=y;if(v>m)for(a=Math.max(p,m),i=v;a<i;++a)s[o=f[a]]!==n&&(l[o]=c[o],s[o]=n,r.push(o)),c[o]^=y;else if(v<m)for(a=Math.max(g,v),i=m;a<i;++a)s[o=f[a]]!==n&&(l[o]=c[o],s[o]=n,r.push(o)),c[o]^=y;e.range=t.slice()},incrementOne:function(e,t,n,r){var a,i,o,u=this.value.curr(),s=e.index(),c=e.bisect(e.range),l=e.bisect(t),f=l[0],d=l[1],h=c[0],p=c[1],v=e.one;if(f<h)for(a=f,i=Math.min(h,d);a<i;++a)u[o=s[a]]^=v,n.push(o);else if(f>h)for(a=h,i=Math.min(f,p);a<i;++a)u[o=s[a]]^=v,r.push(o);if(d>p)for(a=Math.max(f,p),i=d;a<i;++a)u[o=s[a]]^=v,n.push(o);else if(d<p)for(a=Math.max(h,d),i=p;a<i;++a)u[o=s[a]]^=v,r.push(o);e.range=t.slice()}}),fQ.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},ht(fQ,mu,{transform:function(e,t){var n=~(e.ignore||0),r=e.filter,a=r.mask;if(0===(a&n))return t.StopPropagation;var i=t.fork(t.ALL),o=r.data(),u=r.curr(),s=r.prev(),c=function(e){return u[e]&n?null:o[e]};return i.filter(i.MOD,c),a&a-1?(i.filter(i.ADD,(function(e){var t=u[e]&n;return!t&&t^s[e]&n?o[e]:null})),i.filter(i.REM,(function(e){var t=u[e]&n;return t&&!(t^t^s[e]&n)?o[e]:null}))):(i.filter(i.ADD,c),i.filter(i.REM,(function(e){return(u[e]&n)===a?o[e]:null}))),i.filter(i.SOURCE,(function(e){return c(e._index)}))}});var pQ=function(e){return function(t){return t[e]}},vQ=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function gQ(e){throw Error(e)}function mQ(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n),s+=e.substring(++n,++n),t=n;else if(r===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&c(),u=t=n+1):"]"===r&&(u||gQ("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&gQ("Access path missing closing bracket: "+e),o&&gQ("Access path missing closing quote: "+e),n>t&&(n++,c()),a}function yQ(e,t,n){var r=mQ(e);return e=1===r.length?r[0]:e,dQ((n&&n.get||hQ)(r),[e],t||e)}yQ("id");var bQ=dQ((function(e){return e}),[],"identity"),xQ=(dQ((function(){return 0}),[],"zero"),dQ((function(){return 1}),[],"one"),dQ((function(){return!0}),[],"true"));dQ((function(){return!1}),[],"false");var kQ=Array.isArray;function wQ(e){return e===Object(e)}function _Q(e){return e[e.length-1]}function CQ(e){return null==e||""===e?null:+e}var SQ=function(e){return function(t){return e*Math.exp(t)}},AQ=function(e){return function(t){return Math.log(e*t)}},EQ=function(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}},TQ=function(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}},NQ=function(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}};function DQ(e,t,n,r){var a=n(e[0]),i=n(_Q(e)),o=(i-a)*t;return[r(a-o),r(i-o)]}function FQ(e,t,n,r,a){var i=r(e[0]),o=r(_Q(e)),u=null!=t?r(t):(i+o)/2;return[a(u+(i-u)*n),a(u+(o-u)*n)]}function IQ(e){return null!=e?kQ(e)?e:[e]:[]}function MQ(e){return"function"===typeof e}function OQ(e){for(var t,n,r=1,a=arguments.length;r<a;++r)for(n in t=arguments[r])e[n]=t[n];return e}var RQ=Object.prototype.hasOwnProperty;function ZQ(e,t){return RQ.call(e,t)}function BQ(e){return"[object Date]"===Object.prototype.toString.call(e)}function zQ(e){return"number"===typeof e}function LQ(e){return"string"===typeof e}function PQ(e,t){for(var n="";--t>=0;)n+=e;return n}function jQ(e){return kQ(e)?"["+e.map(jQ)+"]":wQ(e)||LQ(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}var UQ=function(e){return zQ(e)||BQ(e)?e:Date.parse(e)};function WQ(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return t}var VQ,GQ,qQ,HQ,XQ,YQ="Literal",KQ="Property",$Q="ArrayExpression",QQ="BinaryExpression",JQ="CallExpression",eJ="ConditionalExpression",tJ="LogicalExpression",nJ="MemberExpression",rJ="ObjectExpression",aJ="UnaryExpression";function iJ(e){this.type=e}iJ.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(n=0,r=(t=function(e){switch(e.type){case $Q:return e.elements;case QQ:case tJ:return[e.left,e.right];case JQ:return[e.callee].concat(e.arguments);case eJ:return[e.test,e.consequent,e.alternate];case nJ:return[e.object,e.property];case rJ:return e.properties;case KQ:return[e.key,e.value];case aJ:return[e.argument];default:return[]}}(this)).length;n<r;++n)if(t[n].visit(e))return 1};(VQ={})[1]="Boolean",VQ[2]="<end>",VQ[3]="Identifier",VQ[4]="Keyword",VQ[5]="Null",VQ[6]="Numeric",VQ[7]="Punctuator",VQ[8]="String",VQ[9]="RegularExpression";var oJ="Identifier",uJ="Unexpected token %0",sJ="Invalid regular expression",cJ="Invalid regular expression: missing /",lJ="Octal literals are not allowed in strict mode.",fJ="ILLEGAL",dJ="Disabled.",hJ=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),pJ=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function vJ(e,t){if(!e)throw new Error("ASSERT: "+t)}function gJ(e){return e>=48&&e<=57}function mJ(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function yJ(e){return"01234567".indexOf(e)>=0}function bJ(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function xJ(e){return 10===e||13===e||8232===e||8233===e}function kJ(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&hJ.test(String.fromCharCode(e))}function wJ(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&pJ.test(String.fromCharCode(e))}var _J={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function CJ(){for(;qQ<HQ;){var e=GQ.charCodeAt(qQ);if(!bJ(e)&&!xJ(e))break;++qQ}}function SJ(e){var t,n,r,a=0;for(n="u"===e?4:2,t=0;t<n;++t)qQ<HQ&&mJ(GQ[qQ])?(r=GQ[qQ++],a=16*a+"0123456789abcdef".indexOf(r.toLowerCase())):jJ({},uJ,fJ);return String.fromCharCode(a)}function AJ(){var e,t,n,r;for(t=0,"}"===(e=GQ[qQ])&&jJ({},uJ,fJ);qQ<HQ&&mJ(e=GQ[qQ++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&jJ({},uJ,fJ),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function EJ(){var e,t;for(e=GQ.charCodeAt(qQ++),t=String.fromCharCode(e),92===e&&(117!==GQ.charCodeAt(qQ)&&jJ({},uJ,fJ),++qQ,(e=SJ("u"))&&"\\"!==e&&kJ(e.charCodeAt(0))||jJ({},uJ,fJ),t=e);qQ<HQ&&wJ(e=GQ.charCodeAt(qQ));)++qQ,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==GQ.charCodeAt(qQ)&&jJ({},uJ,fJ),++qQ,(e=SJ("u"))&&"\\"!==e&&wJ(e.charCodeAt(0))||jJ({},uJ,fJ),t+=e);return t}function TJ(){var e,t;return e=qQ,t=92===GQ.charCodeAt(qQ)?EJ():function(){var e,t;for(e=qQ++;qQ<HQ;){if(92===(t=GQ.charCodeAt(qQ)))return qQ=e,EJ();if(!wJ(t))break;++qQ}return GQ.slice(e,qQ)}(),{type:1===t.length?3:_J.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3,value:t,start:e,end:qQ}}function NJ(){var e,t,n,r,a=qQ,i=GQ.charCodeAt(qQ),o=GQ[qQ];switch(i){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++qQ,{type:7,value:String.fromCharCode(i),start:a,end:qQ};default:if(61===(e=GQ.charCodeAt(qQ+1)))switch(i){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return qQ+=2,{type:7,value:String.fromCharCode(i)+String.fromCharCode(e),start:a,end:qQ};case 33:case 61:return qQ+=2,61===GQ.charCodeAt(qQ)&&++qQ,{type:7,value:GQ.slice(a,qQ),start:a,end:qQ}}}return">>>="===(r=GQ.substr(qQ,4))?{type:7,value:r,start:a,end:qQ+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:a,end:qQ+=3}:o===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===t?{type:7,value:t,start:a,end:qQ+=2}:("//"===t&&jJ({},uJ,fJ),"<>=!+-*%&|^/".indexOf(o)>=0?{type:7,value:o,start:a,end:++qQ}:void jJ({},uJ,fJ))}function DJ(){var e,t,n;if(vJ(gJ((n=GQ[qQ]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=qQ,e="","."!==n){if(e=GQ[qQ++],n=GQ[qQ],"0"===e){if("x"===n||"X"===n)return++qQ,function(e){for(var t="";qQ<HQ&&mJ(GQ[qQ]);)t+=GQ[qQ++];return 0===t.length&&jJ({},uJ,fJ),kJ(GQ.charCodeAt(qQ))&&jJ({},uJ,fJ),{type:6,value:parseInt("0x"+t,16),start:e,end:qQ}}(t);if(yJ(n))return function(e){for(var t="0"+GQ[qQ++];qQ<HQ&&yJ(GQ[qQ]);)t+=GQ[qQ++];return(kJ(GQ.charCodeAt(qQ))||gJ(GQ.charCodeAt(qQ)))&&jJ({},uJ,fJ),{type:6,value:parseInt(t,8),octal:!0,start:e,end:qQ}}(t);n&&gJ(n.charCodeAt(0))&&jJ({},uJ,fJ)}for(;gJ(GQ.charCodeAt(qQ));)e+=GQ[qQ++];n=GQ[qQ]}if("."===n){for(e+=GQ[qQ++];gJ(GQ.charCodeAt(qQ));)e+=GQ[qQ++];n=GQ[qQ]}if("e"===n||"E"===n)if(e+=GQ[qQ++],"+"!==(n=GQ[qQ])&&"-"!==n||(e+=GQ[qQ++]),gJ(GQ.charCodeAt(qQ)))for(;gJ(GQ.charCodeAt(qQ));)e+=GQ[qQ++];else jJ({},uJ,fJ);return kJ(GQ.charCodeAt(qQ))&&jJ({},uJ,fJ),{type:6,value:parseFloat(e),start:t,end:qQ}}function FJ(){var e,t,n,r;return XQ=null,CJ(),e=qQ,t=function(){var e,t,n,r;for(vJ("/"===(e=GQ[qQ]),"Regular expression literal must start with a slash"),t=GQ[qQ++],n=!1,r=!1;qQ<HQ;)if(t+=e=GQ[qQ++],"\\"===e)xJ((e=GQ[qQ++]).charCodeAt(0))&&jJ({},cJ),t+=e;else if(xJ(e.charCodeAt(0)))jJ({},cJ);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||jJ({},cJ),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";qQ<HQ&&wJ((e=GQ[qQ]).charCodeAt(0));)++qQ,"\\"===e&&qQ<HQ?jJ({},uJ,fJ):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&jJ({},sJ,n),{value:n,literal:t}}(),r=function(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111)return"x";jJ({},sJ)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){jJ({},sJ)}try{return new RegExp(e,t)}catch(a){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:qQ}}function IJ(){if(CJ(),qQ>=HQ)return{type:2,start:qQ,end:qQ};var e=GQ.charCodeAt(qQ);return kJ(e)?TJ():40===e||41===e||59===e?NJ():39===e||34===e?function(){var e,t,n,r,a="",i=!1;for(vJ("'"===(e=GQ[qQ])||'"'===e,"String literal must starts with a quote"),t=qQ,++qQ;qQ<HQ;){if((n=GQ[qQ++])===e){e="";break}if("\\"===n)if((n=GQ[qQ++])&&xJ(n.charCodeAt(0)))"\r"===n&&"\n"===GQ[qQ]&&++qQ;else switch(n){case"u":case"x":"{"===GQ[qQ]?(++qQ,a+=AJ()):a+=SJ(n);break;case"n":a+="\n";break;case"r":a+="\r";break;case"t":a+="\t";break;case"b":a+="\b";break;case"f":a+="\f";break;case"v":a+="\v";break;default:yJ(n)?(0!==(r="01234567".indexOf(n))&&(i=!0),qQ<HQ&&yJ(GQ[qQ])&&(i=!0,r=8*r+"01234567".indexOf(GQ[qQ++]),"0123".indexOf(n)>=0&&qQ<HQ&&yJ(GQ[qQ])&&(r=8*r+"01234567".indexOf(GQ[qQ++]))),a+=String.fromCharCode(r)):a+=n}else{if(xJ(n.charCodeAt(0)))break;a+=n}}return""!==e&&jJ({},uJ,fJ),{type:8,value:a,octal:i,start:t,end:qQ}}():46===e?gJ(GQ.charCodeAt(qQ+1))?DJ():NJ():gJ(e)?DJ():NJ()}function MJ(){var e=XQ;return qQ=e.end,XQ=IJ(),qQ=e.end,e}function OJ(){var e=qQ;XQ=IJ(),qQ=e}function RJ(e,t,n){var r=new iJ("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return r.operator=e,r.left=t,r.right=n,r}function ZJ(e,t){var n=new iJ("CallExpression");return n.callee=e,n.arguments=t,n}function BJ(e){var t=new iJ(oJ);return t.name=e,t}function zJ(e){var t=new iJ("Literal");return t.value=e.value,t.raw=GQ.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function LJ(e,t,n){var r=new iJ("MemberExpression");return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function PJ(e,t,n){var r=new iJ("Property");return r.key=t,r.value=n,r.kind=e,r}function jJ(e,t){var n,r=Array.prototype.slice.call(arguments,2),a=t.replace(/%(\d)/g,(function(e,t){return vJ(t<r.length,"Message reference must be in range"),r[t]}));throw(n=new Error(a)).index=qQ,n.description=a,n}function UJ(e){2===e.type&&jJ(e,"Unexpected end of input"),6===e.type&&jJ(e,"Unexpected number"),8===e.type&&jJ(e,"Unexpected string"),3===e.type&&jJ(e,"Unexpected identifier"),4===e.type&&jJ(e,"Unexpected reserved word"),jJ(e,uJ,e.value)}function WJ(e){var t=MJ();7===t.type&&t.value===e||UJ(t)}function VJ(e){return 7===XQ.type&&XQ.value===e}function GJ(e){return 4===XQ.type&&XQ.value===e}function qJ(){var e=[];for(qQ=XQ.start,WJ("[");!VJ("]");)VJ(",")?(MJ(),e.push(null)):(e.push(a0()),VJ("]")||WJ(","));return MJ(),function(e){var t=new iJ("ArrayExpression");return t.elements=e,t}(e)}function HJ(){qQ=XQ.start;var e=MJ();return 8===e.type||6===e.type?(e.octal&&jJ(e,lJ),zJ(e)):BJ(e.value)}function XJ(){var e,t,n;return qQ=XQ.start,3===(e=XQ).type?(n=HJ(),WJ(":"),PJ("init",n,a0())):2!==e.type&&7!==e.type?(t=HJ(),WJ(":"),PJ("init",t,a0())):void UJ(e)}function YJ(){var e,t,n=[],r={},a=String;for(qQ=XQ.start,WJ("{");!VJ("}");)t="$"+((e=XJ()).key.type===oJ?e.key.name:a(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?jJ({},"Duplicate data property in object literal not allowed in strict mode"):r[t]=!0,n.push(e),VJ("}")||WJ(",");return WJ("}"),function(e){var t=new iJ("ObjectExpression");return t.properties=e,t}(n)}var KJ={if:1};function $J(){var e,t,n;if(VJ("("))return function(){WJ("(");var e=i0();return WJ(")"),e}();if(VJ("["))return qJ();if(VJ("{"))return YJ();if(e=XQ.type,qQ=XQ.start,3===e||KJ[XQ.value])n=BJ(MJ().value);else if(8===e||6===e)XQ.octal&&jJ(XQ,lJ),n=zJ(MJ());else{if(4===e)throw new Error(dJ);1===e?((t=MJ()).value="true"===t.value,n=zJ(t)):5===e?((t=MJ()).value=null,n=zJ(t)):VJ("/")||VJ("/=")?(n=zJ(FJ()),OJ()):UJ(MJ())}return n}function QJ(){var e=[];if(WJ("("),!VJ(")"))for(;qQ<HQ&&(e.push(a0()),!VJ(")"));)WJ(",");return WJ(")"),e}function JJ(){return WJ("."),function(){qQ=XQ.start;var e=MJ();return function(e){return 3===e.type||4===e.type||1===e.type||5===e.type}(e)||UJ(e),BJ(e.value)}()}function e0(){WJ("[");var e=i0();return WJ("]"),e}function t0(){var e=function(){var e;for(e=$J();;)if(VJ("."))e=LJ(".",e,JJ());else if(VJ("("))e=ZJ(e,QJ());else{if(!VJ("["))break;e=LJ("[",e,e0())}return e}();if(7===XQ.type&&(VJ("++")||VJ("--")))throw new Error(dJ);return e}function n0(){var e,t;if(7!==XQ.type&&4!==XQ.type)t=t0();else{if(VJ("++")||VJ("--"))throw new Error(dJ);if(VJ("+")||VJ("-")||VJ("~")||VJ("!"))e=MJ(),t=n0(),t=function(e,t){var n=new iJ("UnaryExpression");return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(GJ("delete")||GJ("void")||GJ("typeof"))throw new Error(dJ);t=t0()}}return t}function r0(e){var t=0;if(7!==e.type&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function a0(){var e,t;return e=function(){var e,t,n,r,a,i,o,u,s,c;if(e=XQ,s=n0(),0===(a=r0(r=XQ)))return s;for(r.prec=a,MJ(),t=[e,XQ],i=[s,r,o=n0()];(a=r0(XQ))>0;){for(;i.length>2&&a<=i[i.length-2].prec;)o=i.pop(),u=i.pop().value,s=i.pop(),t.pop(),n=RJ(u,s,o),i.push(n);(r=MJ()).prec=a,i.push(r),t.push(XQ),n=n0(),i.push(n)}for(n=i[c=i.length-1],t.pop();c>1;)t.pop(),n=RJ(i[c-1].value,i[c-2],n),c-=2;return n}(),VJ("?")&&(MJ(),t=a0(),WJ(":"),e=function(e,t,n){var r=new iJ("ConditionalExpression");return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,a0())),e}function i0(){var e=a0();if(VJ(","))throw new Error(dJ);return e}var o0={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function u0(e){function t(t,n,r){return function(a){return function(t,n,r,a){var i=e(n[0]);return r&&(i=r+"("+i+")",0===r.lastIndexOf("new ",0)&&(i="("+i+")")),i+"."+t+(a<0?"":0===a?"()":"("+n.slice(1).map(e).join(",")+")")}(t,a,n,r)}}var n="new Date",r="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&gQ("Missing arguments to clamp function."),t.length>3&&gQ("Too many arguments to clamp function.");var n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:t("getDate",n,0),day:t("getDay",n,0),year:t("getFullYear",n,0),month:t("getMonth",n,0),hours:t("getHours",n,0),minutes:t("getMinutes",n,0),seconds:t("getSeconds",n,0),milliseconds:t("getMilliseconds",n,0),time:t("getTime",n,0),timezoneoffset:t("getTimezoneOffset",n,0),utcdate:t("getUTCDate",n,0),utcday:t("getUTCDay",n,0),utcyear:t("getUTCFullYear",n,0),utcmonth:t("getUTCMonth",n,0),utchours:t("getUTCHours",n,0),utcminutes:t("getUTCMinutes",n,0),utcseconds:t("getUTCSeconds",n,0),utcmilliseconds:t("getUTCMilliseconds",n,0),length:t("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",r,0),lower:t("toLowerCase",r,0),substring:t("substring",r),split:t("split",r),trim:t("trim",r,0),regexp:a,test:t("test",a),if:function(t){t.length<3&&gQ("Missing arguments to if function."),t.length>3&&gQ("Too many arguments to if function.");var n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}var s0,c0,l0,f0,d0,h0,p0,v0,g0,m0,y0,b0,x0,k0,w0,_0,C0=new SM,S0=new SM,A0={point:YM,lineStart:YM,lineEnd:YM,polygonStart:function(){C0=new SM,A0.lineStart=E0,A0.lineEnd=T0},polygonEnd:function(){var e=+C0;S0.add(e<0?FM+e:e),this.lineStart=this.lineEnd=this.point=YM},sphere:function(){S0.add(FM)}};function E0(){A0.point=N0}function T0(){D0(s0,c0)}function N0(e,t){A0.point=D0,s0=e,c0=t,l0=e*=MM,f0=BM(t=(t*=MM)/2+DM),d0=WM(t)}function D0(e,t){var n=(e*=MM)-l0,r=n>=0?1:-1,a=r*n,i=BM(t=(t*=MM)/2+DM),o=WM(t),u=d0*o,s=f0*i+u*BM(a),c=u*r*WM(a);C0.add(ZM(c,s)),l0=e,f0=i,d0=o}var F0,I0,M0,O0,R0,Z0,B0,z0,L0,P0,j0,U0,W0,V0,G0,q0,H0={point:X0,lineStart:K0,lineEnd:$0,polygonStart:function(){H0.point=Q0,H0.lineStart=J0,H0.lineEnd=e1,k0=new SM,A0.polygonStart()},polygonEnd:function(){A0.polygonEnd(),H0.point=X0,H0.lineStart=K0,H0.lineEnd=$0,C0<0?(h0=-(v0=180),p0=-(g0=90)):k0>AM?g0=90:k0<-1e-6&&(p0=-90),_0[0]=h0,_0[1]=v0},sphere:function(){h0=-(v0=180),p0=-(g0=90)}};function X0(e,t){w0.push(_0=[h0=e,v0=e]),t<p0&&(p0=t),t>g0&&(g0=t)}function Y0(e,t){var n=aR([e*MM,t*MM]);if(x0){var r=oR(x0,n),a=oR([r[1],-r[0],0],r);cR(a),a=rR(a);var i,o=e-m0,u=o>0?1:-1,s=a[0]*IM*u,c=OM(o)>180;c^(u*m0<s&&s<u*e)?(i=a[1]*IM)>g0&&(g0=i):c^(u*m0<(s=(s+360)%360-180)&&s<u*e)?(i=-a[1]*IM)<p0&&(p0=i):(t<p0&&(p0=t),t>g0&&(g0=t)),c?e<m0?t1(h0,e)>t1(h0,v0)&&(v0=e):t1(e,v0)>t1(h0,v0)&&(h0=e):v0>=h0?(e<h0&&(h0=e),e>v0&&(v0=e)):e>m0?t1(h0,e)>t1(h0,v0)&&(v0=e):t1(e,v0)>t1(h0,v0)&&(h0=e)}else w0.push(_0=[h0=e,v0=e]);t<p0&&(p0=t),t>g0&&(g0=t),x0=n,m0=e}function K0(){H0.point=Y0}function $0(){_0[0]=h0,_0[1]=v0,H0.point=X0,x0=null}function Q0(e,t){if(x0){var n=e-m0;k0.add(OM(n)>180?n+(n>0?360:-360):n)}else y0=e,b0=t;A0.point(e,t),Y0(e,t)}function J0(){A0.lineStart()}function e1(){Q0(y0,b0),A0.lineEnd(),OM(k0)>AM&&(h0=-(v0=180)),_0[0]=h0,_0[1]=v0,x0=null}function t1(e,t){return(t-=e)<0?t+360:t}function n1(e,t){return e[0]-t[0]}function r1(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var a1={sphere:YM,point:i1,lineStart:u1,lineEnd:l1,polygonStart:function(){a1.lineStart=f1,a1.lineEnd=d1},polygonEnd:function(){a1.lineStart=u1,a1.lineEnd=l1}};function i1(e,t){e*=MM;var n=BM(t*=MM);o1(n*BM(e),n*WM(e),WM(t))}function o1(e,t,n){++F0,M0+=(e-M0)/F0,O0+=(t-O0)/F0,R0+=(n-R0)/F0}function u1(){a1.point=s1}function s1(e,t){e*=MM;var n=BM(t*=MM);V0=n*BM(e),G0=n*WM(e),q0=WM(t),a1.point=c1,o1(V0,G0,q0)}function c1(e,t){e*=MM;var n=BM(t*=MM),r=n*BM(e),a=n*WM(e),i=WM(t),o=ZM(GM((o=G0*i-q0*a)*o+(o=q0*r-V0*i)*o+(o=V0*a-G0*r)*o),V0*r+G0*a+q0*i);I0+=o,Z0+=o*(V0+(V0=r)),B0+=o*(G0+(G0=a)),z0+=o*(q0+(q0=i)),o1(V0,G0,q0)}function l1(){a1.point=i1}function f1(){a1.point=h1}function d1(){p1(U0,W0),a1.point=i1}function h1(e,t){U0=e,W0=t,e*=MM,t*=MM,a1.point=p1;var n=BM(t);V0=n*BM(e),G0=n*WM(e),q0=WM(t),o1(V0,G0,q0)}function p1(e,t){e*=MM;var n=BM(t*=MM),r=n*BM(e),a=n*WM(e),i=WM(t),o=G0*i-q0*a,u=q0*r-V0*i,s=V0*a-G0*r,c=PM(o,u,s),l=XM(c),f=c&&-l/c;L0.add(f*o),P0.add(f*u),j0.add(f*s),I0+=l,Z0+=l*(V0+(V0=r)),B0+=l*(G0+(G0=a)),z0+=l*(q0+(q0=i)),o1(V0,G0,q0)}function v1(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function g1(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function m1(){return 0}function y1(e){return e instanceof Ix?e:new Ix(e)}function b1(e,t,n){return e.fields=t||[],e.fname=n,e}function x1(e){return 1===e.length?k1(e[0]):w1(e)}var k1=function(e){return function(t){return t[e]}},w1=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function _1(e){throw Error(e)}function C1(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n),s+=e.substring(++n,++n),t=n;else if(r===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&c(),u=t=n+1):"]"===r&&(u||_1("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&_1("Access path missing closing bracket: "+e),o&&_1("Access path missing closing quote: "+e),n>t&&(n++,c()),a}function S1(e,t,n){var r=C1(e);return e=1===r.length?r[0]:e,b1((n&&n.get||x1)(r),[e],t||e)}S1("id"),b1((function(e){return e}),[],"identity"),b1((function(){return 0}),[],"zero"),b1((function(){return 1}),[],"one"),b1((function(){return!0}),[],"true"),b1((function(){return!1}),[],"false");var A1=Array.isArray;function E1(e){return e[e.length-1]}function T1(e){return null==e||""===e?null:+e}function N1(e){return null!=e?A1(e)?e:[e]:[]}function D1(e){for(var t,n,r=1,a=arguments.length;r<a;++r)for(n in t=arguments[r])e[n]=t[n];return e}var F1=Object.prototype.hasOwnProperty;function I1(e,t){return F1.call(e,t)}function M1(e,t,n,r){var a,i=t[0],o=t[t.length-1];return i>o&&(a=i,i=o,o=a),r=void 0===r||r,((n=void 0===n||n)?i<=e:i<e)&&(r?e<=o:e<o)}function O1(e){return"[object Date]"===Object.prototype.toString.call(e)}var R1,Z1="Literal",B1="Property",z1="ArrayExpression",L1="BinaryExpression",P1="CallExpression",j1="ConditionalExpression",U1="LogicalExpression",W1="MemberExpression",V1="ObjectExpression",G1="UnaryExpression";function q1(e){this.type=e}q1.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(n=0,r=(t=function(e){switch(e.type){case z1:return e.elements;case L1:case U1:return[e.left,e.right];case P1:return[e.callee].concat(e.arguments);case j1:return[e.test,e.consequent,e.alternate];case W1:return[e.object,e.property];case V1:return e.properties;case B1:return[e.key,e.value];case G1:return[e.argument];default:return[]}}(this)).length;n<r;++n)if(t[n].visit(e))return 1};(R1={})[1]="Boolean",R1[2]="<end>",R1[3]="Identifier",R1[4]="Keyword",R1[5]="Null",R1[6]="Numeric",R1[7]="Punctuator",R1[8]="String",R1[9]="RegularExpression";var H1;var X1="intersect",Y1="union",K1="_vgsid_",$1=S1(K1),Q1="index:unit";function J1(e,t){for(var n,r,a=t.fields,i=t.values,o=a.length,u=0;u<o;++u)if((r=a[u]).getter=S1.getter||S1(r.field),O1(n=r.getter(e))&&(n=T1(n)),O1(i[u])&&(i[u]=T1(i[u])),O1(i[u][0])&&(i[u]=i[u].map(T1)),"E"===r.type){if(A1(i[u])?i[u].indexOf(n)<0:n!==i[u])return!1}else if("R"===r.type){if(!M1(n,i[u]))return!1}else if("R-RE"===r.type){if(!M1(n,i[u],!0,!1))return!1}else if("R-E"===r.type){if(!M1(n,i[u],!1,!1))return!1}else if("R-LE"===r.type&&!M1(n,i[u],!1,!0))return!1;return!0}var e2=function(e){var t,n,r;function a(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<i){if(0!==t(r,r))return i;do{var o=a+i>>>1;n(e[o],r)<0?a=o+1:i=o}while(a<i)}return a}return 2!==e.length?(t=v1,n=function(t,n){return v1(e(t),n)},r=function(t,n){return e(t)-n}):(t=e===v1||e===g1?e:m1,n=e,r=e),{left:a,center:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,o=a(e,t,n,i-1);return o>n&&r(e[o-1],t)>-r(e[o],t)?o-1:o},right:function(e,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(a<i){if(0!==t(r,r))return i;do{var o=a+i>>>1;n(e[o],r)<=0?a=o+1:i=o}while(a<i)}return a}}}($1),t2=e2.left,n2=e2.right;var r2=(H1={},(0,qn.Z)(H1,"".concat(K1,"_union"),(function(){for(var e=new Ix,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o,u=i[a],s=(0,Zt.Z)(u);try{for(s.s();!(o=s.n()).done;){var c=o.value;e.add(c)}}catch(l){s.e(l)}finally{s.f()}}return e})),(0,qn.Z)(H1,"".concat(K1,"_intersect"),(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e=new Ix(e),n=n.map(y1);var a,i=(0,Zt.Z)(e);try{e:for(i.s();!(a=i.n()).done;){var o,u=a.value,s=(0,Zt.Z)(n);try{for(s.s();!(o=s.n()).done;){var c=o.value;if(!c.has(u)){e.delete(u);continue e}}}catch(l){s.e(l)}finally{s.f()}}}catch(l){i.e(l)}finally{i.f()}return e})),(0,qn.Z)(H1,"E_union",(function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e})),(0,qn.Z)(H1,"E_intersect",(function(e,t){return e.length?e.filter((function(e){return t.indexOf(e)>=0})):t})),(0,qn.Z)(H1,"R_union",(function(e,t){var n=T1(t[0]),r=T1(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]})),(0,qn.Z)(H1,"R_intersect",(function(e,t){var n=T1(t[0]),r=T1(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]})),H1);function a2(e,t,n,r){t[0].type!==Z1&&_1("First argument to selection functions must be a string literal.");var a=t[0].value,i="unit",o="@"+i,u=":"+a;(t.length>=2&&E1(t).value)!==X1||I1(r,o)||(r[o]=n.getData(a).indataRef(n,i)),I1(r,u)||(r[u]=n.getData(a).tuplesRef())}function i2(e){var t=this.context.data[e];return t?t.values.value:[]}var o2=function(e){return function(t,n){return this.context.dataflow.locale()[e](n)(t)}},u2=o2("format"),s2=o2("timeFormat"),c2=o2("utcFormat"),l2=o2("timeParse"),f2=o2("utcParse"),d2=new Date(2e3,0,1);function h2(e,t,n){return Number.isInteger(e)&&Number.isInteger(t)?(d2.setYear(2e3),d2.setMonth(e),d2.setDate(t),s2.call(this,d2,n)):""}function p2(e,t,n,r){t[0].type!==YQ&&gQ("First argument to data functions must be a string literal.");var a=t[0].value,i=":"+a;if(!ZQ(i,r))try{r[i]=n.getData(a).tuplesRef()}catch(o){}}function v2(e,t,n,r){if(t[0].type===YQ)g2(n,r,t[0].value);else for(e in n.scales)g2(n,r,e)}function g2(e,t,n){var r="%"+n;if(!ZQ(t,r))try{t[r]=e.scaleRef(n)}catch(a){}}function m2(e,t){var n;return MQ(e)?e:LQ(e)?(n=t.scales[e])&&n.value:void 0}function y2(e,t,n){t.__bandwidth=function(e){return e&&e.bandwidth?e.bandwidth():0},n._bandwidth=v2,n._range=v2,n._scale=v2;var r=function(t){return"_["+(t.type===YQ?jQ("%"+t.value):jQ("%")+"+"+e(t))+"]"};return{_bandwidth:function(e){return"this.__bandwidth(".concat(r(e[0]),")")},_range:function(e){return"".concat(r(e[0]),".range()")},_scale:function(t){return"".concat(r(t[0]),"(").concat(e(t[1]),")")}}}function b2(e,t){return function(n,r,a){if(n){var i=m2(n,(a||this).context);return i&&i.path[e](r)}return t(r)}}var x2=b2("area",(function(e){return S0=new SM,CM(e,A0),2*S0})),k2=b2("bounds",(function(e){var t,n,r,a,i,o,u;if(g0=v0=-(h0=p0=1/0),w0=[],CM(e,H0),n=w0.length){for(w0.sort(n1),t=1,i=[r=w0[0]];t<n;++t)r1(r,(a=w0[t])[0])||r1(r,a[1])?(t1(r[0],a[1])>t1(r[0],r[1])&&(r[1]=a[1]),t1(a[0],r[1])>t1(r[0],r[1])&&(r[0]=a[0])):i.push(r=a);for(o=-1/0,t=0,r=i[n=i.length-1];t<=n;r=a,++t)a=i[t],(u=t1(r[1],a[0]))>o&&(o=u,h0=a[0],v0=r[1])}return w0=_0=null,h0===1/0||p0===1/0?[[NaN,NaN],[NaN,NaN]]:[[h0,p0],[v0,g0]]})),w2=b2("centroid",(function(e){F0=I0=M0=O0=R0=Z0=B0=z0=0,L0=new SM,P0=new SM,j0=new SM,CM(e,a1);var t=+L0,n=+P0,r=+j0,a=PM(t,n,r);return a<EM&&(t=Z0,n=B0,r=z0,I0<AM&&(t=M0,n=O0,r=R0),(a=PM(t,n,r))<EM)?[NaN,NaN]:[ZM(n,t)*IM,XM(r/a)*IM]}));function _2(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(r){e.warn(r)}return n[n.length-1]}function C2(e){var t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function S2(e){var t=Ky(e);return.2126*C2(t.r)+.7152*C2(t.g)+.0722*C2(t.b)}function A2(e,t){return e===t||e!==e&&t!==t||(kQ(e)?!(!kQ(t)||e.length!==t.length)&&function(e,t){for(var n=0,r=e.length;n<r;++n)if(!A2(e[n],t[n]))return!1;return!0}(e,t):!(!wQ(e)||!wQ(t))&&E2(e,t))}function E2(e,t){for(var n in e)if(!A2(e[n],t[n]))return!1;return!0}function T2(e){return function(t){return E2(e,t)}}var N2={};function D2(e){return kQ(e)||ArrayBuffer.isView(e)?e:null}function F2(e){return D2(e)||(LQ(e)?e:null)}var I2=function(e){return e.data};function M2(e,t){var n=i2.call(t,e);return n.root&&n.root.lookup||{}}var O2=function(){return"undefined"!==typeof window&&window||null};var R2={random:function(){return Pu()},cumulativeNormal:$u,cumulativeLogNormal:rs,cumulativeUniform:cs,densityNormal:Ku,densityLogNormal:ns,densityUniform:ss,quantileNormal:Qu,quantileLogNormal:as,quantileUniform:ls,sampleNormal:Yu,sampleLogNormal:ts,sampleUniform:us,isArray:kQ,isBoolean:function(e){return"boolean"===typeof e},isDate:BQ,isDefined:function(e){return void 0!==e},isNumber:zQ,isObject:wQ,isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},isString:LQ,isTuple:Io,isValid:function(e){return null!=e&&e===e},toBoolean:function(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e)&&!!e},toDate:function(e,t){return t=t||UQ,null==e||""===e?null:t(e)},toNumber:CQ,toString:function(e){return null==e||""===e?null:e+""},indexof:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=F2(e)).indexOf.apply(t,r)},join:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=D2(e)).join.apply(t,r)},lastindexof:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=F2(e)).lastIndexOf.apply(t,r)},replace:function(e,t,n){return MQ(n)&&gQ("Function argument passed to replace."),String(e).replace(t,n)},reverse:function(e){return D2(e).slice().reverse()},slice:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=F2(e)).slice.apply(t,r)},flush:function(e,t,n,r,a,i){if(!n&&0!==n)return i;var o,u=+n,s=e[0],c=_Q(e);c<s&&(o=s,s=c,c=o),o=Math.abs(t-s);var l=Math.abs(c-t);return o<l&&o<=u?r:l<=u?a:i},lerp:function(e,t){var n=e[0],r=_Q(e),a=+t;return a?1===a?r:n+a*(r-n):n},merge:function(){var e=[].slice.call(arguments);return e.unshift({}),OQ.apply(void 0,(0,ln.Z)(e))},pad:function(e,t,n,r){var a=n||" ",i=e+"",o=t-i.length;return o<=0?i:"left"===r?PQ(a,o)+i:"center"===r?PQ(a,~~(o/2))+i+PQ(a,Math.ceil(o/2)):i+PQ(a,o)},peek:_Q,pluck:function(e,t){var n=N2[t]||(N2[t]=yQ(t));return kQ(e)?e.map(n):n(e)},span:function(e){return e&&_Q(e)-e[0]||0},inrange:function(e,t,n,r){var a,i=t[0],o=t[t.length-1];return i>o&&(a=i,i=o,o=a),r=void 0===r||r,((n=void 0===n||n)?i<=e:i<e)&&(r?e<=o:e<o)},truncate:function(e,t,n,r){var a=null!=r?r:"\u2026",i=e+"",o=i.length,u=Math.max(0,t-a.length);return o<=t?i:"left"===n?a+i.slice(o-u):"center"===n?i.slice(0,Math.ceil(u/2))+a+i.slice(o-~~(u/2)):i.slice(0,u)+a},rgb:Ky,lab:uk,hcl:pk,hsl:rb,luminance:S2,contrast:function(e,t){var n=S2(e),r=S2(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:Ns,format:u2,utcFormat:c2,utcParse:f2,utcOffset:Dl,utcSequence:Ml,timeFormat:s2,timeParse:l2,timeOffset:Nl,timeSequence:Il,timeUnitSpecifier:tl,monthFormat:function(e){return h2.call(this,e,1,"%B")},monthAbbrevFormat:function(e){return h2.call(this,e,1,"%b")},dayFormat:function(e){return h2.call(this,0,2+e,"%A")},dayAbbrevFormat:function(e){return h2.call(this,0,2+e,"%a")},quarter:function(e){return 1+~~(new Date(e).getMonth()/3)},utcquarter:function(e){return 1+~~(new Date(e).getUTCMonth()/3)},week:il,utcweek:fl,dayofyear:al,utcdayofyear:ll,warn:function(){return _2(this.context.dataflow,"warn",arguments)},info:function(){return _2(this.context.dataflow,"info",arguments)},debug:function(){return _2(this.context.dataflow,"debug",arguments)},extent:function(e,t){var n,r,a,i,o=0;if(e&&(n=e.length))if(null==t){for(r=e[o];o<n&&(null==r||r!==r);r=e[++o]);for(a=i=r;o<n;++o)null!=(r=e[o])&&(r<a&&(a=r),r>i&&(i=r))}else{for(r=t(e[o]);o<n&&(null==r||r!==r);r=t(e[++o]));for(a=i=r;o<n;++o)null!=(r=t(e[o]))&&(r<a&&(a=r),r>i&&(i=r))}return[a,i]},inScope:function(e){var t=this.context.group,n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n},intersect:function(e,t,n){if(!e)return[];var r=(0,ku.Z)(e,2),a=r[0],i=r[1],o=(new KU).set(a[0],a[1],i[0],i[1]);return Cq(n||this.context.dataflow.scenegraph().root,o,function(e){var t=null;if(e){var n=IQ(e.marktype),r=IQ(e.markname);t=function(e){return(!n.length||n.some((function(t){return e.marktype===t})))&&(!r.length||r.some((function(t){return e.name===t})))}}return t}(t))},clampRange:function(e,t,n){var r,a=e[0],i=e[1];return i<a&&(r=i,i=a,a=r),(r=i-a)>=n-t?[t,n]:[a=Math.min(Math.max(a,t),n-r),a+r]},pinchDistance:function(e){var t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)},pinchAngle:function(e){var t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)},screen:function(){var e=O2();return e?e.screen:{}},containerSize:function(){var e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]},windowSize:function(){var e=O2();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]},bandspace:function(e,t,n){return EF(e||0,t||0,n||0)},setdata:function(e,t){var n=this.context.dataflow,r=this.context.data[e].input;return n.pulse(r,n.changeset().remove(xQ).insert(t)),1},pathShape:function(e){var t=null;return function(n){return n?bU(n,t=t||sU(e)):e}},panLinear:function(e,t){return DQ(e,t,CQ,bQ)},panLog:function(e,t){var n=Math.sign(e[0]);return DQ(e,t,AQ(n),SQ(n))},panPow:function(e,t,n){return DQ(e,t,NQ(n),NQ(1/n))},panSymlog:function(e,t,n){return DQ(e,t,EQ(n),TQ(n))},zoomLinear:function(e,t,n){return FQ(e,t,n,CQ,bQ)},zoomLog:function(e,t,n){var r=Math.sign(e[0]);return FQ(e,t,n,AQ(r),SQ(r))},zoomPow:function(e,t,n,r){return FQ(e,t,n,NQ(r),NQ(1/r))},zoomSymlog:function(e,t,n,r){return FQ(e,t,n,EQ(r),TQ(r))},encode:function(e,t,n){if(e){var r=this.context.dataflow,a=e.mark.source;r.pulse(a,r.changeset().encode(e,t))}return void 0!==n?n:e},modify:function(e,t,n,r,a,i){var o,u,s=this.context.dataflow,c=this.context.data[e],l=c.input,f=s.stamp(),d=c.changes;if(!1===s._trigger||!(l.value.length||t||r))return 0;if((!d||d.stamp<f)&&(c.changes=d=s.changeset(),d.stamp=f,s.runAfter((function(){c.modified=!0,s.pulse(l,d).run()}),!0,1)),n&&(o=!0===n?xQ:kQ(n)||Io(n)?n:T2(n),d.remove(o)),t&&d.insert(t),r&&(o=T2(r),l.value.some(o)?d.remove(o):d.insert(r)),a)for(u in i)d.modify(a,u,i[u]);return 1}},Z2=["view","item","group","xy","x","y"],B2="this.",z2={},L2={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:function(e){return"_[".concat(jQ("$"+e),"]")},functions:function(e){var t=u0(e);for(var n in Z2.forEach((function(e){return t[e]="event.vega."+e})),R2)t[n]=B2+n;return OQ(t,y2(e,R2,z2)),t},constants:o0,visitors:z2},P2=function(e){var t=(e=e||{}).allowed?WQ(e.allowed):{},n=e.forbidden?WQ(e.forbidden):{},r=e.constants||o0,a=(e.functions||u0)(f),i=e.globalvar,o=e.fieldvar,u=MQ(i)?i:function(e){return"".concat(i,'["').concat(e,'"]')},s={},c={},l=0;function f(e){if(LQ(e))return e;var t=d[e.type];return null==t&&gQ("Unsupported type: "+e.type),t(e)}var d={Literal:function(e){return e.raw},Identifier:function(e){var a=e.name;return l>0?a:ZQ(n,a)?gQ("Illegal identifier: "+a):ZQ(r,a)?r[a]:ZQ(t,a)?a:(s[a]=1,u(a))},MemberExpression:function(e){var t=!e.computed,n=f(e.object);t&&(l+=1);var r=f(e.property);return n===o&&(c[function(e){var t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(r)]=1),t&&(l-=1),n+(t?"."+r:"["+r+"]")},CallExpression:function(e){"Identifier"!==e.callee.type&&gQ("Illegal callee type: "+e.callee.type);var t=e.callee.name,n=e.arguments,r=ZQ(a,t)&&a[t];return r||gQ("Unrecognized function: "+t),MQ(r)?r(n):r+"("+n.map(f).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(f).join(",")+"]"},BinaryExpression:function(e){return"("+f(e.left)+" "+e.operator+" "+f(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+f(e.argument)+")"},ConditionalExpression:function(e){return"("+f(e.test)+"?"+f(e.consequent)+":"+f(e.alternate)+")"},LogicalExpression:function(e){return"("+f(e.left)+e.operator+f(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(f).join(",")+"}"},Property:function(e){l+=1;var t=f(e.key);return l-=1,t+":"+f(e.value)}};function h(e){var t={code:f(e),globals:Object.keys(s),fields:Object.keys(c)};return s={},c={},t}return h.functions=a,h.constants=r,h}(L2);function j2(e,t,n){return 1===arguments.length?R2[e]:(R2[e]=t,n&&(z2[e]=n),P2&&(P2.functions[e]=B2+e),this)}function U2(e,t){var n,r={};try{n=function(e){qQ=0,HQ=(GQ=e).length,XQ=null,OJ();var t=i0();if(2!==XQ.type)throw new Error("Unexpect token after expression.");return t}(e=LQ(e)?e:jQ(e)+"")}catch(i){gQ("Expression parse error: "+e)}n.visit((function(e){if(e.type===JQ){var n=e.callee.name,a=L2.visitors[n];a&&a(n,e.arguments,t,r)}}));var a=P2(n);return a.globals.forEach((function(e){var n="$"+e;!ZQ(r,n)&&t.getSignal(e)&&(r[n]=t.signalRef(e))})),{$expr:OQ({code:a.code},t.options.ast?{ast:n}:null),$fields:a.fields,$params:r}}function W2(e,t,n){return e.fields=t||[],e.fname=n,e}function V2(e){return 1===e.length?G2(e[0]):q2(e)}j2("bandwidth",(function(e,t){var n=m2(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}),v2),j2("copy",(function(e,t){var n=m2(e,(t||this).context);return n?n.copy():void 0}),v2),j2("domain",(function(e,t){var n=m2(e,(t||this).context);return n?n.domain():[]}),v2),j2("range",(function(e,t){var n=m2(e,(t||this).context);return n&&n.range?n.range():[]}),v2),j2("invert",(function(e,t,n){var r=m2(e,(n||this).context);return r?kQ(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}),v2),j2("scale",(function(e,t,n){var r=m2(e,(n||this).context);return r?r(t):void 0}),v2),j2("gradient",(function(e,t,n,r,a){e=m2(e,(a||this).context);var i=rU(t,n),o=e.domain(),u=o[0],s=_Q(o),c=bQ;return s-u?c=vI(e,u,s):e=(e.interpolator?nI("sequential")().interpolator(e.interpolator()):nI("linear")().interpolate(e.interpolate()).range(e.range())).domain([u=0,s=1]),e.ticks&&(u!==(o=e.ticks(+r||15))[0]&&o.unshift(u),s!==_Q(o)&&o.push(s)),o.forEach((function(t){return i.stop(c(t),e(t))})),i}),v2),j2("geoArea",x2,v2),j2("geoBounds",k2,v2),j2("geoCentroid",w2,v2),j2("geoShape",(function(e,t,n){var r=m2(e,(n||this).context);return function(e){return r?r.path.context(e)(t):""}}),v2),j2("indata",(function(e,t,n){var r=this.context.data[e]["index:"+t],a=r?r.value.get(n):void 0;return a?a.count:a}),(function(e,t,n,r){t[0].type!==YQ&&gQ("First argument to indata must be a string literal."),t[1].type!==YQ&&gQ("Second argument to indata must be a string literal.");var a=t[0].value,i=t[1].value,o="@"+i;ZQ(o,r)||(r[o]=n.getData(a).indataRef(n,i))})),j2("data",i2,p2),j2("treePath",(function(e,t,n){var r=M2(e,this),a=r[t],i=r[n];return a&&i?a.path(i).map(I2):void 0}),p2),j2("treeAncestors",(function(e,t){var n=M2(e,this)[t];return n?n.ancestors().map(I2):void 0}),p2),j2("vlSelectionTest",(function(e,t,n){for(var r,a,i,o,u,s=this.context.data[e],c=s?s.values.value:[],l=s?s[Q1]&&s[Q1].value:void 0,f=n===X1,d=c.length,h=0;h<d;++h)if(r=c[h],l&&f){if(-1===(i=(a=a||{})[o=r.unit]||0))continue;if(u=J1(t,r),a[o]=u?-1:++i,u&&1===l.size)return!0;if(!u&&i===l.get(o).count)return!1}else if(f^(u=J1(t,r)))return u;return d&&f}),a2),j2("vlSelectionIdTest",(function(e,t,n){var r=this.context.data[e],a=r?r.values.value:[],i=r?r[Q1]&&r[Q1].value:void 0,o=n===X1,u=$1(t),s=t2(a,u);if(s===a.length)return!1;if($1(a[s])!==u)return!1;if(i&&o){if(1===i.size)return!0;if(n2(a,u)-s<i.size)return!1}return!0}),a2),j2("vlSelectionResolve",(function(e,t,n,r){for(var a,i,o,u,s,c,l,f,d,h,p,v,g=this.context.data[e],m=g?g.values.value:[],y={},b={},x={},k=m.length,w=0;w<k;++w)if(u=(a=m[w]).unit,i=a.fields,o=a.values,i&&o){for(p=0,v=i.length;p<v;++p)s=i[p],f=(l=y[s.field]||(y[s.field]={}))[u]||(l[u]=[]),x[s.field]=d=s.type.charAt(0),h=r2["".concat(d,"_union")],l[u]=h(f,N1(o[p]));n&&(f=b[u]||(b[u]=[])).push(N1(o).reduce((function(e,t,n){return e[i[n].field]=t,e}),{}))}else s=K1,c=$1(a),(f=(l=y[s]||(y[s]={}))[u]||(l[u]=[])).push(c),n&&(f=b[u]||(b[u]=[])).push((0,qn.Z)({},K1,c));return t=t||Y1,y[K1]?y[K1]=r2["".concat(K1,"_").concat(t)].apply(r2,(0,ln.Z)(Object.values(y[K1]))):Object.keys(y).forEach((function(e){y[e]=Object.keys(y[e]).map((function(t){return y[e][t]})).reduce((function(n,r){return void 0===n?r:r2["".concat(x[e],"_").concat(t)](n,r)}))})),m=Object.keys(b),n&&m.length&&(y[r?"vlPoint":"vlMulti"]=t===Y1?(0,qn.Z)({},"or",m.reduce((function(e,t){return e.push.apply(e,(0,ln.Z)(b[t])),e}),[])):(0,qn.Z)({},"and",m.map((function(e){return(0,qn.Z)({},"or",b[e])})))),y}),a2),j2("vlSelectionTuples",(function(e,t){return e.map((function(e){return D1(t.fields?{values:t.fields.map((function(t){return(t.getter||(t.getter=S1(t.field)))(e.datum)}))}:(0,qn.Z)({},K1,$1(e.datum)),t)}))}));var G2=function(e){return function(t){return t[e]}},q2=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function H2(e){throw Error(e)}function X2(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n),s+=e.substring(++n,++n),t=n;else if(r===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&c(),u=t=n+1):"]"===r&&(u||H2("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&H2("Access path missing closing bracket: "+e),o&&H2("Access path missing closing quote: "+e),n>t&&(n++,c()),a}function Y2(e,t,n){var r=X2(e);return e=1===r.length?r[0]:e,W2((n&&n.get||V2)(r),[e],t||e)}Y2("id"),W2((function(e){return e}),[],"identity"),W2((function(){return 0}),[],"zero"),W2((function(){return 1}),[],"one");var K2=W2((function(){return!0}),[],"true");W2((function(){return!1}),[],"false");var $2=Array.isArray;function Q2(e){return e===Object(e)}function J2(e){return null!=e?$2(e)?e:[e]:[]}function e3(e){return"function"===typeof e}var t3=function(e,t){return(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t===t?-1:t!==t&&e===e?1:0)},n3=function(e,t){return 1===e.length?r3(e[0],t[0]):a3(e,t,e.length)},r3=function(e,t){return function(n,r){return t3(e(n),e(r))*t}},a3=function(e,t,n){return t.push(0),function(r,a){for(var i,o=0,u=-1;0===o&&++u<n;)i=e[u],o=t3(i(r),i(a));return o*t[u]}};var i3=Object.prototype.hasOwnProperty;function o3(e,t){return i3.call(e,t)}function u3(e){return $2(e)?"["+e.map(u3)+"]":Q2(e)||"string"===typeof e?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function s3(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return t}var c3=s3(["rule"]),l3=s3(["group","image","rect"]);function f3(e){return(e+"").toLowerCase()}function d3(e,t,n){n.endsWith(";")||(n="return("+n+");");var r=Function.apply(void 0,(0,ln.Z)(t.concat(n)));return e&&e.functions?r.bind(e.functions):r}var h3={operator:function(e,t){return d3(e,["_"],t.code)},parameter:function(e,t){return d3(e,["datum","_"],t.code)},event:function(e,t){return d3(e,["event"],t.code)},handler:function(e,t){return d3(e,["_","event"],"var datum=event.item&&event.item.datum;return ".concat(t.code,";"))},encode:function(e,t){var n=t.marktype,r=t.channels,a="var o=item,datum=o.datum,m=0,$;";for(var i in r){var o="o["+u3(i)+"]";a+="$=".concat(r[i].code,";if(").concat(o,"!==$)").concat(o,"=$,m=1;")}return a+=function(e,t){var n="";return c3[t]||(e.x2&&(e.x?(l3[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(l3[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),d3(e,["item","_"],a+="return m;")},codegen:{get:function(e){var t="[".concat(e.map(u3).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator:function(e,t){var n,r=Function("a","b","var u, v; return "+e.map((function(e,r){var a,i,o=t[r];return e.path?(a="a".concat(e.path),i="b".concat(e.path)):((n=n||{})["f"+r]=e,a="this.f".concat(r,"(a)"),i="this.f".concat(r,"(b)")),function(e,t,n,r){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(r,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(r," : ")}(a,i,-o,o)})).join("")+"0;");return n?r.bind(n):r}}};function p3(e,t,n){if(!e||!Q2(e))return e;for(var r,a=0,i=v3.length;a<i;++a)if(o3(e,(r=v3[a]).key))return r.parse(e,t,n);return e}var v3=[{key:"$ref",parse:function(e,t){return t.get(e.$ref)||H2("Operator not defined: "+e.$ref)}},{key:"$key",parse:function(e,t){var n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=function(e,t,n){e&&(e=t?J2(e).map((function(e){return e.replace(/\\(.)/g,"$1")})):J2(e));var r,a=e&&e.length,i=n&&n.get||V2,o=function(e){return i(t?[e]:X2(e))};if(a)if(1===a){var u=o(e[0]);r=function(e){return""+u(e)}}else{var s=e.map(o);r=function(e){for(var t=""+s[0](e),n=0;++n<a;)t+="|"+s[n](e);return t}}else r=function(){return""};return W2(r,e,"key")}(e.$key,e.$flat,t.expr.codegen))}},{key:"$expr",parse:function(e,t,n){e.$params&&t.parseParameters(e.$params,n);var r="e:"+e.$expr.code;return t.fn[r]||(t.fn[r]=W2(t.parameterExpression(e.$expr),e.$fields))}},{key:"$field",parse:function(e,t){if(!e.$field)return null;var n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=Y2(e.$field,e.$name,t.expr.codegen))}},{key:"$encode",parse:function(e,t){var n=e.$encode,r={};for(var a in n){var i=n[a];r[a]=W2(t.encodeExpression(i.$expr),i.$fields),r[a].output=i.$output}return r}},{key:"$compare",parse:function(e,t){var n="c:"+e.$compare+"_"+e.$order,r=J2(e.$compare).map((function(e){return e&&e.$tupleid?Mo:e}));return t.fn[n]||(t.fn[n]=function(e,t,n){n=n||{},t=J2(t)||[];var r=[],a=[],i={},o=n.comparator||n3;return J2(e).forEach((function(e,o){var u;null!=e&&(r.push("descending"===t[o]?-1:1),a.push(e=e3(e)?e:Y2(e,null,n)),(u=e,(null==u?null:u.fields)||[]).forEach((function(e){return i[e]=1})))})),0===a.length?null:W2(o(a,r),Object.keys(i))}(r,e.$order,t.expr.codegen))}},{key:"$context",parse:function(e,t){return t}},{key:"$subflow",parse:function(e,t){var n=e.$subflow;return function(e,r,a){var i=t.fork().parse(n),o=i.get(n.operators[0].id),u=i.signals.parent;return u&&u.set(a),o.detachSubflow=function(){return t.detach(i)},o}}},{key:"$tupleid",parse:function(){return Mo}}];var g3={skip:!0};function m3(e,t,n,r){return new y3(e,t,n,r)}function y3(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||h3,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function b3(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}function x3(e,t){e&&(null==t?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}y3.prototype=b3.prototype={fork:function(){var e=new b3(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach:function(e){this.subcontext=this.subcontext.filter((function(t){return t!==e}));for(var t=Object.keys(e.nodes),n=0,r=t;n<r.length;n++){var a=r[n];e.nodes[a]._targets=null}for(var i=0,o=t;i<o.length;i++){var u=o[i];e.nodes[u].detach()}e.nodes=null},get:function(e){return this.nodes[e]},set:function(e,t){return this.nodes[e]=t},add:function(e,t){var n=this,r=n.dataflow,a=e.value;if(n.set(e.id,t),function(e){return"collect"===f3(e)}(e.type)&&a&&(a.$ingest?r.ingest(t,a.$ingest,a.$format):a.$request?r.preload(t,a.$request,a.$format):r.pulse(t,r.changeset().insert(a))),e.root&&(n.root=t),e.parent){var i=n.get(e.parent.$ref);i?(r.connect(i,[t]),t.targets().add(i)):(n.unresolved=n.unresolved||[]).push((function(){i=n.get(e.parent.$ref),r.connect(i,[t]),t.targets().add(i)}))}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data){var o=function(){var r=n.data[u]||(n.data[u]={});e.data[u].forEach((function(e){return r[e]=t}))};for(var u in e.data)o()}},resolve:function(){return(this.unresolved||[]).forEach((function(e){return e()})),delete this.unresolved,this},operator:function(e,t){this.add(e,this.dataflow.add(e.value,t))},transform:function(e,t){this.add(e,this.dataflow.add(this.transforms[f3(t)]))},stream:function(e,t){this.set(e.id,t)},update:function(e,t,n,r,a){this.dataflow.on(t,n,r,a,e.options)},operatorExpression:function(e){return this.expr.operator(this,e)},parameterExpression:function(e){return this.expr.parameter(this,e)},eventExpression:function(e){return this.expr.event(this,e)},handlerExpression:function(e){return this.expr.handler(this,e)},encodeExpression:function(e){return this.expr.encode(this,e)},parse:function(e){var t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach((function(e){return t.parseOperator(e)})),n.forEach((function(e){return t.parseOperatorParameters(e)})),(e.streams||[]).forEach((function(e){return t.parseStream(e)})),(e.updates||[]).forEach((function(e){return t.parseUpdate(e)})),t.resolve()},parseOperator:function(e){var t=this;!function(e){return"operator"===f3(e)}(e.type)&&e.type?t.transform(e,e.type):t.operator(e,e.update?t.operatorExpression(e.update):null)},parseOperatorParameters:function(e){var t=this;if(e.params){var n=t.get(e.id);n||H2("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}},parseParameters:function(e,t){t=t||{};var n=this;for(var r in e){var a=e[r];t[r]=$2(a)?a.map((function(e){return p3(e,n,t)})):p3(a,n,t)}return t},parseStream:function(e){var t,n=this,r=null!=e.filter?n.eventExpression(e.filter):void 0,a=null!=e.stream?n.get(e.stream):void 0;e.source?a=n.events(e.source,e.type,r):e.merge&&(a=(t=e.merge.map((function(e){return n.get(e)})))[0].merge.apply(t[0],t.slice(1))),e.between&&(t=e.between.map((function(e){return n.get(e)})),a=a.between(t[0],t[1])),e.filter&&(a=a.filter(r)),null!=e.throttle&&(a=a.throttle(+e.throttle)),null!=e.debounce&&(a=a.debounce(+e.debounce)),null==a&&H2("Invalid stream definition: "+JSON.stringify(e)),e.consume&&a.consume(!0),n.stream(e,a)},parseUpdate:function(e){var t,n=this,r=Q2(r=e.source)?r.$ref:r,a=n.get(r),i=e.update,o=void 0;a||H2("Source not defined: "+e.source),t=e.target&&e.target.$expr?n.eventExpression(e.target.$expr):n.get(e.target),i&&i.$expr&&(i.$params&&(o=n.parseParameters(i.$params)),i=n.handlerExpression(i.$expr)),n.update(e,a,t,i,o)},getState:function(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach((function(n){var a=t.signals[n];e.signals(n,a)&&(r[n]=a.value)}))}if(e.data){var a=n.data={};Object.keys(t.data).forEach((function(n){var r=t.data[n];e.data(n,r)&&(a[n]=r.input.value)}))}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map((function(t){return t.getState(e)}))),n},setState:function(e){var t=this,n=t.dataflow,r=e.data,a=e.signals;Object.keys(a||{}).forEach((function(e){n.update(t.signals[e],a[e],g3)})),Object.keys(r||{}).forEach((function(e){n.pulse(t.data[e].input,n.changeset().remove(K2).insert(r[e]))})),(e.subcontext||[]).forEach((function(e,n){var r=t.subcontext[n];r&&r.setState(e)}))}};var k3="default";function w3(e,t){var n=e.globalCursor()?"undefined"!==typeof document&&document.body:e.container();if(n)return null==t?n.style.removeProperty("cursor"):n.style.cursor=t}function _3(e,t){var n=e._runtime.data;return ct(n,t)||se("Unrecognized data set: "+t),n[t]}function C3(e,t){Po(t)||se("Second argument to changes must be a changeset.");var n=_3(this,e);return n.modified=!0,this.pulse(n.input,t)}function S3(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function A3(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function E3(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function T3(e){var t=E3(e),n=S3(e),r=A3(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach((function(t){try{t(n,r)}catch(a){e.error(a)}}))}function N3(e,t,n){var r,a,i=e._renderer,o=i&&i.canvas();return o&&(a=E3(e),(r=sG(t.changedTouches?t.changedTouches[0]:t,o))[0]-=a[0],r[1]-=a[1]),t.dataflow=e,t.item=n,t.vega=function(e,t,n){var r=t?"group"===t.mark.marktype?t:t.mark.group:null;function a(e){var n,a=r;if(e)for(n=t;n;n=n.mark.group)if(n.mark.name===e){a=n;break}return a&&a.mark&&a.mark.interactive?a:{}}function i(e){if(!e)return n;xt(e)&&(e=a(e));for(var t=n.slice();e;)t[0]-=e.x||0,t[1]-=e.y||0,e=e.mark&&e.mark.group;return t}return{view:rt(e),item:rt(t||{}),group:a,xy:i,x:function(e){return i(e)[0]},y:function(e){return i(e)[1]}}}(e,n,r),t}var D3="view",F3={trap:!1};function I3(e,t,n,r){e._eventListeners.push({type:n,sources:Ye(t),handler:r})}function M3(e,t,n){var r=e._eventConfig&&e._eventConfig[t];return!(!1===r||Se(r)&&!r[n])||(e.warn("Blocked ".concat(t," ").concat(n," event listener.")),!1)}function O3(e){return e.item}function R3(e){return e.item.mark.source}function Z3(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function B3(e,t,n){var r=document.createElement(e);for(var a in t)r.setAttribute(a,t[a]);return null!=n&&(r.textContent=n),r}function z3(e,t,n,r){var a=n.event||"input",i=function(){return e.update(t.value)};r.signal(n.signal,t.value),t.addEventListener(a,i),I3(r,t,a,i),e.set=function(e){t.value=e,t.dispatchEvent(function(e){return"undefined"!==typeof Event?new Event(e):{type:e}}(a))}}function L3(e,t,n,r){var a=r.signal(n.signal),i=B3("div",{class:"vega-bind"}),o="radio"===n.input?i:i.appendChild(B3("label"));o.appendChild(B3("span",{class:"vega-bind-name"},n.name||n.signal)),t.appendChild(i);var u=P3;switch(n.input){case"checkbox":u=j3;break;case"select":u=U3;break;case"radio":u=W3;break;case"range":u=V3}u(e,o,n,a)}function P3(e,t,n,r){var a=B3("input");for(var i in n)"signal"!==i&&"element"!==i&&a.setAttribute("input"===i?"type":i,n[i]);a.setAttribute("name",n.signal),a.value=r,t.appendChild(a),a.addEventListener("input",(function(){return e.update(a.value)})),e.elements=[a],e.set=function(e){return a.value=e}}function j3(e,t,n,r){var a={type:"checkbox",name:n.signal};r&&(a.checked=!0);var i=B3("input",a);t.appendChild(i),i.addEventListener("change",(function(){return e.update(i.checked)})),e.elements=[i],e.set=function(e){return i.checked=!!e||null}}function U3(e,t,n,r){var a=B3("select",{name:n.signal}),i=n.labels||[];n.options.forEach((function(e,t){var n={value:e};G3(e,r)&&(n.selected=!0),a.appendChild(B3("option",n,(i[t]||e)+""))})),t.appendChild(a),a.addEventListener("change",(function(){e.update(n.options[a.selectedIndex])})),e.elements=[a],e.set=function(e){for(var t=0,r=n.options.length;t<r;++t)if(G3(n.options[t],e))return void(a.selectedIndex=t)}}function W3(e,t,n,r){var a=B3("span",{class:"vega-bind-radio"}),i=n.labels||[];t.appendChild(a),e.elements=n.options.map((function(t,o){var u={type:"radio",name:n.signal,value:t};G3(t,r)&&(u.checked=!0);var s=B3("input",u);s.addEventListener("change",(function(){return e.update(t)}));var c=B3("label",{},(i[o]||t)+"");return c.prepend(s),a.appendChild(c),s})),e.set=function(t){for(var n=e.elements,r=n.length,a=0;a<r;++a)G3(n[a].value,t)&&(n[a].checked=!0)}}function V3(e,t,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;var a=null!=n.max?n.max:Math.max(100,+r)||100,i=n.min||Math.min(0,a,+r)||0,o=n.step||Lc(i,a,100),u=B3("input",{type:"range",name:n.signal,min:i,max:a,step:o});u.value=r;var s=B3("span",{},+r);t.appendChild(u),t.appendChild(s);var c=function(){s.textContent=u.value,e.update(+u.value)};u.addEventListener("input",c),u.addEventListener("change",c),e.elements=[u],e.set=function(e){u.value=e,s.textContent=e}}function G3(e,t){return e===t||e+""===t+""}function q3(e,t,n,r,a,i){return(t=t||new r(e.loader())).initialize(n,S3(e),A3(e),E3(e),a,i).background(e.background())}function H3(e,t){return t?function(){try{t.apply(this,arguments)}catch(n){e.error(n)}}:null}function X3(e,t,n){if("string"===typeof t){if("undefined"===typeof document)return e.error("DOM document instance not found."),null;if(!(t=document.querySelector(t)))return e.error("Signal bind element not found: "+t),null}if(t&&n)try{t.innerHTML=""}catch(r){t=null,e.error(r)}return t}var Y3=function(e){return+e||0};function K3(e){return Se(e)?{top:Y3(e.top),bottom:Y3(e.bottom),left:Y3(e.left),right:Y3(e.right)}:function(e){return{top:e,bottom:e,left:e,right:e}}(Y3(e))}function $3(e,t,n,r){return Q3.apply(this,arguments)}function Q3(){return Q3=(0,Bt.Z)((0,w.Z)().mark((function e(t,n,r,a){var i,o;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=_q(n),(o=i&&i.headless)||se("Unrecognized renderer type: "+n),e.next=4,t.runAsync();case 4:return e.abrupt("return",q3(t,null,null,o,r,a).renderAsync(t._scenegraph.root));case 5:case"end":return e.stop()}}),e)}))),Q3.apply(this,arguments)}function J3(){return J3=(0,Bt.Z)((0,w.Z)().mark((function e(t,n){var r;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t!==kq.Canvas&&t!==kq.SVG&&t!==kq.PNG&&se("Unrecognized image type: "+t),e.next=3,$3(this,t,n);case 3:return r=e.sent,e.abrupt("return",t===kq.SVG?e4(r.svg(),"image/svg+xml"):r.canvas().toDataURL("image/png"));case 5:case"end":return e.stop()}}),e,this)}))),J3.apply(this,arguments)}function e4(e,t){var n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}function t4(){return(t4=(0,Bt.Z)((0,w.Z)().mark((function e(t,n){var r;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$3(this,kq.Canvas,t,n);case 2:return r=e.sent,e.abrupt("return",r.canvas());case 4:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function n4(){return(n4=(0,Bt.Z)((0,w.Z)().mark((function e(t){var n;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$3(this,kq.SVG,t);case 2:return n=e.sent,e.abrupt("return",n.svg());case 4:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}var r4="width",a4="height",i4="padding",o4={skip:!0};function u4(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===i4?r.left+r.right:0)}function s4(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===i4?r.top+r.bottom:0)}function c4(e,t){return t.modified&&Ce(t.input.value)&&e.indexOf("_:vega:_")}function l4(e,t){return!("parent"===e||t instanceof yu.proxy)}function f4(e,t,n,r){var a=e.element();a&&a.setAttribute("title",function(e){return null==e?"":Ce(e)?d4(e):Se(e)&&!gt(e)?(t=e,Object.keys(t).map((function(e){var n=t[e];return e+": "+(Ce(n)?d4(n):h4(n))})).join("\n")):e+"";var t}(r))}function d4(e){return"["+e.map(h4).join(", ")+"]"}function h4(e){return Ce(e)?"[\u2026]":Se(e)&&!gt(e)?"{\u2026}":e}function p4(e,t){var n=this;if(t=t||{},vu.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),null!=t.logLevel&&n.logLevel(t.logLevel),t.locale||e.locale){var r=it({},e.locale,t.locale);n.locale(bj(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||kq.Canvas,n._scenegraph=new tG;var a=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||f4,n._redraw=!0,n._handler=(new EG).scene(a),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(e){var t=it({defaults:{}},e),n=function(e,t){t.forEach((function(t){Ce(e[t])&&(e[t]=Mt(e[t]))}))};return n(t.defaults,["prevent","allow"]),n(t,["view","window","selector"]),t}(e.eventConfig),n.globalCursor(n._eventConfig.globalCursor);var i=function(e,t,n){return m3(e,yu,R2,n).parse(t)}(n,e,t.expr);n._runtime=i,n._signals=i.signals,n._bind=(e.bindings||[]).map((function(e){return{state:null,param:it({},e)}})),i.root&&i.root.set(a),a.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(a.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=u4(n,n._width),n._viewHeight=s4(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(e){var t=e._signals,n=t[r4],r=t[a4],a=t[i4];function i(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,(function(t){e._width=t.size,e._viewWidth=u4(e,t.size),i()}),{size:n}),e._resizeHeight=e.add(null,(function(t){e._height=t.size,e._viewHeight=s4(e,t.size),i()}),{size:r});var o=e.add(null,i,{pad:a});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,o.rank=a.rank+1}(n),function(e){e.add(null,(function(t){return e._background=t.bg,e._resize=1,t.bg}),{bg:e._signals.background})}(n),function(e){var t=e._signals.cursor||(e._signals.cursor=e.add({user:k3,item:null}));e.on(e.events("view","mousemove"),t,(function(e,n){var r=t.value,a=r?xt(r)?r:r.user:k3,i=n.item&&n.item.cursor||null;return r&&a===r.user&&i==r.item?r:{user:a,item:i}})),e.add(null,(function(t){var n=t.cursor,r=this.value;return xt(n)||(r=n.item,n=n.user),w3(e,n&&n!==k3?n:r||n),r}),{cursor:t})}(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function v4(e,t){return ct(e._signals,t)?e._signals[t]:se("Unrecognized signal name: "+Tt(t))}function g4(e,t){var n=(e._targets||[]).filter((function(e){return e._update&&e._update.handler===t}));return n.length?n[0]:null}function m4(e,t,n,r){var a=g4(n,r);return a||((a=H3(e,(function(){return r(t,n.value)}))).handler=r,e.on(n,null,a)),e}function y4(e,t,n){var r=g4(t,n);return r&&t._targets.remove(r),e}ht(p4,vu,{evaluate:function(e,t,n){var r=this;return(0,Bt.Z)((0,w.Z)().mark((function a(){return(0,w.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,vu.prototype.evaluate.call(r,e,t);case 2:if(!r._redraw&&!r._resize){a.next=14;break}if(a.prev=3,!r._renderer){a.next=8;break}return r._resize&&(r._resize=0,T3(r)),a.next=8,r._renderer.renderAsync(r._scenegraph.root);case 8:r._redraw=!1,a.next=14;break;case 11:a.prev=11,a.t0=a.catch(3),r.error(a.t0);case 14:return n&&To(r,n),a.abrupt("return",r);case 16:case"end":return a.stop()}}),a,null,[[3,11]])})))()},dirty:function(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description:function(e){if(arguments.length){var t=null!=e?e+"":null;return t!==this._desc&&x3(this._el,this._desc=t),this}return this._desc},container:function(){return this._el},scenegraph:function(){return this._scenegraph},origin:function(){return this._origin.slice()},signal:function(e,t,n){var r=v4(this,e);return 1===arguments.length?r.value:this.update(r,t,n)},width:function(e){return arguments.length?this.signal("width",e):this.signal("width")},height:function(e){return arguments.length?this.signal("height",e):this.signal("height")},padding:function(e){return arguments.length?this.signal("padding",K3(e)):K3(this.signal("padding"))},autosize:function(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background:function(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer:function(e){return arguments.length?(_q(e)||se("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip:function(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader:function(e){return arguments.length?(e!==this._loader&&(vu.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize:function(){return this._autosize=1,this.touch(v4(this,"autosize"))},_resetRenderer:function(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(e,t,n,r,a,i){this.runAfter((function(o){var u=0;o._autosize=0,o.width()!==n&&(u=1,o.signal(r4,n,o4),o._resizeWidth.skip(!0)),o.height()!==r&&(u=1,o.signal(a4,r,o4),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),o._origin[0]===a[0]&&o._origin[1]===a[1]||(o._resize=1,o._origin=a),u&&o.run("enter"),i&&o.runAfter((function(e){return e.resize()}))}),!1,1)},addEventListener:function(e,t,n){var r=t;return n&&!1===n.trap||((r=H3(this,t)).raw=t),this._handler.on(e,r),this},removeEventListener:function(e,t){for(var n,r,a=this._handler.handlers(e),i=a.length;--i>=0;)if(r=a[i].type,n=a[i].handler,e===r&&(t===n||t===n.raw)){this._handler.off(r,n);break}return this},addResizeListener:function(e){var t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener:function(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener:function(e,t){return m4(this,e,v4(this,e),t)},removeSignalListener:function(e,t){return y4(this,v4(this,e),t)},addDataListener:function(e,t){return m4(this,e,_3(this,e).values,t)},removeDataListener:function(e,t){return y4(this,_3(this,e).values,t)},globalCursor:function(e){if(arguments.length){if(this._globalCursor!==!!e){var t=w3(this,null);this._globalCursor=!!e,t&&w3(this,t)}return this}return this._globalCursor},preventDefault:function(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:function(e,t){this._timers.push(function(e,t,n){var r=new PB,a=t;return null==t?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(e,t,n){t=+t,n=null==n?zB():+n,r._restart((function i(o){o+=a,r._restart(i,a+=t,n),e(o)}),t,n)},r.restart(e,t,n),r)}((function(t){e({timestamp:Date.now(),elapsed:t})}),t))},events:function(e,t,n){var r,a=this,i=new Yo(n),o=function(n,r){a.runAsync(null,(function(){e===D3&&function(e,t){var n=e._eventConfig.defaults,r=n.prevent,a=n.allow;return!1!==r&&!0!==a&&(!0===r||!1===a||(r?r[t]:a?!a[t]:e.preventDefault()))}(a,t)&&n.preventDefault(),i.receive(N3(a,n,r))}))};if("timer"===e)M3(a,"timer",t)&&a.timer(o,t);else if(e===D3)M3(a,"view",t)&&a.addEventListener(t,o,F3);else if("window"===e?M3(a,"window",t)&&"undefined"!==typeof window&&(r=[window]):"undefined"!==typeof document&&M3(a,"selector",t)&&(r=document.querySelectorAll(e)),r){for(var u=0,s=r.length;u<s;++u)r[u].addEventListener(t,o);I3(a,r,t,o)}else a.warn("Can not resolve event source: "+e);return i},finalize:function(){var e,t,n,r=this._tooltip,a=this._timers,i=this._eventListeners;for(e=a.length;--e>=0;)a[e].stop();for(e=i.length;--e>=0;)for(t=(n=i[e]).sources.length;--t>=0;)n.sources[t].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(e,t){return t=[t||"update",(e=[e||"hover"])[0]],this.on(this.events("view","mouseover",O3),R3,Z3(e)),this.on(this.events("view","mouseout",O3),R3,Z3(t)),this},data:function(e,t){return arguments.length<2?_3(this,e).values.value:C3.call(this,e,jo().remove(ve).insert(t))},change:C3,insert:function(e,t){return C3.call(this,e,jo().insert(t))},remove:function(e,t){return C3.call(this,e,jo().remove(t))},scale:function(e){var t=this._runtime.scales;return ct(t,e)||se("Unrecognized scale or projection: "+e),t[e].value},initialize:function(e,t){var n=this,r=n._renderType,a=n._eventConfig.bind,i=_q(r);e=n._el=e?X3(n,e,!0):null,function(e){var t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),x3(t,e.description()))}(n),i||n.error("Unrecognized renderer type: "+r);var o=i.handler||EG,u=e?i.renderer:i.headless;return n._renderer=u?q3(n,n._renderer,e,u):null,n._handler=function(e,t,n,r){var a=new r(e.loader(),H3(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,E3(e),e);return t&&t.handlers().forEach((function(e){a.on(e.type,e.handler)})),a}(n,n._handler,e,o),n._redraw=!0,e&&"none"!==a&&(t=t?n._elBind=X3(n,t,!0):e.appendChild(B3("form",{class:"vega-bindings"})),n._bind.forEach((function(e){e.param.element&&"container"!==a&&(e.element=X3(n,e.param.element,!!e.param.input))})),n._bind.forEach((function(e){!function(e,t,n){if(t){var r=n.param,a=n.state;a||(a=n.state={elements:null,active:!1,set:null,update:function(t){t!=e.signal(r.signal)&&e.runAsync(null,(function(){a.source=!0,e.signal(r.signal,t)}))}},r.debounce&&(a.update=at(r.debounce,a.update))),(null==r.input&&r.element?z3:L3)(a,t,r,e),a.active||(e.on(e._signals[r.signal],null,(function(){a.source?a.source=!1:a.set(e.signal(r.signal))})),a.active=!0)}}(n,e.element||t,e)}))),n},toImageURL:function(e,t){return J3.apply(this,arguments)},toCanvas:function(e,t){return t4.apply(this,arguments)},toSVG:function(e){return n4.apply(this,arguments)},getState:function(e){return this._runtime.getState(e||{data:c4,signals:l4,recurse:!0})},setState:function(e){return this.runAsync(null,(function(t){t._trigger=!1,t._runtime.setState(e)}),(function(e){e._trigger=!0})),this}});var b4,x4,k4="[",w4="]",_4=/[[\]{}]/,C4={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function S4(e,t,n,r,a){for(var i,o=e.length,u=0;t<o;++t){if(i=e[t],!u&&i===n)return t;a&&a.indexOf(i)>=0?--u:r&&r.indexOf(i)>=0&&++u}return t}function A4(e){for(var t=[],n=e.length,r=0,a=0;a<n;)a=S4(e,a,",","[{","]}"),t.push(e.substring(r,a).trim()),r=++a;if(0===t.length)throw"Empty event selector: "+e;return t}function E4(e){return"["===e[0]?function(e){var t,n=e.length,r=1;if(r=S4(e,r,w4,k4,w4),r===n)throw"Empty between selector: "+e;if(t=A4(e.substring(1,r)),2!==t.length)throw"Between selector must have two elements: "+e;if(e=e.slice(r+1).trim(),">"!==e[0])throw"Expected '>' after between selector: "+e;t=t.map(E4);var a=E4(e.slice(1).trim());if(a.between)return{between:t,stream:a};a.between=t;return a}(e):function(e){var t,n,r={source:b4},a=[],i=[0,0],o=0,u=0,s=e.length,c=0;if("}"===e[s-1]){if(!((c=e.lastIndexOf("{"))>=0))throw"Unmatched right brace: "+e;try{i=function(e){var t=e.split(",");if(!e.length||t.length>2)throw e;return t.map((function(t){var n=+t;if(n!==n)throw e;return n}))}(e.substring(c+1,s-1))}catch(l){throw"Invalid throttle specification: "+e}s=(e=e.slice(0,c).trim()).length,c=0}if(!s)throw e;"@"===e[0]&&(o=++c);t=S4(e,c,":"),t<s&&(a.push(e.substring(u,t).trim()),u=c=++t);if(c=S4(e,c,k4),c===s)a.push(e.substring(u,s).trim());else if(a.push(e.substring(u,c).trim()),n=[],(u=++c)===s)throw"Unmatched left bracket: "+e;for(;c<s;){if((c=S4(e,c,w4))===s)throw"Unmatched left bracket: "+e;if(n.push(e.substring(u,c).trim()),c<s-1&&e[++c]!==k4)throw"Expected left bracket: "+e;u=++c}if(!(s=a.length)||_4.test(a[s-1]))throw"Invalid event selector: "+e;s>1?(r.type=a[1],o?r.markname=a[0].slice(1):!function(e){return x4[e]}(a[0])?r.source=a[0]:r.marktype=a[0]):r.type=a[0];"!"===r.type.slice(-1)&&(r.consume=!0,r.type=r.type.slice(0,-1));null!=n&&(r.filter=n);i[0]&&(r.throttle=i[0]);i[1]&&(r.debounce=i[1]);return r}(e)}function T4(e){return Se(e)?e:{type:e||"pad"}}var N4=function(e){return+e||0};function D4(e){return Se(e)?e.signal?e:{top:N4(e.top),bottom:N4(e.bottom),left:N4(e.left),right:N4(e.right)}:{top:t=N4(e),bottom:t,left:t,right:t};var t}var F4=function(e){return Se(e)&&!Ce(e)?it({},e):{value:e}};function I4(e,t,n,r){return null!=n?(Se(n)&&!Ce(n)||Ce(n)&&n.length&&Se(n[0])?e.update[t]=n:e[r||"enter"][t]={value:n},1):0}function M4(e,t,n){for(var r in t)I4(e,r,t[r]);for(var a in n)I4(e,a,n[a],"update")}function O4(e,t,n){for(var r in t)n&&ct(n,r)||(e[r]=it(e[r]||{},t[r]));return e}function R4(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}var Z4="mark",B4="frame",z4="scope",L4="legend-label",P4="title-text",j4="title-subtitle";function U4(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}var W4=function(e){return xt(e)?Tt(e):e.signal?"(".concat(e.signal,")"):H4(e)};function V4(e){if(null!=e.gradient)return function(e){var t=[e.start,e.stop,e.count].map((function(e){return null==e?null:Tt(e)}));for(;t.length&&null==De(t);)t.pop();return t.unshift(W4(e.gradient)),"gradient(".concat(t.join(","),")")}(e);var t=e.signal?"(".concat(e.signal,")"):e.color?function(e){return e.c?G4("hcl",e.h,e.c,e.l):e.h||e.s?G4("hsl",e.h,e.s,e.l):e.l||e.a?G4("lab",e.l,e.a,e.b):e.r||e.g||e.b?G4("rgb",e.r,e.g,e.b):null}(e.color):null!=e.field?H4(e.field):void 0!==e.value?Tt(e.value):void 0;return null!=e.scale&&(t=function(e,t){var n=W4(e.scale);null!=e.range?t="lerp(_range(".concat(n,"), ").concat(+e.range,")"):(void 0!==t&&(t="_scale(".concat(n,", ").concat(t,")")),e.band&&(t=(t?t+"+":"")+"_bandwidth(".concat(n,")")+(1===+e.band?"":"*"+q4(e.band)),e.extra&&(t="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(t,")"))),null==t&&(t="0"));return t}(e,t)),void 0===t&&(t=null),null!=e.exponent&&(t="pow(".concat(t,",").concat(q4(e.exponent),")")),null!=e.mult&&(t+="*".concat(q4(e.mult))),null!=e.offset&&(t+="+".concat(q4(e.offset))),e.round&&(t="round(".concat(t,")")),t}var G4=function(e,t,n,r){return"(".concat(e,"(").concat([t,n,r].map(V4).join(","),")+'')")};function q4(e){return Se(e)?"("+V4(e)+")":e}function H4(e){return X4(Se(e)?e:{datum:e})}function X4(e){var t,n,r;if(e.signal)t="datum",r=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(r=e.parent,t+=".datum"):r=e.group}else e.datum?(t="datum",r=e.datum):se("Invalid field reference: "+Tt(e));return e.signal||(r=xt(r)?ce(r).map(Tt).join("]["):X4(r)),t+"["+r+"]"}function Y4(e,t,n,r,a,i){var o={};for(var u in(i=i||{}).encoders={$encode:o},e=function(e,t,n,r,a){var i,o,u,s={},c={};for(o in o="lineBreak","text"!==t||null==a[o]||R4(o,e)||U4(s,o,a[o]),("legend"==n||String(n).startsWith("axis"))&&(n=null),u=n===B4?a.group:n===Z4?it({},a.mark,a[t]):null)R4(o,e)||("fill"===o||"stroke"===o)&&(R4("fill",e)||R4("stroke",e))||U4(s,o,u[o]);for(o in Ye(r).forEach((function(t){var n=a.style&&a.style[t];for(var r in n)R4(r,e)||U4(s,r,n[r])})),e=it({},e),s)(u=s[o]).signal?(i=i||{})[o]=u:c[o]=u;return e.enter=it(c,e.enter),i&&(e.update=it(i,e.update)),e}(e,t,n,r,a.config),e)o[u]=K4(e[u],t,i,a);return i}function K4(e,t,n,r){var a,i={},o={};for(var u in e)null!=e[u]&&(i[u]=$4((a=e[u],Ce(a)?function(e){var t="";return e.forEach((function(e){var n=V4(e);t+=e.test?"(".concat(e.test,")?").concat(n,":"):n})),":"===De(t)&&(t+="null"),t}(a):V4(a)),r,n,o));return{$expr:{marktype:t,channels:i},$fields:Object.keys(o),$output:Object.keys(e)}}function $4(e,t,n,r){var a=U2(e,t);return a.$fields.forEach((function(e){return r[e]=1})),it(n,a.$params),a.$expr}var Q4=["value","update","init","react","bind"];function J4(e,t){se(e+' for "outer" push: '+Tt(t))}function e5(e,t){var n=e.name;if("outer"===e.push)t.signals[n]||J4("No prior signal definition",n),Q4.forEach((function(t){void 0!==e[t]&&J4("Invalid property ",t)}));else{var r=t.addSignal(n,e.value);!1===e.react&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function t5(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function n5(e,t,n,r){return new t5(e,t,n,r)}function r5(e,t){return n5("operator",e,t)}function a5(e){var t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function i5(e,t){return t?{$field:e,$name:t}:{$field:e}}var o5=i5("key");function u5(e,t){return{$compare:e,$order:t}}function s5(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}var c5="scope",l5="view";function f5(e){return e&&e.signal}function d5(e){if(f5(e))return!0;if(Se(e))for(var t in e)if(d5(e[t]))return!0;return!1}function h5(e,t){return null!=e?e:t}function p5(e){return e&&e.signal||e}var v5="timer";function g5(e,t){return(e.merge?m5:e.stream?y5:e.type?b5:se("Invalid stream specification: "+Tt(e)))(e,t)}function m5(e,t){var n=e.merge.map((function(e){return g5(e,t)})),r=x5({merge:n},e,t);return t.addStream(r).id}function y5(e,t){var n=x5({stream:g5(e.stream,t)},e,t);return t.addStream(n).id}function b5(e,t){var n;e.type===v5?(n=t.event(v5,e.throttle),e={between:e.between,filter:e.filter}):n=t.event(function(e){return e===c5?l5:e||l5}(e.source),e.type);var r=x5({stream:n},e,t);return 1===Object.keys(r).length?n:t.addStream(r).id}function x5(e,t,n){var r=t.between;return r&&(2!==r.length&&se('Stream "between" parameter must have 2 entries: '+Tt(t)),e.between=[g5(r[0],n),g5(r[1],n)]),r=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&r.push(function(e,t,n){var r="event.item";return r+(e&&"*"!==e?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}(t.marktype,t.markname,t.markrole)),t.source===c5&&r.push("inScope(event.item)"),r.length&&(e.filter=U2("("+r.join(")&&(")+")",n).$expr),null!=(r=t.throttle)&&(e.throttle=+r),null!=(r=t.debounce)&&(e.debounce=+r),t.consume&&(e.consume=!0),e}var k5={code:"_.$value",ast:{type:"Identifier",value:"value"}};function w5(e,t,n){var r=e.encode,a={target:n},i=e.events,o=e.update,u=[];i||se("Signal update missing events specification."),xt(i)&&(i=function(e,t,n){return b4=t||"view",x4=n||C4,A4(e.trim()).map(E4)}(i,t.isSubscope()?c5:l5)),i=Ye(i).filter((function(e){return e.signal||e.scale?(u.push(e),0):1})),u.length>1&&(u=[_5(u)]),i.length&&u.push(i.length>1?{merge:i}:i[0]),null!=r&&(o&&se("Signal encode and update are mutually exclusive."),o="encode(item(),"+Tt(r)+")"),a.update=xt(o)?U2(o,t):null!=o.expr?U2(o.expr,t):null!=o.value?o.value:null!=o.signal?{$expr:k5,$params:{$value:t.signalRef(o.signal)}}:se("Invalid signal update specification."),e.force&&(a.options={force:!0}),u.forEach((function(e){return t.addUpdate(it(function(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):g5(e,t)}}(e,t),a))}))}function _5(e){return{signal:"["+e.map((function(e){return e.scale?'scale("'+e.scale+'")':e.signal}))+"]"}}var C5=function(e){return function(t,n,r){return n5(e,n,t||void 0,r)}},S5=C5("aggregate"),A5=C5("axisticks"),E5=C5("bound"),T5=C5("collect"),N5=C5("compare"),D5=C5("datajoin"),F5=C5("encode"),I5=C5("expression"),M5=C5("facet"),O5=C5("field"),R5=C5("key"),Z5=C5("legendentries"),B5=C5("load"),z5=C5("mark"),L5=C5("multiextent"),P5=C5("multivalues"),j5=C5("overlap"),U5=C5("params"),W5=C5("prefacet"),V5=C5("projection"),G5=C5("proxy"),q5=C5("relay"),H5=C5("render"),X5=C5("scale"),Y5=C5("sieve"),K5=C5("sortitems"),$5=C5("viewlayout"),Q5=C5("values"),J5=0,e6={min:"min",max:"max",count:"sum"};function t6(e,t){var n,r=t.getScale(e.name).params;for(n in r.domain=i6(e.domain,e,t),null!=e.range&&(r.range=h6(e,t,r)),null!=e.interpolate&&function(e,t){t.interpolate=n6(e.type||e),null!=e.gamma&&(t.interpolateGamma=n6(e.gamma))}(e.interpolate,r),null!=e.nice&&(r.nice=function(e){return Se(e)?{interval:n6(e.interval),step:n6(e.step)}:n6(e)}(e.nice)),null!=e.bins&&(r.bins=function(e,t){return e.signal||Ce(e)?r6(e,t):t.objectProperty(e)}(e.bins,t)),e)ct(r,n)||"name"===n||(r[n]=n6(e[n],t))}function n6(e,t){return Se(e)?e.signal?t.signalRef(e.signal):se("Unsupported object: "+Tt(e)):e}function r6(e,t){return e.signal?t.signalRef(e.signal):e.map((function(e){return n6(e,t)}))}function a6(e){se("Can not find data set: "+Tt(e))}function i6(e,t,n){if(e)return e.signal?n.signalRef(e.signal):(Ce(e)?o6:e.fields?s6:u6)(e,t,n);null==t.domainMin&&null==t.domainMax||se("No scale domain defined for domainMin/domainMax to override.")}function o6(e,t,n){return e.map((function(e){return n6(e,n)}))}function u6(e,t,n){var r=n.getData(e.data);return r||a6(e.data),oI(t.type)?r.valuesRef(n,e.field,l6(e.sort,!1)):lI(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function s6(e,t,n){var r=e.data,a=e.fields.reduce((function(e,t){return t=xt(t)?{data:r,field:t}:Ce(t)||t.signal?function(e,t){var n="_:vega:_"+J5++,r=T5({});if(Ce(e))r.value={$ingest:e};else if(e.signal){var a="setdata("+Tt(n)+","+e.signal+")";r.params.input=t.signalRef(a)}return t.addDataPipeline(n,[r,Y5({})]),{data:n,field:"data"}}(t,n):t,e.push(t),e}),[]);return(oI(t.type)?c6:lI(t.type)?f6:d6)(e,n,a)}function c6(e,t,n){var r,a,i=l6(e.sort,!0),o=n.map((function(e){var n=t.getData(e.data);return n||a6(e.data),n.countsRef(t,e.field,i)})),u={groupby:o5,pulse:o};i&&(r=i.op||"count",a=i.field?s5(r,i.field):"count",u.ops=[e6[r]],u.fields=[t.fieldRef(a)],u.as=[a]),r=t.add(S5(u));var s=t.add(T5({pulse:a5(r)}));return a=t.add(Q5({field:o5,sort:t.sortRef(i),pulse:a5(s)})),a5(a)}function l6(e,t){return e&&(e.field||e.op?e.field||"count"===e.op?t&&e.field&&e.op&&!e6[e.op]&&se("Multiple domain scales can not be sorted using "+e.op):se("No field provided for sort aggregate op: "+e.op):Se(e)?e.field="key":e={field:"key"}),e}function f6(e,t,n){var r=n.map((function(e){var n=t.getData(e.data);return n||a6(e.data),n.domainRef(t,e.field)}));return a5(t.add(P5({values:r})))}function d6(e,t,n){var r=n.map((function(e){var n=t.getData(e.data);return n||a6(e.data),n.extentRef(t,e.field)}));return a5(t.add(L5({extents:r})))}function h6(e,t,n){var r=t.config.range,a=e.range;if(a.signal)return t.signalRef(a.signal);if(xt(a)){if(r&&ct(r,a))return h6(e=it({},e,{range:r[a]}),t,n);"width"===a?a=[0,{signal:"width"}]:"height"===a?a=oI(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:se("Unrecognized scale range value: "+Tt(a))}else{if(a.scheme)return n.scheme=Ce(a.scheme)?r6(a.scheme,t):n6(a.scheme,t),a.extent&&(n.schemeExtent=r6(a.extent,t)),void(a.count&&(n.schemeCount=n6(a.count,t)));if(a.step)return void(n.rangeStep=n6(a.step,t));if(oI(e.type)&&!Ce(a))return i6(a,e,t);Ce(a)||se("Unsupported range type: "+Tt(a))}return a.map((function(e){return(Ce(e)?r6:n6)(e,t)}))}function p6(e,t,n){return Ce(e)?e.map((function(e){return p6(e,t,n)})):Se(e)?e.signal?n.signalRef(e.signal):"fit"===t?e:se("Unsupported parameter object: "+Tt(e)):e}var v6="top",g6="left",m6="right",y6="bottom",b6="center",x6="index",k6="label",w6="perc",_6="value",C6="guide-label",S6="guide-title",A6="group-title",E6="group-subtitle",T6="symbol",N6="gradient",D6="discrete",F6="size",I6=[F6,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],M6={name:1,style:1,interactive:1},O6={value:0},R6={value:1},Z6="group",B6="rect",z6="rule",L6="text";function P6(e){return e.type=Z6,e.interactive=e.interactive||!1,e}function j6(e,t){var n=function(n,r){return h5(e[n],h5(t[n],r))};return n.isVertical=function(n){return"vertical"===h5(e.direction,t.direction||(n?t.symbolDirection:t.gradientDirection))},n.gradientLength=function(){return h5(e.gradientLength,t.gradientLength||t.gradientWidth)},n.gradientThickness=function(){return h5(e.gradientThickness,t.gradientThickness||t.gradientHeight)},n.entryColumns=function(){return h5(e.columns,h5(t.columns,+n.isVertical(!0)))},n}function U6(e,t){var n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function W6(e,t,n){return"item.anchor === '".concat("start","' ? ").concat(e," : item.anchor === '").concat("end","' ? ").concat(t," : ").concat(n)}var V6=W6(Tt(g6),Tt(m6),Tt(b6));function G6(e,t){return t?e?Se(e)?Object.assign({},e,{offset:G6(e.offset,t)}):{value:e,offset:t}:t:e}function q6(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=O4(e.encode,t,M6)):e.interactive=!1,e}function H6(e,t,n,r){var a,i,o,u,s,c=j6(e,n),l=c.isVertical(),f=c.gradientThickness(),d=c.gradientLength();l?(i=[0,1],o=[0,0],u=f,s=d):(i=[0,0],o=[1,0],u=d,s=f);var h={enter:a={opacity:O6,x:O6,y:O6,width:F4(u),height:F4(s)},update:it({},a,{opacity:R6,fill:{gradient:t,start:i,stop:o}}),exit:{opacity:O6}};return M4(h,{stroke:c("gradientStrokeColor"),strokeWidth:c("gradientStrokeWidth")},{opacity:c("gradientOpacity")}),q6({type:B6,role:"legend-gradient",encode:h},r)}function X6(e,t,n,r,a){var i,o,u,s,c=j6(e,n),l=c.isVertical(),f=c.gradientThickness(),d=c.gradientLength(),h="";l?(i="y",u="y2",o="x",s="width",h="1-"):(i="x",u="x2",o="y",s="height");var p={opacity:O6,fill:{scale:t,field:_6}};p[i]={signal:h+"datum."+w6,mult:d},p[o]=O6,p[u]={signal:h+"datum.perc2",mult:d},p[s]=F4(f);var v={enter:p,update:it({},p,{opacity:R6}),exit:{opacity:O6}};return M4(v,{stroke:c("gradientStrokeColor"),strokeWidth:c("gradientStrokeWidth")},{opacity:c("gradientOpacity")}),q6({type:B6,role:"legend-band",key:_6,from:a,encode:v},r)}var Y6="datum.".concat(w6,'<=0?"').concat(g6,'":datum.').concat(w6,'>=1?"').concat(m6,'":"').concat(b6,'"'),K6="datum.".concat(w6,'<=0?"').concat(y6,'":datum.').concat(w6,'>=1?"').concat(v6,'":"').concat("middle",'"');function $6(e,t,n,r){var a,i,o,u,s=j6(e,t),c=s.isVertical(),l=F4(s.gradientThickness()),f=s.gradientLength(),d=s("labelOverlap"),h="",p={enter:a={opacity:O6},update:i={opacity:R6,text:{field:k6}},exit:{opacity:O6}};return M4(p,{fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:h5(e.labelLimit,t.gradientLabelLimit)}),c?(a.align={value:"left"},a.baseline=i.baseline={signal:K6},o="y",u="x",h="1-"):(a.align=i.align={signal:Y6},a.baseline={value:"top"},o="x",u="y"),a[o]=i[o]={signal:h+"datum."+w6,mult:f},a[u]=i[u]=l,l.offset=h5(e.labelOffset,t.gradientLabelOffset)||0,d=d?{separation:s("labelSeparation"),method:d,order:"datum."+x6}:void 0,q6({type:L6,role:L4,style:C6,key:_6,from:r,encode:p,overlap:d},n)}function Q6(e,t,n,r,a){var i,o,u,s,c,l=j6(e,t),f=n.entries,d=!(!f||!f.interactive),h=f?f.name:void 0,p=l("clipHeight"),v=l("symbolOffset"),g={data:"value"},m="(".concat(a,") ? datum.").concat("offset"," : datum.").concat(F6),y=p?F4(p):{field:F6},b="datum.".concat(x6),x="max(1, ".concat(a,")");y.mult=.5,i={enter:o={opacity:O6,x:{signal:m,mult:.5,offset:v},y:y},update:u={opacity:R6,x:o.x,y:o.y},exit:{opacity:O6}};var k=null,w=null;e.fill||(k=t.symbolBaseFillColor,w=t.symbolBaseStrokeColor),M4(i,{fill:l("symbolFillColor",k),shape:l("symbolType"),size:l("symbolSize"),stroke:l("symbolStrokeColor",w),strokeDash:l("symbolDash"),strokeDashOffset:l("symbolDashOffset"),strokeWidth:l("symbolStrokeWidth")},{opacity:l("symbolOpacity")}),I6.forEach((function(t){e[t]&&(u[t]=o[t]={scale:e[t],field:_6})}));var _=q6({type:"symbol",role:"legend-symbol",key:_6,from:g,clip:!!p||void 0,encode:i},n.symbols),C=F4(v);C.offset=l("labelOffset"),M4(i={enter:o={opacity:O6,x:{signal:m,offset:C},y:y},update:u={opacity:R6,text:{field:k6},x:o.x,y:o.y},exit:{opacity:O6}},{align:l("labelAlign"),baseline:l("labelBaseline"),fill:l("labelColor"),fillOpacity:l("labelOpacity"),font:l("labelFont"),fontSize:l("labelFontSize"),fontStyle:l("labelFontStyle"),fontWeight:l("labelFontWeight"),limit:l("labelLimit")});var S=q6({type:L6,role:L4,style:C6,key:_6,from:g,encode:i},n.labels);return i={enter:{noBound:{value:!p},width:O6,height:p?F4(p):O6,opacity:O6},exit:{opacity:O6},update:u={opacity:R6,row:{signal:null},column:{signal:null}}},l.isVertical(!0)?(s="ceil(item.mark.items.length / ".concat(x,")"),u.row.signal="".concat(b,"%").concat(s),u.column.signal="floor(".concat(b," / ").concat(s,")"),c={field:["row",b]}):(u.row.signal="floor(".concat(b," / ").concat(x,")"),u.column.signal="".concat(b," % ").concat(x),c={field:b}),u.column.signal="(".concat(a,")?").concat(u.column.signal,":").concat(b),P6({role:z4,from:r={facet:{data:r,name:"value",groupby:x6}},encode:O4(i,f,M6),marks:[_,S],name:h,interactive:d,sort:c})}var J6='item.orient === "left"',e8='item.orient === "right"',t8="(".concat(J6," || ").concat(e8,")"),n8="datum.vgrad && ".concat(t8),r8=W6('"top"','"bottom"','"middle"'),a8=W6('"right"','"left"','"center"'),i8="datum.vgrad && ".concat(e8," ? (").concat(a8,") : (").concat(t8," && !(datum.vgrad && ").concat(J6,')) ? "left" : ').concat(V6),o8="item._anchor || (".concat(t8,' ? "middle" : "start")'),u8="".concat(n8," ? (").concat(J6," ? -90 : 90) : 0"),s8="".concat(t8," ? (datum.vgrad ? (").concat(e8,' ? "bottom" : "top") : ').concat(r8,') : "top"');function c8(e,t){var n;return Se(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+l8(e.path)+")":e.sphere&&(n="geoShape("+l8(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function l8(e){return Se(e)&&e.signal?e.signal:Tt(e)}function f8(e){var t=e.role||"";return t.indexOf("axis")&&t.indexOf("legend")&&t.indexOf("title")?e.type===Z6?z4:t||Z4:t}function d8(e){return{marktype:e.type,name:e.name||void 0,role:e.role||f8(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function h8(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}function p8(e,t){var n=bu(e.type);n||se("Unrecognized transform type: "+Tt(e.type));var r=n5(n.type.toLowerCase(),null,v8(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(r)),r.metadata=n.metadata||{},r}function v8(e,t,n){for(var r={},a=e.params.length,i=0;i<a;++i){var o=e.params[i];r[o.name]=g8(o,t,n)}return r}function g8(e,t,n){var r=e.type,a=t[e.name];return"index"===r?function(e,t,n){xt(t.from)||se('Lookup "from" parameter must be a string literal.');return n.getData(t.from).lookupRef(n,t.key)}(0,t,n):void 0!==a?"param"===r?function(e,t,n){var r=t[e.name];return e.array?(Ce(r)||se("Expected an array of sub-parameters. Instead: "+Tt(r)),r.map((function(t){return y8(e,t,n)}))):y8(e,r,n)}(e,t,n):"projection"===r?n.projectionRef(t[e.name]):e.array&&!f5(a)?a.map((function(t){return m8(e,t,n)})):m8(e,a,n):void(e.required&&se("Missing required "+Tt(t.type)+" parameter: "+Tt(e.name)))}function m8(e,t,n){var r=e.type;if(f5(t))return w8(r)?se("Expression references can not be signals."):_8(r)?n.fieldRef(t):C8(r)?n.compareRef(t):n.signalRef(t.signal);var a=e.expr||_8(r);return a&&b8(t)?n.exprRef(t.expr,t.as):a&&x8(t)?i5(t.field,t.as):w8(r)?U2(t,n):k8(r)?a5(n.getData(t).values):_8(r)?i5(t):C8(r)?n.compareRef(t):t}function y8(e,t,n){for(var r,a=e.params.length,i=0;i<a;++i){for(var o in(r=e.params[i]).key)if(r.key[o]!==t[o]){r=null;break}if(r)break}r||se("Unsupported parameter: "+Tt(t));var u=it(v8(r,t,n),r.key);return a5(n.add(U5(u)))}var b8=function(e){return e&&e.expr},x8=function(e){return e&&e.field},k8=function(e){return"data"===e},w8=function(e){return"expr"===e},_8=function(e){return"field"===e},C8=function(e){return"compare"===e};function S8(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:a5(t.getData(e.data).output)}function A8(e,t,n,r,a){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=a,this.index={}}function E8(e){return xt(e)?e:null}function T8(e,t,n){var r,a=s5(n.op,n.field);if(t.ops){for(var i=0,o=t.as.length;i<o;++i)if(t.as[i]===a)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(a))}function N8(e,t,n,r,a,i,o){var u,s,c=t[n]||(t[n]={}),l=function(e){return Se(e)?("descending"===e.order?"-":"+")+s5(e.op,e.field):""}(i),f=E8(a);if(null!=f&&(e=t.scope,u=c[f+=l?"|"+l:""]),!u){var d=i?{field:o5,pulse:t.countsRef(e,a,i)}:{field:e.fieldRef(a),pulse:a5(t.output)};l&&(d.sort=e.sortRef(i)),s=e.add(n5(r,void 0,d)),o&&(t.index[a]=s),u=a5(s),null!=f&&(c[f]=u)}return u}function D8(e,t,n){var r=e.remove,a=e.insert,i=e.toggle,o=e.modify,u=e.values,s=t.add(r5()),c=U2("if("+e.trigger+',modify("'+n+'",'+[a,r,i,o,u].map((function(e){return null==e?"null":e})).join(",")+"),0)",t);s.update=c.$expr,s.params=c.$params}function F8(e,t){var n,r,a,i,o,u,s,c=f8(e),l=e.type===Z6,f=e.from&&e.from.facet,d=e.overlap,h=e.layout||c===z4||c===B4,p=c===Z4||h||f,v=function(e,t,n){var r,a,i,o,u;return e?(r=e.facet)&&(t||se("Only group marks can be faceted."),null!=r.field?o=u=S8(r,n):(e.data?u=a5(n.getData(e.data).aggregate):((i=p8(it({type:"aggregate",groupby:Ye(r.groupby)},r.aggregate),n)).params.key=n.keyRef(r.groupby),i.params.pulse=S8(r,n),o=u=a5(n.add(i))),a=n.keyRef(r.groupby,!0))):o=a5(n.add(T5(null,[{}]))),o||(o=S8(e,n)),{key:a,pulse:o,parent:u}}(e.from,l,t),g=a5(r=t.add(D5({key:v.key||(e.key?i5(e.key):void 0),pulse:v.pulse,clean:!l})));r=a=t.add(T5({pulse:g})),r=t.add(z5({markdef:d8(e),interactive:h8(e.interactive,t),clip:c8(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:a5(r)}));var m=a5(r);(r=i=t.add(F5(Y4(e.encode,e.type,c,e.style,t,{mod:!1,pulse:m})))).params.parent=t.encode(),e.transform&&e.transform.forEach((function(e){var n=p8(e,t),a=n.metadata;(a.generates||a.changes)&&se("Mark transforms should not generate new data."),a.nomod||(i.params.mod=!0),n.params.pulse=a5(r),t.add(r=n)})),e.sort&&(r=t.add(K5({sort:t.compareRef(e.sort),pulse:a5(r)})));var y=a5(r);(f||h)&&(u=a5(h=t.add($5({layout:t.objectProperty(e.layout),legends:t.legends,mark:m,pulse:y}))));var b=t.add(E5({mark:m,pulse:u||y}));s=a5(b),l&&(p&&((n=t.operators).pop(),h&&n.pop()),t.pushState(y,u||s,g),f?function(e,t,n){var r,a=e.from.facet,i=a.name,o=S8(a,t);a.name||se("Facet must have a name: "+Tt(a)),a.data||se("Facet must reference a data set: "+Tt(a)),a.field?r=t.add(W5({field:t.fieldRef(a.field),pulse:o})):a.groupby?r=t.add(M5({key:t.keyRef(a.groupby),group:a5(t.proxy(n.parent)),pulse:o})):se("Facet must specify groupby or field: "+Tt(a));var u=t.fork(),s=u.add(T5()),c=u.add(Y5({pulse:a5(s)}));u.addData(i,new A8(u,s,s,c)),u.addSignal("parent",null),r.params.subflow={$subflow:u.parse(e).toRuntime()}}(e,t,v):p?function(e,t,n){var r=t.add(W5({pulse:n.pulse})),a=t.fork();a.add(Y5()),a.addSignal("parent",null),r.params.subflow={$subflow:a.parse(e).toRuntime()}}(e,t,v):t.parse(e),t.popState(),p&&(h&&n.push(h),n.push(b))),d&&(s=function(e,t,n){var r=e.method,a=e.bound,i=e.separation,o={separation:f5(i)?n.signalRef(i.signal):i,method:f5(r)?n.signalRef(r.signal):r,pulse:t};e.order&&(o.sort=n.compareRef({field:e.order}));if(a){var u=a.tolerance;o.boundTolerance=f5(u)?n.signalRef(u.signal):+u,o.boundScale=n.scaleRef(a.scale),o.boundOrient=a.orient}return a5(n.add(j5(o)))}(d,s,t));var x=t.add(H5({pulse:s})),k=t.add(Y5({pulse:a5(x)},void 0,t.parent()));null!=e.name&&(o=e.name,t.addData(o,new A8(t,a,x,k)),e.on&&e.on.forEach((function(e){(e.insert||e.remove||e.toggle)&&se("Marks only support modify triggers."),D8(e,t,o)})))}function I8(e,t){var n,r,a,i=t.config.legend,o=e.encode||{},u=j6(e,i),s=o.legend||{},c=s.name||void 0,l=s.interactive,f=s.style,d={},h=0;I6.forEach((function(t){return e[t]?(d[t]=e[t],h=h||e[t]):0})),h||se("Missing valid scale for legend.");var p=function(e,t){var n=e.type||T6;e.type||1!==function(e){return I6.reduce((function(t,n){return t+(e[n]?1:0)}),0)}(e)||!e.fill&&!e.stroke||(n=iI(t)?N6:uI(t)?D6:T6);return n!==N6?n:uI(t)?D6:N6}(e,t.scaleType(h)),v={title:null!=e.title,scales:d,type:p,vgrad:"symbol"!==p&&u.isVertical()},g=a5(t.add(T5(null,[v]))),m=a5(t.add(Z5(r={type:p,scale:t.scaleRef(h),count:t.objectProperty(u("tickCount")),limit:t.property(u("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return p===N6?(a=[H6(e,h,i,o.gradient),$6(e,i,o.labels,m)],r.count=r.count||t.signalRef("max(2,2*floor((".concat(p5(u.gradientLength()),")/100))"))):p===D6?a=[X6(e,h,i,o.gradient,m),$6(e,i,o.labels,m)]:(n=function(e,t){var n=j6(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(e,i),a=[Q6(e,i,o,m,p5(n.columns))],r.size=function(e,t,n){var r=p5(O8("size",e,n)),a=p5(O8("strokeWidth",e,n)),i=p5(function(e,t,n){return U6("fontSize",e)||function(e,t,n){var r=t.config.style[n];return r&&r[e]}("fontSize",t,n)}(n[1].encode,t,C6));return U2("max(ceil(sqrt(".concat(r,")+").concat(a,"),").concat(i,")"),t)}(e,t,a[0].marks)),a=[P6({role:"legend-entry",from:g,encode:{enter:{x:{value:0},y:{value:0}}},marks:a,layout:n,interactive:l})],v.title&&a.push(function(e,t,n,r){var a=j6(e,t),i={enter:{opacity:O6},update:{opacity:R6,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:O6}};return M4(i,{orient:a("titleOrient"),_anchor:a("titleAnchor"),anchor:{signal:o8},angle:{signal:u8},align:{signal:i8},baseline:{signal:s8},text:e.title,fill:a("titleColor"),fillOpacity:a("titleOpacity"),font:a("titleFont"),fontSize:a("titleFontSize"),fontStyle:a("titleFontStyle"),fontWeight:a("titleFontWeight"),limit:a("titleLimit"),lineHeight:a("titleLineHeight")},{align:a("titleAlign"),baseline:a("titleBaseline")}),q6({type:L6,role:"legend-title",style:S6,from:r,encode:i},n)}(e,i,o.title,g)),F8(P6({role:"legend",from:g,encode:O4(M8(u,e,i),s,M6),marks:a,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:c,interactive:l,style:f}),t)}function M8(e,t,n){var r={enter:{},update:{}};return M4(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function O8(e,t,n){return t[e]?'scale("'.concat(t[e],'",datum)'):U6(e,n[0].encode)}A8.fromEntries=function(e,t){var n=t.length,r=t[n-1],a=t[n-2],i=t[0],o=null,u=1;for(i&&"load"===i.type&&(i=t[1]),e.add(t[0]);u<n;++u)t[u].params.pulse=a5(t[u-1]),e.add(t[u]),"aggregate"===t[u].type&&(o=t[u]);return new A8(e,i,a,r,o)},A8.prototype={countsRef:function(e,t,n){var r,a,i,o=this,u=o.counts||(o.counts={}),s=E8(t);return null!=s&&(e=o.scope,r=u[s]),r?n&&n.field&&T8(e,r.agg.params,n):(i={groupby:e.fieldRef(t,"key"),pulse:a5(o.output)},n&&n.field&&T8(e,i,n),a=e.add(S5(i)),r=e.add(T5({pulse:a5(a)})),r={agg:a,ref:a5(r)},null!=s&&(u[s]=r)),r.ref},tuplesRef:function(){return a5(this.values)},extentRef:function(e,t){return N8(e,this,"extent","extent",t,!1)},domainRef:function(e,t){return N8(e,this,"domain","values",t,!1)},valuesRef:function(e,t,n){return N8(e,this,"vals","values",t,n||!0)},lookupRef:function(e,t){return N8(e,this,"lookup","tupleindex",t,!1)},indataRef:function(e,t){return N8(e,this,"indata","tupleindex",t,!0,!0)}};var R8='item.orient==="'.concat(g6,'"?-90:item.orient==="').concat(m6,'"?90:0');function Z8(e,t){var n=j6(e=xt(e)?{text:e}:e,t.config.title),r=e.encode||{},a=r.group||{},i=a.name||void 0,o=a.interactive,u=a.style,s=[],c=a5(t.add(T5(null,[{}])));return s.push(function(e,t,n,r){var a={value:0},i=e.text,o={enter:{opacity:a},update:{opacity:{value:1}},exit:{opacity:a}};return M4(o,{text:i,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),q6({type:L6,role:P4,style:A6,from:r,encode:o},n)}(e,n,function(e){var t=e.encode;return t&&t.title||it({name:e.name,interactive:e.interactive,style:e.style},t)}(e),c)),e.subtitle&&s.push(function(e,t,n,r){var a={value:0},i=e.subtitle,o={enter:{opacity:a},update:{opacity:{value:1}},exit:{opacity:a}};return M4(o,{text:i,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),q6({type:L6,role:j4,style:E6,from:r,encode:o},n)}(e,n,r.subtitle,c)),F8(P6({role:"title",from:c,encode:B8(n,a),marks:s,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:i,interactive:o,style:u}),t)}function B8(e,t){var n={enter:{},update:{}};return M4(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:V6},angle:{signal:R8},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),O4(n,t,M6)}function z8(e,t){var n=[];e.transform&&e.transform.forEach((function(e){n.push(p8(e,t))})),e.on&&e.on.forEach((function(n){D8(n,t,e.name)})),t.addDataPipeline(e.name,function(e,t,n){var r,a,i,o,u,s=[],c=null,l=!1,f=!1;e.values?f5(e.values)||d5(e.format)?(s.push(P8(t,e)),s.push(c=L8())):s.push(c=L8({$ingest:e.values,$format:e.format})):e.url?d5(e.url)||d5(e.format)?(s.push(P8(t,e)),s.push(c=L8())):s.push(c=L8({$request:e.url,$format:e.format})):e.source&&(c=r=Ye(e.source).map((function(e){return a5(t.getData(e).output)})),s.push(null));for(a=0,i=n.length;a<i;++a)u=(o=n[a]).metadata,c||u.source||s.push(c=L8()),s.push(o),u.generates&&(f=!0),u.modifies&&!f&&(l=!0),u.source?c=o:u.changes&&(c=null);r&&(i=r.length-1,s[0]=q5({derive:l,pulse:i?r:r[0]}),(l||i)&&s.splice(1,0,L8()));c||s.push(L8());return s.push(Y5({})),s}(e,t,n))}function L8(e){var t=T5({},e);return t.metadata={source:!0},t}function P8(e,t){return B5({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}var j8=function(e){return e===y6||e===v6},U8=function(e,t,n){return f5(e)?X8(e.signal,t,n):e===g6||e===v6?t:n},W8=function(e,t,n){return f5(e)?q8(e.signal,t,n):j8(e)?t:n},V8=function(e,t,n){return f5(e)?H8(e.signal,t,n):j8(e)?n:t},G8=function(e,t,n){return f5(e)?Y8(e.signal,t,n):e===v6?{value:t}:{value:n}},q8=function(e,t,n){return $8("".concat(e," === '").concat(v6,"' || ").concat(e," === '").concat(y6,"'"),t,n)},H8=function(e,t,n){return $8("".concat(e," !== '").concat(v6,"' && ").concat(e," !== '").concat(y6,"'"),t,n)},X8=function(e,t,n){return J8("".concat(e," === '").concat(g6,"' || ").concat(e," === '").concat(v6,"'"),t,n)},Y8=function(e,t,n){return J8("".concat(e," === '").concat(v6,"'"),t,n)},K8=function(e,t,n){return J8("".concat(e," === '").concat(m6,"'"),t,n)},$8=function(e,t,n){return t=null!=t?F4(t):t,n=null!=n?F4(n):n,Q8(t)&&Q8(n)?(t=t?t.signal||Tt(t.value):null,n=n?n.signal||Tt(n.value):null,{signal:"".concat(e," ? (").concat(t,") : (").concat(n,")")}):[it({test:e},t)].concat(n||[])},Q8=function(e){return null==e||1===Object.keys(e).length},J8=function(e,t,n){return{signal:"".concat(e," ? (").concat(t7(t),") : (").concat(t7(n),")")}},e7=function(e,t,n,r,a){return{signal:(null!=r?"".concat(e," === '").concat(g6,"' ? (").concat(t7(r),") : "):"")+(null!=n?"".concat(e," === '").concat(y6,"' ? (").concat(t7(n),") : "):"")+(null!=a?"".concat(e," === '").concat(m6,"' ? (").concat(t7(a),") : "):"")+(null!=t?"".concat(e," === '").concat(v6,"' ? (").concat(t7(t),") : "):"")+"(null)"}},t7=function(e){return f5(e)?e.signal:null==e?null:Tt(e)},n7=function(e,t){var n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function r7(e,t,n,r){var a;if(t&&ct(t,e))return t[e];if(ct(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":a="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":a=e[5].toLowerCase()+e.slice(6)}return r[S6][a]}if(e.startsWith("label")){switch(e){case"labelColor":a="fill";break;case"labelFont":case"labelFontSize":a=e[5].toLowerCase()+e.slice(6)}return r[C6][a]}return null}function a7(e){var t,n={},r=(0,Zt.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a)for(var i in a)n[i]=1}}catch(o){r.e(o)}finally{r.f()}return Object.keys(n)}function i7(e,t){return{scale:e.scale,range:t}}function o7(e,t,n,r,a){var i,o,u,s=j6(e,t),c=e.orient,l=e.gridScale,f=U8(c,1,-1),d=function(e,t){if(1===t);else if(Se(e)){for(var n=e=it({},e);null!=n.mult;){if(!Se(n.mult))return n.mult=f5(t)?{signal:"(".concat(n.mult,") * (").concat(t.signal,")")}:n.mult*t,e;n=n.mult=it({},n.mult)}n.mult=t}else e=f5(t)?{signal:"(".concat(t.signal,") * (").concat(e||0,")")}:t*(e||0);return e}(e.offset,f),h={enter:i={opacity:O6},update:u={opacity:R6},exit:o={opacity:O6}};M4(h,{stroke:s("gridColor"),strokeCap:s("gridCap"),strokeDash:s("gridDash"),strokeDashOffset:s("gridDashOffset"),strokeOpacity:s("gridOpacity"),strokeWidth:s("gridWidth")});var p={scale:e.scale,field:_6,band:a.band,extra:a.extra,offset:a.offset,round:s("tickRound")},v=W8(c,{signal:"height"},{signal:"width"}),g=l?{scale:l,range:0,mult:f,offset:d}:{value:0,offset:d},m=l?{scale:l,range:1,mult:f,offset:d}:it(v,{mult:f,offset:d});return i.x=u.x=W8(c,p,g),i.y=u.y=V8(c,p,g),i.x2=u.x2=V8(c,m),i.y2=u.y2=W8(c,m),o.x=W8(c,p),o.y=V8(c,p),q6({type:z6,role:"axis-grid",key:_6,from:r,encode:h},n)}function u7(e,t,n,r,a){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+a+")"}}function s7(e,t,n,r,a,i){var o,u=j6(e,t),s=e.orient,c=e.scale,l=U8(s,-1,1),f=p5(u("labelFlush")),d=p5(u("labelFlushOffset")),h=u("labelAlign"),p=u("labelBaseline"),v=0===f||!!f,g=F4(a);g.mult=l,g.offset=F4(u("labelPadding")||0),g.offset.mult=l;var m={scale:c,field:_6,band:.5,offset:G6(i.offset,u("labelOffset"))},y=W8(s,v?u7(c,f,'"left"','"right"','"center"'):{value:"center"},function(e,t,n){return f5(e)?K8(e.signal,t,n):e===m6?{value:t}:{value:n}}(s,"left","right")),b=W8(s,G8(s,"bottom","top"),v?u7(c,f,'"top"','"bottom"','"middle"'):{value:"middle"}),x=u7(c,f,"-(".concat(d,")"),d,0);v=v&&d;var k={opacity:O6,x:W8(s,m,g),y:V8(s,m,g)},w={enter:k,update:o={opacity:R6,text:{field:k6},x:k.x,y:k.y,align:y,baseline:b},exit:{opacity:O6,x:k.x,y:k.y}};M4(w,{dx:!h&&v?W8(s,x):null,dy:!p&&v?V8(s,x):null}),M4(w,{angle:u("labelAngle"),fill:u("labelColor"),fillOpacity:u("labelOpacity"),font:u("labelFont"),fontSize:u("labelFontSize"),fontWeight:u("labelFontWeight"),fontStyle:u("labelFontStyle"),limit:u("labelLimit"),lineHeight:u("labelLineHeight")},{align:h,baseline:p});var _=u("labelBound"),C=u("labelOverlap");return C=C||_?{separation:u("labelSeparation"),method:C,order:"datum.index",bound:_?{scale:c,orient:s,tolerance:_}:null}:void 0,o.align!==y&&(o.align=n7(o.align,y)),o.baseline!==b&&(o.baseline=n7(o.baseline,b)),q6({type:L6,role:"axis-label",style:C6,key:_6,from:r,encode:w,overlap:C},n)}function c7(e,t,n,r){var a,i,o=j6(e,t),u=e.orient,s=U8(u,-1,1),c={enter:a={opacity:O6,anchor:F4(o("titleAnchor",null)),align:{signal:V6}},update:i=it({},a,{opacity:R6,text:F4(e.title)}),exit:{opacity:O6}},l={signal:'lerp(range("'.concat(e.scale,'"), ').concat(W6(0,1,.5),")")};return i.x=W8(u,l),i.y=V8(u,l),a.angle=W8(u,O6,function(e,t){return 0===t?0:f5(e)?{signal:"(".concat(e.signal,") * ").concat(t)}:{value:e*t}}(s,90)),a.baseline=W8(u,G8(u,y6,v6),{value:y6}),i.angle=a.angle,i.baseline=a.baseline,M4(c,{fill:o("titleColor"),fillOpacity:o("titleOpacity"),font:o("titleFont"),fontSize:o("titleFontSize"),fontStyle:o("titleFontStyle"),fontWeight:o("titleFontWeight"),limit:o("titleLimit"),lineHeight:o("titleLineHeight")},{align:o("titleAlign"),angle:o("titleAngle"),baseline:o("titleBaseline")}),function(e,t,n,r){var a=function(e,t){return null!=e?(n.update[t]=n7(F4(e),n.update[t]),!1):!R4(t,r)},i=a(e("titleX"),"x"),o=a(e("titleY"),"y");n.enter.auto=o===i?F4(o):W8(t,F4(o),F4(i))}(o,u,c,n),c.update.align=n7(c.update.align,a.align),c.update.angle=n7(c.update.angle,a.angle),c.update.baseline=n7(c.update.baseline,a.baseline),q6({type:L6,role:"axis-title",style:S6,from:r,encode:c},n)}function l7(e,t){var n,r=function(e,t){var n,r,a,i=t.config,o=i.style,u=i.axis,s="band"===t.scaleType(e.scale)&&i.axisBand,c=e.orient;if(f5(c)){var l=a7([i.axisX,i.axisY]),f=a7([i.axisTop,i.axisBottom,i.axisLeft,i.axisRight]);n={};var d,h=(0,Zt.Z)(l);try{for(h.s();!(d=h.n()).done;)n[a=d.value]=W8(c,r7(a,i.axisX,u,o),r7(a,i.axisY,u,o))}catch(g){h.e(g)}finally{h.f()}r={};var p,v=(0,Zt.Z)(f);try{for(v.s();!(p=v.n()).done;)r[a=p.value]=e7(c.signal,r7(a,i.axisTop,u,o),r7(a,i.axisBottom,u,o),r7(a,i.axisLeft,u,o),r7(a,i.axisRight,u,o))}catch(g){v.e(g)}finally{v.f()}}else n=c===v6||c===y6?i.axisX:i.axisY,r=i["axis"+c[0].toUpperCase()+c.slice(1)];return n||r||s?it({},u,n,r,s):u}(e,t),a=e.encode||{},i=a.axis||{},o=i.name||void 0,u=i.interactive,s=i.style,c=j6(e,r),l=function(e){var t,n,r=e("tickBand"),a=e("tickOffset");return r?r.signal?(t={signal:"(".concat(r.signal,") === 'extent' ? 1 : 0.5")},n={signal:"(".concat(r.signal,") === 'extent'")},Se(a)||(a={signal:"(".concat(r.signal,") === 'extent' ? 0 : ").concat(a)})):"extent"===r?(t=1,n=!0,a=0):(t=.5,n=!1):(t=e("bandPosition"),n=e("tickExtra")),{extra:n,band:t,offset:a}}(c),f={scale:e.scale,ticks:!!c("ticks"),labels:!!c("labels"),grid:!!c("grid"),domain:!!c("domain"),title:null!=e.title},d=a5(t.add(T5({},[f]))),h=a5(t.add(A5({scale:t.scaleRef(e.scale),extra:t.property(l.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),p=[];return f.grid&&p.push(o7(e,r,a.grid,h,l)),f.ticks&&(n=c("tickSize"),p.push(function(e,t,n,r,a,i){var o,u,s,c=j6(e,t),l=e.orient,f=U8(l,-1,1),d={enter:o={opacity:O6},update:s={opacity:R6},exit:u={opacity:O6}};M4(d,{stroke:c("tickColor"),strokeCap:c("tickCap"),strokeDash:c("tickDash"),strokeDashOffset:c("tickDashOffset"),strokeOpacity:c("tickOpacity"),strokeWidth:c("tickWidth")});var h=F4(a);h.mult=f;var p={scale:e.scale,field:_6,band:i.band,extra:i.extra,offset:i.offset,round:c("tickRound")};return s.y=o.y=W8(l,O6,p),s.y2=o.y2=W8(l,h),u.x=W8(l,p),s.x=o.x=V8(l,O6,p),s.x2=o.x2=V8(l,h),u.y=V8(l,p),q6({type:z6,role:"axis-tick",key:_6,from:r,encode:d},n)}(e,r,a.ticks,h,n,l))),f.labels&&(n=f.ticks?n:0,p.push(s7(e,r,a.labels,h,n,l))),f.domain&&p.push(function(e,t,n,r){var a,i,o=j6(e,t),u=e.orient,s={enter:a={opacity:O6},update:i={opacity:R6},exit:{opacity:O6}};M4(s,{stroke:o("domainColor"),strokeCap:o("domainCap"),strokeDash:o("domainDash"),strokeDashOffset:o("domainDashOffset"),strokeWidth:o("domainWidth"),strokeOpacity:o("domainOpacity")});var c=i7(e,0),l=i7(e,1);return a.x=i.x=W8(u,c,O6),a.x2=i.x2=W8(u,l),a.y=i.y=V8(u,c,O6),a.y2=i.y2=V8(u,l),q6({type:z6,role:"axis-domain",from:r,encode:s},n)}(e,r,a.domain,d)),f.title&&p.push(c7(e,r,a.title,d)),F8(P6({role:"axis",from:d,encode:O4(f7(c,e),i,M6),marks:p,aria:c("aria"),description:c("description"),zindex:c("zindex"),name:o,interactive:u,style:s}),t)}function f7(e,t){var n={enter:{},update:{}};return M4(n,{orient:e("orient"),offset:e("offset")||0,position:h5(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:'abs(span(range("'.concat(t.scale,'")))')},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function d7(e,t,n){var r=Ye(e.signals),a=Ye(e.scales);return n||r.forEach((function(e){return e5(e,t)})),Ye(e.projections).forEach((function(e){return function(e,t){var n=t.config.projection||{},r={};for(var a in e)"name"!==a&&(r[a]=p6(e[a],a,t));for(var i in n)null==r[i]&&(r[i]=p6(n[i],i,t));t.addProjection(e.name,r)}(e,t)})),a.forEach((function(e){return function(e,t){var n=e.type||"linear";rI(n)||se("Unrecognized scale type: "+Tt(n)),t.addScale(e.name,{type:n,domain:void 0})}(e,t)})),Ye(e.data).forEach((function(e){return z8(e,t)})),a.forEach((function(e){return t6(e,t)})),(n||r).forEach((function(e){return function(e,t){var n=t.getSignal(e.name),r=e.update;e.init&&(r?se("Signals can not include both init and update expressions."):(r=e.init,n.initonly=!0)),r&&(r=U2(r,t),n.update=r.$expr,n.params=r.$params),e.on&&e.on.forEach((function(e){return w5(e,t,n.id)}))}(e,t)})),Ye(e.axes).forEach((function(e){return l7(e,t)})),Ye(e.marks).forEach((function(e){return F8(e,t)})),Ye(e.legends).forEach((function(e){return I8(e,t)})),e.title&&Z8(e.title,t),t.parseLambdas(),t}function h7(e,t){var n=t.config,r=a5(t.root=t.add(r5())),a=function(e,t){var n=function(n){return h5(e[n],t[n])},r=[p7("background",n("background")),p7("autosize",T4(n("autosize"))),p7("padding",D4(n("padding"))),p7("width",n("width")||0),p7("height",n("height")||0)],a=r.reduce((function(e,t){return e[t.name]=t,e}),{}),i={};return Ye(e.signals).forEach((function(e){ct(a,e.name)?e=it(a[e.name],e):r.push(e),i[e.name]=e})),Ye(t.signals).forEach((function(e){ct(i,e.name)||ct(a,e.name)||r.push(e)})),r}(e,n);a.forEach((function(e){return e5(e,t)})),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;var i=t.add(T5()),o=t.add(F5(Y4(function(e){return O4({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e)}(e.encode),Z6,B4,e.style,t,{pulse:a5(i)}))),u=t.add($5({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:r,pulse:a5(o)}));t.operators.pop(),t.pushState(a5(o),a5(u),null),d7(e,t,a),t.operators.push(u);var s=t.add(E5({mark:r,pulse:a5(u)}));return s=t.add(H5({pulse:a5(s)})),s=t.add(Y5({pulse:a5(s)})),t.addData("root",new A8(t,i,i,s)),t}function p7(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function v7(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function g7(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function m7(e){return(Ce(e)?y7:b7)(e)}function y7(e){for(var t=e.length,n="[",r=0;r<t;++r){var a=e[r];n+=(r>0?",":"")+(Se(a)?a.signal||m7(a):Tt(a))}return n+"]"}function b7(e){var t,n,r="{",a=0;for(t in e)n=e[t],r+=(++a>1?",":"")+Tt(t)+":"+(Se(n)?n.signal||m7(n):Tt(n));return r+"}"}function x7(e,t,n){return Se(e)||se("Input Vega specification must be an object."),t=Ee(function(){var e="sans-serif",t="#4c78a8",n="#000",r="#888",a="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:t},area:{fill:t},image:null,line:{stroke:t,strokeWidth:2},path:{stroke:t},rect:{fill:t},rule:{stroke:n},shape:{stroke:t},symbol:{fill:t,size:64},text:{fill:n,font:e,fontSize:11},trail:{fill:t,size:2},style:{"guide-label":{fill:n,font:e,fontSize:10},"guide-title":{fill:n,font:e,fontSize:11,fontWeight:"bold"},"group-title":{fill:n,font:e,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:n,font:e,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:a}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:r,grid:!1,gridWidth:1,gridColor:a,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:r,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:a,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:r,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),t,e.config),h7(e,new v7(t,n)).toRuntime()}v7.prototype=g7.prototype={parse:function(e){return d7(e,this)},fork:function(){return new g7(this)},isSubscope:function(){return this._subid>0},toRuntime:function(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id:function(){return(this._subid?this._subid+":":0)+this._id++},add:function(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach((function(t){t.$ref=e.id})),e.refs=null),e},proxy:function(e){var t=e instanceof t5?a5(e):e;return this.add(G5({value:t}))},addStream:function(e){return this.streams.push(e),e.id=this.id(),e},addUpdate:function(e){return this.updates.push(e),e},finish:function(){var e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(e,t,n){var r;e&&((r=e.data||(e.data={}))[t]||(r[t]=[])).push(n)}for(e in this.data)for(var r in n((t=this.data[e]).input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values"),t.index)n(t.index[r],e,"index:"+r);return this},pushState:function(e,t,n){this._encode.push(a5(this.add(Y5({pulse:e})))),this._parent.push(t),this._lookup.push(n?a5(this.proxy(n)):null),this._markpath.push(-1)},popState:function(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent:function(){return De(this._parent)},encode:function(){return De(this._encode)},lookup:function(){return De(this._lookup)},markpath:function(){var e=this._markpath;return++e[e.length-1]},fieldRef:function(e,t){if(xt(e))return i5(e,t);e.signal||se("Unsupported field reference: "+Tt(e));var n=e.signal,r=this.field[n];if(!r){var a={name:this.signalRef(n)};t&&(a.as=t),this.field[n]=r=a5(this.add(O5(a)))}return r},compareRef:function(e){var t=this,n=!1,r=function(e){return f5(e)?(n=!0,t.signalRef(e.signal)):function(e){return e&&e.expr}(e)?(n=!0,t.exprRef(e.expr)):e},a=Ye(e.field).map(r),i=Ye(e.order).map(r);return n?a5(this.add(N5({fields:a,orders:i}))):u5(a,i)},keyRef:function(e,t){var n=!1,r=this.signals;return e=Ye(e).map((function(e){return f5(e)?(n=!0,a5(r[e.signal])):e})),n?a5(this.add(R5({fields:e,flat:t}))):function(e,t){var n={$key:e};return t&&(n.$flat=!0),n}(e,t)},sortRef:function(e){if(!e)return e;var t=s5(e.op,e.field),n=e.order||"ascending";return n.signal?a5(this.add(N5({fields:t,orders:this.signalRef(n.signal)}))):u5(t,n)},event:function(e,t){var n=e+":"+t;if(!this.events[n]){var r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal:function(e){return ct(this.signals,e)},addSignal:function(e,t){this.hasOwnSignal(e)&&se("Duplicate signal name: "+Tt(e));var n=t instanceof t5?t:this.add(r5(t));return this.signals[e]=n},getSignal:function(e){return this.signals[e]||se("Unrecognized signal name: "+Tt(e)),this.signals[e]},signalRef:function(e){return this.signals[e]?a5(this.signals[e]):(ct(this.lambdas,e)||(this.lambdas[e]=this.add(r5(null))),a5(this.lambdas[e]))},parseLambdas:function(){for(var e=Object.keys(this.lambdas),t=0,n=e.length;t<n;++t){var r=e[t],a=U2(r,this),i=this.lambdas[r];i.params=a.$params,i.update=a.$expr}},property:function(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty:function(e){return e&&Se(e)?this.signalRef(e.signal||m7(e)):e},exprRef:function(e,t){var n={expr:U2(e,this)};return t&&(n.expr.$name=t),a5(this.add(I5(n)))},addBinding:function(e,t){this.bindings||se("Nested signals do not support binding: "+Tt(e)),this.bindings.push(it({signal:e},t))},addScaleProj:function(e,t){ct(this.scales,e)&&se("Duplicate scale or projection name: "+Tt(e)),this.scales[e]=this.add(t)},addScale:function(e,t){this.addScaleProj(e,X5(t))},addProjection:function(e,t){this.addScaleProj(e,V5(t))},getScale:function(e){return this.scales[e]||se("Unrecognized scale name: "+Tt(e)),this.scales[e]},scaleRef:function(e){return a5(this.getScale(e))},scaleType:function(e){return this.getScale(e).params.type},projectionRef:function(e){return this.scaleRef(e)},projectionType:function(e){return this.scaleType(e)},addData:function(e,t){return ct(this.data,e)&&se("Duplicate data set name: "+Tt(e)),this.data[e]=t},getData:function(e){return this.data[e]||se("Undefined data set name: "+Tt(e)),this.data[e]},addDataPipeline:function(e,t){return ct(this.data,e)&&se("Duplicate data set name: "+Tt(e)),this.addData(e,A8.fromEntries(this,t))}};var k7,w7,_7,C7,S7,A7="Property",E7="ArrayExpression",T7="BinaryExpression",N7="CallExpression",D7="ConditionalExpression",F7="LogicalExpression",I7="MemberExpression",M7="ObjectExpression",O7="UnaryExpression";function R7(e){this.type=e}R7.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(n=0,r=(t=function(e){switch(e.type){case E7:return e.elements;case T7:case F7:return[e.left,e.right];case N7:return[e.callee].concat(e.arguments);case D7:return[e.test,e.consequent,e.alternate];case I7:return[e.object,e.property];case M7:return e.properties;case A7:return[e.key,e.value];case O7:return[e.argument];default:return[]}}(this)).length;n<r;++n)if(t[n].visit(e))return 1};(k7={})[1]="Boolean",k7[2]="<end>",k7[3]="Identifier",k7[4]="Keyword",k7[5]="Null",k7[6]="Numeric",k7[7]="Punctuator",k7[8]="String",k7[9]="RegularExpression";var Z7="Identifier",B7="Unexpected token %0",z7="Invalid regular expression",L7="Invalid regular expression: missing /",P7="Octal literals are not allowed in strict mode.",j7="ILLEGAL",U7="Disabled.",W7=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),V7=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function G7(e,t){if(!e)throw new Error("ASSERT: "+t)}function q7(e){return e>=48&&e<=57}function H7(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function X7(e){return"01234567".indexOf(e)>=0}function Y7(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function K7(e){return 10===e||13===e||8232===e||8233===e}function $7(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&W7.test(String.fromCharCode(e))}function Q7(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&V7.test(String.fromCharCode(e))}var J7={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function e9(){for(;_7<C7;){var e=w7.charCodeAt(_7);if(!Y7(e)&&!K7(e))break;++_7}}function t9(e){var t,n,r,a=0;for(n="u"===e?4:2,t=0;t<n;++t)_7<C7&&H7(w7[_7])?(r=w7[_7++],a=16*a+"0123456789abcdef".indexOf(r.toLowerCase())):m9({},B7,j7);return String.fromCharCode(a)}function n9(){var e,t,n,r;for(t=0,"}"===(e=w7[_7])&&m9({},B7,j7);_7<C7&&H7(e=w7[_7++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&m9({},B7,j7),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function r9(){var e,t;for(e=w7.charCodeAt(_7++),t=String.fromCharCode(e),92===e&&(117!==w7.charCodeAt(_7)&&m9({},B7,j7),++_7,(e=t9("u"))&&"\\"!==e&&$7(e.charCodeAt(0))||m9({},B7,j7),t=e);_7<C7&&Q7(e=w7.charCodeAt(_7));)++_7,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==w7.charCodeAt(_7)&&m9({},B7,j7),++_7,(e=t9("u"))&&"\\"!==e&&Q7(e.charCodeAt(0))||m9({},B7,j7),t+=e);return t}function a9(){var e,t;return e=_7,t=92===w7.charCodeAt(_7)?r9():function(){var e,t;for(e=_7++;_7<C7;){if(92===(t=w7.charCodeAt(_7)))return _7=e,r9();if(!Q7(t))break;++_7}return w7.slice(e,_7)}(),{type:1===t.length?3:J7.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3,value:t,start:e,end:_7}}function i9(){var e,t,n,r,a=_7,i=w7.charCodeAt(_7),o=w7[_7];switch(i){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++_7,{type:7,value:String.fromCharCode(i),start:a,end:_7};default:if(61===(e=w7.charCodeAt(_7+1)))switch(i){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return _7+=2,{type:7,value:String.fromCharCode(i)+String.fromCharCode(e),start:a,end:_7};case 33:case 61:return _7+=2,61===w7.charCodeAt(_7)&&++_7,{type:7,value:w7.slice(a,_7),start:a,end:_7}}}return">>>="===(r=w7.substr(_7,4))?{type:7,value:r,start:a,end:_7+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:a,end:_7+=3}:o===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===t?{type:7,value:t,start:a,end:_7+=2}:("//"===t&&m9({},B7,j7),"<>=!+-*%&|^/".indexOf(o)>=0?{type:7,value:o,start:a,end:++_7}:void m9({},B7,j7))}function o9(){var e,t,n;if(G7(q7((n=w7[_7]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=_7,e="","."!==n){if(e=w7[_7++],n=w7[_7],"0"===e){if("x"===n||"X"===n)return++_7,function(e){for(var t="";_7<C7&&H7(w7[_7]);)t+=w7[_7++];return 0===t.length&&m9({},B7,j7),$7(w7.charCodeAt(_7))&&m9({},B7,j7),{type:6,value:parseInt("0x"+t,16),start:e,end:_7}}(t);if(X7(n))return function(e){for(var t="0"+w7[_7++];_7<C7&&X7(w7[_7]);)t+=w7[_7++];return($7(w7.charCodeAt(_7))||q7(w7.charCodeAt(_7)))&&m9({},B7,j7),{type:6,value:parseInt(t,8),octal:!0,start:e,end:_7}}(t);n&&q7(n.charCodeAt(0))&&m9({},B7,j7)}for(;q7(w7.charCodeAt(_7));)e+=w7[_7++];n=w7[_7]}if("."===n){for(e+=w7[_7++];q7(w7.charCodeAt(_7));)e+=w7[_7++];n=w7[_7]}if("e"===n||"E"===n)if(e+=w7[_7++],"+"!==(n=w7[_7])&&"-"!==n||(e+=w7[_7++]),q7(w7.charCodeAt(_7)))for(;q7(w7.charCodeAt(_7));)e+=w7[_7++];else m9({},B7,j7);return $7(w7.charCodeAt(_7))&&m9({},B7,j7),{type:6,value:parseFloat(e),start:t,end:_7}}function u9(){var e,t,n,r;return S7=null,e9(),e=_7,t=function(){var e,t,n,r;for(G7("/"===(e=w7[_7]),"Regular expression literal must start with a slash"),t=w7[_7++],n=!1,r=!1;_7<C7;)if(t+=e=w7[_7++],"\\"===e)K7((e=w7[_7++]).charCodeAt(0))&&m9({},L7),t+=e;else if(K7(e.charCodeAt(0)))m9({},L7);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||m9({},L7),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";_7<C7&&Q7((e=w7[_7]).charCodeAt(0));)++_7,"\\"===e&&_7<C7?m9({},B7,j7):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&m9({},z7,n),{value:n,literal:t}}(),r=function(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111)return"x";m9({},z7)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){m9({},z7)}try{return new RegExp(e,t)}catch(a){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:_7}}function s9(){if(e9(),_7>=C7)return{type:2,start:_7,end:_7};var e=w7.charCodeAt(_7);return $7(e)?a9():40===e||41===e||59===e?i9():39===e||34===e?function(){var e,t,n,r,a="",i=!1;for(G7("'"===(e=w7[_7])||'"'===e,"String literal must starts with a quote"),t=_7,++_7;_7<C7;){if((n=w7[_7++])===e){e="";break}if("\\"===n)if((n=w7[_7++])&&K7(n.charCodeAt(0)))"\r"===n&&"\n"===w7[_7]&&++_7;else switch(n){case"u":case"x":"{"===w7[_7]?(++_7,a+=n9()):a+=t9(n);break;case"n":a+="\n";break;case"r":a+="\r";break;case"t":a+="\t";break;case"b":a+="\b";break;case"f":a+="\f";break;case"v":a+="\v";break;default:X7(n)?(0!==(r="01234567".indexOf(n))&&(i=!0),_7<C7&&X7(w7[_7])&&(i=!0,r=8*r+"01234567".indexOf(w7[_7++]),"0123".indexOf(n)>=0&&_7<C7&&X7(w7[_7])&&(r=8*r+"01234567".indexOf(w7[_7++]))),a+=String.fromCharCode(r)):a+=n}else{if(K7(n.charCodeAt(0)))break;a+=n}}return""!==e&&m9({},B7,j7),{type:8,value:a,octal:i,start:t,end:_7}}():46===e?q7(w7.charCodeAt(_7+1))?o9():i9():q7(e)?o9():i9()}function c9(){var e=S7;return _7=e.end,S7=s9(),_7=e.end,e}function l9(){var e=_7;S7=s9(),_7=e}function f9(e,t,n){var r=new R7("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return r.operator=e,r.left=t,r.right=n,r}function d9(e,t){var n=new R7("CallExpression");return n.callee=e,n.arguments=t,n}function h9(e){var t=new R7(Z7);return t.name=e,t}function p9(e){var t=new R7("Literal");return t.value=e.value,t.raw=w7.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function v9(e,t,n){var r=new R7("MemberExpression");return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function g9(e,t,n){var r=new R7("Property");return r.key=t,r.value=n,r.kind=e,r}function m9(e,t){var n,r=Array.prototype.slice.call(arguments,2),a=t.replace(/%(\d)/g,(function(e,t){return G7(t<r.length,"Message reference must be in range"),r[t]}));throw(n=new Error(a)).index=_7,n.description=a,n}function y9(e){2===e.type&&m9(e,"Unexpected end of input"),6===e.type&&m9(e,"Unexpected number"),8===e.type&&m9(e,"Unexpected string"),3===e.type&&m9(e,"Unexpected identifier"),4===e.type&&m9(e,"Unexpected reserved word"),m9(e,B7,e.value)}function b9(e){var t=c9();7===t.type&&t.value===e||y9(t)}function x9(e){return 7===S7.type&&S7.value===e}function k9(e){return 4===S7.type&&S7.value===e}function w9(){var e=[];for(_7=S7.start,b9("[");!x9("]");)x9(",")?(c9(),e.push(null)):(e.push(O9()),x9("]")||b9(","));return c9(),function(e){var t=new R7("ArrayExpression");return t.elements=e,t}(e)}function _9(){_7=S7.start;var e=c9();return 8===e.type||6===e.type?(e.octal&&m9(e,P7),p9(e)):h9(e.value)}function C9(){var e,t,n;return _7=S7.start,3===(e=S7).type?(n=_9(),b9(":"),g9("init",n,O9())):2!==e.type&&7!==e.type?(t=_9(),b9(":"),g9("init",t,O9())):void y9(e)}function S9(){var e,t,n=[],r={},a=String;for(_7=S7.start,b9("{");!x9("}");)t="$"+((e=C9()).key.type===Z7?e.key.name:a(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?m9({},"Duplicate data property in object literal not allowed in strict mode"):r[t]=!0,n.push(e),x9("}")||b9(",");return b9("}"),function(e){var t=new R7("ObjectExpression");return t.properties=e,t}(n)}var A9={if:1};function E9(){var e,t,n;if(x9("("))return function(){b9("(");var e=R9();return b9(")"),e}();if(x9("["))return w9();if(x9("{"))return S9();if(e=S7.type,_7=S7.start,3===e||A9[S7.value])n=h9(c9().value);else if(8===e||6===e)S7.octal&&m9(S7,P7),n=p9(c9());else{if(4===e)throw new Error(U7);1===e?((t=c9()).value="true"===t.value,n=p9(t)):5===e?((t=c9()).value=null,n=p9(t)):x9("/")||x9("/=")?(n=p9(u9()),l9()):y9(c9())}return n}function T9(){var e=[];if(b9("("),!x9(")"))for(;_7<C7&&(e.push(O9()),!x9(")"));)b9(",");return b9(")"),e}function N9(){return b9("."),function(){_7=S7.start;var e=c9();return function(e){return 3===e.type||4===e.type||1===e.type||5===e.type}(e)||y9(e),h9(e.value)}()}function D9(){b9("[");var e=R9();return b9("]"),e}function F9(){var e=function(){var e;for(e=E9();;)if(x9("."))e=v9(".",e,N9());else if(x9("("))e=d9(e,T9());else{if(!x9("["))break;e=v9("[",e,D9())}return e}();if(7===S7.type&&(x9("++")||x9("--")))throw new Error(U7);return e}function I9(){var e,t;if(7!==S7.type&&4!==S7.type)t=F9();else{if(x9("++")||x9("--"))throw new Error(U7);if(x9("+")||x9("-")||x9("~")||x9("!"))e=c9(),t=I9(),t=function(e,t){var n=new R7("UnaryExpression");return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if(k9("delete")||k9("void")||k9("typeof"))throw new Error(U7);t=F9()}}return t}function M9(e){var t=0;if(7!==e.type&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function O9(){var e,t;return e=function(){var e,t,n,r,a,i,o,u,s,c;if(e=S7,s=I9(),0===(a=M9(r=S7)))return s;for(r.prec=a,c9(),t=[e,S7],i=[s,r,o=I9()];(a=M9(S7))>0;){for(;i.length>2&&a<=i[i.length-2].prec;)o=i.pop(),u=i.pop().value,s=i.pop(),t.pop(),n=f9(u,s,o),i.push(n);(r=c9()).prec=a,i.push(r),t.push(S7),n=I9(),i.push(n)}for(n=i[c=i.length-1],t.pop();c>1;)t.pop(),n=f9(i[c-1].value,i[c-2],n),c-=2;return n}(),x9("?")&&(c9(),t=O9(),b9(":"),e=function(e,t,n){var r=new R7("ConditionalExpression");return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,O9())),e}function R9(){var e=O9();if(x9(","))throw new Error(U7);return e}function Z9(e){_7=0,C7=(w7=e).length,S7=null,l9();var t=R9();if(2!==S7.type)throw new Error("Unexpect token after expression.");return t}var B9={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function z9(e){function t(t,n,r){return function(a){return function(t,n,r,a){var i=e(n[0]);return r&&(i=r+"("+i+")",0===r.lastIndexOf("new ",0)&&(i="("+i+")")),i+"."+t+(a<0?"":0===a?"()":"("+n.slice(1).map(e).join(",")+")")}(t,a,n,r)}}var n="new Date",r="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&se("Missing arguments to clamp function."),t.length>3&&se("Too many arguments to clamp function.");var n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:t("getDate",n,0),day:t("getDay",n,0),year:t("getFullYear",n,0),month:t("getMonth",n,0),hours:t("getHours",n,0),minutes:t("getMinutes",n,0),seconds:t("getSeconds",n,0),milliseconds:t("getMilliseconds",n,0),time:t("getTime",n,0),timezoneoffset:t("getTimezoneOffset",n,0),utcdate:t("getUTCDate",n,0),utcday:t("getUTCDay",n,0),utcyear:t("getUTCFullYear",n,0),utcmonth:t("getUTCMonth",n,0),utchours:t("getUTCHours",n,0),utcminutes:t("getUTCMinutes",n,0),utcseconds:t("getUTCSeconds",n,0),utcmilliseconds:t("getUTCMilliseconds",n,0),length:t("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",r,0),lower:t("toLowerCase",r,0),substring:t("substring",r),split:t("split",r),trim:t("trim",r,0),regexp:a,test:t("test",a),if:function(t){t.length<3&&se("Missing arguments to if function."),t.length>3&&se("Too many arguments to if function.");var n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function L9(e){var t=(e=e||{}).allowed?Mt(e.allowed):{},n=e.forbidden?Mt(e.forbidden):{},r=e.constants||B9,a=(e.functions||z9)(f),i=e.globalvar,o=e.fieldvar,u=$e(i)?i:function(e){return"".concat(i,'["').concat(e,'"]')},s={},c={},l=0;function f(e){if(xt(e))return e;var t=d[e.type];return null==t&&se("Unsupported type: "+e.type),t(e)}var d={Literal:function(e){return e.raw},Identifier:function(e){var a=e.name;return l>0?a:ct(n,a)?se("Illegal identifier: "+a):ct(r,a)?r[a]:ct(t,a)?a:(s[a]=1,u(a))},MemberExpression:function(e){var t=!e.computed,n=f(e.object);t&&(l+=1);var r=f(e.property);return n===o&&(c[function(e){var t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(r)]=1),t&&(l-=1),n+(t?"."+r:"["+r+"]")},CallExpression:function(e){"Identifier"!==e.callee.type&&se("Illegal callee type: "+e.callee.type);var t=e.callee.name,n=e.arguments,r=ct(a,t)&&a[t];return r||se("Unrecognized function: "+t),$e(r)?r(n):r+"("+n.map(f).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(f).join(",")+"]"},BinaryExpression:function(e){return"("+f(e.left)+" "+e.operator+" "+f(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+f(e.argument)+")"},ConditionalExpression:function(e){return"("+f(e.test)+"?"+f(e.consequent)+":"+f(e.alternate)+")"},LogicalExpression:function(e){return"("+f(e.left)+e.operator+f(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(f).join(",")+"}"},Property:function(e){l+=1;var t=f(e.key);return l-=1,t+":"+f(e.value)}};function h(e){var t={code:f(e),globals:Object.keys(s),fields:Object.keys(c)};return s={},c={},t}return h.functions=a,h.constants=r,h}var P9,j9,U9="[",W9="]",V9=/[[\]{}]/,G9={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function q9(e,t,n){return P9=t||"view",j9=n||G9,X9(e.trim()).map(Y9)}function H9(e,t,n,r,a){for(var i,o=e.length,u=0;t<o;++t){if(i=e[t],!u&&i===n)return t;a&&a.indexOf(i)>=0?--u:r&&r.indexOf(i)>=0&&++u}return t}function X9(e){for(var t=[],n=e.length,r=0,a=0;a<n;)a=H9(e,a,",","[{","]}"),t.push(e.substring(r,a).trim()),r=++a;if(0===t.length)throw"Empty event selector: "+e;return t}function Y9(e){return"["===e[0]?function(e){var t,n=e.length,r=1;if(r=H9(e,r,W9,U9,W9),r===n)throw"Empty between selector: "+e;if(t=X9(e.substring(1,r)),2!==t.length)throw"Between selector must have two elements: "+e;if(e=e.slice(r+1).trim(),">"!==e[0])throw"Expected '>' after between selector: "+e;t=t.map(Y9);var a=Y9(e.slice(1).trim());if(a.between)return{between:t,stream:a};a.between=t;return a}(e):function(e){var t,n,r={source:P9},a=[],i=[0,0],o=0,u=0,s=e.length,c=0;if("}"===e[s-1]){if(!((c=e.lastIndexOf("{"))>=0))throw"Unmatched right brace: "+e;try{i=function(e){var t=e.split(",");if(!e.length||t.length>2)throw e;return t.map((function(t){var n=+t;if(n!==n)throw e;return n}))}(e.substring(c+1,s-1))}catch(l){throw"Invalid throttle specification: "+e}s=(e=e.slice(0,c).trim()).length,c=0}if(!s)throw e;"@"===e[0]&&(o=++c);t=H9(e,c,":"),t<s&&(a.push(e.substring(u,t).trim()),u=c=++t);if(c=H9(e,c,U9),c===s)a.push(e.substring(u,s).trim());else if(a.push(e.substring(u,c).trim()),n=[],(u=++c)===s)throw"Unmatched left bracket: "+e;for(;c<s;){if((c=H9(e,c,W9))===s)throw"Unmatched left bracket: "+e;if(n.push(e.substring(u,c).trim()),c<s-1&&e[++c]!==U9)throw"Expected left bracket: "+e;u=++c}if(!(s=a.length)||V9.test(a[s-1]))throw"Invalid event selector: "+e;s>1?(r.type=a[1],o?r.markname=a[0].slice(1):!function(e){return j9[e]}(a[0])?r.source=a[0]:r.marktype=a[0]):r.type=a[0];"!"===r.type.slice(-1)&&(r.consume=!0,r.type=r.type.slice(0,-1));null!=n&&(r.filter=n);i[0]&&(r.throttle=i[0]);i[1]&&(r.debounce=i[1]);return r}(e)}var K9="5.20.0";it(yu,i,u,c,l,f,h,d,p,v,m,y);var $9=K9;function Q9(e,t,n){return e.fields=t||[],e.fname=n,e}function J9(e){return 1===e.length?eee(e[0]):tee(e)}var eee=function(e){return function(t){return t[e]}},tee=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function nee(e){throw Error(e)}function ree(e){var t,n,r,a=[],i=null,o=0,u=e.length,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<u;++n)if("\\"===(r=e[n]))s+=e.substring(t,n),s+=e.substring(++n,++n),t=n;else if(r===i)c(),i=null,o=-1;else{if(i)continue;t===o&&'"'===r||t===o&&"'"===r?(t=n+1,i=r):"."!==r||o?"["===r?(n>t&&c(),o=t=n+1):"]"===r&&(o||nee("Access path missing open bracket: "+e),o>0&&c(),o=0,t=n+1):n>t?c():t=n+1}return o&&nee("Access path missing closing bracket: "+e),i&&nee("Access path missing closing quote: "+e),n>t&&(n++,c()),a}var aee=[],iee=(function(e,t,n){var r=ree(e);e=1===r.length?r[0]:e,Q9((n&&n.get||J9)(r),[e],t||e)}("id"),Q9((function(e){return e}),aee,"identity"));Q9((function(){return 0}),aee,"zero"),Q9((function(){return 1}),aee,"one"),Q9((function(){return!0}),aee,"true"),Q9((function(){return!1}),aee,"false");function oee(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var uee=Array.isArray;function see(e){return e===Object(e)}var cee=function(e){return"__proto__"!==e};function lee(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){for(var n in t)if("signals"===n)e.signals=dee(e.signals,t.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;fee(e,n,t[n],r)}return e}),{})}function fee(e,t,n,r){var a,i;if(cee(t))if(see(n)&&!uee(n))for(a in i=see(e[t])?e[t]:e[t]={},n)r&&(!0===r||r[a])?fee(i,a,n[a]):cee(a)&&(i[a]=n[a]);else e[t]=n}function dee(e,t){if(null==e)return t;var n={},r=[];function a(e){n[e.name]||(n[e.name]=1,r.push(e))}return t.forEach(a),e.forEach(a),r}function hee(e){return null!=e?uee(e)?e:[e]:[]}var pee=Object.prototype.hasOwnProperty;function vee(e,t){return pee.call(e,t)}function gee(e){return"boolean"===typeof e}function mee(e){return"number"===typeof e}function yee(e){return"string"===typeof e}function bee(e){return uee(e)?"["+e.map(bee)+"]":see(e)||yee(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function xee(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t}function kee(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}Object.create;Object.create;Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,(function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var wee=n(3991),_ee=n.n(wee),Cee=n(8262),See=n.n(Cee),Aee=n(2248),Eee=n.n(Aee);function Tee(e){return!!e.or}function Nee(e){return!!e.and}function Dee(e){return!!e.not}function Fee(e,t){if(Dee(e))Fee(e.not,t);else if(Nee(e)){var n,r=(0,Zt.Z)(e.and);try{for(r.s();!(n=r.n()).done;){Fee(n.value,t)}}catch(o){r.e(o)}finally{r.f()}}else if(Tee(e)){var a,i=(0,Zt.Z)(e.or);try{for(i.s();!(a=i.n()).done;){Fee(a.value,t)}}catch(o){i.e(o)}finally{i.f()}}else t(e)}function Iee(e,t){return Dee(e)?{not:Iee(e.not,t)}:Nee(e)?{and:e.and.map((function(e){return Iee(e,t)}))}:Tee(e)?{or:e.or.map((function(e){return Iee(e,t)}))}:t(e)}var Mee=See(),Oee=_ee();function Ree(e,t){var n,r={},a=(0,Zt.Z)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;vee(e,i)&&(r[i]=e[i])}}catch(o){a.e(o)}finally{a.f()}return r}function Zee(e,t){var n,r=Object.assign({},e),a=(0,Zt.Z)(t);try{for(a.s();!(n=a.n()).done;){delete r[n.value]}}catch(i){a.e(i)}finally{a.f()}return r}Set.prototype.toJSON=function(){return"Set(".concat((0,ln.Z)(this).map((function(e){return Eee()(e)})).join(","),")")};var Bee=Eee();function zee(e){if(mee(e))return e;var t=yee(e)?e:Eee()(e);if(t.length<250)return t;for(var n=0,r=0;r<t.length;r++){n=(n<<5)-n+t.charCodeAt(r),n&=n}return n}function Lee(e){return!1===e||null===e}function Pee(e,t){return e.indexOf(t)>-1}function jee(e,t){var n,r=0,a=(0,Zt.Z)(e.entries());try{for(a.s();!(n=a.n()).done;){var i=(0,ku.Z)(n.value,2),o=i[0];if(t(i[1],o,r++))return!0}}catch(u){a.e(u)}finally{a.f()}return!1}function Uee(e,t){var n,r=0,a=(0,Zt.Z)(e.entries());try{for(a.s();!(n=a.n()).done;){var i=(0,ku.Z)(n.value,2),o=i[0];if(!t(i[1],o,r++))return!1}}catch(u){a.e(u)}finally{a.f()}return!0}function Wee(e,t){var n,r=(0,Zt.Z)(Yee(t));try{for(r.s();!(n=r.n()).done;){var a=n.value;fee(e,a,t[a],!0)}}catch(i){r.e(i)}finally{r.f()}}function Vee(e,t){var n,r,a=[],i={},o=(0,Zt.Z)(e);try{for(o.s();!(r=o.n()).done;){var u=r.value;(n=t(u))in i||(i[n]=1,a.push(u))}}catch(s){o.e(s)}finally{o.f()}return a}function Gee(e,t){var n,r=(0,Zt.Z)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(t.has(a))return!0}}catch(i){r.e(i)}finally{r.f()}return!1}function qee(e){var t,n=new Set,r=(0,Zt.Z)(e);try{var a=function(){var e,r=ree(t.value).map((function(e,t){return 0===t?e:"[".concat(e,"]")})),a=r.map((function(e,t){return r.slice(0,t+1).join("")})),i=(0,Zt.Z)(a);try{for(i.s();!(e=i.n()).done;){var o=e.value;n.add(o)}}catch(u){i.e(u)}finally{i.f()}};for(r.s();!(t=r.n()).done;)a()}catch(i){r.e(i)}finally{r.f()}return n}function Hee(e,t){return void 0===e||void 0===t||Gee(qee(e),qee(t))}function Xee(e){return 0===Yee(e).length}var Yee=Object.keys,Kee=Object.values;function $ee(e){var t=[];for(var n in e)vee(e,n)&&t.push({key:n,value:e[n]});return t}function Qee(e){return!0===e||!1===e}function Jee(e){var t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function ete(e,t){return Dee(e)?"!("+ete(e.not,t)+")":Nee(e)?"("+e.and.map((function(e){return ete(e,t)})).join(") && (")+")":Tee(e)?"("+e.or.map((function(e){return ete(e,t)})).join(") || (")+")":t(e)}function tte(e,t){if(0===t.length)return!0;var n=t.shift();return n in e&&tte(e[n],t)&&delete e[n],Xee(e)}function nte(e){return e.charAt(0).toUpperCase()+e.substr(1)}function rte(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum",n=ree(e),r=[],a=1;a<=n.length;a++){var i="[".concat(n.slice(0,a).map(bee).join("]["),"]");r.push("".concat(t).concat(i))}return r.join(" && ")}function ate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum";return"".concat(t,"[").concat(bee(ree(e).join(".")),"]")}function ite(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function ote(e){return"".concat(ree(e).map(ite).join("\\."))}function ute(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function ste(e){return"".concat(ree(e).join("."))}function cte(e){return e?ree(e).length:0}function lte(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,a=t;r<a.length;r++){var i=a[r];if(void 0!==i)return i}}var fte=42;function dte(e){return function(e){return 0===e.indexOf("__")}(e)?e:"__".concat(e)}function hte(e){if(void 0!==e)return(e%360+360)%360}function pte(e){return!!mee(e)||!isNaN(e)&&!isNaN(parseFloat(e))}var vte={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function gte(e){return e&&e.condition}var mte=["domain","grid","labels","ticks","title"],yte={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},bte={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},xte=Object.assign(Object.assign({},bte),{style:1,labelExpr:1,encoding:1});function kte(e){return!!xte[e]}Yee(xte);var wte={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},_te=wte.arc,Cte=wte.area,Ste=wte.bar,Ate=wte.image,Ete=wte.line,Tte=wte.point,Nte=wte.rect,Dte=wte.rule,Fte=wte.text,Ite=wte.tick,Mte=wte.trail,Ote=wte.circle,Rte=wte.square,Zte=wte.geoshape;function Bte(e){return Pee(["line","area","trail"],e)}function zte(e){return Pee(["rect","bar","image","arc"],e)}var Lte=Yee(wte);function Pte(e){return e.type}xee(Lte);var jte=[].concat(["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],["fill","fillOpacity"]),Ute=Yee({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1}),Wte={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},Vte={binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},Gte={binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5};function qte(e){return"mark"in e}var Hte=function(){function e(t,n){(0,Jh.Z)(this,e),this.name=t,this.run=n}return(0,ep.Z)(e,[{key:"hasMatchingType",value:function(e){return!!qte(e)&&function(e){return Pte(e)?e.type:e}(e.mark)===this.name}}]),e}(),Xte={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},Yte={count:1,min:1,max:1};function Kte(e){return!!e&&!!e.argmin}function $te(e){return!!e&&!!e.argmax}Yee(Xte);function Qte(e){return yee(e)&&!!Xte[e]}var Jte=["count","valid","missing","distinct"];function ene(e){return yee(e)&&Pee(Jte,e)}var tne=["count","sum","distinct","valid","missing"],nne=xee(["mean","average","median","q1","q3","min","max"]),rne="row",ane="column",ine="facet",one="x",une="y",sne="x2",cne="y2",lne="radius",fne="radius2",dne="theta",hne="theta2",pne="latitude",vne="longitude",gne="latitude2",mne="longitude2",yne="color",bne="fill",xne="stroke",kne="shape",wne="size",_ne="angle",Cne="opacity",Sne="fillOpacity",Ane="strokeOpacity",Ene="strokeWidth",Tne="strokeDash",Nne="text",Dne="order",Fne="detail",Ine="key",Mne="tooltip",One="href",Rne="url",Zne="description",Bne={theta:1,theta2:1,radius:1,radius2:1};function zne(e){return e in Bne}var Lne={longitude:1,longitude2:1,latitude:1,latitude2:1};var Pne=Yee(Lne),jne=Object.assign(Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),Bne),Lne),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function Une(e){return e===yne||e===bne||e===xne}var Wne={row:1,column:1,facet:1},Vne=Yee(Wne),Gne=Object.assign(Object.assign({},jne),Wne),qne=Yee(Gne),Hne=(Gne.order,Gne.detail,Gne.tooltip,kee(Gne,["order","detail","tooltip"])),Xne=(Hne.row,Hne.column,Hne.facet,kee(Hne,["row","column","facet"]));Yee(Hne),Yee(Xne);function Yne(e){return!!Gne[e]}var Kne=[sne,cne,gne,mne,hne,fne];function $ne(e){return Qne(e)!==e}function Qne(e){switch(e){case sne:return one;case cne:return une;case gne:return pne;case mne:return vne;case hne:return dne;case fne:return lne}return e}function Jne(e){if(zne(e))switch(e){case dne:return"startAngle";case hne:return"endAngle";case lne:return"outerRadius";case fne:return"innerRadius"}return e}function ere(e){switch(e){case one:return sne;case une:return cne;case pne:return gne;case vne:return mne;case dne:return hne;case lne:return fne}}function tre(e){switch(e){case one:case sne:return"width";case une:case cne:return"height"}}Yee(jne),jne.x,jne.y,jne.x2,jne.y2,jne.latitude,jne.longitude,jne.latitude2,jne.longitude2,jne.theta,jne.theta2,jne.radius,jne.radius2;var nre=kee(jne,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),rre=Yee(nre),are={x:1,y:1},ire=Yee(are);function ore(e){return e in are}var ure={theta:1,radius:1},sre=Yee(ure);function cre(e){return"width"===e?one:une}nre.text,nre.tooltip,nre.href,nre.url,nre.description,nre.detail,nre.key,nre.order;var lre=kee(nre,["text","tooltip","href","url","description","detail","key","order"]),fre=Yee(lre);var dre=Object.assign(Object.assign(Object.assign({},are),ure),lre),hre=Yee(dre);function pre(e){return!!dre[e]}function vre(e,t){return function(e){switch(e){case yne:case bne:case xne:case Zne:case Fne:case Ine:case Mne:case One:case Dne:case Cne:case Sne:case Ane:case Ene:case ine:case rne:case ane:return gre;case one:case une:case pne:case vne:return mre;case sne:case cne:case gne:case mne:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case wne:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Tne:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case kne:return{point:"always",geoshape:"always"};case Nne:return{text:"always"};case _ne:return{point:"always",square:"always",text:"always"};case Rne:return{image:"always"};case dne:case lne:return{text:"always",arc:"always"};case hne:case fne:return{arc:"always"}}}(e)[t]}var gre={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},mre=kee(gre,["geoshape"]);function yre(e){switch(e){case one:case une:case dne:case lne:case wne:case _ne:case Ene:case Cne:case Sne:case Ane:case sne:case cne:case hne:case fne:return;case ine:case rne:case ane:case kne:case Tne:case Nne:case Mne:case One:case Rne:case Zne:return"discrete";case yne:case bne:case xne:return"flexible";case pne:case vne:case gne:case mne:case Fne:case Ine:case Dne:return}}function bre(e){return gee(e)&&(e=qoe(e,void 0)),"bin"+Yee(e).map((function(t){return _re(e[t])?Jee("_".concat(t,"_").concat(Object.entries(e[t]))):Jee("_".concat(t,"_").concat(e[t]))})).join("")}function xre(e){return!0===e||wre(e)&&!e.binned}function kre(e){return"binned"===e||wre(e)&&!0===e.binned}function wre(e){return see(e)}function _re(e){return null===e||void 0===e?void 0:e.selection}function Cre(e){switch(e){case rne:case ane:case wne:case yne:case bne:case xne:case Ene:case Cne:case Sne:case Ane:case kne:return 6;case Tne:return 4;default:return 10}}var Sre=n(5647);function Are(e){return"Invalid specification ".concat(JSON.stringify(e),'. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".')}var Ere='Autosize "fit" only works for single views and layered views.';function Tre(e){return"".concat("width"==e?"Width":"Height",' "container" only works for single views and layered views.')}function Nre(e){var t="width"==e?"x":"y";return"".concat("width"==e?"Width":"Height",' "container" only works well with autosize "fit" or "fit-').concat(t,'".')}function Dre(e){return e?'Dropping "fit-'.concat(e,'" because spec has discrete ').concat(tre(e),"."):'Dropping "fit" because spec has discrete size.'}function Fre(e){return'Cannot project a selection on encoding channel "'.concat(e,'", which has no field.')}function Ire(e,t){return'Cannot project a selection on encoding channel "'.concat(e,'" as it uses an aggregate function ("').concat(t,'").')}function Mre(e){return"Selection not supported for ".concat(e," yet.")}function Ore(e){return'The "columns" property cannot be used when "'.concat(e,'" has nested row/column.')}function Rre(e,t,n){return'An ancestor parsed field "'.concat(e,'" as ').concat(n," but a child wants to parse the field as ").concat(t,".")}function Zre(e){return"Ignoring an invalid transform: ".concat(Bee(e),".")}function Bre(e){return"Config.customFormatTypes is not true, thus custom format type and format for channel ".concat(e," are dropped.")}function zre(e){return'Invalid field type "'.concat(e,'".')}function Lre(e,t){var n=t.fill,r=t.stroke;return"Dropping color ".concat(e," as the plot also has ").concat(n&&r?"fill and stroke":n?"fill":"stroke",".")}function Pre(e,t){return"Dropping ".concat(Bee(e),' from channel "').concat(t,'" since it does not contain any data field, datum, value, or signal.')}function jre(e,t,n){return"".concat(e,' dropped as it is incompatible with "').concat(t,'"').concat(n?" when ".concat(n):"",".")}function Ure(e){return"".concat(e," encoding should be discrete (ordinal / nominal / binned).")}function Wre(e,t){return'Using discrete channel "'.concat(e,'" to encode "').concat(t,'" field can be misleading as it does not encode ').concat("ordinal"===t?"order":"magnitude",".")}function Vre(e){return"Using unaggregated domain with raw field has no effect (".concat(Bee(e),").")}function Gre(e){return'Unaggregated domain not applicable for "'.concat(e,'" since it produces values outside the origin domain of the source data.')}function qre(e){return"Unaggregated domain is currently unsupported for log scale (".concat(Bee(e),").")}function Hre(e,t,n){return"".concat(n,"-scale's \"").concat(t,'" is dropped as it does not work with ').concat(e," scale.")}function Xre(e){return'The step for "'.concat(e,'" is dropped because the ').concat("width"===e?"x":"y"," is continuous.")}var Yre="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function Kre(e){return'Cannot stack "'.concat(e,'" if there is already "').concat(e,'2".')}function $re(e){return"Cannot stack non-linear scale (".concat(e,").")}function Qre(e){return'Stacking is applied even though the aggregate function is non-summative ("'.concat(e,'").')}function Jre(e,t){return"Invalid ".concat(e,": ").concat(Bee(t),".")}function eae(e){return"1D error band does not support ".concat(e,".")}function tae(e){return"Channel ".concat(e,' is required for "binned" bin.')}var nae=function(e,t){var n=e||0;return{level:function(e){return arguments.length?(n=+e,this):n},error:function(){return n>=1&&oee(t||"error","ERROR",arguments),this},warn:function(){return n>=2&&oee(t||"warn","WARN",arguments),this},info:function(){return n>=3&&oee(t||"log","INFO",arguments),this},debug:function(){return n>=4&&oee(t||"log","DEBUG",arguments),this}}}(2),rae=nae;function aae(e){return rae=e}function iae(){return rae=nae}function oae(){var e;(e=rae).warn.apply(e,arguments)}function uae(e){if(e&&see(e)){var t,n=(0,Zt.Z)(mae);try{for(n.s();!(t=n.n()).done;){if(t.value in e)return!0}}catch(r){n.e(r)}finally{n.f()}}return!1}var sae=["january","february","march","april","may","june","july","august","september","october","november","december"],cae=sae.map((function(e){return e.substr(0,3)})),lae=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],fae=lae.map((function(e){return e.substr(0,3)}));function dae(e,t){var n=[];if(t&&void 0!==e.day&&Yee(e).length>1&&(oae(function(e){return"Dropping day from datetime ".concat(Bee(e)," as day cannot be combined with other units.")}(e)),delete(e=Oee(e)).day),void 0!==e.year?n.push(e.year):n.push(2012),void 0!==e.month){var r=t?function(e){if(pte(e)&&(e=+e),mee(e))return e-1;var t=e.toLowerCase(),n=sae.indexOf(t);if(-1!==n)return n;var r=t.substr(0,3),a=cae.indexOf(r);if(-1!==a)return a;throw new Error(Jre("month",e))}(e.month):e.month;n.push(r)}else if(void 0!==e.quarter){var a=t?function(e){if(pte(e)&&(e=+e),mee(e))return e>4&&oae(Jre("quarter",e)),e-1;throw new Error(Jre("quarter",e))}(e.quarter):e.quarter;n.push(mee(a)?3*a:a+"*3")}else n.push(0);if(void 0!==e.date)n.push(e.date);else if(void 0!==e.day){var i=t?function(e){if(pte(e)&&(e=+e),mee(e))return e%7;var t=e.toLowerCase(),n=lae.indexOf(t);if(-1!==n)return n;var r=t.substr(0,3),a=fae.indexOf(r);if(-1!==a)return a;throw new Error(Jre("day",e))}(e.day):e.day;n.push(mee(i)?i+1:i+"+1")}else n.push(1);for(var o=0,u=["hours","minutes","seconds","milliseconds"];o<u.length;o++){var s=e[u[o]];n.push("undefined"===typeof s?0:s)}return n}function hae(e){var t=dae(e,!0).join(", ");return e.utc?"utc(".concat(t,")"):"datetime(".concat(t,")")}function pae(e){var t=dae(e,!1).join(", ");return e.utc?"utc(".concat(t,")"):"datetime(".concat(t,")")}function vae(e){var t=dae(e,!0);return e.utc?+new Date(Date.UTC.apply(Date,(0,ln.Z)(t))):+(0,Sre.Z)(Date,(0,ln.Z)(t))}var gae={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},mae=Yee(gae);function yae(e){return e.startsWith("utc")}var bae={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function xae(e){var t,n=[],r=(0,Zt.Z)(mae);try{for(r.s();!(t=r.n()).done;){var a=t.value;kae(e,a)&&n.push(a)}}catch(i){r.e(i)}finally{r.f()}return n}function kae(e,t){var n=e.indexOf(t);return!(n<0)&&(!(n>0&&"seconds"===t&&"i"===e.charAt(n-1))&&(!(e.length>n+3&&"day"===t&&"o"===e.charAt(n+3))&&!(n>0&&"year"===t&&"f"===e.charAt(n-1))))}function wae(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!1},a=r.end,i=rte(t),o=yae(e)?"utc":"";function u(e){return"quarter"===e?"(".concat(o,"quarter(").concat(i,")-1)"):"".concat(o).concat(e,"(").concat(i,")")}var s,c={},l=(0,Zt.Z)(mae);try{for(l.s();!(s=l.n()).done;){var f=s.value;kae(e,f)&&(c[f]=u(f),n=f)}}catch(d){l.e(d)}finally{l.f()}return a&&(c[n]+="+1"),pae(c)}function _ae(e){if(e){var t=xae(e);return"timeUnitSpecifier(".concat(Eee()(t),", ").concat(Eee()(bae),")")}}function Cae(e){var t;if(e)return yee(e)?t={unit:e}:see(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),yae(t.unit)&&(t.utc=!0,t.unit=t.unit.substr(3)),t}function Sae(e){var t=Cae(e),n=t.utc,r=kee(t,["utc"]);return r.unit?(n?"utc":"")+Yee(r).map((function(e){return Jee("".concat("unit"===e?"":"_".concat(e,"_")).concat(r[e]))})).join(""):(n?"utc":"")+"timeunit"+Yee(r).map((function(e){return Jee("_".concat(e,"_").concat(r[e]))})).join("")}function Aae(e){return e&&!!e.signal}function Eae(e){return!!e.step}function Tae(e){return!uee(e)&&("field"in e&&"data"in e)}var Nae=Yee({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1}),Dae={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},Fae=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function Iae(e){return e&&!!e.field&&void 0!==e.equal}function Mae(e){return e&&!!e.field&&void 0!==e.lt}function Oae(e){return e&&!!e.field&&void 0!==e.lte}function Rae(e){return e&&!!e.field&&void 0!==e.gt}function Zae(e){return e&&!!e.field&&void 0!==e.gte}function Bae(e){if(e&&e.field){if(uee(e.range)&&2===e.range.length)return!0;if(Aae(e.range))return!0}return!1}function zae(e){return e&&!!e.field&&(uee(e.oneOf)||uee(e.in))}function Lae(e){return e&&!!e.field&&void 0!==e.valid}function Pae(e){return zae(e)||Iae(e)||Bae(e)||Mae(e)||Rae(e)||Oae(e)||Zae(e)}function jae(e,t){return Yoe(e,{timeUnit:t,wrapTime:!0})}function Uae(e,t){return e.map((function(e){return jae(e,t)}))}function Wae(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.field,a=null===(t=Cae(e.timeUnit))||void 0===t?void 0:t.unit,i=a?"time("+wae(a,r)+")":Noe(e,{expr:"datum"});if(Iae(e))return i+"==="+jae(e.equal,a);if(Mae(e)){var o=e.lt;return"".concat(i,"<").concat(jae(o,a))}if(Rae(e)){var u=e.gt;return"".concat(i,">").concat(jae(u,a))}if(Oae(e)){var s=e.lte;return"".concat(i,"<=").concat(jae(s,a))}if(Zae(e)){var c=e.gte;return"".concat(i,">=").concat(jae(c,a))}if(zae(e))return"indexof([".concat(Uae(e.oneOf,a).join(","),"], ").concat(i,") !== -1");if(Lae(e))return Vae(i,e.valid);if(Bae(e)){var l=e.range,f=Aae(l)?{signal:"".concat(l.signal,"[0]")}:l[0],d=Aae(l)?{signal:"".concat(l.signal,"[1]")}:l[1];if(null!==f&&null!==d&&n)return"inrange("+i+", ["+jae(f,a)+", "+jae(d,a)+"])";var h=[];return null!==f&&h.push("".concat(i," >= ").concat(jae(f,a))),null!==d&&h.push("".concat(i," <= ").concat(jae(d,a))),h.length>0?h.join(" && "):"true"}throw new Error("Invalid field predicate: ".concat(JSON.stringify(e)))}function Vae(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t?"isValid(".concat(e,") && isFinite(+").concat(e,")"):"!isValid(".concat(e,") || !isFinite(+").concat(e,")")}function Gae(e){var t;return Pae(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:null===(t=Cae(e.timeUnit))||void 0===t?void 0:t.unit}):e}var qae={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};var Hae=qae.quantitative,Xae=qae.ordinal,Yae=qae.temporal,Kae=qae.nominal,$ae=qae.geojson,Qae=Yee(qae);var Jae="linear",eie="log",tie="pow",nie="sqrt",rie="symlog",aie="time",iie="utc",oie="quantile",uie="quantize",sie="threshold",cie="point",lie="band",fie={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},die=Yee(fie);function hie(e,t){var n=fie[e],r=fie[t];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}var pie={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function vie(e){return pie[e]}var gie=["linear","log","pow","sqrt","symlog","time","utc"],mie=xee(gie),yie=xee(["linear","log","pow","sqrt","symlog"]);var bie=xee(["quantile","quantize","threshold"]),xie=xee(gie.concat(["quantile","quantize","threshold","sequential","identity"])),kie=xee(["ordinal","bin-ordinal","point","band"]);function wie(e){return e in kie}function _ie(e){return e in xie}function Cie(e){return e in mie}function Sie(e){return e in bie}function Aie(e){return null===e||void 0===e?void 0:e.selection}var Eie={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},Tie=(Yee(Eie),kee(Eie,["type","domain","range","scheme"])),Nie=Yee(Tie);!function(){var e,t,n={},r=(0,Zt.Z)(qne);try{for(r.s();!(t=r.n()).done;){var a,i=t.value,o=(0,Zt.Z)(Qae);try{for(o.s();!(a=o.n()).done;){var u,s=a.value,c=(0,Zt.Z)(die);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=Oie(i,s);Mie(i,l)&&Iie(l,s)&&(n[f]=null!==(e=n[f])&&void 0!==e?e:[],n[f].push(l))}}catch(d){c.e(d)}finally{c.f()}}}catch(d){o.e(d)}finally{o.f()}}}catch(d){r.e(d)}finally{r.f()}}();function Die(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!Pee(["point","band","identity"],e);case"bins":return!Pee(["point","band","identity","ordinal"],e);case"round":return Cie(e)||"band"===e||"point"===e;case"padding":return Cie(e)||Pee(["point","band"],e);case"paddingOuter":case"align":return Pee(["point","band"],e);case"paddingInner":return"band"===e;case"domainMid":case"clamp":return Cie(e);case"nice":return Cie(e)||"quantize"===e||"threshold"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"constant":return"symlog"===e;case"zero":return _ie(e)&&!Pee(["log","time","utc","threshold","quantile"],e)}}function Fie(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return Une(e)?void 0:'Cannot use the scale property "'.concat(e,'" with non-color channel.');case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function Iie(e,t){return Pee([Xae,Kae],t)?void 0===e||wie(e):t===Yae?Pee([aie,iie,void 0],e):t!==Hae||Pee([eie,tie,nie,rie,oie,uie,sie,Jae,void 0],e)}function Mie(e,t){if(!pre(e))return!1;switch(e){case one:case une:case dne:case lne:return Cie(t)||Pee(["band","point"],t);case wne:case Ene:case Cne:case Sne:case Ane:case _ne:return Cie(t)||Sie(t)||Pee(["band","point","ordinal"],t);case yne:case bne:case xne:return"band"!==t;case Tne:return"ordinal"===t||Sie(t);case kne:return"ordinal"===t}}function Oie(e,t){return e+"_"+t}function Rie(e){var t=e.channel,n=e.channelDef,r=e.markDef,a=e.scale,i=e.config,o=jie(e);return goe(n)&&!ene(n.aggregate)&&a&&Cie(a.get("type"))&&!1===a.get("zero")?Zie({fieldDef:n,channel:t,markDef:r,ref:o,config:i}):o}function Zie(e){var t=e.fieldDef,n=e.channel,r=e.markDef,a=e.ref,i=e.config;return Bte(r.type)||null===aue("invalid",r,i)?a:[Bie(t,n),a]}function Bie(e,t){var n=zie(e,!0),r="y"===Qne(t)?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function zie(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Vae(yee(e)?e:Noe(e,{expr:"datum"}),!t)}function Lie(e,t,n,r){var a={};if(t&&(a.scale=t),yoe(e)){var i=e.datum;uae(i)?a.signal=hae(i):Aae(i)?a.signal=i.signal:a.value=i}else a.field=Noe(e,n);if(r){var o=r.offset,u=r.band;o&&(a.offset=o),u&&(a.band=u)}return a}function Pie(e){var t=e.scaleName,n=e.fieldOrDatumDef,r=e.fieldOrDatumDef2,a=e.offset,i=e.startSuffix,o=e.band,u=void 0===o?.5:o,s=0<u&&u<1?"datum":void 0,c=Noe(n,{expr:s,suffix:i}),l=void 0!==r?Noe(r,{expr:s}):Noe(n,{suffix:"end",expr:s}),f={};if(0===u||1===u){f.scale=t;var d=0===u?c:l;f.field=d}else{var h="".concat(u," * ").concat(c," + ").concat(1-u," * ").concat(l);f.signal='scale("'.concat(t,'", ').concat(h,")")}return a&&(f.offset=a),f}function jie(e){var t,n=e.channel,r=e.channelDef,a=e.channel2Def,i=e.markDef,o=e.config,u=e.scaleName,s=e.scale,c=e.stack,l=e.offset,f=e.defaultRef,d=e.band;if(r){if(koe(r)){if(woe(r)){d=null!==d&&void 0!==d?d:foe({channel:n,fieldDef:r,fieldDef2:a,markDef:i,stack:c,config:o,isMidPoint:!0});var h=r.bin,p=r.timeUnit,v=r.type;if(xre(h)||d&&p&&v===Yae)return c&&c.impute?Lie(r,u,{binSuffix:"mid"},{offset:l}):d?Pie({scaleName:u,fieldOrDatumDef:r,band:d,offset:l}):Lie(r,u,$oe(r,n)?{binSuffix:"range"}:{},{offset:l});if(kre(h)){if(goe(a))return Pie({scaleName:u,fieldOrDatumDef:r,fieldOrDatumDef2:a,band:d,offset:l});oae(tae(n===one?sne:cne))}}var g=null===s||void 0===s?void 0:s.get("type");return Lie(r,u,wie(g)?{binSuffix:"range"}:{},{offset:l,band:"band"===g?null!==(t=null!==d&&void 0!==d?d:r.band)&&void 0!==t?t:.5:void 0})}if(_oe(r)){var m=r.value,y=l?{offset:l}:{};return Object.assign(Object.assign({},Uie(n,m)),y)}}return"function"===typeof f&&(f=f()),f?Object.assign(Object.assign({},f),l?{offset:l}:{}):f}function Uie(e,t){return Pee(["x","x2"],e)&&"width"===t?{field:{group:"width"}}:Pee(["y","y2"],e)&&"height"===t?{field:{group:"height"}}:eue(t)}function Wie(e){return e&&"number"!==e&&"time"!==e}function Vie(e,t,n){return"".concat(e,"(").concat(t).concat(n?", ".concat(JSON.stringify(n)):"",")")}function Gie(e){var t,n,r=e.fieldOrDatumDef,a=e.format,i=e.formatType,o=e.expr,u=e.normalizeStack,s=e.config;if(Wie(i))return Hie({fieldOrDatumDef:r,format:a,formatType:i,expr:o,config:s});var c=qie(r,o,u);if(Xoe(r)){var l=function(e,t,n,r,a){return!t||n?(n=yee(n)?n:r,"".concat(a?"utc":"time","Format(").concat(e,", '").concat(n,"')")):function(e,t,n){if(e){var r=_ae(e),a=n||yae(e);return"".concat(a?"utc":"time","Format(").concat(t,", ").concat(r,")")}}(t,e,a)}(c,goe(r)?null===(t=Cae(r.timeUnit))||void 0===t?void 0:t.unit:void 0,a,s.timeFormat,Coe(r)&&(null===(n=r.scale)||void 0===n?void 0:n.type)===iie);return l?{signal:l}:void 0}return a=Kie(moe(r),a,s),goe(r)&&xre(r.bin)?{signal:Jie(c,Noe(r,{expr:o,binSuffix:"end"}),a,i,s)}:a||"quantitative"===moe(r)?{signal:"".concat($ie(c,a))}:{signal:"isValid(".concat(c,") ? ").concat(c,' : ""+').concat(c)}}function qie(e,t,n){return goe(e)?n?"".concat(Noe(e,{expr:t,suffix:"end"}),"-").concat(Noe(e,{expr:t,suffix:"start"})):Noe(e,{expr:t}):function(e){var t=e.datum;return uae(t)?hae(t):"".concat(JSON.stringify(t))}(e)}function Hie(e){var t=e.fieldOrDatumDef,n=e.format,r=e.formatType,a=e.expr,i=e.normalizeStack,o=e.config,u=e.field;return u=null!==u&&void 0!==u?u:qie(t,a,i),goe(t)&&xre(t.bin)?{signal:Jie(u,Noe(t,{expr:a,binSuffix:"end"}),n,r,o)}:{signal:Vie(r,u,n)}}function Xie(e,t,n,r,a,i){var o;if(!Wie(r))return Xoe(e)?function(e,t,n,r){if(e)return e;if(t)return{signal:_ae(t)};return r?void 0:n.timeFormat}(n,goe(e)?null===(o=Cae(e.timeUnit))||void 0===o?void 0:o.unit:void 0,a,i):Kie(t,n,a)}function Yie(e,t,n){return e&&(Aae(e)||"number"===e||"time"===e)?e:Xoe(t)&&"time"!==n&&"utc"!==n?"time":void 0}function Kie(e,t,n){return yee(t)?t:e===Hae?n.numberFormat:void 0}function $ie(e,t){return"format(".concat(e,', "').concat(t||"",'")')}function Qie(e,t,n,r){var a;return Wie(n)?Vie(n,e,t):$ie(e,null!==(a=yee(t)?t:void 0)&&void 0!==a?a:r.numberFormat)}function Jie(e,t,n,r,a){var i=Qie(e,n,r,a),o=Qie(t,n,r,a);return"".concat(Vae(e,!1),' ? "null" : ').concat(i,' + "').concat(" \u2013 ",'" + ').concat(o)}var eoe="min",toe={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function noe(e){return e in toe}function roe(e){return!!e&&!!e.encoding}function aoe(e){return!!e&&("count"===e.op||!!e.field)}function ioe(e){return!!e&&uee(e)}function ooe(e){return"row"in e||"column"in e}function uoe(e){return!!e&&"header"in e}function soe(e){return"facet"in e}function coe(e){var t=e.field,n=e.timeUnit,r=e.bin,a=e.aggregate;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),a?{aggregate:a}:{}),{field:t})}function loe(e){return woe(e)&&"sort"in e}function foe(e){var t=e.channel,n=e.fieldDef,r=e.fieldDef2,a=e.markDef,i=e.stack,o=e.config,u=e.isMidPoint;if(koe(n)&&void 0!==n.band)return n.band;if(goe(n)){var s=n.timeUnit,c=n.bin;if(s&&!r)return u?iue("timeUnitBandPosition",a,o):zte(a.type)?iue("timeUnitBand",a,o):0;if(xre(c))return zte(a.type)&&!u?1:.5}return(null===i||void 0===i?void 0:i.fieldChannel)===t&&u?.5:void 0}function doe(e,t,n,r,a,i){return!!(xre(t.bin)||t.timeUnit&&woe(t)&&"temporal"===t.type)&&!!foe({channel:e,fieldDef:t,fieldDef2:n,stack:r,markDef:a,config:i})}function hoe(e){return!!e&&"condition"in e}function poe(e){var t=e&&e.condition;return!!t&&!uee(t)&&goe(t)}function voe(e){var t=e&&e.condition;return!!t&&!uee(t)&&koe(t)}function goe(e){return!!e&&(!!e.field||"count"===e.aggregate)}function moe(e){return e&&e.type}function yoe(e){return!!e&&"datum"in e}function boe(e){return woe(e)&&Foe(e)||xoe(e)}function xoe(e){return yoe(e)&&mee(e.datum)}function koe(e){return goe(e)||yoe(e)}function woe(e){return!!e&&("field"in e&&"type"in e||"count"===e.aggregate)}function _oe(e){return e&&"value"in e&&"value"in e}function Coe(e){return!!e&&("scale"in e||"sort"in e)}function Soe(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function Aoe(e){return!!e&&"legend"in e}function Eoe(e){return!!e&&("format"in e||"formatType"in e)}function Toe(e){return"op"in e}function Noe(e){var t,n,r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.field,o=a.prefix,u=a.suffix,s="";if(Ioe(e))i=dte("count");else{var c;if(!a.nofn)if(Toe(e))c=e.op;else{var l=e.bin,f=e.aggregate,d=e.timeUnit;xre(l)?(c=bre(l),u=(null!==(t=a.binSuffix)&&void 0!==t?t:"")+(null!==(n=a.suffix)&&void 0!==n?n:"")):f?$te(f)?(s='["'.concat(i,'"]'),i="argmax_".concat(f.argmax)):Kte(f)?(s='["'.concat(i,'"]'),i="argmin_".concat(f.argmin)):c=String(f):d&&(c=Sae(d),u=(!Pee(["range","mid"],a.binSuffix)&&a.binSuffix||"")+(null!==(r=a.suffix)&&void 0!==r?r:""))}c&&(i=i?"".concat(c,"_").concat(i):c)}return u&&(i="".concat(i,"_").concat(u)),o&&(i="".concat(o,"_").concat(i)),a.forAs?ste(i):a.expr?ate(i,a.expr)+s:ote(i)+s}function Doe(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return goe(e)&&!!e.bin;case"temporal":return!1}throw new Error(zre(e.type))}function Foe(e){return!Doe(e)}function Ioe(e){return"count"===e.aggregate}var Moe=function(e,t){switch(t.fieldTitle){case"plain":return e.field;case"functional":return function(e){var t=e.aggregate,n=e.bin,r=e.timeUnit,a=e.field;if($te(t))return"".concat(a," for argmax(").concat(t.argmax,")");if(Kte(t))return"".concat(a," for argmin(").concat(t.argmin,")");var i=Cae(r),o=t||(null===i||void 0===i?void 0:i.unit)||(null===i||void 0===i?void 0:i.maxbins)&&"timeunit"||xre(n)&&"bin";return o?o.toUpperCase()+"("+a+")":a}(e);default:return function(e,t){var n,r=e.field,a=e.bin,i=e.timeUnit,o=e.aggregate;if("count"===o)return t.countTitle;if(xre(a))return"".concat(r," (binned)");if(i){var u=null===(n=Cae(i))||void 0===n?void 0:n.unit;if(u)return"".concat(r," (").concat(xae(u).join("-"),")")}else if(o)return $te(o)?"".concat(r," for max ").concat(o.argmax):Kte(o)?"".concat(r," for min ").concat(o.argmin):"".concat(nte(o)," of ").concat(r);return r}(e,t)}},Ooe=Moe;function Roe(e){Ooe=e}function Zoe(){Roe(Moe)}function Boe(e,t,n){var r,a,i=n.allowDisabling,o=n.includeDefault,u=void 0===o||o,s=(null!==(r=zoe(e))&&void 0!==r?r:{}).title;if(!goe(e))return s;var c=e,l=u?Loe(c,t):void 0;return i?lte(s,c.title,l):null!==(a=null!==s&&void 0!==s?s:c.title)&&void 0!==a?a:l}function zoe(e){return Soe(e)&&e.axis?e.axis:Aoe(e)&&e.legend?e.legend:uoe(e)&&e.header?e.header:void 0}function Loe(e,t){return Ooe(e,t)}function Poe(e){var t;if(Eoe(e))return{format:e.format,formatType:e.formatType};var n=null!==(t=zoe(e))&&void 0!==t?t:{};return{format:n.format,formatType:n.formatType}}function joe(e){return goe(e)?e:poe(e)?e.condition:void 0}function Uoe(e){return koe(e)?e:voe(e)?e.condition:void 0}function Woe(e,t,n){return yee(e)||mee(e)||gee(e)?(oae(function(e,t,n){return"Channel ".concat(e," is a ").concat(t,". Converted to {value: ").concat(Bee(n),"}.")}(t,yee(e)?"string":mee(e)?"number":"boolean",e)),{value:e}):koe(e)?Voe(e,t,n):voe(e)?Object.assign(Object.assign({},e),{condition:Voe(e.condition,t,n)}):e}function Voe(e,t,n){if(Eoe(e)){e.format;var r=e.formatType,a=kee(e,["format","formatType"]);if(Wie(r)&&!n.customFormatTypes)return oae(Bre(t)),Voe(a,t,n)}else{var i=Soe(e)?"axis":Aoe(e)?"legend":uoe(e)?"header":null;if(i&&e[i]){var o=e[i],u=(o.format,o.formatType),s=kee(o,["format","formatType"]);if(Wie(u)&&!n.customFormatTypes)return oae(Bre(t)),Voe(Object.assign(Object.assign({},e),(0,qn.Z)({},i,s)),t,n)}}return goe(e)?Goe(e,t):function(e){var t=e.type;if(t)return e;var n=e.datum;return t=mee(n)?"quantitative":yee(n)?"nominal":uae(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}(e)}function Goe(e,t){var n=e.aggregate,r=e.timeUnit,a=e.bin,i=e.field,o=Object.assign({},e);if(!n||Qte(n)||$te(n)||Kte(n)||(oae(function(e){return'Invalid aggregation operator "'.concat(e,'".')}(n)),delete o.aggregate),r&&(o.timeUnit=Cae(r)),i&&(o.field="".concat(i)),xre(a)&&(o.bin=qoe(a,t)),kre(a)&&!ore(t)&&oae("Channel ".concat(t,' should not be used with "binned" bin.')),woe(o)){var u=o.type,s=function(e){if(e)switch(e=e.toLowerCase()){case"q":case Hae:return"quantitative";case"t":case Yae:return"temporal";case"o":case Xae:return"ordinal";case"n":case Kae:return"nominal";case $ae:return"geojson"}}(u);u!==s&&(o.type=s),"quantitative"!==u&&ene(n)&&(oae(function(e,t){return'Invalid field type "'.concat(e,'" for aggregate: "').concat(t,'", using "quantitative" instead.')}(u,n)),o.type="quantitative")}else if(!$ne(t)){var c=function(e,t){if(e.timeUnit)return"temporal";if(xre(e.bin))return"quantitative";switch(yre(t)){case"continuous":default:return"quantitative";case"discrete":case"flexible":return"nominal"}}(o,t);oae(function(e,t){return'Missing type for channel "'.concat(e,'", using "').concat(t,'" instead.')}(t,c)),o.type=c}if(woe(o)){var l=function(e,t){var n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:"Channel ".concat(t," should not be used with a geojson data.")};switch(t){case rne:case ane:case ine:return Foe(e)?{compatible:!1,warning:Ure(t)}:Hoe;case one:case une:case yne:case bne:case xne:case Nne:case Fne:case Ine:case Mne:case One:case Rne:case _ne:case dne:case lne:case Zne:return Hoe;case vne:case mne:case pne:case gne:return n!==Hae?{compatible:!1,warning:"Channel ".concat(t," should be used with a quantitative field only, not ").concat(e.type," field.")}:Hoe;case Cne:case Sne:case Ane:case Ene:case wne:case hne:case fne:case sne:case cne:return"nominal"!==n||e.sort?Hoe:{compatible:!1,warning:"Channel ".concat(t," should not be used with an unsorted discrete field.")};case Tne:return Pee(["ordinal","nominal"],e.type)?Hoe:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case kne:return Pee(["ordinal","nominal","geojson"],e.type)?Hoe:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case Dne:return"nominal"!==e.type||"sort"in e?Hoe:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(o,t),f=l.compatible,d=l.warning;f||oae(d)}if(loe(o)&&yee(o.sort)){var h=o.sort;if(noe(h))return Object.assign(Object.assign({},o),{sort:{encoding:h}});var p=h.substr(1);if("-"===h.charAt(0)&&noe(p))return Object.assign(Object.assign({},o),{sort:{encoding:p,order:"descending"}})}if(uoe(o)){var v=o.header,g=v.orient,m=kee(v,["orient"]);if(g)return Object.assign(Object.assign({},o),{header:Object.assign(Object.assign({},m),{labelOrient:v.labelOrient||g,titleOrient:v.titleOrient||g})})}return o}function qoe(e,t){return gee(e)?{maxbins:Cre(t)}:"binned"===e?{binned:!0}:e.maxbins||e.step?e:Object.assign(Object.assign({},e),{maxbins:Cre(t)})}var Hoe={compatible:!0};function Xoe(e){var t=Poe(e).formatType;return"time"===t||!t&&function(e){return e&&("temporal"===e.type||goe(e)&&!!e.timeUnit)}(e)}function Yoe(e,t){var n,r,a=t.timeUnit,i=t.type,o=t.wrapTime,u=t.undefinedIfExprNotRequired,s=a&&(null===(n=Cae(a))||void 0===n?void 0:n.unit),c=s||"temporal"===i;return Aae(e)?r=e.signal:uae(e)?(c=!0,r=hae(e)):(yee(e)||mee(e))&&c&&(r="datetime(".concat(JSON.stringify(e),")"),function(e){return!!gae[e]}(s)&&(mee(e)&&e<1e4||yee(e)&&isNaN(Date.parse(e)))&&(r=hae((0,qn.Z)({},s,e)))),r?o&&c?"time(".concat(r,")"):r:u?void 0:JSON.stringify(e)}function Koe(e,t){var n=e.type;return t.map((function(t){var r=Yoe(t,{timeUnit:goe(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:t}))}function $oe(e,t){return xre(e.bin)?pre(t)&&Pee(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}function Qoe(e){var t=e.anchor,n=e.frame,r=e.offset,a=e.orient,i=e.color,o=e.subtitleColor,u=e.subtitleFont,s=e.subtitleFontSize,c=e.subtitleFontStyle,l=e.subtitleFontWeight,f=e.subtitleLineHeight,d=e.subtitlePadding,h=kee(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),p=Object.assign(Object.assign({},h),i?{fill:i}:{}),v=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),r?{offset:r}:{}),a?{orient:a}:{}),g=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},o?{subtitleColor:o}:{}),u?{subtitleFont:u}:{}),s?{subtitleFontSize:s}:{}),c?{subtitleFontStyle:c}:{}),l?{subtitleFontWeight:l}:{}),f?{subtitleLineHeight:f}:{}),d?{subtitlePadding:d}:{});return{titleMarkConfig:p,subtitleMarkConfig:Ree(p,["align","baseline","dx","dy","limit"]),nonMark:v,subtitle:g}}function Joe(e){return yee(e)||uee(e)&&yee(e[0])}function eue(e){return Aae(e)?e:void 0!==e?{value:e}:void 0}function tue(e){return Aae(e)?e.signal:bee(e.value)}function nue(e){return Aae(e)?e.signal:null==e?null:bee(e)}function rue(e){var t;return[].concat(e.type,null!==(t=e.style)&&void 0!==t?t:[])}function aue(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=r.vgChannel,i=r.ignoreVgConfig;return a&&void 0!==t[a]?t[a]:void 0!==t[e]?t[e]:!i||a&&a!==e?iue(e,t,n,r):void 0}function iue(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=r.vgChannel;return lte(a?oue(e,t,n.style):void 0,oue(e,t,n.style),a?n[t.type][a]:void 0,n[t.type][e],a?n.mark[a]:n.mark[e])}function oue(e,t,n){return uue(e,rue(t),n)}function uue(e,t,n){var r;t=hee(t);var a,i=(0,Zt.Z)(t);try{for(i.s();!(a=i.n()).done;){var o=n[a.value];o&&void 0!==o[e]&&(r=o[e])}}catch(u){i.e(u)}finally{i.f()}return r}function sue(e,t){return hee(e).reduce((function(e,n){var r;return e.field.push(Noe(n,t)),e.order.push(null!==(r=n.sort)&&void 0!==r?r:"ascending"),e}),{field:[],order:[]})}function cue(e,t){var n=(0,ln.Z)(e);return t.forEach((function(e){var t,r=(0,Zt.Z)(n);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(Mee(a,e))return}}catch(i){r.e(i)}finally{r.f()}n.push(e)})),n}function lue(e,t){return Mee(e,t)||!t?e:e?[].concat((0,ln.Z)(hee(e)),(0,ln.Z)(hee(t))).join(", "):t}function fue(e,t){var n=e.value,r=t.value;if(null==n||null===r)return{explicit:e.explicit,value:null};if((Joe(n)||Aae(n))&&(Joe(r)||Aae(r)))return{explicit:e.explicit,value:lue(n,r)};if(Joe(n)||Aae(n))return{explicit:e.explicit,value:n};if(Joe(r)||Aae(r))return{explicit:e.explicit,value:r};if(!Joe(n)&&!Aae(n)&&!Joe(r)&&!Aae(r))return{explicit:e.explicit,value:cue(n,r)};throw new Error("It should never reach here")}function due(e,t){var n=e&&e[t];return!!n&&(uee(n)?jee(n,(function(e){return!!e.field})):goe(n)||poe(n))}function hue(e){return jee(qne,(function(t){if(due(e,t)){var n=e[t];if(uee(n))return jee(n,(function(e){return!!e.aggregate}));var r=joe(n);return r&&!!r.aggregate}return!1}))}function pue(e,t){var n=[],r=[],a=[],i=[],o={};return mue(e,(function(u,s){if(goe(u)){var c=u.field,l=u.aggregate,f=u.bin,d=u.timeUnit,h=kee(u,["field","aggregate","bin","timeUnit"]);if(l||d||f){var p,v=zoe(u),g=v&&v.title,m=Noe(u,{forAs:!0}),y=Object.assign(Object.assign(Object.assign({},g?[]:{title:Boe(u,t,{allowDisabling:!0})}),h),{field:m});if(l){if($te(l)?(p="argmax",m=Noe({op:"argmax",field:l.argmax},{forAs:!0}),y.field="".concat(m,".").concat(c)):Kte(l)?(p="argmin",m=Noe({op:"argmin",field:l.argmin},{forAs:!0}),y.field="".concat(m,".").concat(c)):"boxplot"!==l&&"errorbar"!==l&&"errorband"!==l&&(p=l),p){var b={op:p,as:m};c&&(b.field=c),i.push(b)}}else if(n.push(m),woe(u)&&xre(f)){if(r.push({bin:f,field:c,as:m}),n.push(Noe(u,{binSuffix:"end"})),$oe(u,s)&&n.push(Noe(u,{binSuffix:"range"})),ore(s)){var x={field:m+"_end"};o[s+"2"]=x}y.bin="binned",$ne(s)||(y.type=Hae)}else if(d){a.push({timeUnit:d,field:c,as:m});var k=woe(u)&&u.type!==Yae&&"time";k&&(s===Nne||s===Mne?y.formatType=k:!function(e){return!!nre[e]}(s)?ore(s)&&(y.axis=Object.assign({formatType:k},y.axis)):y.legend=Object.assign({formatType:k},y.legend))}o[s]=y}else n.push(c),o[s]=e[s]}else o[s]=e[s]})),{bins:r,timeUnits:a,aggregate:i,groupby:n,encoding:o}}function vue(e,t,n){var r=t.type;return Yee(e).reduce((function(a,i){if(!Yne(i))return oae(function(e){return"".concat(e,"-encoding is dropped as ").concat(e," is not a valid encoding channel.")}(i)),a;var o=e[i];if("angle"!==i||"arc"!==r||e.theta||(oae("Arc marks uses theta channel rather than angle, replacing angle with theta."),i=dne),!function(e,t,n){var r=vre(t,n);if(!r)return!1;if("binned"===r){var a=e[t===sne?one:une];return!!(goe(a)&&goe(e[t])&&kre(a.bin))}return!0}(e,i,r))return oae(jre(i,r)),a;if(i===wne&&"line"===r){var u=joe(e[i]);if(null===u||void 0===u?void 0:u.aggregate)return oae("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead."),a}if(i===yne&&(t.filled?"fill"in e:"stroke"in e))return oae(Lre("encoding",{fill:"fill"in e,stroke:"stroke"in e})),a;if(i===Fne||i===Dne&&!uee(o)&&!_oe(o)||i===Mne&&uee(o))o&&(a[i]=hee(o).reduce((function(e,t){return goe(t)?e.push(Goe(t,i)):oae(Pre(t,i)),e}),[]));else{if(i===Mne&&null===o)a[i]=null;else if(!goe(o)&&!yoe(o)&&!_oe(o)&&!hoe(o)&&!Aae(o))return oae(Pre(o,i)),a;a[i]=Woe(o,i,n)}return a}),{})}function gue(e){var t,n=[],r=(0,Zt.Z)(Yee(e));try{for(r.s();!(t=r.n()).done;){var a=t.value;if(due(e,a)){var i,o=hee(e[a]),u=(0,Zt.Z)(o);try{for(u.s();!(i=u.n()).done;){var s=i.value;goe(s)?n.push(s):poe(s)&&n.push(s.condition)}}catch(c){u.e(c)}finally{u.f()}}}}catch(c){r.e(c)}finally{r.f()}return n}function mue(e,t,n){if(e){var r,a=(0,Zt.Z)(Yee(e));try{for(a.s();!(r=a.n()).done;){var i=r.value,o=e[i];if(uee(o)){var u,s=(0,Zt.Z)(o);try{for(s.s();!(u=s.n()).done;){var c=u.value;t.call(n,c,i)}}catch(l){s.e(l)}finally{s.f()}}else t.call(n,o,i)}}catch(l){a.e(l)}finally{a.f()}}}function yue(e,t,n,r){return e?Yee(e).reduce((function(n,a){var i=e[a];return uee(i)?i.reduce((function(e,n){return t.call(r,e,n,a)}),n):t.call(r,n,i,a)}),n):n}function bue(e,t){return Yee(t).reduce((function(n,r){switch(r){case one:case une:case One:case Zne:case Rne:case sne:case cne:case dne:case hne:case lne:case fne:case pne:case vne:case gne:case mne:case Nne:case kne:case _ne:case Mne:return n;case Dne:if("line"===e||"trail"===e)return n;case Fne:case Ine:var a=t[r];if(uee(a)||goe(a)){var i,o=(0,Zt.Z)(hee(a));try{for(o.s();!(i=o.n()).done;){var u=i.value;u.aggregate||n.push(Noe(u,{}))}}catch(c){o.e(c)}finally{o.f()}}return n;case wne:if("trail"===e)return n;case yne:case bne:case xne:case Cne:case Sne:case Ane:case Tne:case Ene:var s=joe(t[r]);return s&&!s.aggregate&&n.push(Noe(s,{})),n}}),[])}function xue(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if("tooltip"in n)return{tooltip:n.tooltip};var a=e.map((function(e){var n=e.fieldPrefix,a=e.titlePrefix,i=r?" of ".concat(t.field):"";return{field:n+t.field,type:t.type,title:Aae(a)?{signal:a+'"'.concat(escape(i),'"')}:a+i}}));return{tooltip:[].concat((0,ln.Z)(a),(0,ln.Z)(gue(n)))}}function kue(e){var t=e.axis,n=e.title,r=e.field;return t&&void 0!==t.title?void 0:lte(n,r)}function wue(e,t,n,r,a){var i=n.scale,o=n.axis;return function(u){var s=u.partName,c=u.mark,l=u.positionPrefix,f=u.endPositionPrefix,d=void 0===f?void 0:f,h=u.aria,p=u.extraEncoding,v=void 0===p?{}:p,g=kue(n);return _ue(e,s,a,h,{mark:c,encoding:Object.assign(Object.assign(Object.assign((0,qn.Z)({},t,Object.assign(Object.assign(Object.assign({field:l+"_"+n.field,type:n.type},void 0!==g?{title:g}:{}),void 0!==i?{scale:i}:{}),void 0!==o?{axis:o}:{})),yee(d)?(0,qn.Z)({},t+"2",{field:d+"_"+n.field}):{}),r),v)})}}function _ue(e,t,n,r,a){var i=e.clip,o=e.color,u=e.opacity,s=e.type;return e[t]||void 0===e[t]&&n[t]?[Object.assign(Object.assign({},a),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),i?{clip:i}:{}),o?{color:o}:{}),u?{opacity:u}:{}),Pte(a.mark)?a.mark:{type:a.mark}),{style:"".concat(s,"-").concat(t)}),gee(e[t])?{}:e[t]),!1===r?{aria:r}:{})})]:[]}function Cue(e,t,n){var r=e.encoding,a="vertical"===t?"y":"x",i=r[a],o=r[a+"2"],u=r[a+"Error"],s=r[a+"Error2"];return{continuousAxisChannelDef:Sue(i,n),continuousAxisChannelDef2:Sue(o,n),continuousAxisChannelDefError:Sue(u,n),continuousAxisChannelDefError2:Sue(s,n),continuousAxis:a}}function Sue(e,t){if(e&&e.aggregate){var n=e.aggregate,r=kee(e,["aggregate"]);return n!==t&&oae(function(e,t){return"Continuous axis should not have customized aggregation function ".concat(e,"; ").concat(t," already agregates the axis.")}(n,t)),r}return e}function Aue(e,t){var n=e.mark,r=e.encoding,a=r.x,i=r.y;if(boe(a)){if(boe(i)){var o=goe(a)&&a.aggregate,u=goe(i)&&i.aggregate;if(o||u!==t){if(u||o!==t){if(o===t&&u===t)throw new Error("Both x and y cannot have aggregate");return Pte(n)&&n.orient?n.orient:"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(boe(i))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}var Eue="boxplot",Tue=new Hte(Eue,Due);function Nue(e){return mee(e)?"tukey":e}function Due(e,t){var n,r,a=t.config,i=e.mark,o=(e.encoding,e.selection),u=(e.projection,kee(e,["mark","encoding","selection","projection"])),s=Pte(i)?i:{type:i};o&&oae(Mre("boxplot"));var c,l=null!==(n=s.extent)&&void 0!==n?n:a.boxplot.extent,f=aue("size",s,a),d=Nue(l),h=function(e,t,n){var r=Aue(e,Eue),a=Cue(e,r,Eue),i=a.continuousAxisChannelDef,o=a.continuousAxis,u=i.field,s=Nue(t),c=[].concat((0,ln.Z)(Fue(u)),[{op:"median",field:u,as:"mid_box_"+u},{op:"min",field:u,as:("min-max"===s?"lower_whisker_":"min_")+u},{op:"max",field:u,as:("min-max"===s?"upper_whisker_":"max_")+u}]),l="min-max"===s||"tukey"===s?[]:[{calculate:'datum["upper_box_'.concat(u,'"] - datum["lower_box_').concat(u,'"]'),as:"iqr_"+u},{calculate:'min(datum["upper_box_'.concat(u,'"] + datum["iqr_').concat(u,'"] * ').concat(t,', datum["max_').concat(u,'"])'),as:"upper_whisker_"+u},{calculate:'max(datum["lower_box_'.concat(u,'"] - datum["iqr_').concat(u,'"] * ').concat(t,', datum["min_').concat(u,'"])'),as:"lower_whisker_"+u}],f=e.encoding,d=o,h=(f[d],kee(f,["symbol"===typeof d?d:d+""])),p=function(e){var t,n,r=e.tooltip,a=kee(e,["tooltip"]);if(!r)return{filteredEncoding:e};if(uee(r)){var i,o=(0,Zt.Z)(r);try{for(o.s();!(i=o.n()).done;){var u=i.value;u.aggregate?(t||(t=[]),t.push(u)):(n||(n=[]),n.push(u))}}catch(s){o.e(s)}finally{o.f()}t&&(a.tooltip=t)}else r.aggregate?a.tooltip=r:n=r;return uee(n)&&1===n.length&&(n=n[0]),{customTooltipWithoutAggregatedField:n,filteredEncoding:a}}(h),v=p.customTooltipWithoutAggregatedField,g=pue(p.filteredEncoding,n),m=g.bins,y=g.timeUnits,b=g.aggregate,x=g.groupby,k=g.encoding,w="vertical"===r?"horizontal":"vertical",_=r,C=[].concat((0,ln.Z)(m),(0,ln.Z)(y),[{aggregate:[].concat((0,ln.Z)(b),(0,ln.Z)(c)),groupby:x}],l);return{transform:C,groupby:x,aggregate:b,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:k,ticksOrient:w,boxOrient:_,customTooltipWithoutAggregatedField:v}}(e,l,a),p=h.transform,v=h.continuousAxisChannelDef,g=h.continuousAxis,m=h.groupby,y=h.aggregate,b=h.encodingWithoutContinuousAxis,x=h.ticksOrient,k=h.boxOrient,w=h.customTooltipWithoutAggregatedField,_=(b.color,b.size),C=kee(b,["color","size"]),S=function(e){return wue(s,g,v,e,a.boxplot)},A=S(C),E=S(b),T=S(Object.assign(Object.assign({},C),_?{size:_}:{})),N=xue([{fieldPrefix:"min-max"===d?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===d?"lower_whisker_":"min_",titlePrefix:"Min"}],v,b),D={type:"tick",color:"black",opacity:1,orient:x,invalid:null},F="min-max"===d?N:xue([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],v,b),I=[].concat((0,ln.Z)(A({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:F})),(0,ln.Z)(A({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:F})),(0,ln.Z)(A({partName:"ticks",mark:D,positionPrefix:"lower_whisker",aria:!1,extraEncoding:F})),(0,ln.Z)(A({partName:"ticks",mark:D,positionPrefix:"upper_whisker",aria:!1,extraEncoding:F}))),M=[].concat((0,ln.Z)("tukey"!==d?I:[]),(0,ln.Z)(E({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:k,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:N})),(0,ln.Z)(T({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},see(a.boxplot.median)&&a.boxplot.median.color?{color:a.boxplot.median.color}:{}),f?{size:f}:{}),{orient:x,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:N})));if("min-max"!==d){var O='datum["lower_box_'.concat(v.field,'"]'),R='datum["upper_box_'.concat(v.field,'"]'),Z="(".concat(R," - ").concat(O,")"),B="".concat(O," - ").concat(l," * ").concat(Z),z="".concat(R," + ").concat(l," * ").concat(Z),L='datum["'.concat(v.field,'"]'),P={joinaggregate:Fue(v.field),groupby:m},j=void 0;"tukey"===d&&(j={transform:[{filter:"(".concat(B," <= ").concat(L,") && (").concat(L," <= ").concat(z,")")},{aggregate:[{op:"min",field:v.field,as:"lower_whisker_"+v.field},{op:"max",field:v.field,as:"upper_whisker_"+v.field},{op:"min",field:"lower_box_"+v.field,as:"lower_box_"+v.field},{op:"max",field:"upper_box_"+v.field,as:"upper_box_"+v.field}].concat((0,ln.Z)(y)),groupby:m}],layer:I});C.tooltip;var U=kee(C,["tooltip"]),W=v.scale,V=v.axis,G=kue(v),q=_ue(s,"outliers",a.boxplot,!0,{transform:[{filter:"(".concat(L," < ").concat(B,") || (").concat(L," > ").concat(z,")")}],mark:"point",encoding:Object.assign(Object.assign((0,qn.Z)({},g,Object.assign(Object.assign(Object.assign({field:v.field,type:v.type},void 0!==G?{title:G}:{}),void 0!==W?{scale:W}:{}),void 0!==V?{axis:V}:{})),U),w?{tooltip:w}:{})})[0];q&&j?c={transform:[P],layer:[q,j]}:q?(c=q).transform.unshift(P):j&&(c=j).transform.unshift(P)}return c?Object.assign(Object.assign({},u),{layer:[c,{transform:p,layer:M}]}):Object.assign(Object.assign({},u),{transform:(null!==(r=u.transform)&&void 0!==r?r:[]).concat(p),layer:M})}function Fue(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}var Iue="errorbar",Mue=new Hte(Iue,Oue);function Oue(e,t){var n=t.config,r=Zue(e,Iue,n),a=r.transform,i=r.continuousAxisChannelDef,o=r.continuousAxis,u=r.encodingWithoutContinuousAxis,s=r.ticksOrient,c=r.markDef,l=r.outerSpec,f=r.tooltipEncoding,d=wue(c,o,i,u,n.errorbar),h={type:"tick",orient:s},p=[].concat((0,ln.Z)(d({partName:"ticks",mark:h,positionPrefix:"lower",aria:!1,extraEncoding:f})),(0,ln.Z)(d({partName:"ticks",mark:h,positionPrefix:"upper",aria:!1,extraEncoding:f})),(0,ln.Z)(d({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:f})));return Object.assign(Object.assign(Object.assign({},l),{transform:a}),p.length>1?{layer:p}:Object.assign({},p[0]))}function Rue(e,t){var n=e.encoding;if(function(e){return(koe(e.x)||koe(e.y))&&!koe(e.x2)&&!koe(e.y2)&&!koe(e.xError)&&!koe(e.xError2)&&!koe(e.yError)&&!koe(e.yError2)}(n))return{orient:Aue(e,t),inputType:"raw"};var r=function(e){return koe(e.x2)||koe(e.y2)}(n),a=function(e){return koe(e.xError)||koe(e.xError2)||koe(e.yError)||koe(e.yError2)}(n),i=n.x,o=n.y;if(r){if(a)throw new Error("".concat(t," cannot be both type aggregated-upper-lower and aggregated-error"));var u=n.x2,s=n.y2;if(koe(u)&&koe(s))throw new Error("".concat(t," cannot have both x2 and y2"));if(koe(u)){if(boe(i))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in ".concat(t))}if(koe(s)){if(boe(o))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in ".concat(t))}throw new Error("No ranged axis")}var c=n.xError,l=n.xError2,f=n.yError,d=n.yError2;if(koe(l)&&!koe(c))throw new Error("".concat(t," cannot have xError2 without xError"));if(koe(d)&&!koe(f))throw new Error("".concat(t," cannot have yError2 without yError"));if(koe(c)&&koe(f))throw new Error("".concat(t," cannot have both xError and yError with both are quantiative"));if(koe(c)){if(boe(i))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(koe(f)){if(boe(o))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}function Zue(e,t,n){var r,a=e.mark,i=e.encoding,o=e.selection,u=(e.projection,kee(e,["mark","encoding","selection","projection"])),s=Pte(a)?a:{type:a};o&&oae(Mre(t));var c=Rue(e,t),l=c.orient,f=c.inputType,d=Cue(e,l,t),h=d.continuousAxisChannelDef,p=d.continuousAxisChannelDef2,v=d.continuousAxisChannelDefError,g=d.continuousAxisChannelDefError2,m=d.continuousAxis,y=function(e,t,n,r,a,i,o,u){var s,c=[],l=[],f=t.field,d=!1;if("raw"===i){var h,p,v,g=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":u.errorbar.center,m=e.extent?e.extent:"mean"===g?"stderr":"iqr";if("median"===g!==("iqr"===m)&&oae(function(e,t,n){return"".concat(e," is not usually used with ").concat(t," for ").concat(n,".")}(g,m,o)),"stderr"===m||"stdev"===m)c=[{op:m,field:f,as:"extent_"+f},{op:g,field:f,as:"center_"+f}],l=[{calculate:'datum["center_'.concat(f,'"] + datum["extent_').concat(f,'"]'),as:"upper_"+f},{calculate:'datum["center_'.concat(f,'"] - datum["extent_').concat(f,'"]'),as:"lower_"+f}],s=[{fieldPrefix:"center_",titlePrefix:nte(g)},{fieldPrefix:"upper_",titlePrefix:Bue(g,m,"+")},{fieldPrefix:"lower_",titlePrefix:Bue(g,m,"-")}],d=!0;else e.center&&e.extent&&oae(function(e,t){return"Center is not needed to be specified in ".concat(t," when extent is ").concat(e,".")}(e.extent,o)),"ci"===m?(h="mean",p="ci0",v="ci1"):(h="median",p="q1",v="q3"),c=[{op:p,field:f,as:"lower_"+f},{op:v,field:f,as:"upper_"+f},{op:h,field:f,as:"center_"+f}],s=[{fieldPrefix:"upper_",titlePrefix:Boe({field:f,aggregate:v,type:"quantitative"},u,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Boe({field:f,aggregate:p,type:"quantitative"},u,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Boe({field:f,aggregate:h,type:"quantitative"},u,{allowDisabling:!1})}]}else{(e.center||e.extent)&&oae(function(e,t){return"".concat(t?"extent ":"").concat(t&&e?"and ":"").concat(e?"center ":"").concat(t&&e?"are ":"is ","not needed when data are aggregated.")}(e.center,e.extent)),"aggregated-upper-lower"===i?(s=[],l=[{calculate:'datum["'.concat(n.field,'"]'),as:"upper_"+f},{calculate:'datum["'.concat(f,'"]'),as:"lower_"+f}]):"aggregated-error"===i&&(s=[{fieldPrefix:"",titlePrefix:f}],l=[{calculate:'datum["'.concat(f,'"] + datum["').concat(r.field,'"]'),as:"upper_"+f}],a?l.push({calculate:'datum["'.concat(f,'"] + datum["').concat(a.field,'"]'),as:"lower_"+f}):l.push({calculate:'datum["'.concat(f,'"] - datum["').concat(r.field,'"]'),as:"lower_"+f}));var y,b=(0,Zt.Z)(l);try{for(b.s();!(y=b.n()).done;){var x=y.value;s.push({fieldPrefix:x.as.substring(0,6),titlePrefix:ute(ute(x.calculate,'datum["',""),'"]',"")})}}catch(k){b.e(k)}finally{b.f()}}return{postAggregateCalculates:l,errorBarSpecificAggregate:c,tooltipSummary:s,tooltipTitleWithFieldName:d}}(s,h,p,v,g,f,t,n),b=y.errorBarSpecificAggregate,x=y.postAggregateCalculates,k=y.tooltipSummary,w=y.tooltipTitleWithFieldName,_=i,C=m,S=(_[C],"x"===m?"x2":"y2"),A=(_[S],"x"===m?"xError":"yError"),E=(_[A],"x"===m?"xError2":"yError2"),T=(_[E],pue(kee(_,["symbol"===typeof C?C:C+"","symbol"===typeof S?S:S+"","symbol"===typeof A?A:A+"","symbol"===typeof E?E:E+""]),n)),N=T.bins,D=T.timeUnits,F=T.aggregate,I=T.groupby,M=T.encoding,O=[].concat((0,ln.Z)(F),(0,ln.Z)(b)),R="raw"!==f?[]:I,Z=xue(k,h,M,w);return{transform:[].concat((0,ln.Z)(null!==(r=u.transform)&&void 0!==r?r:[]),(0,ln.Z)(N),(0,ln.Z)(D),(0,ln.Z)(0===O.length?[]:[{aggregate:O,groupby:R}]),(0,ln.Z)(x)),groupby:R,continuousAxisChannelDef:h,continuousAxis:m,encodingWithoutContinuousAxis:M,ticksOrient:"vertical"===l?"horizontal":"vertical",markDef:s,outerSpec:u,tooltipEncoding:Z}}function Bue(e,t,n){return nte(e)+" "+n+" "+t}var zue="errorband",Lue=new Hte(zue,Pue);function Pue(e,t){var n=t.config,r=Zue(e,zue,n),a=r.transform,i=r.continuousAxisChannelDef,o=r.continuousAxis,u=r.encodingWithoutContinuousAxis,s=r.markDef,c=r.outerSpec,l=r.tooltipEncoding,f=s,d=wue(f,o,i,u,n.errorband),h=void 0!==e.encoding.x&&void 0!==e.encoding.y,p={type:h?"area":"rect"},v={type:h?"line":"rule"},g=Object.assign(Object.assign({},f.interpolate?{interpolate:f.interpolate}:{}),f.tension&&f.interpolate?{tension:f.tension}:{});return h?(p=Object.assign(Object.assign(Object.assign({},p),g),{ariaRoleDescription:"errorband"}),v=Object.assign(Object.assign({},v),g)):f.interpolate?oae(eae("interpolate")):f.tension&&oae(eae("tension")),Object.assign(Object.assign({},c),{transform:a,layer:[].concat((0,ln.Z)(d({partName:"band",mark:p,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l})),(0,ln.Z)(d({partName:"borders",mark:v,positionPrefix:"lower",aria:!1,extraEncoding:l})),(0,ln.Z)(d({partName:"borders",mark:v,positionPrefix:"upper",aria:!1,extraEncoding:l})))})}var jue={};function Uue(e,t,n){var r=new Hte(e,t);jue[e]={normalizer:r,parts:n}}Uue(Eue,Due,["box","median","outliers","rule","ticks"]),Uue(Iue,Oue,["ticks","rule"]),Uue(zue,Pue,["band","borders"]);var Wue=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],Vue=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],Gue={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},que={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Hue=(Yee(que),"_vgsid_"),Xue={single:{on:"click",fields:[Hue],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[Hue],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function Yue(e){return!!e&&("legend"===e||!!e.legend)}function Kue(e){return Yue(e)&&see(e)}function $ue(e){return"concat"in e}function Que(e){return"vconcat"in e}function Jue(e){return"hconcat"in e}function ese(e){return see(e)&&void 0!==e.step}function tse(e){return e.view||e.width||e.height}var nse=Yee({align:1,bounds:1,center:1,columns:1,spacing:1});function rse(e,t){var n;return null!==(n=e[t])&&void 0!==n?n:e["width"===t?"continuousWidth":"continuousHeight"]}function ase(e,t){var n=ise(e,t);return ese(n)?n.step:ose}function ise(e,t){var n;return lte(null!==(n=e[t])&&void 0!==n?n:e["width"===t?"discreteWidth":"discreteHeight"],{step:e.step})}var ose=20;var use={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:ose},mark:{color:"#4c78a8",invalid:"filter",timeUnitBand:1},arc:{},area:{},bar:Vte,circle:{},geoshape:{},image:{},line:{},point:{},rect:Gte,rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:Xue,style:{},title:{},facet:{spacing:20},concat:{spacing:20}},sse=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],cse={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},lse={blue:sse[0],orange:sse[1],red:sse[2],teal:sse[3],green:sse[4],yellow:sse[5],purple:sse[6],pink:sse[7],brown:sse[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function fse(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{signals:[{name:"color",value:see(e)?Object.assign(Object.assign({},lse),e):lse}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function dse(e){return{signals:[{name:"fontSize",value:see(e)?Object.assign(Object.assign({},cse),e):cse}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function hse(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function pse(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.color,n=e.font,r=e.fontSize,a=kee(e,["color","font","fontSize"]);return lee({},use,n?hse(n):{},t?fse(t):{},r?dse(r):{},a||{})}var vse=["view"].concat((0,ln.Z)(Lte)),gse=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],mse=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]});function yse(e){e=Oee(e);var t,n=(0,Zt.Z)(gse);try{for(n.s();!(t=n.n()).done;){delete e[t.value]}}catch(_){n.e(_)}finally{n.f()}if(e.axis)for(var r in e.axis)gte(e.axis[r])&&delete e.axis[r];if(e.legend){var a,i=(0,Zt.Z)(Wue);try{for(i.s();!(a=i.n()).done;){var o=a.value;delete e.legend[o]}}catch(_){i.e(_)}finally{i.f()}}if(e.mark){var u,s=(0,Zt.Z)(Ute);try{for(s.s();!(u=s.n()).done;){var c=u.value;delete e.mark[c]}}catch(_){s.e(_)}finally{s.f()}e.mark.tooltip&&see(e.mark.tooltip)&&delete e.mark.tooltip}var l,f=(0,Zt.Z)(vse);try{for(f.s();!(l=f.n()).done;){var d,h=l.value,p=(0,Zt.Z)(Ute);try{for(p.s();!(d=p.n()).done;){var v=d.value;delete e[h][v]}}catch(_){p.e(_)}finally{p.f()}var g=mse[h];if(g){var m,y=(0,Zt.Z)(g);try{for(y.s();!(m=y.n()).done;){var b=m.value;delete e[h][b]}}catch(_){y.e(_)}finally{y.f()}}bse(e,h)}}catch(_){f.e(_)}finally{f.f()}var x,k=(0,Zt.Z)(Yee(jue));try{for(k.s();!(x=k.n()).done;){delete e[x.value]}}catch(_){k.e(_)}finally{k.f()}for(var w in function(e){var t=Qoe(e.title),n=t.titleMarkConfig,r=t.subtitleMarkConfig,a=t.subtitle;Xee(n)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),n));Xee(r)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),r));Xee(a)?delete e.title:e.title=a}(e),e)see(e[w])&&Xee(e[w])&&delete e[w];return Xee(e)?void 0:e}function bse(e,t,n,r){var a=r?e[t][r]:e[t];"view"===t&&(n="cell");var i=Object.assign(Object.assign({},a),e.style[null!==n&&void 0!==n?n:t]);Xee(i)||(e.style[null!==n&&void 0!==n?n:t]=i),r||delete e[t]}function xse(e){return"layer"in e}var kse=function(){function e(){(0,Jh.Z)(this,e)}return(0,ep.Z)(e,[{key:"map",value:function(e,t){return soe(e)?this.mapFacet(e,t):function(e){return"repeat"in e}(e)?this.mapRepeat(e,t):Jue(e)?this.mapHConcat(e,t):Que(e)?this.mapVConcat(e,t):$ue(e)?this.mapConcat(e,t):this.mapLayerOrUnit(e,t)}},{key:"mapLayerOrUnit",value:function(e,t){if(xse(e))return this.mapLayer(e,t);if(qte(e))return this.mapUnit(e,t);throw new Error(Are(e))}},{key:"mapLayer",value:function(e,t){var n=this;return Object.assign(Object.assign({},e),{layer:e.layer.map((function(e){return n.mapLayerOrUnit(e,t)}))})}},{key:"mapHConcat",value:function(e,t){var n=this;return Object.assign(Object.assign({},e),{hconcat:e.hconcat.map((function(e){return n.map(e,t)}))})}},{key:"mapVConcat",value:function(e,t){var n=this;return Object.assign(Object.assign({},e),{vconcat:e.vconcat.map((function(e){return n.map(e,t)}))})}},{key:"mapConcat",value:function(e,t){var n=this,r=e.concat,a=kee(e,["concat"]);return Object.assign(Object.assign({},a),{concat:r.map((function(e){return n.map(e,t)}))})}},{key:"mapFacet",value:function(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}},{key:"mapRepeat",value:function(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}}]),e}(),wse={zero:1,center:1,normalize:1};function _se(e){return e in wse}var Cse=new Set([_te,Ste,Cte,Dte,Tte,Ote,Rte,Ete,Fte,Ite]),Sse=new Set([Ste,Cte,_te]);function Ase(e,t){var n,r,a="x"===t?"y":"radius",i=e[t],o=e[a];if(goe(i)&&goe(o))if("quantitative"===moe(i)&&"quantitative"===moe(o)){if(i.stack)return t;if(o.stack)return a;var u=goe(i)&&!!i.aggregate;if(u!==(goe(o)&&!!o.aggregate))return u?t:a;var s=null===(n=i.scale)||void 0===n?void 0:n.type,c=null===(r=o.scale)||void 0===r?void 0:r.type;if(s&&"linear"!==s)return a;if(c&&"linear"!==c)return t}else{if("quantitative"===moe(i))return t;if("quantitative"===moe(o))return a}else{if("quantitative"===moe(i))return t;if("quantitative"===moe(o))return a}}function Ese(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function Tse(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Pte(e)?e.type:e;if(!Cse.has(r))return null;var a=Ase(t,"x")||Ase(t,"theta");if(!a)return null;var i=t[a],o=goe(i)?Noe(i,{}):void 0,u=Ese(a),s=t[u],c=goe(s)?Noe(s,{}):void 0;c===o&&(c=void 0,s=void 0,u=void 0);var l,f=rre.reduce((function(e,n){if("tooltip"!==n&&due(t,n)){var r,a=t[n],i=(0,Zt.Z)(hee(a));try{for(i.s();!(r=i.n()).done;){var o=joe(r.value);if(!o.aggregate){var u=Noe(o,{});u&&u===c||e.push({channel:n,fieldDef:o})}}}catch(s){i.e(s)}finally{i.f()}}return e}),[]);if(void 0!==i.stack?l=gee(i.stack)?i.stack?"zero":null:i.stack:f.length>0&&Sse.has(r)&&(l="zero"),!l||!_se(l))return null;if(hue(t)&&0===f.length)return null;if(i.scale&&i.scale.type&&i.scale.type!==Jae){if(n.disallowNonLinearStack)return null;oae($re(i.scale.type))}return koe(t[ere(a)])?(void 0!==i.stack&&oae(Kre(a)),null):(goe(i)&&i.aggregate&&!Pee(tne,i.aggregate)&&oae(Qre(i.aggregate)),{groupbyChannel:s?u:void 0,groupbyField:c,fieldChannel:a,impute:null!==i.impute&&Bte(r),stackBy:f,offset:l})}function Nse(e){e.point,e.line;var t=kee(e,["point","line"]);return Yee(t).length>1?t:t.type}function Dse(e){for(var t=0,n=["line","area","rule","trail"];t<n.length;t++){var r=n[t];e[r]&&(e=Object.assign(Object.assign({},e),(0,qn.Z)({},r,Zee(e[r],["point","line"]))))}return e}function Fse(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return"transparent"===e.point?{opacity:0}:e.point?see(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?see(t.point)?t.point:{}:void 0}function Ise(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0}var Mse=function(){function e(){(0,Jh.Z)(this,e),this.name="path-overlay"}return(0,ep.Z)(e,[{key:"hasMatchingType",value:function(e,t){if(qte(e)){var n=e.mark,r=e.encoding,a=Pte(n)?n:{type:n};switch(a.type){case"line":case"rule":case"trail":return!!Fse(a,t[a.type],r);case"area":return!!Fse(a,t[a.type],r)||!!Ise(a,t[a.type])}}return!1}},{key:"run",value:function(e,t,n){var r=t.config,a=e.selection,i=e.projection,o=e.encoding,u=e.mark,s=kee(e,["selection","projection","encoding","mark"]),c=Pte(u)?u:{type:u},l=Fse(c,r[c.type],o),f="area"===c.type&&Ise(c,r[c.type]),d=[Object.assign(Object.assign({},a?{selection:a}:{}),{mark:Nse(Object.assign(Object.assign({},"area"===c.type&&void 0===c.opacity&&void 0===c.fillOpacity?{opacity:.7}:{}),c)),encoding:Zee(o,["shape"])})],h=Tse(c,o),p=o;if(h){var v=h.fieldChannel,g=h.offset;p=Object.assign(Object.assign({},o),(0,qn.Z)({},v,Object.assign(Object.assign({},o[v]),g?{stack:g}:{})))}return f&&d.push(Object.assign(Object.assign({},i?{projection:i}:{}),{mark:Object.assign(Object.assign({type:"line"},Ree(c,["clip","interpolate","tension","tooltip"])),f),encoding:p})),l&&d.push(Object.assign(Object.assign({},i?{projection:i}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},Ree(c,["clip","tooltip"])),l),encoding:p})),n(Object.assign(Object.assign({},s),{layer:d}),Object.assign(Object.assign({},t),{config:Dse(r)}))}}]),e}(),Ose=function(){function e(){(0,Jh.Z)(this,e),this.name="RangeStep"}return(0,ep.Z)(e,[{key:"hasMatchingType",value:function(e){var t;if(qte(e)&&e.encoding){var n,r=(0,Zt.Z)(ire);try{for(r.s();!(n=r.n()).done;){var a=n.value,i=e.encoding[a];if(i&&koe(i)&&(null===(t=null===i||void 0===i?void 0:i.scale)||void 0===t?void 0:t.rangeStep))return!0}}catch(o){r.e(o)}finally{r.f()}}return!1}},{key:"run",value:function(e){var t,n,r={},a=Object.assign({},e.encoding),i=(0,Zt.Z)(ire);try{for(i.s();!(n=i.n()).done;){var o=n.value,u=tre(o),s=a[o];if(s&&koe(s)&&(null===(t=null===s||void 0===s?void 0:s.scale)||void 0===t?void 0:t.rangeStep)){var c=s.scale,l=kee(s,["scale"]),f=c,d=(f.rangeStep,kee(f,["rangeStep"]));r[u]={step:c.rangeStep},oae('Scale\'s "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.'),a=Object.assign(Object.assign({},a),(0,qn.Z)({},o,Object.assign(Object.assign({},l),Xee(d)?{}:{scale:d})))}}}catch(h){i.e(h)}finally{i.f()}return Object.assign(Object.assign(Object.assign({},r),e),{encoding:a})}}]),e}();function Rse(e,t){return t?ooe(e)?jse(e,t):zse(e,t):e}function Zse(e,t){return t?jse(e,t):e}function Bse(e,t,n){var r=t[e];return function(e){return e&&!yee(e)&&"repeat"in e}(r)?r.repeat in n?Object.assign(Object.assign({},t),(0,qn.Z)({},e,n[r.repeat])):void oae(function(e){return'Unknown repeated value "'.concat(e,'".')}(r.repeat)):t}function zse(e,t){if(void 0!==(e=Bse("field",e,t))){if(null===e)return null;if(loe(e)&&aoe(e.sort)){var n=Bse("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function Lse(e,t){if(goe(e))return zse(e,t);var n=Bse("datum",e,t);return n===e||n.type||(n.type="nominal"),n}function Pse(e,t){if(!koe(e)){if(voe(e)){var n=Lse(e.condition,t);if(n)return Object.assign(Object.assign({},e),{condition:n});e.condition;return kee(e,["condition"])}return e}var r=Lse(e,t);return r||(hoe(e)?{condition:e.condition}:void 0)}function jse(e,t){var n={};for(var r in e)if(vee(e,r)){var a=e[r];if(uee(a))n[r]=a.map((function(e){return Pse(e,t)})).filter((function(e){return e}));else{var i=Pse(a,t);void 0!==i&&(n[r]=i)}}return n}var Use=function(){function e(){(0,Jh.Z)(this,e),this.name="RuleForRangedLine"}return(0,ep.Z)(e,[{key:"hasMatchingType",value:function(e){if(qte(e)){var t=e.encoding;if("line"===e.mark){var n,r=(0,Zt.Z)(Kne);try{for(r.s();!(n=r.n()).done;){var a=n.value,i=t[Qne(a)];if(t[a]&&(goe(i)&&!kre(i.bin)||yoe(i)))return!0}}catch(o){r.e(o)}finally{r.f()}}}return!1}},{key:"run",value:function(e,t,n){var r,a,i=e.encoding;return oae((r=!!i.x2,a=!!i.y2,"Line mark is for continuous lines and thus cannot be used with ".concat(r&&a?"x2 and y2":r?"x2":"y2",". We will use the rule mark (line segments) instead."))),n(Object.assign(Object.assign({},e),{mark:"rule"}),t)}}]),e}(),Wse=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(){var e;return(0,Jh.Z)(this,n),(e=t.apply(this,arguments)).nonFacetUnitNormalizers=[Tue,Mue,Lue,new Mse,new Use,new Ose],e}return(0,ep.Z)(n,[{key:"map",value:function(e,t){if(qte(e)){var r=due(e.encoding,rne),a=due(e.encoding,ane),i=due(e.encoding,ine);if(r||a||i)return this.mapFacetedUnit(e,t)}return(0,Ax.Z)((0,Ex.Z)(n.prototype),"map",this).call(this,e,t)}},{key:"mapUnit",value:function(e,t){var n=t.parentEncoding,r=t.parentProjection,a=Object.assign(Object.assign({},e),{encoding:Zse(e.encoding,t.repeater)});if(n||r)return this.mapUnitWithParentEncodingOrProjection(a,t);var i,o=this.mapLayerOrUnit.bind(this),u=(0,Zt.Z)(this.nonFacetUnitNormalizers);try{for(u.s();!(i=u.n()).done;){var s=i.value;if(s.hasMatchingType(a,t.config))return s.run(a,t,o)}}catch(c){u.e(c)}finally{u.f()}return a}},{key:"mapRepeat",value:function(e,t){return function(e){return!uee(e.repeat)&&e.repeat.layer}(e)?this.mapLayerRepeat(e,t):this.mapNonLayerRepeat(e,t)}},{key:"mapLayerRepeat",value:function(e,t){var n=this,r=e.repeat,a=e.spec,i=kee(e,["repeat","spec"]),o=r.row,u=r.column,s=r.layer,c=t.repeater,l=void 0===c?{}:c,f=t.repeaterPrefix,d=void 0===f?"":f;return o||u?this.mapRepeat(Object.assign(Object.assign({},e),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),u?{column:u}:{}),spec:{repeat:{layer:s},spec:a}}),t):Object.assign(Object.assign({},i),{layer:s.map((function(e){var r=Object.assign(Object.assign({},l),{layer:e}),i=(a.name||"")+d+"child__layer_".concat(Jee(e)),o=n.mapLayerOrUnit(a,Object.assign(Object.assign({},t),{repeater:r,repeaterPrefix:i}));return o.name=i,o}))})}},{key:"mapNonLayerRepeat",value:function(e,t){var n,r=e,a=r.repeat,i=r.spec,o=r.data,u=kee(e,["repeat","spec","data"]);!uee(a)&&e.columns&&(e=Zee(e,["columns"]),oae(Ore("repeat")));var s,c=[],l=t.repeater,f=void 0===l?{}:l,d=t.repeaterPrefix,h=void 0===d?"":d,p=!uee(a)&&a.row||[f?f.row:null],v=!uee(a)&&a.column||[f?f.column:null],g=uee(a)&&a||[f?f.repeat:null],m=(0,Zt.Z)(g);try{for(m.s();!(s=m.n()).done;){var y,b=s.value,x=(0,Zt.Z)(p);try{for(x.s();!(y=x.n()).done;){var k,w=y.value,_=(0,Zt.Z)(v);try{for(_.s();!(k=_.n()).done;){var C=k.value,S={repeat:b,row:w,column:C,layer:f.layer},A=(i.name||"")+h+"child__"+(uee(a)?"".concat(Jee(b)):(a.row?"row_".concat(Jee(w)):"")+(a.column?"column_".concat(Jee(C)):"")),E=this.map(i,Object.assign(Object.assign({},t),{repeater:S,repeaterPrefix:A}));E.name=A,c.push(Zee(E,["data"]))}}catch(N){_.e(N)}finally{_.f()}}}catch(N){x.e(N)}finally{x.f()}}}catch(N){m.e(N)}finally{m.f()}var T=uee(a)?e.columns:a.column?a.column.length:1;return Object.assign(Object.assign({data:null!==(n=i.data)&&void 0!==n?n:o,align:"all"},u),{columns:T,concat:c})}},{key:"mapFacet",value:function(e,t){return ooe(e.facet)&&e.columns&&(e=Zee(e,["columns"]),oae(Ore("facet"))),(0,Ax.Z)((0,Ex.Z)(n.prototype),"mapFacet",this).call(this,e,t)}},{key:"mapUnitWithParentEncodingOrProjection",value:function(e,t){var n=e.encoding,r=e.projection,a=t.parentEncoding,i=t.parentProjection,o=t.config,u=Gse({parentProjection:i,projection:r}),s=Vse({parentEncoding:a,encoding:Zse(n,t.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},e),u?{projection:u}:{}),s?{encoding:s}:{}),{config:o})}},{key:"mapFacetedUnit",value:function(e,t){var n=e.encoding,r=n.row,a=n.column,i=n.facet,o=kee(n,["row","column","facet"]),u=e.mark,s=e.width,c=e.projection,l=e.height,f=e.view,d=e.selection,h=(e.encoding,kee(e,["mark","width","projection","height","view","selection","encoding"])),p=this.getFacetMappingAndLayout({row:r,column:a,facet:i},t),v=p.facetMapping,g=p.layout,m=Zse(o,t.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},h),g),{facet:v,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},s?{width:s}:{}),l?{height:l}:{}),f?{view:f}:{}),c?{projection:c}:{}),{mark:u,encoding:m}),d?{selection:d}:{})}),t)}},{key:"getFacetMappingAndLayout",value:function(e,t){var n,r=e.row,a=e.column,i=e.facet;if(r||a){i&&oae((g=[].concat((0,ln.Z)(r?[rne]:[]),(0,ln.Z)(a?[ane]:[])),"Facet encoding dropped as ".concat(g.join(" and ")," ").concat(g.length>1?"are":"is"," also specified.")));for(var o={},u={},s=0,c=[rne,ane];s<c.length;s++){var l=c[s],f=e[l];if(f){f.align,f.center,f.spacing,f.columns;var d=kee(f,["align","center","spacing","columns"]);o[l]=d;for(var h=0,p=["align","center","spacing"];h<p.length;h++){var v=p[h];void 0!==f[v]&&(u[v]=null!==(n=u[v])&&void 0!==n?n:{},u[v][l]=f[v])}}}return{facetMapping:o,layout:u}}var g,m=i.align,y=i.center,b=i.spacing,x=i.columns;return{facetMapping:Rse(kee(i,["align","center","spacing","columns"]),t.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},m?{align:m}:{}),y?{center:y}:{}),b?{spacing:b}:{}),x?{columns:x}:{})}}},{key:"mapLayer",value:function(e,t){var r=t.parentEncoding,a=t.parentProjection,i=kee(t,["parentEncoding","parentProjection"]),o=e.encoding,u=e.projection,s=kee(e,["encoding","projection"]),c=Object.assign(Object.assign({},i),{parentEncoding:Vse({parentEncoding:r,encoding:o}),parentProjection:Gse({parentProjection:a,projection:u})});return(0,Ax.Z)((0,Ex.Z)(n.prototype),"mapLayer",this).call(this,s,c)}}]),n}(kse);function Vse(e){var t,n=e.parentEncoding,r=e.encoding;if(n&&r){var a=Yee(n).reduce((function(e,t){return r[t]&&e.push(t),e}),[]);a.length>0&&oae("Layer's shared ".concat((t=a).join(",")," channel ").concat(1===t.length?"is":"are"," overriden."))}var i=Object.assign(Object.assign({},null!==n&&void 0!==n?n:{}),null!==r&&void 0!==r?r:{});return Xee(i)?void 0:i}function Gse(e){var t=e.parentProjection,n=e.projection;return t&&n&&oae(function(e){var t=e.parentProjection,n=e.projection;return"Layer's shared projection ".concat(Bee(t)," is overridden by a child projection ").concat(Bee(n),".")}({parentProjection:t,projection:n})),null!==n&&void 0!==n?n:t}function qse(e,t){void 0===t&&(t=pse(e.config));var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Hse.map(e,{config:t})}(e,t),r=function(e,t,n){var r=t.width,a=t.height,i=qte(e)||xse(e),o={};i?"container"==r&&"container"==a?(o.type="fit",o.contains="padding"):"container"==r?(o.type="fit-x",o.contains="padding"):"container"==a&&(o.type="fit-y",o.contains="padding"):("container"==r&&(oae(Tre("width")),r=void 0),"container"==a&&(oae(Tre("height")),a=void 0));var u=Object.assign(Object.assign(Object.assign({type:"pad"},o),n?Xse(n.autosize):{}),Xse(e.autosize));"fit"!==u.type||i||(oae(Ere),u.type="pad");"container"==r&&"fit"!=u.type&&"fit-x"!=u.type&&oae(Nre("width"));"container"==a&&"fit"!=u.type&&"fit-y"!=u.type&&oae(Nre("height"));if(Mee(u,{type:"pad"}))return;return u}(n,{width:e.width,height:e.height,autosize:e.autosize},t);return Object.assign(Object.assign({},n),r?{autosize:r}:{})}var Hse=new Wse;function Xse(e){return yee(e)?{type:e}:null!==e&&void 0!==e?e:{}}var Yse=["background","padding"];function Kse(e){return Yse.reduce((function(t,n){return e&&void 0!==e[n]&&(t[n]=e[n]),t}),{})}var $se=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,Jh.Z)(this,e),this.explicit=t,this.implicit=n}return(0,ep.Z)(e,[{key:"clone",value:function(){return new e(Oee(this.explicit),Oee(this.implicit))}},{key:"combine",value:function(){return Object.assign(Object.assign({},this.explicit),this.implicit)}},{key:"get",value:function(e){return lte(this.explicit[e],this.implicit[e])}},{key:"getWithExplicit",value:function(e){return void 0!==this.explicit[e]?{explicit:!0,value:this.explicit[e]}:void 0!==this.implicit[e]?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0}}},{key:"setWithExplicit",value:function(e,t){void 0!==t.value&&this.set(e,t.value,t.explicit)}},{key:"set",value:function(e,t,n){return delete this[n?"implicit":"explicit"][e],this[n?"explicit":"implicit"][e]=t,this}},{key:"copyKeyFromSplit",value:function(e,t){void 0!==t.explicit[e]?this.set(e,t.explicit[e],!0):void 0!==t.implicit[e]&&this.set(e,t.implicit[e],!1)}},{key:"copyKeyFromObject",value:function(e,t){void 0!==t[e]&&this.set(e,t[e],!0)}},{key:"copyAll",value:function(e){var t,n=(0,Zt.Z)(Yee(e.combine()));try{for(n.s();!(t=n.n()).done;){var r=t.value,a=e.getWithExplicit(r);this.setWithExplicit(r,a)}}catch(i){n.e(i)}finally{n.f()}}}]),e}();function Qse(e){return{explicit:!0,value:e}}function Jse(e){return{explicit:!1,value:e}}function ece(e){return function(t,n,r,a){var i=e(t.value,n.value);return i>0?t:i<0?n:tce(t,n,r,a)}}function tce(e,t,n,r){return e.explicit&&t.explicit&&oae(function(e,t,n,r){return"Conflicting ".concat(t.toString(),' property "').concat(e.toString(),'" (').concat(Bee(n)," and ").concat(Bee(r),"). Using ").concat(Bee(n),".")}(n,r,e.value,t.value)),e}function nce(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:tce;return void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:Mee(e.value,t.value)?e:a(e,t,n,r)}var rce=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,Jh.Z)(this,n),(e=t.call(this,r,a)).explicit=r,e.implicit=a,e.parseNothing=i,e}return(0,ep.Z)(n,[{key:"clone",value:function(){var e=(0,Ax.Z)((0,Ex.Z)(n.prototype),"clone",this).call(this);return e.parseNothing=this.parseNothing,e}}]),n}($se);function ace(e){return"url"in e}function ice(e){return"values"in e}function oce(e){return"name"in e&&!ace(e)&&!ice(e)&&!uce(e)}function uce(e){return e&&(sce(e)||cce(e)||lce(e))}function sce(e){return"sequence"in e}function cce(e){return"sphere"in e}function lce(e){return"graticule"in e}var fce="main",dce="raw";function hce(e){return"filter"in e}function pce(e){return"lookup"in e}function vce(e){return"pivot"in e}function gce(e){return"density"in e}function mce(e){return"quantile"in e}function yce(e){return"regression"in e}function bce(e){return"loess"in e}function xce(e){return"sample"in e}function kce(e){return"window"in e}function wce(e){return"joinaggregate"in e}function _ce(e){return"flatten"in e}function Cce(e){return"calculate"in e}function Sce(e){return"bin"in e}function Ace(e){return"impute"in e}function Ece(e){return"timeUnit"in e}function Tce(e){return"aggregate"in e}function Nce(e){return"stack"in e}function Dce(e){return"fold"in e}function Fce(e,t,n,r){var a=hoe(t)&&t.condition,i=r(t);if(a){var o=hee(a).map((function(t){var n=r(t),a=function(e){return e.selection}(t)?_de(e,t.selection):Sde(e,t.test);return Object.assign({test:a},n)}));return(0,qn.Z)({},n,[].concat((0,ln.Z)(o),(0,ln.Z)(void 0!==i?[i]:[])))}return void 0!==i?(0,qn.Z)({},n,i):{}}function Ice(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text",n=e.encoding[t];return Fce(e,n,t,(function(t){return Mce(t,e.config)}))}function Mce(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"datum";if(e){if(_oe(e))return eue(e.value);if(koe(e)){var r=Poe(e),a=r.format,i=r.formatType;return Gie({fieldOrDatumDef:e,format:a,formatType:i,expr:n,config:t})}}}function Oce(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.encoding,r=e.markDef,a=e.config,i=e.stack,o=n.tooltip;if(uee(o))return{tooltip:Zce({tooltip:o},i,a,t)};var u=t.reactiveGeom?"datum.datum":"datum";return Fce(e,o,"tooltip",(function(e){var o=Mce(e,a,u);if(o)return o;if(null!==e){var s=aue("tooltip",r,a);return!0===s&&(s={content:"encoding"}),yee(s)?{value:s}:see(s)?"encoding"===s.content?Zce(n,i,a,t):{signal:u}:void 0}}))}function Rce(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=r.reactiveGeom,i={},o=a?"datum.datum":"datum",u=[];function s(r,a){var s,c=Qne(a),l=woe(r)?r:Object.assign(Object.assign({},r),{type:e[c].type}),f=hee(Boe(l,n,{allowDisabling:!1})).join(", ");if(ore(a)){var d="x"===a?"x2":"y2",h=joe(e[d]);if(kre(l.bin)&&h){var p=Noe(l,{expr:o}),v=Noe(h,{expr:o}),g=Poe(l);s=Jie(p,v,g.format,g.formatType,n),i[d]=!0}else if(t&&t.fieldChannel===a&&"normalize"===t.offset){var m=Poe(l);s=Gie({fieldOrDatumDef:l,format:m.format,formatType:m.formatType,expr:o,config:n,normalizeStack:!0}).signal}}s=null!==s&&void 0!==s?s:Mce(l,n,o).signal,u.push({channel:a,key:f,value:s})}mue(e,(function(e,t){goe(e)?s(e,t):poe(e)&&s(e.condition,t)}));for(var c={},l=0,f=u;l<f.length;l++){var d=f[l],h=d.channel,p=d.key,v=d.value;i[h]||c[p]||(c[bee(p)]=v)}return c}function Zce(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=r.reactiveGeom,i=Rce(e,t,n,{reactiveGeom:a}),o=$ee(i).map((function(e){var t=e.key,n=e.value;return"".concat(t,": ").concat(n)}));return o.length>0?{signal:"{".concat(o.join(", "),"}")}:void 0}function Bce(e){var t=aue("aria",e.markDef,e.config);return!1===t?{}:Object.assign(Object.assign(Object.assign({},t?{aria:t}:{}),function(e){var t=e.mark,n=e.markDef,r=e.config;if(!1===r.aria)return{};var a=aue("ariaRoleDescription",n,r);if(null!=a)return{ariaRoleDescription:{value:a}};return t in Dae?{}:{ariaRoleDescription:{value:t}}}(e)),function(e){var t=e.encoding,n=e.markDef,r=e.config,a=e.stack,i=t.description;if(i)return Fce(e,i,"description",(function(t){return Mce(t,e.config)}));var o=aue("description",n,r);if(null!=o)return{description:eue(o)};if(!1===r.aria)return{};var u=Rce(t,a,r);if(Xee(u))return;return{description:{signal:$ee(u).map((function(e){var t=e.key,n=e.value;return"".concat(t,' + ": " + (').concat(n,")")})).join(' + "; " + ')}}}(e))}function zce(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.markDef,a=t.encoding,i=t.config,o=n.vgChannel,u=n.defaultRef,s=n.defaultValue;void 0===u&&void 0!==(s=null!==s&&void 0!==s?s:aue(e,r,i,{vgChannel:o,ignoreVgConfig:!0}))&&(u=eue(s));var c=a[e];return Fce(t,c,null!==o&&void 0!==o?o:e,(function(n){return jie({channel:e,channelDef:n,markDef:r,config:i,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:u})}))}function Lce(e){var t,n,r,a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{filled:void 0},o=e.markDef,u=e.encoding,s=e.config,c=o.type,l=null!==(t=i.filled)&&void 0!==t?t:aue("filled",o,s),f=Pee(["bar","point","circle","square","geoshape"],c)?"transparent":void 0,d=null!==(r=null!==(n=aue(!0===l?"color":void 0,o,s,{vgChannel:"fill"}))&&void 0!==n?n:s.mark[!0===l&&"color"])&&void 0!==r?r:f,h=null!==(a=aue(!1===l?"color":void 0,o,s,{vgChannel:"stroke"}))&&void 0!==a?a:s.mark[!1===l&&"color"],p=l?"fill":"stroke",v=Object.assign(Object.assign({},d?{fill:eue(d)}:{}),h?{stroke:eue(h)}:{});return o.color&&(l?o.fill:o.stroke)&&oae(Lre("property",{fill:"fill"in o,stroke:"stroke"in o})),Object.assign(Object.assign(Object.assign(Object.assign({},v),zce("color",e,{vgChannel:p,defaultValue:l?d:h})),zce("fill",e,{defaultValue:u.fill?d:void 0})),zce("stroke",e,{defaultValue:u.stroke?h:void 0}))}function Pce(e,t){var n=function(e){switch(e){case one:return"xOffset";case une:return"yOffset";case sne:return"x2Offset";case cne:return"y2Offset";case dne:return"thetaOffset";case lne:return"radiusOffset";case hne:return"theta2Offset";case fne:return"radius2Offset"}}(e),r=t[n];if(r)return r}function jce(e,t,n){var r=n.defaultPos,a=n.vgChannel,i=n.isMidPoint,o=t.encoding,u=t.markDef,s=t.config,c=t.stack,l=o[e],f=o[ere(e)],d=t.scaleName(e),h=t.getScaleComponent(e),p=Pce(e,u),v=Uce({model:t,defaultPos:r,channel:e,scaleName:d,scale:h}),g=!l&&ore(e)&&(o.latitude||o.longitude)?{field:t.getName(e)}:function(e){var t=e.channel,n=e.channelDef,r=e.isMidPoint,a=e.scaleName,i=e.stack,o=e.offset,u=e.markDef,s=e.config;if(koe(n)&&i&&t===i.fieldChannel){if(goe(n)){var c=foe({channel:t,fieldDef:n,isMidPoint:r,markDef:u,stack:i,config:s});if(void 0!==c)return Pie({scaleName:a,fieldOrDatumDef:n,startSuffix:"start",band:c,offset:o})}return Lie(n,a,{suffix:"end"},{offset:o})}return Rie(e)}({channel:e,channelDef:l,channel2Def:f,markDef:u,config:s,isMidPoint:i,scaleName:d,scale:h,stack:c,offset:p,defaultRef:v});return g?(0,qn.Z)({},a||e,g):void 0}function Uce(e){var t=e.model,n=e.defaultPos,r=e.channel,a=e.scaleName,i=e.scale,o=t.markDef,u=t.config;return function(){var e=Qne(r),s=Jne(r),c=aue(r,o,u,{vgChannel:s});if(void 0!==c)return Uie(r,c);switch(n){case"zeroOrMin":case"zeroOrMax":if(a){var l=i.get("type");if(Pee([eie,aie,iie],l));else if(i.domainDefinitelyIncludesZero())return{scale:a,value:0}}if("zeroOrMin"===n)return"y"===e?{field:{group:"height"}}:{value:0};switch(e){case"radius":return{signal:"min(".concat(t.width.signal,",").concat(t.height.signal,")/2")};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":var f=t[tre(r)];return Object.assign(Object.assign({},f),{mult:.5})}}}var Wce={left:"x",center:"xc",right:"x2"},Vce={top:"y",middle:"yc",bottom:"y2"};function Gce(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"middle";if("radius"===e||"theta"===e)return Jne(e);var a="x"===e?"align":"baseline",i=aue(a,t,n);return"x"===e?Wce[i||("top"===r?"left":"center")]:Vce[i||r]}function qce(e,t,n){var r=n.defaultPos,a=n.defaultPos2;return n.range?Hce(e,t,{defaultPos:r,defaultPos2:a}):jce(e,t,{defaultPos:r})}function Hce(e,t,n){var r=n.defaultPos,a=n.defaultPos2,i=t.markDef,o=t.config,u=ere(e),s=tre(e),c=function(e,t,n){var r,a=e.encoding,i=e.mark,o=e.markDef,u=e.stack,s=e.config,c=Qne(n),l=tre(n),f=Jne(n),d=a[c],h=e.scaleName(c),p=e.getScaleComponent(c),v=Pce(n in a||n in o?n:c,e.markDef);if(!d&&("x2"===n||"y2"===n)&&(a.latitude||a.longitude))return(0,qn.Z)({},f,{field:e.getName(n)});var g=function(e){var t=e.channel,n=e.channelDef,r=e.channel2Def,a=e.markDef,i=e.config,o=e.scaleName,u=e.scale,s=e.stack,c=e.offset,l=e.defaultRef;if(koe(n)&&s&&t.charAt(0)===s.fieldChannel.charAt(0))return Lie(n,o,{suffix:"start"},{offset:c});return Rie({channel:t,channelDef:r,scaleName:o,scale:u,stack:s,markDef:a,config:i,offset:c,defaultRef:l})}({channel:n,channelDef:d,channel2Def:a[n],markDef:o,config:s,scaleName:h,scale:p,stack:u,offset:v,defaultRef:void 0});if(void 0!==g)return(0,qn.Z)({},f,g);return Xce(n,o)||Xce(n,(r={},(0,qn.Z)(r,n,oue(n,o,s.style)),(0,qn.Z)(r,l,oue(l,o,s.style)),r))||Xce(n,s[i])||Xce(n,s.mark)||(0,qn.Z)({},f,Uce({model:e,defaultPos:t,channel:n,scaleName:h,scale:p})())}(t,a,u),l=c[s]?Gce(e,i,o):Jne(e);return Object.assign(Object.assign({},jce(e,t,{defaultPos:r,vgChannel:l})),c)}function Xce(e,t){var n=tre(e),r=Jne(e);return void 0!==t[r]?(0,qn.Z)({},r,Uie(e,t[r])):void 0!==t[e]?(0,qn.Z)({},r,Uie(e,t[e])):t[n]?(0,qn.Z)({},n,Uie(e,t[n])):void 0}function Yce(e,t,n){var r,a,i,o,u=e.config,s=e.encoding,c=e.markDef,l=e.stack,f=ere(t),d=tre(t),h=s[t],p=s[f],v=e.getScaleComponent(t),g=v?v.get("type"):void 0,m=e.scaleName(t),y=c.orient,b=null!==(a=null!==(r=s[d])&&void 0!==r?r:s.size)&&void 0!==a?a:aue("size",c,u,{vgChannel:d}),x="bar"===n&&("x"===t?"vertical"===y:"horizontal"===y);if(goe(h)&&(xre(h.bin)||kre(h.bin)||h.timeUnit&&!p)&&!b&&!wie(g)){var k=foe({channel:t,fieldDef:h,stack:l,markDef:c,config:u}),w=null===(i=e.component.axes[t])||void 0===i?void 0:i[0];return function(e){var t,n=e.fieldDef,r=e.fieldDef2,a=e.channel,i=e.band,o=e.scaleName,u=e.markDef,s=e.spacing,c=void 0===s?0:s,l=e.axisTranslate,f=e.reverse,d=e.config,h=ere(a),p=Jne(a),v=Jne(h),g=Pce(a,u);if(xre(n.bin)||n.timeUnit)return t={},(0,qn.Z)(t,v,$ce({channel:a,fieldDef:n,scaleName:o,markDef:u,band:(1-i)/2,offset:Kce(h,c,f,l,g),config:d})),(0,qn.Z)(t,p,$ce({channel:a,fieldDef:n,scaleName:o,markDef:u,band:1-(1-i)/2,offset:Kce(a,c,f,l,g),config:d})),t;if(kre(n.bin)){var m,y,b=Lie(n,o,{},{offset:Kce(h,c,f,l,g)});if(goe(r))return m={},(0,qn.Z)(m,v,b),(0,qn.Z)(m,p,Lie(r,o,{},{offset:Kce(a,c,f,l,g)})),m;if(wre(n.bin)&&n.bin.step)return y={},(0,qn.Z)(y,v,b),(0,qn.Z)(y,p,{signal:'scale("'.concat(o,'", ').concat(Noe(n,{expr:"datum"})," + ").concat(n.bin.step,")"),offset:Kce(a,c,f,l,g)}),y}return void oae(tae(h))}({fieldDef:h,fieldDef2:p,channel:t,markDef:c,scaleName:m,band:k,axisTranslate:null!==(o=null===w||void 0===w?void 0:w.get("translate"))&&void 0!==o?o:.5,spacing:ore(t)?aue("binSpacing",c,u):void 0,reverse:v.get("reverse"),config:u})}return(koe(h)&&wie(g)||x)&&!p?function(e,t,n,r){var a,i,o=r.markDef,u=r.encoding,s=r.config,c=r.stack,l=o.orient,f=r.scaleName(n),d=r.getScaleComponent(n),h=tre(n),p=ere(n),v="horizontal"===l&&"y"===n||"vertical"===l&&"x"===n,g=aue(v?"size":h,o,s,{vgChannel:h});(u.size||void 0!==g)&&(v?i=zce("size",r,{vgChannel:h,defaultValue:g}):oae(function(e){return'Cannot apply size to non-oriented mark "'.concat(e,'".')}(o.type)));var m=null!==(a=koe(t)?foe({channel:n,fieldDef:t,markDef:o,stack:c,config:s}):void 0)&&void 0!==a?a:1;i=i||(0,qn.Z)({},h,function(e,t,n,r,a,i){if(r){var o=r.get("type");if("point"===o||"band"===o){if(void 0!==a[e].discreteBandSize)return{value:a[e].discreteBandSize};if(o===cie){var u=r.get("range");return Eae(u)&&mee(u.step)?{value:u.step-2}:{value:ose-2}}return{scale:n,band:i}}return{value:a[e].continuousBandSize}}var s=ase(a.view,t),c=lte(a[e].discreteBandSize,s-2);return void 0!==c?{value:c}:void 0}(e,h,f,d,s,m));var y="band"!==(null===d||void 0===d?void 0:d.get("type"))||!("band"in i[h]),b=Gce(n,o,s,y?"middle":"top"),x=Pce(n,o),k=Rie({channel:n,channelDef:t,markDef:o,config:s,scaleName:f,scale:d,stack:c,offset:x,defaultRef:Uce({model:r,defaultPos:"mid",channel:n,scaleName:f,scale:d}),band:y?.5:(1-m)/2});if(h)return Object.assign((0,qn.Z)({},b,k),i);var w,_=Jne(p),C=i[h],S=x?Object.assign(Object.assign({},C),{offset:x}):C;return w={},(0,qn.Z)(w,b,k),(0,qn.Z)(w,_,uee(k)?[k[0],Object.assign(Object.assign({},k[1]),{offset:S})]:Object.assign(Object.assign({},k),{offset:S})),w}(n,h,t,e):Hce(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function Kce(e,t,n,r,a){if(zne(e))return 0;var i="x"===e||"y2"===e?-t/2:t/2;if(Aae(n)){var o=nue(a);return{signal:"".concat(n.signal," ? ").concat(r-i).concat(o?"-"+o:""," : ").concat(r+i).concat(o?"+"+o:"")}}if(Aae(a)){var u=r+(n?-i:i);return{signal:"".concat(u||"").concat(n?" - ":u?" + ":"").concat(a.signal)}}return a=a||0,r+(n?-a-i:+a+i)}function $ce(e){var t=e.channel,n=e.fieldDef,r=e.scaleName,a=e.markDef,i=e.band,o=e.offset,u=e.config;return Zie({fieldDef:n,channel:t,markDef:a,ref:Pie({scaleName:r,fieldOrDatumDef:n,band:i,offset:o}),config:u})}var Qce=new Set(["aria"]);function Jce(e,t){var n="include"===t.color?Lce(e):{},r=n.fill,a=void 0===r?void 0:r,i=n.stroke,o=void 0===i?void 0:i;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function(e,t){return Nae.reduce((function(n,r){return Qce.has(r)||void 0===e[r]||"ignore"===t[r]||(n[r]=eue(e[r])),n}),{})}(e.markDef,t)),ele(e,"fill",a)),ele(e,"stroke",o)),zce("opacity",e)),zce("fillOpacity",e)),zce("strokeOpacity",e)),zce("strokeWidth",e)),zce("strokeDash",e)),Oce(e)),Ice(e,"href")),Bce(e))}function ele(e,t,n){var r=e.config,a=e.mark;if("hide"===aue("invalid",e.markDef,r)&&n&&!Bte(a)){var i=function(e,t){var n=t.invalid,r=void 0!==n&&n,a=t.channels.reduce((function(t,n){var r=e.getScaleComponent(n);if(r){var a=r.get("type"),i=e.vgField(n,{expr:"datum"});i&&_ie(a)&&(t[i]=!0)}return t}),{}),i=Yee(a);if(i.length>0){var o=r?"||":"&&";return i.map((function(e){return zie(e,r)})).join(" ".concat(o," "))}return}(e,{invalid:!0,channels:hre});if(i)return(0,qn.Z)({},t,[{test:i,value:null}].concat((0,ln.Z)(hee(n))))}return n?(0,qn.Z)({},t,n):{}}function tle(e){var t=e.config;if(aue("invalid",e.markDef,t)){var n=function(e,t){var n=t.invalid,r=void 0!==n&&n,a=t.channels.reduce((function(t,n){var r=e.getScaleComponent(n);if(r){var a=r.get("type"),i=e.vgField(n,{expr:"datum"});i&&_ie(a)&&(t[i]=!0)}return t}),{}),i=Yee(a);if(i.length>0){var o=r?"||":"&&";return i.map((function(e){return zie(e,r)})).join(" ".concat(o," "))}return}(e,{channels:ire});if(n)return{defined:{signal:n}}}return{}}function nle(e,t){if(void 0!==t)return(0,qn.Z)({},e,eue(t))}var rle="voronoi",ale={has:function(e){return"interval"!==e.type&&e.nearest},parse:function(e,t){if(t.events){var n,r=(0,Zt.Z)(t.events);try{for(r.s();!(n=r.n()).done;){n.value.markname=e.getName(rle)}}catch(a){r.e(a)}finally{r.f()}}},marks:function(e,t,n){var r=t.project.hasChannel,a=r.x,i=r.y,o=e.mark;if(Bte(o))return oae('The "nearest" transform is not supported for '.concat(o," marks.")),n;var u={name:e.getName(rle),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},Oce(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:a||!i?"datum.datum.x || 0":"0"},y:{expr:i||!a?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]},s=0,c=!1;return n.forEach((function(t,n){var r,a=null!==(r=t.name)&&void 0!==r?r:"";a===e.component.mark[0].name?s=n:a.indexOf(rle)>=0&&(c=!0)})),c||n.splice(s+1,0,u),n}},ile=ale,ole=function(){function e(t,n){(0,Jh.Z)(this,e),this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}return(0,ep.Z)(e,[{key:"clone",value:function(){throw new Error("Cannot clone node")}},{key:"parent",get:function(){return this._parent},set:function(e){this._parent=e,e&&e.addChild(this)}},{key:"children",get:function(){return this._children}},{key:"numChildren",value:function(){return this._children.length}},{key:"addChild",value:function(e,t){this._children.indexOf(e)>-1?console.warn("Attempt to add the same child twice."):void 0!==t?this._children.splice(t,0,e):this._children.push(e)}},{key:"removeChild",value:function(e){var t=this._children.indexOf(e);return this._children.splice(t,1),t}},{key:"remove",value:function(){var e,t=this._parent.removeChild(this),n=(0,Zt.Z)(this._children);try{for(n.s();!(e=n.n()).done;){var r=e.value;r._parent=this._parent,this._parent.addChild(r,t++)}}catch(a){n.e(a)}finally{n.f()}}},{key:"insertAsParentOf",value:function(e){var t=e.parent;t.removeChild(this),this.parent=t,e.parent=this}},{key:"swapWithParent",value:function(){var e,t=this._parent,n=t.parent,r=(0,Zt.Z)(this._children);try{for(r.s();!(e=r.n()).done;){e.value.parent=t}}catch(a){r.e(a)}finally{r.f()}this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=n,t.parent=this}}]),e}(),ule=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r,a,i){var o;return(0,Jh.Z)(this,n),(o=t.call(this,e,r)).type=a,o.refCounts=i,o._source=o._name=r,o.refCounts&&!(o._name in o.refCounts)&&(o.refCounts[o._name]=0),o}return(0,ep.Z)(n,[{key:"clone",value:function(){var e=new this.constructor;return e.debugName="clone_"+this.debugName,e._source=this._source,e._name="clone_"+this._name,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return void 0===this._hash&&(this._hash="Output ".concat(function(e){var t=++fte;return e?String(e)+t:t}())),this._hash}},{key:"getSource",value:function(){return this.refCounts[this._name]++,this._source}},{key:"isRequired",value:function(){return!!this.refCounts[this._name]}},{key:"setSource",value:function(e){this._source=e}}]),n}(ole),sle=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a;return(0,Jh.Z)(this,n),(a=t.call(this,e)).formula=r,a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Oee(this.formula))}},{key:"merge",value:function(e){for(var t in this.formula=Object.assign({},this.formula),e.formula)this.formula[t]&&!e.formula[t].band||(this.formula[t]=e.formula[t]);var n,r=(0,Zt.Z)(e.children);try{for(r.s();!(n=r.n()).done;){var a=n.value;e.removeChild(a),a.parent=this}}catch(i){r.e(i)}finally{r.f()}e.remove()}},{key:"producedFields",value:function(){return new Set(Kee(this.formula).map((function(e){return e.as})))}},{key:"dependentFields",value:function(){return new Set(Kee(this.formula).map((function(e){return e.field})))}},{key:"hash",value:function(){return"TimeUnit ".concat(zee(this.formula))}},{key:"assemble",value:function(){var e,t=[],n=(0,Zt.Z)(Kee(this.formula));try{for(n.s();!(e=n.n()).done;){var r=e.value,a=r.field,i=r.as,o=Cae(r.timeUnit),u=o.unit,s=o.utc,c=kee(o,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:ote(a),type:"timeunit"},u?{units:xae(u)}:{}),s?{timezone:"utc"}:{}),c),{as:[i,"".concat(i,"_end")]}))}}catch(l){n.e(l)}finally{n.f()}return t}}],[{key:"makeFromEncoding",value:function(e,t){var r=t.reduceFieldDef((function(e,n,r){var a=n.field,i=n.timeUnit,o=ave(t)?t.encoding[ere(r)]:void 0,u=ave(t)&&doe(r,n,o,t.stack,t.markDef,t.config);if(i){var s=Noe(n,{forAs:!0});e[zee({as:s,field:a,timeUnit:i})]=Object.assign({as:s,field:a,timeUnit:i},u?{band:!0}:{})}return e}),{});return Xee(r)?null:new n(e,r)}},{key:"makeFromTransform",value:function(e,t){var r=Object.assign({},t),a=r.timeUnit,i=kee(r,["timeUnit"]),o=Cae(a),u=Object.assign(Object.assign({},i),{timeUnit:o});return new n(e,(0,qn.Z)({},zee(u),u))}}]),n}(ole),cle="_tuple_fields",lle=(0,ep.Z)((function e(){(0,Jh.Z)(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this.items=n,this.hasChannel={},this.hasField={}})),fle={has:function(){return!0},parse:function(e,t,n){var r,a,i,o=t.name,u=null!==(r=t.project)&&void 0!==r?r:t.project=new lle,s={},c={},l=new Set,f=function(e,t){for(var n="visual"===t?e.channel:e.field,r=Jee("".concat(o,"_").concat(n)),a=1;l.has(r);a++)r=Jee("".concat(o,"_").concat(n,"_").concat(a));return l.add(r),(0,qn.Z)({},t,r)};if(!n.fields&&!n.encodings){var d=e.config.selection[n.type];if(n.init){var h,p=(0,Zt.Z)(hee(n.init));try{for(p.s();!(h=p.n()).done;){var v,g=h.value,m=(0,Zt.Z)(Yee(g));try{for(m.s();!(v=m.n()).done;){var y=v.value;Xne[y]?(n.encodings||(n.encodings=[])).push(y):"interval"===n.type?(oae('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=d.encodings):(n.fields||(n.fields=[])).push(y)}}catch(M){m.e(M)}finally{m.f()}}}catch(M){p.e(M)}finally{p.f()}}else n.encodings=d.encodings,n.fields=d.fields}var b,x=(0,Zt.Z)(null!==(a=n.fields)&&void 0!==a?a:[]);try{for(x.s();!(b=x.n()).done;){var k=b.value,w={type:"E",field:k};w.signals=Object.assign({},f(w,"data")),u.items.push(w),u.hasField[k]=w}}catch(M){x.e(M)}finally{x.f()}var _,C=(0,Zt.Z)(null!==(i=n.encodings)&&void 0!==i?i:[]);try{for(C.s();!(_=C.n()).done;){var S=_.value,A=e.fieldDef(S);if(A){var E=A.field;if(A.aggregate){oae(Ire(S,A.aggregate));continue}if(!E){oae(Fre(S));continue}if(A.timeUnit){E=e.vgField(S);var T={timeUnit:A.timeUnit,as:E,field:A.field};c[zee(T)]=T}if(!s[E]){var N="E";if("interval"===t.type)_ie(e.getScaleComponent(S).get("type"))&&(N="R");else A.bin&&(N="R-RE");var D={field:E,channel:S,type:N};D.signals=Object.assign(Object.assign({},f(D,"data")),f(D,"visual")),u.items.push(s[E]=D),u.hasField[E]=u.hasChannel[S]=s[E]}}else oae(Fre(S))}}catch(M){C.e(M)}finally{C.f()}if(n.init){var F=function(e){return u.items.map((function(t){return void 0!==e[t.channel]?e[t.channel]:e[t.field]}))};if("interval"===n.type)t.init=F(n.init);else{var I=hee(n.init);t.init=I.map(F)}}Xee(c)||(u.timeUnit=new sle(null,c))},signals:function(e,t,n){var r=t.name+cle,a=n.filter((function(e){return e.name===r}));return a.length>0?n:n.concat({name:r,value:t.project.items.map((function(e){e.signals,e.hasLegend;var t=kee(e,["signals","hasLegend"]);return t.field=ote(t.field),t}))})}},dle={has:function(e){return"single"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind&&!Yue(e.bind)},parse:function(e,t,n,r){r.on||delete t.events,r.clear||delete t.clear},topLevelSignals:function(e,t,n){var r=t.name,a=t.project,i=t.bind,o=t.init&&t.init[0],u=ile.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return a.items.forEach((function(e,a){var s,c,l=Jee("".concat(r,"_").concat(e.field)),f=n.filter((function(e){return e.name===l}));f.length||n.unshift(Object.assign(Object.assign({name:l},o?{init:Ile(o[a])}:{value:null}),{on:t.events?[{events:t.events,update:"datum && item().mark.marktype !== 'group' ? ".concat(u,"[").concat(bee(e.field),"] : null")}]:[],bind:null!==(c=null!==(s=i[e.field])&&void 0!==s?s:i[e.channel])&&void 0!==c?c:i}))})),n},signals:function(e,t,n){var r=t.name,a=t.project,i=n.filter((function(e){return e.name===r+Wle}))[0],o=r+cle,u=a.items.map((function(e){return Jee("".concat(r,"_").concat(e.field))})),s=u.map((function(e){return"".concat(e," !== null")})).join(" && ");return u.length&&(i.update="".concat(s," ? {fields: ").concat(o,", values: [").concat(u.join(", "),"]} : null")),delete i.value,delete i.on,n}},hle=dle,ple="_toggle",vle={has:function(e){return"multi"===e.type&&!!e.toggle},signals:function(e,t,n){return n.concat({name:t.name+ple,value:!1,on:[{events:t.events,update:t.toggle}]})},modifyExpr:function(e,t){var n=t.name+Wle,r=t.name+ple;return"".concat(r," ? null : ").concat(n,", ")+("global"===t.resolve?"".concat(r," ? null : true, "):"".concat(r," ? null : {unit: ").concat(Yle(e),"}, "))+"".concat(r," ? ").concat(n," : null")}},gle={has:function(e){return void 0!==e.clear&&!1!==e.clear},parse:function(e,t,n){n.clear&&(t.clear=yee(n.clear)?q9(n.clear,"scope"):n.clear)},topLevelSignals:function(e,t,n){if(hle.has(t)){var r,a=(0,Zt.Z)(t.project.items);try{var i=function(){var e=r.value,a=n.findIndex((function(n){return n.name===Jee("".concat(t.name,"_").concat(e.field))}));-1!==a&&n[a].on.push({events:t.clear,update:"null"})};for(a.s();!(r=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}}return n},signals:function(e,t,n){function r(e,r){-1!==e&&n[e].on&&n[e].on.push({events:t.clear,update:r})}if("interval"===t.type){var a,i=(0,Zt.Z)(t.project.items);try{var o=function(){var e=a.value,t=n.findIndex((function(t){return t.name===e.signals.visual}));(r(t,"[0, 0]"),-1===t)&&r(n.findIndex((function(t){return t.name===e.signals.data})),"null")};for(i.s();!(a=i.n()).done;)o()}catch(s){i.e(s)}finally{i.f()}}else{var u=n.findIndex((function(e){return e.name===t.name+Wle}));r(u,"null"),vle.has(t)&&r(u=n.findIndex((function(e){return e.name===t.name+ple})),"false")}return n}},mle={has:function(e){return"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind},parse:function(e,t){var n,r=t.scales=[],a=(0,Zt.Z)(t.project.items);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=i.channel;if(pre(o)){var u=e.getScaleComponent(o),s=u?u.get("type"):void 0;if(u&&_ie(s)){var c={selection:t.name,field:i.field};u.set("selectionExtent",c,!0),r.push(i)}else oae("Scale bindings are currently only supported for scales with unbinned, continuous domains.")}}}catch(l){a.e(l)}finally{a.f()}},topLevelSignals:function(e,t,n){var r=t.scales.filter((function(e){return 0===n.filter((function(t){return t.name===e.signals.data})).length}));if(!e.parent||xle(e)||0===r.length)return n;var a=n.filter((function(e){return e.name===t.name}))[0],i=a.update;if(i.indexOf(Gle)>=0)a.update="{".concat(r.map((function(e){return"".concat(bee(e.field),": ").concat(e.signals.data)})).join(", "),"}");else{var o,u=(0,Zt.Z)(r);try{for(u.s();!(o=u.n()).done;){var s=o.value,c="".concat(bee(s.field),": ").concat(s.signals.data);i.indexOf(c)<0&&(i="".concat(i.substring(0,i.length-1),", ").concat(c,"}"))}}catch(l){u.e(l)}finally{u.f()}a.update=i}return n.concat(r.map((function(e){return{name:e.signals.data}})))},signals:function(e,t,n){if(e.parent&&!xle(e)){var r,a=(0,Zt.Z)(t.scales);try{var i=function(){var e=r.value,t=n.filter((function(t){return t.name===e.signals.data}))[0];t.push="outer",delete t.value,delete t.update};for(a.s();!(r=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}}return n}},yle=mle;function ble(e,t){var n=bee(e.scaleName(t));return"domain(".concat(n,")")}function xle(e){var t;return e.parent&&uve(e.parent)&&(null!==(t=!e.parent.parent)&&void 0!==t?t:xle(e.parent.parent))}var kle={has:function(e){var t="global"===e.resolve&&e.bind&&Yue(e.bind),n=1===e.project.items.length&&e.project.items[0].field!==Hue;return t&&!n&&oae("Legend bindings are only supported for selections over an individual field or encoding channel."),t&&n},parse:function(e,t,n,r){var a;if(r.on||delete t.events,r.clear||delete t.clear,r.on||r.clear){var i,o='event.item && indexof(event.item.mark.role, "legend") < 0',u=(0,Zt.Z)(t.events);try{for(u.s();!(i=u.n()).done;){var s=i.value;s.filter=hee(null!==(a=s.filter)&&void 0!==a?a:[]),s.filter.indexOf(o)<0&&s.filter.push(o)}}catch(f){u.e(f)}finally{u.f()}}var c=Kue(t.bind)?t.bind.legend:"click",l=yee(c)?q9(c,"view"):hee(c);t.bind={legend:{merge:l}}},topLevelSignals:function(e,t,n){var r,a=t.name,i=Kue(t.bind)&&t.bind.legend,o=function(e){return function(t){var n=Oee(t);return n.markname=e,n}},u=(0,Zt.Z)(t.project.items);try{var s=function(){var e=r.value;if(!e.hasLegend)return"continue";var u="".concat(Jee(e.field),"_legend"),s="".concat(a,"_").concat(u),c=n.filter((function(e){return e.name===s}));if(0===c.length){var l=i.merge.map(o("".concat(u,"_symbols"))).concat(i.merge.map(o("".concat(u,"_labels")))).concat(i.merge.map(o("".concat(u,"_entries"))));n.unshift(Object.assign(Object.assign({name:s},t.init?{}:{value:null}),{on:[{events:l,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:"!event.item || !datum ? null : ".concat(s),force:!0}]}))}};for(u.s();!(r=u.n()).done;)s()}catch(c){u.e(c)}finally{u.f()}return n},signals:function(e,t,n){var r=t.name,a=t.project,i=n.find((function(e){return e.name===r+Wle})),o=r+cle,u=a.items.filter((function(e){return e.hasLegend})).map((function(e){return Jee("".concat(r,"_").concat(Jee(e.field),"_legend"))})),s=u.map((function(e){return"".concat(e," !== null")})).join(" && "),c="".concat(s," ? {fields: ").concat(o,", values: [").concat(u.join(", "),"]} : null");t.events&&u.length>0?i.on.push({events:u.map((function(e){return{signal:e}})),update:c}):u.length>0&&(i.update=c,delete i.value,delete i.on);var l=n.find((function(e){return e.name===r+ple})),f=Kue(t.bind)&&t.bind.legend;return l&&(t.events?l.on.push(Object.assign(Object.assign({},l.on[0]),{events:f})):l.on[0].events=f),n}};var wle="_translate_anchor",_le="_translate_delta",Cle={has:function(e){return"interval"===e.type&&e.translate},signals:function(e,t,n){var r=t.name,a=yle.has(t),i=r+wle,o=t.project.hasChannel,u=o.x,s=o.y,c=q9(t.translate,"scope");return a||(c=c.map((function(e){return e.between[0].markname=r+Rle,e}))),n.push({name:i,value:{},on:[{events:c.map((function(e){return e.between[0]})),update:"{x: x(unit), y: y(unit)"+(void 0!==u?", extent_x: "+(a?ble(e,one):"slice(".concat(u.signals.visual,")")):"")+(void 0!==s?", extent_y: "+(a?ble(e,une):"slice(".concat(s.signals.visual,")")):"")+"}"}]},{name:r+_le,value:{},on:[{events:c,update:"{x: ".concat(i,".x - x(unit), y: ").concat(i,".y - y(unit)}")}]}),void 0!==u&&Sle(e,t,u,"width",n),void 0!==s&&Sle(e,t,s,"height",n),n}};function Sle(e,t,n,r,a){var i,o=t.name,u=o+wle,s=o+_le,c=n.channel,l=yle.has(t),f=a.filter((function(e){return e.name===n.signals[l?"data":"visual"]}))[0],d=e.getSizeSignalRef(r).signal,h=e.getScaleComponent(c),p=h.get("type"),v=l&&c===one?"-":"",g="".concat(u,".extent_").concat(c),m="".concat(v).concat(s,".").concat(c," / ")+(l?"".concat(d):"span(".concat(g,")")),y="".concat(l?"log"===p?"panLog":"pow"===p?"panPow":"panLinear":"panLinear","(").concat(g,", ").concat(m)+(l&&"pow"===p?", ".concat(null!==(i=h.get("exponent"))&&void 0!==i?i:1):"")+")";f.on.push({events:{signal:s},update:l?y:"clampRange(".concat(y,", 0, ").concat(d,")")})}var Ale="_zoom_anchor",Ele="_zoom_delta",Tle={has:function(e){return"interval"===e.type&&e.zoom},signals:function(e,t,n){var r=t.name,a=yle.has(t),i=r+Ele,o=t.project.hasChannel,u=o.x,s=o.y,c=bee(e.scaleName(one)),l=bee(e.scaleName(une)),f=q9(t.zoom,"scope");return a||(f=f.map((function(e){return e.markname=r+Rle,e}))),n.push({name:r+Ale,on:[{events:f,update:a?"{"+[c?"x: invert(".concat(c,", x(unit))"):"",l?"y: invert(".concat(l,", y(unit))"):""].filter((function(e){return!!e})).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:i,on:[{events:f,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==u&&Nle(e,t,u,"width",n),void 0!==s&&Nle(e,t,s,"height",n),n}};function Nle(e,t,n,r,a){var i,o=t.name,u=n.channel,s=yle.has(t),c=a.filter((function(e){return e.name===n.signals[s?"data":"visual"]}))[0],l=e.getSizeSignalRef(r).signal,f=e.getScaleComponent(u),d=f.get("type"),h=s?ble(e,u):c.name,p=o+Ele,v="".concat(o).concat(Ale,".").concat(u),g="".concat(s?"log"===d?"zoomLog":"pow"===d?"zoomPow":"zoomLinear":"zoomLinear","(").concat(h,", ").concat(v,", ").concat(p)+(s&&"pow"===d?", ".concat(null!==(i=f.get("exponent"))&&void 0!==i?i:1):"")+")";c.on.push({events:{signal:p},update:s?g:"clampRange(".concat(g,", 0, ").concat(l,")")})}var Dle=[fle,vle,yle,kle,Cle,Tle,hle,ile,gle];function Fle(e,t){var n,r=(0,Zt.Z)(Dle);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.has(e)&&t(a)}}catch(i){r.e(i)}finally{r.f()}}function Ile(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:iee;if(uee(e)){var r=e.map((function(e){return Ile(e,t,n)}));return t?"[".concat(r.join(", "),"]"):r}return uae(e)?n(t?hae(e):vae(e)):t?n(JSON.stringify(e)):e}function Mle(e,t){return Hle(e,(function(n,r){t=r.marks?r.marks(e,n,t):t,Fle(n,(function(r){r.marks&&(t=r.marks(e,n,t))}))})),t}function Ole(e){return e.map((function(e){return e.on&&!e.on.length&&delete e.on,e}))}var Rle="_brush",Zle="_scale_trigger",Ble={signals:function(e,t){var n=t.name,r=n+cle,a=yle.has(t),i=[],o=[],u=[];if(t.translate&&!a){var s="!event.item || event.item.mark.name !== ".concat(bee(n+Rle));zle(t,(function(e,t){var n,r=hee(null!==(n=t.between[0].filter)&&void 0!==n?n:t.between[0].filter=[]);return r.indexOf(s)<0&&r.push(s),e}))}t.project.items.forEach((function(n,r){var a=n.channel;if(a===one||a===une){var s=t.init?t.init[r]:null,c=function(e,t,n,r){var a=n.channel,i=n.signals.visual,o=n.signals.data,u=yle.has(t),s=bee(e.scaleName(a)),c=e.getScaleComponent(a),l=c?c.get("type"):void 0,f=function(e){return"scale(".concat(s,", ").concat(e,")")},d=e.getSizeSignalRef(a===one?"width":"height").signal,h="".concat(a,"(unit)"),p=zle(t,(function(e,t){return[].concat((0,ln.Z)(e),[{events:t.between[0],update:"[".concat(h,", ").concat(h,"]")},{events:t,update:"[".concat(i,"[0], clamp(").concat(h,", 0, ").concat(d,")]")}])}));return p.push({events:{signal:t.name+Zle},update:_ie(l)?"[".concat(f("".concat(o,"[0]")),", ").concat(f("".concat(o,"[1]")),"]"):"[0, 0]"}),u?[{name:o,on:[]}]:[Object.assign(Object.assign({name:i},r?{init:Ile(r,!0,f)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:o},r?{init:Ile(r)}:{}),{on:[{events:{signal:i},update:"".concat(i,"[0] === ").concat(i,"[1] ? null : invert(").concat(s,", ").concat(i,")")}]})]}(e,t,n,s),l=n.signals.data,f=n.signals.visual,d=bee(e.scaleName(a)),h=_ie(e.getScaleComponent(a).get("type"))?"+":"";i.push.apply(i,(0,ln.Z)(c)),o.push(l),u.push({scaleName:e.scaleName(a),expr:"(!isArray(".concat(l,") || ")+"(".concat(h,"invert(").concat(d,", ").concat(f,")[0] === ").concat(h).concat(l,"[0] && ")+"".concat(h,"invert(").concat(d,", ").concat(f,")[1] === ").concat(h).concat(l,"[1]))")})}else oae("Interval selections only support x and y encoding channels.")})),a||i.push({name:n+Zle,value:{},on:[{events:u.map((function(e){return{scale:e.scaleName}})),update:u.map((function(e){return e.expr})).join(" && ")+" ? ".concat(n+Zle," : {}")}]});var c=t.init,l="unit: ".concat(Yle(e),", fields: ").concat(r,", values");return i.concat(Object.assign(Object.assign({name:n+Wle},c?{init:"{".concat(l,": ").concat(Ile(c),"}")}:{}),{on:[{events:[{signal:o.join(" || ")}],update:o.join(" && ")+" ? {".concat(l,": [").concat(o,"]} : null")}]}))},modifyExpr:function(e,t){return t.name+Wle+", "+("global"===t.resolve?"true":"{unit: ".concat(Yle(e),"}"))},marks:function(e,t,n){var r=t.name,a=t.project.hasChannel,i=a.x,o=a.y,u=i&&i.signals.visual,s=o&&o.signals.visual,c="data(".concat(bee(t.name+Ule),")");if(yle.has(t))return n;var l={x:void 0!==i?{signal:"".concat(u,"[0]")}:{value:0},y:void 0!==o?{signal:"".concat(s,"[0]")}:{value:0},x2:void 0!==i?{signal:"".concat(u,"[1]")}:{field:{group:"width"}},y2:void 0!==o?{signal:"".concat(s,"[1]")}:{field:{group:"height"}}};if("global"===t.resolve){var f,d=(0,Zt.Z)(Yee(l));try{for(d.s();!(f=d.n()).done;){var h=f.value;l[h]=[Object.assign({test:"".concat(c,".length && ").concat(c,"[0].unit === ").concat(Yle(e))},l[h]),{value:0}]}}catch(x){d.e(x)}finally{d.f()}}var p=t.mark,v=p.fill,g=p.fillOpacity,m=p.cursor,y=kee(p,["fill","fillOpacity","cursor"]),b=Yee(y).reduce((function(e,t){return e[t]=[{test:[void 0!==i&&"".concat(u,"[0] !== ").concat(u,"[1]"),void 0!==o&&"".concat(s,"[0] !== ").concat(s,"[1]")].filter((function(e){return e})).join(" && "),value:y[t]},{value:null}],e}),{});return[{name:r+Rle+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:v},fillOpacity:{value:g}},update:l}}].concat((0,ln.Z)(n),[{name:r+Rle,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},m?{cursor:{value:m}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},l),b)}}])}};function zle(e,t){return e.events.reduce((function(e,n){return n.between?t(e,n):(oae("".concat(n," is not an ordered event stream for interval selections.")),e)}),[])}function Lle(e,t){var n=t.name,r=n+cle,a=t.project,i="(item().isVoronoi ? datum.datum : datum)",o=a.items.map((function(t){var n=e.fieldDef(t.channel);return n&&n.bin?"[".concat(i,"[").concat(bee(e.vgField(t.channel,{})),"], ")+"".concat(i,"[").concat(bee(e.vgField(t.channel,{binSuffix:"end"})),"]]"):"".concat(i,"[").concat(bee(t.field),"]")})).join(", "),u="unit: ".concat(Yle(e),", fields: ").concat(r,", values"),s=t.events;return[{name:n+Wle,on:s?[{events:s,update:"datum && item().mark.marktype !== 'group' ? {".concat(u,": [").concat(o,"]} : null"),force:!0}]:[]}]}var Ple={signals:Lle,modifyExpr:function(e,t){return t.name+Wle+", "+("global"===t.resolve?"null":"{unit: ".concat(Yle(e),"}"))}},jle={signals:Lle,modifyExpr:function(e,t){return t.name+Wle+", "+("global"===t.resolve?"true":"{unit: ".concat(Yle(e),"}"))}},Ule="_store",Wle="_tuple",Vle="_modify",Gle="vlSelectionResolve",qle={single:jle,multi:Ple,interval:Ble};function Hle(e,t){var n=e.component.selection;if(n){var r,a=(0,Zt.Z)(Kee(n));try{for(a.s();!(r=a.n()).done;){var i=r.value;if(!0===t(i,qle[i.type]))break}}catch(o){a.e(o)}finally{a.f()}}}function Xle(e){for(var t=e.parent;t&&!ive(t);)t=t.parent;return t}function Yle(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{escape:!0},n=t.escape,r=n?bee(e.name):e.name,a=Xle(e);if(a){var i,o=a.facet,u=(0,Zt.Z)(Vne);try{for(u.s();!(i=u.n()).done;){var s=i.value;o[s]&&(r+=" + '__facet_".concat(s,"_' + (facet[").concat(bee(a.vgField(s)),"])"))}}catch(c){u.e(c)}finally{u.f()}}return r}function Kle(e){var t=!1;return Hle(e,(function(e){t=t||e.project.items.some((function(e){return e.field===Hue}))})),t}var $le,Qle,Jle,efe,tfe,nfe="Property",rfe="ArrayExpression",afe="BinaryExpression",ife="CallExpression",ofe="ConditionalExpression",ufe="LogicalExpression",sfe="MemberExpression",cfe="ObjectExpression",lfe="UnaryExpression";function ffe(e){this.type=e}ffe.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(n=0,r=(t=function(e){switch(e.type){case rfe:return e.elements;case afe:case ufe:return[e.left,e.right];case ife:return[e.callee].concat(e.arguments);case ofe:return[e.test,e.consequent,e.alternate];case sfe:return[e.object,e.property];case cfe:return e.properties;case nfe:return[e.key,e.value];case lfe:return[e.argument];default:return[]}}(this)).length;n<r;++n)if(t[n].visit(e))return 1};($le={})[1]="Boolean",$le[2]="<end>",$le[3]="Identifier",$le[4]="Keyword",$le[5]="Null",$le[6]="Numeric",$le[7]="Punctuator",$le[8]="String",$le[9]="RegularExpression";var dfe="Identifier",hfe="Unexpected token %0",pfe="Invalid regular expression",vfe="Invalid regular expression: missing /",gfe="Octal literals are not allowed in strict mode.",mfe="ILLEGAL",yfe="Disabled.",bfe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),xfe=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function kfe(e,t){if(!e)throw new Error("ASSERT: "+t)}function wfe(e){return e>=48&&e<=57}function _fe(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function Cfe(e){return"01234567".indexOf(e)>=0}function Sfe(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function Afe(e){return 10===e||13===e||8232===e||8233===e}function Efe(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&bfe.test(String.fromCharCode(e))}function Tfe(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&xfe.test(String.fromCharCode(e))}var Nfe={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function Dfe(){for(var e;Jle<efe&&(Sfe(e=Qle.charCodeAt(Jle))||Afe(e));)++Jle}function Ffe(e){var t,n,r,a=0;for(n="u"===e?4:2,t=0;t<n;++t)Jle<efe&&_fe(Qle[Jle])?(r=Qle[Jle++],a=16*a+"0123456789abcdef".indexOf(r.toLowerCase())):Hfe({},hfe,mfe);return String.fromCharCode(a)}function Ife(){var e,t,n,r;for(t=0,"}"===(e=Qle[Jle])&&Hfe({},hfe,mfe);Jle<efe&&_fe(e=Qle[Jle++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&Hfe({},hfe,mfe),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function Mfe(){var e,t;for(e=Qle.charCodeAt(Jle++),t=String.fromCharCode(e),92===e&&(117!==Qle.charCodeAt(Jle)&&Hfe({},hfe,mfe),++Jle,(e=Ffe("u"))&&"\\"!==e&&Efe(e.charCodeAt(0))||Hfe({},hfe,mfe),t=e);Jle<efe&&Tfe(e=Qle.charCodeAt(Jle));)++Jle,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==Qle.charCodeAt(Jle)&&Hfe({},hfe,mfe),++Jle,(e=Ffe("u"))&&"\\"!==e&&Tfe(e.charCodeAt(0))||Hfe({},hfe,mfe),t+=e);return t}function Ofe(){var e,t;return e=Jle,t=92===Qle.charCodeAt(Jle)?Mfe():function(){var e,t;for(e=Jle++;Jle<efe;){if(92===(t=Qle.charCodeAt(Jle)))return Jle=e,Mfe();if(!Tfe(t))break;++Jle}return Qle.slice(e,Jle)}(),{type:1===t.length?3:Nfe.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3,value:t,start:e,end:Jle}}function Rfe(){var e,t,n,r,a=Jle,i=Qle.charCodeAt(Jle),o=Qle[Jle];switch(i){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++Jle,{type:7,value:String.fromCharCode(i),start:a,end:Jle};default:if(61===(e=Qle.charCodeAt(Jle+1)))switch(i){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return Jle+=2,{type:7,value:String.fromCharCode(i)+String.fromCharCode(e),start:a,end:Jle};case 33:case 61:return Jle+=2,61===Qle.charCodeAt(Jle)&&++Jle,{type:7,value:Qle.slice(a,Jle),start:a,end:Jle}}}return">>>="===(r=Qle.substr(Jle,4))?{type:7,value:r,start:a,end:Jle+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:a,end:Jle+=3}:o===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===t?{type:7,value:t,start:a,end:Jle+=2}:"<>=!+-*%&|^/".indexOf(o)>=0?{type:7,value:o,start:a,end:++Jle}:void Hfe({},hfe,mfe)}function Zfe(){var e,t,n;if(kfe(wfe((n=Qle[Jle]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=Jle,e="","."!==n){if(e=Qle[Jle++],n=Qle[Jle],"0"===e){if("x"===n||"X"===n)return++Jle,function(e){for(var t="";Jle<efe&&_fe(Qle[Jle]);)t+=Qle[Jle++];return 0===t.length&&Hfe({},hfe,mfe),Efe(Qle.charCodeAt(Jle))&&Hfe({},hfe,mfe),{type:6,value:parseInt("0x"+t,16),start:e,end:Jle}}(t);if(Cfe(n))return function(e){for(var t="0"+Qle[Jle++];Jle<efe&&Cfe(Qle[Jle]);)t+=Qle[Jle++];return(Efe(Qle.charCodeAt(Jle))||wfe(Qle.charCodeAt(Jle)))&&Hfe({},hfe,mfe),{type:6,value:parseInt(t,8),octal:!0,start:e,end:Jle}}(t);n&&wfe(n.charCodeAt(0))&&Hfe({},hfe,mfe)}for(;wfe(Qle.charCodeAt(Jle));)e+=Qle[Jle++];n=Qle[Jle]}if("."===n){for(e+=Qle[Jle++];wfe(Qle.charCodeAt(Jle));)e+=Qle[Jle++];n=Qle[Jle]}if("e"===n||"E"===n)if(e+=Qle[Jle++],"+"!==(n=Qle[Jle])&&"-"!==n||(e+=Qle[Jle++]),wfe(Qle.charCodeAt(Jle)))for(;wfe(Qle.charCodeAt(Jle));)e+=Qle[Jle++];else Hfe({},hfe,mfe);return Efe(Qle.charCodeAt(Jle))&&Hfe({},hfe,mfe),{type:6,value:parseFloat(e),start:t,end:Jle}}function Bfe(){var e,t,n,r;return tfe=null,Dfe(),e=Jle,t=function(){var e,t,n,r;for(kfe("/"===(e=Qle[Jle]),"Regular expression literal must start with a slash"),t=Qle[Jle++],n=!1,r=!1;Jle<efe;)if(t+=e=Qle[Jle++],"\\"===e)Afe((e=Qle[Jle++]).charCodeAt(0))&&Hfe({},vfe),t+=e;else if(Afe(e.charCodeAt(0)))Hfe({},vfe);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||Hfe({},vfe),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";Jle<efe&&Tfe((e=Qle[Jle]).charCodeAt(0));)++Jle,"\\"===e&&Jle<efe?Hfe({},hfe,mfe):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&Hfe({},pfe,n),{value:n,literal:t}}(),r=function(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111)return"x";Hfe({},pfe)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){Hfe({},pfe)}try{return new RegExp(e,t)}catch(a){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:Jle}}function zfe(){var e;return Dfe(),Jle>=efe?{type:2,start:Jle,end:Jle}:Efe(e=Qle.charCodeAt(Jle))?Ofe():40===e||41===e||59===e?Rfe():39===e||34===e?function(){var e,t,n,r,a="",i=!1;for(kfe("'"===(e=Qle[Jle])||'"'===e,"String literal must starts with a quote"),t=Jle,++Jle;Jle<efe;){if((n=Qle[Jle++])===e){e="";break}if("\\"===n)if((n=Qle[Jle++])&&Afe(n.charCodeAt(0)))"\r"===n&&"\n"===Qle[Jle]&&++Jle;else switch(n){case"u":case"x":"{"===Qle[Jle]?(++Jle,a+=Ife()):a+=Ffe(n);break;case"n":a+="\n";break;case"r":a+="\r";break;case"t":a+="\t";break;case"b":a+="\b";break;case"f":a+="\f";break;case"v":a+="\v";break;default:Cfe(n)?(0!==(r="01234567".indexOf(n))&&(i=!0),Jle<efe&&Cfe(Qle[Jle])&&(i=!0,r=8*r+"01234567".indexOf(Qle[Jle++]),"0123".indexOf(n)>=0&&Jle<efe&&Cfe(Qle[Jle])&&(r=8*r+"01234567".indexOf(Qle[Jle++]))),a+=String.fromCharCode(r)):a+=n}else{if(Afe(n.charCodeAt(0)))break;a+=n}}return""!==e&&Hfe({},hfe,mfe),{type:8,value:a,octal:i,start:t,end:Jle}}():46===e?wfe(Qle.charCodeAt(Jle+1))?Zfe():Rfe():wfe(e)?Zfe():Rfe()}function Lfe(){var e;return Jle=(e=tfe).end,tfe=zfe(),Jle=e.end,e}function Pfe(){var e;e=Jle,tfe=zfe(),Jle=e}function jfe(e,t,n){var r=new ffe("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return r.operator=e,r.left=t,r.right=n,r}function Ufe(e,t){var n=new ffe("CallExpression");return n.callee=e,n.arguments=t,n}function Wfe(e){var t=new ffe(dfe);return t.name=e,t}function Vfe(e){var t=new ffe("Literal");return t.value=e.value,t.raw=Qle.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function Gfe(e,t,n){var r=new ffe("MemberExpression");return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function qfe(e,t,n){var r=new ffe("Property");return r.key=t,r.value=n,r.kind=e,r}function Hfe(e,t){var n,r=Array.prototype.slice.call(arguments,2),a=t.replace(/%(\d)/g,(function(e,t){return kfe(t<r.length,"Message reference must be in range"),r[t]}));throw(n=new Error(a)).index=Jle,n.description=a,n}function Xfe(e){2===e.type&&Hfe(e,"Unexpected end of input"),6===e.type&&Hfe(e,"Unexpected number"),8===e.type&&Hfe(e,"Unexpected string"),3===e.type&&Hfe(e,"Unexpected identifier"),4===e.type&&Hfe(e,"Unexpected reserved word"),Hfe(e,hfe,e.value)}function Yfe(e){var t=Lfe();7===t.type&&t.value===e||Xfe(t)}function Kfe(e){return 7===tfe.type&&tfe.value===e}function $fe(e){return 4===tfe.type&&tfe.value===e}function Qfe(){var e=[];for(Jle=tfe.start,Yfe("[");!Kfe("]");)Kfe(",")?(Lfe(),e.push(null)):(e.push(lde()),Kfe("]")||Yfe(","));return Lfe(),function(e){var t=new ffe("ArrayExpression");return t.elements=e,t}(e)}function Jfe(){var e;return Jle=tfe.start,8===(e=Lfe()).type||6===e.type?(e.octal&&Hfe(e,gfe),Vfe(e)):Wfe(e.value)}function ede(){var e,t,n;return Jle=tfe.start,3===(e=tfe).type?(n=Jfe(),Yfe(":"),qfe("init",n,lde())):2!==e.type&&7!==e.type?(t=Jfe(),Yfe(":"),qfe("init",t,lde())):void Xfe(e)}function tde(){var e,t,n=[],r={},a=String;for(Jle=tfe.start,Yfe("{");!Kfe("}");)t="$"+((e=ede()).key.type===dfe?e.key.name:a(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?Hfe({},"Duplicate data property in object literal not allowed in strict mode"):r[t]=!0,n.push(e),Kfe("}")||Yfe(",");return Yfe("}"),function(e){var t=new ffe("ObjectExpression");return t.properties=e,t}(n)}var nde={if:1};function rde(){var e,t,n;if(Kfe("("))return function(){var e;return Yfe("("),e=fde(),Yfe(")"),e}();if(Kfe("["))return Qfe();if(Kfe("{"))return tde();if(e=tfe.type,Jle=tfe.start,3===e||nde[tfe.value])n=Wfe(Lfe().value);else if(8===e||6===e)tfe.octal&&Hfe(tfe,gfe),n=Vfe(Lfe());else{if(4===e)throw new Error(yfe);1===e?((t=Lfe()).value="true"===t.value,n=Vfe(t)):5===e?((t=Lfe()).value=null,n=Vfe(t)):Kfe("/")||Kfe("/=")?(n=Vfe(Bfe()),Pfe()):Xfe(Lfe())}return n}function ade(){var e=[];if(Yfe("("),!Kfe(")"))for(;Jle<efe&&(e.push(lde()),!Kfe(")"));)Yfe(",");return Yfe(")"),e}function ide(){return Yfe("."),function(){var e;return Jle=tfe.start,function(e){return 3===e.type||4===e.type||1===e.type||5===e.type}(e=Lfe())||Xfe(e),Wfe(e.value)}()}function ode(){var e;return Yfe("["),e=fde(),Yfe("]"),e}function ude(){var e=function(){var e;for(e=rde();;)if(Kfe("."))e=Gfe(".",e,ide());else if(Kfe("("))e=Ufe(e,ade());else{if(!Kfe("["))break;e=Gfe("[",e,ode())}return e}();if(7===tfe.type&&(Kfe("++")||Kfe("--")))throw new Error(yfe);return e}function sde(){var e,t;if(7!==tfe.type&&4!==tfe.type)t=ude();else{if(Kfe("++")||Kfe("--"))throw new Error(yfe);if(Kfe("+")||Kfe("-")||Kfe("~")||Kfe("!"))e=Lfe(),t=sde(),t=function(e,t){var n=new ffe("UnaryExpression");return n.operator=e,n.argument=t,n.prefix=!0,n}(e.value,t);else{if($fe("delete")||$fe("void")||$fe("typeof"))throw new Error(yfe);t=ude()}}return t}function cde(e){var t=0;if(7!==e.type&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function lde(){var e,t;return e=function(){var e,t,n,r,a,i,o,u,s,c;if(e=tfe,s=sde(),0===(a=cde(r=tfe)))return s;for(r.prec=a,Lfe(),t=[e,tfe],i=[s,r,o=sde()];(a=cde(tfe))>0;){for(;i.length>2&&a<=i[i.length-2].prec;)o=i.pop(),u=i.pop().value,s=i.pop(),t.pop(),n=jfe(u,s,o),i.push(n);(r=Lfe()).prec=a,i.push(r),t.push(tfe),n=sde(),i.push(n)}for(n=i[c=i.length-1],t.pop();c>1;)t.pop(),n=jfe(i[c-1].value,i[c-2],n),c-=2;return n}(),Kfe("?")&&(Lfe(),t=lde(),Yfe(":"),e=function(e,t,n){var r=new ffe("ConditionalExpression");return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,lde())),e}function fde(){var e=lde();if(Kfe(","))throw new Error(yfe);return e}function dde(e,t,n){return e.fields=t||[],e.fname=n,e}function hde(e){return 1===e.length?pde(e[0]):vde(e)}var pde=function(e){return function(t){return t[e]}},vde=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function gde(e){throw Error(e)}function mde(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n),s+=e.substring(++n,++n),t=n;else if(r===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&c(),u=t=n+1):"]"===r&&(u||gde("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&gde("Access path missing closing bracket: "+e),o&&gde("Access path missing closing quote: "+e),n>t&&(n++,c()),a}function yde(e,t,n){var r=mde(e);return e=1===r.length?r[0]:e,dde((n&&n.get||hde)(r),[e],t||e)}yde("id"),dde((function(e){return e}),[],"identity"),dde((function(){return 0}),[],"zero"),dde((function(){return 1}),[],"one"),dde((function(){return!0}),[],"true"),dde((function(){return!1}),[],"false");Array.isArray;Object.prototype.hasOwnProperty;function bde(e){var t=[];return"Identifier"===e.type?[e.name]:"Literal"===e.type?[e.value]:("MemberExpression"===e.type&&(t.push.apply(t,(0,ln.Z)(bde(e.object))),t.push.apply(t,(0,ln.Z)(bde(e.property)))),t)}function xde(e){return"MemberExpression"===e.object.type?xde(e.object):"datum"===e.object.name}function kde(e){var t=function(e){Jle=0,efe=(Qle=e).length,tfe=null,Pfe();var t=fde();if(2!==tfe.type)throw new Error("Unexpect token after expression.");return t}(e),n=new Set;return t.visit((function(e){"MemberExpression"===e.type&&xde(e)&&n.add(bde(e).slice(1).join("."))})),n}var wde=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r,a){var i;return(0,Jh.Z)(this,n),(i=t.call(this,e)).model=r,i.filter=a,i.expr=Sde(i.model,i.filter,(0,Sx.Z)(i)),i._dependentFields=kde(i.expr),i}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,this.model,Oee(this.filter))}},{key:"dependentFields",value:function(){return this._dependentFields}},{key:"producedFields",value:function(){return new Set}},{key:"assemble",value:function(){return{type:"filter",expr:this.expr}}},{key:"hash",value:function(){return"Filter ".concat(this.expr)}}]),n}(ole);function _de(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"datum",a=[];function i(t){var i=Jee(t),o=e.getSelectionComponent(i,t),u=bee(i+Ule);if(o.project.timeUnit){var s=null!==n&&void 0!==n?n:e.component.data.raw,c=o.project.timeUnit.clone();s.parent?c.insertAsParentOf(s):s.parent=c}return"none"!==o.empty&&a.push(u),"vlSelectionTest(".concat(u,", ").concat(r)+("global"===o.resolve?")":", ".concat(bee(o.resolve),")"))}var o=ete(t,i);return(a.length?"!("+a.map((function(e){return"length(data(".concat(e,"))")})).join(" || ")+") || ":"")+"(".concat(o,")")}function Cde(e,t){var n=t.encoding,r=t.field;if(n||r){if(n&&!r){var a=e.project.items.filter((function(e){return e.channel===n}));!a.length||a.length>1?(r=e.project.items[0].field,oae((a.length?"Multiple ":"No ")+"matching ".concat(bee(n)," encoding found for selection ").concat(bee(t.selection),". ")+'Using "field": '.concat(bee(r),"."))):r=a[0].field}}else r=e.project.items[0].field,e.project.items.length>1&&oae('A "field" or "encoding" must be specified when using a selection as a scale domain. '+'Using "field": '.concat(bee(r),"."));return"".concat(e.name,"[").concat(bee(r),"]")}function Sde(e,t,n){return ete(t,(function(t){return yee(t)?t:function(e){return null===e||void 0===e?void 0:e.selection}(t)?_de(e,t.selection,n):Wae(t)}))}function Ade(e,t){if(e)return uee(e)&&!Joe(e)?e.map((function(e){return Loe(e,t)})).join(", "):e}function Ede(e,t,n,r){var a,i,o;e.encode=null!==(a=e.encode)&&void 0!==a?a:{},e.encode[t]=null!==(i=e.encode[t])&&void 0!==i?i:{},e.encode[t].update=null!==(o=e.encode[t].update)&&void 0!==o?o:{},e.encode[t].update[n]=r}function Tde(e,t,n){var r,a,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{header:!1},o=e.combine(),u=o.disable,s=o.orient,c=o.scale,l=o.labelExpr,f=o.title,d=o.zindex,h=kee(o,["disable","orient","scale","labelExpr","title","zindex"]);if(!u){for(var p in h){var v=yte[p],g=h[p];if(v&&v!==t&&"both"!==v)delete h[p];else if(gte(g)){var m=g.condition,y=kee(g,["condition"]),b=hee(m),x=vte[p];if(x){var k=x.vgProp,w=x.part,_=[].concat((0,ln.Z)(b.map((function(e){var t=e.test,n=kee(e,["test"]);return Object.assign({test:Sde(null,t)},n)}))),[y]);Ede(h,w,k,_),delete h[p]}else if(null===x){var C={signal:b.map((function(e){var t=e.test,n=kee(e,["test"]);return"".concat(Sde(null,t)," ? ").concat(tue(n)," : ")})).join("")+tue(y)};h[p]=C}}else if(Aae(g)){var S=vte[p];if(S){var A=S.vgProp,E=S.part;Ede(h,E,A,g),delete h[p]}}}if("grid"===t){if(!h.grid)return;if(h.encode){var T=h.encode.grid;h.encode=Object.assign({},T?{grid:T}:{}),Xee(h.encode)&&delete h.encode}return Object.assign(Object.assign({scale:c,orient:s},h),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:lte(d,0)})}if(i.header||!e.mainExtracted){if(void 0!==l){var N=l;(null===(a=null===(r=h.encode)||void 0===r?void 0:r.labels)||void 0===a?void 0:a.update)&&Aae(h.encode.labels.update.text)&&(N=ute(l,"datum.label",h.encode.labels.update.text.signal)),Ede(h,"labels","text",{signal:N})}if(null===h.labelAlign&&delete h.labelAlign,h.encode){var D,F=(0,Zt.Z)(mte);try{for(F.s();!(D=F.n()).done;){var I=D.value;e.hasAxisPart(I)||delete h.encode[I]}}catch(O){F.e(O)}finally{F.f()}Xee(h.encode)&&delete h.encode}var M=Ade(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:c,orient:s,grid:!1},M?{title:M}:{}),h),!1===n.aria?{aria:!1}:{}),{zindex:lte(d,0)})}}}function Nde(e){var t,n=e.component.axes,r=[],a=(0,Zt.Z)(ire);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(n[i]){var o,u=(0,Zt.Z)(n[i]);try{for(u.s();!(o=u.n()).done;){var s=o.value;if(!s.get("disable")&&!s.get("gridScale")){var c="x"===i?"height":"width",l=e.getSizeSignalRef(c).signal;c!==l&&r.push({name:c,update:l})}}}catch(f){u.e(f)}finally{u.f()}}}}catch(f){a.e(f)}finally{a.f()}return r}var Dde={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},Fde={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},Ide=Yee(Dde),Mde=Yee(Fde);function Ode(e,t,n,r){return Object.assign.apply(null,[{}].concat((0,ln.Z)(e.map((function(e){if("axisOrient"===e){var a,i="x"===n?"bottom":"left",o=t["x"===n?"axisBottom":"axisLeft"]||{},u=t["x"===n?"axisTop":"axisRight"]||{},s=new Set([].concat((0,ln.Z)(Yee(o)),(0,ln.Z)(Yee(u)))),c={},l=(0,Zt.Z)(s.values());try{for(l.s();!(a=l.n()).done;){var f=a.value;c[f]={signal:"".concat(r.signal,' === "').concat(i,'" ? ').concat(nue(o[f])," : ").concat(nue(u[f]))}}}catch(d){l.e(d)}finally{l.f()}return c}return t[e]})))))}function Rde(e,t,n,r){var a="band"===t?["axisDiscrete","axisBand"]:"point"===t?["axisDiscrete","axisPoint"]:function(e){return e in yie}(t)?["axisQuantitative"]:"time"===t||"utc"===t?["axisTemporal"]:[],i="x"===e?"axisX":"axisY",o=Aae(n)?"axisOrient":"axis"+nte(n),u=[].concat(a,(0,ln.Z)(a.map((function(e){return i+e.substr(4)})))),s=["axis",o,i];return{vlOnlyAxisConfig:Ode(u,r,e,n),vgAxisConfig:Ode(s,r,e,n),axisConfigStyle:Zde([].concat(s,(0,ln.Z)(u)),r)}}function Zde(e,t){var n,r,a=[{}],i=(0,Zt.Z)(e);try{for(i.s();!(r=i.n()).done;){var o=null===(n=t[r.value])||void 0===n?void 0:n.style;if(o){o=hee(o);var u,s=(0,Zt.Z)(o);try{for(s.s();!(u=s.n()).done;){var c=u.value;a.push(t.style[c])}}catch(l){s.e(l)}finally{s.f()}}}}catch(l){i.e(l)}finally{i.f()}return Object.assign.apply(null,a)}function Bde(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=uue(e,n,t.style);if(void 0!==i)return{configFrom:"style",configValue:i};for(var o=0,u=["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"];o<u.length;o++){var s=u[o];if(void 0!==(null===(r=a[s])||void 0===r?void 0:r[e]))return{configFrom:s,configValue:a[s][e]}}return{}}var zde={scale:function(e){var t=e.model,n=e.channel;return t.scaleName(n)},format:function(e){var t=e.fieldOrDatumDef,n=e.config,r=e.axis,a=r.format,i=r.formatType;return Xie(t,t.type,a,i,n,!0)},formatType:function(e){var t=e.axis,n=e.fieldOrDatumDef,r=e.scaleType,a=t.formatType;return Yie(a,n,r)},grid:function(e){var t,n=e.fieldOrDatumDef,r=e.axis,a=e.scaleType;return(!goe(n)||!kre(n.bin))&&(null!==(t=r.grid)&&void 0!==t?t:function(e,t){return!wie(e)&&goe(t)&&!xre(null===t||void 0===t?void 0:t.bin)}(a,n))},gridScale:function(e){return function(e,t){var n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n);return}(e.model,e.channel)},labelAlign:function(e){var t=e.axis,n=e.labelAngle,r=e.orient,a=e.channel;return t.labelAlign||jde(n,r,a)},labelAngle:function(e){return e.labelAngle},labelBaseline:function(e){var t=e.axis,n=e.labelAngle,r=e.orient,a=e.channel;return t.labelBaseline||Pde(n,r,a)},labelFlush:function(e){var t,n=e.axis,r=e.fieldOrDatumDef,a=e.channel;return null!==(t=n.labelFlush)&&void 0!==t?t:function(e,t){if("x"===t&&Pee(["quantitative","temporal"],e))return!0;return}(r.type,a)},labelOverlap:function(e){var t,n=e.axis,r=e.fieldOrDatumDef,a=e.scaleType;return null!==(t=n.labelOverlap)&&void 0!==t?t:function(e,t){if("nominal"!==e)return"log"!==t||"greedy";return}(r.type,a)},orient:function(e){return e.orient},tickCount:function(e){var t,n=e.channel,r=e.model,a=e.axis,i=e.fieldOrDatumDef,o=e.scaleType,u="x"===n?"width":"y"===n?"height":void 0,s=u?r.getSizeSignalRef(u):void 0;return null!==(t=a.tickCount)&&void 0!==t?t:function(e){var t,n=e.fieldOrDatumDef,r=e.scaleType,a=e.size,i=e.values;if(!i&&!wie(r)&&"log"!==r){if(goe(n)){if(xre(n.bin))return{signal:"ceil(".concat(a.signal,"/10)")};if(n.timeUnit&&Pee(["month","hours","day","quarter"],null===(t=Cae(n.timeUnit))||void 0===t?void 0:t.unit))return}return{signal:"ceil(".concat(a.signal,"/40)")}}return}({fieldOrDatumDef:i,scaleType:o,size:s,values:a.values})},title:function(e){var t=e.axis,n=e.model,r=e.channel;if(void 0!==t.title)return t.title;var a=Ude(n,r);if(void 0!==a)return a;var i=n.typedFieldDef(r),o="x"===r?"x2":"y2",u=n.fieldDef(o);return cue(i?[coe(i)]:[],goe(u)?[coe(u)]:[])},values:function(e){return function(e,t){var n=e.values;if(uee(n))return Koe(t,n);if(Aae(n))return n;return}(e.axis,e.fieldOrDatumDef)},zindex:function(e){var t,n=e.axis,r=e.fieldOrDatumDef,a=e.mark;return null!==(t=n.zindex)&&void 0!==t?t:function(e,t){if("rect"===e&&Doe(t))return 1;return 0}(a,r)}};function Lde(e){return"(((".concat(e.signal," % 360) + 360) % 360)")}function Pde(e,t,n,r){if(void 0!==e){if("x"===n){if(Aae(e)){var a=Lde(e),i=Aae(t)?"(".concat(t.signal,' === "top")'):"top"===t;return{signal:"(45 < ".concat(a," && ").concat(a," < 135) || (225 < ").concat(a," && ").concat(a,' < 315) ? "middle" :')+"(".concat(a," <= 45 || 315 <= ").concat(a,") === ").concat(i,' ? "bottom" : "top"')}}if(45<e&&e<135||225<e&&e<315)return"middle";if(Aae(t)){var o=e<=45||315<=e?"===":"!==";return{signal:"".concat(t.signal," ").concat(o,' "top" ? "bottom" : "top"')}}return(e<=45||315<=e)===("top"===t)?"bottom":"top"}if(Aae(e)){var u=Lde(e),s=Aae(t)?"(".concat(t.signal,' === "left")'):"left"===t,c=r?'"middle"':"null";return{signal:"".concat(u," <= 45 || 315 <= ").concat(u," || (135 <= ").concat(u," && ").concat(u," <= 225) ? ").concat(c," : (45 <= ").concat(u," && ").concat(u," <= 135) === ").concat(s,' ? "top" : "bottom"')}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(Aae(t)){var l=45<=e&&e<=135?"===":"!==";return{signal:"".concat(t.signal," ").concat(l,' "left" ? "top" : "bottom"')}}return(45<=e&&e<=135)===("left"===t)?"top":"bottom"}}function jde(e,t,n){if(void 0!==e){var r="x"===n,a=r?0:90,i=r?"bottom":"left";if(Aae(e)){var o=Lde(e),u=Aae(t)?"(".concat(t.signal,' === "').concat(i,'")'):t===i;return{signal:"(".concat(a?"("+o+" + 90)":o," % 180 === 0) ? ").concat(r?null:'"center"'," :")+"(".concat(a," < ").concat(o," && ").concat(o," < ").concat(180+a,") === ").concat(u,' ? "left" : "right"')}}if((e+a)%180===0)return r?null:"center";if(Aae(t)){var s=a<e&&e<180+a?"===":"!==",c="".concat(t.signal," ").concat(s,' "').concat(i,'"');return{signal:"".concat(c,' ? "left" : "right"')}}return(a<e&&e<180+a)===(t===i)?"left":"right"}}function Ude(e,t){var n="x"===t?"x2":"y2",r=e.fieldDef(t),a=e.fieldDef(n),i=r?r.title:void 0,o=a?a.title:void 0;return i&&o?lue(i,o):i||(o||(void 0!==i?i:void 0!==o?o:void 0))}var Wde=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a;return(0,Jh.Z)(this,n),(a=t.call(this,e)).transform=r,a._dependentFields=kde(a.transform.calculate),a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Oee(this.transform))}},{key:"producedFields",value:function(){return new Set([this.transform.as])}},{key:"dependentFields",value:function(){return this._dependentFields}},{key:"assemble",value:function(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}},{key:"hash",value:function(){return"Calculate ".concat(zee(this.transform))}}],[{key:"parseAllForSortIndex",value:function(e,t){return t.forEachFieldDef((function(t,r){if(Coe(t)&&ioe(t.sort)){var a=t.field,i=t.timeUnit,o=t.sort,u=o.map((function(e,t){return"".concat(Wae({field:a,timeUnit:i,equal:e})," ? ").concat(t," : ")})).join("")+o.length;e=new n(e,{calculate:u,as:Vde(t,r,{forAs:!0})})}})),e}}]),n}(ole);function Vde(e,t,n){return Noe(e,Object.assign({prefix:t,suffix:"sort_index"},null!==n&&void 0!==n?n:{}))}function Gde(e,t){return Pee(["top","bottom"],t)?"column":Pee(["left","right"],t)||"row"===e?"row":"column"}function qde(e,t,n,r){var a="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return lte(((null===t||void 0===t?void 0:t.header)||{})[e],a[e],n.header[e])}function Hde(e,t,n,r){var a,i={},o=(0,Zt.Z)(e);try{for(o.s();!(a=o.n()).done;){var u=a.value,s=qde(u,t,n,r);void 0!==s&&(i[u]=s)}}catch(c){o.e(c)}finally{o.f()}return i}var Xde=["row","column"],Yde=["header","footer"];function Kde(e,t){var n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,a=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,i=Hde(["titleAnchor","titleAngle","titleOrient"],a,r,t),o=i.titleAnchor,u=i.titleAngle,s=Gde(t,i.titleOrient),c=hte(u);return{name:"".concat(t,"-title"),type:"group",role:"".concat(s,"-title"),title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===t?{orient:"left"}:{}),{style:"guide-title"}),Qde(c,s)),$de(s,c,o)),ihe(r,a,t,Ide,Dde))}}function $de(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"middle";switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}var r=jde(t,"row"===e?"left":"top","row"===e?"y":"x");return r?{align:r}:{}}function Qde(e,t){var n=Pde(e,"row"===t?"left":"top","row"===t?"y":"x",!0);return n?{baseline:n}:{}}function Jde(e,t){var n,r=e.component.layoutHeaders[t],a=[],i=(0,Zt.Z)(Yde);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(r[o]){var u,s=(0,Zt.Z)(r[o]);try{for(s.s();!(u=s.n()).done;){var c=nhe(e,t,o,r,u.value);null!=c&&a.push(c)}}catch(l){s.e(l)}finally{s.f()}}}}catch(l){i.e(l)}finally{i.f()}return a}function ehe(e,t){var n,r=e.sort;return aoe(r)?{field:Noe(r,{expr:"datum"}),order:null!==(n=r.order)&&void 0!==n?n:"ascending"}:uee(r)?{field:Vde(e,t,{expr:"datum"}),order:"ascending"}:{field:Noe(e,{expr:"datum"}),order:null!==r&&void 0!==r?r:"ascending"}}function the(e,t,n){var r=Hde(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),a=r.format,i=r.formatType,o=r.labelAngle,u=r.labelAnchor,s=r.labelOrient,c=r.labelExpr,l=Gie({fieldOrDatumDef:e,format:a,formatType:i,expr:"parent",config:n}).signal,f=Gde(t,s);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:c?ute(ute(c,"datum.label",l),"datum.value",Noe(e,{expr:"parent"})):l}},"row"===t?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),Qde(o,f)),$de(f,o,u)),ihe(n,e,t,Mde,Fde))}function nhe(e,t,n,r,a){if(a){var i=null,o=r.facetFieldDef,u=e.config?e.config:void 0;if(o&&a.labels){var s=Hde(["labelOrient"],o,u,t).labelOrient;("row"===t&&!Pee(["top","bottom"],s)||"column"===t&&!Pee(["left","right"],s))&&(i=the(o,t,u))}var c=ive(e)&&!ooe(e.facet),l=a.axes,f=(null===l||void 0===l?void 0:l.length)>0;if(i||f){var d="row"===t?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("".concat(t,"_").concat(n)),type:"group",role:"".concat(t,"-").concat(n)},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:ehe(o,t)}:{}),f&&c?{from:{data:e.getName("facet_domain_".concat(t))}}:{}),i?{title:i}:{}),a.sizeSignal?{encode:{update:(0,qn.Z)({},d,a.sizeSignal)}}:{}),f?{axes:l}:{})}}return null}var rhe={column:{start:0,end:1},row:{start:1,end:0}};function ahe(e,t){return rhe[t][e]}function ihe(e,t,n,r,a){var i,o={},u=(0,Zt.Z)(r);try{for(u.s();!(i=u.n()).done;){var s=i.value;if(a[s]){var c=qde(s,t,e,n);void 0!==c&&(o[a[s]]=c)}}}catch(l){u.e(l)}finally{u.f()}return o}function ohe(e){return[].concat((0,ln.Z)(uhe(e,"width")),(0,ln.Z)(uhe(e,"height")),(0,ln.Z)(uhe(e,"childWidth")),(0,ln.Z)(uhe(e,"childHeight")))}function uhe(e,t){var n="width"===t?"x":"y",r=e.component.layoutSize.get(t);if(!r||"merged"===r)return[];var a=e.getSizeSignalRef(t).signal;if("step"===r){var i=e.getScaleComponent(n);if(i){var o=i.get("type"),u=i.get("range");if(wie(o)&&Eae(u)){var s=e.scaleName(n);if(ive(e.parent))if("independent"===e.parent.component.resolve.scale[n])return[she(s,u)];return[she(s,u),{name:a,update:che(s,i,"domain('".concat(s,"').length"))}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){var c=a.endsWith("width"),l=c?"containerSize()[0]":"containerSize()[1]",f=rse(e.config.view,c?"width":"height"),d="isFinite(".concat(l,") ? ").concat(l," : ").concat(f);return[{name:a,init:d,on:[{update:d,events:"window:resize"}]}]}return[{name:a,value:r}]}function she(e,t){return{name:e+"_step",value:t.step}}function che(e,t,n){var r=t.get("type"),a=t.get("padding"),i=lte(t.get("paddingOuter"),a),o=t.get("paddingInner");return o="band"===r?void 0!==o?o:a:1,"bandspace(".concat(n,", ").concat(o,", ").concat(i,") * ").concat(e,"_step")}function lhe(e){return"childWidth"===e?"width":"childHeight"===e?"height":e}function fhe(e,t){return Yee(e).reduce((function(n,r){var a=e[r];return Object.assign(Object.assign({},n),Fce(t,a,r,(function(e){return Aae(e)?e:{value:e.value}})))}),{})}function dhe(e,t){if(uve(t)||ive(t))return"shared";if(ove(t))return ore(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function hhe(e,t){var n=e.scale[t],r=ore(t)?"axis":"legend";return"independent"===n?("shared"===e[r][t]&&oae(function(e){return'Setting the scale to be independent for "'.concat(e,'" means we also have to set the guide (axis or legend) to be independent.')}(t)),"independent"):e[r][t]||"shared"}var phe=Object.assign(Object.assign({},que),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),vhe=Yee(phe),ghe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(){return(0,Jh.Z)(this,n),t.apply(this,arguments)}return(0,ep.Z)(n)}($se),mhe={symbols:function(e,t){var n,r,a,i,o,u=t.fieldOrDatumDef,s=t.model,c=t.channel,l=t.legendCmpt,f=t.legendType;if("symbol"!==f)return;var d=s.markDef,h=s.encoding,p=s.config,v=s.mark,g=d.filled&&"trail"!==v,m=Object.assign(Object.assign({},function(e,t,n){var r,a=(0,Zt.Z)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value,o=iue(i,t.markDef,t.config);void 0!==o&&(e[i]=eue(o))}}catch(u){a.e(u)}finally{a.f()}return e}({},s,jte)),Lce(s,{filled:g})),y=null!==(n=yhe(h.opacity))&&void 0!==n?n:d.opacity;if(m.fill)if("fill"===c||g&&c===yne)delete m.fill;else if(m.fill.field)l.get("symbolFillColor")?delete m.fill:(m.fill=eue(null!==(r=p.legend.symbolBaseFillColor)&&void 0!==r?r:"black"),m.fillOpacity=eue(null!==y&&void 0!==y?y:1));else if(uee(m.fill)){var b=null!==(o=null!==(i=bhe(null!==(a=h.fill)&&void 0!==a?a:h.color))&&void 0!==i?i:d.fill)&&void 0!==o?o:g&&d.color;b&&(m.fill=eue(b))}if(m.stroke)if("stroke"===c||!g&&c===yne)delete m.stroke;else if(m.stroke.field)delete m.stroke;else if(uee(m.stroke)){var x=lte(bhe(h.stroke||h.color),d.stroke,g?d.color:void 0);x&&(m.stroke={value:x})}if(c!==Cne){var k=goe(u)&&khe(s,l,u);k?m.opacity=[Object.assign({test:k},eue(null!==y&&void 0!==y?y:1)),eue(p.legend.unselectedOpacity)]:y&&(m.opacity=eue(y))}return Xee(m=Object.assign(Object.assign({},m),e))?void 0:m},gradient:function(e,t){var n=t.model,r=t.legendType;if("gradient"!==r)return;var a={},i=yhe(n.encoding.opacity)||n.markDef.opacity;i&&(a.opacity=eue(i));return Xee(a=Object.assign(Object.assign({},a),e))?void 0:a},labels:function(e,t){var n=t.fieldOrDatumDef,r=t.model,a=t.channel,i=t.legendCmpt,o=r.legend(a)||{},u=r.config,s=goe(n)?khe(r,i,n):void 0,c=s?[{test:s,value:1},{value:u.legend.unselectedOpacity}]:void 0,l=o.format,f=o.formatType,d=Wie(f)?Hie({fieldOrDatumDef:n,field:"datum.value",format:l,formatType:f,config:u}):void 0,h=Object.assign(Object.assign(Object.assign({},c?{opacity:c}:{}),d?{text:d}:{}),e);return Xee(h)?void 0:h},entries:function(e,t){var n=t.legendCmpt.get("selections");return(null===n||void 0===n?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}};function yhe(e){return xhe(e,(function(e,t){return Math.max(e,t.value)}))}function bhe(e){return xhe(e,(function(e,t){return lte(e,t.value)}))}function xhe(e,t){return function(e){var t=e&&e.condition;return!!t&&(uee(t)||_oe(t))}(e)?hee(e.condition).reduce(t,e.value):_oe(e)?e.value:void 0}function khe(e,t,n){var r=t.get("selections");if(null===r||void 0===r?void 0:r.length){var a=bee(n.field);return r.map((function(e){var t=bee(Jee(e)+Ule);return"(!length(data(".concat(t,")) || (").concat(e,"[").concat(a,"] && indexof(").concat(e,"[").concat(a,"], datum.value) >= 0))")})).join(" || ")}}var whe={direction:function(e){return e.direction},format:function(e){var t=e.fieldOrDatumDef,n=e.legend,r=e.config,a=n.format,i=n.formatType;return Xie(t,t.type,a,i,r,!1)},formatType:function(e){var t=e.legend,n=e.fieldOrDatumDef,r=e.scaleType,a=t.formatType;return Yie(a,n,r)},gradientLength:function(e){var t,n,r=e.legend,a=e.legendConfig;return null!==(n=null!==(t=r.gradientLength)&&void 0!==t?t:a.gradientLength)&&void 0!==n?n:function(e){var t=e.legendConfig,n=e.model,r=e.direction,a=e.orient,i=e.scaleType,o=t.gradientHorizontalMaxLength,u=t.gradientHorizontalMinLength,s=t.gradientVerticalMaxLength,c=t.gradientVerticalMinLength;if(Cie(i))return"horizontal"===r?"top"===a||"bottom"===a?She(n,"width",u,o):u:She(n,"height",c,s);return}(e)},labelOverlap:function(e){var t,n,r=e.legend,a=e.legendConfig,i=e.scaleType;return null!==(n=null!==(t=r.labelOverlap)&&void 0!==t?t:a.labelOverlap)&&void 0!==n?n:function(e){if(Pee(["quantile","threshold","log"],e))return"greedy";return}(i)},symbolType:function(e){var t,n=e.legend,r=e.markDef,a=e.channel,i=e.encoding;return null!==(t=n.symbolType)&&void 0!==t?t:function(e,t,n,r){var a;if("shape"!==t){var i=null!==(a=bhe(n))&&void 0!==a?a:r;if(i)return i}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(r.type,a,i.shape,r.shape)},title:function(e){return Boe(e.fieldOrDatumDef,e.config,{allowDisabling:!0})},type:function(e){var t=e.legendType,n=e.scaleType;if(Une(e.channel)&&Cie(n)){if("gradient"===t)return}else if("symbol"===t)return;return t},values:function(e){var t=e.fieldOrDatumDef;return function(e,t){var n=e.values;if(uee(n))return Koe(t,n);if(Aae(n))return n;return}(e.legend,t)}};function _he(e){return lte(e.legend.type,function(e){var t=e.channel,n=e.timeUnit,r=e.scaleType;if(Une(t)){if(Pee(["quarter","month","day"],n))return"symbol";if(Cie(r))return"gradient"}return"symbol"}(e))}function Che(e){var t,n,r=e.legendConfig,a=e.legendType,i=e.orient;return null!==(n=null!==(t=e.legend.direction)&&void 0!==t?t:r[a?"gradientDirection":"symbolDirection"])&&void 0!==n?n:function(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===t?"horizontal":void 0}}(i,a)}function She(e,t,n,r){var a=e.getSizeSignalRef(t).signal;return{signal:"clamp(".concat(a,", ").concat(n,", ").concat(r,")")}}function Ahe(e){var t=ave(e)?function(e){for(var t=e.encoding,n={},r=0,a=[yne].concat((0,ln.Z)(Vue));r<a.length;r++){var i=a[r],o=Uoe(t[i]);o&&e.getScaleComponent(i)&&(i===kne&&goe(o)&&o.type===$ae||(n[i]=The(e,i)))}return n}(e):function(e){var t,n=e.component,r=n.legends,a=n.resolve,i=(0,Zt.Z)(e.children);try{for(i.s();!(t=i.n()).done;){var o=t.value;Ahe(o);var u,s=(0,Zt.Z)(Yee(o.component.legends));try{for(s.s();!(u=s.n()).done;){var c=u.value;a.legend[c]=hhe(e.component.resolve,c),"shared"===a.legend[c]&&(r[c]=Nhe(r[c],o.component.legends[c]),r[c]||(a.legend[c]="independent",delete r[c]))}}catch(g){s.e(g)}finally{s.f()}}}catch(g){i.e(g)}finally{i.f()}var l,f=(0,Zt.Z)(Yee(r));try{for(f.s();!(l=f.n()).done;){var d,h=l.value,p=(0,Zt.Z)(e.children);try{for(p.s();!(d=p.n()).done;){var v=d.value;v.component.legends[h]&&("shared"===a.legend[h]&&delete v.component.legends[h])}}catch(g){p.e(g)}finally{p.f()}}}catch(g){f.e(g)}finally{f.f()}return r}(e);return e.component.legends=t,t}function Ehe(e,t,n,r){switch(t){case"disable":return void 0!==n;case"values":return!!(null===n||void 0===n?void 0:n.values);case"title":if("title"===t&&e===(null===r||void 0===r?void 0:r.title))return!0}return e===(n||{})[t]}function The(e,t){var n,r,a,i=e.legend(t),o=e.markDef,u=e.encoding,s=e.config,c=s.legend,l=new ghe({},function(e,t){var n=e.scaleName(t);if("trail"===e.mark){if("color"===t)return{stroke:n};if("size"===t)return{strokeWidth:n}}return"color"===t?e.markDef.filled?{fill:n}:{stroke:n}:(0,qn.Z)({},t,n)}(e,t));!function(e,t,n){var r,a=null===(r=e.fieldDef(t))||void 0===r?void 0:r.field;Hle(e,(function(e){var r,i,o=null!==(r=e.project.hasField[a])&&void 0!==r?r:e.project.hasChannel[t];if(o&&kle.has(e)){var u=null!==(i=n.get("selections"))&&void 0!==i?i:[];u.push(e.name),n.set("selections",u,!1),o.hasLegend=!0}}))}(e,t,l);var f=void 0!==i?!i:c.disable;if(l.set("disable",f,void 0!==i),f)return l;i=i||{};var d,h=e.getScaleComponent(t).get("type"),p=Uoe(u[t]),v=goe(p)?null===(n=Cae(p.timeUnit))||void 0===n?void 0:n.unit:void 0,g=i.orient||s.legend.orient||"right",m=_he({legend:i,channel:t,timeUnit:v,scaleType:h}),y={legend:i,channel:t,model:e,markDef:o,encoding:u,fieldOrDatumDef:p,legendConfig:c,config:s,scaleType:h,orient:g,legendType:m,direction:Che({legend:i,legendType:m,orient:g,legendConfig:c})},b=(0,Zt.Z)(vhe);try{for(b.s();!(d=b.n()).done;){var x=d.value,k=x in whe?whe[x](y):i[x];if(void 0!==k){var w=Ehe(k,x,i,e.fieldDef(t));(w||void 0===s.legend[x])&&l.set(x,k,w)}}}catch(I){b.e(I)}finally{b.f()}for(var _=null!==(r=null===i||void 0===i?void 0:i.encoding)&&void 0!==r?r:{},C=l.get("selections"),S={},A={fieldOrDatumDef:p,model:e,channel:t,legendCmpt:l,legendType:m},E=0,T=["labels","legend","title","symbols","gradient","entries"];E<T.length;E++){var N=T[E],D=fhe(null!==(a=_[N])&&void 0!==a?a:{},e),F=N in mhe?mhe[N](D,A):D;void 0===F||Xee(F)||(S[N]=Object.assign(Object.assign(Object.assign({},(null===C||void 0===C?void 0:C.length)&&goe(p)?{name:"".concat(Jee(p.field),"_legend_").concat(N)}:{}),(null===C||void 0===C?void 0:C.length)?{interactive:!!C}:{}),{update:F}))}return Xee(S)||l.set("encode",S,!!(null===i||void 0===i?void 0:i.encoding)),l}function Nhe(e,t){var n,r,a,i;if(!e)return t.clone();var o=e.getWithExplicit("orient"),u=t.getWithExplicit("orient");if(!o.explicit||!u.explicit||o.value===u.value){var s,c=!1,l=(0,Zt.Z)(vhe);try{var f=function(){var n=s.value,r=nce(e.getWithExplicit(n),t.getWithExplicit(n),n,"legend",(function(e,t){switch(n){case"symbolType":return function(e,t){if("circle"===t.value)return t;return e}(e,t);case"title":return fue(e,t);case"type":return c=!0,Jse("symbol")}return tce(e,t,n,"legend")}));e.setWithExplicit(n,r)};for(l.s();!(s=l.n()).done;)f()}catch(d){l.e(d)}finally{l.f()}return c&&((null===(r=null===(n=e.implicit)||void 0===n?void 0:n.encode)||void 0===r?void 0:r.gradient)&&tte(e.implicit,["encode","gradient"]),(null===(i=null===(a=e.explicit)||void 0===a?void 0:a.encode)||void 0===i?void 0:i.gradient)&&tte(e.explicit,["encode","gradient"])),e}}function Dhe(e,t,n,r){var a,i,o;e.encode=null!==(a=e.encode)&&void 0!==a?a:{},e.encode[t]=null!==(i=e.encode[t])&&void 0!==i?i:{},e.encode[t].update=null!==(o=e.encode[t].update)&&void 0!==o?o:{},e.encode[t].update[n]=r}function Fhe(e){var t,n=e.component.legends,r={},a=(0,Zt.Z)(Yee(n));try{for(a.s();!(t=a.n()).done;){var i=t.value,o=e.getScaleComponent(i),u=Bee(o.get("domains"));if(r[u]){var s,c=(0,Zt.Z)(r[u]);try{for(c.s();!(s=c.n()).done;){Nhe(s.value,n[i])||r[u].push(n[i])}}catch(f){c.e(f)}finally{c.f()}}else r[u]=[n[i].clone()]}}catch(f){a.e(f)}finally{a.f()}var l=Kee(r).flat().map((function(t){return function(e,t){var n,r,a,i=e.combine(),o=i.disable,u=i.labelExpr,s=(i.selections,kee(i,["disable","labelExpr","selections"]));if(o)return;!1===t.aria&&void 0==s.aria&&(s.aria=!1);if(null===(n=s.encode)||void 0===n?void 0:n.symbols){var c=s.encode.symbols.update;!c.fill||"transparent"===c.fill.value||c.stroke||s.stroke||(c.stroke={value:"transparent"});var l,d=(0,Zt.Z)(Vue);try{for(d.s();!(l=d.n()).done;){var h=l.value;s[h]&&delete c[h]}}catch(f){d.e(f)}finally{d.f()}}s.title||delete s.title;if(void 0!==u){var p=u;(null===(a=null===(r=s.encode)||void 0===r?void 0:r.labels)||void 0===a?void 0:a.update)&&Aae(s.encode.labels.update.text)&&(p=ute(u,"datum.label",s.encode.labels.update.text.signal)),Dhe(s,"labels","text",{signal:p})}for(var v in s){var g=s[v];if(Aae(g)){var m=Gue[v];if(m){var y=m.vgProp;Dhe(s,m.part,y,g),delete s[v]}}}return s}(t,e.config)})).filter((function(e){return void 0!==e}));return l}function Ihe(e){return uve(e)||ove(e)?function(e){return e.children.reduce((function(e,t){return e.concat(t.assembleProjections())}),Mhe(e))}(e):Mhe(e)}function Mhe(e){var t=e.component.projection;if(!t||t.merged)return[];var n=t.combine(),r=n.name;if(t.data){var a={signal:"[".concat(t.size.map((function(e){return e.signal})).join(", "),"]")},i=t.data.reduce((function(t,n){var r=Aae(n)?n.signal:"data('".concat(e.lookupDataSource(n),"')");return Pee(t,r)||t.push(r),t}),[]);if(i.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:a,fit:{signal:i.length>1?"[".concat(i.join(", "),"]"):i[0]}},n)]}return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}var Ohe=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"],Rhe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r,a,i){var o;return(0,Jh.Z)(this,n),(o=t.call(this,Object.assign({},r),{name:e})).specifiedProjection=r,o.size=a,o.data=i,o.merged=!1,o}return(0,ep.Z)(n,[{key:"isFit",get:function(){return!!this.data}}]),n}($se);function Zhe(e){e.component.projection=ave(e)?function(e){var t;if(e.hasProjection){var n=e.specifiedProjection,r=!(n&&(null!=n.scale||null!=n.translate)),a=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,i=r?function(e){for(var t=[],n=e.encoding,r=0,a=[[vne,pne],[mne,gne]];r<a.length;r++){var i=a[r];(Uoe(n[i[0]])||Uoe(n[i[1]]))&&t.push({signal:e.getName("geojson_".concat(t.length))})}e.channelHasField(kne)&&e.typedFieldDef(kne).type===$ae&&t.push({signal:e.getName("geojson_".concat(t.length))});0===t.length&&t.push(e.requestDataName(fce));return t}(e):void 0;return new Rhe(e.projectionName(!0),Object.assign(Object.assign({},null!==(t=e.config.projection)&&void 0!==t?t:{}),null!==n&&void 0!==n?n:{}),a,i)}return}(e):function(e){if(0===e.children.length)return;var t,n,r=(0,Zt.Z)(e.children);try{for(r.s();!(n=r.n()).done;){Zhe(n.value)}}catch(d){r.e(d)}finally{r.f()}var a=Uee(e.children,(function(e){var n=e.component.projection;if(n){if(t){var r=function(e,t){var n=Uee(Ohe,(function(n){return!vee(e.explicit,n)&&!vee(t.explicit,n)||!(!vee(e.explicit,n)||!vee(t.explicit,n)||Bee(e.get(n))!==Bee(t.get(n)))})),r=Bee(e.size)===Bee(t.size);if(r){if(n)return e;if(Bee(e.explicit)===Bee({}))return t;if(Bee(t.explicit)===Bee({}))return e}return null}(t,n);return r&&(t=r),!!r}return t=n,!0}return!0}));if(t&&a){var i,o=e.projectionName(!0),u=new Rhe(o,t.specifiedProjection,t.size,Oee(t.data)),s=(0,Zt.Z)(e.children);try{for(s.s();!(i=s.n()).done;){var c=i.value,l=c.component.projection;if(l){var f;if(l.isFit)(f=u.data).push.apply(f,(0,ln.Z)(c.component.projection.data));c.renameProjection(l.get("name"),o),l.merged=!0}}}catch(d){s.e(d)}finally{s.f()}return u}return}(e)}var Bhe=n(4506);function zhe(e,t){return"".concat(bre(e),"_").concat(t)}function Lhe(e,t,n){var r,a=zhe(null!==(r=qoe(n,void 0))&&void 0!==r?r:{},t);return e.getName("".concat(a,"_bins"))}function Phe(e,t,n){var r,a;r=function(e){return"as"in e}(e)?yee(e.as)?[e.as,"".concat(e.as,"_end")]:[e.as[0],e.as[1]]:[Noe(e,{forAs:!0}),Noe(e,{binSuffix:"end",forAs:!0})];var i=Object.assign({},qoe(t,void 0)),o=zhe(i,e.field),u=function(e,t){return{signal:e.getName("".concat(t,"_bins")),extentSignal:e.getName("".concat(t,"_extent"))}}(n,o),s=u.signal,c=u.extentSignal;if(_re(i.extent)){var l=i.extent,f=l.selection;a=Cde(n.getSelectionComponent(Jee(f),f),l),delete i.extent}return{key:o,binComponent:Object.assign(Object.assign(Object.assign({bin:i,field:e.field,as:[r]},s?{signal:s}:{}),c?{extentSignal:c}:{}),a?{span:a}:{})}}var jhe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a;return(0,Jh.Z)(this,n),(a=t.call(this,e)).bins=r,a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Oee(this.bins))}},{key:"merge",value:function(e,t){var n,r=(0,Zt.Z)(Yee(e.bins));try{for(r.s();!(n=r.n()).done;){var a=n.value;a in this.bins?(t(e.bins[a].signal,this.bins[a].signal),this.bins[a].as=Vee([].concat((0,ln.Z)(this.bins[a].as),(0,ln.Z)(e.bins[a].as)),zee)):this.bins[a]=e.bins[a]}}catch(s){r.e(s)}finally{r.f()}var i,o=(0,Zt.Z)(e.children);try{for(o.s();!(i=o.n()).done;){var u=i.value;e.removeChild(u),u.parent=this}}catch(s){o.e(s)}finally{o.f()}e.remove()}},{key:"producedFields",value:function(){return new Set(Kee(this.bins).map((function(e){return e.as})).flat(2))}},{key:"dependentFields",value:function(){return new Set(Kee(this.bins).map((function(e){return e.field})))}},{key:"hash",value:function(){return"Bin ".concat(zee(this.bins))}},{key:"assemble",value:function(){return Kee(this.bins).flatMap((function(e){var t=[],n=(0,Bhe.Z)(e.as),r=n[0],a=n.slice(1),i=e.bin,o=i.extent,u=kee(i,["extent"]),s=Object.assign(Object.assign(Object.assign({type:"bin",field:ote(e.field),as:r,signal:e.signal},_re(o)?{extent:null}:{extent:o}),e.span?{span:{signal:"span(".concat(e.span,")")}}:{}),u);!o&&e.extentSignal&&(t.push({type:"extent",field:ote(e.field),signal:e.extentSignal}),s.extent={signal:e.extentSignal}),t.push(s);var c,l=(0,Zt.Z)(a);try{for(l.s();!(c=l.n()).done;)for(var f=c.value,d=0;d<2;d++)t.push({type:"formula",expr:Noe({field:r[d]},{expr:"datum"}),as:f[d]})}catch(h){l.e(h)}finally{l.f()}return e.formula&&t.push({type:"formula",expr:e.formula,as:e.formulaAs}),t}))}}],[{key:"makeFromEncoding",value:function(e,t){var r=t.reduceFieldDef((function(e,n,r){if(woe(n)&&xre(n.bin)){var a=Phe(n,n.bin,t),i=a.key,o=a.binComponent;e[i]=Object.assign(Object.assign(Object.assign({},o),e[i]),function(e,t,n,r){var a,i;if($oe(t,n)){var o=ave(e)&&null!==(i=null!==(a=e.axis(n))&&void 0!==a?a:e.legend(n))&&void 0!==i?i:{},u=Noe(t,{expr:"datum"}),s=Noe(t,{expr:"datum",binSuffix:"end"});return{formulaAs:Noe(t,{binSuffix:"range",forAs:!0}),formula:Jie(u,s,o.format,o.formatType,r)}}return{}}(t,n,r,t.config))}return e}),{});return Xee(r)?null:new n(e,r)}},{key:"makeFromTransform",value:function(e,t,r){var a=Phe(t,t.bin,r),i=a.key,o=a.binComponent;return new n(e,(0,qn.Z)({},i,o))}}]),n}(ole),Uhe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e){var r,a;if((0,Jh.Z)(this,n),r=t.call(this,null),uce(e=null!==e&&void 0!==e?e:{name:"source"})||(a=e.format?Object.assign({},Zee(e.format,["parse"])):{}),ice(e))r._data={values:e.values};else if(ace(e)){if(r._data={url:e.url},!a.type){var i=/(?:\.([^.]+))?$/.exec(e.url)[1];Pee(["json","csv","tsv","dsv","topojson"],i)||(i="json"),a.type=i}}else cce(e)?r._data={values:[{type:"Sphere"}]}:(oce(e)||uce(e))&&(r._data={});return r._generator=uce(e),e.name&&(r._name=e.name),a&&!Xee(a)&&(r._data.format=a),r}return(0,ep.Z)(n,[{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){}},{key:"data",get:function(){return this._data}},{key:"hasName",value:function(){return!!this._name}},{key:"isGenerator",get:function(){return this._generator}},{key:"dataName",get:function(){return this._name},set:function(e){this._name=e}},{key:"parent",set:function(e){throw new Error("Source nodes have to be roots.")}},{key:"remove",value:function(){throw new Error("Source nodes are roots and cannot be removed.")}},{key:"hash",value:function(){throw new Error("Cannot hash sources")}},{key:"assemble",value:function(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}]),n}(ole);function Whe(e){var t,n=(0,Zt.Z)(e);try{for(n.s();!(t=n.n()).done;){var r,a=t.value,i=(0,Zt.Z)(a.children);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o.parent!==a)return console.error("Dataflow graph is inconsistent.",a,o),!1}}catch(u){i.e(u)}finally{i.f()}if(!Whe(a.children))return!1}}catch(u){n.e(u)}finally{n.f()}return!0}var Vhe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a;return(0,Jh.Z)(this,n),(a=t.call(this,e)).params=r,a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,this.params)}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){}},{key:"hash",value:function(){return"Graticule ".concat(zee(this.params))}},{key:"assemble",value:function(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}]),n}(ole),Ghe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a;return(0,Jh.Z)(this,n),(a=t.call(this,e)).params=r,a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,this.params)}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){var e;return new Set([null!==(e=this.params.as)&&void 0!==e?e:"data"])}},{key:"hash",value:function(){return"Hash ".concat(zee(this.params))}},{key:"assemble",value:function(){return Object.assign({type:"sequence"},this.params)}}]),n}(ole);function qhe(e){return e instanceof Uhe||e instanceof Vhe||e instanceof Ghe}var Hhe=function(){function e(){(0,Jh.Z)(this,e),this._mutated=!1}return(0,ep.Z)(e,[{key:"setMutated",value:function(){this._mutated=!0}},{key:"mutatedFlag",get:function(){return this._mutated}}]),e}(),Xhe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(){var e;return(0,Jh.Z)(this,n),(e=t.call(this))._continue=!1,e}return(0,ep.Z)(n,[{key:"setContinue",value:function(){this._continue=!0}},{key:"continueFlag",get:function(){return this._continue}},{key:"flags",get:function(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}},set:function(e){var t=e.continueFlag,n=e.mutatedFlag;t&&this.setContinue(),n&&this.setMutated()}},{key:"reset",value:function(){}},{key:"optimizeNextFromLeaves",value:function(e){if(qhe(e))return!1;var t=e.parent;return this.run(e).continueFlag&&this.optimizeNextFromLeaves(t),this.mutatedFlag}}]),n}(Hhe),Yhe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(){return(0,Jh.Z)(this,n),t.apply(this,arguments)}return(0,ep.Z)(n)}(Hhe);function Khe(e,t,n,r){var a=ave(r)?r.encoding[ere(t)]:void 0;if(woe(n)&&ave(r)&&doe(t,n,a,r.stack,r.markDef,r.config))e.add(Noe(n,{})),e.add(Noe(n,{suffix:"end"})),n.bin&&$oe(n,t)&&e.add(Noe(n,{binSuffix:"range"}));else if(function(e){return e in Lne}(t)){var i=function(e){switch(e){case pne:return"y";case gne:return"y2";case vne:return"x";case mne:return"x2"}}(t);e.add(r.getName(i))}else e.add(Noe(n));return e}var $he=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r,a){var i;return(0,Jh.Z)(this,n),(i=t.call(this,e)).dimensions=r,i.measures=a,i}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,new Set(this.dimensions),Oee(this.measures))}},{key:"groupBy",get:function(){return this.dimensions}},{key:"merge",value:function(e){return function(e,t){if(e.size!==t.size)return!1;var n,r=(0,Zt.Z)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(!t.has(a))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(this.dimensions,e.dimensions)?(function(e,t){var n,r,a=(0,Zt.Z)(Yee(t));try{for(a.s();!(r=a.n()).done;){var i,o=r.value,u=t[o],s=(0,Zt.Z)(Yee(u));try{for(s.s();!(i=s.n()).done;){var c=i.value;o in e?e[o][c]=new Set([].concat((0,ln.Z)(null!==(n=e[o][c])&&void 0!==n?n:[]),(0,ln.Z)(u[c]))):e[o]=(0,qn.Z)({},c,u[c])}}catch(l){s.e(l)}finally{s.f()}}}catch(l){a.e(l)}finally{a.f()}}(this.measures,e.measures),!0):(function(){var e;(e=rae).debug.apply(e,arguments)}("different dimensions, cannot merge"),!1)}},{key:"addDimensions",value:function(e){e.forEach(this.dimensions.add,this.dimensions)}},{key:"dependentFields",value:function(){return new Set([].concat((0,ln.Z)(this.dimensions),(0,ln.Z)(Yee(this.measures))))}},{key:"producedFields",value:function(){var e,t=new Set,n=(0,Zt.Z)(Yee(this.measures));try{for(n.s();!(e=n.n()).done;){var r,a=e.value,i=(0,Zt.Z)(Yee(this.measures[a]));try{for(i.s();!(r=i.n()).done;){var o=r.value,u=this.measures[a][o];0===u.size?t.add("".concat(o,"_").concat(a)):u.forEach(t.add,t)}}catch(s){i.e(s)}finally{i.f()}}}catch(s){n.e(s)}finally{n.f()}return t}},{key:"hash",value:function(){return"Aggregate ".concat(zee({dimensions:this.dimensions,measures:this.measures}))}},{key:"assemble",value:function(){var e,t=[],n=[],r=[],a=(0,Zt.Z)(Yee(this.measures));try{for(a.s();!(e=a.n()).done;){var i,o=e.value,u=(0,Zt.Z)(Yee(this.measures[o]));try{for(u.s();!(i=u.n()).done;){var s,c=i.value,l=(0,Zt.Z)(this.measures[o][c]);try{for(l.s();!(s=l.n()).done;){var f=s.value;r.push(f),t.push(c),n.push("*"===o?null:ote(o))}}catch(d){l.e(d)}finally{l.f()}}}catch(d){u.e(d)}finally{u.f()}}}catch(d){a.e(d)}finally{a.f()}return{type:"aggregate",groupby:(0,ln.Z)(this.dimensions).map(ote),ops:t,fields:n,as:r}}}],[{key:"makeFromEncoding",value:function(e,t){var r=!1;t.forEachFieldDef((function(e){e.aggregate&&(r=!0)}));var a={},i=new Set;return r?(t.forEachFieldDef((function(e,n){var r,o,u,s,c=e.aggregate,l=e.field;if(c)if("count"===c)a["*"]=null!==(r=a["*"])&&void 0!==r?r:{},a["*"].count=new Set([Noe(e,{forAs:!0})]);else{if(Kte(c)||$te(c)){var f=Kte(c)?"argmin":"argmax",d=c[f];a[d]=null!==(o=a[d])&&void 0!==o?o:{},a[d][f]=new Set([Noe({op:f,field:d},{forAs:!0})])}else a[l]=null!==(u=a[l])&&void 0!==u?u:{},a[l][c]=new Set([Noe(e,{forAs:!0})]);pre(n)&&"unaggregated"===t.scaleDomain(n)&&(a[l]=null!==(s=a[l])&&void 0!==s?s:{},a[l].min=new Set([Noe({field:l,aggregate:"min"},{forAs:!0})]),a[l].max=new Set([Noe({field:l,aggregate:"max"},{forAs:!0})]))}else Khe(i,n,e,t)})),i.size+Yee(a).length===0?null:new n(e,i,a)):null}},{key:"makeFromTransform",value:function(e,t){var r,a,i,o,u=new Set,s={},c=(0,Zt.Z)(t.aggregate);try{for(c.s();!(o=c.n()).done;){var l=o.value,f=l.op,d=l.field,h=l.as;f&&("count"===f?(s["*"]=null!==(r=s["*"])&&void 0!==r?r:{},s["*"].count=new Set([h||Noe(l,{forAs:!0})])):(s[d]=null!==(a=s[d])&&void 0!==a?a:{},s[d][f]=new Set([h||Noe(l,{forAs:!0})])))}}catch(m){c.e(m)}finally{c.f()}var p,v=(0,Zt.Z)(null!==(i=t.groupby)&&void 0!==i?i:[]);try{for(v.s();!(p=v.n()).done;){var g=p.value;u.add(g)}}catch(m){v.e(m)}finally{v.f()}return u.size+Yee(s).length===0?null:new n(e,u,s)}}]),n}(ole),Qhe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r,a,i){var o;(0,Jh.Z)(this,n),(o=t.call(this,e)).model=r,o.name=a,o.data=i;var u,s=(0,Zt.Z)(Vne);try{for(s.s();!(u=s.n()).done;){var c=u.value,l=r.facet[c];if(l){var f=l.bin,d=l.sort;o[c]=Object.assign({name:r.getName("".concat(c,"_domain")),fields:[Noe(l)].concat((0,ln.Z)(xre(f)?[Noe(l,{binSuffix:"end"})]:[]))},aoe(d)?{sortField:d}:uee(d)?{sortIndexField:Vde(l,c)}:{})}}}catch(h){s.e(h)}finally{s.f()}return o.childModel=r.child,o}return(0,ep.Z)(n,[{key:"hash",value:function(){var e,t="Facet",n=(0,Zt.Z)(Vne);try{for(n.s();!(e=n.n()).done;){var r=e.value;this[r]&&(t+=" ".concat(r.charAt(0),":").concat(zee(this[r])))}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"fields",get:function(){var e,t,n=[],r=(0,Zt.Z)(Vne);try{for(r.s();!(t=r.n()).done;){var a=t.value;(null===(e=this[a])||void 0===e?void 0:e.fields)&&n.push.apply(n,(0,ln.Z)(this[a].fields))}}catch(i){r.e(i)}finally{r.f()}return n}},{key:"dependentFields",value:function(){var e,t=new Set(this.fields),n=(0,Zt.Z)(Vne);try{for(n.s();!(e=n.n()).done;){var r=e.value;this[r]&&(this[r].sortField&&t.add(this[r].sortField.field),this[r].sortIndexField&&t.add(this[r].sortIndexField))}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"producedFields",value:function(){return new Set}},{key:"getSource",value:function(){return this.name}},{key:"getChildIndependentFieldsWithStep",value:function(){var e,t={},n=(0,Zt.Z)(ire);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=this.childModel.component.scales[r];if(a&&!a.merged){var i=a.get("type"),o=a.get("range");if(wie(i)&&Eae(o)){var u=Bpe(zpe(this.childModel,r));u?t[r]=u:oae("Unknown field for ".concat(r,". Cannot calculate view size."))}}}}catch(s){n.e(s)}finally{n.f()}return t}},{key:"assembleRowColumnHeaderData",value:function(e,t,n){var r={row:"y",column:"x"}[e],a=[],i=[],o=[];n&&n[r]&&(t?(a.push("distinct_".concat(n[r])),i.push("max")):(a.push(n[r]),i.push("distinct")),o.push("distinct_".concat(n[r])));var u=this[e],s=u.sortField,c=u.sortIndexField;if(s){var l=s.op,f=void 0===l?eoe:l,d=s.field;a.push(d),i.push(f),o.push(Noe(s,{forAs:!0}))}else c&&(a.push(c),i.push("max"),o.push(c));return{name:this[e].name,source:null!==t&&void 0!==t?t:this.data,transform:[Object.assign({type:"aggregate",groupby:this[e].fields},a.length?{fields:a,ops:i,as:o}:{})]}}},{key:"assembleFacetHeaderData",value:function(e){var t,n,r,a=this.model.layout.columns,i=this.model.component.layoutHeaders,o=[],u={},s=(0,Zt.Z)(Xde);try{for(s.s();!(r=s.n()).done;){var c,l=r.value,f=(0,Zt.Z)(Yde);try{for(f.s();!(c=f.n()).done;){var d,h=c.value,p=null!==(t=i[l]&&i[l][h])&&void 0!==t?t:[],v=(0,Zt.Z)(p);try{for(v.s();!(d=v.n()).done;){if((null===(n=d.value.axes)||void 0===n?void 0:n.length)>0){u[l]=!0;break}}}catch(x){v.e(x)}finally{v.f()}}}catch(x){f.e(x)}finally{f.f()}if(u[l]){var g='length(data("'.concat(this.facet.name,'"))'),m="row"===l?a?{signal:"ceil(".concat(g," / ").concat(a,")")}:1:a?{signal:"min(".concat(g,", ").concat(a,")")}:{signal:g};o.push({name:"".concat(this.facet.name,"_").concat(l),transform:[{type:"sequence",start:0,stop:m}]})}}}catch(x){s.e(x)}finally{s.f()}var y=u.row,b=u.column;return(y||b)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,e)),o}},{key:"assemble",value:function(){var e,t,n=[],r=null,a=this.getChildIndependentFieldsWithStep(),i=this.column,o=this.row,u=this.facet;if(i&&o&&(a.x||a.y)){r="cross_".concat(this.column.name,"_").concat(this.row.name);var s=[].concat(null!==(e=a.x)&&void 0!==e?e:[],null!==(t=a.y)&&void 0!==t?t:[]),c=s.map((function(){return"distinct"}));n.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:s,ops:c}]})}for(var l=0,f=[ane,rne];l<f.length;l++){var d=f[l];this[d]&&n.push(this.assembleRowColumnHeaderData(d,r,a))}if(u){var h=this.assembleFacetHeaderData(a);h&&n.push.apply(n,(0,ln.Z)(h))}return n}}]),n}(ole);function Jhe(e){return"'"===e[0]&&"'"===e[e.length-1]||'"'===e[0]&&'"'===e[e.length-1]?e.slice(1,-1):e}function epe(e,t){var n=rte(e);if("number"===t)return"toNumber(".concat(n,")");if("boolean"===t)return"toBoolean(".concat(n,")");if("string"===t)return"toString(".concat(n,")");if("date"===t)return"toDate(".concat(n,")");if("flatten"===t)return n;if(0===t.indexOf("date:")){var r=Jhe(t.slice(5,t.length));return"timeParse(".concat(n,",'").concat(r,"')")}if(0===t.indexOf("utc:")){var a=Jhe(t.slice(4,t.length));return"utcParse(".concat(n,",'").concat(a,"')")}return oae('Unrecognized parse "'.concat(t,'".')),null}function tpe(e){var t={};return Fee(e.filter,(function(e){var n;if(Pae(e)){var r=null;Iae(e)?r=e.equal:Bae(e)?r=e.range[0]:zae(e)&&(r=(null!==(n=e.oneOf)&&void 0!==n?n:e.in)[0]),r&&(uae(r)?t[e.field]="date":mee(r)?t[e.field]="number":yee(r)&&(t[e.field]="string")),e.timeUnit&&(t[e.field]="date")}})),t}function npe(e){var t={};function n(e){var n;Xoe(e)?t[e.field]="date":"quantitative"===e.type&&(yee(n=e.aggregate)&&Pee(["min","max"],n))?t[e.field]="number":cte(e.field)>1?e.field in t||(t[e.field]="flatten"):Coe(e)&&aoe(e.sort)&&cte(e.sort.field)>1&&(e.sort.field in t||(t[e.sort.field]="flatten"))}if((ave(e)||ive(e))&&e.forEachFieldDef((function(t,r){if(woe(t))n(t);else{var a=Qne(r),i=e.fieldDef(a);n(Object.assign(Object.assign({},t),{type:i.type}))}})),ave(e)){var r=e.mark,a=e.markDef,i=e.encoding;if(Bte(r)&&!e.encoding.order){var o=i["horizontal"===a.orient?"y":"x"];goe(o)&&"quantitative"===o.type&&!(o.field in t)&&(t[o.field]="number")}}return t}var rpe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a;return(0,Jh.Z)(this,n),(a=t.call(this,e))._parse=r,a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Oee(this._parse))}},{key:"hash",value:function(){return"Parse ".concat(zee(this._parse))}},{key:"parse",get:function(){return this._parse}},{key:"merge",value:function(e){this._parse=Object.assign(Object.assign({},this._parse),e.parse),e.remove()}},{key:"assembleFormatParse",value:function(){var e,t={},n=(0,Zt.Z)(Yee(this._parse));try{for(n.s();!(e=n.n()).done;){var r=e.value,a=this._parse[r];1===cte(r)&&(t[r]=a)}}catch(i){n.e(i)}finally{n.f()}return t}},{key:"producedFields",value:function(){return new Set(Yee(this._parse))}},{key:"dependentFields",value:function(){return new Set(Yee(this._parse))}},{key:"assembleTransforms",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Yee(this._parse).filter((function(e){return!t||cte(e)>1})).map((function(t){var n=epe(t,e._parse[t]);return n?{type:"formula",expr:n,as:ste(t)}:null})).filter((function(e){return null!==e}))}}],[{key:"makeExplicit",value:function(e,t,n){var r={},a=t.data;return!uce(a)&&a&&a.format&&a.format.parse&&(r=a.format.parse),this.makeWithAncestors(e,r,{},n)}},{key:"makeWithAncestors",value:function(e,t,r,a){var i,o=(0,Zt.Z)(Yee(r));try{for(o.s();!(i=o.n()).done;){var u=i.value,s=a.getWithExplicit(u);void 0!==s.value&&(s.explicit||s.value===r[u]||"derived"===s.value||"flatten"===r[u]?delete r[u]:oae(Rre(u,r[u],s.value)))}}catch(b){o.e(b)}finally{o.f()}var c,l=(0,Zt.Z)(Yee(t));try{for(l.s();!(c=l.n()).done;){var f=c.value,d=a.get(f);void 0!==d&&(d===t[f]?delete t[f]:oae(Rre(f,t[f],d)))}}catch(b){l.e(b)}finally{l.f()}var h=new $se(t,r);a.copyAll(h);var p,v={},g=(0,Zt.Z)(Yee(h.combine()));try{for(g.s();!(p=g.n()).done;){var m=p.value,y=h.get(m);null!==y&&(v[m]=y)}}catch(b){g.e(b)}finally{g.f()}return 0===Yee(v).length||a.parseNothing?null:new n(e,v)}}]),n}(ole),ape=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e){return(0,Jh.Z)(this,n),t.call(this,e)}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null)}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set([Hue])}},{key:"hash",value:function(){return"Identifier"}},{key:"assemble",value:function(){return{type:"identifier",as:Hue}}}]),n}(ole),ipe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a;return(0,Jh.Z)(this,n),(a=t.call(this,e)).transform=r,a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Oee(this.transform))}},{key:"addDimensions",value:function(e){this.transform.groupby=Vee(this.transform.groupby.concat(e),(function(e){return e}))}},{key:"dependentFields",value:function(){var e=new Set;return this.transform.groupby&&this.transform.groupby.forEach(e.add,e),this.transform.joinaggregate.map((function(e){return e.field})).filter((function(e){return void 0!==e})).forEach(e.add,e),e}},{key:"producedFields",value:function(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}},{key:"getDefaultName",value:function(e){var t;return null!==(t=e.as)&&void 0!==t?t:Noe(e)}},{key:"hash",value:function(){return"JoinAggregateTransform ".concat(zee(this.transform))}},{key:"assemble",value:function(){var e,t=[],n=[],r=[],a=(0,Zt.Z)(this.transform.joinaggregate);try{for(a.s();!(e=a.n()).done;){var i=e.value;n.push(i.op),r.push(this.getDefaultName(i)),t.push(void 0===i.field?null:i.field)}}catch(u){a.e(u)}finally{a.f()}var o=this.transform.groupby;return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},void 0!==o?{groupby:o}:{})}}]),n}(ole);var ope=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a;return(0,Jh.Z)(this,n),(a=t.call(this,e))._stack=r,a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Oee(this._stack))}},{key:"stack",get:function(){return this._stack}},{key:"addDimensions",value:function(e){var t;(t=this._stack.facetby).push.apply(t,(0,ln.Z)(e))}},{key:"dependentFields",value:function(){var e=new Set;return e.add(this._stack.stackField),this.getGroupbyFields().forEach(e.add,e),this._stack.facetby.forEach(e.add,e),this._stack.sort.field.forEach(e.add,e),e}},{key:"producedFields",value:function(){return new Set(this._stack.as)}},{key:"hash",value:function(){return"Stack ".concat(zee(this._stack))}},{key:"getGroupbyFields",value:function(){var e=this._stack,t=e.dimensionFieldDef,n=e.impute,r=e.groupby;return t?t.bin?n?[Noe(t,{binSuffix:"mid"})]:[Noe(t,{}),Noe(t,{binSuffix:"end"})]:[Noe(t)]:null!==r&&void 0!==r?r:[]}},{key:"assemble",value:function(){var e=[],t=this._stack,n=t.facetby,r=t.dimensionFieldDef,a=t.stackField,i=t.stackby,o=t.sort,u=t.offset,s=t.impute,c=t.as;if(s&&r){var l=r.band,f=void 0===l?.5:l;r.bin&&e.push({type:"formula",expr:"".concat(f,"*")+Noe(r,{expr:"datum"})+"+".concat(1-f,"*")+Noe(r,{expr:"datum",binSuffix:"end"}),as:Noe(r,{binSuffix:"mid",forAs:!0})}),e.push({type:"impute",field:a,groupby:[].concat((0,ln.Z)(i),(0,ln.Z)(n)),key:Noe(r,{binSuffix:"mid"}),method:"value",value:0})}return e.push({type:"stack",groupby:[].concat((0,ln.Z)(this.getGroupbyFields()),(0,ln.Z)(n)),field:a,sort:o,as:c,offset:u}),e}}],[{key:"makeFromTransform",value:function(e,t){var r=t.stack,a=t.groupby,i=t.as,o=t.offset,u=void 0===o?"zero":o,s=[],c=[];if(void 0!==t.sort){var l,f=(0,Zt.Z)(t.sort);try{for(f.s();!(l=f.n()).done;){var d=l.value;s.push(d.field),c.push(lte(d.order,"ascending"))}}catch(v){f.e(v)}finally{f.f()}}var h,p={field:s,order:c};return h=function(e){return uee(e)&&e.every((function(e){return yee(e)}))&&e.length>1}(i)?i:yee(i)?[i,i+"_end"]:[t.stack+"_start",t.stack+"_end"],new n(e,{stackField:r,groupby:a,offset:u,sort:p,facetby:[],as:h})}},{key:"makeFromEncoding",value:function(e,t){var r=t.stack,a=t.encoding;if(!r)return null;var i,o=r.groupbyChannel,u=r.fieldChannel,s=r.offset,c=r.impute;o&&(i=joe(a[o]));var l,f=function(e){return e.stack.stackBy.reduce((function(e,t){var n=Noe(t.fieldDef);return n&&e.push(n),e}),[])}(t),d=t.encoding.order;return l=uee(d)||goe(d)?sue(d):f.reduce((function(e,t){return e.field.push(t),e.order.push("y"===u?"descending":"ascending"),e}),{field:[],order:[]}),new n(e,{dimensionFieldDef:i,stackField:t.vgField(u),facetby:[],stackby:f,sort:l,offset:s,impute:c,as:[t.vgField(u,{suffix:"start",forAs:!0}),t.vgField(u,{suffix:"end",forAs:!0})]})}}]),n}(ole),upe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a;return(0,Jh.Z)(this,n),(a=t.call(this,e)).transform=r,a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Oee(this.transform))}},{key:"addDimensions",value:function(e){this.transform.groupby=Vee(this.transform.groupby.concat(e),(function(e){return e}))}},{key:"dependentFields",value:function(){var e,t,n=new Set;return(null!==(e=this.transform.groupby)&&void 0!==e?e:[]).forEach(n.add,n),(null!==(t=this.transform.sort)&&void 0!==t?t:[]).forEach((function(e){return n.add(e.field)})),this.transform.window.map((function(e){return e.field})).filter((function(e){return void 0!==e})).forEach(n.add,n),n}},{key:"producedFields",value:function(){return new Set(this.transform.window.map(this.getDefaultName))}},{key:"getDefaultName",value:function(e){var t;return null!==(t=e.as)&&void 0!==t?t:Noe(e)}},{key:"hash",value:function(){return"WindowTransform ".concat(zee(this.transform))}},{key:"assemble",value:function(){var e,t,n=[],r=[],a=[],i=[],o=(0,Zt.Z)(this.transform.window);try{for(o.s();!(t=o.n()).done;){var u=t.value;r.push(u.op),a.push(this.getDefaultName(u)),i.push(void 0===u.param?null:u.param),n.push(void 0===u.field?null:u.field)}}catch(m){o.e(m)}finally{o.f()}var s=this.transform.frame,c=this.transform.groupby;if(s&&null===s[0]&&null===s[1]&&r.every((function(e){return Qte(e)})))return Object.assign({type:"joinaggregate",as:a,ops:r,fields:n},void 0!==c?{groupby:c}:{});var l=[],f=[];if(void 0!==this.transform.sort){var d,h=(0,Zt.Z)(this.transform.sort);try{for(h.s();!(d=h.n()).done;){var p=d.value;l.push(p.field),f.push(null!==(e=p.order)&&void 0!==e?e:"ascending")}}catch(m){h.e(m)}finally{h.f()}}var v={field:l,order:f},g=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:i,as:a,ops:r,fields:n,sort:v},void 0!==g?{ignorePeers:g}:{}),void 0!==c?{groupby:c}:{}),void 0!==s?{frame:s}:{})}}]),n}(ole),spe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(){return(0,Jh.Z)(this,n),t.apply(this,arguments)}return(0,ep.Z)(n,[{key:"run",value:function(e){var t=e.parent;if(e instanceof rpe){if(qhe(t))return this.flags;if(t.numChildren()>1)return this.setContinue(),this.flags;if(t instanceof rpe)this.setMutated(),t.merge(e);else{if(Hee(t.producedFields(),e.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),e.swapWithParent()}}return this.setContinue(),this.flags}}]),n}(Xhe),cpe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(){return(0,Jh.Z)(this,n),t.apply(this,arguments)}return(0,ep.Z)(n,[{key:"mergeNodes",value:function(e,t){var n,r=t.shift(),a=(0,Zt.Z)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;e.removeChild(i),i.parent=r,i.remove()}}catch(o){a.e(o)}finally{a.f()}}},{key:"run",value:function(e){for(var t=e.children.map((function(e){return e.hash()})),n={},r=0;r<t.length;r++)void 0===n[t[r]]?n[t[r]]=[e.children[r]]:n[t[r]].push(e.children[r]);var a,i=(0,Zt.Z)(Yee(n));try{for(i.s();!(a=i.n()).done;){var o=a.value;n[o].length>1&&(this.setMutated(),this.mergeNodes(e,n[o]))}}catch(l){i.e(l)}finally{i.f()}var u,s=(0,Zt.Z)(e.children);try{for(s.s();!(u=s.n()).done;){var c=u.value;this.run(c)}}catch(l){s.e(l)}finally{s.f()}return this.mutatedFlag}}]),n}(Yhe),lpe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(){return(0,Jh.Z)(this,n),t.apply(this,arguments)}return(0,ep.Z)(n,[{key:"run",value:function(e){return e instanceof ule||e.numChildren()>0||e instanceof Qhe||(this.setMutated(),e.remove()),this.flags}}]),n}(Xhe),fpe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(){var e;return(0,Jh.Z)(this,n),(e=t.apply(this,arguments)).fields=new Set,e.prev=null,e}return(0,ep.Z)(n,[{key:"run",value:function(e){if(this.setContinue(),e instanceof sle){var t=e.producedFields();Gee(t,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set([].concat((0,ln.Z)(this.fields),(0,ln.Z)(t))),this.prev=e}return this.flags}},{key:"reset",value:function(){this.fields.clear()}}]),n}(Xhe),dpe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(){return(0,Jh.Z)(this,n),t.apply(this,arguments)}return(0,ep.Z)(n,[{key:"run",value:function(e){this.setContinue();var t,n=e.parent.children.filter((function(e){return e instanceof sle})),r=n.pop(),a=(0,Zt.Z)(n);try{for(a.s();!(t=a.n()).done;){var i=t.value;this.setMutated(),r.merge(i)}}catch(o){a.e(o)}finally{a.f()}return this.flags}}]),n}(Xhe);function hpe(e){if(e instanceof Qhe)if(1!==e.numChildren()||e.children[0]instanceof ule){var t=e.model.component.data.main;ppe(t);var n,r=(u=e,function e(t){if(!(t instanceof Qhe)){var n=t.clone();if(n instanceof ule){var r=kpe+n.getSource();n.setSource(r),u.model.component.data.outputNodes[r]=n}else(n instanceof $he||n instanceof ope||n instanceof upe||n instanceof ipe)&&n.addDimensions(u.fields);var a,i=(0,Zt.Z)(t.children.flatMap(e));try{for(i.s();!(a=i.n()).done;)a.value.parent=n}catch(o){i.e(o)}finally{i.f()}return[n]}return t.children.flatMap(e)}),a=e.children.map(r).flat(),i=(0,Zt.Z)(a);try{for(i.s();!(n=i.n()).done;){n.value.parent=t}}catch(s){i.e(s)}finally{i.f()}}else{var o=e.children[0];(o instanceof $he||o instanceof ope||o instanceof upe||o instanceof ipe)&&o.addDimensions(e.fields),o.swapWithParent(),hpe(e)}else e.children.map(hpe);var u}function ppe(e){if(e instanceof ule&&e.type===fce&&1===e.numChildren()){var t=e.children[0];t instanceof Qhe||(t.swapWithParent(),ppe(e))}}var vpe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(){return(0,Jh.Z)(this,n),t.call(this)}return(0,ep.Z)(n,[{key:"run",value:function(e){e instanceof ule&&!e.isRequired()&&(this.setMutated(),e.remove());var t,n=(0,Zt.Z)(e.children);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.run(r)}}catch(a){n.e(a)}finally{n.f()}return this.mutatedFlag}}]),n}(Yhe),gpe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e){var r;return(0,Jh.Z)(this,n),(r=t.call(this)).requiresSelectionId=e&&Kle(e),r}return(0,ep.Z)(n,[{key:"run",value:function(e){e instanceof ape&&(this.requiresSelectionId&&(qhe(e.parent)||e.parent instanceof $he||e.parent instanceof rpe)||(this.setMutated(),e.remove()));var t,n=(0,Zt.Z)(e.children);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.run(r)}}catch(a){n.e(a)}finally{n.f()}return this.mutatedFlag}}]),n}(Yhe),mpe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(){return(0,Jh.Z)(this,n),t.apply(this,arguments)}return(0,ep.Z)(n,[{key:"run",value:function(e){var t=e.parent,n=(0,ln.Z)(t.children),r=t.children.filter((function(e){return e instanceof rpe}));if(t.numChildren()>1&&r.length>=1){var a,i={},o=new Set,u=(0,Zt.Z)(r);try{for(u.s();!(a=u.n()).done;){var s,c=a.value.parse,l=(0,Zt.Z)(Yee(c));try{for(l.s();!(s=l.n()).done;){var f=s.value;f in i?i[f]!==c[f]&&o.add(f):i[f]=c[f]}}catch(k){l.e(k)}finally{l.f()}}}catch(k){u.e(k)}finally{u.f()}var d,h=(0,Zt.Z)(o);try{for(h.s();!(d=h.n()).done;){delete i[d.value]}}catch(k){h.e(k)}finally{h.f()}if(!Xee(i)){this.setMutated();var p,v=new rpe(t,i),g=(0,Zt.Z)(n);try{for(g.s();!(p=g.n()).done;){var m=p.value;if(m instanceof rpe){var y,b=(0,Zt.Z)(Yee(i));try{for(b.s();!(y=b.n()).done;){var x=y.value;delete m.parse[x]}}catch(k){b.e(k)}finally{b.f()}}t.removeChild(m),m.parent=v,m instanceof rpe&&0===Yee(m.parse).length&&m.remove()}}catch(k){g.e(k)}finally{g.f()}}}return this.setContinue(),this.flags}}]),n}(Xhe),ype=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(){return(0,Jh.Z)(this,n),t.apply(this,arguments)}return(0,ep.Z)(n,[{key:"run",value:function(e){var t,n=e.parent,r=n.children.filter((function(e){return e instanceof $he})),a={},i=(0,Zt.Z)(r);try{for(i.s();!(t=i.n()).done;){var o=t.value,u=zee(o.groupBy);u in a||(a[u]=[]),a[u].push(o)}}catch(v){i.e(v)}finally{i.f()}var s,c=(0,Zt.Z)(Yee(a));try{for(c.s();!(s=c.n()).done;){var l=a[s.value];if(l.length>1){var f,d=l.pop(),h=(0,Zt.Z)(l);try{for(h.s();!(f=h.n()).done;){var p=f.value;d.merge(p)&&(n.removeChild(p),p.parent=d,p.remove(),this.setMutated())}}catch(v){h.e(v)}finally{h.f()}}}}catch(v){c.e(v)}finally{c.f()}return this.setContinue(),this.flags}}]),n}(Xhe),bpe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e){var r;return(0,Jh.Z)(this,n),(r=t.call(this)).model=e,r}return(0,ep.Z)(n,[{key:"run",value:function(e){var t,n=e.parent,r=!(qhe(n)||n instanceof wde||n instanceof rpe||n instanceof ape),a=[],i=[],o=(0,Zt.Z)(n.children);try{for(o.s();!(t=o.n()).done;){var u=t.value;u instanceof jhe&&(r&&!Hee(n.producedFields(),u.dependentFields())?a.push(u):i.push(u))}}catch(g){o.e(g)}finally{o.f()}if(a.length>0){var s,c=a.pop(),l=(0,Zt.Z)(a);try{for(l.s();!(s=l.n()).done;){var f=s.value;c.merge(f,this.model.renameSignal.bind(this.model))}}catch(g){l.e(g)}finally{l.f()}this.setMutated(),n instanceof jhe?n.merge(c,this.model.renameSignal.bind(this.model)):c.swapWithParent()}if(i.length>1){var d,h=i.pop(),p=(0,Zt.Z)(i);try{for(p.s();!(d=p.n()).done;){var v=d.value;h.merge(v,this.model.renameSignal.bind(this.model))}}catch(g){p.e(g)}finally{p.f()}this.setMutated()}return this.setContinue(),this.flags}}]),n}(Xhe),xpe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(){return(0,Jh.Z)(this,n),t.apply(this,arguments)}return(0,ep.Z)(n,[{key:"run",value:function(e){var t=e.parent,n=(0,ln.Z)(t.children),r=jee(n,(function(e){return e instanceof ule}));if(!r||t.numChildren()<=1)return this.setContinue(),this.flags;var a,i,o=[],u=(0,Zt.Z)(n);try{for(u.s();!(i=u.n()).done;){var s=i.value;if(s instanceof ule){for(var c=s;1===c.numChildren();){var l=c.children[0];if(!(l instanceof ule))break;c=l}o.push.apply(o,(0,ln.Z)(c.children)),a?(t.removeChild(s),s.parent=a.parent,a.parent.removeChild(a),a.parent=c,this.setMutated()):a=c}else o.push(s)}}catch(p){u.e(p)}finally{u.f()}if(o.length){this.setMutated();var f,d=(0,Zt.Z)(o);try{for(d.s();!(f=d.n()).done;){var h=f.value;h.parent.removeChild(h),h.parent=a}}catch(p){d.e(p)}finally{d.f()}}return this.setContinue(),this.flags}}]),n}(Xhe),kpe="scale_";function wpe(e){var t=[];function n(e){if(0===e.numChildren())t.push(e);else{var r,a=(0,Zt.Z)(e.children);try{for(a.s();!(r=a.n()).done;){n(r.value)}}catch(i){a.e(i)}finally{a.f()}}}var r,a=(0,Zt.Z)(e);try{for(a.s();!(r=a.n()).done;){n(r.value)}}catch(i){a.e(i)}finally{a.f()}return t}function _pe(e){return e}function Cpe(e,t){return t.map((function(t){if(e instanceof Xhe){var n=e.optimizeNextFromLeaves(t);return e.reset(),n}return e.run(t)})).some(_pe)}function Spe(e,t){var n=e.sources,r=new Set;return r.add(Cpe(new vpe,n)),r.add(Cpe(new gpe(t),n)),n=n.filter((function(e){return e.numChildren()>0})),r.add(Cpe(new lpe,wpe(n))),n=n.filter((function(e){return e.numChildren()>0})),r.add(Cpe(new spe,wpe(n))),r.add(Cpe(new bpe(t),wpe(n))),r.add(Cpe(new fpe,wpe(n))),r.add(Cpe(new mpe,wpe(n))),r.add(Cpe(new ype,wpe(n))),r.add(Cpe(new dpe,wpe(n))),r.add(Cpe(new cpe,n)),r.add(Cpe(new xpe,wpe(n))),e.sources=n,r.has(!0)}function Ape(e,t){Whe(e.sources);for(var n=0,r=0,a=0;a<5&&Spe(e,t);a++)n++;e.sources.map(hpe);for(var i=0;i<5&&Spe(e,t);i++)r++;Whe(e.sources),5===Math.max(n,r)&&oae("Maximum optimization runs(".concat(5,") reached."))}var Epe=function(){function e(t){(0,Jh.Z)(this,e),Object.defineProperty(this,"signal",{enumerable:!0,get:t})}return(0,ep.Z)(e,null,[{key:"fromName",value:function(t,n){return new e((function(){return t(n)}))}}]),e}();function Tpe(e){ave(e)?function(e){var t,n=e.component.scales,r=(0,Zt.Z)(Yee(n));try{for(r.s();!(t=r.n()).done;){var a=t.value,i=Npe(e,a);if(n[a].setWithExplicit("domains",i),Mpe(e,a),e.component.data.isFaceted){for(var o=e;!ive(o)&&o.parent;)o=o.parent;if("shared"===o.component.resolve.scale[a]){var u,s=(0,Zt.Z)(i.value);try{for(s.s();!(u=s.n()).done;){var c=u.value;Tae(c)&&(c.data=kpe+c.data.replace(kpe,""))}}catch(l){s.e(l)}finally{s.f()}}}}}catch(l){r.e(l)}finally{r.f()}}(e):function(e){var t,n=(0,Zt.Z)(e.children);try{for(n.s();!(t=n.n()).done;){Tpe(t.value)}}catch(h){n.e(h)}finally{n.f()}var r,a=e.component.scales,i=(0,Zt.Z)(Yee(a));try{for(i.s();!(r=i.n()).done;){var o,u=r.value,s=void 0,c=null,l=(0,Zt.Z)(e.children);try{for(l.s();!(o=l.n()).done;){var f=o.value.component.scales[u];if(f){s=void 0===s?f.getWithExplicit("domains"):nce(s,f.getWithExplicit("domains"),"domains","scale",Rpe);var d=f.get("selectionExtent");c&&d&&c.selection!==d.selection&&oae("The same selection must be used to override scale domains in a layered view."),c=d}}}catch(h){l.e(h)}finally{l.f()}a[u].setWithExplicit("domains",s),c&&a[u].set("selectionExtent",c,!0)}}catch(h){i.e(h)}finally{i.f()}}(e)}function Npe(e,t){var n=e.getScaleComponent(t).get("type"),r=e.encoding,a=function(e,t,n,r){if("unaggregated"===e){var a=Ope(t,n),i=a.valid,o=a.reason;if(!i)return void oae(o)}else if(void 0===e&&r.useUnaggregatedDomain&&Ope(t,n).valid)return"unaggregated";return e}(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return a!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:a})),"x"===t&&Uoe(r.x2)?Uoe(r.x)?nce(Fpe(n,a,e,"x"),Fpe(n,a,e,"x2"),"domain","scale",Rpe):Fpe(n,a,e,"x2"):"y"===t&&Uoe(r.y2)?Uoe(r.y)?nce(Fpe(n,a,e,"y"),Fpe(n,a,e,"y2"),"domain","scale",Rpe):Fpe(n,a,e,"y2"):Fpe(n,a,e,t)}function Dpe(e,t,n){var r,a=null===(r=Cae(n))||void 0===r?void 0:r.unit;return"temporal"===t||a?function(e,t,n){return e.map((function(e){var r=Yoe(e,{timeUnit:n,type:t});return{signal:"{data: ".concat(r,"}")}}))}(e,t,a):[e]}function Fpe(e,t,n,r){var a=Uoe(n.encoding[r]),i=a.type,o=a.timeUnit;if(function(e){return e&&e.unionWith}(t)){var u=Fpe(e,void 0,n,r),s=Dpe(t.unionWith,i,o);return Qse([].concat((0,ln.Z)(u.value),(0,ln.Z)(s)))}if(Aae(t))return Qse([t]);if(t&&"unaggregated"!==t&&!Aie(t))return Qse(Dpe(t,i,o));var c=n.stack;if(c&&r===c.fieldChannel){if("normalize"===c.offset)return Jse([[0,1]]);var l=n.requestDataName(fce);return Jse([{data:l,field:n.vgField(r,{suffix:"start"})},{data:l,field:n.vgField(r,{suffix:"end"})}])}var f=pre(r)&&goe(a)?function(e,t,n){if(!wie(n))return;var r=e.fieldDef(t),a=r.sort;if(ioe(a))return{op:"min",field:Vde(r,t),order:"ascending"};var i=e.stack,o=i?[].concat((0,ln.Z)(i.groupbyField?[i.groupbyField]:[]),(0,ln.Z)(i.stackBy.map((function(e){return e.fieldDef.field})))):void 0;if(aoe(a))return Ipe(a,i&&!Pee(o,a.field));if(roe(a)){var u=a.encoding,s=a.order,c=e.fieldDef(u),l=c.aggregate,f=c.field,d=i&&!Pee(o,f);if(Kte(l)||$te(l))return Ipe({field:Noe(c),order:s},d);if(Qte(l)||!l)return Ipe({op:l,field:f,order:s},d)}else{if("descending"===a)return{op:"min",field:e.vgField(t),order:"descending"};if(Pee(["ascending",void 0],a))return!0}return}(n,r,e):void 0;if(yoe(a))return Jse(Dpe([a.datum],i,o));var d=a;if("unaggregated"===t){var h=n.requestDataName(fce),p=a.field;return Jse([{data:h,field:Noe({field:p,aggregate:"min"})},{data:h,field:Noe({field:p,aggregate:"max"})}])}if(xre(d.bin)){if(wie(e))return Jse("bin-ordinal"===e?[]:[{data:Qee(f)?n.requestDataName(fce):n.requestDataName(dce),field:n.vgField(r,$oe(d,r)?{binSuffix:"range"}:{}),sort:!0!==f&&see(f)?f:{field:n.vgField(r,{}),op:"min"}}]);var v=d.bin;if(xre(v)){var g=Lhe(n,d.field,v);return Jse([new Epe((function(){var e=n.getSignalName(g);return"[".concat(e,".start, ").concat(e,".stop]")}))])}return Jse([{data:n.requestDataName(fce),field:n.vgField(r,{})}])}if(d.timeUnit&&Pee(["time","utc"],e)&&doe(r,d,ave(n)?n.encoding[ere(r)]:void 0,n.stack,n.markDef,n.config)){var m=n.requestDataName(fce);return Jse([{data:m,field:n.vgField(r)},{data:m,field:n.vgField(r,{suffix:"end"})}])}return Jse(f?[{data:Qee(f)?n.requestDataName(fce):n.requestDataName(dce),field:n.vgField(r),sort:f}]:[{data:n.requestDataName(fce),field:n.vgField(r)}])}function Ipe(e,t){var n=e.op,r=e.field,a=e.order;return Object.assign(Object.assign({op:null!==n&&void 0!==n?n:t?"sum":eoe},r?{field:ote(r)}:{}),a?{order:a}:{})}function Mpe(e,t){var n,r=e.component.scales[t],a=e.specifiedScales[t].domain,i=null===(n=e.fieldDef(t))||void 0===n?void 0:n.bin,o=Aie(a)&&a,u=wre(i)&&_re(i.extent)&&i.extent;(o||u)&&r.set("selectionExtent",null!==o&&void 0!==o?o:u,!0)}function Ope(e,t){var n=e.aggregate,r=e.type;return n?yee(n)&&!nne[n]?{valid:!1,reason:Gre(n)}:"quantitative"===r&&"log"===t?{valid:!1,reason:qre(e)}:{valid:!0}:{valid:!1,reason:Vre(e)}}function Rpe(e,t,n,r){return e.explicit&&t.explicit&&oae(function(e,t,n,r){return"Conflicting ".concat(t.toString(),' property "').concat(e.toString(),'" (').concat(Bee(n)," and ").concat(Bee(r),"). Using the union of the two domains.")}(n,r,e.value,t.value)),{explicit:e.explicit,value:[].concat((0,ln.Z)(e.value),(0,ln.Z)(t.value))}}function Zpe(e){var t=Vee(e.map((function(e){if(Tae(e)){e.sort;return kee(e,["sort"])}return e})),zee),n=Vee(e.map((function(e){if(Tae(e)){var t=e.sort;return void 0===t||Qee(t)||("op"in t&&"count"===t.op&&delete t.field,"ascending"===t.order&&delete t.order),t}})).filter((function(e){return void 0!==e})),zee);if(0!==t.length){if(1===t.length){var r=e[0];if(Tae(r)&&n.length>0){var a=n[0];if(n.length>1)oae(Yre),a=!0;else if(see(a)&&"field"in a){var i=a.field;r.field===i&&(a=!a.order||{order:a.order})}return Object.assign(Object.assign({},r),{sort:a})}return r}var o,u=Vee(n.map((function(e){return Qee(e)||!("op"in e)||e.op in Yte?e:(oae(function(e){return"Dropping sort property ".concat(Bee(e),' as unioned domains only support boolean or op "count", "min", and "max".')}(e)),!0)})),zee);1===u.length?o=u[0]:u.length>1&&(oae(Yre),o=!0);var s=Vee(e.map((function(e){return Tae(e)?e.data:null})),(function(e){return e}));return 1===s.length&&null!==s[0]?Object.assign({data:s[0],fields:t.map((function(e){return e.field}))},o?{sort:o}:{}):Object.assign({fields:t},o?{sort:o}:{})}}function Bpe(e){if(Tae(e)&&yee(e.field))return e.field;if(function(e){return!uee(e)&&"fields"in e&&!("data"in e)}(e)){var t,n,r=(0,Zt.Z)(e.fields);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(Tae(a)&&yee(a.field))if(t){if(t!==a.field)return oae("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),t}else t=a.field}}catch(o){r.e(o)}finally{r.f()}return oae("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),t}if(function(e){return!uee(e)&&"fields"in e&&"data"in e}(e)){oae("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");var i=e.fields[0];return yee(i)?i:void 0}}function zpe(e,t){var n=e.component.scales[t].get("domains").map((function(t){return Tae(t)&&(t.data=e.lookupDataSource(t.data)),t}));return Zpe(n)}function Lpe(e){return uve(e)||ove(e)?e.children.reduce((function(e,t){return e.concat(Lpe(t))}),Ppe(e)):Ppe(e)}function Ppe(e){return Yee(e.component.scales).reduce((function(t,n){var r=e.component.scales[n];if(r.merged)return t;var a,i=r.combine(),o=i.name,u=i.type,s=i.selectionExtent,c=(i.domains,i.range,i.reverse),l=kee(i,["name","type","selectionExtent","domains","range","reverse"]),f=function(e,t,n){if(ore(n)&&Eae(e))return{step:{signal:t+"_step"}};return e}(i.range,o,n);s&&(a=function(e,t){var n=t.selection;return{signal:Cde(e.getSelectionComponent(n,Jee(n)),t)}}(e,s));var d=zpe(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:u},d?{domain:d}:{}),a?{domainRaw:a}:{}),{range:f}),void 0!==c?{reverse:c}:{}),l)),t}),[])}var jpe=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a;return(0,Jh.Z)(this,n),(a=t.call(this,{},{name:e})).merged=!1,a.setWithExplicit("type",r),a}return(0,ep.Z)(n,[{key:"domainDefinitelyIncludesZero",value:function(){return!1!==this.get("zero")||jee(this.get("domains"),(function(e){return uee(e)&&2===e.length&&e[0]<=0&&e[1]>=0}))}}]),n}($se),Upe=["range","scheme"];function Wpe(e){return"x"===e?"width":"y"===e?"height":void 0}function Vpe(e,t){var n=e.fieldDef(t);if(n&&n.bin&&xre(n.bin)){var r=Lhe(e,n.field,n.bin),a=Wpe(t),i=e.getName(a);return new Epe((function(){var t=e.getSignalName(r),n="(".concat(t,".stop - ").concat(t,".start) / ").concat(t,".step");return"".concat(e.getSignalName(i)," / (").concat(n,")")}))}}function Gpe(e,t){var n,r=t.specifiedScales[e],a=t.size,i=t.getScaleComponent(e).get("type"),o=(0,Zt.Z)(Upe);try{for(o.s();!(n=o.n()).done;){var u=n.value;if(void 0!==r[u]){var s=Die(i,u),c=Fie(e,u);if(s)if(c)oae(c);else switch(u){case"range":return uee(r.range)&&ore(e)?Qse(r.range.map((function(e){if("width"===e||"height"===e){var n=t.getName(e),r=t.getSignalName.bind(t);return Epe.fromName(r,n)}return e}))):Qse(r.range);case"scheme":return Qse(qpe(r[u]))}else oae(Hre(i,u,e))}}}catch(d){o.e(d)}finally{o.f()}if(e===one||e===une){var l=e===one?"width":"height",f=a[l];if(ese(f)){if(wie(i))return Qse({step:f.step});oae(Xre(l))}}return Jse(function(e,t){var n=t.size,r=t.config,a=t.mark,i=t.encoding,o=t.getSignalName.bind(t),u=Uoe(i[e]),s=u.type,c=t.getScaleComponent(e),l=c.get("type"),f=t.specifiedScales[e],d=f.domain,h=f.domainMid;switch(e){case one:case une:if(Pee(["point","band"],l))if(e!==one||n.width){if(e===une&&!n.height){var p=ise(r.view,"height");if(ese(p))return p}}else{var v=ise(r.view,"width");if(ese(v))return v}var g=Wpe(e),m=t.getName(g);return e===une&&_ie(l)?[Epe.fromName(o,m),0]:[0,Epe.fromName(o,m)];case wne:var y=Hpe(a,t.component.scales[e].get("zero"),r),b=function(e,t,n,r){var a={x:Vpe(n,"x"),y:Vpe(n,"y")};switch(e){case"bar":case"tick":if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;var i=Ype(t,a,r.view);return mee(i)?i-1:new Epe((function(){return"".concat(i.signal," - 1")}));case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":if(r.scale.maxSize)return r.scale.maxSize;var o=Ype(t,a,r.view);return mee(o)?Math.pow(Xpe*o,2):new Epe((function(){return"pow(".concat(Xpe," * ").concat(o.signal,", 2)")}))}throw new Error(jre("size",e))}(a,n,t,r);return Sie(l)?function(e,t,n){var r=function(){var r=nue(t),a=nue(e),i="(".concat(r," - ").concat(a,") / (").concat(n," - 1)");return"sequence(".concat(a,", ").concat(r," + ").concat(i,", ").concat(i,")")};return Aae(t)?new Epe(r):{signal:r()}}(y,b,function(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&uee(n)?n.length+1:(oae(function(e){return"Domain for ".concat(e," is required for threshold scale.")}(r)),3)}}(l,r,d,e)):[y,b];case dne:return[0,2*Math.PI];case _ne:return[0,360];case lne:return[0,new Epe((function(){var e=t.getSignalName("width"),n=t.getSignalName("height");return"min(".concat(e,",").concat(n,")/2")}))];case Ene:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case Tne:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case kne:return"symbol";case yne:case bne:case xne:return"ordinal"===l?"nominal"===s?"category":"ordinal":void 0!==h?"diverging":"rect"===a||"geoshape"===a?"heatmap":"ramp";case Cne:case Sne:case Ane:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error("Scale range undefined for channel ".concat(e))}(e,t))}function qpe(e){return function(e){return!yee(e)&&!!e.name}(e)?Object.assign({scheme:e.name},Zee(e,["name"])):{scheme:e}}function Hpe(e,t,n){if(t)return Aae(t)?{signal:"".concat(t.signal," ? 0 : ").concat(Hpe(e,!1,n))}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(jre("size",e))}var Xpe=.95;function Ype(e,t,n){var r=ese(e.width)?e.width.step:ase(n,"width"),a=ese(e.height)?e.height.step:ase(n,"height");return t.x||t.y?new Epe((function(){var e=[t.x?t.x.signal:r,t.y?t.y.signal:a];return"min(".concat(e.join(", "),")")})):Math.min(r,a)}function Kpe(e,t){ave(e)?function(e,t){var n,r=e.component.scales,a=e.config,i=e.encoding,o=e.markDef,u=e.specifiedScales,s=(0,Zt.Z)(Yee(r));try{for(s.s();!(n=s.n()).done;){var c=n.value,l=u[c],f=r[c],d=e.getScaleComponent(c),h=Uoe(i[c]),p=l[t],v=d.get("type"),g=d.get("padding"),m=d.get("paddingInner"),y=Die(v,t),b=Fie(c,t);if(void 0!==p&&(y?b&&oae(b):oae(Hre(v,t,c))),y&&void 0===b)if(void 0!==p)f.copyKeyFromObject(t,l);else{var x=t in $pe?$pe[t]({model:e,channel:c,fieldOrDatumDef:h,scaleType:v,scalePadding:g,scalePaddingInner:m,domain:l.domain,markDef:o,config:a}):a.scale[t];void 0!==x&&f.set(t,x,!1)}}}catch(k){s.e(k)}finally{s.f()}}(e,t):Jpe(e,t)}var $pe={bins:function(e){var t=e.model,n=e.fieldOrDatumDef;return goe(n)?function(e,t){var n=t.bin;if(xre(n)){var r=Lhe(e,t.field,n);return new Epe((function(){return e.getSignalName(r)}))}if(kre(n)&&wre(n)&&void 0!==n.step)return{step:n.step};return}(t,n):void 0},interpolate:function(e){return function(e,t){if(Pee([yne,bne,xne],e)&&"nominal"!==t)return"hcl";return}(e.channel,e.fieldOrDatumDef.type)},nice:function(e){return function(e,t,n){var r;if((null===(r=joe(n))||void 0===r?void 0:r.bin)||Pee([aie,iie],e))return;return t in are||void 0}(e.scaleType,e.channel,e.fieldOrDatumDef)},padding:function(e){var t=e.channel,n=e.scaleType,r=e.fieldOrDatumDef,a=e.markDef,i=e.config;return function(e,t,n,r,a,i){if(e in are){if(Cie(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;var o=a.type,u=a.orient;if("bar"===o&&(!goe(r)||!r.bin&&!r.timeUnit)&&("vertical"===u&&"x"===e||"horizontal"===u&&"y"===e))return i.continuousBandSize}if(t===cie)return n.pointPadding}return}(t,n,i.scale,r,a,i.bar)},paddingInner:function(e){var t=e.scalePadding,n=e.channel,r=e.markDef,a=e.config;return function(e,t,n,r){if(void 0!==e)return;if(t in are){var a=r.bandPaddingInner,i=r.barBandPaddingInner,o=r.rectBandPaddingInner;return lte(a,"bar"===n?i:o)}return}(t,n,r.type,a.scale)},paddingOuter:function(e){var t=e.scalePadding,n=e.channel,r=e.scaleType,a=e.markDef,i=e.scalePaddingInner,o=e.config;return function(e,t,n,r,a,i){if(void 0!==e)return;if(t in are){if(n===lie)return lte(i.bandPaddingOuter,Aae(a)?{signal:"".concat(a.signal,"/2")}:a/2)}return}(t,n,r,a.type,i,o.scale)},reverse:function(e){var t=e.fieldOrDatumDef,n=e.scaleType,r=e.channel,a=e.config;return function(e,t,n,r){if("x"===n&&void 0!==r.xReverse)return _ie(e)&&"descending"===t?Aae(r.xReverse)?{signal:"!".concat(r.xReverse.signal)}:!r.xReverse:r.xReverse;if(_ie(e)&&"descending"===t)return!0;return}(n,goe(t)?t.sort:void 0,r,a.scale)},zero:function(e){return function(e,t,n,r,a){if(n&&"unaggregated"!==n&&_ie(a)){if(uee(n)){var i=n[0],o=n[n.length-1];if(i<=0&&o>=0)return!0}return!1}if("size"===e&&"quantitative"===t.type&&!Sie(a))return!0;if((!goe(t)||!t.bin)&&Pee([].concat((0,ln.Z)(ire),(0,ln.Z)(sre)),e)){var u=r.orient;return!Pee(["bar","area","line","trail"],r.type)||!("horizontal"===u&&"y"===e||"vertical"===u&&"x"===e)}return!1}(e.channel,e.fieldOrDatumDef,e.domain,e.markDef,e.scaleType)}};function Qpe(e){ave(e)?function(e){var t,n=e.component.scales,r=(0,Zt.Z)(hre);try{for(r.s();!(t=r.n()).done;){var a=t.value,i=n[a];if(i){var o=Gpe(a,e);i.setWithExplicit("range",o)}}}catch(u){r.e(u)}finally{r.f()}}(e):Jpe(e,"range")}function Jpe(e,t){var n,r=e.component.scales,a=(0,Zt.Z)(e.children);try{for(a.s();!(n=a.n()).done;){var i=n.value;"range"===t?Qpe(i):Kpe(i,t)}}catch(h){a.e(h)}finally{a.f()}var o,u=(0,Zt.Z)(Yee(r));try{for(u.s();!(o=u.n()).done;){var s,c=o.value,l=void 0,f=(0,Zt.Z)(e.children);try{for(f.s();!(s=f.n()).done;){var d=s.value.component.scales[c];if(d)l=nce(l,d.getWithExplicit(t),t,"scale",ece((function(e,n){return"range"===t&&e.step&&n.step?e.step-n.step:0})))}}catch(h){f.e(h)}finally{f.f()}r[c].setWithExplicit(t,l)}}catch(h){u.e(h)}finally{u.f()}}function eve(e,t,n,r){var a=function(e,t,n){var r;switch(t.type){case"nominal":case"ordinal":if(Une(e)||"discrete"===yre(e))return"shape"===e&&"ordinal"===t.type&&oae(Wre(e,"ordinal")),"ordinal";if(e in are){if(Pee(["rect","bar","image","rule"],n))return"band"}else if("arc"===n&&e in ure)return"band";return void 0!==t.band||Soe(t)&&(null===(r=t.axis)||void 0===r?void 0:r.tickBand)?"band":"point";case"temporal":return Une(e)?"time":"discrete"===yre(e)?(oae(Wre(e,"temporal")),"ordinal"):goe(t)&&t.timeUnit&&Cae(t.timeUnit).utc?"utc":"time";case"quantitative":return Une(e)?goe(t)&&xre(t.bin)?"bin-ordinal":"linear":"discrete"===yre(e)?(oae(Wre(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(zre(t.type))}(t,n,r),i=e.type;return pre(t)?void 0!==i?Mie(t,i)?goe(n)&&!Iie(i,n.type)?(oae(function(e,t){return'FieldDef does not work with "'.concat(e,'" scale. We are using "').concat(t,'" scale instead.')}(i,a)),a):i:(oae(function(e,t,n){return'Channel "'.concat(e,'" does not work with "').concat(t,'" scale. We are using "').concat(n,'" scale instead.')}(t,i,a)),a):a:null}function tve(e){ave(e)?e.component.scales=function(e){var t=e.encoding,n=e.mark;return hre.reduce((function(r,a){var i=Uoe(t[a]);if(i&&n===Zte&&a===kne&&i.type===$ae)return r;var o=i&&i.scale;if(i&&null!==o&&!1!==o){var u=eve(o=null!==o&&void 0!==o?o:{},a,i,n);r[a]=new jpe(e.scaleName(a+"",!0),{value:u,explicit:o.type===u})}return r}),{})}(e):e.component.scales=function(e){var t,n,r=e.component.scales={},a={},i=e.component.resolve,o=(0,Zt.Z)(e.children);try{for(o.s();!(n=o.n()).done;){var u=n.value;tve(u);var s,c=(0,Zt.Z)(Yee(u.component.scales));try{for(c.s();!(s=c.n()).done;){var l=s.value;if(i.scale[l]=null!==(t=i.scale[l])&&void 0!==t?t:dhe(l,e),"shared"===i.scale[l]){var f=a[l],d=u.component.scales[l].getWithExplicit("type");f?hie(f.value,d.value)?a[l]=nce(f,d,"type","scale",nve):(i.scale[l]="independent",delete a[l]):a[l]=d}}}catch(w){c.e(w)}finally{c.f()}}}catch(w){o.e(w)}finally{o.f()}var h,p=(0,Zt.Z)(Yee(a));try{for(p.s();!(h=p.n()).done;){var v=h.value,g=e.scaleName(v,!0),m=a[v];r[v]=new jpe(g,m);var y,b=(0,Zt.Z)(e.children);try{for(b.s();!(y=b.n()).done;){var x=y.value,k=x.component.scales[v];k&&(x.renameScale(k.get("name"),g),k.merged=!0)}}catch(w){b.e(w)}finally{b.f()}}}catch(w){p.e(w)}finally{p.f()}return r}(e)}var nve=ece((function(e,t){return vie(e)-vie(t)}));var rve=function(){function e(){(0,Jh.Z)(this,e),this.nameMap={}}return(0,ep.Z)(e,[{key:"rename",value:function(e,t){this.nameMap[e]=t}},{key:"has",value:function(e){return void 0!==this.nameMap[e]}},{key:"get",value:function(e){for(;this.nameMap[e]&&e!==this.nameMap[e];)e=this.nameMap[e];return e}}]),e}();function ave(e){return"unit"===(null===e||void 0===e?void 0:e.type)}function ive(e){return"facet"===(null===e||void 0===e?void 0:e.type)}function ove(e){return"concat"===(null===e||void 0===e?void 0:e.type)}function uve(e){return"layer"===(null===e||void 0===e?void 0:e.type)}var sve=function(){function e(t,n,r,a,i,o,u){var s,c,l=this;(0,Jh.Z)(this,e),this.type=n,this.parent=r,this.config=i,this.view=u,this.children=[],this.correctDataNames=function(e){return e.from&&e.from.data&&(e.from.data=l.lookupDataSource(e.from.data)),e.from&&e.from.facet&&e.from.facet.data&&(e.from.facet.data=l.lookupDataSource(e.from.facet.data)),e},this.parent=r,this.config=i,this.name=null!==(s=t.name)&&void 0!==s?s:a,this.title=Joe(t.title)?{text:t.title}:t.title,this.scaleNameMap=r?r.scaleNameMap:new rve,this.projectionNameMap=r?r.projectionNameMap:new rve,this.signalNameMap=r?r.signalNameMap:new rve,this.data=t.data,this.description=t.description,this.transforms=function(e){return e.map((function(e){return hce(e)?{filter:Iee(e.filter,Gae)}:e}))}(null!==(c=t.transform)&&void 0!==c?c:[]),this.layout="layer"===n||"unit"===n?{}:function(e,t,n){var r,a,i=n[t],o={},u=i.spacing,s=i.columns;void 0!==u&&(o.spacing=u),void 0!==s&&(soe(e)&&!ooe(e.facet)||$ue(e))&&(o.columns=s),Que(e)&&(o.columns=1);var c,l=(0,Zt.Z)(nse);try{for(l.s();!(c=l.n()).done;){var f=c.value;if(void 0!==e[f])if("spacing"===f){var d=e[f];o[f]=mee(d)?d:{row:null!==(r=d.row)&&void 0!==r?r:u,column:null!==(a=d.column)&&void 0!==a?a:u}}else o[f]=e[f]}}catch(h){l.e(h)}finally{l.f()}return o}(t,n,i),this.component={data:{sources:r?r.component.data.sources:[],outputNodes:r?r.component.data.outputNodes:{},outputNodeRefCounts:r?r.component.data.outputNodeRefCounts:{},isFaceted:soe(t)||r&&r.component.data.isFaceted&&void 0===t.data},layoutSize:new $se,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?Oee(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}return(0,ep.Z)(e,[{key:"width",get:function(){return this.getSizeSignalRef("width")}},{key:"height",get:function(){return this.getSizeSignalRef("height")}},{key:"parse",value:function(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}},{key:"parseScale",value:function(){!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.ignoreRange;tve(e),Tpe(e);var r,a=(0,Zt.Z)(Nie);try{for(a.s();!(r=a.n()).done;){Kpe(e,r.value)}}catch(i){a.e(i)}finally{a.f()}n||Qpe(e)}(this)}},{key:"parseProjection",value:function(){Zhe(this)}},{key:"renameTopLevelLayoutSizeSignal",value:function(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}},{key:"parseLegends",value:function(){Ahe(this)}},{key:"assembleGroupStyle",value:function(){var e,t;if("unit"===this.type||"layer"===this.type)return null!==(t=null===(e=this.view)||void 0===e?void 0:e.style)&&void 0!==t?t:"cell"}},{key:"assembleEncodeFromView",value:function(e){e.style;var t,n=kee(e,["style"]),r={},a=(0,Zt.Z)(Yee(n));try{for(a.s();!(t=a.n()).done;){var i=t.value,o=n[i];void 0!==o&&(r[i]=eue(o))}}catch(u){a.e(u)}finally{a.f()}return r}},{key:"assembleGroupEncodeEntry",value:function(e){var t={};return this.view&&(t=this.assembleEncodeFromView(this.view)),e||(this.description&&(t.description=eue(this.description)),"unit"!==this.type&&"layer"!==this.type)?Xee(t)?void 0:t:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!==t&&void 0!==t?t:{})}},{key:"assembleLayout",value:function(){if(this.layout){var e=this.layout,t=e.spacing,n=kee(e,["spacing"]),r=this.component,a=this.config,i=function(e,t){var n,r={},a=(0,Zt.Z)(Vne);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=e[i];if(null===o||void 0===o?void 0:o.facetFieldDef){var u=Hde(["titleAnchor","titleOrient"],o.facetFieldDef,t,i),s=u.titleAnchor,c=Gde(i,u.titleOrient),l=ahe(s,c);void 0!==l&&(r[c]=l)}}}catch(f){a.e(f)}finally{a.f()}return Xee(r)?void 0:r}(r.layoutHeaders,a);return Object.assign(Object.assign(Object.assign({padding:t},this.assembleDefaultLayout()),n),i?{titleBand:i}:{})}}},{key:"assembleDefaultLayout",value:function(){return{}}},{key:"assembleHeaderMarks",value:function(){var e,t=this.component.layoutHeaders,n=[],r=(0,Zt.Z)(Vne);try{for(r.s();!(e=r.n()).done;){var a=e.value;t[a].title&&n.push(Kde(this,a))}}catch(s){r.e(s)}finally{r.f()}var i,o=(0,Zt.Z)(Xde);try{for(o.s();!(i=o.n()).done;){var u=i.value;n=n.concat(Jde(this,u))}}catch(s){o.e(s)}finally{o.f()}return n}},{key:"assembleAxes",value:function(){return function(e,t){var n=e.x,r=void 0===n?[]:n,a=e.y,i=void 0===a?[]:a;return[].concat((0,ln.Z)(r.map((function(e){return Tde(e,"grid",t)}))),(0,ln.Z)(i.map((function(e){return Tde(e,"grid",t)}))),(0,ln.Z)(r.map((function(e){return Tde(e,"main",t)}))),(0,ln.Z)(i.map((function(e){return Tde(e,"main",t)})))).filter((function(e){return e}))}(this.component.axes,this.config)}},{key:"assembleLegends",value:function(){return Fhe(this)}},{key:"assembleProjections",value:function(){return Ihe(this)}},{key:"assembleTitle",value:function(){var e,t,n,r=null!==(e=this.title)&&void 0!==e?e:{},a=r.encoding,i=kee(r,["encoding"]),o=Object.assign(Object.assign(Object.assign({},Qoe(this.config.title).nonMark),i),a?{encode:{update:a}}:{});if(o.text)return Pee(["unit","layer"],this.type)?Pee(["middle",void 0],o.anchor)&&(o.frame=null!==(t=o.frame)&&void 0!==t?t:"group"):o.anchor=null!==(n=o.anchor)&&void 0!==n?n:"start",Xee(o)?void 0:o}},{key:"assembleGroup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={};(e=e.concat(this.assembleSignals())).length>0&&(t.signals=e);var n=this.assembleLayout();n&&(t.layout=n),t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());var r=!this.parent||ive(this.parent)?Lpe(this):[];r.length>0&&(t.scales=r);var a=this.assembleAxes();a.length>0&&(t.axes=a);var i=this.assembleLegends();return i.length>0&&(t.legends=i),t}},{key:"getName",value:function(e){return Jee((this.name?this.name+"_":"")+e)}},{key:"requestDataName",value:function(e){var t,n=this.getName(e),r=this.component.data.outputNodeRefCounts;return r[n]=(null!==(t=r[n])&&void 0!==t?t:0)+1,n}},{key:"getSizeSignalRef",value:function(e){if(ive(this.parent)){var t=cre(lhe(e)),n=this.component.scales[t];if(n&&!n.merged){var r=n.get("type"),a=n.get("range");if(wie(r)&&Eae(a)){var i=n.get("name"),o=Bpe(zpe(this,t));return o?{signal:che(i,n,Noe({aggregate:"distinct",field:o},{expr:"datum"}))}:(oae("Unknown field for ".concat(t,". Cannot calculate view size.")),null)}}}return{signal:this.signalNameMap.get(this.getName(e))}}},{key:"lookupDataSource",value:function(e){var t=this.component.data.outputNodes[e];return t?t.getSource():e}},{key:"getSignalName",value:function(e){return this.signalNameMap.get(e)}},{key:"renameSignal",value:function(e,t){this.signalNameMap.rename(e,t)}},{key:"renameScale",value:function(e,t){this.scaleNameMap.rename(e,t)}},{key:"renameProjection",value:function(e,t){this.projectionNameMap.rename(e,t)}},{key:"scaleName",value:function(e,t){return t?this.getName(e):Yne(e)&&pre(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0}},{key:"projectionName",value:function(e){return e?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}},{key:"getScaleComponent",value:function(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");var t=this.component.scales[e];return t&&!t.merged?t:this.parent?this.parent.getScaleComponent(e):void 0}},{key:"getSelectionComponent",value:function(e,t){var n=this.component.selection[e];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(e,t)),!n)throw new Error('Cannot find a selection named "'.concat(t,'".'));return n}},{key:"hasAxisOrientSignalRef",value:function(){var e,t;return(null===(e=this.component.axes.x)||void 0===e?void 0:e.some((function(e){return e.hasOrientSignalRef()})))||(null===(t=this.component.axes.y)||void 0===t?void 0:t.some((function(e){return e.hasOrientSignalRef()})))}}]),e}(),cve=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(){return(0,Jh.Z)(this,n),t.apply(this,arguments)}return(0,ep.Z)(n,[{key:"vgField",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.fieldDef(e);if(n)return Noe(n,t)}},{key:"reduceFieldDef",value:function(e,t){return yue(this.getMapping(),(function(t,n,r){var a=joe(n);return a?e(t,a,r):t}),t)}},{key:"forEachFieldDef",value:function(e,t){mue(this.getMapping(),(function(t,n){var r=joe(t);r&&e(r,n)}),t)}}]),n}(sve),lve=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a,i,o,u;(0,Jh.Z)(this,n),(a=t.call(this,e)).transform=r,a.transform=Oee(r);var s=null!==(i=a.transform.as)&&void 0!==i?i:[void 0,void 0];return a.transform.as=[null!==(o=s[0])&&void 0!==o?o:"value",null!==(u=s[1])&&void 0!==u?u:"density"],a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Oee(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.density].concat((0,ln.Z)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"DensityTransform ".concat(zee(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.density,n=kee(e,["density"]);return Object.assign({type:"kde",field:t},n)}}]),n}(ole),fve=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a;return(0,Jh.Z)(this,n),(a=t.call(this,e)).filter=r,a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Object.assign({},this.filter))}},{key:"dependentFields",value:function(){return new Set(Yee(this.filter))}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"FilterInvalid ".concat(zee(this.filter))}},{key:"assemble",value:function(){var e=this,t=Yee(this.filter).reduce((function(t,n){var r=e.filter[n],a=Noe(r,{expr:"datum"});return null!==r&&("temporal"===r.type?t.push("(isDate(".concat(a,") || (isValid(").concat(a,") && isFinite(+").concat(a,")))")):"quantitative"===r.type&&(t.push("isValid(".concat(a,")")),t.push("isFinite(+".concat(a,")")))),t}),[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}],[{key:"make",value:function(e,t){var r=t.config,a=t.mark;if("filter"!==aue("invalid",t.markDef,r))return null;var i=t.reduceFieldDef((function(e,n,r){var i=pre(r)&&t.getScaleComponent(r);i&&(_ie(i.get("type"))&&"count"!==n.aggregate&&!Bte(a)&&(e[n.field]=n));return e}),{});return Yee(i).length?new n(e,i):null}}]),n}(ole),dve=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a;(0,Jh.Z)(this,n),(a=t.call(this,e)).transform=r,a.transform=Oee(r);var i=a.transform,o=i.flatten,u=i.as,s=void 0===u?[]:u;return a.transform.as=o.map((function(e,t){var n;return null!==(n=s[t])&&void 0!==n?n:e})),a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(this.parent,Oee(this.transform))}},{key:"dependentFields",value:function(){return new Set(this.transform.flatten)}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"FlattenTransform ".concat(zee(this.transform))}},{key:"assemble",value:function(){var e=this.transform;return{type:"flatten",fields:e.flatten,as:e.as}}}]),n}(ole),hve=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a,i,o,u;(0,Jh.Z)(this,n),(a=t.call(this,e)).transform=r,a.transform=Oee(r);var s=null!==(i=a.transform.as)&&void 0!==i?i:[void 0,void 0];return a.transform.as=[null!==(o=s[0])&&void 0!==o?o:"key",null!==(u=s[1])&&void 0!==u?u:"value"],a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Oee(this.transform))}},{key:"dependentFields",value:function(){return new Set(this.transform.fold)}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"FoldTransform ".concat(zee(this.transform))}},{key:"assemble",value:function(){var e=this.transform;return{type:"fold",fields:e.fold,as:e.as}}}]),n}(ole),pve=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r,a,i){var o;return(0,Jh.Z)(this,n),(o=t.call(this,e)).fields=r,o.geojson=a,o.signal=i,o}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Oee(this.fields),this.geojson,this.signal)}},{key:"dependentFields",value:function(){var e,t=(null!==(e=this.fields)&&void 0!==e?e:[]).filter(yee);return new Set([].concat((0,ln.Z)(this.geojson?[this.geojson]:[]),(0,ln.Z)(t)))}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"GeoJSON ".concat(this.geojson," ").concat(this.signal," ").concat(zee(this.fields))}},{key:"assemble",value:function(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}],[{key:"parseAll",value:function(e,t){if(t.component.projection&&!t.component.projection.isFit)return e;for(var r=0,a=0,i=[[vne,pne],[mne,gne]];a<i.length;a++){var o=i[a].map((function(e){var n=Uoe(t.encoding[e]);return goe(n)?n.field:yoe(n)?{expr:"".concat(n.datum)}:_oe(n)?{expr:"".concat(n.value)}:void 0}));(o[0]||o[1])&&(e=new n(e,o,null,t.getName("geojson_".concat(r++))))}if(t.channelHasField(kne)){var u=t.typedFieldDef(kne);u.type===$ae&&(e=new n(e,null,u.field,t.getName("geojson_".concat(r++))))}return e}}]),n}(ole),vve=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r,a,i){var o;return(0,Jh.Z)(this,n),(o=t.call(this,e)).projection=r,o.fields=a,o.as=i,o}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,this.projection,Oee(this.fields),Oee(this.as))}},{key:"dependentFields",value:function(){return new Set(this.fields.filter(yee))}},{key:"producedFields",value:function(){return new Set(this.as)}},{key:"hash",value:function(){return"Geopoint ".concat(this.projection," ").concat(zee(this.fields)," ").concat(zee(this.as))}},{key:"assemble",value:function(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}],[{key:"parseAll",value:function(e,t){if(!t.projectionName())return e;for(var r=0,a=[[vne,pne],[mne,gne]];r<a.length;r++){var i=a[r],o=i.map((function(e){var n=Uoe(t.encoding[e]);return goe(n)?n.field:yoe(n)?{expr:"".concat(n.datum)}:_oe(n)?{expr:"".concat(n.value)}:void 0})),u=i[0]===mne?"2":"";(o[0]||o[1])&&(e=new n(e,t.projectionName(),o,[t.getName("x"+u),t.getName("y"+u)]))}return e}}]),n}(ole),gve=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a;return(0,Jh.Z)(this,n),(a=t.call(this,e)).transform=r,a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Oee(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.impute,this.transform.key].concat((0,ln.Z)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set([this.transform.impute])}},{key:"processSequence",value:function(e){var t=e.start,n=void 0===t?0:t,r=e.stop,a=e.step,i=[n,r].concat((0,ln.Z)(a?[a]:[])).join(",");return{signal:"sequence(".concat(i,")")}}},{key:"hash",value:function(){return"Impute ".concat(zee(this.transform))}},{key:"assemble",value:function(){var e,t=this.transform,n=t.impute,r=t.key,a=t.keyvals,i=t.method,o=t.groupby,u=t.value,s=t.frame,c=void 0===s?[null,null]:s,l=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:n,key:r},a?{keyvals:(e=a,void 0!==(null===e||void 0===e?void 0:e.stop)?this.processSequence(a):a)}:{}),{method:"value"}),o?{groupby:o}:{}),{value:i&&"value"!==i?null:u});return i&&"value"!==i?[l,Object.assign({type:"window",as:["imputed_".concat(n,"_value")],ops:[i],fields:[n],frame:c,ignorePeers:!1},o?{groupby:o}:{}),{type:"formula",expr:"datum.".concat(n," === null ? datum.imputed_").concat(n,"_value : datum.").concat(n),as:n}]:[l]}}],[{key:"makeFromTransform",value:function(e,t){return new n(e,t)}},{key:"makeFromEncoding",value:function(e,t){var r=t.encoding,a=r.x,i=r.y;if(goe(a)&&goe(i)){var o=a.impute?a:i.impute?i:void 0;if(void 0===o)return;var u=a.impute?i:i.impute?a:void 0,s=o.impute,c=s.method,l=s.value,f=s.frame,d=s.keyvals,h=bue(t.mark,r);return new n(e,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:u.field},c?{method:c}:{}),void 0!==l?{value:l}:{}),f?{frame:f}:{}),void 0!==d?{keyvals:d}:{}),h.length?{groupby:h}:{}))}return null}}]),n}(ole),mve=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a,i,o,u;(0,Jh.Z)(this,n),(a=t.call(this,e)).transform=r,a.transform=Oee(r);var s=null!==(i=a.transform.as)&&void 0!==i?i:[void 0,void 0];return a.transform.as=[null!==(o=s[0])&&void 0!==o?o:r.on,null!==(u=s[1])&&void 0!==u?u:r.loess],a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Oee(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.loess,this.transform.on].concat((0,ln.Z)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"LoessTransform ".concat(zee(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.loess,n=e.on,r=kee(e,["loess","on"]);return Object.assign({type:"loess",x:n,y:t},r)}}]),n}(ole),yve=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r,a){var i;return(0,Jh.Z)(this,n),(i=t.call(this,e)).transform=r,i.secondary=a,i}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Oee(this.transform),this.secondary)}},{key:"dependentFields",value:function(){return new Set([this.transform.lookup])}},{key:"producedFields",value:function(){return new Set(this.transform.as?hee(this.transform.as):this.transform.from.fields)}},{key:"hash",value:function(){return"Lookup ".concat(zee({transform:this.transform,secondary:this.secondary}))}},{key:"assemble",value:function(){var e;if(this.transform.from.fields)e=Object.assign({values:this.transform.from.fields},this.transform.as?{as:hee(this.transform.as)}:{});else{var t=this.transform.as;yee(t)||(oae('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),t="_lookup"),e={as:[t]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},e),this.transform.default?{default:this.transform.default}:{})}}],[{key:"make",value:function(e,t,r,a){var i=t.component.data.sources,o=r.from,u=null;if(function(e){return"data"in e}(o)){var s=Rve(o.data,i);s||(s=new Uhe(o.data),i.push(s));var c=t.getName("lookup_".concat(a));u=new ule(s,c,"lookup",t.component.data.outputNodeRefCounts),t.component.data.outputNodes[c]=u}else if(function(e){return"selection"in e}(o)){var l=o.selection;if(r=Object.assign({as:l},r),!(u=t.getSelectionComponent(Jee(l),l).materialized))throw new Error('Cannot define and lookup the "'.concat(l,'" selection in the same view. ')+"Try moving the lookup into a second, layered view?")}return new n(e,r,u.getSource())}}]),n}(ole),bve=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a,i,o,u;(0,Jh.Z)(this,n),(a=t.call(this,e)).transform=r,a.transform=Oee(r);var s=null!==(i=a.transform.as)&&void 0!==i?i:[void 0,void 0];return a.transform.as=[null!==(o=s[0])&&void 0!==o?o:"prob",null!==(u=s[1])&&void 0!==u?u:"value"],a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Oee(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.quantile].concat((0,ln.Z)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"QuantileTransform ".concat(zee(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.quantile,n=kee(e,["quantile"]);return Object.assign({type:"quantile",field:t},n)}}]),n}(ole),xve=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a,i,o,u;(0,Jh.Z)(this,n),(a=t.call(this,e)).transform=r,a.transform=Oee(r);var s=null!==(i=a.transform.as)&&void 0!==i?i:[void 0,void 0];return a.transform.as=[null!==(o=s[0])&&void 0!==o?o:r.on,null!==(u=s[1])&&void 0!==u?u:r.regression],a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Oee(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.regression,this.transform.on].concat((0,ln.Z)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"RegressionTransform ".concat(zee(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.regression,n=e.on,r=kee(e,["regression","on"]);return Object.assign({type:"regression",x:n,y:t},r)}}]),n}(ole),kve=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a;return(0,Jh.Z)(this,n),(a=t.call(this,e)).transform=r,a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Oee(this.transform))}},{key:"addDimensions",value:function(e){var t;this.transform.groupby=Vee((null!==(t=this.transform.groupby)&&void 0!==t?t:[]).concat(e),(function(e){return e}))}},{key:"producedFields",value:function(){}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.pivot,this.transform.value].concat((0,ln.Z)(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"hash",value:function(){return"PivotTransform ".concat(zee(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.pivot,n=e.value,r=e.groupby,a=e.limit,i=e.op;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},void 0!==a?{limit:a}:{}),void 0!==i?{op:i}:{}),void 0!==r?{groupby:r}:{})}}]),n}(ole),wve=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r){var a;return(0,Jh.Z)(this,n),(a=t.call(this,e)).transform=r,a}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(null,Oee(this.transform))}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"SampleTransform ".concat(zee(this.transform))}},{key:"assemble",value:function(){return{type:"sample",size:this.transform.sample}}}]),n}(ole);function _ve(e){var t=0;return function n(r,a){var i,o,u;if(r instanceof Uhe&&(r.isGenerator||ace(r.data)||(e.push(a),a={name:null,source:a.name,transform:[]})),r instanceof rpe&&(r.parent instanceof Uhe&&!a.source?(a.format=Object.assign(Object.assign({},null!==(i=a.format)&&void 0!==i?i:{}),{parse:r.assembleFormatParse()}),(o=a.transform).push.apply(o,(0,ln.Z)(r.assembleTransforms(!0)))):(u=a.transform).push.apply(u,(0,ln.Z)(r.assembleTransforms()))),r instanceof Qhe){a.name||(a.name="data_".concat(t++)),!a.source||a.transform.length>0?(e.push(a),r.data=a.name):r.data=a.source;var s,c=(0,Zt.Z)(r.assemble());try{for(c.s();!(s=c.n()).done;){var l=s.value;e.push(l)}}catch(v){c.e(v)}finally{c.f()}}else{var f;if((r instanceof Vhe||r instanceof Ghe||r instanceof fve||r instanceof wde||r instanceof Wde||r instanceof vve||r instanceof pve||r instanceof $he||r instanceof yve||r instanceof upe||r instanceof ipe||r instanceof hve||r instanceof dve||r instanceof lve||r instanceof mve||r instanceof bve||r instanceof xve||r instanceof ape||r instanceof wve||r instanceof kve)&&a.transform.push(r.assemble()),r instanceof jhe||r instanceof sle||r instanceof gve||r instanceof ope)(f=a.transform).push.apply(f,(0,ln.Z)(r.assemble()));if(r instanceof ule)if(a.source&&0===a.transform.length)r.setSource(a.source);else if(r.parent instanceof ule)r.setSource(a.name);else{if(a.name||(a.name="data_".concat(t++)),r.setSource(a.name),1===r.numChildren())e.push(a),a={name:null,source:a.name,transform:[]}}switch(r.numChildren()){case 0:r instanceof ule&&(!a.source||a.transform.length>0)&&e.push(a);break;case 1:n(r.children[0],a);break;default:a.name||(a.name="data_".concat(t++));var d=a.name;!a.source||a.transform.length>0?e.push(a):d=a.source;var h,p=(0,Zt.Z)(r.children);try{for(p.s();!(h=p.n()).done;){n(h.value,{name:null,source:d,transform:[]})}}catch(v){p.e(v)}finally{p.f()}}}}}function Cve(e,t){var n,r,a,i=[],o=_ve(i),u=0,s=(0,Zt.Z)(e.sources);try{for(s.s();!(a=s.n()).done;){var c=a.value;c.hasName()||(c.dataName="source_".concat(u++));var l=c.assemble();o(c,l)}}catch(N){s.e(N)}finally{s.f()}for(var f=0,d=i;f<d.length;f++){var h=d[f];0===h.transform.length&&delete h.transform}var p,v=0,g=(0,Zt.Z)(i.entries());try{for(g.s();!(p=g.n()).done;){var m=(0,ku.Z)(p.value,2),y=m[0],b=m[1];0!==(null!==(n=b.transform)&&void 0!==n?n:[]).length||b.source||i.splice(v++,0,i.splice(y,1)[0])}}catch(N){g.e(N)}finally{g.f()}for(var x=0,k=i;x<k.length;x++){var w,_=k[x],C=(0,Zt.Z)(null!==(r=_.transform)&&void 0!==r?r:[]);try{for(C.s();!(w=C.n()).done;){var S=w.value;"lookup"===S.type&&(S.from=e.outputNodes[S.from].getSource())}}catch(N){C.e(N)}finally{C.f()}}for(var A=0,E=i;A<E.length;A++){var T=E[A];T.name in t&&(T.values=t[T.name])}return i}function Sve(e){return"top"===e||"left"===e||Aae(e)?"header":"footer"}function Ave(e,t){var n,r=e.facet,a=e.config,i=e.child,o=e.component;if(e.channelHasField(t)){var u=r[t],s=qde("title",null,a,t),c=Boe(u,a,{allowDisabling:!0,includeDefault:void 0===s||!!s});i.component.layoutHeaders[t].title&&(c=uee(c)?c.join(", "):c,c+=" / "+i.component.layoutHeaders[t].title,i.component.layoutHeaders[t].title=null);var l=qde("labelOrient",u,a,t),f=lte((null!==(n=u.header)&&void 0!==n?n:{}).labels,a.header.labels,!0),d=Pee(["bottom","right"],l)?"footer":"header";o.layoutHeaders[t]=(0,qn.Z)({title:c,facetFieldDef:u},d,"facet"===t?[]:[Eve(e,t,f)])}}function Eve(e,t,n){var r="row"===t?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function Tve(e,t){var n,r=e.child;if(r.component.axes[t]){var a=e.component,i=a.layoutHeaders,o=a.resolve;if(o.axis[t]=hhe(o,t),"shared"===o.axis[t]){var u,s="x"===t?"column":"row",c=i[s],l=(0,Zt.Z)(r.component.axes[t]);try{for(l.s();!(u=l.n()).done;){var f=u.value,d=Sve(f.get("orient"));c[d]=null!==(n=c[d])&&void 0!==n?n:[Eve(e,s,!1)];var h=Tde(f,"main",e.config,{header:!0});h&&c[d][0].axes.push(h),f.mainExtracted=!0}}catch(p){l.e(p)}finally{l.f()}}}}function Nve(e){Dve(e);var t=1===e.layout.columns?"width":"childWidth",n=void 0===e.layout.columns?"height":"childHeight";Fve(e,t),Fve(e,n)}function Dve(e){var t,n=(0,Zt.Z)(e.children);try{for(n.s();!(t=n.n()).done;){t.value.parseLayoutSize()}}catch(r){n.e(r)}finally{n.f()}}function Fve(e,t){var n,r,a=lhe(t),i=cre(a),o=e.component.resolve,u=e.component.layoutSize,s=(0,Zt.Z)(e.children);try{for(s.s();!(r=s.n()).done;){var c=r.value.component.layoutSize.getWithExplicit(a),l=o.scale[i];if("independent"===l&&"step"===c.value){n=void 0;break}if(n){if("independent"===l&&n.value!==c.value){n=void 0;break}n=nce(n,c,a,"")}else n=c}}catch(p){s.e(p)}finally{s.f()}if(n){var f,d=(0,Zt.Z)(e.children);try{for(d.s();!(f=d.n()).done;){var h=f.value;e.renameSignal(h.getName(a),e.getName(t)),h.component.layoutSize.set(a,"merged",!1)}}catch(p){d.e(p)}finally{d.f()}u.setWithExplicit(t,n)}else u.setWithExplicit(t,{explicit:!1,value:void 0})}function Ive(e,t){var n="width"===t?"x":"y",r=e.config,a=e.getScaleComponent(n);if(a){var i=a.get("type"),o=a.get("range");if(wie(i)){var u=ise(r.view,t);return Eae(o)||ese(u)?"step":u}return rse(r.view,t)}if(e.hasProjection||"arc"===e.mark)return rse(r.view,t);var s=ise(r.view,t);return ese(s)?s.step:s}function Mve(e,t,n){return Noe(t,Object.assign({suffix:"by_".concat(Noe(e))},null!==n&&void 0!==n?n:{}))}var Ove=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r,a,i){var o;return(0,Jh.Z)(this,n),(o=t.call(this,e,"facet",r,a,i,e.resolve)).child=dge(e.spec,(0,Sx.Z)(o),o.getName("child"),void 0,i),o.children=[o.child],o.facet=o.initFacet(e.facet,i),o}return(0,ep.Z)(n,[{key:"initFacet",value:function(e,t){return ooe(e)?yue(e,(function(e,n,r){return Pee([rne,ane],r)?void 0===n.field?(oae(Pre(n,r)),e):(e[r]=Woe(n,r,t),e):(oae(jre(r,"facet")),e)}),{}):{facet:Woe(e,"facet",t)}}},{key:"channelHasField",value:function(e){return!!this.facet[e]}},{key:"fieldDef",value:function(e){return this.facet[e]}},{key:"parseData",value:function(){this.component.data=Bve(this),this.child.parseData()}},{key:"parseLayoutSize",value:function(){Dve(this)}},{key:"parseSelections",value:function(){this.child.parseSelections(),this.component.selection=this.child.component.selection}},{key:"parseMarkGroup",value:function(){this.child.parseMarkGroup()}},{key:"parseAxesAndHeaders",value:function(){this.child.parseAxesAndHeaders(),function(e){var t,n=(0,Zt.Z)(Vne);try{for(n.s();!(t=n.n()).done;)Ave(e,t.value)}catch(r){n.e(r)}finally{n.f()}Tve(e,"x"),Tve(e,"y")}(this)}},{key:"assembleSelectionTopLevelSignals",value:function(e){return this.child.assembleSelectionTopLevelSignals(e)}},{key:"assembleSignals",value:function(){return this.child.assembleSignals(),[]}},{key:"assembleSelectionData",value:function(e){return this.child.assembleSelectionData(e)}},{key:"getHeaderLayoutMixins",value:function(){var e,t,n,r,a={},i=(0,Zt.Z)(Vne);try{for(i.s();!(r=i.n()).done;){var o,u=r.value,s=(0,Zt.Z)(Yde);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=this.component.layoutHeaders[u],f=l[c],d=l.facetFieldDef;if(d){var h=qde("titleOrient",d,this.config,u);if(Pee(["right","bottom"],h)){var p=Gde(u,h);a.titleAnchor=null!==(e=a.titleAnchor)&&void 0!==e?e:{},a.titleAnchor[p]="end"}}if(null===f||void 0===f?void 0:f[0]){var v="row"===u?"height":"width",g="header"===c?"headerBand":"footerBand";"facet"===u||this.child.component.layoutSize.get(v)||(a[g]=null!==(t=a[g])&&void 0!==t?t:{},a[g][u]=.5),l.title&&(a.offset=null!==(n=a.offset)&&void 0!==n?n:{},a.offset["row"===u?"rowTitle":"columnTitle"]=10)}}}catch(m){s.e(m)}finally{s.f()}}}catch(m){i.e(m)}finally{i.f()}return a}},{key:"assembleDefaultLayout",value:function(){var e=this.facet,t=e.column,n=e.row,r=t?this.columnDistinctSignal():n?1:void 0,a="all";return(n||"independent"!==this.component.resolve.scale.x)&&(t||"independent"!==this.component.resolve.scale.y)||(a="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:a})}},{key:"assembleLayoutSignals",value:function(){return this.child.assembleLayoutSignals()}},{key:"columnDistinctSignal",value:function(){if(!(this.parent&&this.parent instanceof n)){var e=this.getName("column_domain");return{signal:"length(data('".concat(e,"'))")}}}},{key:"assembleGroup",value:function(e){return this.parent&&this.parent instanceof n?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Noe(this.facet.column,{prefix:"distinct"})}}}}:{}),(0,Ax.Z)((0,Ex.Z)(n.prototype),"assembleGroup",this).call(this,e)):(0,Ax.Z)((0,Ex.Z)(n.prototype),"assembleGroup",this).call(this,e)}},{key:"getCardinalityAggregateForChild",value:function(){var e=[],t=[],r=[];if(this.child instanceof n){if(this.child.channelHasField("column")){var a=Noe(this.child.facet.column);e.push(a),t.push("distinct"),r.push("distinct_".concat(a))}}else{var i,o=(0,Zt.Z)(ire);try{for(o.s();!(i=o.n()).done;){var u=i.value,s=this.child.component.scales[u];if(s&&!s.merged){var c=s.get("type"),l=s.get("range");if(wie(c)&&Eae(l)){var f=Bpe(zpe(this.child,u));f?(e.push(f),t.push("distinct"),r.push("distinct_".concat(f))):oae("Unknown field for ".concat(u,". Cannot calculate view size."))}}}}catch(d){o.e(d)}finally{o.f()}}return{fields:e,ops:t,as:r}}},{key:"assembleFacet",value:function(){var e,t=this.component.data.facetRoot,n=t.name,r=t.data,a=this.facet,i=a.row,o=a.column,u=this.getCardinalityAggregateForChild(),s=u.fields,c=u.ops,l=u.as,f=[],d=(0,Zt.Z)(Vne);try{for(d.s();!(e=d.n()).done;){var h=e.value,p=this.facet[h];if(p){f.push(Noe(p));var v=p.bin,g=p.sort;if(xre(v)&&f.push(Noe(p,{binSuffix:"end"})),aoe(g)){var m=g.field,y=g.op,b=void 0===y?eoe:y,x=Mve(p,g);i&&o?(s.push(x),c.push("max"),l.push(x)):(s.push(m),c.push(b),l.push(x))}else if(uee(g)){var k=Vde(p,h);s.push(k),c.push("max"),l.push(k)}}}}catch(_){d.e(_)}finally{d.f()}var w=!!i&&!!o;return Object.assign({name:n,data:r,groupby:f},w||s.length>0?{aggregate:Object.assign(Object.assign({},w?{cross:w}:{}),s.length?{fields:s,ops:c,as:l}:{})}:{})}},{key:"facetSortFields",value:function(e){var t=this.facet[e];return t?aoe(t.sort)?[Mve(t,t.sort,{expr:"datum"})]:uee(t.sort)?[Vde(t,e,{expr:"datum"})]:[Noe(t,{expr:"datum"})]:[]}},{key:"facetSortOrder",value:function(e){var t=this.facet[e];if(t){var n=t.sort;return[(aoe(n)?n.order:!uee(n)&&n)||"ascending"]}return[]}},{key:"assembleLabelTitle",value:function(){var e=this.facet,t=this.config;if(e.facet)return the(e.facet,"facet",t);var n,r={row:["top","bottom"],column:["left","right"]},a=(0,Zt.Z)(Xde);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(e[i]){var o=qde("labelOrient",e[i],t,i);if(Pee(r[i],o))return the(e[i],i,t)}}}catch(u){a.e(u)}finally{a.f()}}},{key:"assembleMarks",value:function(){var e=this,t=this.child,n=function(e){var t,n=[],r=_ve(n),a=(0,Zt.Z)(e.children);try{for(a.s();!(t=a.n()).done;)r(t.value,{source:e.name,name:null,transform:[]})}catch(i){a.e(i)}finally{a.f()}return n}(this.component.data.facetRoot),r=t.assembleGroupEncodeEntry(!1),a=this.assembleLabelTitle()||t.assembleTitle(),i=t.assembleGroupStyle(),o=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},a?{title:a}:{}),i?{style:i}:{}),{from:{facet:this.assembleFacet()},sort:{field:Vne.map((function(t){return e.facetSortFields(t)})).flat(),order:Vne.map((function(t){return e.facetSortOrder(t)})).flat()}}),n.length>0?{data:n}:{}),r?{encode:{update:r}}:{}),t.assembleGroup(function(e,t){if(e.component.selection&&Yee(e.component.selection).length){var n=bee(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:q9("mousemove","scope"),update:"isTuple(facet) ? facet : group(".concat(n,").datum")}]})}return Ole(t)}(this,[])));return[o]}},{key:"getMapping",value:function(){return this.facet}}]),n}(cve);function Rve(e,t){var n,r,a,i,o,u,s,c,l,f,d,h=(0,Zt.Z)(t);try{for(h.s();!(d=h.n()).done;){var p=d.value,v=p.data;if((!e.name||!p.hasName()||e.name===p.dataName)&&((!(null===(n=e.format)||void 0===n?void 0:n.mesh)||!(null===(r=v.format)||void 0===r?void 0:r.feature))&&(!(null===(a=e.format)||void 0===a?void 0:a.feature)&&!(null===(i=v.format)||void 0===i?void 0:i.feature)||(null===(o=e.format)||void 0===o?void 0:o.feature)===(null===(u=v.format)||void 0===u?void 0:u.feature))&&(!(null===(s=e.format)||void 0===s?void 0:s.mesh)&&!(null===(c=v.format)||void 0===c?void 0:c.mesh)||(null===(l=e.format)||void 0===l?void 0:l.mesh)===(null===(f=v.format)||void 0===f?void 0:f.mesh))))if(ice(e)&&ice(v)){if(Mee(e.values,v.values))return p}else if(ace(e)&&ace(v)){if(e.url===v.url)return p}else if(oce(e)&&e.name===p.dataName)return p}}catch(g){h.e(g)}finally{h.f()}return null}function Zve(e,t){if(e.data||!e.parent){if(null===e.data){var n=new Uhe({values:[]});return t.push(n),n}var r=Rve(e.data,t);if(r)return uce(e.data)||(r.data.format=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];Wee(e,null!==o&&void 0!==o?o:{})}return e}({},e.data.format,r.data.format)),!r.hasName()&&e.data.name&&(r.dataName=e.data.name),r;var a=new Uhe(e.data);return t.push(a),a}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}function Bve(e){var t,n,r,a,i,o,u,s,c,l,f=Zve(e,e.component.data.sources),d=e.component.data,h=d.outputNodes,p=d.outputNodeRefCounts,v=e.parent?e.parent.component.data.ancestorParse.clone():new rce,g=e.data;uce(g)?(sce(g)?f=new Ghe(f,g.sequence):lce(g)&&(f=new Vhe(f,g.graticule)),v.parseNothing=!0):null===(null===(t=null===g||void 0===g?void 0:g.format)||void 0===t?void 0:t.parse)&&(v.parseNothing=!0),f=null!==(n=rpe.makeExplicit(f,e,v))&&void 0!==n?n:f,f=new ape(f);var m=e.parent&&uve(e.parent);(ave(e)||ive(e))&&m&&(f=null!==(r=jhe.makeFromEncoding(f,e))&&void 0!==r?r:f),e.transforms.length>0&&(f=function(e,t,n){var r,a,i,o=0,u=(0,Zt.Z)(t.transforms);try{for(u.s();!(i=u.n()).done;){var s=i.value,c=void 0,l=void 0;if(Cce(s))l=e=new Wde(e,s),c="derived";else if(hce(s)){var f=tpe(s);l=e=null!==(r=rpe.makeWithAncestors(e,{},f,n))&&void 0!==r?r:e,e=new wde(e,t,s.filter)}else if(Sce(s))l=e=jhe.makeFromTransform(e,s,t),c="number";else if(Ece(s))c="date",void 0===n.getWithExplicit(s.field).value&&(e=new rpe(e,(0,qn.Z)({},s.field,c)),n.set(s.field,c,!1)),l=e=sle.makeFromTransform(e,s);else if(Tce(s))l=e=$he.makeFromTransform(e,s),c="number",Kle(t)&&(e=new ape(e));else if(pce(s))l=e=yve.make(e,t,s,o++),c="derived";else if(kce(s))l=e=new upe(e,s),c="number";else if(wce(s))l=e=new ipe(e,s),c="number";else if(Nce(s))l=e=ope.makeFromTransform(e,s),c="derived";else if(Dce(s))l=e=new hve(e,s),c="derived";else if(_ce(s))l=e=new dve(e,s),c="derived";else if(vce(s))l=e=new kve(e,s),c="derived";else if(xce(s))e=new wve(e,s);else if(Ace(s))l=e=gve.makeFromTransform(e,s),c="derived";else if(gce(s))l=e=new lve(e,s),c="derived";else if(mce(s))l=e=new bve(e,s),c="derived";else if(yce(s))l=e=new xve(e,s),c="derived";else{if(!bce(s)){oae(Zre(s));continue}l=e=new mve(e,s),c="derived"}if(l&&void 0!==c){var d,h=(0,Zt.Z)(null!==(a=l.producedFields())&&void 0!==a?a:[]);try{for(h.s();!(d=h.n()).done;){var p=d.value;n.set(p,c,!1)}}catch(v){h.e(v)}finally{h.f()}}}}catch(v){u.e(v)}finally{u.f()}return e}(f,e,v));var y=function(e){var t={};if(ave(e)&&e.component.selection){var n,r=(0,Zt.Z)(Yee(e.component.selection));try{for(r.s();!(n=r.n()).done;){var a,i=n.value,o=e.component.selection[i],u=(0,Zt.Z)(o.project.items);try{for(u.s();!(a=u.n()).done;){var s=a.value;!s.channel&&cte(s.field)>1&&(t[s.field]="flatten")}}catch(c){u.e(c)}finally{u.f()}}}catch(c){r.e(c)}finally{r.f()}}return t}(e),b=npe(e);f=null!==(a=rpe.makeWithAncestors(f,{},Object.assign(Object.assign({},y),b),v))&&void 0!==a?a:f,ave(e)&&(f=pve.parseAll(f,e),f=vve.parseAll(f,e)),(ave(e)||ive(e))&&(m||(f=null!==(i=jhe.makeFromEncoding(f,e))&&void 0!==i?i:f),f=null!==(o=sle.makeFromEncoding(f,e))&&void 0!==o?o:f,f=Wde.parseAllForSortIndex(f,e));var x=e.getName(dce),k=new ule(f,x,dce,p);if(h[x]=k,f=k,ave(e)){var w=$he.makeFromEncoding(f,e);w&&(f=w,Kle(e)&&(f=new ape(f))),f=null!==(u=gve.makeFromEncoding(f,e))&&void 0!==u?u:f,f=null!==(s=ope.makeFromEncoding(f,e))&&void 0!==s?s:f}ave(e)&&(f=null!==(c=fve.make(f,e))&&void 0!==c?c:f);var _=e.getName(fce),C=new ule(f,_,fce,p);h[_]=C,f=C,ave(e)&&function(e,t){Hle(e,(function(n){var r=n.name,a=e.getName("lookup_".concat(r));e.component.data.outputNodes[a]=n.materialized=new ule(new wde(t,e,{selection:r}),a,"lookup",e.component.data.outputNodeRefCounts)}))}(e,C);var S=null;if(ive(e)){var A=e.getName("facet");f=null!==(l=function(e,t){var n=t.row,r=t.column;if(n&&r){for(var a=null,i=0,o=[n,r];i<o.length;i++){var u=o[i];if(aoe(u.sort)){var s=u.sort,c=s.field,l=s.op;e=a=new ipe(e,{joinaggregate:[{op:void 0===l?eoe:l,field:c,as:Mve(u,u.sort,{forAs:!0})}],groupby:[Noe(u)]})}}return a}return null}(f,e.facet))&&void 0!==l?l:f,S=new Qhe(f,e,A,C.getSource()),h[A]=S}return Object.assign(Object.assign({},e.component.data),{outputNodes:h,outputNodeRefCounts:p,raw:k,main:C,facetRoot:S,ancestorParse:v})}var zve=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r,a,i){var o,u,s,c,l;return(0,Jh.Z)(this,n),o=t.call(this,e,"concat",r,a,i,e.resolve),"shared"!==(null===(s=null===(u=e.resolve)||void 0===u?void 0:u.axis)||void 0===s?void 0:s.x)&&"shared"!==(null===(l=null===(c=e.resolve)||void 0===c?void 0:c.axis)||void 0===l?void 0:l.y)||oae("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),o.children=o.getChildren(e).map((function(e,t){return dge(e,(0,Sx.Z)(o),o.getName("concat_"+t),void 0,i)})),o}return(0,ep.Z)(n,[{key:"parseData",value:function(){this.component.data=Bve(this);var e,t=(0,Zt.Z)(this.children);try{for(t.s();!(e=t.n()).done;){e.value.parseData()}}catch(n){t.e(n)}finally{t.f()}}},{key:"parseSelections",value:function(){this.component.selection={};var e,t=(0,Zt.Z)(this.children);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.parseSelections();var r,a=(0,Zt.Z)(Yee(n.component.selection));try{for(a.s();!(r=a.n()).done;){var i=r.value;this.component.selection[i]=n.component.selection[i]}}catch(o){a.e(o)}finally{a.f()}}}catch(o){t.e(o)}finally{t.f()}}},{key:"parseMarkGroup",value:function(){var e,t=(0,Zt.Z)(this.children);try{for(t.s();!(e=t.n()).done;){e.value.parseMarkGroup()}}catch(n){t.e(n)}finally{t.f()}}},{key:"parseAxesAndHeaders",value:function(){var e,t=(0,Zt.Z)(this.children);try{for(t.s();!(e=t.n()).done;){e.value.parseAxesAndHeaders()}}catch(n){t.e(n)}finally{t.f()}}},{key:"getChildren",value:function(e){return Que(e)?e.vconcat:Jue(e)?e.hconcat:e.concat}},{key:"parseLayoutSize",value:function(){Nve(this)}},{key:"parseAxisGroup",value:function(){return null}},{key:"assembleSelectionTopLevelSignals",value:function(e){return this.children.reduce((function(e,t){return t.assembleSelectionTopLevelSignals(e)}),e)}},{key:"assembleSignals",value:function(){return this.children.forEach((function(e){return e.assembleSignals()})),[]}},{key:"assembleLayoutSignals",value:function(){var e,t=ohe(this),n=(0,Zt.Z)(this.children);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,(0,ln.Z)(r.assembleLayoutSignals()))}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"assembleSelectionData",value:function(e){return this.children.reduce((function(e,t){return t.assembleSelectionData(e)}),e)}},{key:"assembleMarks",value:function(){return this.children.map((function(e){var t=e.assembleTitle(),n=e.assembleGroupStyle(),r=e.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:e.getName("group")},t?{title:t}:{}),n?{style:n}:{}),r?{encode:{update:r}}:{}),e.assembleGroup())}))}},{key:"assembleDefaultLayout",value:function(){var e=this.layout.columns;return Object.assign(Object.assign({},null!=e?{columns:e}:{}),{bounds:"full",align:"each"})}}]),n}(sve);var Lve=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},bte),{labelExpr:1,encode:1}),Pve=Yee(Lve),jve=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,Jh.Z)(this,n),(e=t.call(this)).explicit=r,e.implicit=a,e.mainExtracted=i,e}return(0,ep.Z)(n,[{key:"clone",value:function(){return new n(Oee(this.explicit),Oee(this.implicit),this.mainExtracted)}},{key:"hasAxisPart",value:function(e){return"axis"===e||("grid"===e||"title"===e?!!this.get(e):!(!1===(t=this.get(e))||null===t));var t}},{key:"hasOrientSignalRef",value:function(){return Aae(this.explicit.orient)}}]),n}($se);var Uve={bottom:"top",top:"bottom",left:"right",right:"left"};function Wve(e,t){if(!e)return t.map((function(e){return e.clone()}));if(e.length===t.length){for(var n=e.length,r=0;r<n;r++){var a=e[r],i=t[r];if(!!a!==!!i)return;if(a&&i){var o=a.getWithExplicit("orient"),u=i.getWithExplicit("orient");if(o.explicit&&u.explicit&&o.value!==u.value)return;e[r]=Vve(a,i)}}return e}}function Vve(e,t){var n,r=(0,Zt.Z)(Pve);try{var a=function(){var r=n.value,a=nce(e.getWithExplicit(r),t.getWithExplicit(r),r,"axis",(function(e,t){switch(r){case"title":return fue(e,t);case"gridScale":return{explicit:e.explicit,value:lte(e.value,t.value)}}return tce(e,t,r,"axis")}));e.setWithExplicit(r,a)};for(r.s();!(n=r.n()).done;)a()}catch(i){r.e(i)}finally{r.f()}return e}function Gve(e,t,n,r,a){if("disable"===t)return void 0!==n;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(Aae(n.labelAngle)?n.labelAngle:hte(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===Ude(r,a))return!0}return e===n[t]}var qve=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function Hve(e,t){var n,r,a,i=t.axis(e),o=new jve,u=Uoe(t.encoding[e]),s=t.mark,c=t.config,l=(null===i||void 0===i?void 0:i.orient)||(null===(n=c["x"===e?"axisX":"axisY"])||void 0===n?void 0:n.orient)||(null===(r=c.axis)||void 0===r?void 0:r.orient)||function(e){return"x"===e?"bottom":"left"}(e),f=t.getScaleComponent(e).get("type"),d=Rde(e,f,l,t.config),h=void 0!==i?!i:Bde("disable",c,null===i||void 0===i?void 0:i.style,d).configValue;if(o.set("disable",h,void 0!==i),h)return o;var p,v=function(e,t,n,r,a){var i=null===t||void 0===t?void 0:t.labelAngle;if(void 0!==i)return Aae(i)?i:hte(i);var o=Bde("labelAngle",e.config,null===t||void 0===t?void 0:t.style,a).configValue;return void 0!==o?hte(o):n===one&&Pee([Kae,Xae],r.type)?270:void 0}(t,i=i||{},e,u,d),g={fieldOrDatumDef:u,axis:i,channel:e,model:t,scaleType:f,orient:l,labelAngle:v,mark:s,config:c},m=(0,Zt.Z)(Pve);try{for(m.s();!(p=m.n()).done;){var y=p.value,b=y in zde?zde[y](g):kte(y)?i[y]:void 0,x=void 0!==b,k=Gve(b,y,i,t,e);if(x&&k)o.set(y,b,k);else{var w=kte(y)&&"values"!==y?Bde(y,t.config,i.style,d):{},_=w.configValue,C=void 0===_?void 0:_,S=w.configFrom,A=void 0===S?void 0:S,E=void 0!==C;x&&!E?o.set(y,b,k):("vgAxisConfig"!==A||qve.has(y)&&E||gte(C)||Aae(C))&&o.set(y,C,!1)}}}catch(D){m.e(D)}finally{m.f()}var T=null!==(a=i.encoding)&&void 0!==a?a:{},N=mte.reduce((function(n,r){var a;if(!o.hasAxisPart(r))return n;var i=fhe(null!==(a=T[r])&&void 0!==a?a:{},t),u="labels"===r?function(e,t,n){var r,a=e.encoding,i=e.config,o=null!==(r=Uoe(a[t]))&&void 0!==r?r:Uoe(a[ere(t)]),u=e.axis(t)||{},s=u.format,c=u.formatType;return Wie(c)?Object.assign({text:Hie({fieldOrDatumDef:o,field:"datum.value",format:s,formatType:c,config:i})},n):n}(t,e,i):i;return void 0===u||Xee(u)||(n[r]={update:u}),n}),{});return Xee(N)||o.set("encode",N,!!i.encoding||void 0!==i.labelAngle),o}function Xve(e){var t,n=e.encoding,r=e.size,a=(0,Zt.Z)(ire);try{for(a.s();!(t=a.n()).done;){var i=t.value,o=tre(i);ese(r[o])&&boe(n[i])&&(delete r[o],oae(Xre(o)))}}catch(u){a.e(u)}finally{a.f()}return r}function Yve(e,t,n,r){var a,i,o=r.graticule,u=Pte(e)?Object.assign({},e):{type:e},s=aue("orient",u,n);if(u.orient=function(e,t,n){switch(e){case Tte:case Ote:case Rte:case Fte:case Nte:case Ate:return}var r=t.x,a=t.y,i=t.x2,o=t.y2;switch(e){case Ste:if(goe(r)&&(kre(r.bin)||goe(a)&&a.aggregate&&!r.aggregate))return"vertical";if(goe(a)&&(kre(a.bin)||goe(r)&&r.aggregate&&!a.aggregate))return"horizontal";if(o||i){if(n)return n;if(!i&&(goe(r)&&r.type===Hae&&!xre(r.bin)||xoe(r)))return"horizontal";if(!o&&(goe(a)&&a.type===Hae&&!xre(a.bin)||xoe(a)))return"vertical"}case Dte:if(i&&(!goe(r)||!kre(r.bin))&&o&&(!goe(a)||!kre(a.bin)))return;case Cte:if(o)return goe(a)&&kre(a.bin)?"horizontal":"vertical";if(i)return goe(r)&&kre(r.bin)?"vertical":"horizontal";if(e===Dte){if(r&&!a)return"vertical";if(a&&!r)return"horizontal"}case Ete:case Ite:var u=boe(r),s=boe(a);if(u&&!s)return"tick"!==e?"horizontal":"vertical";if(!u&&s)return"tick"!==e?"vertical":"horizontal";if(u&&s){var c=r,l=a,f=c.type===Yae,d=l.type===Yae;return f&&!d?"tick"!==e?"vertical":"horizontal":!f&&d?"tick"!==e?"horizontal":"vertical":!c.aggregate&&l.aggregate?"tick"!==e?"vertical":"horizontal":c.aggregate&&!l.aggregate?"tick"!==e?"horizontal":"vertical":n||"vertical"}return n||void 0}return"vertical"}(u.type,t,s),void 0!==s&&s!==u.orient&&oae((a=u.orient,i=s,'Specified orient "'.concat(a,'" overridden with "').concat(i,'".'))),"bar"===u.type&&u.orient){var c=aue("cornerRadiusEnd",u,n);if(void 0!==c){var l,f="horizontal"===u.orient&&t.x2||"vertical"===u.orient&&t.y2?["cornerRadius"]:Wte[u.orient],d=(0,Zt.Z)(f);try{for(d.s();!(l=d.n()).done;){u[l.value]=c}}catch(h){d.e(h)}finally{d.f()}void 0!==u.cornerRadiusEnd&&delete u.cornerRadiusEnd}}return void 0===aue("opacity",u,n)&&(u.opacity=function(e,t){if(Pee([Tte,Ite,Ote,Rte],e)&&!hue(t))return.7;return}(u.type,t)),void 0===u.filled&&(u.filled=!o&&function(e,t){var n=iue("filled",e,t),r=e.type;return lte(n,r!==Tte&&r!==Ete&&r!==Dte)}(u,n)),void 0===aue("cursor",u,n)&&(u.cursor=function(e,t,n){if(t.href||e.href||aue("href",e,n))return"pointer";return e.cursor}(u,t,n)),u}function Kve(e,t){e.config;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Jce(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),jce("x",e,{defaultPos:"mid"})),jce("y",e,{defaultPos:"mid"})),zce("size",e)),zce("angle",e)),function(e,t,n){if(n)return{shape:{value:n}};return zce("shape",e)}(e,0,t))}var $ve={vgMark:"rule",encodeEntry:function(e){var t=e.markDef.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},Jce(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),qce("x",e,{defaultPos:"horizontal"===t?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==t})),qce("y",e,{defaultPos:"vertical"===t?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==t})),zce("size",e,{vgChannel:"strokeWidth"})):{}}},Qve={vgMark:"text",encodeEntry:function(e){var t=e.config;e.encoding;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Jce(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),jce("x",e,{defaultPos:"mid"})),jce("y",e,{defaultPos:"mid"})),Ice(e)),zce("size",e,{vgChannel:"fontSize"})),zce("angle",e)),nle("align",function(e,t,n){var r=aue("align",e,n);if(void 0===r)return"center";return}(e.markDef,0,t))),nle("baseline",function(e,t,n){var r=aue("baseline",e,n);if(void 0===r)return"middle";return}(e.markDef,0,t))),jce("radius",e,{defaultPos:null,isMidPoint:!0})),jce("theta",e,{defaultPos:null,isMidPoint:!0}))}};var Jve={vgMark:"rect",encodeEntry:function(e){var t=e.config,n=e.markDef,r=n.orient,a="horizontal"===r?"width":"height",i="horizontal"===r?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Jce(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),jce("x",e,{defaultPos:"mid",vgChannel:"xc"})),jce("y",e,{defaultPos:"mid",vgChannel:"yc"})),zce("size",e,{defaultValue:ege(e),vgChannel:a})),(0,qn.Z)({},i,eue(aue("thickness",n,t))))}};function ege(e){var t,n=e.config,r=e.markDef,a=r.orient,i="horizontal"===a?"width":"height",o=e.getScaleComponent("horizontal"===a?"x":"y"),u=null!==(t=aue("size",r,n,{vgChannel:i}))&&void 0!==t?t:n.tick.bandSize;if(void 0!==u)return u;var s=o?o.get("range"):void 0;return s&&Eae(s)&&mee(s.step)?3*s.step/4:3*ase(n.view,i)/4}var tge={arc:{vgMark:"arc",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Jce(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),jce("x",e,{defaultPos:"mid"})),jce("y",e,{defaultPos:"mid"})),Yce(e,"radius","arc")),Yce(e,"theta","arc"))}},area:{vgMark:"area",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign({},Jce(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),qce("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===e.markDef.orient})),qce("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===e.markDef.orient})),tle(e))}},bar:{vgMark:"rect",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign({},Jce(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Yce(e,"x","bar")),Yce(e,"y","bar"))}},circle:{vgMark:"symbol",encodeEntry:function(e){return Kve(e,"circle")}},geoshape:{vgMark:"shape",encodeEntry:function(e){return Object.assign({},Jce(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}))},postEncodingTransform:function(e){var t=e.encoding.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},t&&goe(t)&&t.type===$ae?{field:Noe(t,{expr:"datum"})}:{})]}},image:{vgMark:"image",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign({},Jce(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),Yce(e,"x","image")),Yce(e,"y","image")),Ice(e,"url"))}},line:{vgMark:"line",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Jce(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),jce("x",e,{defaultPos:"mid"})),jce("y",e,{defaultPos:"mid"})),zce("size",e,{vgChannel:"strokeWidth"})),tle(e))}},point:{vgMark:"symbol",encodeEntry:function(e){return Kve(e)}},rect:{vgMark:"rect",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign({},Jce(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Yce(e,"x","rect")),Yce(e,"y","rect"))}},rule:$ve,square:{vgMark:"symbol",encodeEntry:function(e){return Kve(e,"square")}},text:Qve,tick:Jve,trail:{vgMark:"trail",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Jce(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),jce("x",e,{defaultPos:"mid"})),jce("y",e,{defaultPos:"mid"})),zce("size",e)),tle(e))}}};function nge(e){return Pee([Ete,Cte,Mte],e.mark)?function(e){var t=bue(e.mark,e.encoding),n=oge(e,{fromPrefix:t.length>0?rge:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:rge+e.requestDataName(fce),data:e.requestDataName(fce),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}(e):Pee([Ste],e.mark)?function(e){var t=Fae.some((function(t){return aue(t,e.markDef,e.config)}));if(e.stack&&!e.fieldDef("size")&&t){var n,r,a=oge(e,{fromPrefix:age}),i=(0,ku.Z)(a,1)[0],o=e.scaleName(e.stack.fieldChannel),u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.vgField(e.stack.fieldChannel,t)},s=function(e,t){var n=[u({prefix:"min",suffix:"start",expr:t}),u({prefix:"max",suffix:"start",expr:t}),u({prefix:"min",suffix:"end",expr:t}),u({prefix:"max",suffix:"end",expr:t})];return"".concat(e,"(").concat(n.map((function(e){return"scale('".concat(o,"',").concat(e,")")})).join(","),")")};"x"===e.stack.fieldChannel?(n=Object.assign(Object.assign({},Ree(i.encode.update,["y","yc","y2","height"].concat((0,ln.Z)(Fae)))),{x:{signal:s("min","datum")},x2:{signal:s("max","datum")},clip:{value:!0}}),r={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},i.encode.update=Object.assign(Object.assign({},Zee(i.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(n=Object.assign(Object.assign({},Ree(i.encode.update,["x","xc","x2","width"])),{y:{signal:s("min","datum")},y2:{signal:s("max","datum")},clip:{value:!0}}),r={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},i.encode.update=Object.assign(Object.assign({},Zee(i.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));var c,l=(0,Zt.Z)(Fae);try{for(l.s();!(c=l.n()).done;){var f=c.value,d=iue(f,e.markDef,e.config);i.encode.update[f]?(n[f]=i.encode.update[f],delete i.encode.update[f]):d&&(n[f]=eue(d)),d&&(i.encode.update[f]={value:0})}}catch(v){l.e(v)}finally{l.f()}var h=e.fieldDef(e.stack.groupbyChannel),p=Noe(h)?[Noe(h)]:[];return((null===h||void 0===h?void 0:h.bin)||(null===h||void 0===h?void 0:h.timeUnit))&&p.push(Noe(h,{binSuffix:"end"})),n=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((function(t,n){if(i.encode.update[n])return Object.assign(Object.assign({},t),(0,qn.Z)({},n,i.encode.update[n]));var r=iue(n,e.markDef,e.config);return void 0!==r?Object.assign(Object.assign({},t),(0,qn.Z)({},n,eue(r))):t}),n),n.stroke&&(n.strokeForeground={value:!0},n.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(fce),name:age+e.requestDataName(fce),groupby:p,aggregate:{fields:[u({suffix:"start"}),u({suffix:"start"}),u({suffix:"end"}),u({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:n},marks:[{type:"group",encode:{update:r},marks:[i]}]}]}return oge(e)}(e):oge(e)}var rge="faceted_path_";var age="stack_group_";function ige(e){var t=e.encoding,n=e.stack,r=e.mark,a=e.markDef,i=e.config,o=t.order;if(!(!uee(o)&&_oe(o)&&Lee(o.value)||!o&&Lee(aue("order",a,i)))){if((uee(o)||goe(o))&&!n)return sue(o,{expr:"datum"});if(Bte(r)){var u="horizontal"===a.orient?"y":"x",s=t[u];if(goe(s)){var c=s.sort;return uee(c)?{field:Noe(s,{prefix:u,suffix:"sort_index",expr:"datum"})}:aoe(c)?{field:Noe({aggregate:hue(e.encoding)?c.op:void 0,field:c.field},{expr:"datum"})}:roe(c)?{field:Noe(e.fieldDef(c.encoding),{expr:"datum"}),order:c.order}:null===c?void 0:{field:Noe(s,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}}else;}}function oge(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fromPrefix:""},n=e.mark,r=e.markDef,a=e.config,i=lte(r.clip,uge(e),sge(e)),o=rue(r),u=e.encoding.key,s=ige(e),c=cge(e),l=aue("aria",r,a),f=tge[n].postEncodingTransform?tge[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:tge[n].vgMark},i?{clip:!0}:{}),o?{style:o}:{}),u?{key:u.field}:{}),s?{sort:s}:{}),c||{}),!1===l?{aria:l}:{}),{from:{data:t.fromPrefix+e.requestDataName(fce)},encode:{update:tge[n].encodeEntry(e)}}),f?{transform:f}:{})]}function uge(e){var t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!!(t&&t.get("selectionExtent")||n&&n.get("selectionExtent"))||void 0}function sge(e){var t=e.component.projection;return!(!t||t.isFit)||void 0}function cge(e){if(!e.component.selection)return null;for(var t=Yee(e.component.selection).length,n=t,r=e.parent;r&&0===n;)n=Yee(r.component.selection).length,r=r.parent;return n?{interactive:t>0}:null}var lge=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r,a){var i,o,u,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=arguments.length>4?arguments[4]:void 0;(0,Jh.Z)(this,n),(i=t.call(this,e,"unit",r,a,c,void 0,tse(e)?e.view:void 0)).specifiedScales={},i.specifiedAxes={},i.specifiedLegends={},i.specifiedProjection={},i.selection={},i.children=[];var l=Pte(e.mark)?e.mark.type:e.mark;i.markDef=Yve(e.mark,null!==(o=e.encoding)&&void 0!==o?o:{},c,{graticule:e.data&&lce(e.data)});var f=i.encoding=vue(null!==(u=e.encoding)&&void 0!==u?u:{},i.markDef,c);return i.size=Xve({encoding:f,size:tse(e)?Object.assign(Object.assign(Object.assign({},s),e.width?{width:e.width}:{}),e.height?{height:e.height}:{}):s}),i.stack=Tse(l,f),i.specifiedScales=i.initScales(l,f),i.specifiedAxes=i.initAxes(f),i.specifiedLegends=i.initLegend(f),i.specifiedProjection=e.projection,i.selection=e.selection,i}return(0,ep.Z)(n,[{key:"hasProjection",get:function(){var e=this.encoding,t=this.mark===Zte,n=e&&Pne.some((function(t){return koe(e[t])}));return t||n}},{key:"scaleDomain",value:function(e){var t=this.specifiedScales[e];return t?t.domain:void 0}},{key:"axis",value:function(e){return this.specifiedAxes[e]}},{key:"legend",value:function(e){return this.specifiedLegends[e]}},{key:"initScales",value:function(e,t){return hre.reduce((function(e,n){var r,a=Uoe(t[n]);return a&&(e[n]=null!==(r=a.scale)&&void 0!==r?r:{}),e}),{})}},{key:"initAxes",value:function(e){return ire.reduce((function(t,n){var r=e[n];if(koe(r)||n===one&&koe(e.x2)||n===une&&koe(e.y2)){var a=koe(r)?r.axis:void 0;t[n]=a?Object.assign({},a):a}return t}),{})}},{key:"initLegend",value:function(e){return fre.reduce((function(t,n){var r=Uoe(e[n]);if(r&&function(e){switch(e){case yne:case bne:case xne:case wne:case kne:case Cne:case Ene:case Tne:return!0;case Sne:case Ane:case _ne:return!1}}(n)){var a=r.legend;t[n]=a?Object.assign({},a):a}return t}),{})}},{key:"parseData",value:function(){this.component.data=Bve(this)}},{key:"parseLayoutSize",value:function(){!function(e){var t,n=e.size,r=e.component,a=(0,Zt.Z)(ire);try{for(a.s();!(t=a.n()).done;){var i=tre(t.value);if(n[i]){var o=n[i];r.layoutSize.set(i,ese(o)?"step":o,!0)}else{var u=Ive(e,i);r.layoutSize.set(i,u,!1)}}}catch(s){a.e(s)}finally{a.f()}}(this)}},{key:"parseSelections",value:function(){this.component.selection=function(e,t){var n,r,a={},i=e.config.selection,o=(0,Zt.Z)(Yee(null!==t&&void 0!==t?t:{}));try{var u=function(){var o=r.value,u=Oee(t[o]),s=i[u.type],c=(s.fields,s.encodings,kee(s,["fields","encodings"]));for(var l in c)"encodings"===l&&u.fields||"fields"===l&&u.encodings||("mark"===l&&(u[l]=Object.assign(Object.assign({},c[l]),u[l])),void 0!==u[l]&&!0!==u[l]||(u[l]=null!==(n=c[l])&&void 0!==n?n:u[l]));var f=Jee(o),d=a[f]=Object.assign(Object.assign({},u),{name:f,events:yee(u.on)?q9(u.on,"scope"):Oee(u.on)});Fle(d,(function(n){n.has(d)&&n.parse&&n.parse(e,d,u,t[o])}))};for(o.s();!(r=o.n()).done;)u()}catch(s){o.e(s)}finally{o.f()}return a}(this,this.selection)}},{key:"parseMarkGroup",value:function(){this.component.mark=nge(this)}},{key:"parseAxesAndHeaders",value:function(){var e;this.component.axes=(e=this,ire.reduce((function(t,n){return e.component.scales[n]&&(t[n]=[Hve(n,e)]),t}),{}))}},{key:"assembleSelectionTopLevelSignals",value:function(e){return function(e,t){var n=!1;if(Hle(e,(function(r,a){var i=r.name,o=bee(i+Ule),u=t.filter((function(e){return e.name===i}));if(0===u.length){var s="global"===r.resolve?"union":r.resolve,c="multi"===r.type?", true)":")";t.push({name:r.name,update:"".concat(Gle,"(").concat(o,", ").concat(bee(s)).concat(c)})}n=!0,a.topLevelSignals&&(t=a.topLevelSignals(e,r,t)),Fle(r,(function(n){n.topLevelSignals&&(t=n.topLevelSignals(e,r,t))}))})),n){var r=t.filter((function(e){return"unit"===e.name}));0===r.length&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})}return Ole(t)}(this,e)}},{key:"assembleSignals",value:function(){return[].concat((0,ln.Z)(Nde(this)),(0,ln.Z)((t=[],Hle(e=this,(function(n,r){var a,i=n.name,o=r.modifyExpr(e,n);(a=t).push.apply(a,(0,ln.Z)(r.signals(e,n))),Fle(n,(function(r){r.signals&&(t=r.signals(e,n,t)),r.modifyExpr&&(o=r.modifyExpr(e,n,o))})),t.push({name:i+Vle,on:[{events:{signal:n.name+Wle},update:"modify(".concat(bee(n.name+Ule),", ").concat(o,")")}]})})),Ole(t))));var e,t}},{key:"assembleSelectionData",value:function(e){return function(e,t){var n=(0,ln.Z)(t);return Hle(e,(function(t){var r={name:t.name+Ule};if(t.init){var a=t.project.items.map((function(e){return e.signals,kee(e,["signals"])})),i=t.init.map((function(e){return Ile(e,!1)}));r.values="interval"===t.type?[{unit:Yle(e,{escape:!1}),fields:a,values:i}]:i.map((function(t){return{unit:Yle(e,{escape:!1}),fields:a,values:t}}))}n.filter((function(e){return e.name===t.name+Ule})).length||n.push(r)})),n}(this,e)}},{key:"assembleLayout",value:function(){return null}},{key:"assembleLayoutSignals",value:function(){return ohe(this)}},{key:"assembleMarks",value:function(){var e,t=null!==(e=this.component.mark)&&void 0!==e?e:[];return this.parent&&uve(this.parent)||(t=Mle(this,t)),t.map(this.correctDataNames)}},{key:"getMapping",value:function(){return this.encoding}},{key:"mark",get:function(){return this.markDef.type}},{key:"channelHasField",value:function(e){return due(this.encoding,e)}},{key:"fieldDef",value:function(e){return joe(this.encoding[e])}},{key:"typedFieldDef",value:function(e){var t=this.fieldDef(e);return woe(t)?t:null}}]),n}(cve),fge=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(e,r,a,i,o){var u;(0,Jh.Z)(this,n),u=t.call(this,e,"layer",r,a,o,e.resolve,e.view);var s=Object.assign(Object.assign(Object.assign({},i),e.width?{width:e.width}:{}),e.height?{height:e.height}:{});return u.children=e.layer.map((function(e,t){if(xse(e))return new n(e,(0,Sx.Z)(u),u.getName("layer_"+t),s,o);if(qte(e))return new lge(e,(0,Sx.Z)(u),u.getName("layer_"+t),s,o);throw new Error(Are(e))})),u}return(0,ep.Z)(n,[{key:"parseData",value:function(){this.component.data=Bve(this);var e,t=(0,Zt.Z)(this.children);try{for(t.s();!(e=t.n()).done;){e.value.parseData()}}catch(n){t.e(n)}finally{t.f()}}},{key:"parseLayoutSize",value:function(){var e;Dve(e=this),Fve(e,"width"),Fve(e,"height")}},{key:"parseSelections",value:function(){this.component.selection={};var e,t=(0,Zt.Z)(this.children);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.parseSelections();var r,a=(0,Zt.Z)(Yee(n.component.selection));try{for(a.s();!(r=a.n()).done;){var i=r.value;this.component.selection[i]=n.component.selection[i]}}catch(o){a.e(o)}finally{a.f()}}}catch(o){t.e(o)}finally{t.f()}}},{key:"parseMarkGroup",value:function(){var e,t=(0,Zt.Z)(this.children);try{for(t.s();!(e=t.n()).done;){e.value.parseMarkGroup()}}catch(n){t.e(n)}finally{t.f()}}},{key:"parseAxesAndHeaders",value:function(){!function(e){var t,n,r=e.component,a=r.axes,i=r.resolve,o={top:0,bottom:0,right:0,left:0},u=(0,Zt.Z)(e.children);try{for(u.s();!(n=u.n()).done;){var s=n.value;s.parseAxesAndHeaders();var c,l=(0,Zt.Z)(Yee(s.component.axes));try{for(l.s();!(c=l.n()).done;){var f=c.value;i.axis[f]=hhe(e.component.resolve,f),"shared"===i.axis[f]&&(a[f]=Wve(a[f],s.component.axes[f]),a[f]||(i.axis[f]="independent",delete a[f]))}}catch(T){l.e(T)}finally{l.f()}}}catch(T){u.e(T)}finally{u.f()}var d,h=(0,Zt.Z)(ire);try{for(h.s();!(d=h.n()).done;){var p,v=d.value,g=(0,Zt.Z)(e.children);try{for(g.s();!(p=g.n()).done;){var m=p.value;if(m.component.axes[v]){if("independent"===i.axis[v]){a[v]=(null!==(t=a[v])&&void 0!==t?t:[]).concat(m.component.axes[v]);var y,b=(0,Zt.Z)(m.component.axes[v]);try{for(b.s();!(y=b.n()).done;){var x=y.value,k=x.getWithExplicit("orient"),w=k.value,_=k.explicit;if(!Aae(w)){if(o[w]>0&&!_){var C=Uve[w];o[w]>o[C]&&x.set("orient",C,!1)}o[w]++}}}catch(T){b.e(T)}finally{b.f()}}delete m.component.axes[v]}}}catch(T){g.e(T)}finally{g.f()}if("independent"===i.axis[v]&&a[v]&&a[v].length>1){var S,A=(0,Zt.Z)(a[v]);try{for(A.s();!(S=A.n()).done;){var E=S.value;E.get("grid")&&!E.explicit.grid&&(E.implicit.grid=!1)}}catch(T){A.e(T)}finally{A.f()}}}}catch(T){h.e(T)}finally{h.f()}}(this)}},{key:"assembleSelectionTopLevelSignals",value:function(e){return this.children.reduce((function(e,t){return t.assembleSelectionTopLevelSignals(e)}),e)}},{key:"assembleSignals",value:function(){return this.children.reduce((function(e,t){return e.concat(t.assembleSignals())}),Nde(this))}},{key:"assembleLayoutSignals",value:function(){return this.children.reduce((function(e,t){return e.concat(t.assembleLayoutSignals())}),ohe(this))}},{key:"assembleSelectionData",value:function(e){return this.children.reduce((function(e,t){return t.assembleSelectionData(e)}),e)}},{key:"assembleTitle",value:function(){var e=(0,Ax.Z)((0,Ex.Z)(n.prototype),"assembleTitle",this).call(this);if(e)return e;var t,r=(0,Zt.Z)(this.children);try{for(r.s();!(t=r.n()).done;){if(e=t.value.assembleTitle())return e}}catch(a){r.e(a)}finally{r.f()}}},{key:"assembleLayout",value:function(){return null}},{key:"assembleMarks",value:function(){return function(e,t){var n,r=(0,Zt.Z)(e.children);try{for(r.s();!(n=r.n()).done;){var a=n.value;ave(a)&&(t=Mle(a,t))}}catch(i){r.e(i)}finally{r.f()}return t}(this,this.children.flatMap((function(e){return e.assembleMarks()})))}},{key:"assembleLegends",value:function(){return this.children.reduce((function(e,t){return e.concat(t.assembleLegends())}),Fhe(this))}}]),n}(sve);function dge(e,t,n,r,a){if(soe(e))return new Ove(e,t,n,a);if(xse(e))return new fge(e,t,n,r,a);if(qte(e))return new lge(e,t,n,r,a);if(function(e){return Que(e)||Jue(e)||$ue(e)}(e))return new zve(e,t,n,a);throw new Error(Are(e))}function hge(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.logger&&aae(t.logger),t.fieldTitle&&Roe(t.fieldTitle);try{var n=pse(lee(t.config,e.config)),r=qse(e,n),a=dge(r,null,"",void 0,n);a.parse(),Ape(a.component.data,a);var i=vge(a,pge(e,r.autosize,n,a),e.datasets,e.usermeta);return{spec:i,normalized:r}}finally{t.logger&&iae(),t.fieldTitle&&Zoe()}}function pge(e,t,n,r){var a,i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(void 0===t?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):yee(t)&&(t={type:t}),i&&o&&("fit"===(a=t.type)||"fit-x"===a||"fit-y"===a))if("step"===i&&"step"===o)oae(Dre()),t.type="pad";else if("step"===i||"step"===o){var u="step"===i?"width":"height";oae(Dre(cre(u)));var s="width"===u?"height":"width";t.type=function(e){return e?"fit-".concat(cre(e)):"fit"}(s)}return Object.assign(Object.assign(Object.assign({},1===Yee(t).length&&t.type?"pad"===t.type?{}:{autosize:t.type}:{autosize:t}),Kse(n)),Kse(e))}function vge(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,a=e.config?yse(e.config):void 0,i=[].concat(e.assembleSelectionData([]),Cve(e.component.data,n)),o=e.assembleProjections(),u=e.assembleTitle(),s=e.assembleGroupStyle(),c=e.assembleGroupEncodeEntry(!0),l=e.assembleLayoutSignals();return l=l.filter((function(e){return"width"!==e.name&&"height"!==e.name||void 0===e.value||(t[e.name]=+e.value,!1)})),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),u?{title:u}:{}),s?{style:s}:{}),c?{encode:{update:c}}:{}),{data:i}),o.length>0?{projections:o}:{}),e.assembleGroup([].concat((0,ln.Z)(l),(0,ln.Z)(e.assembleSelectionTopLevelSignals([]))))),a?{config:a}:{}),r?{usermeta:r}:{})}var gge=function(e){(0,Tx.Z)(n,e);var t=(0,Nx.Z)(n);function n(){return(0,Jh.Z)(this,n),t.apply(this,arguments)}return(0,ep.Z)(n,[{key:"mapUnit",value:function(e,t){var n=t.config;if(e.encoding){var r=e.encoding,a=e.transform,i=pue(r,n),o=i.bins,u=i.timeUnits,s=i.aggregate,c=i.groupby,l=i.encoding,f=[].concat((0,ln.Z)(a||[]),(0,ln.Z)(o),(0,ln.Z)(u),(0,ln.Z)(0===s.length?[]:[{aggregate:s,groupby:c}]));return Object.assign(Object.assign(Object.assign({},e),f.length>0?{transform:f}:{}),{encoding:l})}return e}}]),n}(kse),mge=new gge;function yge(e,t){return mge.map(e,{config:t})}var bge="4.13.1";var xge=function(e){var t=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3),n=(0,ku.Z)(t,2);return{library:n[0],version:n[1]}},kge="2.12.1",wge="#fff",_ge="#888",Cge={background:"#333",view:{stroke:_ge},title:{color:wge,subtitleColor:wge},style:{"guide-label":{fill:wge},"guide-title":{fill:wge}},axis:{domainColor:wge,gridColor:_ge,tickColor:wge}},Sge="#4572a7",Age={background:"#fff",arc:{fill:Sge},area:{fill:Sge},line:{stroke:Sge,strokeWidth:2},path:{stroke:Sge},rect:{fill:Sge},shape:{stroke:Sge},symbol:{fill:Sge,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Ege="#30a2da",Tge="#cbcbcb",Nge="#f0f0f0",Dge="#333",Fge={arc:{fill:Ege},area:{fill:Ege},axis:{domainColor:Tge,grid:!0,gridColor:Tge,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:Tge,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:Nge,group:{fill:Nge},legend:{labelColor:Dge,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:Dge,titleFontSize:14,titlePadding:10},line:{stroke:Ege,strokeWidth:2},path:{stroke:Ege,strokeWidth:.5},rect:{fill:Ege},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Ege},bar:{binSpacing:2,fill:Ege,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Ige="#000",Mge={group:{fill:"#e5e5e5"},arc:{fill:Ige},area:{fill:Ige},line:{stroke:Ige},path:{stroke:Ige},rect:{fill:Ige},shape:{stroke:Ige},symbol:{fill:Ige,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},Oge="Benton Gothic, sans-serif",Rge="#82c6df",Zge="Benton Gothic Bold, sans-serif",Bge="normal",zge={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},Lge={background:"#ffffff",title:{anchor:"start",color:"#000000",font:Zge,fontSize:22,fontWeight:"normal"},arc:{fill:Rge},area:{fill:Rge},line:{stroke:Rge,strokeWidth:2},path:{stroke:Rge},rect:{fill:Rge},shape:{stroke:Rge},symbol:{fill:Rge,size:30},axis:{labelFont:Oge,labelFontSize:11.5,labelFontWeight:"normal",titleFont:Zge,titleFontSize:13,titleFontWeight:Bge},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:Oge,labelFontSize:11.5,symbolType:"square",titleFont:Zge,titleFontSize:13,titleFontWeight:Bge},range:{category:zge["category-6"],diverging:zge["fireandice-6"],heatmap:zge["fire-7"],ordinal:zge["fire-7"],ramp:zge["fire-7"]}},Pge="#ab5787",jge="#979797",Uge={background:"#f9f9f9",arc:{fill:Pge},area:{fill:Pge},line:{stroke:Pge},path:{stroke:Pge},rect:{fill:Pge},shape:{stroke:Pge},symbol:{fill:Pge,size:30},axis:{domainColor:jge,domainWidth:.5,gridWidth:.2,labelColor:jge,tickColor:jge,tickWidth:.2,titleColor:jge},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Wge="#3e5c69",Vge={background:"#fff",arc:{fill:Wge},area:{fill:Wge},line:{stroke:Wge},path:{stroke:Wge},rect:{fill:Wge},shape:{stroke:Wge},symbol:{fill:Wge},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Gge="#1696d2",qge="#000000",Hge="Lato",Xge="Lato",Yge={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},Kge={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:Hge},axisX:{domain:!0,domainColor:qge,domainWidth:1,grid:!1,labelFontSize:12,labelFont:Xge,labelAngle:0,tickColor:qge,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:Hge},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:Xge,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:Hge,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:Xge,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:Hge,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:Yge["six-groups-cat-1"],diverging:Yge["diverging-colors"],heatmap:Yge["diverging-colors"],ordinal:Yge["six-groups-seq"],ramp:Yge["shades-blue"]},area:{fill:Gge},rect:{fill:Gge},line:{color:Gge,stroke:Gge,strokeWidth:5},trail:{color:Gge,stroke:Gge,strokeWidth:0,size:1},path:{stroke:Gge,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:Gge,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Gge,stroke:null}},arc:{fill:Gge},shape:{stroke:Gge},symbol:{fill:Gge,size:30}},$ge="#3366CC",Qge="#ccc",Jge="Arial, sans-serif",eme={arc:{fill:$ge},area:{fill:$ge},path:{stroke:$ge},rect:{fill:$ge},shape:{stroke:$ge},symbol:{stroke:$ge},circle:{fill:$ge},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:Jge,fontSize:12},"guide-title":{font:Jge,fontSize:12},"group-title":{font:Jge,fontSize:12}},title:{font:Jge,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:Qge,tickColor:Qge,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},tme=function(e){return e*(1/3+1)},nme=tme(9),rme=tme(10),ame=tme(12),ime="Segoe UI",ome="wf_standard-font, helvetica, arial, sans-serif",ume="#252423",sme="#605E5C",cme="transparent",lme="#118DFF",fme="#DEEFFF",dme=[fme,lme],hme={view:{stroke:cme},background:cme,font:ime,header:{titleFont:ome,titleFontSize:ame,titleColor:ume,labelFont:ime,labelFontSize:rme,labelColor:sme},axis:{ticks:!1,grid:!1,domain:!1,labelColor:sme,labelFontSize:nme,titleFont:ome,titleColor:ume,titleFontSize:ame,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:"#C8C6C4",gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:lme},line:{stroke:lme,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:ime,fontSize:nme,fill:sme},arc:{fill:lme},area:{fill:lme,line:!0,opacity:.6},path:{stroke:lme},rect:{fill:lme},point:{fill:lme,filled:!0,size:75},shape:{stroke:lme},symbol:{fill:lme,strokeWidth:1.5,size:50},legend:{titleFont:ime,titleFontWeight:"bold",titleColor:sme,labelFont:ime,labelFontSize:rme,labelColor:sme,symbolType:"circle",symbolSize:75},range:{category:[lme,"#12239E","#E66C37","#6B007B","#E044A7","#744EC2","#D9B300","#D64550"],diverging:dme,heatmap:dme,ordinal:[fme,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",lme]}},pme=kge,vme="vg-tooltip-element",gme={offsetX:10,offsetY:10,id:vme,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2};function mme(e,t,n){if(Ce(e))return"[".concat(e.map((function(e){return t(xt(e)?e:yme(e,n))})).join(", "),"]");if(Se(e)){var r="",a=e,i=a.title,o=a.image,u=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(a,["title","image"]);i&&(r+="<h2>".concat(t(i),"</h2>")),o&&(r+='<img src="'.concat(t(o),'">'));var s=Object.keys(u);if(s.length>0){r+="<table>";var c,l=(0,Zt.Z)(s);try{for(l.s();!(c=l.n()).done;){var f=c.value,d=u[f];void 0!==d&&(Se(d)&&(d=yme(d,n)),r+='<tr><td class="key">'.concat(t(f),':</td><td class="value">').concat(t(d),"</td></tr>"))}}catch(h){l.e(h)}finally{l.f()}r+="</table>"}return r||"{}"}return t(e)}function yme(e,t){return JSON.stringify(e,function(e){var t=[];return function(n,r){if("object"!==typeof r||null===r)return r;var a=t.indexOf(this)+1;return t.length=a,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}(t))}var bme=function(){function e(t){(0,Jh.Z)(this,e),this.options=Object.assign(Object.assign({},gme),t);var n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){var r=document.createElement("style");r.setAttribute("id",this.options.styleId),r.innerHTML=function(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return"#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element img {\n    max-width: 200px;\n    max-height: 200px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n".toString().replace(vme,e)}(n);var a=document.head;a.childNodes.length>0?a.insertBefore(r,a.childNodes[0]):a.appendChild(r)}}return(0,ep.Z)(e,[{key:"tooltipHandler",value:function(e,t,n,r){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(null!=document.fullscreenElement?document.fullscreenElement:document.body).appendChild(this.el),null!=r&&""!==r){this.el.innerHTML=mme(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible","".concat(this.options.theme,"-theme"));var a=function(e,t,n,r){var a=e.clientX+n;a+t.width>window.innerWidth&&(a=+e.clientX-n-t.width);var i=e.clientY+r;return i+t.height>window.innerHeight&&(i=+e.clientY-r-t.height),{x:a,y:i}}(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY),i=a.x,o=a.y;this.el.setAttribute("style","top: ".concat(o,"px; left: ").concat(i,"px"))}else this.el.classList.remove("visible","".concat(this.options.theme,"-theme"))}}]),e}();function xme(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(t){i(t)}}function u(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){e.done?a(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,u)}s((r=r.apply(e,t||[])).next())}))}function kme(e,t,n){var r=e.open(t),a=new URL(t).origin,i=40;e.addEventListener("message",(function t(n){n.source===r&&(i=0,e.removeEventListener("message",t,!1))}),!1),setTimeout((function e(){i<=0||(r.postMessage(n,a),setTimeout(e,250),i-=1)}),250)}var wme,_me='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    z-index: 1001;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n    text-align: left; }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: "";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n  .vega-embed .chart-wrapper {\n    width: 100%;\n    height: 100%; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n';function Cme(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];Sme(e,o)}return e}function Sme(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var a=r[n];Te(e,a,t[a],!0)}}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});var Ame=b,Eme=x,Tme="undefined"!==typeof window?window:void 0;void 0===Eme&&(null===(wme=null===Tme||void 0===Tme?void 0:Tme.vl)||void 0===wme?void 0:wme.compile)&&(Eme=Tme.vl);var Nme={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},Dme={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},Fme={vega:"Vega","vega-lite":"Vega-Lite"},Ime={vega:Ame.version,"vega-lite":Eme?Eme.version:"not available"},Mme={vega:function(e){return e},"vega-lite":function(e,t){return Eme.compile(e,{config:t}).spec}},Ome='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',Rme="chart-wrapper";function Zme(e){return"function"===typeof e}function Bme(e,t,n,r){var a="<html><head>".concat(t,'</head><body><pre><code class="json">'),i="</code></pre>".concat(n,"</body></html>"),o=window.open("");o.document.write(a+e+i),o.document.title="".concat(Fme[r]," JSON Source")}function zme(e,t){var n;if(e.$schema){var r=xge(e.$schema);t&&t!==r.library&&console.warn("The given visualization spec is written in ".concat(Fme[r.library],", but mode argument sets ").concat(null!==(n=Fme[t])&&void 0!==n?n:t,"."));var a=r.library;return(0,te.satisfies)(Ime[a],"^".concat(r.version.slice(1)))||console.warn("The input spec uses ".concat(Fme[a]," ").concat(r.version,", but the current version of ").concat(Fme[a]," is v").concat(Ime[a],".")),a}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":null!==t&&void 0!==t?t:"vega"}function Lme(e){return(t=e)&&"load"in t?e:Ame.loader(e);var t}function Pme(e){var t;return null!==(t=e.usermeta&&e.usermeta.embedOptions)&&void 0!==t?t:{}}function jme(e,t){var n;return xme(this,void 0,void 0,(0,w.Z)().mark((function r(){var a,i;return(0,w.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!xt(e.config)){r.next=8;break}return r.t1=JSON,r.next=4,t.load(e.config);case 4:r.t2=r.sent,r.t0=r.t1.parse.call(r.t1,r.t2),r.next=9;break;case 8:r.t0=null!==(n=e.config)&&void 0!==n?n:{};case 9:if(a=r.t0,!xt(e.patch)){r.next=18;break}return r.t4=JSON,r.next=14,t.load(e.patch);case 14:r.t5=r.sent,r.t3=r.t4.parse.call(r.t4,r.t5),r.next=19;break;case 18:r.t3=e.patch;case 19:return i=r.t3,r.abrupt("return",Object.assign(Object.assign(Object.assign({},e),i?{patch:i}:{}),a?{config:a}:{}));case 21:case"end":return r.stop()}}),r)})))}function Ume(e){var t,n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:null!==(t=document.head)&&void 0!==t?t:document.body}}function Wme(e,t){var n,r,a,i,o,u,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=arguments.length>3?arguments[3]:void 0;return xme(this,void 0,void 0,(0,w.Z)().mark((function l(){var f,d,h,p,v,g,m,y,b,x,_,C,S,A,E,T,N,D,F,I,M,O,R,Z,B,z,L,j,U,W,V,G,q,H,X,Y,K,$,Q;return(0,w.Z)().wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(Q=function(){L&&document.removeEventListener("click",L),M.finalize()},f=s.theme?Ee(k[s.theme],null!==(n=s.config)&&void 0!==n?n:{}):s.config,d=vt(s.actions)?s.actions:Cme({},Nme,null!==(r=s.actions)&&void 0!==r?r:{}),h=Object.assign(Object.assign({},Dme),s.i18n),p=null!==(a=s.renderer)&&void 0!==a?a:"canvas",v=null!==(i=s.logLevel)&&void 0!==i?i:Ame.Warn,g=null!==(o=s.downloadFileName)&&void 0!==o?o:"visualization",m="string"===typeof e?document.querySelector(e):e){l.next=10;break}throw new Error("".concat(e," does not exist"));case 10:return!1!==s.defaultStyle&&(y="vega-embed-style",b=Ume(m),x=b.root,_=b.rootContainer,x.getElementById(y)||((C=document.createElement("style")).id=y,C.innerText=void 0===s.defaultStyle||!0===s.defaultStyle?_me.toString():s.defaultStyle,_.appendChild(C))),S=zme(t,s.mode),A=Mme[S](t,f),"vega-lite"===S&&A.$schema&&(E=xge(A.$schema),(0,te.satisfies)(Ime.vega,"^".concat(E.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(E.version,", but current version is v").concat(Ime.vega,"."))),m.classList.add("vega-embed"),d&&m.classList.add("has-actions"),m.innerHTML="",T=m,d&&((N=document.createElement("div")).classList.add(Rme),m.appendChild(N),T=N),(D=s.patch)&&(A=D instanceof Function?D(A):P(A,D,!0,!1).newDocument),s.formatLocale&&Ame.formatLocale(s.formatLocale),s.timeFormatLocale&&Ame.timeFormatLocale(s.timeFormatLocale),F=s.ast,I=Ame.parse(A,"vega-lite"===S?{}:f,{ast:F}),M=new(s.viewClass||Ame.View)(I,Object.assign({loader:c,logLevel:v,renderer:p},F?{expr:Ame.expressionInterpreter}:{})),!1!==s.tooltip&&(O=Zme(s.tooltip)?s.tooltip:new bme(!0===s.tooltip?{}:s.tooltip).call,M.tooltip(O)),void 0===(R=s.hover)&&(R="vega"===S),R&&(B=(Z="boolean"===typeof R?{}:R).hoverSet,z=Z.updateSet,M.hover(B,z)),s&&(null!=s.width&&M.width(s.width),null!=s.height&&M.height(s.height),null!=s.padding&&M.padding(s.padding)),l.next=33,M.initialize(T,s.bind).runAsync();case 33:if(!1===d){l.next=50;break}if(j=m,!1!==s.defaultStyle&&((U=document.createElement("details")).title=h.CLICK_TO_VIEW_ACTIONS,m.append(U),j=U,(W=document.createElement("summary")).innerHTML=Ome,U.append(W),L=function(e){U.contains(e.target)||U.removeAttribute("open")},document.addEventListener("click",L)),V=document.createElement("div"),j.append(V),V.classList.add("vega-actions"),!0!==d&&!1===d.export){l.next=47;break}G=(0,w.Z)().mark((function e(){var t,n,r;return(0,w.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=H[q],(!0===d||!0===d.export||d.export[t])&&(n=h["".concat(t.toUpperCase(),"_ACTION")],(r=document.createElement("a")).text=n,r.href="#",r.target="_blank",r.download="".concat(g,".").concat(t),r.addEventListener("mousedown",(function(e){return xme(this,void 0,void 0,(0,w.Z)().mark((function n(){var r;return(0,w.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.preventDefault(),n.next=3,M.toImageURL(t,s.scaleFactor);case 3:r=n.sent,this.href=r;case 5:case"end":return n.stop()}}),n,this)})))})),V.append(r));case 2:case"end":return e.stop()}}),e)})),q=0,H=["svg","png"];case 42:if(!(q<H.length)){l.next=47;break}return l.delegateYield(G(),"t0",44);case 44:q++,l.next=42;break;case 47:!0!==d&&!1===d.source||((X=document.createElement("a")).text=h.SOURCE_ACTION,X.href="#",X.addEventListener("click",(function(e){var n,r;Bme(ee()(t),null!==(n=s.sourceHeader)&&void 0!==n?n:"",null!==(r=s.sourceFooter)&&void 0!==r?r:"",S),e.preventDefault()})),V.append(X)),"vega-lite"!==S||!0!==d&&!1===d.compiled||((Y=document.createElement("a")).text=h.COMPILED_ACTION,Y.href="#",Y.addEventListener("click",(function(e){var t,n;Bme(ee()(A),null!==(t=s.sourceHeader)&&void 0!==t?t:"",null!==(n=s.sourceFooter)&&void 0!==n?n:"","vega"),e.preventDefault()})),V.append(Y)),!0!==d&&!1===d.editor||(K=null!==(u=s.editorUrl)&&void 0!==u?u:"https://vega.github.io/editor/",($=document.createElement("a")).text=h.EDITOR_ACTION,$.href="#",$.addEventListener("click",(function(e){kme(window,K,{config:f,mode:S,renderer:p,spec:ee()(t)}),e.preventDefault()})),V.append($));case 50:return l.abrupt("return",{view:M,spec:t,vgSpec:A,finalize:Q});case 51:case"end":return l.stop()}}),l)})))}var Vme=function(e,t){var n,r,a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return xme(this,void 0,void 0,(0,w.Z)().mark((function o(){var u,s,c,l,f,d;return(0,w.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(!xt(t)){o.next=9;break}return s=Lme(i.loader),o.t0=JSON,o.next=5,s.load(t);case 5:o.t1=o.sent,u=o.t0.parse.call(o.t0,o.t1),o.next=10;break;case 9:u=t;case 10:return c=Pme(u).loader,s&&!c||(s=Lme(null!==(n=i.loader)&&void 0!==n?n:c)),o.next=14,jme(Pme(u),s);case 14:return l=o.sent,o.next=17,jme(i,s);case 17:return f=o.sent,d=Object.assign(Object.assign({},Cme(f,l)),{config:Ee(null!==(r=f.config)&&void 0!==r?r:{},null!==(a=l.config)&&void 0!==a?a:{})}),o.next=21,Wme(e,u,d,s);case 21:return o.abrupt("return",o.sent);case 22:case"end":return o.stop()}}),o)})))}},5410:function(){},8628:function(){},1601:function(){},7792:function(){},4977:function(){},5042:function(){},3897:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},5372:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},3405:function(e,t,n){var r=n(3897);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6115:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},6690:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},9728:function(e,t,n){var r=n(4062);function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,r(a.key),a)}}e.exports=function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},4704:function(e,t,n){var r=n(6116);e.exports=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){s=!0,o=e},f:function(){try{u||null==n.return||n.return()}finally{if(s)throw o}}}},e.exports.__esModule=!0,e.exports.default=e.exports},6389:function(e,t,n){var r=n(3808),a=n(9617),i=n(4993);e.exports=function(e){var t=a();return function(){var n,a=r(e);if(t){var o=r(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return i(this,n)}},e.exports.__esModule=!0,e.exports.default=e.exports},8416:function(e,t,n){var r=n(4062);e.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},3808:function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},1655:function(e,t,n){var r=n(6015);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},9617:function(e){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},3049:function(e){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},8872:function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,u=[],s=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(u.push(r.value),u.length!==t);s=!0);}catch(l){c=!0,a=l}finally{try{if(!s&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return u}},e.exports.__esModule=!0,e.exports.default=e.exports},2218:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},2281:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},4993:function(e,t,n){var r=n(8698).default,a=n(6115);e.exports=function(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)},e.exports.__esModule=!0,e.exports.default=e.exports},7061:function(e,t,n){var r=n(8698).default;function a(){"use strict";e.exports=a=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},u="function"==typeof Symbol?Symbol:{},s=u.iterator||"@@iterator",c=u.asyncIterator||"@@asyncIterator",l=u.toStringTag||"@@toStringTag";function f(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(F){f=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),u=new T(r||[]);return o(i,"_invoke",{value:C(e,n,u)}),i}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(F){return{type:"throw",arg:F}}}t.wrap=d;var p={};function v(){}function g(){}function m(){}var y={};f(y,s,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(N([])));x&&x!==n&&i.call(x,s)&&(y=x);var k=m.prototype=v.prototype=Object.create(y);function w(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function n(a,o,u,s){var c=h(e[a],e,o);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==r(f)&&i.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,u,s)}),(function(e){n("throw",e,u,s)})):t.resolve(f).then((function(e){l.value=e,u(l)}),(function(e){return n("throw",e,u,s)}))}s(c.arg)}var a;o(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(i,i):i()}})}function C(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return D()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var u=S(o,n);if(u){if(u===p)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=h(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}function S(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=h(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function N(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:D}}function D(){return{value:void 0,done:!0}}return g.prototype=m,o(k,"constructor",{value:m,configurable:!0}),o(m,"constructor",{value:g,configurable:!0}),g.displayName=f(m,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,f(e,l,"GeneratorFunction")),e.prototype=Object.create(k),e},t.awrap=function(e){return{__await:e}},w(_.prototype),f(_.prototype,c,(function(){return this})),t.AsyncIterator=_,t.async=function(e,n,r,a,i){void 0===i&&(i=Promise);var o=new _(d(e,n,r,a),i);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},w(k),f(k,l,"Generator"),f(k,s,(function(){return this})),f(k,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=N,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],o=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=i.call(a,"catchLoc"),s=i.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;E(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:N(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},t}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},6015:function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},7424:function(e,t,n){var r=n(5372),a=n(8872),i=n(6116),o=n(2218);e.exports=function(e,t){return r(e)||a(e,t)||i(e,t)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},861:function(e,t,n){var r=n(3405),a=n(3049),i=n(6116),o=n(2281);e.exports=function(e){return r(e)||a(e)||i(e)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},5036:function(e,t,n){var r=n(8698).default;e.exports=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},4062:function(e,t,n){var r=n(8698).default,a=n(5036);e.exports=function(e){var t=a(e,"string");return"symbol"===r(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},6116:function(e,t,n){var r=n(3897);e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},3333:function(e){"use strict";var t=/("(?:[^\\"]|\\.)*")|[:,]/g;e.exports=function(e,n){var r,a,i;return n=n||{},r=JSON.stringify([1],void 0,void 0===n.indent?2:n.indent).slice(2,-3),a=""===r?1/0:void 0===n.maxLength?80:n.maxLength,i=n.replacer,function e(n,o,u){var s,c,l,f,d,h,p,v,g,m,y,b;if(n&&"function"===typeof n.toJSON&&(n=n.toJSON()),void 0===(y=JSON.stringify(n,i)))return y;if(p=a-o.length-u,y.length<=p&&(g=y.replace(t,(function(e,t){return t||e+" "}))).length<=p)return g;if(null!=i&&(n=JSON.parse(y),i=void 0),"object"===typeof n&&null!==n){if(v=o+r,l=[],c=0,Array.isArray(n))for(m="[",s="]",p=n.length;c<p;c++)l.push(e(n[c],v,c===p-1?0:1)||"null");else for(m="{",s="}",p=(h=Object.keys(n)).length;c<p;c++)f=h[c],d=JSON.stringify(f)+": ",void 0!==(b=e(n[f],v,d.length+(c===p-1?0:1)))&&l.push(d+b);if(l.length>0)return[m,r+l.join(",\n"+v),s].join("\n"+o)}return y}(e,"",0)}},907:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:function(){return r}})},3878:function(e,t,n){"use strict";function r(e){if(Array.isArray(e))return e}n.d(t,{Z:function(){return r}})},7326:function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Z:function(){return r}})},5861:function(e,t,n){"use strict";function r(e,t,n,r,a,i,o){try{var u=e[i](o),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,a)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function u(e){r(o,a,i,u,s,"next",e)}function s(e){r(o,a,i,u,s,"throw",e)}u(void 0)}))}}n.d(t,{Z:function(){return a}})},5671:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{Z:function(){return r}})},5647:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(9611),a=n(8814);function i(e,t,n){return i=(0,a.Z)()?Reflect.construct.bind():function(e,t,n){var a=[null];a.push.apply(a,t);var i=new(Function.bind.apply(e,a));return n&&(0,r.Z)(i,n.prototype),i},i.apply(null,arguments)}},3144:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(9142);function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(0,r.Z)(a.key),a)}}function i(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}},7762:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(181);function a(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(0,r.Z)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return u=e.done,e},e:function(e){s=!0,o=e},f:function(){try{u||null==n.return||n.return()}finally{if(s)throw o}}}}},7277:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(1120),a=n(8814),i=n(1002),o=n(7326);function u(e,t){if(t&&("object"===(0,i.Z)(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,o.Z)(e)}function s(e){var t=(0,a.Z)();return function(){var n,a=(0,r.Z)(e);if(t){var i=(0,r.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return u(this,n)}}},4942:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(9142);function a(e,t,n){return(t=(0,r.Z)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},1752:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(1120);function a(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,r.Z)(e)););return e}function i(){return i="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=a(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},i.apply(this,arguments)}},1120:function(e,t,n){"use strict";function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n.d(t,{Z:function(){return r}})},136:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(9611);function a(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,r.Z)(e,t)}},8814:function(e,t,n){"use strict";function r(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}n.d(t,{Z:function(){return r}})},9199:function(e,t,n){"use strict";function r(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n.d(t,{Z:function(){return r}})},5267:function(e,t,n){"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{Z:function(){return r}})},4165:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(1002);function a(){a=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},u=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(D){l=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var a=t&&t.prototype instanceof p?t:p,o=Object.create(a.prototype),u=new E(r||[]);return i(o,"_invoke",{value:_(e,n,u)}),o}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(D){return{type:"throw",arg:D}}}e.wrap=f;var h={};function p(){}function v(){}function g(){}var m={};l(m,u,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(T([])));b&&b!==t&&n.call(b,u)&&(m=b);var x=g.prototype=p.prototype=Object.create(m);function k(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function a(i,o,u,s){var c=d(e[i],e,o);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==(0,r.Z)(f)&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){a("next",e,u,s)}),(function(e){a("throw",e,u,s)})):t.resolve(f).then((function(e){l.value=e,u(l)}),(function(e){return a("throw",e,u,s)}))}s(c.arg)}var o;i(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){a(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function _(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return N()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var u=C(o,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=d(e,t,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===h)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}function C(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,C(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var a=d(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,h;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function T(e){if(e){var t=e[u];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:N}}function N(){return{value:void 0,done:!0}}return v.prototype=g,i(x,"constructor",{value:g,configurable:!0}),i(g,"constructor",{value:v,configurable:!0}),v.displayName=l(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,c,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},k(w.prototype),l(w.prototype,s,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new w(f(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},k(x),l(x,c,"Generator"),l(x,u,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=T,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;A(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},e}},9611:function(e,t,n){"use strict";function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}n.d(t,{Z:function(){return r}})},9439:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(3878);var a=n(181),i=n(5267);function o(e,t){return(0,r.Z)(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,u=[],s=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(u.push(r.value),u.length!==t);s=!0);}catch(l){c=!0,a=l}finally{try{if(!s&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw a}}return u}}(e,t)||(0,a.Z)(e,t)||(0,i.Z)()}},4506:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(3878),a=n(9199),i=n(181),o=n(5267);function u(e){return(0,r.Z)(e)||(0,a.Z)(e)||(0,i.Z)(e)||(0,o.Z)()}},3433:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(907);var a=n(9199),i=n(181);function o(e){return function(e){if(Array.isArray(e))return(0,r.Z)(e)}(e)||(0,a.Z)(e)||(0,i.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},9142:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(1002);function a(e){var t=function(e,t){if("object"!==(0,r.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==(0,r.Z)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,r.Z)(t)?t:String(t)}},1002:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{Z:function(){return r}})},181:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(907);function a(e,t){if(e){if("string"===typeof e)return(0,r.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(e,t):void 0}}},8664:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(1120),a=n(9611);var i=n(5647);function o(e){var t="function"===typeof Map?new Map:void 0;return o=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return(0,i.Z)(e,arguments,(0,r.Z)(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),(0,a.Z)(o,e)},o(e)}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var i=Object.create(null);n.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var u=2&a&&r;"object"==typeof u&&!~e.indexOf(u);u=t(u))Object.getOwnPropertyNames(u).forEach((function(e){o[e]=function(){return r[e]}}));return o.default=function(){return r},n.d(i,o),i}}(),n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},n.p="/soma-portal/",function(){"use strict";var e,t=n(2791),r=n.t(t,2),a=n(1250),i=n(9439),o=n(3433),u=n(5671),s=n(3144),c=n(136),l=n(7277),f=n(8664),d=n(4506),h=n(7762);function p(){return p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},p.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(e||(e={}));var v,g="popstate";function m(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function y(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function b(e,t){return{usr:e.state,key:e.key,idx:t}}function x(e,t,n,r){return void 0===n&&(n=null),p({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?w(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function k(e){var t=e.pathname,n=void 0===t?"/":t,r=e.search,a=void 0===r?"":r,i=e.hash,o=void 0===i?"":i;return a&&"?"!==a&&(n+="?"===a.charAt(0)?a:"?"+a),o&&"#"!==o&&(n+="#"===o.charAt(0)?o:"#"+o),n}function w(e){var t={};if(e){var n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));var r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function _(t,n,r,a){void 0===a&&(a={});var i=a,o=i.window,u=void 0===o?document.defaultView:o,s=i.v5Compat,c=void 0!==s&&s,l=u.history,f=e.Pop,d=null,h=v();function v(){return(l.state||{idx:null}).idx}function y(){f=e.Pop;var t=v(),n=null==t?null:t-h;h=t,d&&d({action:f,location:_.location,delta:n})}function w(e){var t="null"!==u.location.origin?u.location.origin:u.location.href,n="string"===typeof e?e:k(e);return m(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==h&&(h=0,l.replaceState(p({},l.state,{idx:h}),""));var _={get action(){return f},get location(){return t(u,l)},listen:function(e){if(d)throw new Error("A history only accepts one active listener");return u.addEventListener(g,y),d=e,function(){u.removeEventListener(g,y),d=null}},createHref:function(e){return n(u,e)},createURL:w,encodeLocation:function(e){var t=w(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(t,n){f=e.Push;var a=x(_.location,t,n);r&&r(a,t);var i=b(a,h=v()+1),o=_.createHref(a);try{l.pushState(i,"",o)}catch(s){u.location.assign(o)}c&&d&&d({action:f,location:_.location,delta:1})},replace:function(t,n){f=e.Replace;var a=x(_.location,t,n);r&&r(a,t);var i=b(a,h=v()),o=_.createHref(a);l.replaceState(i,"",o),c&&d&&d({action:f,location:_.location,delta:0})},go:function(e){return l.go(e)}};return _}function C(e,t,n){void 0===n&&(n="/");var r=M(("string"===typeof t?w(t):t).pathname||"/",n);if(null==r)return null;var a=S(e);!function(e){e.sort((function(e,t){return e.score!==t.score?t.score-e.score:function(e,t){var n=e.length===t.length&&e.slice(0,-1).every((function(e,n){return e===t[n]}));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((function(e){return e.childrenIndex})),t.routesMeta.map((function(e){return e.childrenIndex})))}))}(a);for(var i=null,o=0;null==i&&o<a.length;++o)i=D(a[o],I(r));return i}function S(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");var a=function(e,a,i){var o={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};o.relativePath.startsWith("/")&&(m(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));var u=z([r,o.relativePath]),s=n.concat(o);e.children&&e.children.length>0&&(m(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+u+'".'),S(e.children,t,s,u)),(null!=e.path||e.index)&&t.push({path:u,score:N(u,e.index),routesMeta:s})};return e.forEach((function(e,t){var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?")){var r,i=(0,h.Z)(A(e.path));try{for(i.s();!(r=i.n()).done;){var o=r.value;a(e,t,o)}}catch(u){i.e(u)}finally{i.f()}}else a(e,t)})),t}function A(e){var t=e.split("/");if(0===t.length)return[];var n=(0,d.Z)(t),r=n[0],a=n.slice(1),i=r.endsWith("?"),u=r.replace(/\?$/,"");if(0===a.length)return i?[u,""]:[u];var s=A(a.join("/")),c=[];return c.push.apply(c,(0,o.Z)(s.map((function(e){return""===e?u:[u,e].join("/")})))),i&&c.push.apply(c,(0,o.Z)(s)),c.map((function(t){return e.startsWith("/")&&""===t?"/":t}))}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(v||(v={}));var E=/^:\w+$/,T=function(e){return"*"===e};function N(e,t){var n=e.split("/"),r=n.length;return n.some(T)&&(r+=-2),t&&(r+=2),n.filter((function(e){return!T(e)})).reduce((function(e,t){return e+(E.test(t)?3:""===t?1:10)}),r)}function D(e,t){for(var n=e.routesMeta,r={},a="/",i=[],o=0;o<n.length;++o){var u=n[o],s=o===n.length-1,c="/"===a?t:t.slice(a.length)||"/",l=F({path:u.relativePath,caseSensitive:u.caseSensitive,end:s},c);if(!l)return null;Object.assign(r,l.params);var f=u.route;i.push({params:r,pathname:z([a,l.pathname]),pathnameBase:L(z([a,l.pathnameBase])),route:f}),"/"!==l.pathnameBase&&(a=z([a,l.pathnameBase]))}return i}function F(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});var n=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);O("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');var r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(function(e,t){return r.push(t),"/([^\\/]+)"}));e.endsWith("*")?(r.push("*"),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))");var i=new RegExp(a,t?void 0:"i");return[i,r]}(e.path,e.caseSensitive,e.end),r=(0,i.Z)(n,2),a=r[0],o=r[1],u=t.match(a);if(!u)return null;var s=u[0],c=s.replace(/(.)\/+$/,"$1"),l=u.slice(1);return{params:o.reduce((function(e,t,n){if("*"===t){var r=l[n]||"";c=s.slice(0,s.length-r.length).replace(/(.)\/+$/,"$1")}return e[t]=function(e,t){try{return decodeURIComponent(e)}catch(n){return O(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+n+")."),e}}(l[n]||"",t),e}),{}),pathname:s,pathnameBase:c,pattern:e}}function I(e){try{return decodeURI(e)}catch(t){return O(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function M(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;var n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function O(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function R(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function Z(e){return e.filter((function(e,t){return 0===t||e.route.path&&e.route.path.length>0}))}function B(e,t,n,r){var a;void 0===r&&(r=!1),"string"===typeof e?a=w(e):(m(!(a=p({},e)).pathname||!a.pathname.includes("?"),R("?","pathname","search",a)),m(!a.pathname||!a.pathname.includes("#"),R("#","pathname","hash",a)),m(!a.search||!a.search.includes("#"),R("#","search","hash",a)));var i,o=""===e||""===a.pathname,u=o?"/":a.pathname;if(r||null==u)i=n;else{var s=t.length-1;if(u.startsWith("..")){for(var c=u.split("/");".."===c[0];)c.shift(),s-=1;a.pathname=c.join("/")}i=s>=0?t[s]:"/"}var l=function(e,t){void 0===t&&(t="/");var n="string"===typeof e?w(e):e,r=n.pathname,a=n.search,i=void 0===a?"":a,o=n.hash,u=void 0===o?"":o,s=r?r.startsWith("/")?r:function(e,t){var n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((function(e){".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(r,t):t;return{pathname:s,search:P(i),hash:j(u)}}(a,i),f=u&&"/"!==u&&u.endsWith("/"),d=(o||"."===u)&&n.endsWith("/");return l.pathname.endsWith("/")||!f&&!d||(l.pathname+="/"),l}var z=function(e){return e.join("/").replace(/\/\/+/g,"/")},L=function(e){return e.replace(/\/+$/,"").replace(/^\/*/,"/")},P=function(e){return e&&"?"!==e?e.startsWith("?")?e:"?"+e:""},j=function(e){return e&&"#"!==e?e.startsWith("#")?e:"#"+e:""},U=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n)}((0,f.Z)(Error));function W(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var V=["post","put","patch","delete"],G=(new Set(V),["get"].concat(V));new Set(G),new Set([301,302,303,307,308]),new Set([307,308]),"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;Symbol("deferred");function q(){return q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},q.apply(this,arguments)}var H="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},X=t.useState,Y=t.useEffect,K=t.useLayoutEffect,$=t.useDebugValue;function Q(e){var t=e.getSnapshot,n=e.value;try{var r=t();return!H(n,r)}catch(a){return!0}}"undefined"===typeof window||"undefined"===typeof window.document||window.document.createElement,r.useSyncExternalStore;var J=t.createContext(null);var ee=t.createContext(null);var te=t.createContext(null);var ne=t.createContext(null);var re=t.createContext(null);var ae=t.createContext({outlet:null,matches:[]});var ie=t.createContext(null);function oe(){return null!=t.useContext(re)}function ue(){return oe()||m(!1),t.useContext(re).location}function se(){oe()||m(!1);var e=t.useContext(ne),n=e.basename,r=e.navigator,a=t.useContext(ae).matches,i=ue().pathname,o=JSON.stringify(Z(a).map((function(e){return e.pathnameBase}))),u=t.useRef(!1);t.useEffect((function(){u.current=!0}));var s=t.useCallback((function(e,t){if(void 0===t&&(t={}),u.current)if("number"!==typeof e){var a=B(e,JSON.parse(o),i,"path"===t.relative);"/"!==n&&(a.pathname="/"===a.pathname?n:z([n,a.pathname])),(t.replace?r.replace:r.push)(a,t.state,t)}else r.go(e)}),[n,r,o,i]);return s}function ce(e,n){var r=(void 0===n?{}:n).relative,a=t.useContext(ae).matches,i=ue().pathname,o=JSON.stringify(Z(a).map((function(e){return e.pathnameBase})));return t.useMemo((function(){return B(e,JSON.parse(o),i,"path"===r)}),[e,o,i,r])}function le(){var e=function(){var e,n=t.useContext(ie),r=ge(de.UseRouteError),a=me(de.UseRouteError);if(n)return n;return null==(e=r.errors)?void 0:e[a]}(),n=W(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:a};return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},n),r?t.createElement("pre",{style:i},r):null,null)}var fe,de,he=function(e){(0,c.Z)(r,e);var n=(0,l.Z)(r);function r(e){var t;return(0,u.Z)(this,r),(t=n.call(this,e)).state={location:e.location,error:e.error},t}return(0,s.Z)(r,[{key:"componentDidCatch",value:function(e,t){console.error("React Router caught the following error during render",e,t)}},{key:"render",value:function(){return this.state.error?t.createElement(ae.Provider,{value:this.props.routeContext},t.createElement(ie.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}},{key:"getDerivedStateFromProps",value:function(e,t){return t.location!==e.location?{error:e.error,location:e.location}:{error:e.error||t.error,location:t.location}}}]),r}(t.Component);function pe(e){var n=e.routeContext,r=e.match,a=e.children,i=t.useContext(J);return i&&i.static&&i.staticContext&&r.route.errorElement&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),t.createElement(ae.Provider,{value:n},a)}function ve(e,n,r){if(void 0===n&&(n=[]),null==e){if(null==r||!r.errors)return null;e=r.matches}var a=e,i=null==r?void 0:r.errors;if(null!=i){var o=a.findIndex((function(e){return e.route.id&&(null==i?void 0:i[e.route.id])}));o>=0||m(!1),a=a.slice(0,Math.min(a.length,o+1))}return a.reduceRight((function(e,o,u){var s=o.route.id?null==i?void 0:i[o.route.id]:null,c=r?o.route.errorElement||t.createElement(le,null):null,l=n.concat(a.slice(0,u+1)),f=function(){return t.createElement(pe,{match:o,routeContext:{outlet:e,matches:l}},s?c:void 0!==o.route.element?o.route.element:e)};return r&&(o.route.errorElement||0===u)?t.createElement(he,{location:r.location,component:c,error:s,children:f(),routeContext:{outlet:null,matches:l}}):f()}),null)}function ge(e){var n=t.useContext(ee);return n||m(!1),n}function me(e){var n=function(e){var n=t.useContext(ae);return n||m(!1),n}(),r=n.matches[n.matches.length-1];return r.route.id||m(!1),r.route.id}!function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator"}(fe||(fe={})),function(e){e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator"}(de||(de={}));var ye;function be(e){var n=e.to,r=e.replace,a=e.state,i=e.relative;oe()||m(!1);var o=t.useContext(ee),u=se();return t.useEffect((function(){o&&"idle"!==o.navigation.state||u(n,{replace:r,state:a,relative:i})})),null}function xe(e){m(!1)}function ke(n){var r=n.basename,a=void 0===r?"/":r,i=n.children,o=void 0===i?null:i,u=n.location,s=n.navigationType,c=void 0===s?e.Pop:s,l=n.navigator,f=n.static,d=void 0!==f&&f;oe()&&m(!1);var h=a.replace(/^\/*/,"/"),p=t.useMemo((function(){return{basename:h,navigator:l,static:d}}),[h,l,d]);"string"===typeof u&&(u=w(u));var v=u,g=v.pathname,y=void 0===g?"/":g,b=v.search,x=void 0===b?"":b,k=v.hash,_=void 0===k?"":k,C=v.state,S=void 0===C?null:C,A=v.key,E=void 0===A?"default":A,T=t.useMemo((function(){var e=M(y,h);return null==e?null:{pathname:e,search:x,hash:_,state:S,key:E}}),[h,y,x,_,S,E]);return null==T?null:t.createElement(ne.Provider,{value:p},t.createElement(re.Provider,{children:o,value:{location:T,navigationType:c}}))}function we(n){var r=n.children,a=n.location,i=t.useContext(J);return function(n,r){oe()||m(!1);var a,i=t.useContext(ne).navigator,o=t.useContext(ee),u=t.useContext(ae).matches,s=u[u.length-1],c=s?s.params:{},l=(s&&s.pathname,s?s.pathnameBase:"/"),f=(s&&s.route,ue());if(r){var d,h="string"===typeof r?w(r):r;"/"===l||(null==(d=h.pathname)?void 0:d.startsWith(l))||m(!1),a=h}else a=f;var p=a.pathname||"/",v=C(n,{pathname:"/"===l?p:p.slice(l.length)||"/"}),g=ve(v&&v.map((function(e){return Object.assign({},e,{params:Object.assign({},c,e.params),pathname:z([l,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?l:z([l,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})})),u,o||void 0);return r&&g?t.createElement(re.Provider,{value:{location:q({pathname:"/",search:"",hash:"",state:null,key:"default"},a),navigationType:e.Pop}},g):g}(i&&!r?i.router.routes:Ce(r),a)}!function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"}(ye||(ye={}));var _e=new Promise((function(){}));t.Component;function Ce(e,n){void 0===n&&(n=[]);var r=[];return t.Children.forEach(e,(function(e,a){if(t.isValidElement(e))if(e.type!==t.Fragment){e.type!==xe&&m(!1),e.props.index&&e.props.children&&m(!1);var i=[].concat((0,o.Z)(n),[a]),u={id:e.props.id||i.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,hasErrorBoundary:null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle};e.props.children&&(u.children=Ce(e.props.children,i)),r.push(u)}else r.push.apply(r,Ce(e.props.children,n))})),r}function Se(){return Se=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Se.apply(this,arguments)}function Ae(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}var Ee=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],Te=["aria-current","caseSensitive","className","end","style","to","children"];function Ne(e){var n=e.basename,r=e.children,a=e.window,o=t.useRef();null==o.current&&(o.current=function(e){return void 0===e&&(e={}),_((function(e,t){var n=w(e.location.hash.substr(1)),r=n.pathname,a=void 0===r?"/":r,i=n.search,o=void 0===i?"":i,u=n.hash;return x("",{pathname:a,search:o,hash:void 0===u?"":u},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){var n=e.document.querySelector("base"),r="";if(n&&n.getAttribute("href")){var a=e.location.href,i=a.indexOf("#");r=-1===i?a:a.slice(0,i)}return r+"#"+("string"===typeof t?t:k(t))}),(function(e,t){y("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push("+JSON.stringify(t)+")")}),e)}({window:a,v5Compat:!0}));var u=o.current,s=t.useState({action:u.action,location:u.location}),c=(0,i.Z)(s,2),l=c[0],f=c[1];return t.useLayoutEffect((function(){return u.listen(f)}),[u]),t.createElement(ke,{basename:n,children:r,location:l.location,navigationType:l.action,navigator:u})}var De="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Fe=t.forwardRef((function(e,n){var r=e.onClick,a=e.relative,i=e.reloadDocument,o=e.replace,u=e.state,s=e.target,c=e.to,l=e.preventScrollReset,f=Ae(e,Ee),d="string"===typeof c?c:k(c),h=/^[a-z+]+:\/\//i.test(d)||d.startsWith("//"),p=d,v=!1;if(De&&h){var g=new URL(window.location.href),y=d.startsWith("//")?new URL(g.protocol+d):new URL(d);y.origin===g.origin?p=y.pathname+y.search+y.hash:v=!0}var b=function(e,n){var r=(void 0===n?{}:n).relative;oe()||m(!1);var a=t.useContext(ne),i=a.basename,o=a.navigator,u=ce(e,{relative:r}),s=u.hash,c=u.pathname,l=u.search,f=c;return"/"!==i&&(f="/"===c?i:z([i,c])),o.createHref({pathname:f,search:l,hash:s})}(p,{relative:a}),x=function(e,n){var r=void 0===n?{}:n,a=r.target,i=r.replace,o=r.state,u=r.preventScrollReset,s=r.relative,c=se(),l=ue(),f=ce(e,{relative:s});return t.useCallback((function(t){if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,a)){t.preventDefault();var n=void 0!==i?i:k(l)===k(f);c(e,{replace:n,state:o,preventScrollReset:u,relative:s})}}),[l,c,f,i,o,a,e,u,s])}(p,{replace:o,state:u,target:s,preventScrollReset:l,relative:a});return t.createElement("a",Se({},f,{href:h?d:b,onClick:v||i?r:function(e){r&&r(e),e.defaultPrevented||x(e)},ref:n,target:s}))}));var Ie=t.forwardRef((function(e,n){var r=e["aria-current"],a=void 0===r?"page":r,i=e.caseSensitive,o=void 0!==i&&i,u=e.className,s=void 0===u?"":u,c=e.end,l=void 0!==c&&c,f=e.style,d=e.to,h=e.children,p=Ae(e,Te),v=ce(d,{relative:p.relative}),g=ue(),m=t.useContext(ee),y=t.useContext(ne).navigator,b=y.encodeLocation?y.encodeLocation(v).pathname:v.pathname,x=g.pathname,k=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;o||(x=x.toLowerCase(),k=k?k.toLowerCase():null,b=b.toLowerCase());var w,_=x===b||!l&&x.startsWith(b)&&"/"===x.charAt(b.length),C=null!=k&&(k===b||!l&&k.startsWith(b)&&"/"===k.charAt(b.length)),S=_?a:void 0;w="function"===typeof s?s({isActive:_,isPending:C}):[s,_?"active":null,C?"pending":null].filter(Boolean).join(" ");var A="function"===typeof f?f({isActive:_,isPending:C}):f;return t.createElement(Fe,Se({},p,{"aria-current":S,className:w,ref:n,style:A,to:d}),"function"===typeof h?h({isActive:_,isPending:C}):h)}));var Me,Oe;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(Me||(Me={})),function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Oe||(Oe={}));var Re=n(4341),Ze=n(2145),Be=n(9118),ze=n(651),Le=n(4031),Pe={kernelName:Ze.SYM,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,ze.d)(e,(0,Le.N)((0,Be.p)(n,"float32"),-1))}}}},je=n(5750),Ue=n(4362),We=n(7067),Ve=n(6902),Ge=n(7391),qe=n(4774),He={kernelName:Ze.VGw,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){var t=(0,Ge.h)((0,Be.p)(n,"float32")),r=(0,Ve._)((0,qe.l)((0,We.i)(1),t));return(0,Ue.W)((0,je.h)(e,r))}}}},Xe={kernelName:Ze.SpW,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){var t=(0,Ve._)((0,qe.l)((0,Ge.h)((0,Be.p)(n,"float32")),1));return(0,je.h)(e,t)}}}},Ye=n(5774),Ke=n(5561),$e=n(227),Qe={kernelName:Ze.mm_,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,i.Z)(t,2),r=n[0],a=n[1],o=Ye.assertAndGetBroadcastShape(r.shape,a.shape);return{a:function(){var t=e,n=Ye.getReductionAxes(r.shape,o);return n.length>0&&(t=(0,$e.S)(t,n)),(0,Ke.X)(t,r.shape)},b:function(){var t=e,n=Ye.getReductionAxes(a.shape,o);return n.length>0&&(t=(0,$e.S)(t,n)),(0,Ke.X)(t,a.shape)}}}},Je={kernelName:Ze.Xze,saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}},et=n(7293),tt={kernelName:Ze.sJF,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,et.P)(n)}}}},nt={kernelName:Ze.aJk,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,et.P)(n)}}}},rt={kernelName:Ze.M2y,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,je.h)(e,(0,Ve._)((0,qe.l)((0,We.i)(1),(0,Ge.h)((0,Be.p)(n,"float32")))))}}}},at=n(3312),it={kernelName:Ze.qw7,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){var t=(0,Ve._)((0,at.I)((0,We.i)(1),(0,Ge.h)((0,Be.p)(n,"float32"))));return(0,je.h)(e,t)}}}},ot={kernelName:Ze.QCc,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,i.Z)(t,2),r=n[0],a=n[1],o=(0,Ye.assertAndGetBroadcastShape)(r.shape,a.shape);return{a:function(){var t=(0,at.I)((0,Ge.h)(r),(0,Ge.h)(a)),n=(0,ze.d)(e,(0,je.h)(a,t)),i=(0,Ye.getReductionAxes)(r.shape,o);return i.length>0&&(n=(0,$e.S)(n,i)),(0,Ke.X)(n,r.shape)},b:function(){var t=(0,at.I)((0,Ge.h)(r),(0,Ge.h)(a)),n=(0,Ue.W)((0,ze.d)(e,(0,je.h)(r,t))),i=(0,Ye.getReductionAxes)(a.shape,o);return i.length>0&&(n=(0,$e.S)(n,i)),(0,Ke.X)(n,a.shape)}}}},ut={kernelName:Ze.jMg,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,je.h)(e,(0,at.I)((0,Ge.h)((0,Be.p)(n,"float32")),1))}}}},st={kernelName:Ze.Oyi,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,je.h)(e,(0,qe.l)((0,We.i)(1),(0,Ge.h)((0,Be.p)(n,"float32"))))}}}},ct=n(318),lt=n(8354),ft=n(6147),dt=n(9151),ht=n(8640);var pt=(0,ht.op)({avgPool3dGrad_:function(e,t,n,r,a,i){var o=(0,lt._1)(e,"dy","avgPool3dGrad"),u=(0,lt._1)(t,"input","avgPool3dGrad"),s=o,c=u,l=!1;4===u.rank&&(l=!0,s=(0,Ke.X)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=(0,Ke.X)(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),ft.hu(5===s.rank,(function(){return"Error in avgPool3dGrad: dy must be rank 5 but got rank "+"".concat(s.rank,".")})),ft.hu(5===c.rank,(function(){return"Error in avgPool3dGrad: input must be rank 5 but got rank "+"".concat(c.rank,".")})),(0,dt.m)("avgPool3dGrad",a,i);var f={dy:s,input:c},d={filterSize:n,strides:r,pad:a,dimRoundingMode:i},h=ct.BV.runKernel(Ze.IMb,f,d);return l?(0,Ke.X)(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}}),vt={kernelName:Ze._k9,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,i.Z)(t,1)[0],a=n.filterSize,o=n.strides,u=n.pad,s=n.dimRoundingMode;return{x:function(){return pt(e,r,a,o,u,s)}}}};var gt=(0,ht.op)({avgPoolGrad_:function(e,t,n,r,a){var i=(0,lt._1)(e,"dy","avgPoolGrad"),o=(0,lt._1)(t,"input","avgPoolGrad");ft.hu(o.rank===i.rank,(function(){return"Rank of input (".concat(o.rank,") does not match rank of dy (").concat(i.rank,")")}));var u=o,s=i,c=!1;3===o.rank&&(c=!0,u=(0,Ke.X)(o,[1,o.shape[0],o.shape[1],o.shape[2]]),s=(0,Ke.X)(i,[1,i.shape[0],i.shape[1],i.shape[2]])),ft.hu(4===s.rank,(function(){return"Error in avgPoolGrad: dy must be rank 4 but got rank "+"".concat(s.rank,".")})),ft.hu(4===u.rank,(function(){return"Error in avgPoolGrad: input must be rank 4 but got rank "+"".concat(u.rank,".")}));var l={dy:s,input:u},f={filterSize:n,strides:r,pad:a},d=ct.BV.runKernel(Ze.ROF,l,f);return c?(0,Ke.X)(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),mt={kernelName:Ze.JhU,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,i.Z)(t,1)[0],a=n.filterSize,o=n.strides,u=n.pad;return{x:function(){return gt(e,r,a,o,u)}}}},yt=n(7221),bt={kernelName:Ze.XLW,inputsToSave:["a","b"],gradFunc:function(e,t,n){var r=(0,i.Z)(t,2),a=r[0],o=r[1],u=n.transposeA,s=n.transposeB;return u||s?!u&&s?{a:function(){return(0,yt.O)(e,o,!1,!1)},b:function(){return(0,yt.O)(e,a,!0,!1)}}:u&&!s?{a:function(){return(0,yt.O)(o,e,!1,!0)},b:function(){return(0,yt.O)(a,e,!1,!1)}}:{a:function(){return(0,yt.O)(o,e,!0,!0)},b:function(){return(0,yt.O)(e,a,!0,!0)}}:{a:function(){return(0,yt.O)(e,o,!1,!0)},b:function(){return(0,yt.O)(a,e,!0,!1)}}}},xt=n(5696),kt={kernelName:Ze.zws,gradFunc:function(e,t,n){var r=n.blockShape,a=n.crops;return{x:function(){return(0,xt.f)(e,r,a)}}}},wt={kernelName:Ze.Ly9,gradFunc:function(e,t,n){for(var r=n,a=r.inputShape,i=r.shape,o=Array.from(i),u=a.length-1;u>=0;u--)if(a[u]===i[u])o[u]=1;else if(1!==a[u])throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(i,"]."));for(var s=[],c=0;c<o.length;c++)o[c]>1&&s.push(c);return{x:function(){return(0,$e.S)(e,s,!0)}}}},_t={kernelName:Ze.RFZ,gradFunc:function(e){return{x:function(){return e.clone()}}}},Ct={kernelName:Ze.gJX,gradFunc:function(e){return{x:function(){return(0,et.P)(e)}}}},St=n(8327),At=n(2642),Et=n(2177),Tt=n(329),Nt={kernelName:Ze.xnO,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,i.Z)(t,1)[0],a=n.clipValueMin,o=n.clipValueMax;return{x:function(){return(0,Tt.a)((0,Et.H)((0,St.b)(r,a),(0,At.z)(r,o)),e,(0,et.P)(e))}}}},Dt={kernelName:Ze.yj2,inputsToSave:["x"],gradFunc:Pe.gradFunc},Ft=n(2588),It={kernelName:Ze.Eh3,saveAllInputs:!0,gradFunc:function(e,t,n){var r=t.map((function(e){return e.shape})),a=n.axis,i=(0,ft.EC)(a,t[0].shape)[0],o=r.map((function(e){return e[i]}));return(0,Ft.V)(e,o,i).map((function(e){return function(){return e}}))}},Mt=n(8744),Ot=n(1045),Rt={kernelName:Ze.mhS,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=(0,i.Z)(t,2),a=r[0],o=r[1],u=n.dilations,s=n.strides,c=n.pad,l=n.dataFormat;return ft.hu(dt.I0(u),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(u,"'")})),{x:function(){return(0,Ot._)(a.shape,e,o,s,c,l)},filter:function(){return(0,Mt.p)(a,e,o.shape,s,c,l)}}}},Zt=n(3457),Bt={kernelName:Ze.wm,inputsToSave:["dy","filter"],gradFunc:function(e,t,n){var r=(0,i.Z)(t,2),a=r[0],o=r[1],u=n.strides,s=n.pad,c=n.dataFormat,l=n.dimRoundingMode;return{dy:function(){return(0,Zt.T)(e,o,u,s,c,1,l)},filter:function(){return(0,Mt.p)(e,a,o.shape,u,s,c,l)}}}};var zt=(0,ht.op)({conv3DBackpropFilter_:function(e,t,n,r,a){var i=e;4===e.rank&&(i=(0,Ke.X)(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));var o=t;4===o.rank&&(o=(0,Ke.X)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),ft.hu(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(i.shape,".")})),ft.hu(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(o.shape,".")})),ft.hu(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")})),ft.hu(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input ".concat(i.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")})),ft.hu(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")}));var u={x:i,dy:o},s={strides:r,pad:a,filterShape:n};return ct.BV.runKernel(Ze.o2y,u,s)}}),Lt=n(1873),Pt={kernelName:Ze.x12,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,o=n.pad;ft.hu((0,dt.I0)(r),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'")}));var u=(0,i.Z)(t,2),s=u[0],c=u[1];return{x:function(){return(0,Lt._)(s.shape,e,c,a,o)},filter:function(){return zt(s,e,c.shape,a,o)}}}},jt=n(7254),Ut={kernelName:Ze.mc4,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,ze.d)((0,Ue.W)((0,jt.O)((0,Be.p)(n,"float32"))),e)}}}},Wt=n(7657),Vt={kernelName:Ze.TR1,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,ze.d)((0,Wt.R)((0,Be.p)(n,"float32")),e)}}}},Gt=n(8473),qt=n(8862),Ht=n(1240),Xt={kernelName:Ze.iHb,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,i.Z)(t,1)[0],a=n.axis,o=n.exclusive,u=n.reverse;return{x:function(){var t=(0,Gt.Q3)([a],r.rank),n=(0,qt.z)(e,a,o,!u);return null!=t&&(n=(0,Ht.p)(n,t)),n}}}},Yt=n(288),Kt=n(6939),$t={kernelName:Ze.cie,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,o=n.pad,u=n.dimRoundingMode,s=null==r?[1,1]:r;ft.hu(dt.I0(s),(function(){return"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'")}));var c=(0,i.Z)(t,2),l=c[0],f=c[1];return ft.hu(4===l.rank,(function(){return"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(l.rank,".")})),ft.hu(4===f.rank,(function(){return"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(f.rank,".")})),ft.hu(l.shape[3]===f.shape[2],(function(){return"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(l.shape[3],") must match the inChannels dimension ")+"in filter ".concat(f.shape[2],".")})),ft.hu(dt.jT(a,s),(function(){return"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(a," and dilations ")+"'".concat(s,"'.")})),dt.m("depthwiseConv2d",o,u),{x:function(){return(0,Kt.v)(l.shape,e,f,a,o,s,u)},filter:function(){return(0,Yt.z)(l,e,f.shape,a,o,s,u)}}}},Qt={kernelName:Ze.p4S,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=(0,i.Z)(t,2),a=r[0],o=r[1],u={x:a,filter:o,dy:e},s={x:a,filter:o,dy:e};return{x:function(){return ct.BV.runKernel(Ze.ekb,u,n)},filter:function(){return ct.BV.runKernel(Ze.Vn9,s,n)}}}},Jt={kernelName:Ze.SX0,outputsToSave:[!0],gradFunc:function(e,t){var n={dy:e,y:(0,i.Z)(t,1)[0]};return{x:function(){return ct.BV.runKernel(Ze.HEU,n)}}}},en=n(411),tn={kernelName:Ze.Omj,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0],r=(0,ze.d)((0,en.Q)((0,Ue.W)((0,Ge.h)(n))),2/Math.sqrt(Math.PI));return{x:function(){return(0,ze.d)(e,r)}}}},nn={kernelName:Ze.NEP,outputsToSave:[!0],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,ze.d)(e,n)}}}},rn={kernelName:Ze.YFo,inputsToSave:["input"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{input:function(){return(0,Ke.X)(e,n.shape)}}}},an={kernelName:Ze.Y0y,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,ze.d)(e,(0,en.Q)(n))}}}},on={kernelName:Ze.OR,gradFunc:function(e){return{x:function(){return(0,et.P)(e)}}}},un={kernelName:Ze.jeX,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,i.Z)(t,2),r=n[0],a=n[1],o=(0,Ye.assertAndGetBroadcastShape)(r.shape,a.shape);return{a:function(){var t=(0,je.h)(e,(0,Be.p)(a,"float32")),n=(0,Ye.getReductionAxes)(r.shape,o);return n.length>0?(0,Ke.X)((0,$e.S)(t,n),r.shape):t},b:function(){var t=(0,ze.d)(e,(0,Be.p)(r,"float32")),n=(0,Ye.getReductionAxes)(a.shape,o);n.length>0&&(t=(0,Ke.X)((0,$e.S)(t,n),a.shape));var i=(0,Ge.h)(a);return(0,Ue.W)((0,je.h)(t,(0,Be.p)(i,"float32")))}}}},sn=n(5115),cn=n(2343),ln={kernelName:Ze.sHE,inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,a=(0,i.Z)(t,4),o=a[0],u=a[1],s=a[2],c=a[3],l=null==c?(0,We.i)(1):c,f=(0,Ye.getReductionAxes)(u.shape,o.shape),d=[];if(1===u.rank){for(var h=0;h<o.shape.length-1;++h)d.push(o.shape[h]);d.push(1)}var p=(0,qe.l)(o,u),v=(0,ze.d)(e,l),g=(0,sn.b)((0,at.I)(s,(0,We.i)(r))),m=(0,ze.d)((0,ze.d)((0,ze.d)(g,g),g),(0,We.i)(-.5));return{x:function(){return 1===u.rank?(0,Ke.X)((0,ze.d)((0,ze.d)(e,(0,cn.G)((0,Ke.X)(g,[1,1,1,u.shape[0]]),d)),l),o.shape):(0,Ke.X)((0,ze.d)((0,ze.d)(e,g),l),o.shape)},mean:function(){var e=(0,ze.d)((0,ze.d)(g,(0,We.i)(-1)),v);return 1===u.rank&&(e=(0,$e.S)(e,f)),(0,Ke.X)(e,u.shape)},variance:function(){var e=(0,ze.d)((0,ze.d)(m,p),v);return 1===u.rank&&(e=(0,$e.S)(e,f)),(0,Ke.X)(e,u.shape)},scale:function(){var t=(0,ze.d)(p,g),n=(0,ze.d)(e,t);return 1===u.rank&&(n=(0,$e.S)(n,f)),(0,Ke.X)(n,u.shape)},offset:function(){var t=e;return 1===u.rank&&(t=(0,$e.S)(t,f)),(0,Ke.X)(t,u.shape)}}}},fn=n(6918),dn={kernelName:Ze.qi_,inputsToSave:["x","indices"],gradFunc:function(e,t,n){var r=(0,i.Z)(t,2),a=r[0],o=r[1],u=n.axis,s=(0,ft.EC)(u,a.shape)[0];return{x:function(){var t=a.shape,n=o.size,r=t.slice(0,s),i=r.length,c=t.slice(u,t.length).slice(1),l=c.length,f=hn(0,i),d=hn(i+1,i+1+l),h=pn([r,[n],c]),p=(0,Ke.X)(e,h),v=(0,Ke.X)(o,[n]),g=pn([[i],f,d]),m=(0,Ht.p)(p,g),y=(0,fn.p)(m,v,a.shape[s]),b=(0,Gt.LJ)(g);return y=(0,Ht.p)(y,b)},indices:function(){return o}}}};function hn(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function pn(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var vn={kernelName:Ze.Acj,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,i.Z)(t,2),r=n[0],a=n[1];return{a:function(){return(0,et.P)(r)},b:function(){return(0,et.P)(a)}}}},gn={kernelName:Ze.iJz,gradFunc:function(e){return{x:function(){return(0,Be.p)(e,"float32")}}}},mn={kernelName:Ze.avt,gradFunc:function(e){return{x:function(){return(0,et.P)(e)}}}},yn={kernelName:Ze.iWB,gradFunc:function(e){return{x:function(){return(0,et.P)(e)}}}},bn={kernelName:Ze.r7n,gradFunc:function(e){return{x:function(){return(0,et.P)(e)}}}},xn=n(5014),kn={kernelName:Ze.J$2,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,i.Z)(t,1)[0],a=n.alpha,o=(0,xn.p)(r,0);return{x:function(){return(0,Tt.a)(o,e,(0,ze.d)(e,a))}}}},wn={kernelName:Ze.kU,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,je.h)(e,(0,at.I)(n,1))}}}},_n={kernelName:Ze.ZbH,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,je.h)(e,(0,Be.p)(n,"float32"))}}}},Cn={kernelName:Ze.qCd,inputsToSave:[],outputsToSave:[!0],gradFunc:function(e,t,n){var r=(0,i.Z)(t,1)[0],a=n.axis;return{logits:function(){var t=(0,en.Q)(r);return(0,qe.l)(e,(0,ze.d)((0,$e.S)(e,a,!0),t))}}}};var Sn=(0,ht.op)({localResponseNormalizationBackprop_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5,u={x:e,y:t,dy:n},s={depthRadius:r,bias:a,alpha:i,beta:o};return ct.BV.runKernel(Ze.Hhh,u,s)}}),An={kernelName:Ze.eZ0,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=(0,i.Z)(t,2),a=r[0],o=r[1],u=n.depthRadius,s=n.bias,c=n.alpha,l=n.beta;return{x:function(){return Sn(a,o,e,u,s,c,l)}}}},En=n(3254);function Tn(e,t,n,r){return t.rank<n.rank&&(t=(0,Ke.X)(t,Gt.rv(t.shape,r))),e.rank<n.rank&&(e=(0,Ke.X)(e,Gt.rv(e.shape,r))),{x:function(){return(0,ze.d)(e,(0,Be.p)((0,En.D)(n,t),e.dtype))}}}var Nn={kernelName:Ze.YoZ,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.reductionIndices,a=t[0],i=Tn(e,t[1],a,ft.EC(r,a.shape));return{x:function(){return i.x()}}}},Dn=n(4920),Fn={kernelName:Ze.BMI,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,i.Z)(t,2),r=n[0],a=n[1];return{a:function(){return(0,ze.d)(e,(0,Be.p)((0,St.b)(r,a),"float32"))},b:function(){return(0,ze.d)(e,(0,Be.p)((0,Dn.d)(r,a),"float32"))}}}};var In=(0,ht.op)({maxPool3dGrad_:function(e,t,n,r,a,i,o){var u=(0,lt._1)(e,"dy","maxPool3dGrad"),s=(0,lt._1)(t,"input","maxPool3dGrad"),c=(0,lt._1)(n,"output","maxPool3dGrad"),l=u,f=s,d=c,h=!1;4===s.rank&&(h=!0,l=(0,Ke.X)(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),f=(0,Ke.X)(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),d=(0,Ke.X)(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),ft.hu(5===l.rank,(function(){return"Error in maxPool3dGrad: dy must be rank 5 but got rank "+"".concat(l.rank,".")})),ft.hu(5===f.rank,(function(){return"Error in maxPool3dGrad: input must be rank 5 but got rank "+"".concat(f.rank,".")})),ft.hu(5===d.rank,(function(){return"Error in maxPool3dGrad: output must be rank 5 but got rank "+"".concat(d.rank,".")})),(0,dt.m)("maxPool3dGrad",i,o);var p={dy:l,input:f,output:d},v={filterSize:r,strides:a,pad:i,dimRoundingMode:o},g=ct.BV.runKernel(Ze.OU7,p,v);return h?(0,Ke.X)(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}}),Mn={kernelName:Ze.OAf,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=(0,i.Z)(t,2),a=r[0],o=r[1],u=n.filterSize,s=n.strides,c=n.pad,l=n.dimRoundingMode;return{x:function(){return In(e,a,o,u,s,c,l)}}}};var On=(0,ht.op)({maxPoolGrad_:function(e,t,n,r,a,i,o){var u=(0,lt._1)(e,"dy","maxPoolGrad"),s=(0,lt._1)(t,"input","maxPoolGrad"),c=(0,lt._1)(n,"output","maxPoolGrad");ft.hu(s.rank===u.rank,(function(){return"Rank of input (".concat(s.rank,") does not match rank of dy ")+"(".concat(u.rank,")")})),ft.hu(4===u.rank,(function(){return"Error in maxPoolGrad: dy must be rank 4 but got rank "+"".concat(u.rank,".")})),ft.hu(4===s.rank,(function(){return"Error in maxPoolGrad: input must be rank 4 but got rank "+"".concat(s.rank,".")})),dt.m("maxPoolGrad",i,o);var l={dy:u,input:s,output:c},f={filterSize:r,strides:a,pad:i,dimRoundingMode:o};return ct.BV.runKernel(Ze.OV7,l,f)}}),Rn={kernelName:Ze.mTV,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=(0,i.Z)(t,2),a=r[0],o=r[1],u=n.filterSize,s=n.strides,c=n.pad;return{x:function(){return On(e,a,o,u,s,c)}}}},Zn=n(6100),Bn={kernelName:Ze.q2K,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,i.Z)(t,1)[0],a=n.axis,o=ft.EC(a,r.shape),u=(0,Gt.kz)(r.shape,o)[1],s=ft.NA(u);return{x:function(){var t=r.shape.slice();o.forEach((function(e){t[e]=1}));var n=(0,Ke.X)(e,t);return(0,je.h)((0,ze.d)(n,(0,Zn.i)(r.shape,"float32")),s)}}}},zn={kernelName:Ze.c17,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.axis,a=(0,i.Z)(t,2),o=a[0],u=Tn(e,a[1],o,ft.EC(r,o.shape));return{x:function(){return u.x()}}}},Ln={kernelName:Ze.q8u,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,i.Z)(t,2),r=n[0],a=n[1];return{a:function(){return(0,ze.d)(e,(0,Be.p)((0,At.z)(r,a),"float32"))},b:function(){return(0,ze.d)(e,(0,Be.p)((0,xn.p)(r,a),"float32"))}}}},Pn=n(9238),jn={kernelName:Ze.jQs,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return(0,Pn.t)(e,a,r.shape)}}}},Un=n(2628),Wn={kernelName:Ze.Vbg,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,i.Z)(t,2),r=n[0],a=n[1],o=(0,Ye.assertAndGetBroadcastShape)(r.shape,a.shape);return{a:function(){var t=(0,Ye.getReductionAxes)(r.shape,o);return t.length>0?(0,Ke.X)((0,$e.S)(e,t),r.shape):e},b:function(){var t=(0,ze.d)(e,(0,Ue.W)((0,Un.G)((0,je.h)(r,a)))),n=(0,Ye.getReductionAxes)(a.shape,o);return n.length>0?(0,Ke.X)((0,$e.S)(t,n),a.shape):t}}}},Vn={kernelName:Ze.wYn,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,i.Z)(t,2),r=n[0],a=n[1],o=(0,Ye.assertAndGetBroadcastShape)(r.shape,a.shape);return{a:function(){var t=(0,ze.d)(e,(0,Be.p)(a,"float32")),n=(0,Ye.getReductionAxes)(r.shape,o);return n.length>0?(0,Ke.X)((0,$e.S)(t,n),r.shape):t},b:function(){var t=(0,ze.d)(e,(0,Be.p)(r,"float32")),n=(0,Ye.getReductionAxes)(a.shape,o);return n.length>0?(0,Ke.X)((0,$e.S)(t,n),a.shape):t}}}},Gn={kernelName:Ze.kuV,gradFunc:function(e){return{x:function(){return(0,Ue.W)(e)}}}},qn=n(7742),Hn={kernelName:Ze.we_,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return(0,qn.l)(n.shape,"float32")}}}},Xn={kernelName:Ze.qWM,gradFunc:function(e){return{x:function(){return(0,et.P)(e)}}}},Yn=n(4566),Kn={kernelName:Ze.QiL,saveAllInputs:!0,gradFunc:function(e,t,n){var r=n.axis;return(0,Yn.H)(e,r).map((function(e){return function(){return e}}))}},$n={kernelName:Ze.lyA,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return(0,Pn.t)(e,a,r.shape)}}}},Qn=n(378),Jn=n(4334),er={kernelName:Ze.pe_,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:function(e,t){var n=(0,i.Z)(t,3),r=n[0],a=n[1],o=n[2],u=r,s=a,c=Ye.assertAndGetBroadcastShape(u.shape,s.shape);return{a:function(){var t=(0,Be.p)(s,"float32"),n=(0,ze.d)(e,(0,ze.d)(t,(0,Jn.s)(u,(0,qe.l)(t,(0,We.i)(1))))),r=Ye.getReductionAxes(u.shape,c);return r.length>0&&(n=(0,$e.S)(n,r)),(0,Ke.X)(n,u.shape)},b:function(){var t=(0,xn.p)(u,0),n=(0,Tt.a)(t,(0,Qn.c)(u),(0,et.P)(u)),r=(0,ze.d)(e,(0,ze.d)(o,n)),a=Ye.getReductionAxes(s.shape,c);return a.length>0&&(r=(0,$e.S)(r,a)),(0,Ke.X)(r,s.shape)}}}},tr={kernelName:Ze.o0g,inputsToSave:["x","alpha"],gradFunc:function(e,t){var n=(0,i.Z)(t,2),r=n[0],a=n[1],o=(0,xn.p)(r,0);return{x:function(){return(0,Tt.a)(o,e,(0,ze.d)(e,a))},alpha:function(){var t=(0,Tt.a)(o,(0,et.P)(e),(0,ze.d)(e,r)),n=(0,Ye.getReductionAxes)(a.shape,e.shape);return n.length>0&&(t=(0,$e.S)(t,n)),(0,Ke.X)(t,a.shape)}}}},nr=n(9457);function rr(e,t,n){var r=e.shape.length,a=r-n.length,i=Gt.Q3(n,r),o=e;null!=i&&(o=(0,Ht.p)(e,i));var u=o.shape.slice(),s=u.splice(r-n.length,n.length).reduce((function(e,t){return e*t}),1);u.push(s);var c=function(e,t,n){var r=e.shape.slice();r[n]=1;var a=(0,Ke.X)(t,r),i=(0,nr.$)(e,n,!0,!1),o=(0,nr.$)(e,n,!0,!0),u=(0,ze.d)(i,o);return(0,ze.d)(a,u)}(o.reshape(u),t,a);if(c=c.reshape(o.shape),null!=i){var l=Gt.LJ(i);c=(0,Ht.p)(c,l)}return c}var ar={kernelName:Ze.DlI,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,i.Z)(t,1)[0],a=n.axis,o=[];return o=void 0===a||null===a?r.shape.map((function(e,t){return t})):"number"===typeof a?[a]:a,{x:function(){return rr(r,e,o)}}}},ir={kernelName:Ze.oHH,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,i.Z)(t,2),r=n[0],a=n[1],o=Ye.assertAndGetBroadcastShape(r.shape,a.shape);return{a:function(){var t=(0,je.h)(e,(0,Be.p)(a,"float32")),n=Ye.getReductionAxes(r.shape,o);return n.length>0?(0,Ke.X)((0,$e.S)(t,n),r.shape):t},b:function(){var t=(0,ze.d)(e,(0,Be.p)(r,"float32")),n=Ye.getReductionAxes(a.shape,o);n.length>0&&(t=(0,Ke.X)((0,$e.S)(t,n),a.shape));var i=(0,Ge.h)(a);return(0,Ue.W)((0,je.h)(t,(0,Be.p)(i,"float32")))}}}},or={kernelName:Ze.$HU,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,je.h)(e,(0,Ue.W)((0,Ge.h)(n)))}}}},ur={kernelName:Ze.SbG,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0],r=(0,ze.d)((0,At.z)(n,6),(0,Le.N)(n));return{x:function(){return(0,ze.d)(e,(0,Be.p)(r,"float32"))}}}},sr={kernelName:Ze.qkr,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,ze.d)(e,(0,Be.p)((0,Le.N)(n),"float32"))}}}},cr={kernelName:Ze.HZH,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,Ke.X)(e,n.shape)}}}},lr={kernelName:Ze._Yw,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:(0,i.Z)(t,1)[0]};return{images:function(){return ct.BV.runKernel(Ze.zbQ,r,n)}}}},fr={kernelName:Ze.dpD,inputsToSave:["images"],gradFunc:function(e,t,n){var r={dy:e,images:(0,i.Z)(t,1)[0]};return{images:function(){return ct.BV.runKernel(Ze.Hmb,r,n)}}}},dr=n(4933),hr={kernelName:Ze.mKl,gradFunc:function(e,t,n){var r=n.dims,a=(0,ft.EC)(r,e.shape);return{x:function(){return(0,dr.G)(e,a)}}}},pr={kernelName:Ze.e07,gradFunc:function(e){return{x:function(){return(0,et.P)(e)}}}},vr={kernelName:Ze.bV0,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,Ue.W)((0,je.h)(e,(0,ze.d)((0,Jn.s)(n,1.5),2)))}}}},gr=n(875),mr={kernelName:Ze.PhF,inputsToSave:["condition"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{condition:function(){return(0,Be.p)((0,et.P)(n),"float32")},t:function(){return(0,ze.d)(e,(0,Be.p)(n,e.dtype))},e:function(){return(0,ze.d)(e,(0,Be.p)((0,gr.h)(n),e.dtype))}}}},yr=n(349),br={kernelName:Ze.oFR,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){var t=(0,xn.p)(n,(0,We.i)(0)),r=(0,We.i)(yr.y),a=(0,We.i)(yr.$),i=(0,ze.d)(e,a),o=(0,ze.d)((0,ze.d)(e,r),(0,en.Q)((0,Be.p)(n,"float32")));return(0,Tt.a)(t,i,o)}}}},xr={kernelName:Ze.a5O,outputsToSave:[!0],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,ze.d)(e,(0,ze.d)(n,(0,qe.l)((0,We.i)(1),n)))}}}},kr={kernelName:Ze.i5y,gradFunc:function(e){return{x:function(){return(0,et.P)(e)}}}},wr=n(1227),_r={kernelName:Ze.RQH,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,ze.d)((0,wr.m)((0,Be.p)(n,"float32")),e)}}}},Cr=n(6679),Sr={kernelName:Ze.wYB,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,ze.d)((0,Cr.f)((0,Be.p)(n,"float32")),e)}}}},Ar=n(1970),Er=n(2875),Tr={kernelName:Ze.p2w,inputsToSave:["x"],gradFunc:function(e,t,n){for(var r=(0,i.Z)(t,1)[0],a=n.begin,o=n.size,u=r.shape,s=(0,Er.parseSliceParams)(r,a,o),c=(0,i.Z)(s,2),l=c[0],f=c[1],d=[],h=0;h<e.rank;h++)d.push([l[h],u[h]-l[h]-f[h]]);return{x:function(){return(0,Ar.v)(e,d)}}}},Nr={kernelName:Ze.Gcp,outputsToSave:[!0],gradFunc:function(e,t,n){var r=(0,i.Z)(t,1)[0],a=n.dim,o=(0,ze.d)(e,r);return{logits:function(){return(0,qe.l)(o,(0,ze.d)((0,$e.S)(o,[a],true),r))}}}},Dr=n(7643),Fr={kernelName:Ze.MRv,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,ze.d)(e,(0,Dr.X)(n))}}}},Ir=n(6994),Mr={kernelName:Ze.TQc,gradFunc:function(e,t,n){var r=n.blockShape,a=n.paddings;return{x:function(){return(0,Ir.E)(e,r,a)}}}},Or=n(4836),Rr={kernelName:Ze.L8s,gradFunc:function(e,t,n){var r=n.axis;return{x:function(){return(0,Or.z)(e,r)}}}},Zr={kernelName:Ze.FKq,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,je.h)(e,(0,ze.d)((0,Ve._)((0,Be.p)(n,"float32")),2))}}}},Br={kernelName:Ze.bK0,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,ze.d)(e,(0,ze.d)((0,Be.p)(n,"float32"),2))}}}},zr={kernelName:Ze._tC,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,i.Z)(t,2),r=n[0],a=n[1],o=(0,We.i)(2);return{a:function(){return(0,ze.d)(e,(0,ze.d)(o,(0,qe.l)(r,a)))},b:function(){return(0,ze.d)(e,(0,ze.d)(o,(0,qe.l)(a,r)))}}}},Lr={kernelName:Ze.h8e,gradFunc:function(e){return{x:function(){return(0,et.P)(e)}}}},Pr={kernelName:Ze.Tr8,inputsToSave:["a","b"],gradFunc:function(e,t){var n=(0,i.Z)(t,2),r=n[0],a=n[1],o=Ye.assertAndGetBroadcastShape(r.shape,a.shape);return{a:function(){var t=e,n=Ye.getReductionAxes(r.shape,o);return n.length>0&&(t=(0,$e.S)(t,n)),(0,Ke.X)(t,r.shape)},b:function(){var t=e,n=Ye.getReductionAxes(a.shape,o);return n.length>0&&(t=(0,$e.S)(t,n)),(0,Ke.X)((0,Ue.W)(t),a.shape)}}}},jr={kernelName:Ze.GBy,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,i.Z)(t,1)[0],a=r.shape.slice(),o=n.axis;(0,ft.EC)(o,r.shape).forEach((function(e){a[e]=1}));var u=(0,Ke.X)(e,a),s=(0,ze.d)(u,(0,Zn.i)(r.shape,"float32"));return{x:function(){return s}}}},Ur={kernelName:Ze.sEM,inputsToSave:["x"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,je.h)(e,(0,Ge.h)((0,wr.m)(n)))}}}},Wr={kernelName:Ze.MIZ,outputsToSave:[!0],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return(0,ze.d)((0,qe.l)((0,We.i)(1),(0,Ge.h)(n)),e)}}}},Vr={kernelName:Ze.n9L,inputsToSave:["x"],gradFunc:function(e,t,n){var r=(0,i.Z)(t,1)[0],a=n.reps;return{x:function(){var t=(0,et.P)(r);if(1===r.rank)for(var n=0;n<a[0];++n)t=(0,at.I)(t,(0,Pn.t)(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(var i=0;i<a[0];++i)for(var o=0;o<a[1];++o)t=(0,at.I)(t,(0,Pn.t)(e,[i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(var u=0;u<a[0];++u)for(var s=0;s<a[1];++s)for(var c=0;c<a[2];++c)t=(0,at.I)(t,(0,Pn.t)(e,[u*r.shape[0],s*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(var l=0;l<a[0];++l)for(var f=0;f<a[1];++f)for(var d=0;d<a[2];++d)for(var h=0;h<a[3];++h)t=(0,at.I)(t,(0,Pn.t)(e,[l*r.shape[0],f*r.shape[1],d*r.shape[2],h*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},Gr={kernelName:Ze.G3Y,gradFunc:function(e,t,n){var r=n.perm,a=Gt.LJ(r);return{x:function(){return(0,Ht.p)(e,a)}}}},qr=n(8306),Hr={kernelName:Ze.ToN,gradFunc:function(e,t,n){var r=n.axis;return{value:function(){return(0,qr.k)(e,r)}}}},Xr=n(2975),Yr=n(9498),Kr=n(705),$r={kernelName:Ze.Qvg,inputsToSave:["segmentIds"],gradFunc:function(e,t){var n=(0,i.Z)(t,1)[0];return{x:function(){return function(e,t){for(var n=(0,Kr.g)(t,(0,et.P)(t)),r=(0,Yr.I)(e,n),a=(0,St.b)(t,(0,We.i)(0,"int32")),i=r.rank-a.rank,o=0;o<i;++o)a=(0,Xr.d)(a,o+1);a=(0,Et.H)(a,(0,Zn.i)(r.shape,"bool"));var u=(0,et.P)(r);return(0,Tt.a)(a,r,u)}(e,n)}}}};for(var Qr={kernelName:Ze.RuY,gradFunc:function(e){return{x:function(){return(0,et.P)(e)}}}},Jr=n(8864),ea=0,ta=[Pe,He,Xe,Qe,Je,tt,nt,rt,it,ot,ut,st,vt,mt,bt,kt,wt,_t,Ct,Nt,Dt,It,Bt,Rt,Pt,Ut,Vt,Xt,$t,Qt,ir,Jt,tn,nn,rn,an,un,on,ln,dn,vn,gn,mn,yn,bn,kn,wn,_n,Cn,An,Nn,Nn,Fn,Mn,Rn,Bn,zn,Ln,jn,Wn,Vn,Gn,Hn,Xn,Kn,$n,$n,er,tr,ar,or,ur,sr,cr,lr,fr,hr,pr,vr,mr,br,xr,kr,_r,Sr,Tr,Nr,Fr,Mr,Mr,Rr,Rr,Zr,zr,Br,Lr,Pr,jr,Ur,Wr,Vr,Gr,Hr,$r,Qr];ea<ta.length;ea++){var na=ta[ea];(0,Jr.Li)(na)}n(4672);var ra=n(7326),aa=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),r=t.call(this,e),Object.setPrototypeOf((0,ra.Z)(r),n.prototype),r}return(0,s.Z)(n)}((0,f.Z)(Error)),ia=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),r=t.call(this,e),Object.setPrototypeOf((0,ra.Z)(r),n.prototype),r}return(0,s.Z)(n)}((0,f.Z)(Error)),oa=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),r=t.call(this,e),Object.setPrototypeOf((0,ra.Z)(r),n.prototype),r}return(0,s.Z)(n)}((0,f.Z)(Error)),ua=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),r=t.call(this,e),Object.setPrototypeOf((0,ra.Z)(r),n.prototype),r}return(0,s.Z)(n)}((0,f.Z)(Error)),sa=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),r=t.call(this,e),Object.setPrototypeOf((0,ra.Z)(r),n.prototype),r}return(0,s.Z)(n)}((0,f.Z)(Error)),ca=(Error,function(){function e(t){(0,u.Z)(this,e),this.maxEntries=t||100,this.cache=new Map}return(0,s.Z)(e,[{key:"get",value:function(e){var t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}},{key:"put",value:function(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}},{key:"getMaxEntries",value:function(){return this.maxEntries}},{key:"setMaxEntries",value:function(e){if(e<0)throw new Error("The maxEntries of LRU caches must be at least 0, but got ".concat(e,"."));if(this.maxEntries>e)for(var t=0;t<this.maxEntries-e;t++){var n=this.cache.keys().next().value;this.cache.delete(n)}this.maxEntries=e}}]),e}());function la(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}var a=new Array(t);return a.fill(e),a}function fa(e,t){if(!e)throw new sa(t)}function da(e,t){var n,r=0,a=(0,h.Z)(e);try{for(a.s();!(n=a.n()).done;){n.value===t&&r++}}catch(i){a.e(i)}finally{a.f()}return r}function ha(e){return 1===e.length?e[0]:e}function pa(e){return Array.isArray(e)?e:[e]}function va(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function ga(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(function(e,t){return t.toUpperCase()}))}var ma={};function ya(e){if(null===e||void 0===e)return null;var t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function ba(e){if(null!=e&&"object"===typeof e)if(Array.isArray(e))e.forEach((function(e){return ba(e)}));else for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],a=e[r];null!=a&&"object"===typeof a&&(Array.isArray(a)||"ndarray"!==a.type||"number"!==typeof a.value?ba(a):e[r]=a.value)}}function xa(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"===typeof e){var o,u=e;if(u in n)o=n[u];else if(u in ma)o=ma[u];else if(null==(o=t[u]))throw new oa("Unknown ".concat(r,": ").concat(e,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return o}var s=e;if(null==s.className||null==s.config)throw new oa("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(s),".\n")+"'className' and 'config' must set.");var c,l,f=s.className;if(f in n){var d=(0,i.Z)(n[f],2);c=d[0],l=d[1]}else if(f in ma){var h=(0,i.Z)(ma.className,2);c=h[0],l=h[1]}else if(f in t){var p=(0,i.Z)(t[f],2);c=p[0],l=p[1]}if(null==c)throw new oa("Unknown ".concat(r,": ").concat(f,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=l){for(var v={},g=0,m=Object.keys(ma);g<m.length;g++){var y=m[g];v[y]=ma[y]}for(var b=0,x=Object.keys(n);b<x.length;b++){var k=x[b];v[k]=n[k]}var w=s.config;w.customObjects=v;for(var _=Object.assign({},ma),C=0,S=Object.keys(n);C<S.length;C++){var A=S[C];ma[A]=n[A]}ba(s.config);var E=l(c,s.config,n,a);return ma=Object.assign({},_),E}for(var T=Object.assign({},ma),N=0,D=Object.keys(n);N<D.length;N++){var F=D[N];ma[F]=n[F]}var I=new c(s.config);return ma=Object.assign({},T),I}function ka(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function wa(e){if(null==e)return e;var t,n=[],r=(0,h.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;-1===n.indexOf(a)&&n.push(a)}}catch(i){r.e(i)}finally{r.f()}return n}function _a(e){if(null==e)throw new oa("Invalid value in obj: ".concat(JSON.stringify(e)));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function Ca(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new oa("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function Sa(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return fa(n>=0),fa(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((function(e){return typeof e===t}))}function Aa(e,t){Array.isArray(e)?(Re.util.assert(e.length>0,(function(){return"".concat(t," is unexpectedly an empty array.")})),e.forEach((function(e,n){return Aa(e,"element ".concat(n+1," of ").concat(t))}))):Re.util.assert(Number.isInteger(e)&&e>0,(function(){return"Expected ".concat(t," to be a positive integer, but got ")+"".concat(Ea(e),".")}))}function Ea(e){return null===e?"null":Array.isArray(e)?"["+e.map((function(e){return Ea(e)})).join(",")+"]":"string"===typeof e?'"'.concat(e,'"'):"".concat(e)}function Ta(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}var Na=0;function Da(){return Na++}var Fa={};function Ia(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in Fa||(Fa[e]=0),Fa[e]+=1,e+Fa[e].toString()}var Ma=["channelsFirst","channelsLast"],Oa=["nearest","bilinear"],Ra=["valid","same","causal"],Za=["max","avg"],Ba=["sum","mul","concat","ave"],za=new Map;function La(e){Ca(Ma,"DataFormat",e)}function Pa(e){Ca(Ra,"PaddingMode",e)}function ja(e){Ca(Za,"PoolMode",e)}var Ua=[];function Wa(e,t){Ua.push(e);try{var n=t();return Ua.pop(),n}catch(r){throw Ua.pop(),r}}function Va(e){if(!Xa(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===Ua.length?"":Ua.join("/")+"/")+e}function Ga(e){if(!Xa(e))throw new Error("Not a valid tensor name: '"+e+"'");za.has(e)||za.set(e,0);var t=za.get(e);if(za.set(e,za.get(e)+1),t>0){var n="".concat(e,"_").concat(t);return za.set(n,1),n}return e}var qa,Ha=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function Xa(e){return!!e.match(Ha)}function Ya(e,t,n){null==t&&(t=0),null==n&&(n=e.length);for(var r=1,a=t;a<n;++a)r*=e[a];return r}function Ka(e){if(0===e.length)return Number.NaN;for(var t=Number.POSITIVE_INFINITY,n=0;n<e.length;n++){var r=e[n];r<t&&(t=r)}return t}function $a(e){if(0===e.length)return Number.NaN;for(var t=Number.NEGATIVE_INFINITY,n=0;n<e.length;n++){var r=e[n];r>t&&(t=r)}return t}function Qa(e,t){if(t<e)throw new oa("end (".concat(t,") < begin (").concat(e,") is forbidden."));for(var n=[],r=e;r<t;++r)n.push(r);return n}function Ja(){return null==qa&&(qa=(0,Re.backend)().epsilon()),qa}function ei(e,t){return Re.cast(e,t)}function ti(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),Re.reshape(e,n)}function ni(e){var t=[Ya(e.shape)];return Re.reshape(e,t)}function ri(e,t,n){return(0,Re.tidy)((function(){switch(e.rank){case 1:return Re.slice1d(e,t,n);case 2:return Re.slice2d(e,[t,0],[n,e.shape[1]]);case 3:return Re.slice3d(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return Re.slice4d(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return Re.slice(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return Re.slice(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new oa("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function ai(e,t,n){return(0,Re.tidy)((function(){switch(e.rank){case 1:return Re.slice1d(e,t,n);case 2:return Re.slice2d(e,[0,t],[e.shape[0],n]);case 3:return Re.slice3d(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return Re.slice4d(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new oa("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function ii(e,t,n,r){return(0,Re.tidy)((function(){switch(e.rank){case 1:return Re.slice1d(e,t,n);case 2:switch(r){case 1:return ri(e,t,n);case 2:return ai(e,t,n);default:throw new oa("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return ri(e,t,n);case 2:return Re.slice3d(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return ai(e,t,n);default:throw new oa("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return ri(e,t,n);case 2:return Re.slice4d(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return Re.slice4d(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return ai(e,t,n);default:throw new oa("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new oa("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function oi(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(n=0!==(t=e[0].rank)?t:0),n===e[0].rank&&(n=-1),Re.concat(e,n)}function ui(e,t){switch(e.rank){case 1:return Re.concat1d([e,t]);case 2:return Re.concat2d([e,t],0);case 3:return Re.concat3d([e,t],0);case 4:return Re.concat4d([e,t],0);default:throw new oa("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(e.rank))}}function si(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new oa("The length of input n (".concat(t.length,") does not match ")+"the number of dimensions in input x (".concat(e.rank,")"));return Re.tile(e,t)}function ci(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;return Re.randomNormal(e,t,n,r,a)}function li(e,t,n,r){if(e.rank<2||t.rank<2)throw new ua("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3&&e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new ua("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(e.shape," and ")+" y shape = ".concat(t.shape));if(2===e.rank&&2===t.rank){return Re.fused.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?hi(e.rank,r,"channelsLast"):null,activation:n})}var a=e.shape.slice(),i=a.pop();e=Re.reshape(e,[-1,i]);var u=t.shape.slice(),s=u.pop(),c=u.pop(),l=[].concat((0,o.Z)(u),[s]),f=Array.from({length:t.rank},(function(e,n){return 0===n?t.rank-2:n<=t.rank-2?n-1:n}));t=Re.reshape(Re.transpose(t,f),[c,-1]);var d=[].concat((0,o.Z)(a),(0,o.Z)(l));return Re.reshape(Re.fused.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?hi(e.rank,r,"channelsLast"):null,activation:n}),d)}function fi(e,t,n){return(0,Re.tidy)((function(){return t=Array.isArray(t)?(0,Re.tensor1d)(t,"int32"):Re.cast(t,"int32"),Re.gather(e,t,n)}))}function di(e){return Re.mul(e,e)}function hi(e,t,n){var r=t.shape;if(1!==t.rank&&t.rank!==e)throw new oa("Unexpected bias dimensions: ".concat(t.rank)+"; expected it to be 1 or ".concat(e));if(5===e){if("channelsFirst"===n)return 1===r.length?Re.reshape(t,[1,r[0],1,1,1]):Re.reshape(t,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?Re.reshape(t,[1,1,1,1,r[0]]):Re.reshape(t,[1].concat(r))}else if(4===e){if("channelsFirst"===n)return 1===r.length?Re.reshape(t,[1,r[0],1,1]):Re.reshape(t,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?Re.reshape(t,[1,1,1,r[0]]):Re.reshape(t,[1].concat(r))}else if(3===e){if("channelsFirst"===n)return 1===r.length?Re.reshape(t,[1,r[0],1]):Re.reshape(t,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?Re.reshape(t,[1,1,r[0]]):Re.reshape(t,[1].concat(r))}else if(e<3)return t;throw new oa("Unsupported input rank by biasAdd: ".concat(t.rank))}function pi(e,t,n){return(0,Re.tidy)((function(){return null==n&&(n="channelsLast"),La(n),Re.add(e,hi(e.rank,t,n))}))}function vi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new ua("Support for alpha values other than 1 (".concat(t,") is not implemented ")+"yet.");return Re.elu(e)}function gi(e,t,n,r){return(0,Re.tidy)((function(){return Re.dropout(e,t,n,r)}))}function mi(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?e():t()}var yi=["fanIn","fanOut","fanAvg"],bi=["normal","uniform","truncatedNormal"];var xi=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"fromConfigUsesCustomObjects",value:function(){return!1}},{key:"getConfig",value:function(){return{}}}]),n}(Re.serialization.Serializable),ki=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e,t){return(0,Re.zeros)(e,t)}}]),n}(xi);ki.className="Zeros",Re.serialization.registerClass(ki);var wi=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e,t){return(0,Re.ones)(e,t)}}]),n}(xi);wi.className="Ones",Re.serialization.registerClass(wi);var _i=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),r=t.call(this),"object"!==typeof e)throw new oa("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new oa("config must have value set but got ".concat(e));return r.value=e.value,r}return(0,s.Z)(n,[{key:"apply",value:function(e,t){var n=this;return(0,Re.tidy)((function(){return(0,Re.mul)((0,Re.scalar)(n.value),(0,Re.ones)(e,t))}))}},{key:"getConfig",value:function(){return{value:this.value}}}]),n}(xi);_i.className="Constant",Re.serialization.registerClass(_i);var Ci=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=e.minval||r.DEFAULT_MINVAL,r.maxval=e.maxval||r.DEFAULT_MAXVAL,r.seed=e.seed,r}return(0,s.Z)(n,[{key:"apply",value:function(e,t){return(0,Re.randomUniform)(e,this.minval,this.maxval,t,this.seed)}},{key:"getConfig",value:function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}]),n}(xi);Ci.className="RandomUniform",Re.serialization.registerClass(Ci);var Si=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return(0,s.Z)(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new ua("randomNormal does not support dType ".concat(t,"."));return ci(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(xi);Si.className="RandomNormal",Re.serialization.registerClass(Si);var Ai=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return(0,s.Z)(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new ua("truncatedNormal does not support dType ".concat(t,"."));return(0,Re.truncatedNormal)(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(xi);Ai.className="TruncatedNormal",Re.serialization.registerClass(Ai);var Ei=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).gain=null!=e.gain?e.gain:1,r}return(0,s.Z)(n,[{key:"apply",value:function(e,t){var n=this;return(0,Re.tidy)((function(){if(2!==e.length||e[0]!==e[1])throw new oa("Identity matrix initializer can only be used for 2D square matrices.");return(0,Re.mul)(n.gain,(0,Re.eye)(e[0]))}))}},{key:"getConfig",value:function(){return{gain:this.gain}}}]),n}(xi);Ei.className="Identity",Re.serialization.registerClass(Ei);var Ti=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r,a;if((0,u.Z)(this,n),r=t.call(this),e.scale<0)throw new oa("scale must be a positive float. Got: ".concat(e.scale));return r.scale=null==e.scale?1:e.scale,r.mode=null==e.mode?"fanIn":e.mode,a=r.mode,Ca(yi,"FanMode",a),r.distribution=null==e.distribution?"normal":e.distribution,function(e){Ca(bi,"Distribution",e)}(r.distribution),r.seed=e.seed,r}return(0,s.Z)(n,[{key:"apply",value:function(e,t){var n=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(La(r),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===r){var a=Ya(e,2);t=e[1]*a,n=e[0]*a}else if("channelsLast"===r){var i=Ya(e,0,e.length-2);t=e[e.length-2]*i,n=e[e.length-1]*i}}else{var o=Ya(e);t=Math.sqrt(o),n=Math.sqrt(o)}return[t,n]}(e),r=n[0],a=n[1],i=this.scale;if("fanIn"===this.mode?i/=Math.max(1,r):"fanOut"===this.mode?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),"normal"===this.distribution){var o=Math.sqrt(i);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new ua("".concat(this.getClassName()," does not support dType ").concat(t,"."));return(0,Re.truncatedNormal)(e,0,o,t,this.seed)}var u=Math.sqrt(3*i);return(0,Re.randomUniform)(e,-u,u,t,this.seed)}},{key:"getConfig",value:function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}]),n}(xi);Ti.className="VarianceScaling",Re.serialization.registerClass(Ti);var Ni=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}return(0,s.Z)(n,[{key:"getClassName",value:function(){return Ti.className}}]),n}(Ti);Ni.className="GlorotUniform",Re.serialization.registerClass(Ni);var Di=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}return(0,s.Z)(n,[{key:"getClassName",value:function(){return Ti.className}}]),n}(Ti);Di.className="GlorotNormal",Re.serialization.registerClass(Di);var Fi=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return(0,s.Z)(n,[{key:"getClassName",value:function(){return Ti.className}}]),n}(Ti);Fi.className="HeNormal",Re.serialization.registerClass(Fi);var Ii=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return(0,s.Z)(n,[{key:"getClassName",value:function(){return Ti.className}}]),n}(Ti);Ii.className="HeUniform",Re.serialization.registerClass(Ii);var Mi=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return(0,s.Z)(n,[{key:"getClassName",value:function(){return Ti.className}}]),n}(Ti);Mi.className="LeCunNormal",Re.serialization.registerClass(Mi);var Oi=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return(0,s.Z)(n,[{key:"getClassName",value:function(){return Ti.className}}]),n}(Ti);Oi.className="LeCunUniform",Re.serialization.registerClass(Oi);var Ri=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),(r=t.call(this)).DEFAULT_GAIN=1,r.gain=null==e.gain?r.DEFAULT_GAIN:e.gain,r.seed=e.seed,null!=r.seed)throw new ua("Random seed is not implemented for Orthogonal Initializer yet.");return r}return(0,s.Z)(n,[{key:"apply",value:function(e,t){var n=this;return(0,Re.tidy)((function(){if(e.length<2)throw new ua("Shape must be at least 2D.");e[0]*e[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than 2000 (".concat(e[0]*e[1],") elements: ")+"Slowness may result.");var t=ci(e[0]>e[1]?[e[1],e[0]]:e,0,1,"float32"),r=Re.linalg.gramSchmidt(t);return e[0]>e[1]&&(r=(0,Re.transpose)(r)),(0,Re.mul)(n.gain,r)}))}},{key:"getConfig",value:function(){return{gain:this.gain,seed:this.seed}}}]),n}(xi);Ri.className="Orthogonal",Re.serialization.registerClass(Ri);var Zi={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function Bi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return xa(e,Re.serialization.SerializationMap.getMap().classNameMap,t,"initializer")}function zi(e){return ya(e)}function Li(e){if("string"===typeof e){var t=e in Zi?Zi[e]:e;if("GlorotNormal"===t)return new Di;if("GlorotUniform"===t)return new Ni;if("HeNormal"===t)return new Fi;if("HeUniform"===t)return new Ii;if("LeCunNormal"===t)return new Mi;if("LeCunUniform"===t)return new Oi;var n={};return n.className=t,n.config={},Bi(n)}return e instanceof xi?e:Bi(e)}function Pi(e){return Array.isArray(e)&&Array.isArray(e[0])}function ji(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function Ui(e){var t;if(Array.isArray(e)){if(1!==e.length)throw new oa("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function Wi(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new oa("Expected exactly 1 Shape; got ".concat(e.length))}return e}function Vi(e){var t,n=0,r=(0,h.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;0===a.shape.length?n+=1:n+=a.shape.reduce((function(e,t){return e*t}))}}catch(i){r.e(i)}finally{r.f()}return n}var Gi="Variable",qi=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Gi,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;(0,u.Z)(this,e),this.dtype=null==n?"float32":n,this.shape=t.shape,this.id=Da(),r=null==r?Gi:r,this.originalName=Va(r),this.name=Ga(this.originalName),this.trainable_=a,this.constraint=i,this.val=Re.variable(t,this.trainable_,this.name,this.dtype)}return(0,s.Z)(e,[{key:"read",value:function(){return this.assertNotDisposed(),this.val}},{key:"write",value:function(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}},{key:"dispose",value:function(){this.assertNotDisposed(),this.val.dispose()}},{key:"assertNotDisposed",value:function(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.trainable_=e,this.val.trainable=e}}]),e}();function Hi(e){return e.map((function(e){return e.read()}))}function Xi(e){e.forEach((function(e){e[0].write(e[1])}))}var Yi=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}})),Ki=(0,s.Z)((function e(t,n,r,a,i,o,s){(0,u.Z)(this,e),this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=a,this.callArgs=i,this.outputTensorIndex=s,this.id=Da(),null!=o&&(this.originalName=Va(o),this.name=Ga(this.originalName)),this.rank=n.length})),$i=0,Qi=function(){function e(t,n){(0,u.Z)(this,e),this.callArgs=n,this.id=$i++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;var r,a=(0,h.Z)(t.inboundLayers);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&i.outboundNodes.push(this)}}catch(o){a.e(o)}finally{a.f()}t.outboundLayer.inboundNodes.push(this)}return(0,s.Z)(e,[{key:"getConfig",value:function(){var e,t=[],n=(0,h.Z)(this.inboundLayers);try{for(n.s();!(e=n.n()).done;){var r=e.value;null!=r?t.push(r.name):t.push(null)}}catch(a){n.e(a)}finally{n.f()}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}]),e}(),Ji=0,eo=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,u.Z)(this,n),(e=t.call(this))._callHook=null,e._addedWeightNames=[],e._stateful=!1,e.id=Ji++,e.activityRegularizer=null,e.inputSpec=null,e.supportsMasking=!1,e._trainableWeights=[],e._nonTrainableWeights=[],e._losses=[],e._updates=[],e._built=!1,e.inboundNodes=[],e.outboundNodes=[];var a=r.name;if(!a){var i=e.getClassName();a=va(i)+"_"+Ia(i)}if(e.name=a,e.trainable_=null==r.trainable||r.trainable,null!=r.inputShape||null!=r.batchInputShape){var o;if(null!=r.batchInputShape)o=r.batchInputShape;else if(null!=r.inputShape){var s=null;null!=r.batchSize&&(s=r.batchSize),o=[s].concat(r.inputShape)}e.batchInputShape=o;var c=r.dtype;null==c&&(c=r.inputDType),null==c&&(c="float32"),e.dtype=c}return null!=r.weights?e.initialWeights=r.weights:e.initialWeights=null,e._refCount=null,e.fastWeightInitDuringBuild=!1,e}return(0,s.Z)(n,[{key:"getNodeAtIndex",value:function(e,t){if(0===this.inboundNodes.length)throw new ia("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new oa("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}},{key:"getInputAt",value:function(e){return ha(this.getNodeAtIndex(e,"input").inputTensors)}},{key:"getOutputAt",value:function(e){return ha(this.getNodeAtIndex(e,"output").outputTensors)}},{key:"input",get:function(){if(this.inboundNodes.length>1)throw new aa("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new aa("Layer ".concat(this.name)+" is not connected, no input to return.");return ha(this.getNodeAtIndex(0,"input").inputTensors)}},{key:"output",get:function(){if(0===this.inboundNodes.length)throw new aa("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new aa("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return ha(this.getNodeAtIndex(0,"output").outputTensors)}},{key:"losses",get:function(){return this._losses}},{key:"calculateLosses",value:function(){return this.losses.map((function(e){return e()}))}},{key:"updates",get:function(){return this._updates}},{key:"built",get:function(){return this._built},set:function(e){this._built=e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this._trainableWeights.forEach((function(t){return t.trainable=e})),this.trainable_=e}},{key:"trainableWeights",get:function(){return this.trainable_?this._trainableWeights.filter((function(e){return e.trainable})):[]},set:function(e){this._trainableWeights=e}},{key:"nonTrainableWeights",get:function(){return this.trainable?this._trainableWeights.filter((function(e){return!e.trainable})).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"stateful",get:function(){return this._stateful}},{key:"resetStates",value:function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}},{key:"assertInputCompatibility",value:function(e){if(e=pa(e),null!=this.inputSpec&&0!==this.inputSpec.length){var t=pa(this.inputSpec);if(e.length!==t.length)throw new oa("Layer ".concat(this.name," expects ").concat(t.length," inputs, ")+"but it received ".concat(e.length," input tensors. ")+"Input received: ".concat(e));for(var n=0;n<e.length;n++){var r=e[n],a=t[n];if(null!=a){var i=r.rank;if(null!=a.ndim&&i!==a.ndim)throw new oa("Input ".concat(n," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(a.ndim,", found ndim=").concat(i));if(null!=a.maxNDim&&i>a.maxNDim)throw new oa("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(a.maxNDim,", found ndim=").concat(i));if(null!=a.minNDim&&i<a.minNDim)throw new oa("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(a.minNDim,", found ndim=").concat(i,"."));if(null!=a.dtype&&r.dtype!==a.dtype)throw new oa("Input ".concat(n," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(a.dtype,", found dtype=").concat(r.dtype,"."));if(a.axes){var o=r.shape;for(var u in a.axes){var s=Number(u),c=a.axes[u],l=s>=0?o[s]:o[o.length+s];if(null!=c&&-1===[c,null].indexOf(l))throw new oa("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(s," of input shape to ")+"have value ".concat(c," but got shape ").concat(o,"."))}}if(null!=a.shape)for(var f=0;f<a.shape.length;++f){var d=a.shape[f],h=r.shape[f];if(null!=d&&null!=h&&d!==h)throw new oa("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(a.shape,", ")+"found shape=".concat(r.shape,"."))}}}}}},{key:"call",value:function(e,t){return e}},{key:"invokeCallHook",value:function(e,t){null!=this._callHook&&this._callHook(e,t)}},{key:"setCallHook",value:function(e){this._callHook=e}},{key:"clearCallHook",value:function(){this._callHook=null}},{key:"apply",value:function(e,t){var n=this;t=t||{},this.assertNotDisposed();var r,a=pa(e),i=!0,o=(0,h.Z)(a);try{for(o.s();!(r=o.n()).done;){if(!(r.value instanceof Ki)){i=!1;break}}}catch(l){o.e(l)}finally{o.f()}var u,s=!0,c=(0,h.Z)(a);try{for(c.s();!(u=c.n()).done;){if(u.value instanceof Ki){s=!1;break}}}catch(l){c.e(l)}finally{c.f()}if(i===s)throw new oa("Arguments to apply() must be all SymbolicTensors or all Tensors");return Wa(this.name,(function(){if(!n.built){n.assertInputCompatibility(e);var r,i=[],o=(0,h.Z)(pa(e));try{for(o.s();!(r=o.n()).done;){var u=r.value;i.push(u.shape)}}catch(l){o.e(l)}finally{o.f()}n.build(ha(i)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&s&&(n._refCount=1)}if(n.assertInputCompatibility(e),s){var c,f=n.call(e,t),d=pa(f),p=[],v=(0,h.Z)(d);try{for(v.s();!(c=v.n()).done;){var g=c.value;-1!==a.indexOf(g)&&(g=g.clone()),p.push(g)}}catch(l){v.e(l)}finally{v.f()}if(f=ha(p),null!=n.activityRegularizer)throw new ua("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return f}var m,y=function(e){e=pa(e);var t,n=[],r=(0,h.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push(a.shape)}}catch(l){r.e(l)}finally{r.f()}return ha(n)}(e),b=n.computeOutputShape(y),x="float32";if(n.warnOnIncompatibleInputShape(Array.isArray(e)?y[0]:y),m=null!=b&&b.length>0&&Array.isArray(b[0])?b.map((function(r,a){return new Ki(x,r,n,pa(e),t,n.name,a)})):new Ki(x,b,n,pa(e),t,n.name),n.addInboundNode(e,m,null,null,y,b,t),n._refCount++,null!=n.activityRegularizer)throw new ua("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return m}))}},{key:"warnOnIncompatibleInputShape",value:function(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{var t=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}},{key:"outputShape",get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new aa("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");var e,t=[],n=(0,h.Z)(this.inboundNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=JSON.stringify(r.outputShapes);-1===t.indexOf(a)&&t.push(a)}}catch(o){n.e(o)}finally{n.f()}if(1===t.length){var i=this.inboundNodes[0].outputShapes;return Array.isArray(i)&&Array.isArray(i[0])&&1===i.length?i[0]:i}throw new aa("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}},{key:"countParams",value:function(){if(!this.built)throw new ia("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return Vi(this.weights)}},{key:"build",value:function(e){this.built=!0}},{key:"getWeights",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Hi(e?this.trainableWeights:this.weights)}},{key:"setWeights",value:function(e){var t=this;(0,Re.tidy)((function(){var n=t.weights;if(n.length!==e.length)throw new oa('You called setWeights(weights) on layer "'.concat(t.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(n.length," weights. ")+"Provided weights: ".concat(e,"..."));if(0!==n.length){for(var r=[],a=Hi(n),i=0;i<a.length;++i){var o=a[i],u=n[i],s=e[i];if(!Re.util.arraysEqual(o.shape,s.shape))throw new oa("Layer weight shape ".concat(o.shape," ")+"not compatible with provided weight shape ".concat(s.shape));r.push([u,s])}Xi(r)}}))}},{key:"addWeight",value:function(e,t,n,r,a,i,o,u){if(-1!==this._addedWeightNames.indexOf(e))throw new oa("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=u?u():Li("zeros"));var s=r.apply(t,n),c=new qi(s,n,e,i,o);return s.dispose(),null!=a&&this.addLoss((function(){return a.apply(c.read())})),null==i&&(i=!0),i?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}},{key:"setFastWeightInitDuringBuild",value:function(e){this.fastWeightInitDuringBuild=e}},{key:"addLoss",value:function(e){var t;null==e||Array.isArray(e)&&0===e.length||(e=pa(e),void 0!==this._losses&&null!==this._losses&&(t=this.losses).push.apply(t,(0,o.Z)(e)))}},{key:"computeOutputShape",value:function(e){return e}},{key:"computeMask",value:function(e,t){var n=this;if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");t.forEach((function(e){if(null!=e)throw new TypeError("Layer ".concat(n.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return t}},{key:"addInboundNode",value:function(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=pa(e);t=pa(t),n=pa(n),r=pa(r),a=ji(a),i=ji(i);var s,c=[],l=[],f=[],d=(0,h.Z)(u);try{for(d.s();!(s=d.n()).done;){var p=s.value;c.push(p.sourceLayer),l.push(p.nodeIndex),f.push(p.tensorIndex)}}catch(g){d.e(g)}finally{d.f()}new Qi({outboundLayer:this,inboundLayers:c,nodeIndices:l,tensorIndices:f,inputTensors:u,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(var v=0;v<t.length;v++)t[v].sourceLayer=this,t[v].nodeIndex=this.inboundNodes.length-1,t[v].tensorIndex=v}},{key:"getConfig",value:function(){var e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}},{key:"disposeWeights",value:function(){return this.weights.forEach((function(e){return e.dispose()})),this.weights.length}},{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();var e=0;return 0===--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}],[{key:"nodeKey",value:function(e,t){return e.name+"_ib-"+t.toString()}}]),n}(Re.serialization.Serializable);function to(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];var r=t.inboundNodes[n];if(0===r.inboundLayers.length)return r.inputTensors;for(var a=[],i=0;i<r.inboundLayers.length;i++){var o,u=to(r.inputTensors[i],r.inboundLayers[i],r.nodeIndices[i]),s=(0,h.Z)(u);try{for(s.s();!(o=s.n()).done;){var c=o.value;-1===a.indexOf(c)&&a.push(c)}}catch(l){s.e(l)}finally{s.f()}}return a}var no=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),r=t.call(this,{dtype:e.dtype,name:null!=e.name?e.name:Ia("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new oa("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var a=e.batchInputShape;if(null==a){if(null==e.inputShape)throw new oa("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");a=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new oa("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=e.dtype||"float32";r.batchInputShape=a,r.dtype=i,r.inputSpec=[{shape:a}];var o=new Ki(r.dtype,r.batchInputShape,(0,ra.Z)(r),[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new Qi({outboundLayer:(0,ra.Z)(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[a],outputShapes:[a]}),r}return(0,s.Z)(n,[{key:"apply",value:function(e,t){throw new oa("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}},{key:"dispose",value:function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}},{key:"getConfig",value:function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}]),n}(eo);function ro(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new oa("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));var n=e.dtype;return null==n&&(n="float32"),new no({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}no.className="InputLayer",Re.serialization.registerClass(no);var ao=function(){function e(t){if((0,u.Z)(this,e),this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(null==t)return;var r,a=(0,h.Z)(t);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.add(i.key,i.value)}}catch(o){a.e(o)}finally{a.f()}}}return(0,s.Z)(e,[{key:"add",value:function(e,t,n){if(null!=this.id2Value[e.id])throw new oa("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return(0,Re.cast)(t,e.dtype)}catch(n){throw new oa("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype ")+"of the key '".concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}},{key:"addFeed",value:function(e){this.add(e.key,e.value)}},{key:"hasKey",value:function(e){return null!=this.id2Value[e.id]}},{key:"names",value:function(){return Object.keys(this.name2Id)}},{key:"getValue",value:function(e){if(e instanceof Ki){if(null==this.id2Value[e.id])throw new oa("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}var t=this.name2Id[e];if(null==t)throw new oa("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}},{key:"getMask",value:function(e){if(e instanceof Ki){if(null==this.id2Value[e.id])throw new oa("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}var t=this.name2Id[e];if(null==t)throw new oa("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}},{key:"disposeMasks",value:function(){null!=this.id2Mask&&(0,Re.dispose)(this.id2Mask)}}]),e}(),io=new ca,oo=new ca;function uo(e,t,n,r){var a,i=null!=n&&n.training,o=Array.isArray(e),u=o?e:[e],s=u.map((function(e){return e.name})),c=[],l=t.names(),f=(0,h.Z)(s);try{for(f.s();!(a=f.n()).done;){var d=a.value;-1!==l.indexOf(d)?c.push(t.getValue(d)):c.push(null)}}catch(z){f.e(z)}finally{f.f()}null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var p,v=s.join(",")+"|"+t.names().sort().join(","),g=io.get(v);if(null==g){var m=function(e,t){Re.util.assert(null!=e&&e.length>0,(function(){return"Expected at least one fetch, got none"}));var n=[],r={};if(1===e.length){var a=co(e[0],t);n=a.sorted,r=a.recipientMap}else{var i,o=new Set,u=(0,h.Z)(e);try{for(u.s();!(i=u.n()).done;){var s,c=co(i.value,t),l=c.sorted,f=c.recipientMap,d=(0,h.Z)(l);try{for(d.s();!(s=d.n()).done;){var p=s.value;o.has(p.name)||(n.push(p),o.add(p.name))}}catch(z){d.e(z)}finally{d.f()}var v=function(e){null==r[e]&&(r[e]=new Set),f[e].forEach((function(t){return r[e].add(t)}))};for(var g in f)v(g)}}catch(z){u.e(z)}finally{u.f()}}return{sorted:n,recipientCounts:so(r)}}(u,t);g=m.sorted,p=m.recipientCounts,io.put(v,g),oo.put(v,p)}p={},i||Object.assign(p,oo.get(v));for(var y=new ao(t),b=0;b<g.length;++b){if(null!=r){var x=(0,Re.memory)().numTensors;x>r.maxNumTensors&&(r.maxNumTensors=x),x<r.minNumTensors&&(r.minNumTensors=x)}var k=g[b],w=k.sourceLayer;if(!(w instanceof no)){var _,C=[],S=[],A=[],E=!1,T=(0,h.Z)(k.inputs);try{for(T.s();!(_=T.n()).done;){var N=_.value,D=y.getValue(N),F=y.getMask(N);C.push(D),S.push(F),null!=F&&(E=!0),i||(p[N.name]--,0!==p[N.name]||t.hasKey(N)||-1!==s.indexOf(N.name)||D.isDisposed||!0===N.sourceLayer.stateful||A.push(D))}}catch(z){T.e(z)}finally{T.f()}E&&((n=n||{}).mask=S[0]);var I=pa(w.apply(C,n)),M=null;w.supportsMasking&&(M=w.computeMask(C,S));for(var O=lo(k),R=Array.isArray(O)?O:[O],Z=0;Z<R.length;++Z){y.hasKey(R[Z])||y.add(R[Z],I[Z],Array.isArray(M)?M[0]:M);var B=s.indexOf(R[Z].name);-1!==B&&(c[B]=I[Z])}i||(0,Re.dispose)(A)}}return y.disposeMasks(),o?c:c[0]}function so(e){var t={};for(var n in e)t[n]=e[n].size;return t}function co(e,t){var n,r=new Set,a=[],i={},o=(0,h.Z)(t.names());try{for(o.s();!(n=o.n()).done;){var u=n.value;r.add(u)}}catch(g){o.e(g)}finally{o.f()}var s=[],c=[];for(s.push(e);s.length>0;){var l=s[s.length-1];if(r.has(l.name))s.pop();else{var f=c[c.length-1]===s.length-1;if(0===l.inputs.length||f)s.pop(),a.push(l),r.add(l.name),f&&c.pop();else{c.push(s.length-1);var d,p=(0,h.Z)(l.inputs);try{for(p.s();!(d=p.n()).done;){var v=d.value;null==i[v.name]&&(i[v.name]=new Set),i[v.name].add(l.name),r.has(v.name)||s.push(v)}}catch(g){p.e(g)}finally{p.f()}}}}return{sorted:a,recipientMap:i}}function lo(e){var t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r){var a,i=(0,h.Z)(e.sourceLayer.inboundNodes[r].outputTensors);try{for(i.s();!(a=i.n()).done;){if(a.value.id===e.id){n=r;break}}}catch(o){i.e(o)}finally{i.f()}}t=e.sourceLayer.getOutputAt(n)}return t}function fo(e,t){return(0,Re.tidy)((function(){return Re.sqrt(Re.sum(Re.mul(e,e),t,!0))}))}(0,Re.env)().registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",(function(){return 100}),(function(e){null!=io&&io.setMaxEntries(e),null!=oo&&oo.setMaxEntries(e)}));var ho=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getConfig",value:function(){return{}}}]),n}(Re.serialization.Serializable),po=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).defaultMaxValue=2,r.defaultAxis=0,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return(0,s.Z)(n,[{key:"apply",value:function(e){var t=this;return(0,Re.tidy)((function(){var n=fo(e,t.axis),r=Re.clipByValue(n,0,t.maxValue);return Re.mul(e,Re.div(r,Re.add(Ja(),n)))}))}},{key:"getConfig",value:function(){return{maxValue:this.maxValue,axis:this.axis}}}]),n}(ho);po.className="MaxNorm",Re.serialization.registerClass(po);var vo=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).defaultAxis=0,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return(0,s.Z)(n,[{key:"apply",value:function(e){var t=this;return(0,Re.tidy)((function(){return Re.div(e,Re.add(Ja(),fo(e,t.axis)))}))}},{key:"getConfig",value:function(){return{axis:this.axis}}}]),n}(ho);vo.className="UnitNorm",Re.serialization.registerClass(vo);var go=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e){return Re.relu(e)}}]),n}(ho);go.className="NonNeg",Re.serialization.registerClass(go);var mo=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=null!=e.minValue?e.minValue:r.defaultMinValue,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.rate=null!=e.rate?e.rate:r.defaultRate,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return(0,s.Z)(n,[{key:"apply",value:function(e){var t=this;return(0,Re.tidy)((function(){var n=fo(e,t.axis),r=Re.add(Re.mul(t.rate,Re.clipByValue(n,t.minValue,t.maxValue)),Re.mul(1-t.rate,n));return Re.mul(e,Re.div(r,Re.add(Ja(),n)))}))}},{key:"getConfig",value:function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}]),n}(ho);mo.className="MinMaxNorm",Re.serialization.registerClass(mo);var yo={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function bo(e){return ya(e)}function xo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return xa(e,Re.serialization.SerializationMap.getMap().classNameMap,t,"constraint")}function ko(e){return null==e?null:"string"===typeof e?xo({className:e in yo?yo[e]:e,config:{}}):e instanceof ho?e:xo(e)}var wo,_o=n(4165),Co=n(5861);function So(e){return Ao.apply(this,arguments)}function Ao(){return(Ao=(0,Co.Z)((0,_o.Z)().mark((function e(t){var n,r,a,i,o,u,s,c;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}return e.abrupt("return");case 2:for(i in n=[],r=[],a=[],t)"number"!==typeof(o=t[i])&&(u=o,n.push(u.data()),r.push(i),a.push(u));if(!(n.length>0)){e.next=12;break}return e.next=9,Promise.all(n);case 9:for(s=e.sent,c=0;c<s.length;++c)t[r[c]]=s[c][0];(0,Re.dispose)(a);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Eo(e){if(null!=e)for(var t in e){var n=e[t];"number"!==typeof n&&n.dispose()}}!function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(wo||(wo={}));var To=function(){function e(){(0,u.Z)(this,e),this.validationData=null}return(0,s.Z)(e,[{key:"setParams",value:function(e){this.params=e}},{key:"onEpochBegin",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"setModel",value:function(e){}}]),e}(),No=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;(0,u.Z)(this,e),null==t&&(t=[]),this.callbacks=t,this.queueLength=n}return(0,s.Z)(e,[{key:"append",value:function(e){this.callbacks.push(e)}},{key:"setParams",value:function(e){var t,n=(0,h.Z)(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setParams(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"setModel",value:function(e){var t,n=(0,h.Z)(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setModel(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"onEpochBegin",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){var r,a,i;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=(0,h.Z)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){var r,a,i;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=(0,h.Z)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){var r,a,i;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=(0,h.Z)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){var r,a,i;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=(0,h.Z)(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){var n,r,a;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=(0,h.Z)(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainBegin(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){var n,r,a;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=(0,h.Z)(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainEnd(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Do=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.call(this)}return(0,s.Z)(n,[{key:"onEpochBegin",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.seen=0,this.totals={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){var r,a,i,o=this;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=null==n.size?0:n.size,this.seen+=r,a=(0,_o.Z)().mark((function e(t){var a,i,u;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"number"===typeof(a=n[t])?(o.totals.hasOwnProperty(t)||(o.totals[t]=0),o.totals[t]=o.totals[t]+a*r):(t in o.totals?i=o.totals[t]:o.totals[t]=0,u=(0,Re.tidy)((function(){return(0,Re.add)(o.totals[t],(0,Re.mul)(a,r))})),o.totals[t]=u,null!=i&&i.dispose());case 2:case"end":return e.stop()}}),e)})),e.t0=(0,_o.Z)().keys(n);case 5:if((e.t1=e.t0()).done){e.next=10;break}return i=e.t1.value,e.delegateYield(a(i),"t2",8);case 8:e.next=5;break;case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){var r,a,i,o=this;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n){e.next=20;break}r=(0,h.Z)(this.params.metrics),e.prev=2,i=(0,_o.Z)().mark((function e(){var t;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a.value,null!=o.totals[t]){e.next=3;break}return e.abrupt("return","continue");case 3:"number"===typeof o.totals[t]?n[t]=o.totals[t]/o.seen:(0,Re.tidy)((function(){var e=(0,Re.mul)((0,Re.div)(1,o.seen),o.totals[t]);n[t]=e,o.totals[t].dispose(),(0,Re.keep)(n[t])}));case 4:case"end":return e.stop()}}),e)})),r.s();case 5:if((a=r.n()).done){e.next=12;break}return e.delegateYield(i(),"t0",7);case 7:if("continue"!==e.t0){e.next=10;break}return e.abrupt("continue",10);case 10:e.next=5;break;case 12:e.next=17;break;case 14:e.prev=14,e.t1=e.catch(2),r.e(e.t1);case 17:return e.prev=17,r.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[2,14,17,20]])})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(To),Fo=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"onTrainBegin",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.epoch=[],this.history={};case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){var r;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in null==n&&(n={}),this.epoch.push(t),n)null==this.history[r]&&(this.history[r]=[]),this.history[r].push(n[r]);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"syncData",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t,n,r,a,i,o,u,s,c;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t=[],n=[],r=[],this.history)for(i=this.history[a],o=0;o<i.length;++o)"number"!==typeof i[o]&&(u=i[o],t.push(u.data()),n.push(a),r.push(o));return e.next=6,Promise.all(t);case 6:for(s=e.sent,c=0;c<s.length;++c)this.history[n[c]][r[c]].dispose(),this.history[n[c]][r[c]]=s[c][0];case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(To),Io=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;if((0,u.Z)(this,n),(a=t.call(this)).currentEpoch=0,a.nowFunc=e.nowFunc,a.nextFrameFunc=e.nextFrameFunc||Re.nextFrame,a.yieldEvery=r||"auto","auto"===a.yieldEvery&&(a.yieldEvery=125),"never"===a.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return Re.util.isNumber(a.yieldEvery)&&(a.maybeWait=function(e,t,n){var r,a=null!=n?n():Re.util.now();return function(){var i=null!=n?n():Re.util.now();return i-a<t?r:(a=i,r=e.apply(void 0,arguments))}}(a.maybeWait.bind((0,ra.Z)(a)),a.yieldEvery,a.nowFunc)),a.trainBegin=e.onTrainBegin,a.trainEnd=e.onTrainEnd,a.epochBegin=e.onEpochBegin,a.epochEnd=e.onEpochEnd,a.batchBegin=e.onBatchBegin,a.batchEnd=e.onBatchEnd,a.yield=e.onYield,a}return(0,s.Z)(n,[{key:"maybeWait",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n,r){var a;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],null==this.yield){e.next=5;break}return e.next=4,So(r);case 4:a.push(this.yield(t,n,r));case 5:return a.push(this.nextFrameFunc()),e.next=8,Promise.all(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"onEpochBegin",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentEpoch=t,null==this.epochBegin){e.next=6;break}return e.next=4,So(n);case 4:return e.next=6,this.epochBegin(t,n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEpochEnd",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){var r;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.epochEnd){e.next=5;break}return e.next=4,So(n);case 4:r.push(this.epochEnd(t,n));case 5:return"epoch"===this.yieldEvery&&r.push(this.nextFrameFunc()),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchBegin",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.batchBegin){e.next=5;break}return e.next=3,So(n);case 3:return e.next=5,this.batchBegin(t,n);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onBatchEnd",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){var r;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],null==this.batchEnd){e.next=5;break}return e.next=4,So(n);case 4:r.push(this.batchEnd(t,n));case 5:return"batch"===this.yieldEvery?r.push(this.nextFrameFunc()):Re.util.isNumber(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,t,n)),e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTrainBegin",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainBegin){e.next=5;break}return e.next=3,So(t);case 3:return e.next=5,this.trainBegin(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrainEnd",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.trainEnd){e.next=5;break}return e.next=3,So(t);case 3:return e.next=5,this.trainEnd(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(To);function Mo(e,t){return null==e&&(e={}),e instanceof To?[e]:Array.isArray(e)&&e[0]instanceof To?e:pa(e).map((function(e){return new Io(e,t)}))}var Oo=function(){function e(){(0,u.Z)(this,e)}return(0,s.Z)(e,null,[{key:"registerCallbackConstructor",value:function(t,n){Re.util.assert(t>=0&&Number.isInteger(t),(function(){return"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(t)})),e.checkForDuplicate(n),null==e.constructors[t]&&(e.constructors[t]=[]),e.constructors[t].push(n)}},{key:"checkForDuplicate",value:function(t){for(var n in e.constructors){e.constructors[+n].forEach((function(e){if(e===t)throw new oa("Duplicate callback constructor.")}))}}},{key:"clear",value:function(){e.constructors={}}},{key:"createCallbacks",value:function(t){var n=[];for(var r in e.constructors){var a=+r;t>=a&&n.push.apply(n,(0,o.Z)(e.constructors[a]))}return n.map((function(e){return new e}))}}]),e}();function Ro(e,t,n,r,a,i,u,s,c){var l=new Fo,f=[new Do].concat((0,o.Z)(Oo.createCallbacks(t)));null!=e&&f.push.apply(f,(0,o.Z)(e)),f.push(l);var d=new No(f);return d.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:u,verbose:t,doValidation:s,metrics:c}),{callbackList:d,history:l}}Oo.constructors={};var Zo=n(1752),Bo=n(1120);function zo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return xa(e,Re.serialization.SerializationMap.getMap().classNameMap,t,"layer",n)}function Lo(e,t){return(0,Re.tidy)((function(){"float32"!==e.dtype&&(e=Re.cast(e,"float32"));var n=Re.sum(di(e),t,!0),r=Re.fill(n.shape,Ja()),a=Re.sqrt(Re.maximum(n,r));return Re.div(e,a)}))}function Po(e,t){return(0,Re.tidy)((function(){return Re.mean(di(Re.sub(t,e)),-1)}))}function jo(e,t){return(0,Re.tidy)((function(){return Re.mean(Re.abs(Re.sub(t,e)),-1)}))}function Uo(e,t){return(0,Re.tidy)((function(){var n=Re.sub(e,t),r=Re.clipByValue(Re.abs(e),Ja(),Number.MAX_VALUE),a=Re.abs(Re.div(n,r));return Re.mul(100,Re.mean(a,-1))}))}function Wo(e,t){return(0,Re.tidy)((function(){var n=Re.clipByValue(t,Ja(),Number.MAX_VALUE),r=Re.log(Re.add(1,n)),a=Re.clipByValue(e,Ja(),Number.MAX_VALUE),i=Re.log(Re.add(1,a));return Re.mean(di(Re.sub(r,i)),-1)}))}function Vo(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,Re.tidy)((function(){if(n)t=Re.softmax(t);else{var r=Re.sum(t,t.shape.length-1,!0);t=Re.div(t,r)}return t=Re.clipByValue(t,Ja(),1-Ja()),Re.neg(Re.sum(Re.mul(Re.cast(e,"float32"),Re.log(t)),t.shape.length-1))}))}function Go(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,Re.tidy)((function(){var r=Re.cast(Re.floor(ni(e)),"int32"),a=(t=Re.clipByValue(t,Ja(),1-Ja())).shape;return Vo(Re.reshape(Re.oneHot(r,a[a.length-1]),a),t,n)}))}function qo(e,t){return(0,Re.tidy)((function(){var n;return n=Re.clipByValue(t,Ja(),1-Ja()),n=Re.log(Re.div(n,Re.sub(1,n))),Re.mean(function(e,t){if(!Re.util.arraysEqual(e.shape,t.shape))throw new oa("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return(0,Re.tidy)((function(){var n=Re.relu(t),r=Re.neg(Re.abs(t));return Re.add(Re.sub(n,Re.mul(t,e)),Re.log1p(Re.exp(r)))}))}(e,n),-1)}))}function Ho(e,t){return(0,Re.tidy)((function(){var n=Re.clipByValue(e,Ja(),1),r=Re.clipByValue(t,Ja(),1);return Re.sum(Re.mul(e,Re.log(Re.div(n,r))),-1)}))}function Xo(e,t){return(0,Re.tidy)((function(){var n=Lo(e,-1),r=Lo(t,-1),a=Re.mul(n,r);return Re.neg(Re.sum(a,-1))}))}var Yo={meanSquaredError:Po,meanAbsoluteError:jo,meanAbsolutePercentageError:Uo,meanSquaredLogarithmicError:Wo,squaredHinge:function(e,t){return(0,Re.tidy)((function(){var n=Re.maximum(0,Re.sub(1,Re.mul(e,t)));return Re.mean(di(n),-1)}))},hinge:function(e,t){return(0,Re.tidy)((function(){var n=Re.maximum(0,Re.sub(1,Re.mul(e,t)));return Re.mean(n,-1)}))},categoricalHinge:function(e,t){return(0,Re.tidy)((function(){var n=Re.sum(Re.mul(e,t),-1),r=Re.max(Re.mul(Re.sub(1,e),t),-1);return Re.maximum(0,Re.add(1,Re.sub(r,n)))}))},logcosh:function(e,t){return(0,Re.tidy)((function(){var n=Math.log(2),r=Re.sub(t,e),a=Re.sub(Re.add(r,Re.softplus(Re.mul(-2,r))),n);return Re.mean(a,-1)}))},categoricalCrossentropy:Vo,sparseCategoricalCrossentropy:Go,binaryCrossentropy:qo,kullbackLeiblerDivergence:Ho,poisson:function(e,t){return(0,Re.tidy)((function(){var n=Re.log(Re.add(Ja(),t));return Re.mean(Re.sub(t,Re.mul(e,n)),-1)}))},cosineProximity:Xo};function Ko(e){if("string"===typeof e){if(e in Yo)return Yo[e];var t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new oa(t)}return e}function $o(e,t){return(0,Re.tidy)((function(){var n=Re.mul(.5,Re.onesLike(t)),r=ei(Re.greater(t,n),e.dtype);return Re.mean(Re.equal(e,r),-1)}))}function Qo(e,t){return(0,Re.tidy)((function(){return ei(Re.equal(Re.argMax(e,-1),Re.argMax(t,-1)),"float32")}))}function Jo(e,t){return(0,Re.tidy)((function(){return Re.cast(Re.sum(Re.logicalAnd(Re.equal(e,1),Re.equal(t,1))),"float32")}))}function eu(e,t){return qo(e,t)}function tu(e,t){return e.rank===t.rank&&(e=Re.squeeze(e,[e.rank-1])),(t=Re.argMax(t,-1)).dtype!==e.dtype&&(t=Re.cast(t,e.dtype)),Re.cast(Re.equal(e,t),"float32")}var nu=Vo,ru=Go,au={binaryAccuracy:$o,categoricalAccuracy:Qo,precision:function(e,t){return(0,Re.tidy)((function(){var n=Jo(e,t),r=function(e,t){return(0,Re.tidy)((function(){return Re.cast(Re.sum(Re.logicalAnd(Re.equal(e,0),Re.equal(t,1))),"float32")}))}(e,t),a=Re.add(n,r);return Re.cast(Re.where(Re.greater(a,0),Re.div(n,a),0),"float32")}))},categoricalCrossentropy:nu,sparseCategoricalCrossentropy:ru,mse:Po,MSE:Po,mae:jo,MAE:jo,mape:Uo,MAPE:Uo,cosine:Xo};function iu(e){if(fa(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"===typeof e)return e;for(var t,n=0,r=Object.keys(Yo);n<r.length;n++){var a=r[n];if(Yo[a]===e){t=a;break}}if(void 0!==t)return t;for(var i=0,o=Object.keys(au);i<o.length;i++){var u=o[i];if(au[u]===e){t=u;break}}return void 0!==t?t:e.name}var ou=1048576;function uu(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!==typeof e||Object.getPrototypeOf(e)!==Object.prototype||!su(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(e);r.length>ou&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in ')+"size (length=".concat(r.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(ou,"."))}}function su(e){if(null===e)return!0;if("object"===typeof e){if(Object.getPrototypeOf(e)===Object.prototype){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];if("string"!==typeof r)return!1;if(!su(e[r]))return!1}return!0}if(Array.isArray(e)){var a,i=(0,h.Z)(e);try{for(i.s();!(a=i.n()).done;){if(!su(a.value))return!1}}catch(u){i.e(u)}finally{i.f()}return!0}return!1}var o=typeof e;return"string"===o||"number"===o||"boolean"===o}function cu(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,i=fu(e),u=["Layer (type)","Input Shape","Output shape","Param #"];if(i?(t=t||90,n=n||[.32,.61,.89,1]):(t=t||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map((function(e){return Math.floor(t*e)}))),!i)for(var s in u.push("Receives inputs"),r=[],e.nodesByDepth){var c;(c=r).push.apply(c,(0,o.Z)(e.nodesByDepth[s]))}a("_".repeat(t)),du(u,n,a),a("=".repeat(t));for(var l=e.layers,f=0;f<l.length;++f)i?hu(l[f],n,a):pu(l[f],n,r,a),a((f===l.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var d=lu(e),h=Vi(e.nonTrainableWeights);a("Total params: ".concat(d+h)),a("Trainable params: ".concat(d)),a("Non-trainable params: ".concat(h)),a("_".repeat(t))}function lu(e){return null!=e.collectedTrainableWeights?Vi(e.collectedTrainableWeights):Vi(e.trainableWeights)}function fu(e){var t=!0,n=[],r=[];for(var a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(var i=0,u=n;i<u.length;i++){var s=u[i];if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){t=!1;break}r.push.apply(r,(0,o.Z)(s))}if(t){var c,l=(0,h.Z)(e.layers);try{for(l.s();!(c=l.n()).done;){var f,d=c.value,p=!1,v=(0,h.Z)(d.inboundNodes);try{for(v.s();!(f=v.n()).done;){var g=f.value;if(-1!==r.indexOf(g)){if(p){t=!1;break}p=!0}}}catch(m){v.e(m)}finally{v.f()}if(!t)break}}catch(m){l.e(m)}finally{l.f()}}return t}function du(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="",a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[a]).slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function hu(e,t,n){var r,a;try{a=e.inboundNodes.map((function(e){return JSON.stringify(e.inputShapes)})).join(",")}catch(u){a="multiple"}try{r=JSON.stringify(e.outputShape)}catch(u){r="multiple"}var i=e.name,o=e.getClassName();du(["".concat(i," (").concat(o,")"),a,r,e.countParams().toString()],t,n)}function pu(e,t,n,r){var a,i;try{i=e.inboundNodes.map((function(e){return JSON.stringify(e.inputShapes)})).join(",")}catch(b){i="multiple"}try{a=JSON.stringify(e.outputShape)}catch(b){a="multiple"}var o,u=[],s=(0,h.Z)(e.inboundNodes);try{for(s.s();!(o=s.n()).done;){var c=o.value;if(!(null!=n&&n.length>0&&-1===n.indexOf(c)))for(var l=0;l<c.inboundLayers.length;++l){var f=c.inboundLayers[l].name,d=c.nodeIndices[l],p=c.tensorIndices[l];u.push("".concat(f,"[").concat(d,"][").concat(p,"]"))}}}catch(b){s.e(b)}finally{s.f()}var v=e.name,g=e.getClassName(),m=0===u.length?"":u[0];du(["".concat(v," (").concat(g,")"),i,a,e.countParams().toString(),m],t,r);for(var y=1;y<u.length;++y)du(["","","","",u[y]],t,r)}function vu(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"===typeof n}function gu(e,t){if(null===e)return null;if("string"===typeof e)return ga(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];vu(t,a,i)?n.push(i):n.push(gu(i,t))}return n}for(var o={},u=0,s=Object.keys(e);u<s.length;u++){var c=s[u],l=e[c];if("name"===c&&"string"===typeof l)o[c]=l;else{var f=ga(c);o[f]=gu(l,f)}}return o}function mu(e,t){if(null===e||void 0===e)return null;if("string"===typeof e)return va(e);if("number"===typeof e||"boolean"===typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];vu(t,a,i)?n.push(i):n.push(mu(i,t))}return n}for(var o={},u=0,s=Object.keys(e);u<s.length;u++){var c=s[u],l=e[c],f=va(c);o[f]="name"!==c&&"className"!==c||"string"!==typeof l?mu(l,c):l}return o}var yu="4.2.0",bu=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),(r=t.call(this,{})).containerNodes=new Set,r.name=e.name,null==r.name){var a=r.getClassName().toLowerCase();r.name=Ia(a)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(e.inputs)?r.inputs=e.inputs.slice():r.inputs=[e.inputs],Array.isArray(e.outputs)?r.outputs=e.outputs.slice():r.outputs=[e.outputs],wa(r.inputs).length!==r.inputs.length)throw new oa("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(r.inputs.map((function(e){return e.name}))));wa(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(r.outputs.map((function(e){return e.name})))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];var i,o=(0,h.Z)(r.outputs);try{for(o.s();!(i=o.n()).done;){var s=i.value,c=s.sourceLayer,l=s.nodeIndex,f=s.tensorIndex;r.outputLayers.push(c),r.outputLayersNodeIndices.push(l),r.outputLayersTensorIndices.push(f)}}catch(Ce){o.e(Ce)}finally{o.f()}var d,p=(0,h.Z)(r.inputs);try{for(p.s();!(d=p.n()).done;){var v=d.value,g=v.sourceLayer,m=v.nodeIndex,y=v.tensorIndex;fa(0===m,"input layer has >1 nodes"),fa(0===y,"input layer has >1 tensors"),r.inputLayers.push(g),r.inputLayersNodeIndices.push(m),r.inputLayersTensorIndices.push(y)}}catch(Ce){p.e(Ce)}finally{p.f()}r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var b=0;b<r.inputLayers.length;b++){var x=r.inputLayers[b];if(!(x instanceof no))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(b," (0-based) originates ")+"from layer type ".concat(x.getClassName(),"."));r.inputNames.push(x.name),r.feedInputShapes.push(x.batchInputShape),r.feedInputNames.push(x.name)}var k,w=(0,h.Z)(r.outputLayers);try{for(w.s();!(k=w.n()).done;){var _=k.value;r.outputNames.push(_.name)}}catch(Ce){w.e(Ce)}finally{w.f()}r.internalInputShapes=r.inputs.map((function(e){return e.shape})),r.internalOutputShapes=r.outputs.map((function(e){return e.shape}));var C,S={},A={},E={},T={},N={},D=[],F=function e(t,a,i,o,u,s){null!=o&&null!=u&&null!=s||(o=t.sourceLayer,u=t.nodeIndex,s=t.tensorIndex);var c=o.inboundNodes[u];if(-1!==i.indexOf(c))throw new ia("The tensor ".concat(t.name,' at layer "').concat(o.name,'" ')+"is part of a cycle.");if(-1===a.indexOf(c)){r.containerNodes.add(n.nodeKey(o,u)),o.id in N||(N[o.id]=Object.keys(N).length),-1===i.indexOf(c)&&i.push(c);for(var l=c.inboundLayers.length,f=0;f<l;f++){e(c.inputTensors[f],a,i,c.inboundLayers[f],c.nodeIndices[f],c.tensorIndices[f])}for(a.push(c);i.indexOf(c)>=0;)i.splice(i.indexOf(c),1);D.push(c)}},I=[],M=[],O=(0,h.Z)(r.outputs);try{for(O.s();!(C=O.n()).done;){F(C.value,I,M)}}catch(Ce){O.e(Ce)}finally{O.f()}var R,Z=D.slice().reverse(),B=(0,h.Z)(Z);try{for(B.s();!(R=B.n()).done;){var z=R.value;A[z.id]=z,z.id in S||(S[z.id]=0);var L=S[z.id],P=null==E[z.outboundLayer.id]?0:E[z.outboundLayer.id];L=Math.max(L,P),E[z.outboundLayer.id]=L,T[z.outboundLayer.id]=z.outboundLayer,S[z.id]=L;for(var j=0;j<z.inboundLayers.length;j++){var U=z.inboundLayers[j],W=z.nodeIndices[j],V=U.inboundNodes[W],G=null==S[V.id]?0:S[V.id];S[V.id]=Math.max(L+1,G),A[V.id]=V}}}catch(Ce){B.e(Ce)}finally{B.f()}var q={};for(var H in S){var X=S[H];X in q||(q[X]=[]),q[X].push(A[H])}var Y={};for(var K in E){var $=E[K];$ in Y||(Y[$]=[]),Y[$].push(T[K])}var Q=Object.keys(Y).map((function(e){return parseInt(e,10)})).sort(ka);r.layers=[];var J,ee=(0,h.Z)(Q);try{for(ee.s();!(J=ee.n()).done;){var te=Y[J.value];te.sort((function(e,t){var n=N[e.id],r=N[t.id];return n<r?-1:n>r?1:0}));var ne,re=(0,h.Z)(te);try{for(re.s();!(ne=re.n()).done;){var ae=ne.value;ae instanceof n&&r.internalContainerRefs.push(ae),r.layers.push(ae)}}catch(Ce){re.e(Ce)}finally{re.f()}}}catch(Ce){ee.e(Ce)}finally{ee.f()}r.layersByDepth=Y,Q=Object.keys(q).map((function(e){return parseInt(e,10)})).sort(ka);var ie,oe=r.inputs.slice(),ue=[],se=(0,h.Z)(Q);try{for(se.s();!(ie=se.n()).done;){var ce,le=ie.value,fe=(0,h.Z)(q[le]);try{for(fe.s();!(ce=fe.n()).done;){var de=ce.value,he=de.outboundLayer;if(null!=he){var pe,ve=(0,h.Z)(de.inputTensors);try{for(ve.s();!(pe=ve.n()).done;){var ge=pe.value;if(-1===oe.indexOf(ge))throw new ia("Graph disconnected: cannot obtain value for tensor ".concat(ge)+' at layer "'.concat(he.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(ue))}}catch(Ce){ve.e(Ce)}finally{ve.f()}var me,ye=(0,h.Z)(de.outputTensors);try{for(ye.s();!(me=ye.n()).done;){var be=me.value;oe.push(be)}}catch(Ce){ye.e(Ce)}finally{ye.f()}ue.push(he.name)}}}catch(Ce){fe.e(Ce)}finally{fe.f()}}}catch(Ce){se.e(Ce)}finally{se.f()}r.nodesByDepth=q;var xe,ke=r.layers.map((function(e){return e.name})),we=(0,h.Z)(ke);try{var _e=function(){var e=xe.value,t=ke.filter((function(t){return t===e})).length;if(1!==t)throw new ia('The name "'.concat(e,'" is used ').concat(t," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(ke))};for(we.s();!(xe=we.n()).done;)_e()}catch(Ce){we.e(Ce)}finally{we.f()}return r.outboundNodes=[],r.inboundNodes=[],new Qi({outboundLayer:(0,ra.Z)(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(e){return null})),outputMasks:r.outputs.map((function(e){return null})),inputShapes:r.inputs.map((function(e){return e.shape})),outputShapes:r.outputs.map((function(e){return e.shape}))}),r.built=!0,r._refCount=1,r}return(0,s.Z)(n,[{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){this.assertNotDisposed();var e={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){var t,n=(0,h.Z)(this.layers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.numDisposedVariables+=r.dispose().numDisposedVariables}}catch(u){n.e(u)}finally{n.f()}var a,i=(0,h.Z)(this.internalContainerRefs);try{for(i.s();!(a=i.n()).done;){var o=a.value;e.numDisposedVariables+=o.dispose().numDisposedVariables}}catch(u){i.e(u)}finally{i.f()}}return e.refCountAfterDispose=this._refCount,e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.layers.forEach((function(t){t._trainableWeights.forEach((function(t){return t.trainable=e}))})),this.trainable_=e}},{key:"trainableWeights",get:function(){if(this._trainableWeights.length>0)throw new oa("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];var e,t=[],n=(0,h.Z)(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=t.concat(r.trainableWeights)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=(0,h.Z)(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,(0,o.Z)(r.nonTrainableWeights))}}catch(c){n.e(c)}finally{n.f()}if(!this.trainable){var a,i=[],u=(0,h.Z)(this.layers);try{for(u.s();!(a=u.n()).done;){var s=a.value;i.push.apply(i,(0,o.Z)(s.trainableWeights))}}catch(c){u.e(c)}finally{u.f()}return i.concat(t)}return t}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"loadWeights",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r={},a=0,i=(0,h.Z)(this.layers);try{for(i.s();!(t=i.n()).done;){var o,u=t.value,s=(0,h.Z)(u.weights);try{for(s.s();!(o=s.n()).done;){var c=o.value;if(null!=r[c.originalName])throw new oa("Duplicate weight name: ".concat(c.originalName));r[c.originalName]=c,a++}}catch(y){s.e(y)}finally{s.f()}}}catch(y){i.e(y)}finally{i.f()}var l=[];for(var f in e){var d=f;if(null==r[f]){var p=f.split("/"),v=p.slice(0,-2).concat([p[p.length-1]]);d=v.join("/")}if(null!=r[d])l.push([r[d],e[f]]);else if(n)throw new oa("Provided weight data has no target variable: ".concat(f));delete r[d]}if(n){var g=[];for(var m in r)g.push(m);if(g.length>0)throw new oa("".concat(g.length," of ").concat(a," weights are not set: ")+"".concat(g))}Xi(l)}},{key:"updatedConfig",value:function(){var e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(yu),t.backend="TensorFlow.js",t}},{key:"toJSON",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=mu(this.updatedConfig());return t?JSON.stringify(n):n}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){e=pa(e);for(var r=new ao,a=0;a<n.inputs.length;++a)r.add(n.inputs[a],e[a]);return uo(n.outputs,r,t)}))}},{key:"computeMask",value:function(e,t){var n=this;return(0,Re.tidy)((function(){var r;return e=pa(e),r=null==t?la(null,e.length):pa(t),n.runInternalGraph(e,r)[1]}))}},{key:"computeOutputShape",value:function(e){var t=ji(e);if(t.length!==this.inputLayers.length)throw new oa("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));for(var n={},r=0;r<t.length;r++){var a=this.inputLayers[r],i=t[r];n[a.name+"_0_0"]=i}var o=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(ka);if(o.length>1){var u,s=(0,h.Z)(o);try{for(s.s();!(u=s.n()).done;){var c,l=u.value,f=this.nodesByDepth[l],d=(0,h.Z)(f);try{for(d.s();!(c=d.n()).done;){var p=c.value,v=p.outboundLayer;if(-1===this.inputLayers.map((function(e){return e.id})).indexOf(v.id)){for(var g=[],m=0;m<p.inboundLayers.length;m++){var y=p.inboundLayers[m],b=p.nodeIndices[m],x=p.tensorIndices[m],k=n["".concat(y.name,"_").concat(b,"_").concat(x)];g.push(k)}for(var w=ji(v.computeOutputShape(ha(g))),_=v.inboundNodes.indexOf(p),C=0;C<w.length;C++){n["".concat(v.name,"_").concat(_,"_").concat(C)]=w[C]}}}}catch(O){d.e(O)}finally{d.f()}}}catch(O){s.e(O)}finally{s.f()}}for(var S=[],A=[],E=0;E<this.outputLayers.length;E++){var T=this.outputLayers[E],N=this.outputLayersNodeIndices[E],D=this.outputLayersTensorIndices[E],F="".concat(T.name,"_").concat(N,"_").concat(D);A.push(F)}for(var I=0;I<A.length;I++){var M=A[I];fa(M in n),S.push(n[M])}return ha(S)}},{key:"runInternalGraph",value:function(e,t){null==t&&(t=la(null,e.length));for(var n={},r=0;r<this.inputs.length;++r){var a=this.inputs[r],o=e[r],u=t[r];n[a.id]=[o,u]}var s,c=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(ka),l=(0,h.Z)(c);try{for(l.s();!(s=l.n()).done;){var f,d=s.value,p=this.nodesByDepth[d],v=(0,h.Z)(p);try{for(v.s();!(f=v.n()).done;){var g,m=f.value,y=m.outboundLayer,b=m.inputTensors,x=m.outputTensors,k=new Array,w=(0,h.Z)(b);try{for(w.s();!(g=w.n()).done;){var _=g.value;_.id in n&&k.push(n[_.id])}}catch(G){w.e(G)}finally{w.f()}if(k.length===b.length){var C={},S=void 0,A=void 0,E=void 0,T=void 0;if(null!=m.callArgs&&(C=m.callArgs),1===k.length){var N=(0,i.Z)(k[0],2),D=N[0],F=N[1];null==C.mask&&(C.mask=F),E=pa(y.call(D,C)),T=pa(y.computeMask(D,F)),S=[D],A=[F]}else S=k.map((function(e){return e[0]})),A=k.map((function(e){return e[1]})),null==C.mask&&(C.mask=A),E=pa(y.call(S,C)),T=pa(y.computeMask(S,A));if(y.activityRegularizer)throw new ua("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(var I=0;I<x.length;++I){var M=x[I],O=E[I],R=T[I];n[M.id]=[O,R]}}}}catch(G){v.e(G)}finally{v.f()}}}catch(G){l.e(G)}finally{l.f()}var Z,B=[],z=[],L=[],P=(0,h.Z)(this.outputs);try{for(P.s();!(Z=P.n()).done;){var j=Z.value;fa(j.id in n,"Could not compute output ".concat(j.name," : ").concat(j.id));var U=(0,i.Z)(n[j.id],2),W=U[0],V=U[1];L.push(W.shape),B.push(W),z.push(V)}}catch(G){P.e(G)}finally{P.f()}return[B,z,L]}},{key:"buildNodeConversionMap",value:function(e){var t,r,a={},i=(0,h.Z)(this.layers);try{for(i.s();!(r=i.n()).done;){var o=r.value;t=o instanceof n?1:0;for(var u=0;u<o.inboundNodes.length;u++){var s=n.nodeKey(o,u);this.containerNodes.has(s)&&(a[s]=t,t+=1)}}}catch(c){i.e(c)}finally{i.f()}return a}},{key:"getLayer",value:function(e,t){if(null!=t){if(this.layers.length<=t)throw new oa("Was asked to retrieve layer at index ".concat(t,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[t]}if(null==e)throw new oa("Provide either a layer name or layer index");var n,r=(0,h.Z)(this.layers);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.name===e)return a}}catch(i){r.e(i)}finally{r.f()}throw new oa("No such layer: ".concat(e))}},{key:"calculateLosses",value:function(){var e=this;return(0,Re.tidy)((function(){var t,r=[],a=(0,h.Z)(e.layers);try{for(a.s();!(t=a.n()).done;)for(var i=t.value,u=0;u<i.inboundNodes.length;++u){var s=n.nodeKey(i,u);e.containerNodes.has(s)&&r.push.apply(r,(0,o.Z)(i.calculateLosses()))}}catch(c){a.e(c)}finally{a.f()}return r}))}},{key:"getConfig",value:function(){var e,t={name:this.name},r=this.buildNodeConversionMap(this.layers),a=[],i=(0,h.Z)(this.layers);try{for(i.s();!(e=i.n()).done;){for(var o=e.value,u=o.getClassName(),s=o.getConfig(),c=[],l=0;l<o.inboundNodes.length;l++){var f=o.inboundNodes[l],d=n.nodeKey(o,l),p={};if(this.containerNodes.has(d)){if(f.callArgs)try{JSON.stringify(f.callArgs),p=f.callArgs}catch(Z){console.warn("Layer ".concat(o.name," was passed ")+"non-serializable keyword arguments: "+"".concat(f.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),p={}}if(f.inboundLayers.length>0){for(var v=[],g=0;g<f.inboundLayers.length;g++){var m=f.inboundLayers[g],y=f.nodeIndices[g],b=f.tensorIndices[g],x=r[n.nodeKey(m,y)];null==x&&(x=0),v.push([m.name,x,b,p])}c.push(v)}}}var k={};k.name=o.name,k.className=u,k.config=s,k.inboundNodes=c,a.push(k)}}catch(Z){i.e(Z)}finally{i.f()}t.layers=a;for(var w=[],_=0;_<this.inputLayers.length;_++){var C=this.inputLayers[_],S=this.inputLayersNodeIndices[_],A=n.nodeKey(C,S);if(this.containerNodes.has(A)){var E=r[A];null!==E&&void 0!==E||(E=0);var T=this.inputLayersTensorIndices[_];w.push([C.name,E,T])}}t.inputLayers=w;for(var N=[],D=0;D<this.outputLayers.length;D++){var F=this.outputLayers[D],I=this.outputLayersNodeIndices[D],M=n.nodeKey(F,I);if(this.containerNodes.has(M)){var O=r[M];null!==O&&void 0!==O||(O=0);var R=this.outputLayersTensorIndices[D];N.push([F.name,O,R])}}return t.outputLayers=N,t}},{key:"stateful",get:function(){if(this._stateful)throw new oa("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");var e,t=(0,h.Z)(this.layers);try{for(t.s();!(e=t.n()).done;){if(e.value.stateful)return!0}}catch(n){t.e(n)}finally{t.f()}return!1}},{key:"resetStates",value:function(){var e=this;(0,Re.tidy)((function(){e.layers.forEach((function(e){e.stateful&&e.resetStates()}))}))}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={},a={};function i(e,t){e.name in a?a[e.name].push(t):a[e.name]=[t]}function o(e,t){var n,a,o=[],u=(0,h.Z)(t);try{for(u.s();!(a=u.n()).done;){var s=a.value,c=s[0],l=s[1],f=s[2];if(n=null==s[3]?{}:s[3],!(c in r))return void i(e,t);var d=r[c];if(d.inboundNodes.length<=l)return void i(e,t);var p=d.inboundNodes[l];o.push(p.outputTensors[f])}}catch(v){u.e(v)}finally{u.f()}o.length>0&&e.apply(ha(o),n)}function u(e){var a=e.name,o=zo(e,null!=t.customObjects?t.customObjects:{});o.setFastWeightInitDuringBuild(n),r[a]=o,e.inboundNodes.forEach((function(e){if(!(e instanceof Array))throw new oa("Corrupted configuration, expected array for nodeData: ".concat(e));i(o,e)}))}var s,c=t.name,l=t.layers,f=(0,h.Z)(l);try{for(f.s();!(s=f.n()).done;){var d=s.value;u(d)}}catch(U){f.e(U)}finally{f.f()}for(;!_a(a);){var p,v=(0,h.Z)(l);try{for(v.s();!(p=v.n()).done;){var g=p.value,m=r[g.name];if(m.name in a){var y=a[m.name];delete a[m.name];var b,x=(0,h.Z)(y);try{for(x.s();!(b=x.n()).done;){var k=b.value;o(m,k)}}catch(U){x.e(U)}finally{x.f()}}}}catch(U){v.e(U)}finally{v.f()}}var w,_=[],C=[],S=t.inputLayers,A=(0,h.Z)(S);try{for(A.s();!(w=A.n()).done;){var E=w.value,T=E[0],N=E[1],D=E[2];fa(T in r);var F=r[T],I=F.inboundNodes[N].outputTensors;_.push(I[D])}}catch(U){A.e(U)}finally{A.f()}var M,O=t.outputLayers,R=(0,h.Z)(O);try{for(R.s();!(M=R.n()).done;){var Z=M.value,B=Z[0],z=Z[1],L=Z[2];fa(B in r);var P=r[B],j=P.inboundNodes[z].outputTensors;C.push(j[L])}}catch(U){R.e(U)}finally{R.f()}return new e({inputs:_,outputs:C,name:c})}}]),n}(eo);function xu(e,t,n){var r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return null}));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"===typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(e.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return e}if("object"===typeof e&&Object.keys(e).length>0&&"object"===typeof e[Object.keys(e)[0]]){var a=[];return t.forEach((function(t){t in e?a.push(e[t]):a.push(null)})),a}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(r," elements or an object with ").concat(t," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(e)))}function ku(e,t){return xu(e,t,"classWeight")}function wu(e,t,n,r){return _u.apply(this,arguments)}function _u(){return(_u=(0,Co.Z)((0,_o.Z)().mark((function e(t,n,r,a){var i,o,u;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&null==a){e.next=2;break}throw new Error("Support sampleWeight is not implemented yet");case 2:if(null==r){e.next=15;break}return i=(0,Re.tidy)((function(){if(1===t.shape.length)return(0,Re.clone)(t);if(2===t.shape.length){if(t.shape[1]>1){return(0,Re.argMax)(t,1)}if(1===t.shape[1])return(0,Re.reshape)(t,[t.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(t.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(t.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),e.t0=Array,e.next=7,i.data();case 7:return e.t1=e.sent,o=e.t0.from.call(e.t0,e.t1),(0,Re.dispose)(i),u=[],o.forEach((function(e){if(null==r[e])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(e," exists in the data but not in ")+"classWeight");u.push(r[e])})),e.abrupt("return",(0,Re.tensor1d)(u,"float32"));case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Cu(e,t){return(0,Re.mul)(e,t)}function Su(e,t){var n,r,a=t;n=a.xs,r=a.ys,Re.util.assert(null!=n&&null!=r,(function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(t)}));var i=Au("input",e.inputNames,n),o=Au("output",e.outputNames,r),u=i[0].shape[0];Re.util.assert(i.length===e.inputs.length,(function(){return"LayersModel has ".concat(e.inputs.length," inputs, but the dataset ")+"provides ".concat(i.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(e.inputNames),")")})),Re.util.assert(o.length===e.outputs.length,(function(){return"LayersModel has ".concat(e.outputs.length," outputs, but the dataset ")+"provides ".concat(o.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(e.outputNames),")")}));for(var s=function(t){Re.util.assert(i[t].shape[0]===u,(function(){return"Batch size mismatch: input "+"".concat(e.inputNames[t]," has ").concat(i[t].shape[0],"; ")+"expected  ".concat(u," based on input ").concat(e.inputNames[0],".")}))},c=0;c<i.length;c++)s(c);for(var l=function(t){Re.util.assert(o[t].shape[0]===u,(function(){return"Batch size mismatch: output "+"".concat(e.outputNames[t]," has ").concat(o[t].shape[0],"; ")+"expected  ".concat(u," based on input ").concat(e.inputNames[0],".")}))},f=0;f<o.length;f++)l(f);return{xs:i,ys:o}}function Au(e,t,n){if(n instanceof Re.Tensor)return[n];if(Array.isArray(n))return Re.util.assert(n.length===t.length,(function(){return"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")})),n;var r,a=[],i=(0,h.Z)(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(null==n[o])throw new oa("The feature data generated by the dataset lacks the required "+"".concat(e," key '").concat(o,"'."));a.push(n[o])}}catch(u){i.e(u)}finally{i.f()}return a}function Eu(e){if(3===e.length)throw new ua("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}function Tu(e,t,n){return Nu.apply(this,arguments)}function Nu(){return Nu=(0,Co.Z)((0,_o.Z)().mark((function e(t,n,r){var a,i,o,u,s,c,l,f,d,h,p,v,g,m,y,b,x,k,w,_,C,S,A,E,T,N,D,F,I,M,O,R,Z;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=r.batchesPerEpoch,Re.util.assert(null!=t.optimizer,(function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."})),Re.util.assert(null!=r,(function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."})),Re.util.assert(null!=r.epochs&&r.epochs>0&&Number.isInteger(r.epochs),(function(){return"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(r.epochs)})),Re.util.assert(!a||r.batchesPerEpoch>0&&Number.isInteger(r.batchesPerEpoch),(function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(r.batchesPerEpoch)})),Re.util.assert(null==r.validationSplit,(function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."})),!t.isTraining){e.next=8;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 8:return t.isTraining=!0,e.prev=9,(i=null!=r.validationData)&&(Fu(r.validationData)?Re.util.assert(null==r.validationBatches||r.validationBatches>0&&Number.isInteger(r.validationBatches),(function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(r.validationBatches)})):(s=Eu(r.validationData),o=s.xs,u=s.ys)),c=t.makeTrainFunction(),l=t.getDedupedMetricsNames(),f=i?l.slice().concat(l.map((function(e){return"val_"+e}))):l.slice(),d=Mo(r.callbacks,r.yieldEvery),h=null==r.verbose?1:r.verbose,p=Ro(d,h,r.epochs,null,null,Du(n,r),null,i,f),v=p.callbackList,g=p.history,v.setModel(t),t.history=g,e.next=22,v.onTrainBegin();case 22:return t.stopTraining_=!1,m=null==r.initialEpoch?0:r.initialEpoch,e.next=26,n.iterator();case 26:y=e.sent;case 27:if(!(m<r.epochs)){e.next=98;break}return b={},e.next=31,v.onEpochBegin(m);case 31:if(x=0,k=0,a){e.next=37;break}return e.next=36,n.iterator();case 36:y=e.sent;case 37:if(a&&!(x<r.batchesPerEpoch)){e.next=91;break}return e.next=40,y.next();case 40:if(w=e.sent,!a||!w.done){e.next=44;break}return console.warn("You provided `batchesPerEpoch` as "+"".concat(r.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(x," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(r.batchesPerEpoch*r.epochs," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("break",91);case 44:if(null==w.value){e.next=73;break}return _=Su(t,w.value),C=_.xs,S=_.ys,(A={}).batch=k,A.size=C[0].shape[0],e.next=51,v.onBatchBegin(k,A);case 51:if(E=[],null==r.classWeight){e.next=64;break}T=ku(r.classWeight,t.outputNames),N=0;case 55:if(!(N<T.length)){e.next=64;break}return e.t0=E,e.next=59,wu(S[N],null,T[N]);case 59:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 61:++N,e.next=55;break;case 64:for(D=C.concat(S).concat(E),F=c(D),Re.dispose(D),I=0;I<l.length;++I)M=l[I],O=F[I],A[M]=O,Re.keep(O);return e.next=70,v.onBatchEnd(k,A);case 70:Eo(A),k++,x++;case 73:if(!(a?x>=r.batchesPerEpoch:w.done)){e.next=87;break}if(!i){e.next=86;break}if(R=void 0,!Fu(r.validationData)){e.next=84;break}return e.t2=pa,e.next=80,t.evaluateDataset(r.validationData,{batches:r.validationBatches});case 80:e.t3=e.sent,R=(0,e.t2)(e.t3),e.next=85;break;case 84:R=pa(t.evaluate(o,u,{batchSize:null==r.validationBatchSize?32:r.validationBatchSize,verbose:0}));case 85:for(Z=0;Z<t.metricsNames.length;++Z)b["val_".concat(t.metricsNames[Z])]=R[Z];case 86:return e.abrupt("break",91);case 87:if(!t.stopTraining_){e.next=89;break}return e.abrupt("break",91);case 89:e.next=37;break;case 91:return e.next=93,v.onEpochEnd(m,b);case 93:if(m++,!t.stopTraining_){e.next=96;break}return e.abrupt("break",98);case 96:e.next=27;break;case 98:return e.next=100,v.onTrainEnd();case 100:return e.next=102,t.history.syncData();case 102:return e.abrupt("return",t.history);case 103:return e.prev=103,t.isTraining=!1,e.finish(103);case 106:case"end":return e.stop()}}),e,null,[[9,,103,106]])}))),Nu.apply(this,arguments)}function Du(e,t){var n=null;return null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function Fu(e){return"function"===typeof e.iterator}function Iu(e){return"function"===typeof e.next}function Mu(e,t,n){return Ou.apply(this,arguments)}function Ou(){return Ou=(0,Co.Z)((0,_o.Z)().mark((function e(t,n,r){var a,i,o,u,s,c,l,f,d;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null!=(r=r||{}).batches,i=t.testFunction,o=[],!(r.verbose>0)){e.next=6;break}throw new ua("Verbose mode is not implemented yet.");case 6:if(Re.util.assert(!a||r.batches>0&&Number.isInteger(r.batches),(function(){return"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(r.batches))})),!Iu(n)){e.next=11;break}e.t0=n,e.next=14;break;case 11:return e.next=13,n.iterator();case 13:e.t0=e.sent;case 14:u=e.t0,s=0,c=0,l=(0,_o.Z)().mark((function e(){var n;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.next();case 2:if(n=e.sent,o=Re.tidy((function(){if(n.value){var e=Su(t,n.value),r=e.xs,a=e.ys,u=r.concat(a),l=Re.tidy((function(){return i(u)}));if(Re.dispose(u),0===c)for(var f=0;f<l.length;++f)o.push((0,Re.scalar)(0));for(var d=u[0].shape[0],h=function(e){var t=l[e],n=o[e];o[e]=Re.tidy((function(){return Re.add(o[e],Re.mul(d,t))})),c>0&&Re.dispose(n)},p=0;p<l.length;++p)h(p);Re.dispose(l),s+=d,++c}return o})),!n.done){e.next=7;break}return a&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(r.batches," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("return","break");case 7:case"end":return e.stop()}}),e)}));case 18:if(a&&!(c<r.batches)){e.next=25;break}return e.delegateYield(l(),"t1",20);case 20:if("break"!==e.t1){e.next=23;break}return e.abrupt("break",25);case 23:e.next=18;break;case 25:for(f=0;f<o.length;++f)d=o[f],o[f]=Re.div(o[f],s),Re.dispose(d);return e.abrupt("return",ha(o));case 27:case"end":return e.stop()}}),e)}))),Ou.apply(this,arguments)}function Ru(e){Re.util.assert(e>0&&Number.isInteger(e),(function(){return"batchSize is required to be a positive integer, but got ".concat(e)}))}function Zu(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((function(e){return ri(e,t,n-t)})):ri(e,t,n-t)}function Bu(e,t){return Re.tidy((function(){return null==e?null:Array.isArray(e)?e.map((function(e){return Bu(e,t)})):fi(e,"int32"===t.dtype?t:Re.cast(t,"int32"))}))}function zu(e,t){for(var n=[],r=0,a=null;r<e;)(a=r+t)>=e&&(a=e),n.push([r,a]),r=a;return n}function Lu(e){var t=[];e instanceof Re.Tensor&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(1===r.rank)t.push(ti(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function Pu(e,t){if(null!=e){var n=[];if(t instanceof Re.Tensor)n.push(t.id);else if(Array.isArray(t))t.forEach((function(e){return n.push(e.id)}));else if(null!=t)for(var r in t){var a=t[r];n.push(a.id)}var i=[];if(e instanceof Re.Tensor)-1===n.indexOf(e.id)&&i.push(e);else if(Array.isArray(e))e.forEach((function(e){-1===n.indexOf(e.id)&&i.push(e)}));else if(null!=e)for(var o in e){var u=e[o];-1===n.indexOf(u.id)&&i.push(u)}i.forEach((function(e){e.isDisposed||e.dispose()}))}}function ju(e){return Array.isArray(e)}function Uu(e){return!function(e){return e instanceof Re.Tensor}(e)&&!ju(e)}function Wu(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){var o=!1;if(ju(e)&&e.length>0)o=!0;else if(Uu(e)){for(var u in e)if(e.hasOwnProperty(u)){o=!0;break}}else o=!0;if(o)throw new oa("Error when checking model ".concat(i," expected no data, ")+"but got ".concat(e))}return[]}if(null==e)return t.map((function(e){return null}));if(Uu(e)){r=[];var s,c=(0,h.Z)(t);try{for(c.s();!(s=c.n()).done;){var l=s.value;if(null==e[l])throw new oa('No data provided for "'.concat(l,'". Need data for each key in: ')+"".concat(t));r.push(e[l])}}catch(m){c.e(m)}finally{c.f()}}else if(ju(e)){if(e.length!==t.length)throw new oa("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(t.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(e));r=e}else{if(t.length>1)throw new oa("The model ".concat(i," expects ").concat(t.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(e.shape));r=[e]}if(r=Lu(r),null!=n)for(var f=0;f<t.length;++f)if(null!=n[f]){var d=r[f];if(d.shape.length!==n[f].length)throw new oa("Error when checking ".concat(i,": expected ").concat(t[f]," ")+"to have ".concat(n[f].length," dimension(s). but got array with ")+"shape ".concat(d.shape));for(var p=0;p<n[f].length;++p)if(0!==p||a){var v=d.shape[p],g=n[f][p];if(null!=g&&g>=0&&v!==g)throw new oa("".concat(i," expected a batch of elements where each ")+"example has shape [".concat(n[f].slice(1,n[f].length),"] ")+"(i.e.,tensor shape [*,".concat(n[f].slice(1,n[f].length),"])")+" but the ".concat(i," received an input with ").concat(d.shape[0])+" examples, each with shape [".concat(d.shape.slice(1,d.shape.length),"]")+" (tensor shape [".concat(d.shape,"])"))}}return r}function Vu(e,t,n){var r=wa(e.map((function(e){return e.shape[0]})));r.sort();var a=wa(t.map((function(e){return e.shape[0]})));if(a.sort(),r.length>1)throw new oa("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((function(e){return e.shape})))));if(a.length>1)throw new oa("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((function(e){return e.shape})))));if(r.length>0&&a.length>0&&!Re.util.arraysEqual(r,a))throw new oa("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(r[0]," input sample(s) and ").concat(a[0]," target ")+"sample(s).")}function Gu(e,t,n){for(var r=[Po,qo,Vo],a=0;a<e.length;++a){var i=e[a],o=t[a],u=n[a];if(null!=o){if(o===Vo&&1===i.shape[i.shape.length-1])throw new oa("You are passing a target array of shape ".concat(i.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o))for(var s=i.shape.slice(1),c=u.slice(1),l=0;l<s.length;++l){var f=s[l],d=c[l];if(null!=d&&f!==d)throw new oa("A target Tensor with shape ".concat(i.shape," was passed for an ")+"output of shape ".concat(u,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}function qu(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new oa("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(t.length," Tensor(s),")+" but instead got ".concat(e.length," Tensors(s)."));r=e}else{if(t.length>1)throw new oa("The model expects ".concat(t.length," ").concat(i," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(e.shape),"."));r=[e]}if(null!=n)for(var o=0;o<t.length;++o)if(null!=n[o]){var u=r[o];if(u.shape.length!==n[o].length)throw new oa("Error when checking ".concat(i,": expected ").concat(t[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(u.shape)));for(var s=0;s<n[o].length;++s)if(0!==s||a){var c=u.shape[s],l=n[o][s];if(null!=l&&l!==c)throw new oa("Error when checking ".concat(i,": expected ")+"".concat(t[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(u.shape),"."))}}}var Hu=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).isTraining=!1,r}return(0,s.Z)(n,[{key:"summary",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new oa("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");cu(this,e,t,n)}},{key:"compile",value:function(e){var t=this;if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"===typeof e.optimizer)this.optimizer_=function(e){var t={Adagrad:function(){return Re.train.adagrad(.01)},Adadelta:function(){return Re.train.adadelta(1,.95,Ja())},Adam:function(){return Re.train.adam(.001,.9,.999,Ja())},Adamax:function(){return Re.train.adamax(.002,.9,.999,Ja(),0)},RMSProp:function(){return Re.train.rmsprop(.001,.9,0,Ja())},SGD:function(){return Re.train.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new oa("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Re.Optimizer))throw new oa("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}var n=[];if(Array.isArray(e.loss)||"string"===typeof e.loss||"function"===typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new oa("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));var r=e.loss;n=r.map((function(e){return Ko(e)}))}else{var a=Ko(e.loss);this.outputs.forEach((function(e){n.push(a)}))}else{for(var i in e.loss=e.loss,e.loss)if(-1===this.outputNames.indexOf(i))throw new oa('Unknown entry in loss dictionary: "'.concat(i,'". ')+"Only expected the following keys: ".concat(this.outputNames));var o,u=(0,h.Z)(this.outputNames);try{for(u.s();!(o=u.n()).done;){var s=o.value;null==e.loss[s]&&console.warn('Output "'.concat(s,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(s," during training")),n.push(Ko(e.loss[s]))}}catch(v){u.e(v)}finally{u.f()}}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var c=0;c<this.outputs.length;++c){var l=this.internalOutputShapes[c],f=this.outputNames[c];this.feedOutputNames.push(f),this.feedOutputShapes.push(l),this.feedLossFns.push(this.lossFunctions[c])}var d=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Wa("loss",(function(){for(var e=0;e<t.outputs.length;++e)if(-1===d.indexOf(e)){var n=t.lossFunctions[e];t.outputs.length>1&&(t.metricsTensors.push([n,e]),t.metricsNames.push(t.outputNames[e]+"_loss"))}}));var p=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return[]}));var n;if("string"===typeof e||"function"===typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!==typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(e));n=e}if(Array.isArray(n))return t.map((function(e){return n}));var r,a=[],i=(0,h.Z)(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,u=n.hasOwnProperty(o)?n[o]:[];Array.isArray(u)||(u=[u]),a.push(u)}}catch(v){i.e(v)}finally{i.f()}return a}(e.metrics,this.outputNames);Wa("metric",(function(){for(var e=function(e){if(-1!==d.indexOf(e))return"continue";!function(n){var r,a,i,o,u=(0,h.Z)(n);try{var s=function(){var n,u=o.value;if("string"===typeof u&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(u)){var s,c=t.internalOutputShapes[e];1===c[c.length-1]||t.lossFunctions[e]===qo?-1!==["accuracy","acc"].indexOf(u)?a=$o:-1!==["crossentropy","ce"].indexOf(u)&&(a=eu):t.lossFunctions[e]===Go?-1!==["accuracy","acc"].indexOf(u)?a=tu:-1!==["crossentropy","ce"].indexOf(u)&&(a=ru):-1!==["accuracy","acc"].indexOf(u)?a=Qo:-1!==["crossentropy","ce"].indexOf(u)&&(a=nu),-1!==["accuracy","acc"].indexOf(u)?s="acc":-1!==["crossentropy","ce"].indexOf(u)&&(s="ce"),i=a,r=""+s}else{var l=function(e){if("string"===typeof e&&e in au)return au[e];if("string"!==typeof e&&null!=e)return e;throw new oa("Unknown metric ".concat(e))}(u);i=l,r=""+iu(u)}Wa(r,(function(){n=i})),function(e,n,r){t.outputNames.length>1&&(n=t.outputNames[e]+"_"+n),t.metricsNames.push(n),t.metricsTensors.push([r,e])}(e,r,n)};for(u.s();!(o=u.n()).done;)s()}catch(v){u.e(v)}finally{u.f()}}(p[e])},n=0;n<t.outputs.length;++n)e(n)})),this.collectedTrainableWeights=this.trainableWeights}},{key:"checkTrainableWeightsConsistency",value:function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null==n.batchSize?32:n.batchSize;Ru(r);var a=!0,i=this.standardizeUserDataXY(e,t,a,r);try{var o=i[0].concat(i[1]);this.makeTestFunction();var u=this.testFunction,s=this.testLoop(u,o,r,n.verbose,n.steps);return ha(s)}finally{Pu(i[0],e),Pu(i[1],t)}}},{key:"evaluateDataset",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.makeTestFunction(),e.abrupt("return",Mu(this,t,n));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"checkNumSamples",value:function(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=t)throw new oa("If ".concat(a," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else{if(null==e)throw new oa("Either the input data should have a defined shape, or "+"".concat(a," shoud be specified."));r=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return r}},{key:"execute",value:function(e,t){if(Array.isArray(t)&&0===t.length)throw new oa("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(t),r=n?t:[t],a=this.retrieveSymbolicTensors(r),i=new ao;if(e instanceof Re.Tensor&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new oa("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(var o=0;o<this.inputs.length;++o)i.add(this.inputs[o],e[o])}else{var u,s=(0,h.Z)(this.inputs);try{for(s.s();!(u=s.n()).done;){var c=u.value,l=e[c.name];if(null==l)throw new oa("No value is provided for the model's input ".concat(c.name));i.add(c,l)}}catch(d){s.e(d)}finally{s.f()}}var f=uo(a,i);return n?f:f[0]}},{key:"retrieveSymbolicTensors",value:function(e){var t,n=la(null,e.length),r=e.length,a=(0,h.Z)(this.layers);try{for(a.s();!(t=a.n()).done;){for(var i=t.value,o=Array.isArray(i.output)?i.output:[i.output],u=o.map((function(e){return e.name})),s=0;s<e.length;++s){var c=u.indexOf(e[s]);if(-1!==c&&(n[s]=o[c],r--),0===r)break}if(0===r)break}}catch(f){a.e(f)}finally{a.f()}if(r>0){var l=[];throw n.forEach((function(t,n){null==t&&l.push(e[n])})),new oa("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(l)))}return n}},{key:"predictLoop",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Re.tidy((function(){var a=t.checkNumSamples(e);if(r)throw new ua("Verbose predictLoop() is not implemented yet.");for(var i=zu(a,n),o=t.outputs.map((function(e){return[]})),u=function(n){Re.tidy((function(){var r=i[n][0],a=i[n][1],o=Zu(e,r,a),u=[];if(Array.isArray(o))for(var s=0;s<o.length;++s)u.push({key:t.inputs[s],value:o[s]});else u.push({key:t.inputs[0],value:o});var c=new ao(u);return uo(t.outputs,c)})).forEach((function(e,t){return o[t].push(e)}))},s=0;s<i.length;++s)u(s);return ha(o.map((function(e){return Re.concat(e,0)})))}))}},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Lu(e);qu(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==t.batchSize?32:t.batchSize;return Ru(r),this.predictLoop(n,r)}finally{Pu(n,e)}}},{key:"predictOnBatch",value:function(e){qu(e,this.inputNames,this.feedInputShapes,!0);var t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}},{key:"standardizeUserDataXY",value:function(e,t){var n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new ia("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var r=[],a=0;a<this.feedOutputShapes.length;++a){var i=this.feedOutputShapes[a],o=this.feedLossFns[a];o===Go?r.push(i.slice(0,i.length-1).concat([1])):r.push(i)}if(Vu(e=Wu(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=Wu(t,this.feedOutputNames,r,!1,"target")),Gu(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!==0)throw new oa("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}},{key:"standardizeUserData",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n,r,a){var o,u,s,c,l,f,d,h,p,v=arguments;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=!(v.length>4&&void 0!==v[4])||v[4],u=v.length>5?v[5]:void 0,s=this.standardizeUserDataXY(t,n,o,u),c=(0,i.Z)(s,2),l=c[0],f=c[1],null==r){e.next=5;break}throw new Error("sample weight is not supported yet.");case 5:if(d=null,null==a){e.next=19;break}h=ku(a,this.outputNames),d=[],p=0;case 10:if(!(p<h.length)){e.next=19;break}return e.t0=d,e.next=14,wu(f[p],null,h[p]);case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 16:++p,e.next=10;break;case 19:return e.abrupt("return",[l,f,d]);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"testLoop",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0;return Re.tidy((function(){var o=r.checkNumSamples(t,n,i,"steps"),u=[];if(a>0)throw new ua("Verbose mode is not implemented yet.");if(null!=i)throw new ua("steps mode in testLoop() is not implemented yet");for(var s=zu(o,n),c=(0,Re.tensor1d)(Qa(0,o)),l=0;l<s.length;++l){var f=s[l][0],d=s[l][1],h=ri(c,f,d-f),p=Bu(t,h),v=e(p);if(0===l)for(var g=0;g<v.length;++g)u.push((0,Re.scalar)(0));for(var m=0;m<v.length;++m){var y=v[m];u[m]=Re.add(u[m],Re.mul(d-f,y))}}for(var b=0;b<u.length;++b)u[b]=Re.div(u[b],o);return u}))}},{key:"getDedupedMetricsNames",value:function(){for(var e=this.metricsNames,t=[],n=0;n<e.length;++n){var r=e[n],a=r;if(da(e,r)>1){var i=da(e.slice(0,n),r);a+="_".concat(i)}t.push(a)}return t}},{key:"makeTrainFunction",value:function(){var e=this;return function(t){var n=[],r=t.slice(0,e.inputs.length),a=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),i=t.slice(e.inputs.length+e.outputs.length,e.inputs.length+2*e.outputs.length),o=[],u=e.collectedTrainableWeights.map((function(e){return e.read()}));return[e.optimizer_.minimize((function(){for(var t=[],u=0;u<e.inputs.length;++u)t.push({key:e.inputs[u],value:r[u]});for(var s,c=new ao(t),l=uo(e.outputs,c,{training:!0}),f=0;f<e.lossFunctions.length;++f){var d=(0,e.lossFunctions[f])(a[f],l[f]);null!=i[f]&&(d=Cu(d,i[f]));var h=Re.mean(d);n.push(h),s=0===f?d:Re.add(s,d)}for(var p=0;p<e.metricsTensors.length;++p){var v=void 0;if(e.outputs.length>1&&p<e.outputs.length)v=n[p];else{var g=e.metricsTensors[p][0],m=e.metricsTensors[p][1];v=Re.mean(g(a[m],l[m]))}Re.keep(v),o.push(v)}return s=Re.mean(s),e.calculateLosses().forEach((function(e){s=Re.add(s,e)})),s}),!0,u)].concat(o)}}},{key:"makeTestFunction",value:function(){var e=this;this.testFunction=function(t){return Re.tidy((function(){for(var n,r=[],a=t.slice(0,e.inputs.length),i=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),o=[],u=0;u<e.inputs.length;++u)o.push({key:e.inputs[u],value:a[u]});for(var s=new ao(o),c=uo(e.outputs,s),l=0;l<e.lossFunctions.length;++l){var f=e.lossFunctions[l],d=Re.mean(f(i[l],c[l]));n=0===l?d:Re.add(n,d),r.push(n)}for(var h=0;h<e.metricsTensors.length;++h){var p=e.metricsTensors[h][0],v=e.metricsTensors[h][1],g=Re.mean(p(i[v],c[v]));r.push(g)}return r}))}}},{key:"fit",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){var r,a,i,o,u,s,c,l,f,d,h,p,v,g,m,y,b,x,k,w,_,C,S,A,E,T,N=arguments;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=N.length>2&&void 0!==N[2]?N[2]:{},!this.isTraining){e.next=3;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 3:return this.isTraining=!0,e.prev=4,Ru(h=null==r.batchSize?32:r.batchSize),p=!1,e.next=10,this.standardizeUserData(t,n,r.sampleWeight,r.classWeight,p,h);case 10:if(v=e.sent,a=v[0],i=v[1],d=v[2],g=!1,!(null!=r.validationData&&r.validationData.length>0)){e.next=36;break}if(g=!0,2!==r.validationData.length){e.next=22;break}s=r.validationData[0],c=r.validationData[1],e.next=27;break;case 22:if(3!==r.validationData.length){e.next=26;break}throw new ua("validationData including sample weights is not supported yet.");case 26:throw new oa("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(r.validationData," is invalid."));case 27:return y=!0,e.next=30,this.standardizeUserData(s,c,null,null,y,h);case 30:b=e.sent,l=b[0],f=b[1],m=l.concat(f),e.next=37;break;case 36:null!=r.validationSplit&&r.validationSplit>0&&r.validationSplit<1?(g=!0,x=Math.floor(a[0].shape[0]*(1-r.validationSplit)),k=a[0].shape[0],l=Zu(a,x,k),o=a,a=Zu(a,0,x),f=Zu(i,x,k),u=i,i=Zu(i,0,x),m=l.concat(f)):null!=r.validationSteps&&(g=!0);case 37:return w=a.concat(i).concat(d),this.checkTrainableWeightsConsistency(),_=this.makeTrainFunction(),C=this.getDedupedMetricsNames(),g?(this.makeTestFunction(),S=this.testFunction,A=C.slice().concat(C.map((function(e){return"val_"+e})))):(S=null,m=[],A=C.slice()),E=Mo(r.callbacks,r.yieldEvery),e.next=45,this.fitLoop(_,w,C,h,r.epochs,r.verbose,E,S,m,r.shuffle,A,r.initialEpoch,null,null);case 45:return T=e.sent,e.abrupt("return",T);case 47:return e.prev=47,this.isTraining=!1,Pu(a,t),Pu(i,n),Pu(o,t),Pu(u,n),Pu(l,s),Pu(f,c),null!=d&&Re.dispose(d),e.finish(47);case 57:case"end":return e.stop()}}),e,this,[[4,,47,57]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitLoop",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n,r,a,i,o,u,s,c,l,f,d,h,p){var v,g,m,y,b,x,k,w,_=this;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==a&&(a=32),null==i&&(i=1),null==l&&(l=!0),null==d&&(d=0),v=!1,null!=s&&null!=c&&(v=!0),null==p){e.next=10;break}if(v=!0,null!=h){e.next=10;break}throw new oa("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");case 10:return null!=(g=this.checkNumSamples(n,a,h,"steps_per_epoch"))&&(m=Qa(0,g)),null==o&&(o=1),y=Ro(u,o,i,d,g,h,a,v,f),b=y.callbackList,x=y.history,b.setModel(this),this.history=x,e.next=18,b.onTrainBegin();case 18:this.stopTraining_=!1,k=(0,_o.Z)().mark((function e(){var i,o,u,f,d;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.onEpochBegin(w);case 2:if(i={},null==h){e.next=7;break}throw new ua("stepsPerEpoch mode is not implemented yet.");case 7:if("batch"!==l){e.next=11;break}throw new ua("batch shuffling is not implemneted yet");case 11:l&&Re.util.shuffle(m);case 12:o=(0,Re.tensor1d)(m),u=zu(g,a),f=(0,_o.Z)().mark((function e(l){var f;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f={},e.next=3,b.onBatchBegin(l,f);case 3:return Re.tidy((function(){var e=u[l][0],d=u[l][1],h=ri(o,e,d-e);f.batch=l,f.size=d-e;for(var p=Bu(n,h),g=t(p),m=0;m<r.length;++m){var y=r[m],b=g[m];f[y]=b,Re.keep(b)}if(l===u.length-1&&v)for(var x=_.testLoop(s,c,a),k=0;k<r.length;++k){var w=r[k],C=x[k];Re.keep(C),i["val_"+w]=C}})),e.next=6,b.onBatchEnd(l,f);case 6:if(Eo(f),!_.stopTraining_){e.next=9;break}return e.abrupt("return","break");case 9:case"end":return e.stop()}}),e)})),d=0;case 16:if(!(d<u.length)){e.next=24;break}return e.delegateYield(f(d),"t0",18);case 18:if("break"!==e.t0){e.next=21;break}return e.abrupt("break",24);case 21:++d,e.next=16;break;case 24:o.dispose();case 25:return e.next=27,b.onEpochEnd(w,i);case 27:if(!_.stopTraining_){e.next=29;break}return e.abrupt("return","break");case 29:case"end":return e.stop()}}),e)})),w=d;case 21:if(!(w<i)){e.next=29;break}return e.delegateYield(k(),"t0",23);case 23:if("break"!==e.t0){e.next=26;break}return e.abrupt("break",29);case 26:++w,e.next=21;break;case 29:return e.next=31,b.onTrainEnd();case 31:return e.next=33,this.history.syncData();case 33:return e.abrupt("return",this.history);case 34:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a,i,o,u,s,c,l,f,d,h,p){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Tu(this,t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){var r,a,i,o,u,s,c,l,f,d;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.standardizeUserData(t,n);case 2:r=e.sent,a=r[0],i=r[1],o=this.makeTrainFunction(),u=o(a.concat(i)),s=[],c=(0,h.Z)(u),e.prev=9,c.s();case 11:if((l=c.n()).done){e.next=19;break}return f=l.value,e.next=15,f.data();case 15:d=e.sent,s.push(d[0]);case 17:e.next=11;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(9),c.e(e.t0);case 24:return e.prev=24,c.f(),e.finish(24);case 27:return Re.dispose(u),Pu(r[0],t),Pu(r[1],n),e.abrupt("return",ha(s));case 31:case"end":return e.stop()}}),e,this,[[9,21,24,27]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getNamedWeights",value:function(e){for(var t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n),i=0;i<r.length;++i)n&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}},{key:"stopTraining",get:function(){return this.stopTraining_},set:function(e){this.stopTraining_=e}},{key:"optimizer",get:function(){return this.optimizer_},set:function(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}},{key:"dispose",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"dispose",this).call(this);if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var t=Re.memory().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-Re.memory().numTensors}return e}},{key:"getLossIdentifiers",value:function(){var e;if("string"===typeof this.loss)e=va(this.loss);else if(Array.isArray(this.loss)){var t,n=(0,h.Z)(this.loss);try{for(n.s();!(t=n.n()).done;){if("string"!==typeof t.value)throw new Error("Serialization of non-string loss is not supported.")}}catch(s){n.e(s)}finally{n.f()}e=this.loss.map((function(e){return va(e)}))}else{var r=Object.keys(this.loss);e={};for(var a=this.loss,i=0,o=r;i<o.length;i++){var u=o[i];if("string"!==typeof a[u])throw new Error("Serialization of non-string loss is not supported.");e[u]=va(a[u])}}return e}},{key:"getMetricIdentifiers",value:function(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[va(iu(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((function(e){return va(iu(e))}));var e={};for(var t in this.metrics)e[t]=va(iu(this.metrics[t]));return e}},{key:"getTrainingConfig",value:function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}},{key:"loadTrainingConfig",value:function(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var t,n,r=zo(gu(e.optimizer_config));if("string"===typeof e.loss)t=ga(e.loss);else if(Array.isArray(e.loss))t=e.loss.map((function(e){return ga(e)}));else if(null!=e.loss)for(var a in t={},e.loss)t[a]=ga(e.loss[a]);if(Array.isArray(e.metrics))n=e.metrics.map((function(e){return ga(e)}));else if(null!=e.metrics)for(var i in n={},e.metrics)n[i]=ga(e.metrics[i]);this.compile({loss:t,metrics:n,optimizer:r})}},{key:"save",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){var r,a,i,u,s,c,l,f,d;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=9;break}if(0!==(r=Re.io.getSaveHandlers(t)).length){e.next=6;break}throw new oa("Cannot find any save handlers for URL '".concat(t,"'"));case 6:if(!(r.length>1)){e.next=8;break}throw new oa("Found more than one (".concat(r.length,") save handlers for ")+"URL '".concat(t,"'"));case 8:t=r[0];case 9:if(null!=t.save){e.next=11;break}throw new oa("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return e.next=13,Re.io.encodeWeights(this.getNamedWeights(n));case 13:if(a=e.sent,!1,null,i=this.toJSON(null,false),u={modelTopology:i,format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(yu),convertedBy:null},!(null!=n&&n.includeOptimizer)||null==this.optimizer){e.next=34;break}return u.trainingConfig=this.getTrainingConfig(),c="optimizer",e.t0=Re.io,e.next=25,this.optimizer.getWeights();case 25:return e.t1=e.sent,e.t2=c,e.next=29,e.t0.encodeWeights.call(e.t0,e.t1,e.t2);case 29:l=e.sent,f=l.data,d=l.specs,(s=a.specs).push.apply(s,(0,o.Z)(d)),a.data=Re.io.concatenateArrayBuffers([a.data,f]);case 34:return null!=this.userDefinedMetadata&&(!0,uu(this.userDefinedMetadata,this.name,true),u.userDefinedMetadata=this.userDefinedMetadata),u.weightData=a.data,u.weightSpecs=a.specs,e.abrupt("return",t.save(u));case 38:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setUserDefinedMetadata",value:function(e){uu(e,this.name),this.userDefinedMetadata=e}},{key:"getUserDefinedMetadata",value:function(){return this.userDefinedMetadata}}]),n}(bu);Hu.className="Model",Re.serialization.registerClass(Hu);var Xu=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n)}(Hu);Xu.className="Functional",Re.serialization.registerClass(Xu);var Yu=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),e=e||{},(r=t.call(this,{inputs:[],outputs:[]})).trainable=!0,r.built=!1,r.name=null!=e.name?e.name:Ia("sequential_"),null!=e.layers){var a,i=(0,h.Z)(e.layers);try{for(i.s();!(a=i.n()).done;){var o=a.value;r.add(o)}}catch(s){i.e(s)}finally{i.f()}}return r}return(0,s.Z)(n,[{key:"checkShape",value:function(e){if(e.inboundNodes[0].outputTensors[0].shape.some((function(e){return e<0})))throw new oa("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}},{key:"add",value:function(e){var t,r=e instanceof n||e instanceof Hu;if(r){if(1!==(t=e).outputs.length)throw new oa("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==t.inputs.length)throw new oa("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new oa("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var a=ro({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(a)}if(r)this.outputs=t.outputs,this.inputs=t.inputs;else{if(1!==e.inboundNodes.length)throw new oa("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new oa("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=to(this.outputs[0])}this.inboundNodes=[],new Qi({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:la(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(e){return e.shape})),outputShapes:this.outputs[0].shape})}else{var i=e.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}},{key:"pop",value:function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}},{key:"call",value:function(e,t){return null==this.model&&this.build(),this.model.call(e,t)}},{key:"build",value:function(e){if(Wi(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Hu({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}},{key:"countParams",value:function(){return this.built||this.build(),(0,Zo.Z)((0,Bo.Z)(n.prototype),"countParams",this).call(this)}},{key:"summary",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),(0,Zo.Z)((0,Bo.Z)(n.prototype),"summary",this).call(this,e,t,r)}},{key:"setWeights",value:function(e){null==this.model&&this.build(),this.model.setWeights(e)}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new ia("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}},{key:"evaluateDataset",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new ia("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.evaluateDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}},{key:"predictOnBatch",value:function(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}},{key:"compile",value:function(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}},{key:"optimizer",get:function(){return null==this.model?void 0:this.model.optimizer},set:function(e){this.model.optimizer=e}},{key:"fit",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){var r,a=arguments;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>2&&void 0!==a[2]?a[2]:{},this.built){e.next=3;break}throw new ia("The model needs to be compiled before being used.");case 3:return e.abrupt("return",this.model.fit(t,n,r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"fitDataset",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new ia("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.fitDataset(t,n));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"trainOnBatch",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.model.trainOnBatch(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stopTraining",get:function(){if(null==this.model)throw new oa("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(e){if(null==this.model)throw new oa("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}},{key:"getConfig",value:function(){var e,t=[],n=(0,h.Z)(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value,a={};a.className=r.getClassName(),a.config=r.getConfig(),t.push(a)}}catch(i){n.e(i)}finally{n.f()}return{name:this.name,layers:t}}}],[{key:"fromConfig",value:function(e,t){var r,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new oa("Legacy serialization format not supported yet.");r=t}else Re.util.assert(null!=t.layers,(function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."})),r=t.layers,delete t.layers,i=t;var o=new e(i);if(!(o instanceof n))throw new ua("Sequential.fromConfig called on non-Sequential input: ".concat(o));var u,s=(0,h.Z)(r);try{for(s.s();!(u=s.n()).done;){var c=u.value,l=void 0,f=zo(c,l,a);a&&f.setFastWeightInitDuringBuild(!0),o.add(f)}}catch(d){s.e(d)}finally{s.f()}return o}}]),n}(Hu);function Ku(e){return new Yu(e)}Yu.className="Sequential",Re.serialization.registerClass(Yu);var $u=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"getConfig",value:function(){return{}}}]),n}(Re.serialization.Serializable),Qu=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return vi(e,t)}}]),n}($u);Qu.className="elu",Re.serialization.registerClass(Qu);var Ju=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e){return Re.selu(e)}}]),n}($u);Ju.className="selu",Re.serialization.registerClass(Ju);var es=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e){return Re.relu(e)}}]),n}($u);es.className="relu",Re.serialization.registerClass(es);var ts=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e){return(0,Re.tidy)((function(){return Re.minimum(6,Re.relu(e))}))}}]),n}($u);ts.className="relu6",Re.serialization.registerClass(ts);var ns=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e){return e}}]),n}($u);ns.className="linear",Re.serialization.registerClass(ns);var rs=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e){return Re.sigmoid(e)}}]),n}($u);rs.className="sigmoid",Re.serialization.registerClass(rs);var as=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e){return function(e){return(0,Re.tidy)((function(){var t=Re.add(.5,Re.mul(.2,e));return Re.clipByValue(t,0,1)}))}(e)}}]),n}($u);as.className="hardSigmoid",Re.serialization.registerClass(as);var is=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e){return Re.softplus(e)}}]),n}($u);is.className="softplus",Re.serialization.registerClass(is);var os=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e){return function(e){return(0,Re.tidy)((function(){return Re.div(e,Re.add(Re.abs(e),1))}))}(e)}}]),n}($u);os.className="softsign",Re.serialization.registerClass(os);var us=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e){return Re.tanh(e)}}]),n}($u);us.className="tanh",Re.serialization.registerClass(us);var ss=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return Re.softmax(e,t)}}]),n}($u);ss.className="softmax",Re.serialization.registerClass(ss);var cs=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return Re.logSoftmax(e,t)}}]),n}($u);cs.className="logSoftmax",Re.serialization.registerClass(cs);var ls=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(0,Re.tidy)((function(){return Re.mul(Re.sigmoid(Re.mul(e,t)),e)}))}}]),n}($u);ls.className="swish",Re.serialization.registerClass(ls);var fs=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e){return(0,Re.tidy)((function(){return Re.mul(e,Re.tanh(Re.softplus(e)))}))}}]),n}($u);function ds(e){return e.getClassName()}function hs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return xa(e,Re.serialization.SerializationMap.getMap().classNameMap,t,"activation")}function ps(e){if(null==e){var t={className:"linear",config:{}};return hs(t)}if("string"===typeof e){var n={};return n.className=e,n.config={},hs(n)}return e instanceof $u?e:hs(e)}function vs(e){if(null!=e&&"object"!==typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(e))}fs.className="mish",Re.serialization.registerClass(fs);var gs=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n)}(Re.serialization.Serializable),ms=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),r=t.call(this),vs(e),r.l1=null==e||null==e.l1?.01:e.l1,r.l2=null==e||null==e.l2?.01:e.l2,r.hasL1=0!==r.l1,r.hasL2=0!==r.l2,r}return(0,s.Z)(n,[{key:"apply",value:function(e){var t=this;return(0,Re.tidy)((function(){var n=(0,Re.zeros)([1]);return t.hasL1&&(n=(0,Re.add)(n,(0,Re.sum)(Re.mul(t.l1,(0,Re.abs)(e))))),t.hasL2&&(n=(0,Re.add)(n,(0,Re.sum)(Re.mul(t.l2,di(e))))),Re.reshape(n,[])}))}},{key:"getConfig",value:function(){return{l1:this.l1,l2:this.l2}}}],[{key:"fromConfig",value:function(e,t){return new e({l1:t.l1,l2:t.l2})}}]),n}(gs);ms.className="L1L2",Re.serialization.registerClass(ms);var ys={l1l2:"L1L2"};function bs(e){return ya(e)}function xs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return xa(e,Re.serialization.SerializationMap.getMap().classNameMap,t,"regularizer")}function ks(e){return null==e?null:"string"===typeof e?xs({className:e in ys?ys[e]:e,config:{}}):e instanceof gs?e:xs(e)}var ws=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,null!=e&&(r.maxValue=e.maxValue),r}return(0,s.Z)(n,[{key:"call",value:function(e,t){e=Ui(e);var n=(0,Re.relu)(e);return null!=this.maxValue&&(n=(0,Re.clipByValue)(n,0,this.maxValue)),n}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={maxValue:this.maxValue},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);ws.className="ReLU",Re.serialization.registerClass(ws);var _s=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=.3,null==e&&(e={}),r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return(0,s.Z)(n,[{key:"call",value:function(e,t){var n=Ui(e);return(0,Re.leakyRelu)(n,this.alpha)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);_s.className="LeakyReLU",Re.serialization.registerClass(_s);var Cs=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),r.supportsMasking=!0,r.alphaInitializer=Li(e.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=ks(e.alphaRegularizer),r.alphaConstraint=ko(e.alphaConstraint),null==e.sharedAxes)r.sharedAxes=null;else if(Array.isArray(e.sharedAxes))r.sharedAxes=e.sharedAxes;else{if("number"!==typeof e.sharedAxes)throw new oa("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes));r.sharedAxes=[e.sharedAxes]}return r}return(0,s.Z)(n,[{key:"build",value:function(e){var t=(e=Wi(e)).slice(1);if(null!=this.sharedAxes){var n,r=(0,h.Z)(this.sharedAxes);try{for(r.s();!(n=r.n()).done;){t[n.value-1]=1}}catch(o){r.e(o)}finally{r.f()}}this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var a={};if(null!=this.sharedAxes)for(var i=1;i<e.length;++i)a[i]=e[i];this.inputSpec=[new Yi({ndim:e.length,axes:a})],this.built=!0}},{key:"call",value:function(e,t){return e=Ui(e),(0,Re.prelu)(e,this.alpha.read())}},{key:"getConfig",value:function(){var e={alphaInitializer:zi(this.alphaInitializer),alphaRegularizer:bs(this.alphaRegularizer),alphaConstraint:bo(this.alphaConstraint),sharedAxes:this.sharedAxes},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);Cs.className="PReLU",Re.serialization.registerClass(Cs);var Ss=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==r.DEFAULT_ALPHA)throw new ua("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");return r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return(0,s.Z)(n,[{key:"call",value:function(e,t){var n=Ui(e);return(0,Re.elu)(n)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);Ss.className="ELU",Re.serialization.registerClass(Ss);var As=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_THETA=1,null==e&&(e={}),r.theta=null==e.theta?r.DEFAULT_THETA:e.theta,r}return(0,s.Z)(n,[{key:"call",value:function(e,t){var n=Ui(e);return(0,Re.mul)(n,(0,Re.cast)((0,Re.greater)(n,this.theta),"float32"))}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={theta:this.theta},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);As.className="ThresholdedReLU",Re.serialization.registerClass(As);var Es=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_AXIS=1,null==e&&(e={}),r.softmax=(new ss).apply,r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r}return(0,s.Z)(n,[{key:"call",value:function(e,t){var n=Ui(e);return this.softmax(n,this.axis)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={axis:this.axis},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);Es.className="Softmax",Re.serialization.registerClass(Es);var Ts=n(4942);function Ns(e,t,n){if("number"===typeof e)return la(e,t);if(e.length!==t)throw new oa("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers.")+" Received: ".concat(e.length," elements."));for(var r=0;r<t;++r){var a=e[r];if((i=a)!==parseInt(i.toString(),10))throw new oa("The ".concat(n," argument must be an integer or tuple of ").concat(t)+" integers. Received: ".concat(JSON.stringify(e)," including a")+" non-integer number ".concat(a))}return e;var i}function Ds(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(null==e)return e;var i,o=t+(t-1)*(a-1);return i="same"===n?e:e-o+1,Math.floor((i+r-1)/r)}function Fs(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+$a([n-t,0]);else{if("same"!==r)throw new oa("Unsupport padding mode: ".concat(r,"."));e*=t}return e}function Is(e,t){return(0,Re.tidy)((function(){return La(t),"channelsFirst"===t?Re.transpose(e,[0,2,3,1]):e}))}function Ms(e,t){return(0,Re.tidy)((function(){return La(t),"channelsFirst"===t?Re.transpose(e,[0,2,3,4,1]):e}))}function Os(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return(0,Re.tidy)((function(){if(null==i&&(i="channelsLast"),La(i),3!==e.shape.length)throw new oa("The input of a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new oa("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new oa("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(t.shape.length," instead"));if("channelsFirst"===i&&(e=Re.transpose(e,[0,2,1])),"causal"===a)throw new ua("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var u=Re.conv1d(e,t,r,"same"===a?"same":"valid","NWC",o);return null!=n&&(u=pi(u,n)),u}))}function Rs(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return(0,Re.tidy)((function(){if(null==i&&(i="channelsLast"),La(i),3!==e.rank&&4!==e.rank)throw new oa("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new oa("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));var s=Is(e,i);if("causal"===a)throw new ua("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return s=Re.fused.conv2d({x:s,filter:t,strides:r,pad:"same"===a?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:u}),"channelsFirst"===i&&(s=Re.transpose(s,[0,3,1,2])),s}))}function Zs(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return(0,Re.tidy)((function(){if(null==i&&(i="channelsLast"),La(i),4!==e.rank&&5!==e.rank)throw new oa("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new oa("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(e.rank,"."));var u=Ms(e,i);if("causal"===a)throw new ua("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return u=Re.conv3d(u,t,r,"same"===a?"same":"valid","NDHWC",o),null!=n&&(u=pi(u,n)),"channelsFirst"===i&&(u=Re.transpose(u,[0,4,1,2,3])),u}))}var Bs=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;if((0,u.Z)(this,n),(a=t.call(this,r)).bias=null,a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_BIAS_INITIALIZER="zeros",n.verifyArgs(r),a.rank=e,Aa(a.rank,"rank"),1!==a.rank&&2!==a.rank&&3!==a.rank)throw new ua("Convolution layer for rank other than 1, 2, or 3 (".concat(a.rank,") is ")+"not implemented yet.");if(a.kernelSize=Ns(r.kernelSize,e,"kernelSize"),a.strides=Ns(null==r.strides?1:r.strides,e,"strides"),a.padding=null==r.padding?"valid":r.padding,Pa(a.padding),a.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,La(a.dataFormat),a.activation=ps(r.activation),a.useBias=null==r.useBias||r.useBias,a.biasInitializer=Li(r.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.biasConstraint=ko(r.biasConstraint),a.biasRegularizer=ks(r.biasRegularizer),a.activityRegularizer=ks(r.activityRegularizer),a.dilationRate=Ns(null==r.dilationRate?1:r.dilationRate,e,"dilationRate"),1===a.rank&&Array.isArray(a.dilationRate)&&1!==a.dilationRate.length)throw new oa("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(a.dilationRate)));if(2===a.rank){if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate];else if(2!==a.dilationRate.length)throw new oa("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)))}else if(3===a.rank)if("number"===typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate,a.dilationRate];else if(3!==a.dilationRate.length)throw new oa("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)));return a}return(0,s.Z)(n,[{key:"getConfig",value:function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:ds(this.activation),useBias:this.useBias,biasInitializer:zi(this.biasInitializer),biasRegularizer:bs(this.biasRegularizer),activityRegularizer:bs(this.activityRegularizer),biasConstraint:bo(this.biasConstraint)},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(fa("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!==typeof e.kernelSize&&!Sa(e.kernelSize,"number",1,3))throw new oa("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(eo),zs=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;return(0,u.Z)(this,n),(a=t.call(this,e,r)).kernel=null,n.verifyArgs(r),a.filters=r.filters,Aa(a.filters,"filters"),a.kernelInitializer=Li(r.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.kernelConstraint=ko(r.kernelConstraint),a.kernelRegularizer=ks(r.kernelRegularizer),a}return(0,s.Z)(n,[{key:"build",value:function(e){e=Wi(e);var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new oa("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));var n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:(0,Ts.Z)({},t,n)}],this.built=!0}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){var t;e=Ui(e);var r=null==n.bias?null:n.bias.read(),a=Ta(n.activation.getClassName());if(null!=a&&2===n.rank)t=Rs(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate,a);else{if(1===n.rank)t=Os(e,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)t=Rs(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new ua("convolutions greater than 3D are not implemented yet.");t=Zs(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate)}null!=n.activation&&(t=n.activation.apply(t))}return t}))}},{key:"computeOutputShape",value:function(e){e=Wi(e);for(var t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2),r=0;r<n.length;++r){var a=Ds(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);t.push(a)}var i=[e[0]];return"channelsLast"===this.dataFormat?(i=i.concat(t)).push(this.filters):(i.push(this.filters),i=i.concat(t)),i}},{key:"getConfig",value:function(){var e={filters:this.filters,kernelInitializer:zi(this.kernelInitializer),kernelRegularizer:bs(this.kernelRegularizer),kernelConstraint:bo(this.kernelConstraint)},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(!("filters"in e)||"number"!==typeof e.filters||e.filters<1)throw new oa("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}}]),n}(Bs),Ls=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),r=t.call(this,2,e),n.verifyArgs(e),r}return(0,s.Z)(n,[{key:"getConfig",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!Sa(e.kernelSize,"number",1,2))throw new oa("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(zs);Ls.className="Conv2D",Re.serialization.registerClass(Ls);var Ps=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),r=t.call(this,3,e),n.verifyArgs(e),r}return(0,s.Z)(n,[{key:"getConfig",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new oa("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(zs);Ps.className="Conv3D",Re.serialization.registerClass(Ps);var js=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),(r=t.call(this,e)).inputSpec=[new Yi({ndim:4})],"same"!==r.padding&&"valid"!==r.padding)throw new oa("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return r}return(0,s.Z)(n,[{key:"build",value:function(e){if(4!==(e=Wi(e)).length)throw new oa("Input should have rank 4; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new oa("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Yi({ndim:4,axes:(0,Ts.Z)({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Re.tidy((function(){var t=Ui(e);if(4!==t.shape.length)throw new oa("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,a,i=t.shape,o=i[0];"channelsFirst"===n.dataFormat?(r=2,a=3):(r=1,a=2);var u=i[r],s=i[a],c=n.kernelSize[0],l=n.kernelSize[1],f=n.strides[0],d=n.strides[1],h=[o,Fs(u,f,c,n.padding),Fs(s,d,l,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=Re.transpose(t,[0,2,3,1]));var p=Re.conv2dTranspose(t,n.kernel.read(),h,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(p=Re.transpose(p,[0,3,1,2])),null!=n.bias&&(p=pi(p,n.bias.read(),n.dataFormat)),null!=n.activation&&(p=n.activation.apply(p)),p}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=(e=Wi(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3):(t=3,n=1,r=2);var i=this.kernelSize[0],o=this.kernelSize[1],u=this.strides[0],s=this.strides[1];return a[t]=this.filters,a[n]=Fs(a[n],u,i,this.padding),a[r]=Fs(a[r],s,o,this.padding),a}},{key:"getConfig",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(Ls);js.className="Conv2DTranspose",Re.serialization.registerClass(js);var Us=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),(r=t.call(this,e)).inputSpec=[new Yi({ndim:5})],"same"!==r.padding&&"valid"!==r.padding)throw new oa("Conv3DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return r}return(0,s.Z)(n,[{key:"build",value:function(e){if(5!==(e=Wi(e)).length)throw new oa("Input should have rank 5; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new oa("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Yi({ndim:5,axes:(0,Ts.Z)({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return Re.tidy((function(){var t=Ui(e);if(5!==t.shape.length)throw new oa("Conv3DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,a,i,o=t.shape,u=o[0];"channelsFirst"===n.dataFormat?(i=2,r=3,a=4):(i=1,r=2,a=3);var s=o[i],c=o[r],l=o[a],f=n.kernelSize[0],d=n.kernelSize[1],h=n.kernelSize[2],p=n.strides[0],v=n.strides[1],g=n.strides[2],m=[u,Fs(s,p,f,n.padding),Fs(c,v,d,n.padding),Fs(l,g,h,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=Re.transpose(t,[0,2,3,4,1]));var y=Re.conv3dTranspose(t,n.kernel.read(),m,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(y=Re.transpose(y,[0,4,1,2,3])),null!==n.bias&&(y=pi(y,n.bias.read(),n.dataFormat)),null!==n.activation&&(y=n.activation.apply(y)),y}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a,i=(e=Wi(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3,a=4):(t=4,n=1,r=2,a=3);var o=this.kernelSize[0],u=this.kernelSize[1],s=this.kernelSize[2],c=this.strides[0],l=this.strides[1],f=this.strides[2];return i[t]=this.filters,i[n]=Fs(i[n],c,o,this.padding),i[r]=Fs(i[r],l,u,this.padding),i[a]=Fs(i[a],f,s,this.padding),i}},{key:"getConfig",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(Ps);Us.className="Conv3DTranspose",Re.serialization.registerClass(Us);var Ws=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;if((0,u.Z)(this,n),(a=t.call(this,e,r)).DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",a.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",a.depthwiseKernel=null,a.pointwiseKernel=null,null==r.filters)throw new oa("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=r.kernelInitializer||null!=r.kernelRegularizer||null!=r.kernelConstraint)throw new oa("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=r.padding&&"same"!==r.padding&&"valid"!==r.padding)throw new oa("SeparableConv".concat(a.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(r.padding)));return a.depthMultiplier=null==r.depthMultiplier?1:r.depthMultiplier,a.depthwiseInitializer=Li(r.depthwiseInitializer||a.DEFAULT_DEPTHWISE_INITIALIZER),a.depthwiseRegularizer=ks(r.depthwiseRegularizer),a.depthwiseConstraint=ko(r.depthwiseConstraint),a.pointwiseInitializer=Li(r.depthwiseInitializer||a.DEFAULT_POINTWISE_INITIALIZER),a.pointwiseRegularizer=ks(r.pointwiseRegularizer),a.pointwiseConstraint=ko(r.pointwiseConstraint),a}return(0,s.Z)(n,[{key:"build",value:function(e){if((e=Wi(e)).length<this.rank+2)throw new oa("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new oa("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));for(var n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[],i=0;i<this.rank;++i)a.push(1);a.push(n*this.depthMultiplier,this.filters);var o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new Yi({ndim:this.rank+2,axes:(0,Ts.Z)({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){var t;if(e=Ui(e),1===n.rank)throw new ua("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(e=Re.transpose(e,[0,2,3,1])),t=Re.separableConv2d(e,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(t=pi(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),"channelsFirst"===n.dataFormat&&(t=Re.transpose(t,[0,3,1,2])),t}))}},{key:"getConfig",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=zi(this.depthwiseInitializer),e.pointwiseInitializer=zi(this.pointwiseInitializer),e.depthwiseRegularizer=bs(this.depthwiseRegularizer),e.pointwiseRegularizer=bs(this.pointwiseRegularizer),e.depthwiseConstraint=bo(this.depthwiseConstraint),e.pointwiseConstraint=bo(this.pointwiseConstraint),e}}]),n}(zs);Ws.className="SeparableConv";var Vs=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,2,e)}return(0,s.Z)(n)}(Ws);Vs.className="SeparableConv2D",Re.serialization.registerClass(Vs);var Gs=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),r=t.call(this,1,e),n.verifyArgs(e),r.inputSpec=[{ndim:3}],r}return(0,s.Z)(n,[{key:"getConfig",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.dataFormat,e}}],[{key:"verifyArgs",value:function(e){if("number"!==typeof e.kernelSize&&!Sa(e.kernelSize,"number",1,1))throw new oa("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(zs);Gs.className="Conv1D",Re.serialization.registerClass(Gs);var qs=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),r=t.call(this,e),"number"===typeof e.cropping?r.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"===typeof e.cropping[0]?r.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:r.cropping=e.cropping,r.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,r.inputSpec=[{ndim:4}],r}return(0,s.Z)(n,[{key:"computeOutputShape",value:function(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){if(e=Ui(e),"channelsLast"===n.dataFormat){var t=ii(e,n.cropping[0][0],e.shape[1]-n.cropping[0][0]-n.cropping[0][1],2);return ii(t,n.cropping[1][0],e.shape[2]-n.cropping[1][1]-n.cropping[1][0],3)}var r=ii(e,n.cropping[0][0],e.shape[2]-n.cropping[0][0]-n.cropping[0][1],3);return ii(r,n.cropping[1][0],e.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))}},{key:"getConfig",value:function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);qs.className="Cropping2D",Re.serialization.registerClass(qs);var Hs=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r,a;return(0,u.Z)(this,n),(r=t.call(this,e)).DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=null==e.size?r.DEFAULT_SIZE:e.size,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,La(r.dataFormat),r.interpolation=null==e.interpolation?"nearest":e.interpolation,a=r.interpolation,Ca(Oa,"InterpolationFormat",a),r}return(0,s.Z)(n,[{key:"computeOutputShape",value:function(e){if("channelsFirst"===this.dataFormat){var t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}var r=null==e[1]?null:this.size[0]*e[1],a=null==e[2]?null:this.size[1]*e[2];return[e[0],r,a,e[3]]}},{key:"call",value:function(e,t){var n=this;return Re.tidy((function(){var t=Ui(e),r=t.shape;if("channelsFirst"===n.dataFormat){t=Re.transpose(t,[0,2,3,1]);var a=n.size[0]*r[2],i=n.size[1]*r[3],o="nearest"===n.interpolation?Re.image.resizeNearestNeighbor(t,[a,i]):Re.image.resizeBilinear(t,[a,i]);return Re.transpose(o,[0,3,1,2])}var u=n.size[0]*r[1],s=n.size[1]*r[2];return"nearest"===n.interpolation?Re.image.resizeNearestNeighbor(t,[u,s]):Re.image.resizeBilinear(t,[u,s])}))}},{key:"getConfig",value:function(){var e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);Hs.className="UpSampling2D",Re.serialization.registerClass(Hs);var Xs=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,2,e)).depthwiseKernel=null,r.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,r.depthwiseInitializer=Li(e.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=ko(e.depthwiseConstraint),r.depthwiseRegularizer=ks(e.depthwiseRegularizer),r}return(0,s.Z)(n,[{key:"build",value:function(e){if((e=Wi(e)).length<4)throw new oa("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));var t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new oa("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));var n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){var t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return(0,Re.tidy)((function(){null==a&&(a="channelsLast"),La(a);var o=Is(e,a);if(4!==e.rank)throw new oa("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));if(4!==t.rank)throw new oa("depthwiseKernel is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));return o=Re.depthwiseConv2d(o,t,n,"same"===r?"same":"valid","NHWC",i),"channelsFirst"===a&&(o=Re.transpose(o,[0,3,1,2])),o}))}(e=Ui(e),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat,null);return n.useBias&&(t=pi(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),t}))}},{key:"computeOutputShape",value:function(e){e=Wi(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=Ds(t,this.kernelSize[0],this.padding,this.strides[0]),i=Ds(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,a,i]:[e[0],a,i,r]}},{key:"getConfig",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=zi(this.depthwiseInitializer),e.depthwiseRegularizer=bs(this.depthwiseRegularizer),e.depthwiseConstraint=bo(this.depthwiseRegularizer),e}}]),n}(Bs);function Ys(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new oa("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=a(t),constants:n=a(n)}}function Ks(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return Re.tidy((function(){var s=t.shape.length;if(s<3)throw new oa("Input should be at least 3D, but is ".concat(s,"D."));var c=[1,0].concat(Qa(2,s));if(t=Re.transpose(t,c),null!=i)throw new ua("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&((a=Re.cast(Re.cast(a,"bool"),"float32")).rank===s-1&&(a=Re.expandDims(a,-1)),a=Re.transpose(a,c)),r&&(t=Re.reverse(t,0),null!=a&&(a=Re.reverse(a,0)));var l,f,d=[],h=n,p=t.shape[0],v=Re.unstack(t);null!=a&&(f=Re.unstack(a));for(var g,m=function(t){var n=v[t],r=Re.tidy((function(){return e(n,h)}));if(null==a)l=r[0],h=r[1];else{var i=Re.tidy((function(){var e=f[t],n=Re.sub(Re.onesLike(e),e);return{output:Re.add(Re.mul(r[0],e),Re.mul(h[0],n)),newStates:h.map((function(t,a){return Re.add(Re.mul(r[1][a],e),Re.mul(t,n))}))}}));l=i.output,h=i.newStates}u&&d.push(l)},y=0;y<p;++y)m(y);if(u){g=Re.stack(d,1)}return[l,g,h]}))}Xs.className="DepthwiseConv2D",Re.serialization.registerClass(Xs);var $s=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r,a;if((0,u.Z)(this,n),r=t.call(this,e),null==e.cell)throw new oa("cell property is missing for the constructor of RNN.");if(null==(a=Array.isArray(e.cell)?new ic({cells:e.cell}):e.cell).stateSize)throw new oa("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=a,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new Yi({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],r}return(0,s.Z)(n,[{key:"getStates",value:function(){return null==this.states_?Qa(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(e){return null})):this.states_}},{key:"setStates",value:function(e){this.states_=e}},{key:"computeOutputShape",value:function(e){Pi(e)&&(e=e[0]);var t=this.cell.stateSize;Array.isArray(t)||(t=[t]);var n,r=t[0];if(n=this.returnSequences?[e[0],e[1],r]:[e[0],r],this.returnState){var a,i=[],o=(0,h.Z)(t);try{for(o.s();!(a=o.n()).done;){var u=a.value;i.push([e[0],u])}}catch(s){o.e(s)}finally{o.f()}return[n].concat(i)}return n}},{key:"computeMask",value:function(e,t){var n=this;return Re.tidy((function(){Array.isArray(t)&&(t=t[0]);var e=n.returnSequences?t:null;if(n.returnState){var r=n.states.map((function(e){return null}));return[e].concat(r)}return e}))}},{key:"states",get:function(){if(null==this.states_){for(var e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[],n=0;n<e;++n)t.push(null);return t}return this.states_},set:function(e){this.states_=e}},{key:"build",value:function(e){if(null!=this.numConstants)throw new ua("Constants support is not implemented in RNN yet.");Pi(e)&&(e=e[0]);var t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new Yi({shape:[t,null].concat((0,o.Z)(n))});var r,a=[e[0]].concat(e.slice(2));if(this.cell.build(a),r=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!Re.util.arraysEqual(this.stateSpec.map((function(e){return e.shape[e.shape.length-1]})),r))throw new oa("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=r.map((function(e){return new Yi({shape:[null,e]})}));this.stateful&&this.resetStates()}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,Re.tidy)((function(){if(!t.stateful)throw new aa("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape[0];if(null==r)throw new oa("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.states_)Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return Re.zeros([r,e])})):t.states_=[Re.zeros([r,t.cell.stateSize])];else if(null==e)Re.dispose(t.states_),null!=t.keptStates&&(Re.dispose(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return Re.zeros([r,e])})):t.states_[0]=Re.zeros([r,t.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new oa("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));!0===n?t.keptStates.push(t.states_.slice()):Re.dispose(t.states_);for(var a=0;a<t.states_.length;++a){var i=e[a],o=Array.isArray(t.cell.stateSize)?t.cell.stateSize[a]:t.cell.stateSize,u=[r,o];if(!Re.util.arraysEqual(i.shape,u))throw new oa("State ".concat(a," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(u,", received shape=").concat(i.shape));t.states_[a]=i}}t.states_=t.states_.map((function(e){return Re.keep(e.clone())}))}))}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=Ys(e,r,a,this.numConstants);e=i.inputs,r=i.initialState,a=i.constants;var o=[],u=[];if(null!=r){t.initialState=r,o=o.concat(r),this.stateSpec=[];var s,c=(0,h.Z)(r);try{for(c.s();!(s=c.n()).done;){var l=s.value;this.stateSpec.push(new Yi({shape:l.shape}))}}catch(g){c.e(g)}finally{c.f()}u=u.concat(this.stateSpec)}if(null!=a&&(t.constants=a,o=o.concat(a),this.numConstants=a.length),o[0]instanceof Ki){var f=[e].concat(o),d=this.inputSpec.concat(u),p=this.inputSpec;this.inputSpec=d;var v=(0,Zo.Z)((0,Bo.Z)(n.prototype),"apply",this).call(this,f,t);return this.inputSpec=p,v}return(0,Zo.Z)((0,Bo.Z)(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){var r=null==t?null:t.mask,a=null==t?null:t.training,i=null==t?null:t.initialState;e=Ui(e),null==i&&(i=n.stateful?n.states_:n.getInitialState(e));var o=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(i.length!==o)throw new oa("RNN Layer has ".concat(o," state(s) but was passed ")+"".concat(i.length," initial state(s)."));n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var u={training:a},s=Ks((function(e,t){var r=n.cell.call([e].concat(t),u);return[r[0],r.slice(1)]}),e,i,n.goBackwards,r,null,n.unroll,n.returnSequences),c=s[0],l=s[1],f=s[2];n.stateful&&n.resetStates(f,a);var d=n.returnSequences?l:c;return n.returnState?[d].concat(f):d}))}},{key:"getInitialState",value:function(e){var t=this;return(0,Re.tidy)((function(){var n=Re.zeros(e.shape);return n=ti(n=Re.sum(n,[1,2])),Array.isArray(t.cell.stateSize)?t.cell.stateSize.map((function(e){return e>1?si(n,[1,e]):n})):t.cell.stateSize>1?[si(n,[1,t.cell.stateSize])]:[n]}))}},{key:"trainableWeights",get:function(){return this.trainable?this.cell.trainableWeights:[]}},{key:"nonTrainableWeights",get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}},{key:"setFastWeightInitDuringBuild",value:function(e){(0,Zo.Z)((0,Bo.Z)(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(t.numConstants=this.numConstants);var r=this.cell.getConfig();return this.getClassName()===n.className&&(t.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),t)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.cell,a=zo(r,n);return new e(Object.assign(t,{cell:a}))}}]),n}(eo);$s.className="RNN",Re.serialization.registerClass($s);var Qs=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n)}(eo),Js=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,Aa(r.units,"units"),r.activation=ps(null==e.activation?r.DEFAULT_ACTIVATION:e.activation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Li(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Li(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Li(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=ks(e.kernelRegularizer),r.recurrentRegularizer=ks(e.recurrentRegularizer),r.biasRegularizer=ks(e.biasRegularizer),r.kernelConstraint=ko(e.kernelConstraint),r.recurrentConstraint=ko(e.recurrentConstraint),r.biasConstraint=ko(e.biasConstraint),r.dropout=Ka([1,$a([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=Ka([1,$a([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.dropoutFunc=e.dropoutFunc,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return(0,s.Z)(n,[{key:"build",value:function(e){e=Wi(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){if(2!==e.length)throw new oa("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));var r=e[1];e=e[0];var a,i=null!=t.training&&t.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=oc({ones:function(){return Re.onesLike(e)},rate:n.dropout,training:i,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=oc({ones:function(){return Re.onesLike(r)},rate:n.recurrentDropout,training:i,dropoutFunc:n.dropoutFunc}));var o=n.dropoutMask,u=n.recurrentDropoutMask;a=li(null!=o?Re.mul(e,o):e,n.kernel.read()),null!=n.bias&&(a=pi(a,n.bias.read())),null!=u&&(r=Re.mul(r,u));var s=Re.add(a,li(r,n.recurrentKernel.read()));return null!=n.activation&&(s=n.activation.apply(s)),[s,s]}))}},{key:"getConfig",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:ds(this.activation),useBias:this.useBias,kernelInitializer:zi(this.kernelInitializer),recurrentInitializer:zi(this.recurrentInitializer),biasInitializer:zi(this.biasInitializer),kernelRegularizer:bs(this.kernelRegularizer),recurrentRegularizer:bs(this.recurrentRegularizer),biasRegularizer:bs(this.biasRegularizer),activityRegularizer:bs(this.activityRegularizer),kernelConstraint:bo(this.kernelConstraint),recurrentConstraint:bo(this.recurrentConstraint),biasConstraint:bo(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}]),n}(Qs);Js.className="SimpleRNNCell",Re.serialization.registerClass(Js);var ec=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),e.cell=new Js(e),t.call(this,e)}return(0,s.Z)(n,[{key:"call",value:function(e,t){var r=this;return(0,Re.tidy)((function(){null!=r.cell.dropoutMask&&(Re.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Re.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return(0,Zo.Z)((0,Bo.Z)(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}($s);ec.className="SimpleRNN",Re.serialization.registerClass(ec);var tc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new oa("GRUCell does not support reset_after parameter set to true.");return r.units=e.units,Aa(r.units,"units"),r.activation=ps(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=ps(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Li(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Li(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Li(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=ks(e.kernelRegularizer),r.recurrentRegularizer=ks(e.recurrentRegularizer),r.biasRegularizer=ks(e.biasRegularizer),r.kernelConstraint=ko(e.kernelConstraint),r.recurrentConstraint=ko(e.recurrentConstraint),r.biasConstraint=ko(e.biasConstraint),r.dropout=Ka([1,$a([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=Ka([1,$a([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.dropoutFunc=e.dropoutFunc,r.implementation=e.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return(0,s.Z)(n,[{key:"build",value:function(e){var t=(e=Wi(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){if(2!==e.length)throw new oa("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=null!=t.training&&t.training,a=e[1];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=oc({ones:function(){return Re.onesLike(e)},rate:n.dropout,training:r,count:3,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=oc({ones:function(){return Re.onesLike(a)},rate:n.recurrentDropout,training:r,count:3,dropoutFunc:n.dropoutFunc}));var o,u,s,c=n.dropoutMask,l=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=Re.mul(e,c[0]));var f=li(e,n.kernel.read());n.useBias&&(f=pi(f,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(a=Re.mul(a,l[0]));var d=n.recurrentKernel.read(),h=Re.split(d,[2*n.units,n.units],d.rank-1),p=(0,i.Z)(h,2),v=p[0],g=p[1],m=li(a,v),y=Re.split(f,3,f.rank-1),b=(0,i.Z)(y,3),x=b[0],k=b[1],w=b[2],_=Re.split(m,2,m.rank-1),C=(0,i.Z)(_,2),S=C[0],A=C[1];o=n.recurrentActivation.apply(Re.add(x,S)),u=n.recurrentActivation.apply(Re.add(k,A));var E=li(Re.mul(u,a),g);s=n.activation.apply(Re.add(w,E));var T=Re.add(Re.mul(o,a),Re.mul(Re.add(1,Re.neg(o)),s));return[T,T]}))}},{key:"getConfig",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:ds(this.activation),recurrentActivation:ds(this.recurrentActivation),useBias:this.useBias,kernelInitializer:zi(this.kernelInitializer),recurrentInitializer:zi(this.recurrentInitializer),biasInitializer:zi(this.biasInitializer),kernelRegularizer:bs(this.kernelRegularizer),recurrentRegularizer:bs(this.recurrentRegularizer),biasRegularizer:bs(this.biasRegularizer),activityRegularizer:bs(this.activityRegularizer),kernelConstraint:bo(this.kernelConstraint),recurrentConstraint:bo(this.recurrentConstraint),biasConstraint:bo(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}]),n}(Qs);tc.className="GRUCell",Re.serialization.registerClass(tc);var nc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new tc(e),t.call(this,e)}return(0,s.Z)(n,[{key:"call",value:function(e,t){var r=this;return(0,Re.tidy)((function(){null!=r.cell.dropoutMask&&(Re.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Re.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return(0,Zo.Z)((0,Bo.Z)(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}($s);nc.className="GRU",Re.serialization.registerClass(nc);var rc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,Aa(r.units,"units"),r.activation=ps(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=ps(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Li(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Li(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Li(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=e.unitForgetBias,r.kernelRegularizer=ks(e.kernelRegularizer),r.recurrentRegularizer=ks(e.recurrentRegularizer),r.biasRegularizer=ks(e.biasRegularizer),r.kernelConstraint=ko(e.kernelConstraint),r.recurrentConstraint=ko(e.recurrentConstraint),r.biasConstraint=ko(e.biasConstraint),r.dropout=Ka([1,$a([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=Ka([1,$a([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.dropoutFunc=e.dropoutFunc,r.implementation=e.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return(0,s.Z)(n,[{key:"build",value:function(e){var t,n,r=(e=Wi(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var a=this.biasInitializer,i=this.units;n=new(t=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e,t){var n=a.apply([i]),r=(new wi).apply([i]),o=a.apply([2*i]);return ui(ui(n,r),o)}}]),n}(xi),t.className="CustomInit",t)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){var r=null!=t.training&&t.training;if(3!==e.length)throw new oa("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var a=e[1],o=e[2];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=oc({ones:function(){return Re.onesLike(e)},rate:n.dropout,training:r,count:4,dropoutFunc:n.dropoutFunc})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=oc({ones:function(){return Re.onesLike(a)},rate:n.recurrentDropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var u,s,c,l,f=n.dropoutMask,d=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=Re.mul(e,f[0]));var h=li(e,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(a=Re.mul(a,d[0])),h=Re.add(h,li(a,n.recurrentKernel.read())),n.useBias&&(h=pi(h,n.bias.read()));var p=Re.split(h,4,h.rank-1),v=(0,i.Z)(p,4),g=v[0],m=v[1],y=v[2],b=v[3];u=n.recurrentActivation.apply(g),s=n.recurrentActivation.apply(m),c=Re.add(Re.mul(s,o),Re.mul(u,n.activation.apply(y))),l=n.recurrentActivation.apply(b);var x=Re.mul(l,n.activation.apply(c));return[x,x,c]}))}},{key:"getConfig",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this),t={units:this.units,activation:ds(this.activation),recurrentActivation:ds(this.recurrentActivation),useBias:this.useBias,kernelInitializer:zi(this.kernelInitializer),recurrentInitializer:zi(this.recurrentInitializer),biasInitializer:zi(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:bs(this.kernelRegularizer),recurrentRegularizer:bs(this.recurrentRegularizer),biasRegularizer:bs(this.biasRegularizer),activityRegularizer:bs(this.activityRegularizer),kernelConstraint:bo(this.kernelConstraint),recurrentConstraint:bo(this.recurrentConstraint),biasConstraint:bo(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}]),n}(Qs);rc.className="LSTMCell",Re.serialization.registerClass(rc);var ac=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new rc(e),t.call(this,e)}return(0,s.Z)(n,[{key:"call",value:function(e,t){var r=this;return(0,Re.tidy)((function(){null!=r.cell.dropoutMask&&(Re.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Re.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return(0,Zo.Z)((0,Bo.Z)(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}($s);ac.className="LSTM",Re.serialization.registerClass(ac);var ic=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).cells=e.cells,r}return(0,s.Z)(n,[{key:"stateSize",get:function(){var e,t=[],n=(0,h.Z)(this.cells.slice().reverse());try{for(n.s();!(e=n.n()).done;){var r=e.value;Array.isArray(r.stateSize)?t.push.apply(t,(0,o.Z)(r.stateSize)):t.push(r.stateSize)}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){var r,a=e.slice(1),i=[],u=(0,h.Z)(n.cells.slice().reverse());try{for(u.s();!(r=u.n()).done;){var s=r.value;Array.isArray(s.stateSize)?i.push(a.splice(0,s.stateSize.length)):i.push(a.splice(0,1))}}catch(y){u.e(y)}finally{u.f()}i.reverse();for(var c,l=[],f=0;f<n.cells.length;++f){var d=n.cells[f];a=i[f],c=0===f?[e[0]].concat(a):[c[0]].concat(a),c=d.call(c,t),l.push(c.slice(1))}a=[];var p,v=(0,h.Z)(l.slice().reverse());try{for(v.s();!(p=v.n()).done;){var g,m=p.value;(g=a).push.apply(g,(0,o.Z)(m))}}catch(y){v.e(y)}finally{v.f()}return[c[0]].concat(a)}))}},{key:"build",value:function(e){var t;Pi(e)&&(e=e[0]),this.cells.forEach((function(n,r){Wa("RNNCell_".concat(r),(function(){n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}},{key:"getConfig",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this),t={cells:this.cells.map((function(e){return{className:e.getClassName(),config:e.getConfig()}}))};return Object.assign(Object.assign({},e),t)}},{key:"trainableWeights",get:function(){if(!this.trainable)return[];var e,t=[],n=(0,h.Z)(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,(0,o.Z)(r.trainableWeights))}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=(0,h.Z)(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,(0,o.Z)(r.nonTrainableWeights))}}catch(c){n.e(c)}finally{n.f()}if(!this.trainable){var a,i=[],u=(0,h.Z)(this.cells);try{for(u.s();!(a=u.n()).done;){var s=a.value;i.push.apply(i,(0,o.Z)(s.trainableWeights))}}catch(c){u.e(c)}finally{u.f()}return i.concat(t)}return t}},{key:"getWeights",value:function(){var e,t=[],n=(0,h.Z)(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,(0,o.Z)(r.weights))}}catch(a){n.e(a)}finally{n.f()}return Hi(t)}},{key:"setWeights",value:function(e){var t,n=[],r=(0,h.Z)(this.cells);try{for(r.s();!(t=r.n()).done;)for(var a=t.value,i=a.weights.length,o=e.splice(i),u=0;u<a.weights.length;++u)n.push([a.weights[u],o[u]])}catch(s){r.e(s)}finally{r.f()}Xi(n)}}],[{key:"fromConfig",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],i=(0,h.Z)(t.cells);try{for(i.s();!(n=i.n()).done;){var o=n.value;a.push(zo(o,r))}}catch(u){i.e(u)}finally{i.f()}return new e({cells:a})}}]),n}(Qs);function oc(e){var t=e.ones,n=e.rate,r=e.training,a=void 0!==r&&r,i=e.count,o=void 0===i?1:i,u=e.dropoutFunc,s=function(){return null!=u?u(t(),n):gi(t(),n)},c=function(){return mi(s,t,a)};return!o||o<=1?Re.keep(c().clone()):Array(o).fill(void 0).map(c).map((function(e){return Re.keep(e.clone())}))}ic.className="StackedRNNCells",Re.serialization.registerClass(ic);var uc=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},sc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),e.unroll)throw new ua("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new ua("It is not possible at the moment to stack convolutional cells.");return(r=t.call(this,e)).inputSpec=[new Yi({ndim:5})],r}return(0,s.Z)(n,[{key:"call",value:function(e,t){var r=this;return Re.tidy((function(){if(null!=r.cell.dropoutMask&&(Re.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(Re.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t&&t.constants)throw new oa("ConvRNN2D cell does not support constants");var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return(0,Zo.Z)((0,Bo.Z)(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}},{key:"computeOutputShape",value:function(e){var t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0]].concat((0,o.Z)(t.slice(2)))),this.returnState&&(t=[t].concat((0,o.Z)(Array(2).fill([e[0]].concat((0,o.Z)(t.slice(-3))))))),t}},{key:"getInitialState",value:function(e){var t=this;return Re.tidy((function(){var n=t.cell.stateSize,r=e.shape,a=t.computeSingleOutputShape(r),i=[a[0]].concat((0,o.Z)(a.slice(2))),u=Re.zeros(i);return Array.isArray(n)?Array(n.length).fill(u):[u]}))}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Re.tidy((function(){if(!t.stateful)throw new aa("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=t.inputSpec[0].shape,a=t.computeSingleOutputShape(r),i=[a[0]].concat((0,o.Z)(a.slice(2)));if(null==r[0])throw new oa("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.getStates())Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return Re.zeros(i)})):t.states_=[Re.zeros(i)];else if(null==e)Re.dispose(t.states_),null!=t.keptStates&&(Re.dispose(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(){return Re.zeros(i)})):t.states_[0]=Re.zeros(i);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new oa("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));n?t.keptStates.push(t.states_.slice()):Re.dispose(t.states_);for(var u=0;u<t.states_.length;++u){var s=e[u],c=i;if(!Re.util.arraysEqual(s.shape,c))throw new oa("State ".concat(u," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(c,", received shape=").concat(s.shape));t.states_[u]=s}}t.states_=t.states_.map((function(e){return Re.keep(e.clone())}))}))}},{key:"computeSingleOutputShape",value:function(e){var t=this.cell,n=t.dataFormat,r=t.filters,a=t.kernelSize,i=t.padding,u=t.strides,s=t.dilationRate,c="channelsFirst"===n,l=e[c?3:2],f=e[c?4:3],d=Ds(l,a[0],i,u[0],s[0]),h=Ds(f,a[1],i,u[1],s[1]);return[].concat((0,o.Z)(e.slice(0,2)),(0,o.Z)(c?[r,d,h]:[d,h,r]))}}]),n}($s);sc.className="ConvRNN2D";var cc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;(0,u.Z)(this,n);var a=e.filters,i=e.kernelSize,o=e.strides,s=e.padding,c=e.dataFormat,l=e.dilationRate;return(r=t.call(this,Object.assign(Object.assign({},e),{units:a}))).filters=a,Aa(r.filters,"filters"),r.kernelSize=Ns(i,2,"kernelSize"),r.kernelSize.forEach((function(e){return Aa(e,"kernelSize")})),r.strides=Ns(o||1,2,"strides"),r.strides.forEach((function(e){return Aa(e,"strides")})),r.padding=s||"valid",Pa(r.padding),r.dataFormat=c||"channelsLast",La(r.dataFormat),r.dilationRate=Ns(l||1,2,"dilationRate"),r.dilationRate.forEach((function(e){return Aa(e,"dilationRate")})),r}return(0,s.Z)(n,[{key:"build",value:function(e){var t;e=Wi(e);var n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new oa("The channel dimension of the input should be defined. "+"Found ".concat(e[n]));var r=e[n],a=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);var i=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",i,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){var o;if(this.unitForgetBias){var f=this.biasInitializer,d=this.filters;o=new(t=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"apply",value:function(e,t){return oi([f.apply([d]),Re.ones([d]),f.apply([2*d])])}}]),n}(xi),t.className="CustomInit",t)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,o,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}},{key:"call",value:function(e,t){var n=this;return Re.tidy((function(){if(3!==e.length)throw new oa("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=t.training||!1,a=e[0],o=e[1],u=e[2];0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=oc({ones:function(){return Re.onesLike(a)},rate:n.dropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var s=n.dropoutMask,c=function(e,t,n){return t&&t[n]?Re.mul(t[n],e):e},l=c(a,s,0),f=c(a,s,1),d=c(a,s,2),h=c(a,s,3);0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=oc({ones:function(){return Re.onesLike(o)},rate:n.recurrentDropout,training:r,count:4,dropoutFunc:n.dropoutFunc}));var p=n.recurrentDropoutMask,v=c(o,p,0),g=c(o,p,1),m=c(o,p,2),y=c(o,p,3),b=Re.split(n.kernel.read(),4,3),x=(0,i.Z)(b,4),k=x[0],w=x[1],_=x[2],C=x[3],S=n.useBias?Re.split(n.bias.read(),4):[null,null,null,null],A=(0,i.Z)(S,4),E=A[0],T=A[1],N=A[2],D=A[3];l=n.inputConv(l,k,E,n.padding),f=n.inputConv(f,w,T,n.padding),d=n.inputConv(d,_,N,n.padding),h=n.inputConv(h,C,D,n.padding);var F=Re.split(n.recurrentKernel.read(),4,3),I=(0,i.Z)(F,4),M=I[0],O=I[1],R=I[2],Z=I[3];v=n.recurrentConv(v,M),g=n.recurrentConv(g,O),m=n.recurrentConv(m,R),y=n.recurrentConv(y,Z);var B=n.recurrentActivation.apply(Re.add(l,v)),z=n.recurrentActivation.apply(Re.add(f,g)),L=Re.add(Re.mul(z,u),Re.mul(B,n.activation.apply(Re.add(d,m)))),P=Re.mul(n.recurrentActivation.apply(Re.add(h,y)),n.activation.apply(L));return[P,P,L]}))}},{key:"getConfig",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this),t=(e.units,uc(e,["units"])),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},t),r)}},{key:"inputConv",value:function(e,t,n,r){var a=Re.conv2d(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?pi(a,n,this.dataFormat):a}},{key:"recurrentConv",value:function(e,t){return Re.conv2d(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}]),n}(rc);cc.className="ConvLSTM2DCell",Re.serialization.registerClass(cc);var lc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){(0,u.Z)(this,n);var r=new cc(e);return t.call(this,Object.assign(Object.assign({},e),{cell:r}))}return(0,s.Z)(n,null,[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(sc);lc.className="ConvLSTM2D",Re.serialization.registerClass(lc);var fc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).rate=Math.max(Math.min(e.rate,1),0),r.noiseShape=e.noiseShape,r.seed=e.seed,r.supportsMasking=!0,r}return(0,s.Z)(n,[{key:"getNoiseShape",value:function(e){if(null==this.noiseShape)return this.noiseShape;for(var t=e.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){n.invokeCallHook(e,t);var r=Ui(e);if(0<n.rate&&n.rate<1){var a=null!=t.training&&t.training,i=n.getNoiseShape(r);return mi((function(){return gi(r,n.rate,i,n.seed)}),(function(){return r}),a)}return e}))}},{key:"getConfig",value:function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"dispose",value:function(){return(0,Zo.Z)((0,Bo.Z)(n.prototype),"dispose",this).call(this)}}]),n}(eo);fc.className="Dropout",Re.serialization.registerClass(fc);var dc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).inputSpec=[{ndim:3}],r}return(0,s.Z)(n,[{key:"getNoiseShape",value:function(e){var t=e.shape;return[t[0],1,t[2]]}}]),n}(fc);dc.className="SpatialDropout1D",Re.serialization.registerClass(dc);var hc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),(r=t.call(this,e)).activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var a=null;null!=e.batchSize&&(a=e.batchSize),r.batchInputShape=[a,e.inputDim]}return r.units=e.units,Aa(r.units,"units"),r.activation=ps(e.activation),null!=e.useBias&&(r.useBias=e.useBias),r.kernelInitializer=Li(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=Li(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=ko(e.kernelConstraint),r.biasConstraint=ko(e.biasConstraint),r.kernelRegularizer=ks(e.kernelRegularizer),r.biasRegularizer=ks(e.biasRegularizer),r.activityRegularizer=ks(e.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],r}return(0,s.Z)(n,[{key:"build",value:function(e){var t=(e=Wi(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:(0,Ts.Z)({},-1,t)}],this.built=!0}},{key:"computeOutputShape",value:function(e){var t=(e=Wi(e)).slice();return t[t.length-1]=this.units,t}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){n.invokeCallHook(e,t);var r,a=Ui(e),i=Ta(n.activation.getClassName());return null!=i?r=li(a,n.kernel.read(),i,n.bias?n.bias.read():null):(r=li(a,n.kernel.read()),null!=n.bias&&(r=pi(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:ds(this.activation),useBias:this.useBias,kernelInitializer:zi(this.kernelInitializer),biasInitializer:zi(this.biasInitializer),kernelRegularizer:bs(this.kernelRegularizer),biasRegularizer:bs(this.biasRegularizer),activityRegularizer:bs(this.activityRegularizer),kernelConstraint:bo(this.kernelConstraint),biasConstraint:bo(this.biasConstraint)},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);hc.className="Dense",Re.serialization.registerClass(hc);var pc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),e=e||{},(r=t.call(this,e)).inputSpec=[{minNDim:3}],r.dataFormat=e.dataFormat,r}return(0,s.Z)(n,[{key:"computeOutputShape",value:function(e){e=Wi(e);var t,n=(0,h.Z)(e.slice(1));try{for(n.s();!(t=n.n()).done;){if(null==t.value)throw new oa('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.')}}catch(r){n.e(r)}finally{n.f()}return[e[0],Ya(e,1)]}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){n.invokeCallHook(e,t);var r=Ui(e);if("channelsFirst"===n.dataFormat&&r.rank>1){for(var a=[0],i=2;i<r.rank;++i)a.push(i);a.push(1),r=(0,Re.transpose)(r,a)}return function(e){if(e.rank<=1)throw new oa("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));var t=[e.shape[0],Ya(e.shape,1)];return Re.reshape(e,t)}(r)}))}},{key:"getConfig",value:function(){var e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);var t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);pc.className="Flatten",Re.serialization.registerClass(pc);var vc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.activation=ps(e.activation),r}return(0,s.Z)(n,[{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){n.invokeCallHook(e,t);var r=Ui(e);return n.activation.apply(r)}))}},{key:"getConfig",value:function(){var e={activation:ds(this.activation)},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);vc.className="Activation",Re.serialization.registerClass(vc);var gc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).n=e.n,r.inputSpec=[{ndim:2}],r}return(0,s.Z)(n,[{key:"computeOutputShape",value:function(e){return[e[0],this.n,e[1]]}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){return e=Ui(e),t=e,r=n.n,(0,Re.tidy)((function(){if(2!==t.shape.length)throw new oa("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(t.shape.length," tensor."));return si(ti(t,1),[1,r,1])}));var t,r}))}},{key:"getConfig",value:function(){var e={n:this.n},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);gc.className="RepeatVector",Re.serialization.registerClass(gc);var mc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;(0,u.Z)(this,n),(r=t.call(this,e)).targetShape=e.targetShape;for(var a=0;a<r.targetShape.length;++a)r.isUnknown(r.targetShape[a])&&(r.targetShape[a]=null);return r}return(0,s.Z)(n,[{key:"isUnknown",value:function(e){return e<0||null==e}},{key:"fixUnknownDimension",value:function(e,t){for(var n="Total size of new array must be unchanged.",r=t.slice(),a=1,i=null,o=0;o<r.length;++o){var u=r[o];if(this.isUnknown(u)){if(null!==i)throw new oa("Can only specifiy one unknown dimension.");i=o}else a*=u}var s=Ya(e);if(null!==i){if(0===a||s%a!==0)throw new oa(n);r[i]=s/a}else if(s!==a)throw new oa(n);return r}},{key:"computeOutputShape",value:function(e){for(var t=!1,n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){n.invokeCallHook(e,t);var r=Ui(e),a=r.shape,i=a.slice(0,1).concat(n.fixUnknownDimension(a.slice(1),n.targetShape));return(0,Re.reshape)(r,i)}))}},{key:"getConfig",value:function(){var e={targetShape:this.targetShape},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);mc.className="Reshape",Re.serialization.registerClass(mc);var yc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),r=t.call(this,e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));var a=Qa(1,e.dims.length+1);if(!Re.util.arraysEqual(e.dims.slice().sort(),a))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=e.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new Yi({ndim:r.dims.length+1})],r}return(0,s.Z)(n,[{key:"computeOutputShape",value:function(e){var t=(e=Wi(e)).slice();return this.dims.forEach((function(n,r){t[r+1]=e[n]})),t}},{key:"call",value:function(e,t){return(0,Re.transpose)(Ui(e),this.dimsIncludingBatch)}},{key:"getConfig",value:function(){var e={dims:this.dims},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);yc.className="Permute",Re.serialization.registerClass(yc);var bc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,r.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0,r}return(0,s.Z)(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this),t={maskValue:this.maskValue};return Object.assign(t,e),t}},{key:"computeMask",value:function(e,t){var n=Ui(e);return(0,Re.any)((0,Re.notEqual)(n,this.maskValue),-1)}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){n.invokeCallHook(e,t);var r=Ui(e),a=(0,Re.any)((0,Re.notEqual)(r,n.maskValue),-1,!0);return(0,Re.mul)(r,(0,Re.cast)(a,r.dtype))}))}}]),n}(eo);bc.className="Masking",Re.serialization.registerClass(bc);var xc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),(r=t.call(this,e)).embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var a=null;null!=e.batchSize&&(a=e.batchSize),null==e.inputLength?r.batchInputShape=[a,null]:r.batchInputShape=[a].concat(pa(e.inputLength))}return r.inputDim=e.inputDim,Aa(r.inputDim,"inputDim"),r.outputDim=e.outputDim,Aa(r.outputDim,"outputDim"),r.embeddingsInitializer=Li(e.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=ks(e.embeddingsRegularizer),r.activityRegularizer=ks(e.activityRegularizer),r.embeddingsConstraint=ko(e.embeddingsConstraint),r.maskZero=e.maskZero,r.supportsMasking=e.maskZero,r.inputLength=e.inputLength,r}return(0,s.Z)(n,[{key:"build",value:function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}},{key:"warnOnIncompatibleInputShape",value:function(e){}},{key:"computeMask",value:function(e,t){var n=this;return(0,Re.tidy)((function(){return n.maskZero?(e=Ui(e),(0,Re.notEqual)(e,(0,Re.zerosLike)(e))):null}))}},{key:"computeOutputShape",value:function(e){if(e=Wi(e),null==this.inputLength)return[].concat((0,o.Z)(e),[this.outputDim]);var t=pa(this.inputLength);if(t.length!==e.length-1)throw new oa('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));for(var n=0,r=0;r<t.length;++r){var a=t[r],i=e[r+1];if(null!=a&&null!=i&&a!==i)throw new oa('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));null==a&&(t[n]=i),n++}return[e[0]].concat((0,o.Z)(t),[this.outputDim])}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){n.invokeCallHook(e,t);var r=Ui(e);"int32"!==r.dtype&&(r=ei(r,"int32"));var a=fi(n.embeddings.read(),(0,Re.reshape)(r,[r.size]));return(0,Re.reshape)(a,Wi(n.computeOutputShape(r.shape)))}))}},{key:"getConfig",value:function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:zi(this.embeddingsInitializer),embeddingsRegularizer:bs(this.embeddingsRegularizer),activityRegularizer:bs(this.activityRegularizer),embeddingsConstraint:bo(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);xc.className="Embedding",Re.serialization.registerClass(xc);var kc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e||{})).supportsMasking=!0,r}return(0,s.Z)(n,[{key:"mergeFunction",value:function(e){throw new ua}},{key:"computeElementwiseOpOutputShape",value:function(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;for(var n=e.slice(0,e.length-t.length),r=0;r<t.length;++r){var a=e[e.length-t.length+r],i=t[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new oa("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}},{key:"build",value:function(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Wi(e)]),e.length<2)throw new oa("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));var t,n=[],r=(0,h.Z)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;null!=a&&null!==a[0]&&n.push(a[0])}}catch(c){r.e(c)}finally{r.f()}if((n=wa(n)).length>1)throw new oa("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));for(var i=null==e[0]?null:e[0].slice(1),o=1;o<e.length;++o){var u=null==e[o]?null:e[o].slice(1);i=this.computeElementwiseOpOutputShape(i,u)}var s=e.map((function(e){return e.length}));-1===e.indexOf(null)&&1===wa(s).length?this.reshapeRequired=!1:this.reshapeRequired=!0}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){if(n.reshapeRequired){var t=[],r=e.map((function(e){return e.rank}));if(-1===r.indexOf(null)){var a,i=$a(r),o=(0,h.Z)(e);try{for(o.s();!(a=o.n()).done;){for(var u=a.value,s=u.rank,c=0;c<i-s;++c)u=ti(u,1);t.push(u)}}catch(E){o.e(E)}finally{o.f()}return n.mergeFunction(t)}var l,f=!1,d=(0,h.Z)(e);try{for(d.s();!(l=d.n()).done;){var p=l.value,v=p.rank;if(null==v){var g=p.shape,m=g[0],y=g.slice(1).concat([m]),b=Re.reshape(p,[m].concat(Ya(g.slice(1))));b=Re.transpose(b,[1,0]),b=Re.reshape(b,y),t.push(b),f=!0}else if(v>1){var x=Qa(1,v).concat([0]);t.push(Re.transpose(p,x)),f=!0}else t.push(p)}}catch(E){d.e(E)}finally{d.f()}var k=n.mergeFunction(t),w=k.rank;if(f)if(null==w){var _=k.shape,C=_[_.length-1],S=[C].concat(_.slice(0,_.length-1));k=Re.reshape(Re.transpose(Re.reshape(k,[-1,C]),[1,0]),S)}else if(w>1){var A=[w-1].concat(Qa(0,w-1));k=Re.transpose(k,A)}return k}return n.mergeFunction(e)}))}},{key:"computeOutputShape",value:function(e){var t;t=null==e[0]?null:e[0].slice(1);for(var n=1;n<e.length;++n){var r=null==e[n]?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}var a,i=[],o=(0,h.Z)(e);try{for(o.s();!(a=o.n()).done;){var u=a.value;null!=u&&null!==u[0]&&i.push(u[0])}}catch(s){o.e(s)}finally{o.f()}return t=1===(i=wa(i)).length?i.concat(t):[null].concat(t)}},{key:"computeMask",value:function(e,t){return Re.tidy((function(){if(null==t)return null;if(!Array.isArray(t))throw new oa("`mask` should be an Array");if(!Array.isArray(e))throw new oa("`inputs` should be an Array");if(t.length!==e.length)throw new oa("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every((function(e){return null==e})))return null;for(var n=(t=t.map((function(e){return null==e?e:Re.expandDims(e,0)})))[0],r=1;r<t.length-1;++r)n=Re.logicalAnd(n,t[r]);return n}))}}]),n}(eo),wc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,s.Z)(n,[{key:"mergeFunction",value:function(e){return(0,Re.tidy)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Re.add(t,e[n]);return t}))}}]),n}(kc);wc.className="Add",Re.serialization.registerClass(wc);var _c=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,s.Z)(n,[{key:"mergeFunction",value:function(e){return(0,Re.tidy)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Re.mul(t,e[n]);return t}))}}]),n}(kc);_c.className="Multiply",Re.serialization.registerClass(_c);var Cc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,s.Z)(n,[{key:"mergeFunction",value:function(e){return(0,Re.tidy)((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Re.add(t,e[n]);return Re.mul(1/e.length,t)}))}}]),n}(kc);Cc.className="Average",Re.serialization.registerClass(Cc);var Sc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,s.Z)(n,[{key:"mergeFunction",value:function(e){return(0,Re.tidy)((function(){for(var t=e[0],n=1;n<e.length;++n)t=Re.maximum(t,e[n]);return t}))}}]),n}(kc);Sc.className="Maximum",Re.serialization.registerClass(Sc);var Ac=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,s.Z)(n,[{key:"mergeFunction",value:function(e){return(0,Re.tidy)((function(){for(var t=e[0],n=1;n<e.length;++n)t=Re.minimum(t,e[n]);return t}))}}]),n}(kc);Ac.className="Minimum",Re.serialization.registerClass(Ac);var Ec=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).DEFAULT_AXIS=-1,null==e&&(e={}),r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return(0,s.Z)(n,[{key:"build",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new oa("A `Concatenate` layer should be called on a list of at least 2 inputs");var t,n=!0,r=(0,h.Z)(e);try{for(r.s();!(t=r.n()).done;){if(null!=t.value){n=!1;break}}}catch(f){r.e(f)}finally{r.f()}if(!n){for(var a=[],i=0;i<e.length;++i){var o=e[i].slice();o.splice(this.axis,1);var u,s=!1,c=(0,h.Z)(a);try{for(c.s();!(u=c.n()).done;){var l=u.value;if(Re.util.arraysEqual(l,o)){s=!0;break}}}catch(f){c.e(f)}finally{c.f()}s||a.push(o)}if(a.length>1)throw new oa("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}}},{key:"mergeFunction",value:function(e){var t=this;return(0,Re.tidy)((function(){return oi(e,t.axis)}))}},{key:"computeOutputShape",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new oa("A `Concatenate` layer should be called on a list of inputs.");var t,n=e,r=n[0].slice(),a=this.axis<0?r.length+this.axis:this.axis,i=(0,h.Z)(n.slice(1));try{for(i.s();!(t=i.n()).done;){var o=t.value;if(null==r[a]||null==o[a]){r[a]=null;break}r[a]+=o[a]}}catch(u){i.e(u)}finally{i.f()}return r}},{key:"computeMask",value:function(e,t){var n=this;if(null==t)return null;if(!Array.isArray(t))throw new oa("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new oa("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new oa("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return Re.tidy((function(){var r=!0;if(t.forEach((function(e){null==e||(r=!1)})),r)return null;for(var a=[],i=0;i<e.length;++i)null==t[i]?a.push(Re.cast(Re.onesLike(e[i]),"bool")):t[i].rank<e[i].rank?a.push(Re.expandDims(t[i],-1)):a.push(t[i]);var o=Re.concat(a,n.axis);return Re.all(o,-1,!1)}))}},{key:"getConfig",value:function(){var e={axis:this.axis},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(kc);function Tc(e,t){for(;e<0;)e+=t;return e}Ec.className="Concatenate",Re.serialization.registerClass(Ec);var Nc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).axes=e.axes,r.normalize=null!=e.normalize&&e.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return(0,s.Z)(n,[{key:"build",value:function(e){Re.util.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0],n=e[1];if(t.length>3||n.length>3)throw new ua("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new oa("Dimension incompatibility: "+"".concat(t[r[0]]," !== ").concat(n[r[1]]))}},{key:"mergeFunction",value:function(e){if(2!==e.length)throw new oa("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));var t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map((function(t,n){return Tc(t,e[n].shape.length)})):[Tc(this.axes,n.shape.length),Tc(this.axes,r.shape.length)],this.normalize&&(n=Lo(n,t[0]),r=Lo(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new ua("batchDot is not implemented for tensors of 4D or higher rank yet");if(Re.util.assert(e.shape.length>=2,(function(){return"batchDot requires the rank of x to be >= 2, "+"but got ".concat(e.shape.length)})),Re.util.assert(e.shape.length>=2,(function(){return"batchDot requires the rank of y to be >= 2, "+"but got ".concat(t.shape.length)})),"number"===typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new ua("batchDot is not implemented for complex64-type Tensors yet.");var r=e.shape.length,a=t.shape.length;null==n&&(n=[r-1,a-2]);var i=n;return Re.tidy((function(){var n,o;if(r>a){n=r-a;for(var u=[],s=0;s<n;++s)u.push(1);t=Re.reshape(t,t.shape.concat(u))}else if(a>r){n=a-r;for(var c=[],l=0;l<n;++l)c.push(1);e=Re.reshape(e,e.shape.concat(c))}else n=0;if(2===e.shape.length&&2===t.shape.length)o=i[0]===i[1]?Re.sum(Re.mul(e,t),i[0]):Re.sum(Re.mul(Re.transpose(e,[1,0]),t),i[1]);else{var f=i[0]!==e.shape.length-1,d=i[1]===t.shape.length-1;o=Re.matMul(e,t,f,d)}if(n>0){for(var h,p=[],v=h=r>a?r+a-3:r-1;v<h+n;++v)p.push(v);o=Re.squeeze(o,p)}return 1===o.shape.length&&(o=Re.expandDims(o,1)),o}))}(n,r,t)}},{key:"interpretAxes",value:function(e,t){return Array.isArray(this.axes)?this.axes:[Tc(this.axes,e.length),Tc(this.axes,t.length)]}},{key:"computeOutputShape",value:function(e){Re.util.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new ua("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);var a=t.concat(n);return 1===a.length&&a.push(1),a}},{key:"computeMask",value:function(e,t){return null}},{key:"getConfig",value:function(){var e={axes:this.axes,normalize:this.normalize},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(kc);Nc.className="Dot",Re.serialization.registerClass(Nc);var Dc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.stddev=e.stddev,r}return(0,s.Z)(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this),t={stddev:this.stddev};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){n.invokeCallHook(e,t);var r=Ui(e);return mi((function(){return(0,Re.add)(ci(r.shape,0,n.stddev),r)}),(function(){return r}),t.training||!1)}))}}]),n}(eo);Dc.className="GaussianNoise",Re.serialization.registerClass(Dc);var Fc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r}return(0,s.Z)(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){n.invokeCallHook(e,t);var r=Ui(e);if(n.rate>0&&n.rate<1){return mi((function(){var e=Math.sqrt(n.rate/(1-n.rate));return(0,Re.mul)(r,ci(r.shape,1,e))}),(function(){return r}),t.training||!1)}return r}))}}]),n}(eo);Fc.className="GaussianDropout",Re.serialization.registerClass(Fc);var Ic=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r.noiseShape=e.noiseShape,r}return(0,s.Z)(n,[{key:"_getNoiseShape",value:function(e){return this.noiseShape||Ui(e).shape}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){if(n.rate<1&&n.rate>0){var r=n._getNoiseShape(e);return mi((function(){var t=Ui(e),a=-1.7580993408473766,i=(0,Re.greaterEqual)((0,Re.randomUniform)(r),n.rate);i=ei(i,"float32");var o=Math.pow((1-n.rate)*(1+n.rate*Math.pow(a,2)),-.5),u=-o*a*n.rate,s=(0,Re.add)((0,Re.mul)(t,i),(0,Re.mul)((0,Re.add)(i,-1),a));return(0,Re.add)((0,Re.mul)(s,o),u)}),(function(){return Ui(e)}),t.training||!1)}return e}))}}]),n}(eo);function Mc(e,t,n,r,a){var i,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)i=Re.batchNorm2d(e,t,n,r,a,o);else if(3===e.rank)i=Re.batchNorm3d(e,t,n,r,a,o);else{if(4!==e.rank)throw new ua("batchNormalization is not implemented for array of rank ".concat(e.rank," ")+"yet");i=Re.batchNorm4d(e,t,n,r,a,o)}return i}function Oc(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return(0,Re.tidy)((function(){var i=Re.moments(e,r),o=i.mean,u=i.variance;return[Mc(e,o,u,n,t,a),o,u]}))}function Rc(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return(0,Re.tidy)((function(){var i,o=Re.moments(e,r),u=o.mean,s=o.variance,c=[],l=(0,h.Z)(Qa(0,e.rank));try{for(l.s();!(i=l.n()).done;){var f=i.value;-1!==r.indexOf(f)?c.push(1):c.push(e.shape[f])}}catch(m){l.e(m)}finally{l.f()}var d=(0,Re.reshape)(u,c),p=(0,Re.reshape)(s,c),v=null==t?null:(0,Re.reshape)(t,c),g=null==n?null:(0,Re.reshape)(n,c);return[Mc(e,d,p,g,v,a),u,s]}))}Ic.className="AlphaDropout",Re.serialization.registerClass(Ic);var Zc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),null==e&&(e={}),(r=t.call(this,e)).supportsMasking=!0,r.axis=null==e.axis?-1:e.axis,r.momentum=null==e.momentum?.99:e.momentum,r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=Li(e.betaInitializer||"zeros"),r.gammaInitializer=Li(e.gammaInitializer||"ones"),r.movingMeanInitializer=Li(e.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=Li(e.movingVarianceInitializer||"ones"),r.betaConstraint=ko(e.betaConstraint),r.gammaConstraint=ko(e.gammaConstraint),r.betaRegularizer=ks(e.betaRegularizer),r.gammaRegularizer=ks(e.gammaRegularizer),r}return(0,s.Z)(n,[{key:"build",value:function(e){e=Wi(e);var t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new oa("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new Yi({ndim:e.length,axes:(0,Ts.Z)({},t,n)})];var r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){var r=null!=t.training&&t.training,a=Ui(e),o=a.shape,u=o.length,s=Qa(0,u),c=n.axis>=0?n.axis:n.axis+u;s.splice(c,1);var l=la(1,u);l[c]=o[c];var f=s.slice();f.sort();var d=!Re.util.arraysEqual(f,Qa(0,u).slice(0,u-1));if(!r)return function(){if(d){var e=(0,Re.reshape)(n.movingMean.read(),l),t=(0,Re.reshape)(n.movingVariance.read(),l),r=n.center?(0,Re.reshape)(n.beta.read(),l):null,i=n.scale?(0,Re.reshape)(n.gamma.read(),l):null;return Mc(a,e,t,r,i,n.epsilon)}return Mc(a,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var h=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return Re.util.arraysEqual(r.slice().sort(),Qa(0,e.rank-1))?Oc(e,t,n,r,a):Rc(e,t,n,r,a)}(a,n.gamma.read(),n.beta.read(),s,n.epsilon),p=(0,i.Z)(h,3),v=p[0],g=p[1],m=p[2],y=function(e,t,n){Re.tidy((function(){var r=1-n,a=e.read(),i=Re.mul(Re.sub(a,t),r);e.write(Re.sub(a,i))}))};return y(n.movingMean,g,n.momentum),y(n.movingVariance,m,n.momentum),v}))}},{key:"getConfig",value:function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:zi(this.betaInitializer),gammaInitializer:zi(this.gammaInitializer),movingMeanInitializer:zi(this.movingMeanInitializer),movingVarianceInitializer:zi(this.movingVarianceInitializer),betaRegularizer:bs(this.betaRegularizer),gammaRegularizer:bs(this.gammaRegularizer),betaConstraint:bo(this.betaConstraint),gammaConstraint:bo(this.gammaConstraint)},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);Zc.className="BatchNormalization",Re.serialization.registerClass(Zc);var Bc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),null==e&&(e={}),(r=t.call(this,e)).axis=null==e.axis?-1:e.axis,"number"===typeof r.axis){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received ".concat(r.axis))}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(r.axis)));var a,i=(0,h.Z)(r.axis);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(!Number.isInteger(o))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(r.axis)))}}catch(s){i.e(s)}finally{i.f()}}return r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=Li(e.betaInitializer||"zeros"),r.gammaInitializer=Li(e.gammaInitializer||"ones"),r.betaRegularizer=ks(e.betaRegularizer),r.gammaRegularizer=ks(e.gammaRegularizer),r.supportsMasking=!0,r}return(0,s.Z)(n,[{key:"build",value:function(e){var t=(e=Wi(e)).length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(var n=0;n<this.axis.length;++n)this.axis[n]<0&&(this.axis[n]+=t);var r,a=(0,h.Z)(this.axis);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(i<0||i>=t)throw new Error("Invalid axis: ".concat(i))}}catch(u){a.e(u)}finally{a.f()}if(this.axis.length!==wa(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));var o=this.axis.map((function(t){return e[t]}));this.scale?this.gamma=this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,true):this.gamma=null,this.center?this.beta=this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,true):this.beta=null,this.built=!0}},{key:"call",value:function(e,t){var n=this,r=Ui(e),a=r.shape,i=a.length;return(0,Re.tidy)((function(){var e,t=(0,Re.moments)(r,n.axis,!0),o=t.mean,u=t.variance,s=la(1,i),c=(0,h.Z)(n.axis);try{for(c.s();!(e=c.n()).done;){var l=e.value;s[l]=a[l]}}catch(y){c.e(y)}finally{c.f()}for(var f=function(e){return null!=e&&e.shape.length!==i?Re.reshape(e,s):e},d=n.scale?f(n.gamma.read()):null,p=n.center?f(n.beta.read()):null,v=[],g=[],m=0;m<i;++m)-1!==n.axis.indexOf(m)?(v.push(a[m]),g.push(1)):(v.push(1),g.push(a[m]));return o=Re.tile(o,v),u=Re.tile(u,v),null!=d&&(d=Re.tile(d,g)),null!=p&&(p=Re.tile(p,g)),Mc(r,o,u,p,d,n.epsilon)}))}},{key:"getConfig",value:function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:zi(this.betaInitializer),gammaInitializer:zi(this.gammaInitializer),betaRegularizer:bs(this.betaRegularizer),gammaRegularizer:bs(this.gammaRegularizer)},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);Bc.className="LayerNormalization",Re.serialization.registerClass(Bc);var zc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),null==e&&(e={}),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)r.padding=[[1,1],[1,1]];else if("number"===typeof e.padding)r.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new oa("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));var a,i;if("number"===typeof e.padding[0])a=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new oa("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(a=e.padding[0],2!==e.padding[1].length)throw new oa("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));i=e.padding[1]}r.padding=[a,i]}return r.inputSpec=[new Yi({ndim:4})],r}return(0,s.Z)(n,[{key:"computeOutputShape",value:function(e){var t,n;return e=Wi(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){return t=Ui(e),r=n.padding,a=n.dataFormat,(0,Re.tidy)((function(){if(4!==t.rank)throw new oa("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(t.rank,"-D tensor."));if(null==r&&(r=[[1,1],[1,1]]),2!==r.length||2!==r[0].length||2!==r[1].length)throw new oa("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==a&&(a="channelsLast"),"channelsLast"!==a&&"channelsFirst"!==a)throw new oa("Unknown data format: ".concat(a,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");var e;return e="channelsFirst"===a?[[0,0],[0,0],r[0],r[1]]:[[0,0],r[0],r[1],[0,0]],Re.pad(t,e)}));var t,r,a}))}},{key:"getConfig",value:function(){var e={padding:this.padding,dataFormat:this.dataFormat},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo);function Lc(e,t,n,r,a,i){return(0,Re.tidy)((function(){var o;La(a),ja(i),Pa(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=Is(e,a);var u="same"===r?"same":"valid";return o="max"===i?Re.maxPool(e,t,n,u):Re.avgPool(e,t,n,u),"channelsFirst"===a&&(o=Re.transpose(o,[0,3,1,2])),o}))}function Pc(e,t,n,r,a,i){return(0,Re.tidy)((function(){var o;La(a),ja(i),Pa(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=Ms(e,a);var u="same"===r?"same":"valid";return o="max"===i?Re.maxPool3d(e,t,n,u):Re.avgPool3d(e,t,n,u),"channelsFirst"===a&&(o=Re.transpose(o,[0,4,1,2,3])),o}))}zc.className="ZeroPadding2D",Re.serialization.registerClass(zc);var jc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),null==e.poolSize&&(e.poolSize=2),r=t.call(this,e),"number"===typeof e.poolSize)r.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!==typeof e.poolSize[0])throw new oa("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));r.poolSize=e.poolSize}if(Aa(r.poolSize,"poolSize"),null==e.strides)r.strides=r.poolSize;else if("number"===typeof e.strides)r.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!==typeof e.strides[0])throw new oa("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));r.strides=e.strides}return Aa(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,Pa(r.padding),r.inputSpec=[new Yi({ndim:3})],r}return(0,s.Z)(n,[{key:"computeOutputShape",value:function(e){var t=Ds((e=Wi(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){n.invokeCallHook(e,t),e=ti(Ui(e),2);var r=n.poolingFunction(Ui(e),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return Re.squeeze(r,[2])}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo),Uc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,s.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return La(a),Pa(r),Lc(e,t,n,r,a,"max")}}]),n}(jc);Uc.className="MaxPooling1D",Re.serialization.registerClass(Uc);var Wc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,s.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return La(a),Pa(r),Lc(e,t,n,r,a,"avg")}}]),n}(jc);Wc.className="AveragePooling1D",Re.serialization.registerClass(Wc);var Vc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),null==e.poolSize&&(e.poolSize=[2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new oa("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides];return Aa(r.poolSize,"poolSize"),Aa(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,La(r.dataFormat),Pa(r.padding),r.inputSpec=[new Yi({ndim:4})],r}return(0,s.Z)(n,[{key:"computeOutputShape",value:function(e){e=Wi(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=Ds(t,this.poolSize[0],this.padding,this.strides[0]),n=Ds(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){return n.invokeCallHook(e,t),n.poolingFunction(Ui(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo),Gc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,s.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return La(a),Pa(r),Lc(e,t,n,r,a,"max")}}]),n}(Vc);Gc.className="MaxPooling2D",Re.serialization.registerClass(Gc);var qc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,s.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return La(a),Pa(r),Lc(e,t,n,r,a,"avg")}}]),n}(Vc);qc.className="AveragePooling2D",Re.serialization.registerClass(qc);var Hc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),null==e.poolSize&&(e.poolSize=[2,2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new oa("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides,e.strides];return Aa(r.poolSize,"poolSize"),Aa(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,La(r.dataFormat),Pa(r.padding),r.inputSpec=[new Yi({ndim:5})],r}return(0,s.Z)(n,[{key:"computeOutputShape",value:function(e){e=Wi(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=Ds(t,this.poolSize[0],this.padding,this.strides[0]),n=Ds(n,this.poolSize[1],this.padding,this.strides[1]),r=Ds(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){return n.invokeCallHook(e,t),n.poolingFunction(Ui(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo),Xc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,s.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return La(a),Pa(r),Pc(e,t,n,r,a,"max")}}]),n}(Hc);Xc.className="MaxPooling3D",Re.serialization.registerClass(Xc);var Yc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,s.Z)(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return La(a),Pa(r),Pc(e,t,n,r,a,"avg")}}]),n}(Hc);Yc.className="AveragePooling3D",Re.serialization.registerClass(Yc);var Kc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).inputSpec=[new Yi({ndim:3})],r}return(0,s.Z)(n,[{key:"computeOutputShape",value:function(e){return[e[0],e[2]]}},{key:"call",value:function(e,t){throw new ua}}]),n}(eo),$c=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e||{})}return(0,s.Z)(n,[{key:"call",value:function(e,t){return(0,Re.tidy)((function(){var t=Ui(e);return Re.mean(t,1)}))}}]),n}(Kc);$c.className="GlobalAveragePooling1D",Re.serialization.registerClass($c);var Qc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e||{})}return(0,s.Z)(n,[{key:"call",value:function(e,t){return(0,Re.tidy)((function(){var t=Ui(e);return Re.max(t,1)}))}}]),n}(Kc);Qc.className="GlobalMaxPooling1D",Re.serialization.registerClass(Qc);var Jc=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,La(r.dataFormat),r.inputSpec=[new Yi({ndim:4})],r}return(0,s.Z)(n,[{key:"computeOutputShape",value:function(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}},{key:"call",value:function(e,t){throw new ua}},{key:"getConfig",value:function(){var e={dataFormat:this.dataFormat},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(eo),el=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){var t=Ui(e);return"channelsLast"===n.dataFormat?Re.mean(t,[1,2]):Re.mean(t,[2,3])}))}}]),n}(Jc);el.className="GlobalAveragePooling2D",Re.serialization.registerClass(el);var tl=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.apply(this,arguments)}return(0,s.Z)(n,[{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){var t=Ui(e);return"channelsLast"===n.dataFormat?Re.max(t,[1,2]):Re.max(t,[2,3])}))}}]),n}(Jc);tl.className="GlobalMaxPooling2D",Re.serialization.registerClass(tl);var nl=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).layer=e.layer,r}return(0,s.Z)(n,[{key:"build",value:function(e){this.built=!0}},{key:"trainable",get:function(){return null!=this.layer&&this.layer.trainable},set:function(e){null!=this.layer&&(this.layer.trainable=e)}},{key:"trainableWeights",get:function(){return this.layer.trainableWeights}},{key:"nonTrainableWeights",get:function(){return this.layer.nonTrainableWeights}},{key:"updates",get:function(){return this.layer._updates}},{key:"losses",get:function(){return this.layer.losses}},{key:"getWeights",value:function(){return this.layer.getWeights()}},{key:"setWeights",value:function(e){this.layer.setWeights(e)}},{key:"getConfig",value:function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"setFastWeightInitDuringBuild",value:function(e){(0,Zo.Z)((0,Bo.Z)(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.layer,a=zo(r,n);delete t.layer;var i={layer:a};return Object.assign(i,t),new e(i)}}]),n}(eo),rl=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).supportsMasking=!0,r}return(0,s.Z)(n,[{key:"build",value:function(e){if((e=Wi(e)).length<3)throw new oa("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];var t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),(0,Zo.Z)((0,Bo.Z)(n.prototype),"build",this).call(this,e)}},{key:"computeOutputShape",value:function(e){var t=[(e=Wi(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){return Ks((function(e,r){return[Ui(n.layer.call(e,t)),[]]}),e=Ui(e),[],!1,null,null,!1,!0)[1]}))}}]),n}(nl);rl.className="TimeDistributed",Re.serialization.registerClass(rl);var al=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;(0,u.Z)(this,n),r=t.call(this,e);var a=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=a,r.forwardLayer=zo(i),a.goBackwards=!0!==a.goBackwards;var o,s={};if(s.className=e.layer.getClassName(),s.config=a,r.backwardLayer=zo(s),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,o=r.mergeMode,Ca(Ba,"BidirectionalMergeMode",o),e.weights)throw new ua("weights support is not implemented for Bidirectional layer yet.");return r._stateful=e.layer.stateful,r.returnSequences=e.layer.returnSequences,r.returnState=e.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=e.layer.inputSpec,r.numConstants=null,r}return(0,s.Z)(n,[{key:"trainable",get:function(){return this._trainable},set:function(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}},{key:"getWeights",value:function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}},{key:"setWeights",value:function(e){var t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=this.forwardLayer.computeOutputShape(e);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),this.returnState?(r=a.slice(1),t=a[0]):t=a[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):ha(n)}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=Ys(e,r,a,this.numConstants);if(e=i.inputs,r=i.initialState,a=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(null==r||0===r.length)&&null==a)return(0,Zo.Z)((0,Bo.Z)(n.prototype),"apply",this).call(this,e,t);var u=[],s=[];if(null!=r){var c=r.length;if(c%2>0)throw new oa("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=r,u.push.apply(u,(0,o.Z)(r));var l=r.map((function(e){return new Yi({shape:e.shape})}));this.forwardLayer.stateSpec=l.slice(0,c/2),this.backwardLayer.stateSpec=l.slice(c/2),s.push.apply(s,(0,o.Z)(l))}if(null!=a)throw new ua("Support for constants in Bidirectional layers is not implemented yet.");for(var f=u[0]instanceof Ki,d=0,h=u;d<h.length;d++){if(h[d]instanceof Ki!==f)throw new oa("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors")}if(f){var p=[e].concat(u),v=this.inputSpec.concat(s),g=this.inputSpec;this.inputSpec=v;var m=(0,Zo.Z)((0,Bo.Z)(n.prototype),"apply",this).call(this,p,t);return this.inputSpec=g,m}return(0,Zo.Z)((0,Bo.Z)(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){var r,a,i,o,u=t.initialState;if(null==u)r=n.forwardLayer.call(e,t),a=n.backwardLayer.call(e,t);else{var s=u.slice(0,u.length/2),c=u.slice(u.length/2);r=n.forwardLayer.call(e,Object.assign(t,{initialState:s})),a=n.backwardLayer.call(e,Object.assign(t,{initialState:c}))}return n.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),n.returnSequences&&(a=Re.reverse(a,1)),"concat"===n.mergeMode?o=oi([r,a]):"sum"===n.mergeMode?o=Re.add(r,a):"ave"===n.mergeMode?o=Re.mul(.5,Re.add(r,a)):"mul"===n.mergeMode?o=Re.mul(r,a):null==n.mergeMode&&(o=[r,a]),n.returnState?null==n.mergeMode?o.concat(i):[o].concat(i):o}))}},{key:"resetStates",value:function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}},{key:"build",value:function(e){var t=this;Wa(this.forwardLayer.name,(function(){t.forwardLayer.build(e)})),Wa(this.backwardLayer.name,(function(){t.backwardLayer.build(e)})),this.built=!0}},{key:"computeMask",value:function(e,t){var n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){var r=this.forwardLayer.states.map((function(e){return null}));return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}return n}},{key:"trainableWeights",get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}},{key:"nonTrainableWeights",get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}},{key:"setFastWeightInitDuringBuild",value:function(e){(0,Zo.Z)((0,Bo.Z)(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e={mergeMode:this.mergeMode},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"fromConfig",value:function(e,t){var n=zo(t.layer);if(delete t.layer,null!=t.numConstants)throw new ua("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=t;return r.layer=n,new e(r)}}]),n}(nl);al.className="Bidirectional",Re.serialization.registerClass(al);var il=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).scale=e.scale,e.offset?r.offset=e.offset:r.offset=0,r}return(0,s.Z)(n,[{key:"getConfig",value:function(){var e={scale:this.scale,offset:this.offset},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){return"float32"!==(e=Ui(e)).dtype&&(e=ei(e,"float32")),(0,Re.add)((0,Re.mul)(e,n.scale),n.offset)}))}}]),n}(eo);il.className="Rescaling",Re.serialization.registerClass(il);var ol=Re.image.resizeBilinear,ul=Re.image.cropAndResize,sl=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).height=e.height,r.width=e.width,r}return(0,s.Z)(n,[{key:"centerCrop",value:function(e,t,n,r,a,i,o,u){return(0,Re.tidy)((function(){var s,c=!1,l=[t/i,n/o,(r+t)/i,(a+n)/o],f=[];3===e.rank?(c=!0,s=(0,Re.stack)([e])):s=e;for(var d=0;d<s.shape[0];d++)f.push(l);var h=(0,Re.tensor)(f,[f.length,4]),p=(0,Re.range)(0,f.length,1,"int32"),v=ul(s,h,p,[r,a],"nearest");return ei(c?Ui((0,Re.unstack)(v)):v,u)}))}},{key:"upsize",value:function(e,t,n,r){return(0,Re.tidy)((function(){return ei(ol(e,[t,n]),r)}))}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){var t=Ui(e),r=t.dtype,a=t.shape,i=a[a.length-3],o=a[a.length-2],u=0;i!==n.height&&(u=Math.floor((i-n.height)/2));var s=0;return o!==n.width&&0===(s=Math.floor((o-n.width)/2))&&(s=1),u>=0&&s>=0?n.centerCrop(t,u,s,n.height,n.width,i,o,r):n.upsize(e,n.height,n.width,r)}))}},{key:"getConfig",value:function(){var e={height:this.height,width:this.width},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"computeOutputShape",value:function(e){var t=(e=Wi(e)).length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}}]),n}(eo);sl.className="CenterCrop",Re.serialization.registerClass(sl);var cl=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,e)).numTokens=e.numTokens,e.outputMode?r.outputMode=e.outputMode:r.outputMode="multiHot",r}return(0,s.Z)(n,[{key:"getConfig",value:function(){var e={numTokens:this.numTokens,outputMode:this.outputMode},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"computeOutputShape",value:function(e){return null==(e=Wi(e))?[this.numTokens]:"oneHot"===this.outputMode&&1!==e[e.length-1]?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){var r;if("int32"!==(e=Ui(e)).dtype&&(e=ei(e,"int32")),"undefined"!==typeof t.countWeights){if("count"!==n.outputMode)throw new oa("countWeights is not used when outputMode !== count.\n              Received countWeights=".concat(t.countWeights));r=Ui(t.countWeights)}var a=(0,Re.max)(e),i=(0,Re.min)(e),o=(0,Re.greater)(n.numTokens,a).bufferSync().get(0),u=(0,Re.greaterEqual)(i,0).bufferSync().get(0);if(!o||!u)throw new oa("Input values must be between 0 < values <="+" numTokens with numTokens=".concat(n.numTokens));return function(e,t,n,r){var a=Ui(e);if("int32"!==a.dtype&&(a=ei(a,"int32")),"int"===t)return a;var i=a.shape;if(0===a.rank&&(a=(0,Re.expandDims)(a,-1)),"oneHot"===t&&1!==a.shape[a.shape.length-1]&&(a=(0,Re.expandDims)(a,-1)),a.rank>2)throw new oa("When outputMode is not int, maximum output rank is 2"+" Received outputMode ".concat(t," and input shape ").concat(i)+" which would result in output rank ".concat(a.rank,"."));var o,u=["multiHot","oneHot"].includes(t),s=a;if(o="undefined"!==typeof r&&"count"===t?(0,Re.denseBincount)(s,r,n,u):(0,Re.denseBincount)(s,[],n,u),"tfIdf"!==t)return o;if(r)return(0,Re.mul)(o,r);throw new oa("When outputMode is 'tfIdf', weights must be provided.")}(e,n.outputMode,n.numTokens,r)}))}}]),n}(eo);cl.className="CategoryEncoding",Re.serialization.registerClass(cl);var ll=new Set(["bilinear","nearest"]),fl=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;if((0,u.Z)(this,n),(r=t.call(this,e)).height=e.height,r.width=e.width,e.interpolation){if(!ll.has(e.interpolation))throw new oa("Invalid interpolation parameter: ".concat(e.interpolation," is not implemented"));r.interpolation=e.interpolation}else r.interpolation="bilinear";return r.cropToAspectRatio=Boolean(e.cropToAspectRatio),r}return(0,s.Z)(n,[{key:"computeOutputShape",value:function(e){var t=(e=Wi(e))[2];return[this.height,this.width,t]}},{key:"getConfig",value:function(){var e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=(0,Zo.Z)((0,Bo.Z)(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"call",value:function(e,t){var n=this;return(0,Re.tidy)((function(){var t=[n.height,n.width];if("bilinear"===n.interpolation)return Re.image.resizeBilinear(e,t,!n.cropToAspectRatio);if("nearest"===n.interpolation)return Re.image.resizeNearestNeighbor(e,t,!n.cropToAspectRatio);throw new Error("Interpolation is ".concat(n.interpolation," but only ").concat((0,o.Z)(ll)," are supported"))}))}}]),n}(eo);function dl(e){return new Ls(e)}function hl(e){return new hc(e)}function pl(e){return new pc(e)}function vl(e){return new Gc(e)}fl.className="Resizing",Re.serialization.registerClass(fl);var gl,ml;(0,Re.env)().registerFlag("KEEP_INTERMEDIATE_TENSORS",(function(){return!1}),(function(e){e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")})),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(gl||(gl={})),function(e){!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(ml||(ml={}));var yl=n(6699);function bl(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if("function"===typeof Blob&&e instanceof Blob)return e.slice();if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(_l(e)){var i=Array.isArray(e)?[]:{};for(var o in r.add(e),e){var u=e[o],s=bl(u,t,n,r);i[o]=s}return r.delete(e),e.__proto__&&(i.__proto__=e.__proto__),i}throw new Error("Can't recurse into non-iterable type: ".concat(e))}return n.set(e,a.value),a.value}function xl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:wl;return kl(e,t)}function kl(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(_l(r)){var i=Array.isArray(r)?[]:{};n.add(r);var o=function(r){var a=kl(e.map((function(e){return e[r]})),t,n);i[r]=a};for(var u in r)o(u);return n.delete(r),i}throw new Error("Can't recurse into non-iterable type: ".concat(r))}return a.value}function wl(e){return null===e?null:_l(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function _l(e){var t=!1;Re.env().get("IS_BROWSER")?t=e instanceof TextDecoder:t=e instanceof n(4977).StringDecoder;return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"===typeof e&&!(e instanceof Re.Tensor)&&!(e instanceof Promise)&&!t)}function Cl(e){return function(e,t){return bl(e,t)}(e,Sl)}function Sl(e){return e instanceof Re.Tensor?{value:e.clone(),recurse:!1}:_l(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}var Al=function(){function e(t){if((0,u.Z)(this,e),this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return(0,s.Z)(e,[{key:"wrap",value:function(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}},{key:"get",value:function(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}},{key:"set",value:function(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}},{key:"length",value:function(){var e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}},{key:"isFull",value:function(){return this.length()===this.capacity}},{key:"isEmpty",value:function(){return 0===this.length()}},{key:"push",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}},{key:"pushAll",value:function(e){var t,n=(0,h.Z)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.push(r)}}catch(a){n.e(a)}finally{n.f()}}},{key:"pop",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var e=this.get(this.end);return this.set(this.end,void 0),e}},{key:"unshift",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}},{key:"shift",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}},{key:"shuffleExcise",value:function(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}]),e}(),El=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){return(0,u.Z)(this,n),t.call(this,n.INITIAL_CAPACITY)}return(0,s.Z)(n,[{key:"isFull",value:function(){return!1}},{key:"push",value:function(e){(0,Zo.Z)((0,Bo.Z)(n.prototype),"isFull",this).call(this)&&this.expand(),(0,Zo.Z)((0,Bo.Z)(n.prototype),"push",this).call(this,e)}},{key:"unshift",value:function(e){(0,Zo.Z)((0,Bo.Z)(n.prototype),"isFull",this).call(this)&&this.expand(),(0,Zo.Z)((0,Bo.Z)(n.prototype),"unshift",this).call(this,e)}},{key:"expand",value:function(){for(var e=2*this.capacity,t=new Array(e),n=this.length(),r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}]),n}(Al);function Tl(e){return new Ml(e)}function Nl(e,t){return new Vl(e,t)}El.INITIAL_CAPACITY=32;var Dl,Fl=function(){function e(){(0,u.Z)(this,e)}return(0,s.Z)(e,[{key:"toArray",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t,n;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.next();case 3:n=e.sent;case 4:if(n.done){e.next=11;break}return t.push(n.value),e.next=8,this.next();case 8:n=e.sent,e.next=4;break;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t,n,r;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.prefetch(100),n=[],e.next=4,t.next();case 4:r=e.sent;case 5:if(r.done){e.next=12;break}return n.push(r.value),e.next=9,t.next();case 9:r=e.sent,e.next=5;break;case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveFully",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:t=e.sent;case 3:if(t.done){e.next=9;break}return e.next=6,this.next();case 6:t=e.sent,e.next=3;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resolveWhile",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){var n,r;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:n=e.sent,r=t(n.value);case 4:if(n.done||!r){e.next=11;break}return e.next=7,this.next();case 7:n=e.sent,r=t(n.value),e.next=4;break;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleErrors",value:function(e){return new Pl(this,e)}},{key:"filter",value:function(e){return new zl(this,e)}},{key:"map",value:function(e){return new Ll(this,e)}},{key:"mapAsync",value:function(e){return new jl(this,e)}},{key:"serialMapAsync",value:function(e){return new jl(this,e).serial()}},{key:"flatmap",value:function(e){return new Wl(this,e)}},{key:"forEachAsync",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.map(t).resolveFully());case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"serialForEach",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.serialMapAsync(t).resolveWhile((function(e){return!0===e})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rowMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new Bl(this,e,t)}},{key:"columnMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wl,r=this.rowMajorBatch(e,t);return r.map((function(e){return xl(e,n)}))}},{key:"concatenate",value:function(e,t){return new Vl(new Il([this,e]),t)}},{key:"take",value:function(e){return e<0||null==e?this:new Zl(this,e)}},{key:"skip",value:function(e){return e<0||null==e?this:new Rl(this,e)}},{key:"prefetch",value:function(e){return new Gl(this,e)}},{key:"shuffle",value:function(e,t){return new ql(this,e,t)}},{key:"serial",value:function(){return new Ol(this)}}]),e}(),Il=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).items=e,r.trav=0,r}return(0,s.Z)(n,[{key:"summary",value:function(){return"Array of ".concat(this.items.length," items")}},{key:"next",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.trav>=this.items.length)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return t=this.items[this.trav],this.trav++,e.abrupt("return",{value:Cl(t),done:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Fl),Ml=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).nextFn=e,r}return(0,s.Z)(n,[{key:"summary",value:function(){return"Function call"}},{key:"next",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",this.nextFn());case 4:throw e.prev=4,e.t0=e.catch(0),e.t0.message="Error thrown while iterating through a dataset: ".concat(e.t0.message),e.t0;case 8:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(){return e.apply(this,arguments)}}()}]),n}(Fl),Ol=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).upstream=e,r.lastRead=Promise.resolve({value:null,done:!1}),r}return(0,s.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Serial")}},{key:"next",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t=this;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.upstream.next());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Fl),Rl=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;return(0,u.Z)(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return(0,s.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Skip")}},{key:"next",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t=this;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++<this.maxCount)){e.next=9;break}return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done){e.next=6;break}return e.abrupt("return",t);case 6:Re.dispose(t.value),e.next=0;break;case 9:return e.abrupt("return",this.upstream.next());case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Fl),Zl=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;return(0,u.Z)(this,n),(a=t.call(this)).upstream=e,a.maxCount=r,a.count=0,a}return(0,s.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Take")}},{key:"next",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++>=this.maxCount)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return e.abrupt("return",this.upstream.next());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Fl),Bl=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(0,u.Z)(this,n),(a=t.call(this)).upstream=e,a.batchSize=r,a.enableSmallLastBatch=i,a.lastRead=Promise.resolve({value:null,done:!1}),a}return(0,s.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}},{key:"next",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t=this;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t,n;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[];case 1:if(!(t.length<this.batchSize)){e.next=12;break}return e.next=4,this.upstream.next();case 4:if(!(n=e.sent).done){e.next=9;break}if(!(this.enableSmallLastBatch&&t.length>0)){e.next=8;break}return e.abrupt("return",{value:t,done:!1});case 8:return e.abrupt("return",{value:null,done:!0});case 9:t.push(n.value),e.next=1;break;case 12:return e.abrupt("return",{value:t,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Fl),zl=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;return(0,u.Z)(this,n),(a=t.call(this)).upstream=e,a.predicate=r,a.lastRead=Promise.resolve({value:null,done:!1}),a}return(0,s.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Filter")}},{key:"next",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t=this;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done&&!this.predicate(t.value)){e.next=6;break}return e.abrupt("return",t);case 6:Re.dispose(t.value),e.next=0;break;case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Fl),Ll=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;return(0,u.Z)(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return(0,s.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Map")}},{key:"next",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t,n,r,a,i,o,u;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:n=Re.tensor_util.getTensorsInContainer(t.value),r=this.transform(t.value),a=Re.tensor_util.getTensorsInContainer(r),i=(0,h.Z)(n);try{for(i.s();!(o=i.n()).done;)u=o.value,Re.tensor_util.isTensorInList(u,a)||u.dispose()}catch(s){i.e(s)}finally{i.f()}return e.abrupt("return",{value:r,done:!1});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Fl),Pl=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;return(0,u.Z)(this,n),(a=t.call(this)).upstream=e,a.handler=r,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return(0,s.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> handleErrors")}},{key:"next",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t=this;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,this.upstream.next();case 4:return e.abrupt("return",e.sent);case 7:if(e.prev=7,e.t0=e.catch(1),this.handler(e.t0)){e.next=11;break}return e.abrupt("return",{value:null,done:!0});case 11:e.next=0;break;case 13:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(){return e.apply(this,arguments)}}()}]),n}(Fl),jl=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;return(0,u.Z)(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return(0,s.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> AsyncMap")}},{key:"next",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t,n,r,a,i,o,u;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:return n=Re.tensor_util.getTensorsInContainer(t.value),e.next=8,this.transform(t.value);case 8:r=e.sent,a=Re.tensor_util.getTensorsInContainer(r),i=(0,h.Z)(n);try{for(i.s();!(o=i.n()).done;)u=o.value,Re.tensor_util.isTensorInList(u,a)||u.dispose()}catch(s){i.e(s)}finally{i.f()}return e.abrupt("return",{value:r,done:!1});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Fl),Ul=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this)).outputQueue=new El,e.lastRead=Promise.resolve({value:null,done:!1}),e}return(0,s.Z)(n,[{key:"next",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t=this;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialNext",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.outputQueue.length()){e.next=7;break}return e.next=3,this.pump();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:e.next=0;break;case 7:return e.abrupt("return",{value:this.outputQueue.shift(),done:!1});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Fl),Wl=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;return(0,u.Z)(this,n),(a=t.call(this)).upstream=e,a.transform=r,a}return(0,s.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Flatmap")}},{key:"pump",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t,n,r,a,i,o,u;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",!1);case 5:n=Re.tensor_util.getTensorsInContainer(t.value),r=this.transform(t.value),a=Re.tensor_util.getTensorsInContainer(r),this.outputQueue.pushAll(r),i=(0,h.Z)(n);try{for(i.s();!(o=i.n()).done;)u=o.value,Re.tensor_util.isTensorInList(u,a)||u.dispose()}catch(s){i.e(s)}finally{i.f()}return e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Ul),Vl=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;return(0,u.Z)(this,n),(a=t.call(this)).baseErrorHandler=r,a.lastRead=null,a.iterator=null,a.moreIterators=e,a}return(0,s.Z)(n,[{key:"summary",value:function(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}},{key:"next",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.readFromChain(this.lastRead),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readFromChain",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){var n,r;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(null!=this.iterator){e.next=10;break}return e.next=5,this.moreIterators.next();case 5:if(!(n=e.sent).done){e.next=8;break}return e.abrupt("return",{value:null,done:!0});case 8:this.iterator=n.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler));case 10:return e.next=12,this.iterator.next();case 12:if(!(r=e.sent).done){e.next=16;break}return this.iterator=null,e.abrupt("return",this.readFromChain(t));case 16:return e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Fl);!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(Dl||(Dl={}));var Gl=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r){var a;return(0,u.Z)(this,n),(a=t.call(this)).upstream=e,a.bufferSize=r,a.buffer=new Al(r),a}return(0,s.Z)(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Prefetch")}},{key:"refill",value:function(){for(;!this.buffer.isFull();){var e=this.upstream.next();this.buffer.push(e)}}},{key:"next",value:function(){return this.refill(),this.buffer.shift()}}]),n}(Fl),ql=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e,r,a){var i;return(0,u.Z)(this,n),(i=t.call(this,e,r)).upstream=e,i.windowSize=r,i.upstreamExhausted=!1,i.random=yl.alea(a||Re.util.now().toString()),i.lastRead=Promise.resolve({value:null,done:!1}),i}return(0,s.Z)(n,[{key:"next",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t=this;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.lastRead=this.lastRead.then((function(){return t.serialNext()})),e.abrupt("return",this.lastRead);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"randomInt",value:function(e){return Math.floor(this.random()*e)}},{key:"chooseIndex",value:function(){return this.randomInt(this.buffer.length())}},{key:"serialNext",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t,n;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.upstreamExhausted||this.refill();case 1:if(this.buffer.isEmpty()){e.next=14;break}return t=this.chooseIndex(),e.next=5,this.buffer.shuffleExcise(t);case 5:if(!(n=e.sent).done){e.next=10;break}this.upstreamExhausted=!0,e.next=12;break;case 10:return this.refill(),e.abrupt("return",n);case 12:e.next=1;break;case 14:return e.abrupt("return",{value:null,done:!0});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Gl),Hl=function(){function e(){(0,u.Z)(this,e),this.size=null}return(0,s.Z)(e,[{key:"batch",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this;return Re.util.assert(e>0,(function(){return"batchSize needs to be positive, but it is\n      ".concat(e)})),t=this.size===1/0||null==this.size?this.size:n?Math.ceil(this.size/e):Math.floor(this.size/e),Xl((0,Co.Z)((0,_o.Z)().mark((function t(){return(0,_o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.iterator();case 2:return t.abrupt("return",t.sent.columnMajorBatch(e,n,Yl));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"concatenate",value:function(e){var t,n=this;return t=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,Xl((0,Co.Z)((0,_o.Z)().mark((function t(){return(0,_o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.t0=t.sent,t.next=5,e.iterator();case 5:return t.t1=t.sent,t.abrupt("return",t.t0.concatenate.call(t.t0,t.t1));case 7:case"end":return t.stop()}}),t)}))),t)}},{key:"filter",value:function(e){var t,n=this;return t=this.size===1/0?1/0:null,Xl((0,Co.Z)((0,_o.Z)().mark((function t(){return(0,_o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.filter((function(t){return Re.tidy((function(){return e(t)}))})));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"forEachAsync",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator();case 2:return e.abrupt("return",e.sent.forEachAsync(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"map",value:function(e){var t=this;return Xl((0,Co.Z)((0,_o.Z)().mark((function n(){return(0,_o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.map((function(t){return Re.tidy((function(){return e(t)}))})));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"mapAsync",value:function(e){var t=this;return Xl((0,Co.Z)((0,_o.Z)().mark((function n(){return(0,_o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.mapAsync(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"prefetch",value:function(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var t=this;return Xl((0,Co.Z)((0,_o.Z)().mark((function n(){return(0,_o.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.prefetch(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"repeat",value:function(e){var t,n=this;return t=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,Xl((0,Co.Z)((0,_o.Z)().mark((function t(){var r;return(0,_o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Tl((0,Co.Z)((0,_o.Z)().mark((function e(){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.iterator();case 2:return e.t0=e.sent,e.abrupt("return",{value:e.t0,done:!1});case 4:case"end":return e.stop()}}),e)})))),t.abrupt("return",Nl(r.take(e)));case 2:case"end":return t.stop()}}),t)}))),t)}},{key:"skip",value:function(e){var t,n=this;return t=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,Xl((0,Co.Z)((0,_o.Z)().mark((function t(){return(0,_o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.skip(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"shuffle",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));var r=this,a=yl.alea(t||Re.util.now().toString());return Xl((0,Co.Z)((0,_o.Z)().mark((function t(){var i;return(0,_o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=a.int32(),n&&(i+=a.int32()),t.next=4,r.iterator();case 4:return t.abrupt("return",t.sent.shuffle(e,i.toString()));case 5:case"end":return t.stop()}}),t)}))),this.size)}},{key:"take",value:function(e){var t,n=this;return t=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,Xl((0,Co.Z)((0,_o.Z)().mark((function t(){return(0,_o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.take(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"toArray",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArray());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toArrayForTest",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArrayForTest());case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Xl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new(function(n){(0,c.Z)(a,n);var r=(0,l.Z)(a);function a(){var e;return(0,u.Z)(this,a),(e=r.apply(this,arguments)).size=t,e}return(0,s.Z)(a,[{key:"iterator",value:function(){var t=(0,Co.Z)((0,_o.Z)().mark((function t(){return(0,_o.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e());case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),a}(Hl))}function Yl(e){return null===e?null:function(e){return null==e||null===(t=e)||"object"!==typeof t&&"function"!==typeof t||Array.isArray(e)||"object"===typeof e&&e instanceof Re.Tensor||Re.util.isTypedArray(e);var t}(e[0])?{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof Re.Tensor?Re.stack(e):Re.tensor(e)}(e),recurse:!1}:{value:null,recurse:!0}}Hl.MAX_BUFFER_SIZE=1e4;Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");function Kl(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&Re.util.assert("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors in the CPU backend.")}))}))}var $l=Re.kernel_impls.whereImpl,Ql=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(){var e;return(0,u.Z)(this,n),(e=t.call(this)).blockSize=48,e.firstUse=!0,e.data=new Re.DataStorage((0,ra.Z)(e),(0,Re.engine)()),e}return(0,s.Z)(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"write",value:function(e,t,n){this.firstUse&&(this.firstUse=!1,(0,Re.env)().get("IS_NODE")&&Re.backend_util.warn("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));var r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&Re.util.isString(n[0])){var a=n.map((function(e){return Re.util.encodeString(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}},{key:"refCount",value:function(e){return this.data.has(e)?this.data.get(e).refCount:0}},{key:"incRef",value:function(e){this.data.get(e).refCount++}},{key:"decRef",value:function(e){this.data.has(e)&&this.data.get(e).refCount--}},{key:"move",value:function(e,t,n,r,a){this.data.set(e,{values:t,dtype:r,refCount:a})}},{key:"numDataIds",value:function(){return this.data.numDataIds()}},{key:"read",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readSync(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readSync",value:function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensorInfos;if("complex64"===n){var a=this.readSync(r.real.dataId),i=this.readSync(r.imag.dataId);return Re.backend_util.mergeRealAndImagArrays(a,i)}return Re.util.convertBackendValuesAndArrayBuffer(this.data.get(e).values,n)}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId);if("string"===e.dtype)try{var n=t.map((function(e){return Re.util.decodeString(e)}));return(0,Re.buffer)(e.shape,e.dtype,n)}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return(0,Re.buffer)(e.shape,e.dtype,t)}},{key:"makeOutput",value:function(e,t,n){return(0,Re.engine)().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;var n=this.data.get(e),r=n.complexTensorInfos;null!=r&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"time",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){var n,r;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Re.util.now(),t(),r=Re.util.now()-n,e.abrupt("return",{kernelMs:r});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"memory",value:function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}},{key:"where",value:function(e){Kl([e],"where");var t=this.readSync(e.dataId);return $l(e.shape,t)}},{key:"dispose",value:function(){}},{key:"floatPrecision",value:function(){return 32}},{key:"epsilon",value:function(){return(0,Zo.Z)((0,Bo.Z)(n.prototype),"epsilon",this).call(this)}}]),n}(Re.KernelBackend);Ql.nextDataId=0;function Jl(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,u=a.x;if(Kl(u,e),"string"===u.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");for(var s=o,c=s.data.get(u.dataId).values,l=Re.util.sizeFromShape(u.shape),f=n||u.dtype,d=Re.util.getArrayFromDType(f,l),h=0;h<l;++h)d[h]=t(c[h],i);return s.makeTensorInfo(u.shape,f,d)}}function ef(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,u=a.x;if(Kl(u,e),"string"===u.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");var s=o,c=s.data.get(u.dataId).values,l=n||u.dtype,f=t(c,l,i);return s.makeTensorInfo(u.shape,l,f)}}(0,Re.registerBackend)("cpu",(function(){return new Ql}),1);var tf=Jl(Re.Elu,(function(e){return e>=0?e:Math.exp(e)-1})),nf={kernelName:Re.Elu,backendName:"cpu",kernelFunc:tf};function rf(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var af={kernelName:Re.Identity,backendName:"cpu",kernelFunc:rf};function of(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha;Kl([a],"leakyRelu");for(var o=Re.util.sizeFromShape(a.shape),u=n.data.get(a.dataId).values,s=Re.util.getTypedArrayFromDType("float32",o),c=0;c<u.length;c++)s[c]=u[c]<0?i*u[c]:u[c];return n.makeTensorInfo(a.shape,"float32",s)}var uf={kernelName:Re.LeakyRelu,backendName:"cpu",kernelFunc:of};function sf(e){return function(t,n,r,a,i){var o=Re.backend_util.assertAndGetBroadcastShape(t,n),u=o.length,s=Re.util.computeStrides(o),c=Re.util.sizeFromShape(o),l=Re.util.getTypedArrayFromDType(i,c),f=t.length,d=n.length,h=Re.util.computeStrides(t),p=Re.util.computeStrides(n),v=Re.backend_util.getBroadcastDims(t,o),g=Re.backend_util.getBroadcastDims(n,o);if(v.length+g.length===0)for(var m=0;m<l.length;++m)l[m]=e(r[m%r.length],a[m%a.length]);else for(var y=function(){var t=Re.util.indexToLoc(b,u,s),n=t.slice(-f);v.forEach((function(e){return n[e]=0}));var i=Re.util.locToIndex(n,f,h),o=t.slice(-d);g.forEach((function(e){return o[e]=0}));var c=Re.util.locToIndex(o,d,p);l[b]=e(r[i],a[c])},b=0;b<l.length;++b)y();return[l,o]}}var cf=sf((function(e,t){return e<0?t*e:e}));function lf(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha;Kl([r,a],"prelu");var o=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,s=cf(r.shape,a.shape,o,u,"float32"),c=(0,i.Z)(s,2),l=c[0],f=c[1];return n.makeTensorInfo(f,"float32",l)}var ff={kernelName:Re.Prelu,backendName:"cpu",kernelFunc:lf},df=Jl(Re.Relu,(function(e){return Math.max(0,e)})),hf={kernelName:Re.Relu,backendName:"cpu",kernelFunc:df},pf=Jl(Re.Relu6,(function(e){return Math.min(Math.max(0,e),6)})),vf={kernelName:Re.Relu6,backendName:"cpu",kernelFunc:pf};function gf(e){return function(t,n,r){for(var a=Re.util.getTypedArrayFromDType(n,t.length),i=0;i<t.length;++i)a[i]=e(t[i],r);return a}}var mf=gf((function(e){return 1/(1+Math.exp(-e))})),yf=Jl(Re.Sigmoid,(function(e){return 1/(1+Math.exp(-e))})),bf={kernelName:Re.Sigmoid,backendName:"cpu",kernelFunc:yf};function xf(e,t,n,r,a){if("linear"===n)return rf({inputs:{x:t},backend:e});if("relu"===n)return df({inputs:{x:t},backend:e});if("elu"===n)return tf({inputs:{x:t},backend:e});if("relu6"===n)return pf({inputs:{x:t},backend:e});if("prelu"===n)return lf({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return of({inputs:{x:t},backend:e,attrs:{alpha:a}});if("sigmoid"===n)return yf({inputs:{x:t},backend:e});throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}function kf(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,u=n.makeTensorInfo(r.shape,"complex64");return n.data.get(u.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},u}var wf={kernelName:Re.Complex,backendName:"cpu",kernelFunc:kf};function _f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){var r=_f(e,t,"float32"),a=_f(e,t,"float32");return kf({inputs:{real:r,imag:a},backend:e})}var i=Re.util.makeZerosTypedArray(Re.util.sizeFromShape(t),n);return e.makeTensorInfo(t,n,i)}function Cf(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var Sf={kernelName:Re.Real,backendName:"cpu",kernelFunc:Cf};function Af(e,t,n,r){if("int32"===r)return[t,"int32",Int32Array.from(e)];if("bool"===r){var a=Re.util.toTypedArray([0],n),o=sf((function(e,t){return e!==t?1:0}))(t,[],e,a,"bool"),u=(0,i.Z)(o,2),s=u[0];return[u[1],"bool",s]}throw new Error("Error in Cast: failed to cast ".concat(n," to ").concat(r))}function Ef(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.dtype;if("complex64"===o){if("complex64"===a.dtype)return rf({inputs:{x:a},backend:n});var u=_f(n,a.shape,a.dtype),s=Ef({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),c=kf({inputs:{real:s,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(s),c}if("complex64"===a.dtype){var l=Cf({inputs:{input:a},backend:n}),f=Ef({inputs:{x:l},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(l),f}if(!Re.util.hasEncodingLoss(a.dtype,o)){var d=rf({inputs:{x:a},backend:n});return{dataId:d.dataId,shape:d.shape,dtype:o}}var h=Af(n.data.get(a.dataId).values,a.shape,a.dtype,o),p=(0,i.Z)(h,3),v=p[0],g=p[1],m=p[2];return n.makeTensorInfo(v,g,m)}var Tf={kernelName:Re.Cast,backendName:"cpu",kernelFunc:Ef};function Nf(e,t,n,r){return null==n?function(n){var a=n.inputs,o=n.backend,u=a.a,s=a.b,c=o;Kl([u,s],e);var l=c.data.get(u.dataId).values,f=c.data.get(s.dataId).values,d="string"===u.dtype?Re.backend_util.fromUint8ToStringArray(l):l,h="string"===u.dtype?Re.backend_util.fromUint8ToStringArray(f):f,p=r||u.dtype,v=t(u.shape,s.shape,d,h,p),g=(0,i.Z)(v,2),m=g[0],y=g[1];return c.makeTensorInfo(y,p,m)}:function(e){var a=e.inputs,o=e.backend,u=a.a,s=a.b,c=o;if("complex64"===u.dtype||"complex64"===s.dtype){var l=Ef({inputs:{x:u},backend:c,attrs:{dtype:"complex64"}}),f=c.data.get(l.dataId),d=f.complexTensorInfos.real,h=f.complexTensorInfos.imag,p=c.data.get(d.dataId).values,v=c.data.get(h.dataId).values,g=Ef({inputs:{x:s},backend:c,attrs:{dtype:"complex64"}}),m=c.data.get(g.dataId),y=m.complexTensorInfos.real,b=m.complexTensorInfos.imag,x=c.data.get(y.dataId).values,k=c.data.get(b.dataId).values,w=n(u.shape,s.shape,p,v,x,k),_=(0,i.Z)(w,3),C=_[0],S=_[1],A=_[2],E=c.makeTensorInfo(A,"float32",C),T=c.makeTensorInfo(A,"float32",S),N=kf({inputs:{real:E,imag:T},backend:c});return c.disposeIntermediateTensorInfo(l),c.disposeIntermediateTensorInfo(g),c.disposeIntermediateTensorInfo(E),c.disposeIntermediateTensorInfo(T),N}var D=c.data.get(u.dataId).values,F=c.data.get(s.dataId).values,I=r||u.dtype,M=t(u.shape,s.shape,D,F,I),O=(0,i.Z)(M,2),R=O[0],Z=O[1];return c.makeTensorInfo(Z,I,R)}}function Df(e){return function(t,n,r,a,i,o){var u=Re.backend_util.assertAndGetBroadcastShape(t,n),s=Re.util.sizeFromShape(u),c=u.length,l=Re.util.computeStrides(u),f=Re.util.getTypedArrayFromDType("float32",s),d=Re.util.getTypedArrayFromDType("float32",s),h=Re.backend_util.getBroadcastDims(t,u),p=Re.backend_util.getBroadcastDims(n,u),v=Re.backend_util.mergeRealAndImagArrays(r,a),g=Re.backend_util.mergeRealAndImagArrays(i,o),m=t.length,y=Re.util.computeStrides(t),b=n.length,x=Re.util.computeStrides(n);if(h.length+p.length===0)for(var k=0;k<f.length;k++){var w=k%v.length,_=k%g.length,C=e(v[2*w],v[2*w+1],g[2*_],g[2*_+1]);f[k]=C.real,d[k]=C.imag}else for(var S=function(){var t=Re.util.indexToLoc(A,c,l),n=t.slice(-m);h.forEach((function(e){return n[e]=0}));var r=Re.util.locToIndex(n,m,y),a=t.slice(-b);p.forEach((function(e){return a[e]=0}));var i=Re.util.locToIndex(a,b,x),o=e(v[2*r],v[2*r+1],g[2*i],g[2*i+1]);f[A]=o.real,d[A]=o.imag},A=0;A<f.length;A++)S();return[f,d,u]}}var Ff=sf((function(e,t){return e+t})),If=Df((function(e,t,n,r){return{real:e+n,imag:t+r}})),Mf=Nf(Re.Add,Ff,If),Of={kernelName:Re.Add,backendName:"cpu",kernelFunc:Mf};function Rf(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,o=Re.util.sizeFromShape(a.shape),u=Re.util.inferFromImplicitShape(i,o),s=Re.util.sizeFromShape(u);Re.util.assert(o===s,(function(){return"The new shape (".concat(u,") has ").concat(s," elements and the old ")+"shape (".concat(a.shape,") has ").concat(o," elements. The new shape and old ")+"shape must have the same number of elements."})),n.incRef(a.dataId);var c=n.data.get(a.dataId);if(null!=c.complexTensorInfos){var l=c.complexTensorInfos.real,f=c.complexTensorInfos.imag;l.shape=u,f.shape=u}return{dataId:a.dataId,shape:u,dtype:a.dtype}}var Zf={kernelName:Re.Reshape,backendName:"cpu",kernelFunc:Rf};function Bf(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,o=t.b,u=r.transposeA,s=r.transposeB;Kl([a,o],"matMul");var c=a.shape.length,l=o.shape.length,f=u?a.shape[c-2]:a.shape[c-1],d=s?o.shape[l-1]:o.shape[l-2],h=u?a.shape[c-1]:a.shape[c-2],p=s?o.shape[l-2]:o.shape[l-1],v=a.shape.slice(0,-2),g=o.shape.slice(0,-2),m=Re.util.sizeFromShape(v),y=Re.util.sizeFromShape(g),b=Re.broadcast_util.assertAndGetBroadcastShape(a.shape.slice(0,-2),o.shape.slice(0,-2)).concat([h,p]);Re.util.assert(f===d,(function(){return"Error in matMul: inner shapes (".concat(f,") and (")+"".concat(d,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(o.shape," and transposeA=").concat(u)+" and transposeB=".concat(s," must match.")}));for(var x=s?[y,p,d]:[y,d,p],k=Rf({inputs:{x:a},backend:n,attrs:{shape:u?[m,f,h]:[m,h,f]}}),w=Rf({inputs:{x:o},backend:n,attrs:{shape:x}}),_=u?k.shape[1]:k.shape[2],C=u?k.shape[2]:k.shape[1],S=s?w.shape[1]:w.shape[2],A=Math.max(m,y),E=n.data.get(k.dataId).values,T=n.data.get(w.dataId).values,N=Re.util.computeStrides(k.shape),D=Re.util.computeStrides(w.shape),F=u?[N[0],1,N[1]]:[N[0],N[1],1],I=(0,i.Z)(F,3),M=I[0],O=I[1],R=I[2],Z=s?[1,D[1],D[0]]:[D[1],1,D[0]],B=(0,i.Z)(Z,3),z=B[0],L=B[1],P=B[2],j=C*S,U=(0,Re.buffer)([A,C,S],k.dtype),W=U.values,V=n.blockSize,G=0;G<A;G++)for(var q=G%m,H=G%y,X=0;X<C;X+=V)for(var Y=Math.min(X+V,C),K=0;K<S;K+=V)for(var $=Math.min(K+V,S),Q=0;Q<_;Q+=V)for(var J=Math.min(Q+V,_),ee=X;ee<Y;ee++)for(var te=K;te<$;te++){for(var ne=0,re=Q;re<J;re++){ne+=E[q*M+ee*O+re*R]*T[re*z+te*L+H*P]}W[G*j+(ee*S+te)]+=ne}return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(w),n.makeTensorInfo(b,U.dtype,U.values)}var zf={kernelName:Re.BatchMatMul,backendName:"cpu",kernelFunc:Bf};var Lf={kernelName:Re._FusedMatMul,backendName:"cpu",kernelFunc:function(e){var t,n,r,a=e.inputs,i=e.backend,o=e.attrs,u=a.a,s=a.b,c=a.bias,l=a.preluActivationWeights,f=o.transposeA,d=o.transposeB,h=o.activation,p=o.leakyreluAlpha,v=[];t=Bf({inputs:{a:u,b:s},attrs:{transposeA:f,transposeB:d},backend:i}),c&&(n=Mf({inputs:{a:t,b:c},backend:i}),v.push(t),t=n),h&&(r=xf(i,t,h,l,p),v.push(t),t=r);for(var g=0,m=v;g<m.length;g++){var y=m[g];i.disposeIntermediateTensorInfo(y)}return t}};function Pf(e){for(var t=new Float32Array(e.length),n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}var jf={kernelName:Re.Abs,backendName:"cpu",kernelFunc:function(e){var t=e.inputs.x,n=e.backend;Kl(t,"abs");var r=new Float32Array(Re.util.sizeFromShape(t.shape));return r=Pf(n.data.get(t.dataId).values),n.makeOutput(r,t.shape,t.dtype)}},Uf=Jl(Re.Acos,(function(e){return Math.acos(e)})),Wf={kernelName:Re.Acos,backendName:"cpu",kernelFunc:Uf},Vf=Jl(Re.Acosh,(function(e){return Math.acosh(e)})),Gf={kernelName:Re.Acosh,backendName:"cpu",kernelFunc:Vf};var qf={kernelName:Re.AddN,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;Kl(t,"addN");for(var a=r.map((function(e){return n.data.get(e.dataId).values})),i=(0,Re.buffer)(r[0].shape,r[0].dtype),o=i.values,u=0;u<r.length;u++)for(var s=a[u],c=0;c<o.length;c++)o[c]+=s[c];return n.makeTensorInfo(i.shape,i.dtype,i.values)}};function Hf(e,t,n,r,a){for(var i=t.length,o=Re.util.sizeFromShape(t),u=Re.util.computeStrides(t),s=Re.util.computeStrides(a),c=Re.util.getTypedArrayFromDType(n,Re.util.sizeFromShape(a)),l=0;l<o;++l){for(var f=Re.util.indexToLoc(l,i,u),d=new Array(f.length),h=0;h<d.length;h++)d[h]=f[r[h]];c[Re.util.locToIndex(d,i,s)]=e[l]}return c}function Xf(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.perm;Kl(a,"transpose");for(var o=a.shape.length,u=new Array(o),s=0;s<u.length;s++)u[s]=a.shape[i[s]];var c=Hf(r.data.get(a.dataId).values,a.shape,a.dtype,i,u);return{dataId:r.write(c,u,a.dtype),shape:u,dtype:a.dtype}}var Yf={kernelName:Re.Transpose,backendName:"cpu",kernelFunc:Xf};var Kf={kernelName:Re.All,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.axis,u=r.keepDims;Kl(a,"all");var s=Re.util.parseAxisParam(o,a.shape),c=s,l=Re.backend_util.getAxesPermutation(c,a.shape.length),f=a;null!=l&&(f=Xf({inputs:{x:a},backend:n,attrs:{perm:l}}),c=Re.backend_util.getInnerMostAxes(c.length,a.shape.length)),Re.backend_util.assertAxesAreInnerMostDims("all",c,f.shape.length);for(var d=Re.backend_util.computeOutAndReduceShapes(f.shape,c),h=(0,i.Z)(d,2),p=h[0],v=h[1],g=Re.util.sizeFromShape(v),m=Re.util.makeZerosTypedArray(Re.util.sizeFromShape(p),f.dtype),y=n.data.get(f.dataId).values,b=0;b<m.length;++b){for(var x=b*g,k=y[x],w=0;w<g;++w){var _=y[x+w];k=k&&_}m[b]=k}null!=l&&n.disposeIntermediateTensorInfo(f);var C=n.makeTensorInfo(p,f.dtype,m);if(u){var S=Rf({inputs:{x:C},backend:n,attrs:{shape:Re.backend_util.expandShapeToKeepDim(p,s)}});return n.disposeIntermediateTensorInfo(C),S}return C}};var $f={kernelName:Re.Any,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.axis,u=r.keepDims;Kl(a,"any");var s=Re.util.parseAxisParam(o,a.shape),c=s,l=Re.backend_util.getAxesPermutation(c,a.shape.length),f=a;null!=l&&(f=Xf({inputs:{x:a},backend:n,attrs:{perm:l}}),c=Re.backend_util.getInnerMostAxes(c.length,a.shape.length)),Re.backend_util.assertAxesAreInnerMostDims("any",c,f.shape.length);for(var d=Re.backend_util.computeOutAndReduceShapes(f.shape,c),h=(0,i.Z)(d,2),p=h[0],v=h[1],g=Re.util.sizeFromShape(v),m=Re.util.makeZerosTypedArray(Re.util.sizeFromShape(p),f.dtype),y=n.data.get(f.dataId).values,b=0;b<m.length;++b){for(var x=b*g,k=y[x],w=0;w<g;++w){var _=y[x+w];k=k||_}m[b]=k}null!=l&&n.disposeIntermediateTensorInfo(f);var C=n.makeTensorInfo(p,f.dtype,m);if(u){var S=Rf({inputs:{x:C},backend:n,attrs:{shape:Re.backend_util.expandShapeToKeepDim(p,s)}});return n.disposeIntermediateTensorInfo(C),S}return C}};var Qf={kernelName:Re.ArgMax,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.axis;Kl(a,"argMax");var u=Re.util.parseAxisParam(o,a.shape),s=Re.backend_util.getAxesPermutation(u,a.shape.length),c=a,l=[];null!=s&&(c=Xf({inputs:{x:a},backend:n,attrs:{perm:s}}),l.push(c),u=Re.backend_util.getInnerMostAxes(u.length,c.shape.length)),u=[u[0]],Re.backend_util.assertAxesAreInnerMostDims("argMax",u,c.shape.length);for(var f=Re.backend_util.computeOutAndReduceShapes(c.shape,u),d=(0,i.Z)(f,2),h=d[0],p=d[1],v=Re.util.sizeFromShape(h),g=Re.util.makeZerosTypedArray(v,"int32"),m=Re.util.sizeFromShape(p),y=n.data.get(c.dataId).values,b=0;b<g.length;++b){for(var x=b*m,k=y[x],w=0,_=0;_<m;++_){var C=y[x+_];C>k&&(k=C,w=_)}g[b]=w}return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(h,"int32",g)}};var Jf={kernelName:Re.ArgMin,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.axis;Kl(a,"argMin");var u=Re.util.parseAxisParam(o,a.shape),s=Re.backend_util.getAxesPermutation(u,a.shape.length),c=a,l=[];null!=s&&(c=Xf({inputs:{x:a},backend:n,attrs:{perm:s}}),l.push(c),u=Re.backend_util.getInnerMostAxes(u.length,c.shape.length)),u=[u[0]],Re.backend_util.assertAxesAreInnerMostDims("argMin",u,c.shape.length);for(var f=Re.backend_util.computeOutAndReduceShapes(c.shape,u),d=(0,i.Z)(f,2),h=d[0],p=d[1],v=Re.util.sizeFromShape(h),g=Re.util.makeZerosTypedArray(v,"int32"),m=Re.util.sizeFromShape(p),y=n.data.get(c.dataId).values,b=0;b<g.length;++b){for(var x=b*m,k=y[x],w=0,_=0;_<m;++_){var C=y[x+_];C<k&&(k=C,w=_)}g[b]=w}return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(h,"int32",g)}},ed=Jl(Re.Asin,(function(e){return Math.asin(e)})),td={kernelName:Re.Asin,backendName:"cpu",kernelFunc:ed},nd=Jl(Re.Asinh,(function(e){return Math.asinh(e)})),rd={kernelName:Re.Asinh,backendName:"cpu",kernelFunc:nd},ad=Jl(Re.Atan,(function(e){return Math.atan(e)})),id={kernelName:Re.Atan,backendName:"cpu",kernelFunc:ad},od=sf((function(e,t){return Math.atan2(e,t)})),ud=Nf(Re.Atan2,od),sd={kernelName:Re.Atan2,backendName:"cpu",kernelFunc:ud},cd=Jl(Re.Atanh,(function(e){return Math.atanh(e)})),ld={kernelName:Re.Atanh,backendName:"cpu",kernelFunc:cd};function fd(e,t,n,r,a,i){for(var o=a.strideHeight,u=a.strideWidth,s=a.dilationHeight,c=a.dilationWidth,l=a.effectiveFilterHeight,f=a.effectiveFilterWidth,d=a.padInfo.top,h=a.padInfo.left,p="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=(0,Re.buffer)(a.outShape,n),g=v.values,m=a.outShape[1]*a.outShape[2]*a.outShape[3],y=a.outShape[2]*a.outShape[3],b=a.outShape[3],x=0;x<a.batchSize;++x)for(var k=x*m,w=x*r[0],_=0;_<a.inChannels;++_)for(var C=0;C<a.outHeight;++C)for(var S=C*o-d,A=Math.max(0,S),E=Math.min(a.inHeight,l+S),T=k+C*y,N=0;N<a.outWidth;++N){for(var D=N*u-h,F=Math.max(0,D),I=Math.min(a.inWidth,f+D),M=p,O=0,R=0,Z=A;Z<E;Z+=s){for(var B=w+Z*r[1],z=F;z<I;z+=c){var L=e[B+z*r[2]+_];"max"===i&&L>M?M=L:"avg"===i&&(O+=L,R++)}if(isNaN(M))break}g[T+N*b+_]="avg"===i?O/R:M}return v}function dd(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=(0,Re.buffer)(r.outShape,"int32"),u=r.strideHeight,s=r.strideWidth,c=r.dilationHeight,l=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,p=r.padInfo.left,v=(0,Re.buffer)(t,n,e),g=0;g<r.batchSize;++g)for(var m=0;m<r.inChannels;++m)for(var y=0;y<r.outHeight;++y){for(var b=y*u-h,x=b;x<0;)x+=c;for(var k=Math.min(r.inHeight,f+b),w=0;w<r.outWidth;++w){for(var _=w*s-p,C=_;C<0;)C+=l;for(var S=Math.min(r.inWidth,d+_),A=Number.NEGATIVE_INFINITY,E=-1,T=x;T<k;T+=c)for(var N=T-b,D=C;D<S;D+=l){var F=D-_,I=v.get(g,T,D,m);I>A&&(A=I,E=a?i?((g*r.inHeight+T)*r.inWidth+D)*r.inChannels+m:(T*r.inWidth+D)*r.inChannels+m:N*d+F)}o.set(E,g,y,w,m)}}return o}function hd(e,t,n,r,a,i){for(var o=a.strideDepth,u=a.strideHeight,s=a.strideWidth,c=a.dilationDepth,l=a.dilationHeight,f=a.dilationWidth,d=a.effectiveFilterDepth,h=a.effectiveFilterHeight,p=a.effectiveFilterWidth,v=a.padInfo.front,g=a.padInfo.top,m=a.padInfo.left,y="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=(0,Re.buffer)(a.outShape,n),x=b.values,k=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],w=a.outShape[2]*a.outShape[3]*a.outShape[4],_=a.outShape[3]*a.outShape[4],C=a.outShape[4],S=0;S<a.batchSize;++S)for(var A=S*k,E=S*r[0],T=0;T<a.inChannels;++T)for(var N=0;N<a.outDepth;++N){for(var D=N*o-v,F=D;F<0;)F+=c;for(var I=Math.min(a.inDepth,d+D),M=A+N*w,O=0;O<a.outHeight;++O){for(var R=O*u-g,Z=R;Z<0;)Z+=l;for(var B=Math.min(a.inHeight,h+R),z=M+O*_,L=0;L<a.outWidth;++L){for(var P=L*s-m,j=P;j<0;)j+=f;for(var U=Math.min(a.inWidth,p+P),W=z+L*C,V=y,G=0,q=0,H=F;H<I;H+=c){for(var X=E+H*r[1],Y=Z;Y<B;Y+=l){for(var K=X+Y*r[2],$=j;$<U;$+=f){var Q=e[K+$*r[3]+T];if("max"===i&&Q>V?V=Q:"avg"===i&&(G+=Q,q++),isNaN(V))break}if(isNaN(V))break}if(isNaN(V))break}x[W+T]="avg"===i?G/Math.max(q,1):V}}}return b}var pd={kernelName:Re.AvgPool,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;Kl(a,"avgPool");var i=r.filterSize,o=r.strides,u=r.pad,s=r.dimRoundingMode;Re.util.assert(Re.backend_util.eitherStridesOrDilationsAreOne(o,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c,l=Re.backend_util.computePool2DInfo(a.shape,i,o,1,u,s);if(1===l.filterWidth&&1===l.filterHeight&&Re.util.arraysEqual(l.inShape,l.outShape))c=rf({inputs:{x:a},backend:n});else{var f=n.data.get(a.dataId).values,d=Re.util.computeStrides(a.shape),h=fd(f,a.shape,a.dtype,d,l,"avg");c=n.makeTensorInfo(l.outShape,a.dtype,h.values)}return c}};var vd={kernelName:Re.AvgPool3D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,u=r.pad,s=r.dimRoundingMode,c=r.dataFormat;Kl(a,"avgPool3d");var l=Re.backend_util.computePool3DInfo(a.shape,i,o,1,u,s,c),f=hd(n.data.get(a.dataId).values,a.shape,a.dtype,Re.util.computeStrides(a.shape),l,"avg");return n.makeTensorInfo(f.shape,"float32",f.values)}};var gd={kernelName:Re.AvgPool3DGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,u=r.strides,s=r.pad,c=r.dimRoundingMode;Kl([a,i],"avgPool3DGrad");for(var l=Re.backend_util.computePool3DInfo(i.shape,o,u,1,s,c),f=l.strideDepth,d=l.strideHeight,h=l.strideWidth,p=l.filterDepth,v=l.filterHeight,g=l.filterWidth,m=l.dilationDepth,y=l.dilationHeight,b=l.dilationWidth,x=l.effectiveFilterDepth,k=l.effectiveFilterHeight,w=l.effectiveFilterWidth,_=x-1-l.padInfo.front,C=w-1-l.padInfo.left,S=k-1-l.padInfo.top,A=(0,Re.buffer)(i.shape,"float32"),E=1/(p*v*g),T=n.bufferSync(a),N=0;N<l.batchSize;++N)for(var D=0;D<l.inChannels;++D)for(var F=0;F<l.inDepth;++F)for(var I=0;I<l.inHeight;++I)for(var M=0;M<l.inWidth;++M){for(var O=F-_,R=I-S,Z=M-C,B=0,z=0;z<x;z+=m){var L=(O+z)/f;if(!(L<0||L>=l.outDepth||Math.floor(L)!==L))for(var P=0;P<k;P+=y){var j=(R+P)/d;if(!(j<0||j>=l.outHeight||Math.floor(j)!==j))for(var U=0;U<w;U+=b){var W=(Z+U)/h;if(!(W<0||W>=l.outWidth||Math.floor(W)!==W))B+=T.get(N,L,j,W,D)}}}A.set(B*E,N,F,I,M,D)}return n.makeTensorInfo(A.shape,A.dtype,A.values)}};var md={kernelName:Re.AvgPoolGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;Kl([a,i],"avgPoolGrad");for(var u=r.filterSize,s=r.strides,c=r.pad,l=Re.backend_util.computePool2DInfo(o.shape,u,s,1,c),f=l.strideHeight,d=l.strideWidth,h=l.filterHeight,p=l.filterWidth,v=l.dilationHeight,g=l.dilationWidth,m=l.effectiveFilterHeight,y=l.effectiveFilterWidth,b=y-1-l.padInfo.left,x=m-1-l.padInfo.top,k=(0,Re.buffer)(o.shape,"float32"),w=1/(h*p),_=n.data.get(a.dataId).values,C=(0,Re.buffer)(a.shape,"float32",_),S=0;S<l.batchSize;++S)for(var A=0;A<l.inChannels;++A)for(var E=0;E<l.inHeight;++E)for(var T=0;T<l.inWidth;++T){for(var N=E-x,D=T-b,F=0,I=0;I<m;I+=v){var M=(N+I)/f;if(!(M<0||M>=l.outHeight||Math.floor(M)!==M))for(var O=0;O<y;O+=g){var R=(D+O)/d;if(!(R<0||R>=l.outWidth||Math.floor(R)!==R))F+=C.get(S,M,R,A)}}k.set(F*w,S,E,T,A)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}};var yd={kernelName:Re.FusedBatchNorm,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.scale,o=t.offset,u=t.mean,s=t.variance;Re.util.assert(u.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),Re.util.assert(null==o||u.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),Re.util.assert(null==i||u.shape.length===i.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),Kl([a,u,s,i,o],"batchNorm");var c=r.varianceEpsilon;null==c&&(c=.001);for(var l=n.data.get(a.dataId).values,f=n.data.get(u.dataId).values,d=n.data.get(s.dataId).values,h=i?n.data.get(i.dataId).values:new Float32Array([1]),p=o?n.data.get(o.dataId).values:new Float32Array([0]),v=new Float32Array(l.length),g=p.length,m=h.length,y=d.length,b=f.length,x=0,k=0,w=0,_=0,C=0;C<l.length;++C)v[C]=p[x++]+(l[C]-f[k++])*h[w++]/Math.sqrt(d[_++]+c),x>=g&&(x=0),k>=b&&(k=0),w>=m&&(w=0),_>=y&&(_=0);return n.makeTensorInfo(a.shape,a.dtype,v)}};function bd(e,t,n,r,a){var i=Re.slice_util.isSliceContinous(r,t,n),u=Re.util.sizeFromShape(n),s=Re.util.computeStrides(r);if(i){var c=Re.slice_util.computeFlatOffset(t,s);return"string"===a?e.slice(c,c+u):e.subarray(c,c+u)}for(var l="string"===a?Re.backend_util.fromUint8ToStringArray(e):e,f=(0,Re.buffer)(r,a,l),d=(0,Re.buffer)(n,a),h=0;h<d.size;++h){var p=d.indexToLoc(h),v=p.map((function(e,n){return e+t[n]}));d.set.apply(d,[f.get.apply(f,(0,o.Z)(v))].concat((0,o.Z)(p)))}return"string"===a?Re.backend_util.fromStringArrayToUint8(d.values):d.values}function xd(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.begin,u=r.size;Kl(a,"slice");var s=Re.slice_util.parseSliceParams(a,o,u),c=(0,i.Z)(s,2),l=c[0],f=c[1];Re.slice_util.assertParamsValid(a,l,f);var d=bd(n.data.get(a.dataId).values,l,f,a.shape,a.dtype);return n.makeTensorInfo(f,a.dtype,d)}var kd={kernelName:Re.Slice,backendName:"cpu",kernelFunc:xd};var wd={kernelName:Re.BatchToSpaceND,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;Kl([a],"batchToSpaceND");var u=i.reduce((function(e,t){return e*t})),s=Re.backend_util.getReshaped(a.shape,i,u),c=Re.backend_util.getPermuted(s.length,i.length),l=Re.backend_util.getReshapedPermuted(a.shape,i,u),f=Re.backend_util.getSliceBeginCoords(o,i.length),d=Re.backend_util.getSliceSize(l,o,i.length),h=Rf({inputs:{x:a},backend:n,attrs:{shape:s}}),p=Xf({inputs:{x:h},backend:n,attrs:{perm:c}}),v=Rf({inputs:{x:p},backend:n,attrs:{shape:l}}),g=xd({inputs:{x:v},backend:n,attrs:{begin:f,size:d}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),g}};function _d(e,t,n,r,a){for(var i=Re.util.sizeFromShape(r),o=Re.util.makeZerosTypedArray(a,n),u=0;u<e.length;u++){var s=e[u];if(s<0)throw new Error("Input x must be non-negative!");s>=a||(o[s]+=i>0?t[u]:1)}return o}function Cd(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.shape[0],i=e.shape[1],o=(0,Re.buffer)([a,n],t.dtype),u=0;u<a;u++)for(var s=0;s<i;s++){var c=e.get(u,s);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(r?o.set(1,u,c):t.size>0?o.set(o.get(u,c)+t.get(u,s),u,c):o.set(o.get(u,c)+1,u,c))}return o}var Sd={kernelName:Re.Bincount,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,u=_d(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}};var Ad={kernelName:Re.BroadcastArgs,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.s0,a=t.s1,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,u=Re.backend_util.assertAndGetBroadcastShape(Array.from(i),Array.from(o));return n.makeTensorInfo([u.length],"int32",Int32Array.from(u))}},Ed=gf((function(e){return Math.ceil(e)})),Td=ef(Re.Ceil,Ed),Nd={kernelName:Re.Ceil,backendName:"cpu",kernelFunc:Td},Dd=Jl(Re.ClipByValue,(function(e,t){var n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e})),Fd={kernelName:Re.ClipByValue,backendName:"cpu",kernelFunc:Dd},Id={kernelName:Re.ComplexAbs,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs.x,n=e.backend,r=new Float32Array(Re.util.sizeFromShape(t.shape)),a=n.data.get(t.dataId),i=a.complexTensorInfos.real,o=a.complexTensorInfos.imag,u=n.data.get(i.dataId).values,s=n.data.get(o.dataId).values,c=0;c<u.length;c++){var l=u[c],f=s[c];r[c]=Math.hypot(l,f)}return n.makeOutput(r,t.shape,"float32")}};function Md(e,t,n,r){var a=Re.util.getArrayFromDType(n,Re.util.sizeFromShape(t));if(r&&"string"!==n){var i=0;e.forEach((function(e){var t=Re.util.sizeFromShape(e.shape);a.set(e.vals,i),i+=t}))}else{var o=0;e.forEach((function(e){for(var r="string"===n?Re.backend_util.fromUint8ToStringArray(e.vals):e.vals,i=0,u=0;u<e.shape[0];++u)for(var s=u*t[1]+o,c=0;c<e.shape[1];++c)a[s+c]=r[i++];o+=e.shape[1]}))}return a}function Od(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}var Rd={kernelName:Re.Imag,backendName:"cpu",kernelFunc:Od};function Zd(e){var t=e.inputs,n=e.backend,r=e.attrs.axis,a=Re.util.parseAxisParam(r,t[0].shape)[0],i=t.map((function(e){return e.shape}));Re.backend_util.assertParamsConsistent(i,a);var o=Re.backend_util.computeOutShape(t.map((function(e){return e.shape})),a);if(0===Re.util.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);var u=t.filter((function(e){return Re.util.sizeFromShape(e.shape)>0}));if(1===u.length)return rf({inputs:{x:u[0]},backend:n});if("complex64"===u[0].dtype){var s=u.map((function(e){return Cf({inputs:{input:e},backend:n})})),c=u.map((function(e){return Od({inputs:{input:e},backend:n})})),l=Zd({inputs:s,backend:n,attrs:{axis:a}}),f=Zd({inputs:c,backend:n,attrs:{axis:a}}),d=kf({inputs:{real:l,imag:f},backend:n});return s.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),d}var h=u.map((function(e){var t=Re.util.sizeFromShape(e.shape.slice(a));return Rf({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})})),p=h.map((function(e){return{vals:n.data.get(e.dataId).values,shape:e.shape}}));o=Re.backend_util.computeOutShape(h.map((function(e){return e.shape})),1);var v=1===h[0].shape[0],g=Md(p,o,t[0].dtype,v),m=Re.backend_util.computeOutShape(u.map((function(e){return e.shape})),a),y=n.makeTensorInfo(m,t[0].dtype,g);return h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),y}var Bd={kernelName:Re.Concat,backendName:"cpu",kernelFunc:Zd};function zd(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,u=r.pad,s=r.dataFormat,c=r.dilations,l=r.dimRoundingMode;Kl([a,i],"conv2d");for(var f=Re.backend_util.convertConv2DDataFormat(s),d=Re.backend_util.computeConv2DInfo(a.shape,i.shape,o,c,u,l,!1,f),h=d.filterHeight,p=d.filterWidth,v=d.dilationHeight,g=d.dilationWidth,m=d.padInfo.left,y=d.padInfo.top,b="channelsLast"===d.dataFormat,x=new Re.TensorBuffer(d.outShape,a.dtype),k=Re.util.computeStrides(a.shape),w=Re.util.computeStrides(i.shape),_=k[0],C=b?k[1]:k[2],S=b?k[2]:1,A=b?1:k[1],E=x.strides[0],T=b?x.strides[1]:x.strides[2],N=b?x.strides[2]:1,D=b?1:x.strides[1],F=n.data.get(a.dataId).values,I=n.data.get(i.dataId).values,M=x.values,O=0;O<d.batchSize;++O)for(var R=O*_,Z=O*E,B=0;B<d.outHeight;++B)for(var z=Z+B*T,L=B*d.strideHeight-y,P=0;P<h;++P){var j=L+P*v;if(!(j<0||j>=d.inHeight))for(var U=P*w[0],W=R+j*C,V=0;V<d.outWidth;++V)for(var G=z+V*N,q=V*d.strideWidth-m,H=0;H<p;++H){var X=q+H*g;if(!(X<0||X>=d.inWidth))for(var Y=W+X*S,K=U+H*w[1],$=0;$<d.inChannels;++$){for(var Q=F[Y+$*A],J=0;J<d.outChannels;++J)M[G+J*D]+=Q*I[K+J];K+=d.outChannels}}}return n.makeTensorInfo(x.shape,x.dtype,M)}var Ld={kernelName:Re.Conv2D,backendName:"cpu",kernelFunc:zd};var Pd={kernelName:Re.Conv2DBackpropFilter,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,u=r.pad,s=r.dataFormat,c=r.dimRoundingMode,l=r.filterShape;Kl([a,i],"conv2dBackpropFilter");for(var f=Re.backend_util.convertConv2DDataFormat(s),d=Re.backend_util.computeConv2DInfo(a.shape,l,o,1,u,c,!1,f),h=d.strideHeight,p=d.strideWidth,v=d.filterHeight,g=d.filterWidth,m="channelsLast"===d.dataFormat,y=new Re.TensorBuffer(d.filterShape,"float32"),b=d.padInfo.left,x=d.padInfo.top,k=n.data.get(a.dataId).values,w=n.data.get(i.dataId).values,_=new Re.TensorBuffer(a.shape,a.dtype,k),C=new Re.TensorBuffer(i.shape,i.dtype,w),S=0;S<v;++S)for(var A=Math.max(0,Math.ceil((x-S)/h)),E=Math.min(d.outHeight,(d.inHeight+x-S)/h),T=0;T<g;++T)for(var N=Math.max(0,Math.ceil((b-T)/p)),D=Math.min(d.outWidth,(d.inWidth+b-T)/p),F=0;F<d.inChannels;++F)for(var I=0;I<d.outChannels;++I){for(var M=0,O=0;O<d.batchSize;++O)for(var R=A;R<E;++R)for(var Z=S+R*h-x,B=N;B<D;++B){var z=T+B*p-b;M+=m?_.get(O,Z,z,F)*C.get(O,R,B,I):_.get(O,F,Z,z)*C.get(O,I,R,B)}y.set(M,S,T,F,I)}return n.makeTensorInfo(y.shape,y.dtype,y.values)}};var jd={kernelName:Re.Conv2DBackpropInput,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,o=t.filter,u=r.inputShape,s=r.strides,c=r.pad,l=r.dataFormat,f=r.dimRoundingMode;Kl([a,o],"conv2dBackpropInput");var d=Re.util.computeStrides(o.shape),h=Re.util.computeStrides(a.shape),p=Re.backend_util.convertConv2DDataFormat(l),v=Re.backend_util.computeConv2DInfo(u,o.shape,s,1,c,f,!1,p),g=new Re.TensorBuffer(v.inShape,"float32"),m=g.values,y=n.data.get(a.dataId).values,b=n.data.get(o.dataId).values,x=(0,i.Z)(d,3),k=x[0],w=x[1],_=x[2],C=v.batchSize,S=v.filterHeight,A=v.filterWidth,E=v.inChannels,T=v.inHeight,N=v.inWidth,D=v.outChannels,F=v.outHeight,I=v.outWidth,M=v.strideHeight,O=v.strideWidth;p=v.dataFormat;for(var R=S-1-v.padInfo.top,Z=A-1-v.padInfo.left,B="channelsLast"===p,z=g.strides[0],L=B?g.strides[1]:g.strides[2],P=B?g.strides[2]:1,j=B?1:g.strides[1],U=h[0],W=B?h[1]:h[2],V=B?h[2]:1,G=B?1:h[1],q=0;q<C;++q)for(var H=0;H<E;++H)for(var X=0;X<T;++X)for(var Y=X-R,K=Math.max(0,Math.ceil(Y/M)),$=Math.min(F,(S+Y)/M),Q=0;Q<N;++Q){for(var J=Q-Z,ee=Math.max(0,Math.ceil(J/O)),te=Math.min(I,(A+J)/O),ne=0,re=K;re<$;++re)for(var ae=re*M-Y,ie=ee;ie<te;++ie)for(var oe=U*q+W*re+V*ie,ue=k*(S-1-ae)+w*(A-1-(ie*O-J))+_*H,se=0;se<D;++se){ne+=y[oe+G*se]*b[ue+se]}m[z*q+L*X+P*Q+j*H]=ne}return n.makeTensorInfo(g.shape,g.dtype,g.values)}};var Ud={kernelName:Re.Conv3D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,u=r.pad,s=r.dilations;Kl([a,i],"conv3d");for(var c=Re.backend_util.computeConv3DInfo(a.shape,i.shape,o,s,u),l=c.filterDepth,f=c.filterHeight,d=c.filterWidth,h=c.dilationDepth,p=c.dilationHeight,v=c.dilationWidth,g=c.padInfo,m=g.front,y=g.left,b=g.top,x=new Re.TensorBuffer(c.outShape,a.dtype),k=n.data.get(a.dataId).values,w=n.data.get(i.dataId).values,_=x.values,C=Re.util.computeStrides(a.shape),S=Re.util.computeStrides(i.shape),A=0;A<c.batchSize;++A)for(var E=A*C[0],T=A*x.strides[0],N=0;N<c.outDepth;++N)for(var D=T+N*x.strides[1],F=N*c.strideDepth-m,I=0;I<l;++I){var M=F+I*h;if(!(M<0||M>=c.inDepth))for(var O=I*S[0],R=E+M*C[1],Z=0;Z<c.outHeight;++Z)for(var B=D+Z*x.strides[2],z=Z*c.strideHeight-b,L=0;L<f;++L){var P=z+L*p;if(!(P<0||P>=c.inHeight))for(var j=O+L*S[1],U=R+P*C[2],W=0;W<c.outWidth;++W)for(var V=B+W*c.outChannels,G=W*c.strideWidth-y,q=0;q<d;++q){var H=G+q*v;if(!(H<0||H>=c.inWidth))for(var X=j+q*S[2],Y=U+H*c.inChannels,K=X,$=0;$<c.inChannels;++$){for(var Q=k[Y+$],J=0;J<c.outChannels;++J)_[V+J]+=Q*w[K+J];K+=c.outChannels}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}};var Wd={kernelName:Re.Conv3DBackpropFilterV2,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=t.dy,u=r.strides,s=r.pad,c=r.filterShape;Kl([a,o],"conv3dBackpropFilterV2");for(var l=Re.util.computeStrides(a.shape),f=Re.util.computeStrides(o.shape),d=Re.backend_util.computeConv3DInfo(a.shape,c,u,1,s),h=d.strideDepth,p=d.strideHeight,v=d.strideWidth,g=d.filterDepth,m=d.filterHeight,y=d.filterWidth,b=new Re.TensorBuffer(d.filterShape,"float32"),x=b.values,k=(0,i.Z)(b.strides,4),w=k[0],_=k[1],C=k[2],S=k[3],A=n.data.get(o.dataId).values,E=(0,i.Z)(f,4),T=E[0],N=E[1],D=E[2],F=E[3],I=n.data.get(a.dataId).values,M=(0,i.Z)(l,4),O=M[0],R=M[1],Z=M[2],B=M[3],z=d.padInfo.front,L=d.padInfo.left,P=d.padInfo.top,j=0;j<g;++j)for(var U=Math.max(0,Math.ceil((z-j)/h)),W=Math.min(d.outDepth,(d.inDepth+z-j)/h),V=j*w,G=0;G<m;++G)for(var q=Math.max(0,Math.ceil((P-G)/p)),H=Math.min(d.outHeight,(d.inHeight+P-G)/p),X=G*_+V,Y=0;Y<y;++Y)for(var K=Math.max(0,Math.ceil((L-Y)/v)),$=Math.min(d.outWidth,(d.inWidth+L-Y)/v),Q=Y*C+X,J=0;J<d.inChannels;++J)for(var ee=J*S+Q,te=0;te<d.outChannels;++te){for(var ne=0,re=0;re<d.batchSize;++re)for(var ae=re*O,ie=re*T,oe=U;oe<W;++oe)for(var ue=(j+oe*h-z)*R+ae,se=oe*N+ie,ce=q;ce<H;++ce)for(var le=(G+ce*p-P)*Z+ue,fe=ce*D+se,de=K;de<$;++de){var he=de*F+fe;ne+=I[(Y+de*v-L)*B+le+J]*A[he+te]}x[ee+te]=ne}return n.makeTensorInfo(b.shape,b.dtype,b.values)}};var Vd={kernelName:Re.Conv3DBackpropInputV2,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,o=t.filter,u=r.pad,s=r.strides,c=r.inputShape;Kl([a],"conv3dBackpropInputV2");for(var l=Re.util.computeStrides(a.shape),f=Re.util.computeStrides(o.shape),d=Re.backend_util.computeConv3DInfo(c,o.shape,s,1,u),h=new Re.TensorBuffer(d.inShape,"float32"),p=h.values,v=(0,i.Z)(h.strides,4),g=v[0],m=v[1],y=v[2],b=v[3],x=n.data.get(a.dataId).values,k=(0,i.Z)(l,4),w=k[0],_=k[1],C=k[2],S=k[3],A=n.data.get(o.dataId).values,E=(0,i.Z)(f,4),T=E[0],N=E[1],D=E[2],F=E[3],I=d.batchSize,M=d.filterDepth,O=d.filterHeight,R=d.filterWidth,Z=d.inChannels,B=d.inDepth,z=d.inHeight,L=d.inWidth,P=d.outChannels,j=d.outDepth,U=d.outHeight,W=d.outWidth,V=d.strideDepth,G=d.strideHeight,q=d.strideWidth,H=M-1-d.padInfo.front,X=O-1-d.padInfo.top,Y=R-1-d.padInfo.left,K=0;K<I;++K)for(var $=0;$<Z;++$)for(var Q=0;Q<B;++Q)for(var J=Q-H,ee=Math.max(0,Math.ceil(J/V)),te=Math.min(j,(M+J)/V),ne=0;ne<z;++ne)for(var re=ne-X,ae=Math.max(0,Math.ceil(re/G)),ie=Math.min(U,(O+re)/G),oe=0;oe<L;++oe){for(var ue=oe-Y,se=Math.max(0,Math.ceil(ue/q)),ce=Math.min(W,(R+ue)/q),le=0,fe=ee;fe<te;++fe)for(var de=fe*V-J,he=ae;he<ie;++he)for(var pe=he*G-re,ve=se;ve<ce;++ve)for(var ge=w*K+_*fe+C*he+S*ve,me=T*(M-1-de)+N*(O-1-pe)+D*(R-1-(ve*q-ue))+F*$,ye=0;ye<P;++ye){le+=x[ge+ye]*A[me+ye]}p[g*K+m*Q+y*ne+b*oe+$]=le}return n.makeTensorInfo(h.shape,h.dtype,h.values)}},Gd=Jl(Re.Cos,(function(e){return Math.cos(e)})),qd={kernelName:Re.Cos,backendName:"cpu",kernelFunc:Gd},Hd=Jl(Re.Cosh,(function(e){return Math.cosh(e)})),Xd={kernelName:Re.Cosh,backendName:"cpu",kernelFunc:Hd};var Yd={kernelName:Re.CropAndResize,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,o=t.boxes,u=t.boxInd,s=r.cropSize,c=r.method,l=r.extrapolationValue,f=(0,i.Z)(a.shape,4),d=f[0],h=f[1],p=f[2],v=f[3],g=o.shape[0],m=(0,i.Z)(s,2),y=m[0],b=m[1],x=(0,Re.buffer)([g,y,b,v],"float32"),k=n.data.get(o.dataId).values,w=n.data.get(u.dataId).values,_=n.data.get(a.dataId).values,C=Re.util.computeStrides(a.shape),S=Re.util.computeStrides(x.shape),A=0;A<g;A++){var E=4*A,T=k[E],N=k[E+1],D=k[E+2],F=k[E+3],I=w[A];if(!(I>=d))for(var M=y>1?(D-T)*(h-1)/(y-1):0,O=b>1?(F-N)*(p-1)/(b-1):0,R=0;R<y;R++){var Z=y>1?T*(h-1)+R*M:.5*(T+D)*(h-1);if(Z<0||Z>h-1)for(var B=0;B<b;B++)for(var z=0;z<v;z++){var L=z+B*S[2]+R*S[1]+A*S[0];x.values[L]=l}else if("bilinear"===c)for(var P=Math.floor(Z),j=Math.ceil(Z),U=Z-P,W=0;W<b;W++){var V=b>1?N*(p-1)+W*O:.5*(N+F)*(p-1);if(V<0||V>p-1)for(var G=0;G<v;G++){var q=G+W*S[2]+R*S[1]+A*S[0];x.values[q]=l}else for(var H=Math.floor(V),X=Math.ceil(V),Y=V-H,K=0;K<v;K++){var $=K+H*C[2]+P*C[1]+I*C[0],Q=_[$],J=_[$=K+X*C[2]+P*C[1]+I*C[0]],ee=_[$=K+H*C[2]+j*C[1]+I*C[0]],te=Q+(J-Q)*Y,ne=ee+(_[$=K+X*C[2]+j*C[1]+I*C[0]]-ee)*Y;$=K+W*S[2]+R*S[1]+A*S[0],x.values[$]=te+(ne-te)*U}}else for(var re=0;re<b;++re){var ae=b>1?N*(p-1)+re*O:.5*(N+F)*(p-1);if(ae<0||ae>p-1)for(var ie=0;ie<v;ie++){var oe=ie+re*S[2]+R*S[1]+A*S[0];x.values[oe]=l}else for(var ue=Math.round(ae),se=Math.round(Z),ce=0;ce<v;ce++){var le=ce+ue*C[2]+se*C[1]+I*C[0],fe=ce+re*S[2]+R*S[1]+A*S[0];x.values[fe]=_[le]}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}};var Kd={kernelName:Re.Cumprod,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,u=r.reverse;Kl(a,"cumprod");var s=Re.backend_util.getAxesPermutation([i],a.shape.length),c=a;null!=s&&(c=Xf({inputs:{x:a},backend:n,attrs:{perm:s}}));var l=Re.backend_util.getInnerMostAxes(1,a.shape.length)[0];if(l!==c.shape.length-1)throw new Error("backend.cumprod in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(l));for(var f=(0,Re.upcastType)(c.dtype,"int32"),d=Re.util.makeOnesTypedArray(Re.util.sizeFromShape(c.shape),f),h=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],v=u?function(e,t){return e+p-t-1}:function(e,t){return e+t},g=0;g<h.length;g+=p)for(var m=0;m<p;m++){var y=v(g,m);if(0===m)d[y]=o?1:h[y];else{var b=v(g,m-1);d[y]=o?h[b]*d[b]:h[y]*d[b]}}var x=n.makeTensorInfo(c.shape,f,d);if(null!=s){var k=Xf({inputs:{x:x},backend:n,attrs:{perm:Re.backend_util.getUndoAxesPermutation(s)}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(c),k}return x}};var $d={kernelName:Re.Cumsum,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,u=r.reverse;Kl(a,"cumsum");var s=Re.backend_util.getAxesPermutation([i],a.shape.length),c=a;null!=s&&(c=Xf({inputs:{x:a},backend:n,attrs:{perm:s}}));var l=Re.backend_util.getInnerMostAxes(1,a.shape.length)[0];if(l!==c.shape.length-1)throw new Error("backend.cumsum in CPU expects an inner-most "+"axis=".concat(c.shape.length-1," but got axis=").concat(l));for(var f=(0,Re.upcastType)(c.dtype,"int32"),d=Re.util.makeZerosTypedArray(Re.util.sizeFromShape(c.shape),f),h=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],v=u?function(e,t){return e+p-t-1}:function(e,t){return e+t},g=0;g<h.length;g+=p)for(var m=0;m<p;m++){var y=v(g,m);if(0===m)d[y]=o?0:h[y];else{var b=v(g,m-1);d[y]=o?h[b]+d[b]:h[y]+d[b]}}var x=n.makeTensorInfo(c.shape,f,d);if(null!=s){var k=Xf({inputs:{x:x},backend:n,attrs:{perm:Re.backend_util.getUndoAxesPermutation(s)}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(c),k}return x}};var Qd={kernelName:Re.DenseBincount,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,u=r.binaryOutput;if(1===a.shape.length){var s=_d(n.data.get(a.dataId).values,n.data.get(i.dataId).values,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,s)}if(2===a.shape.length){var c=Cd(n.bufferSync(a),n.bufferSync(i),o,u);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}};var Jd={kernelName:Re.DepthToSpace,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat;Re.util.assert("NHWC"===o,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(o)}));for(var u=a.shape[0],s=a.shape[1],c=a.shape[2],l=a.shape[3],f=s*i,d=c*i,h=l/(i*i),p=n.data.get(a.dataId).values,v=new Float32Array(u*f*d*h),g=0,m=0;m<u;++m)for(var y=0;y<f;++y)for(var b=Math.floor(y/i),x=y%i,k=0;k<d;++k)for(var w=Math.floor(k/i),_=(x*i+k%i)*h,C=0;C<h;++C){var S=C+_+l*(w+c*(b+s*m));v[g++]=p[S]}return n.makeTensorInfo([u,f,d,h],a.dtype,v)}};function eh(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,u=r.pad,s=r.dilations,c=r.dimRoundingMode;Kl([a,i],"depthwiseConv2DNative");var l=Re.util.computeStrides(a.shape),f=Re.util.computeStrides(i.shape),d=s;null==d&&(d=[1,1]),Re.util.assert(Re.backend_util.eitherStridesOrDilationsAreOne(o,d),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(d,"'")}));for(var h=Re.backend_util.computeConv2DInfo(a.shape,i.shape,o,d,u,c,!0),p=h.filterHeight,v=h.filterWidth,g=h.dilationHeight,m=h.dilationWidth,y=h.padInfo,b=y.left,x=y.top,k=h.outChannels/h.inChannels,w=new Re.TensorBuffer(h.outShape,a.dtype),_=n.data.get(a.dataId).values,C=n.data.get(i.dataId).values,S=w.values,A=0;A<h.batchSize;++A)for(var E=A*l[0],T=A*w.strides[0],N=0;N<h.outHeight;++N)for(var D=T+N*w.strides[1],F=N*h.strideHeight-x,I=0;I<p;++I){var M=F+I*g;if(!(M<0||M>=h.inHeight))for(var O=I*f[0],R=E+M*l[1],Z=0;Z<h.outWidth;++Z)for(var B=D+Z*w.strides[2],z=Z*h.strideWidth-b,L=0;L<v;++L){var P=z+L*m;if(!(P<0||P>=h.inWidth))for(var j=O+L*f[1],U=R+P*h.inChannels,W=B,V=j,G=0;G<h.inChannels;++G){for(var q=_[U+G],H=0;H<k;++H)S[W+H]+=q*C[V+H];W+=k,V+=k}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}var th={kernelName:Re.DepthwiseConv2dNative,backendName:"cpu",kernelFunc:eh};var nh={kernelName:Re.DepthwiseConv2dNativeBackpropFilter,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,u=r.dilations,s=r.pad,c=r.dimRoundingMode,l=r.filterShape;Kl([a,i],"depthwiseConv2dNativeBackpropFilter");for(var f=Re.backend_util.computeConv2DInfo(a.shape,l,o,u,s,c,!0),d=f.strideHeight,h=f.strideWidth,p=f.filterHeight,v=f.filterWidth,g=new Re.TensorBuffer(f.filterShape,"float32"),m=f.padInfo.left,y=f.padInfo.top,b=f.outChannels/f.inChannels,x=n.data.get(a.dataId).values,k=new Re.TensorBuffer(a.shape,a.dtype,x),w=n.data.get(i.dataId).values,_=new Re.TensorBuffer(i.shape,i.dtype,w),C=0;C<p;++C)for(var S=Math.max(0,Math.ceil((y-C)/d)),A=Math.min(f.outHeight,(f.inHeight+y-C)/d),E=0;E<v;++E)for(var T=Math.max(0,Math.ceil((m-E)/h)),N=Math.min(f.outWidth,(f.inWidth+m-E)/h),D=0;D<f.outChannels;++D){for(var F=Math.trunc(D/b),I=D%b,M=0,O=0;O<f.batchSize;++O)for(var R=S;R<A;++R)for(var Z=C+R*d-y,B=T;B<N;++B){var z=E+B*h-m;M+=k.get(O,Z,z,F)*_.get(O,R,B,D)}g.set(M,C,E,F,I)}return n.makeTensorInfo(g.shape,g.dtype,g.values)}};var rh={kernelName:Re.DepthwiseConv2dNativeBackpropInput,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,o=t.filter,u=r.strides,s=r.dilations,c=r.pad,l=r.dimRoundingMode,f=r.inputShape;Kl([a,o],"depthwiseConv2DNativeBackpropInput");for(var d=Re.util.computeStrides(a.shape),h=Re.util.computeStrides(o.shape),p=Re.backend_util.computeConv2DInfo(f,o.shape,u,s,c,l,!0),v=new Re.TensorBuffer(p.inShape,"float32"),g=v.values,m=(0,i.Z)(v.strides,3),y=m[0],b=m[1],x=m[2],k=n.data.get(a.dataId).values,w=(0,i.Z)(d,3),_=w[0],C=w[1],S=w[2],A=n.data.get(o.dataId).values,E=(0,i.Z)(h,3),T=E[0],N=E[1],D=E[2],F=p.batchSize,I=p.filterHeight,M=p.filterWidth,O=p.inChannels,R=p.inHeight,Z=p.inWidth,B=p.outChannels,z=p.outHeight,L=p.outWidth,P=p.strideHeight,j=p.strideWidth,U=I-1-p.padInfo.top,W=M-1-p.padInfo.left,V=B/O,G=0;G<F;++G)for(var q=0;q<O;++q)for(var H=0;H<R;++H)for(var X=H-U,Y=Math.max(0,Math.ceil(X/P)),K=Math.min(z,(I+X)/P),$=0;$<Z;++$){for(var Q=$-W,J=Math.max(0,Math.ceil(Q/j)),ee=Math.min(L,(M+Q)/j),te=0,ne=Y;ne<K;++ne)for(var re=ne*P-X,ae=J;ae<ee;++ae)for(var ie=_*G+C*ne+S*ae,oe=T*(I-1-re)+N*(M-1-(ae*j-Q))+D*q,ue=0;ue<V;++ue){te+=k[ie+(q*V+ue)]*A[oe+ue]}g[y*G+b*H+x*$+q]=te}return n.makeTensorInfo(v.shape,v.dtype,v.values)}};var ah={kernelName:Re.Diag,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=t.x,a=Re.util.sizeFromShape(r.shape),i=n.data.get(r.dataId).values,u=(0,Re.buffer)([a,a],r.dtype),s=u.values,c=0;c<i.length;c++)s[c*a+c]=i[c];var l=[].concat((0,o.Z)(r.shape),(0,o.Z)(r.shape));return n.makeTensorInfo(l,u.dtype,u.values)}},ih={kernelName:Re.Dilation2D,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,u=r.pad,s=r.dilations,c=n,l=c.data.get(a.dataId).values,f=a.shape.length,d=c.data.get(i.dataId).values,h=i.shape.length,p=Re.backend_util.computeDilation2DInfo(a.shape,i.shape,o,u,"NHWC",s),v=p.batchSize,g=p.inHeight,m=p.inWidth,y=p.inChannels,b=p.outHeight,x=p.outWidth,k=p.padInfo,w=p.strideHeight,_=p.strideWidth,C=p.filterHeight,S=p.filterWidth,A=p.dilationHeight,E=p.dilationWidth,T=p.outShape,N=Re.util.sizeFromShape(T),D=T.length,F=Re.util.getArrayFromDType(a.dtype,N),I=0;I<v;++I)for(var M=0;M<b;++M)for(var O=M*w-k.top,R=0;R<x;++R)for(var Z=R*_-k.left,B=0;B<y;++B){for(var z=Number.MIN_SAFE_INTEGER,L=0;L<C;++L){var P=O+L*A;if(P>=0&&P<g)for(var j=0;j<S;++j){var U=Z+j*E;if(U>=0&&U<m){var W=Re.util.locToIndex([I,P,U,B],f,Re.util.computeStrides(a.shape)),V=Re.util.locToIndex([L,j,B],h,Re.util.computeStrides(i.shape)),G=l[W]+d[V];G>z&&(z=G)}}}F[Re.util.locToIndex([I,M,R,B],D,Re.util.computeStrides(T))]=z}return{dataId:c.write(Re.util.toTypedArray(F,a.dtype),T,a.dtype),shape:T,dtype:a.dtype}}},oh={kernelName:Re.Dilation2DBackpropFilter,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,u=r.strides,s=r.pad,c=r.dilations,l=n,f=Re.util.toNestedArray(a.shape,l.data.get(a.dataId).values),d=Re.util.toNestedArray(i.shape,l.data.get(i.dataId).values),h=Re.backend_util.computeDilation2DInfo(a.shape,i.shape,u,s,"NHWC",c),p=h.batchSize,v=h.inHeight,g=h.inWidth,m=h.inChannels,y=h.outHeight,b=h.outWidth,x=h.padInfo,k=h.strideHeight,w=h.strideWidth,_=h.filterHeight,C=h.filterWidth,S=h.dilationHeight,A=h.dilationWidth,E=h.outShape;Re.util.assert(o.rank===E.length,(function(){return"Error in ".concat(Re.Dilation2DBackpropFilter,", dy ")+"must have the same rank as output ".concat(E.length,", but got ")+"".concat(o.rank)}));for(var T=Re.util.toNestedArray(E,l.data.get(o.dataId).values),N=Re.util.makeZerosNestedTypedArray(i.shape,i.dtype),D=0;D<p;++D)for(var F=0;F<y;++F)for(var I=F*k-x.top,M=0;M<b;++M)for(var O=M*w-x.left,R=0;R<m;++R){for(var Z=Number.MIN_SAFE_INTEGER,B=0,z=0,L=0;L<_;++L){var P=I+L*S;if(P>=0&&P<v)for(var j=0;j<C;++j){var U=O+j*A;if(U>=0&&U<g){var W=f[D][P][U][R]+d[L][j][R];W>Z&&(Z=W,B=L,z=j)}}}N[B][z][R]+=T[D][F][M][R]}return{dataId:l.write(Re.util.toTypedArray(N,a.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},uh={kernelName:Re.Dilation2DBackpropInput,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,u=r.strides,s=r.pad,c=r.dilations,l=n,f=Re.util.toNestedArray(a.shape,l.data.get(a.dataId).values),d=Re.util.toNestedArray(i.shape,l.data.get(i.dataId).values),h=Re.backend_util.computeDilation2DInfo(a.shape,i.shape,u,s,"NHWC",c),p=h.batchSize,v=h.inHeight,g=h.inWidth,m=h.inChannels,y=h.outHeight,b=h.outWidth,x=h.padInfo,k=h.strideHeight,w=h.strideWidth,_=h.filterHeight,C=h.filterWidth,S=h.dilationHeight,A=h.dilationWidth,E=h.outShape;Re.util.assert(o.rank===E.length,(function(){return"Error in ".concat(Re.Dilation2DBackpropInput,", dy ")+"must have the same rank as output ".concat(E.length,", but got ")+"".concat(o.rank)}));for(var T=Re.util.toNestedArray(E,l.data.get(o.dataId).values),N=Re.util.makeZerosNestedTypedArray(a.shape,a.dtype),D=0;D<p;++D)for(var F=0;F<y;++F)for(var I=F*k-x.top,M=0;M<b;++M)for(var O=M*w-x.left,R=0;R<m;++R){for(var Z=Number.MIN_SAFE_INTEGER,B=I<0?0:I,z=O<0?0:O,L=0;L<_;++L){var P=I+L*S;if(P>=0&&P<v)for(var j=0;j<C;++j){var U=O+j*A;if(U>=0&&U<g){var W=f[D][P][U][R]+d[L][j][R];W>Z&&(Z=W,B=P,z=U)}}}N[D][B][z][R]+=T[D][F][M][R]}return{dataId:l.write(Re.util.toTypedArray(N,a.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},sh=sf((function(e,t){return e*t})),ch=Df((function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})),lh=Nf(Re.Multiply,sh,ch),fh={kernelName:Re.Multiply,backendName:"cpu",kernelFunc:lh};function dh(e){var t,n=e.inputs,r=e.backend,a=e.attrs,o=n.x,u=a.axis,s=a.keepDims;Kl(o,"sum");var c=(t="bool"===o.dtype?Ef({inputs:{x:o},backend:r,attrs:{dtype:"int32"}}):rf({inputs:{x:o},backend:r})).shape.length,l=Re.util.parseAxisParam(u,t.shape),f=Re.backend_util.getAxesPermutation(l,c),d=l,h=t;null!=f&&(h=Xf({inputs:{x:t},backend:r,attrs:{perm:f}}),d=Re.backend_util.getInnerMostAxes(d.length,c)),Re.backend_util.assertAxesAreInnerMostDims("sum",d,h.shape.length);for(var p=Re.backend_util.computeOutAndReduceShapes(h.shape,d),v=(0,i.Z)(p,2),g=v[0],m=v[1],y=_f(r,g,Re.backend_util.upcastType(h.dtype,"int32")),b=Re.util.sizeFromShape(m),x=r.data.get(y.dataId).values,k=r.data.get(h.dataId).values,w=0;w<x.length;++w){for(var _=w*b,C=0,S=0;S<b;++S)C+=k[_+S];x[w]=C}if(s){var A=y;y=Rf({inputs:{x:y},backend:r,attrs:{shape:Re.backend_util.expandShapeToKeepDim(y.shape,l)}}),r.disposeIntermediateTensorInfo(A)}return r.disposeIntermediateTensorInfo(t),null!=f&&r.disposeIntermediateTensorInfo(h),y}var hh={kernelName:Re.Sum,backendName:"cpu",kernelFunc:dh};var ph={kernelName:Re.Einsum,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.equation,a=t,i=Re.backend_util.decodeEinsumEquation(r,a.length),o=i.allDims,u=i.summedDims,s=i.idDims;Re.backend_util.checkEinsumDimSizes(o.length,s,a);for(var c=Re.backend_util.getEinsumComputePath(u,s),l=c.path,f=c.steps,d=f.length,p=null,v=o.length,g=[],m=0;m<d;++m){var y,b=(0,h.Z)(f[m]);try{for(b.s();!(y=b.n()).done;){var x=y.value,k=Re.backend_util.getEinsumPermutation(v,s[x]),w=k.permutationIndices,_=k.expandDims,C=void 0;Re.backend_util.isIdentityPermutation(w)?C=a[x]:(C=Xf({inputs:{x:a[x]},backend:n,attrs:{perm:w}}),g.push(C));for(var S=C.shape.slice(),A=0;A<_.length;++A)S.splice(_[A],0,1);Re.util.arraysEqual(C.shape,S)||(C=Rf({inputs:{x:C},backend:n,attrs:{shape:S}}),g.push(C)),null===p?p=C:(p=lh({inputs:{a:C,b:p},backend:n}),g.push(p))}}catch(D){b.e(D)}finally{b.f()}m<d-1&&(l[m]>=0&&(p=dh({inputs:{x:p},backend:n,attrs:{axis:l[m]-(o.length-v),keepDims:!1}}),g.push(p)),v--)}for(var E=0,T=g;E<T.length;E++){var N=T[E];N!==p&&n.disposeIntermediateTensorInfo(N)}return p}};var vh={kernelName:Re.EluGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y;Kl([r,a],"eluGrad");for(var i=new Float32Array(Re.util.sizeFromShape(a.shape)),o=n.data.get(a.dataId).values,u=n.data.get(r.dataId).values,s=0;s<o.length;++s){var c=o[s];i[s]=c>=1?u[s]:u[s]*(c+1)}return n.makeTensorInfo(a.shape,"float32",i)}},gh=sf((function(e,t){return e===t?1:0})),mh=Nf(Re.Equal,gh,null,"bool"),yh={kernelName:Re.Equal,backendName:"cpu",kernelFunc:mh},bh=Re.backend_util.ERF_P,xh=Re.backend_util.ERF_A1,kh=Re.backend_util.ERF_A2,wh=Re.backend_util.ERF_A3,_h=Re.backend_util.ERF_A4,Ch=Re.backend_util.ERF_A5,Sh=Jl(Re.Erf,(function(e){var t=Math.sign(e),n=Math.abs(e),r=1/(1+bh*n);return t*(1-((((Ch*r+_h)*r+wh)*r+kh)*r+xh)*r*Math.exp(-n*n))})),Ah={kernelName:Re.Erf,backendName:"cpu",kernelFunc:Sh},Eh=gf((function(e){return Math.exp(e)})),Th=ef(Re.Exp,Eh,"float32"),Nh={kernelName:Re.Exp,backendName:"cpu",kernelFunc:Th};function Dh(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.input,i=r.dim,o=a.shape.length,u=a.shape.slice(),s=i;return i<0&&(Re.util.assert(-(o+1)<=i,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),s=o+i+1),u.splice(s,0,1),Rf({inputs:{x:a},backend:n,attrs:{shape:u}})}var Fh={kernelName:Re.ExpandDims,backendName:"cpu",kernelFunc:Dh},Ih=gf((function(e){return Math.expm1(e)})),Mh=ef(Re.Expm1,Ih),Oh={kernelName:Re.Expm1,backendName:"cpu",kernelFunc:Mh},Rh=sf((function(e,t){return e/t})),Zh=Nf(Re.RealDiv,Rh),Bh={kernelName:Re.RealDiv,backendName:"cpu",kernelFunc:Zh},zh=sf((function(e,t){return e-t})),Lh=Df((function(e,t,n,r){return{real:e-n,imag:t-r}})),Ph=Nf(Re.Sub,zh,Lh),jh={kernelName:Re.Sub,backendName:"cpu",kernelFunc:Ph};function Uh(e,t,n){for(var r=e.shape,a=r[0],i=r[1],o=n.data.get(e.dataId),u=o.complexTensorInfos.real,s=o.complexTensorInfos.imag,c=[a,i],l=Re.util.sizeFromShape(c),f=Re.util.getTypedArrayFromDType("float32",l),d=Re.util.getTypedArrayFromDType("float32",l),h=0;h<a;h++){for(var p=xd({inputs:{x:u},backend:n,attrs:{begin:[h,0],size:[1,i]}}),v=xd({inputs:{x:s},backend:n,attrs:{begin:[h,0],size:[1,i]}}),g=kf({inputs:{real:p,imag:v},backend:n}),m=Wh(g,t,n),y=m.real,b=m.imag,x=Re.backend_util.mergeRealAndImagArrays(y,b),k=0;k<i;k++){var w=Re.backend_util.getComplexWithIndex(x,k);f[h*i+k]=w.real,d[h*i+k]=w.imag}n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g)}var _=n.makeTensorInfo(c,"float32",f),C=n.makeTensorInfo(c,"float32",d),S=kf({inputs:{real:_,imag:C},backend:n});return n.disposeIntermediateTensorInfo(_),n.disposeIntermediateTensorInfo(C),S}function Wh(e,t,n){var r=Re.util.sizeFromShape(e.shape),a=n.data.get(e.dataId),i=n.data.get(a.complexTensorInfos.real.dataId).values,o=n.data.get(a.complexTensorInfos.imag.dataId).values;if(0===((m=r)&m-1)){var u=Vh(i,o,r,t,n),s=[e.shape[0],e.shape[1]];if(t){var c=n.makeTensorInfo(s,"float32",u.real),l=n.makeTensorInfo(s,"float32",u.imag),f=n.makeTensorInfo([],"float32",Re.util.createScalarValue(r,"float32")),d=rf({inputs:{x:f},backend:n}),h=Bh.kernelFunc({inputs:{a:c,b:f},backend:n}),p=Bh.kernelFunc({inputs:{a:l,b:d},backend:n}),v=n.data.get(h.dataId).values,g=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),{real:v,imag:g}}return u}var m,y=function(e,t,n){for(var r=new Float32Array(2*t),a=0;a<t;a++){for(var i=0,o=0,u=0;u<t;u++){var s=Re.backend_util.exponent(a*u,t,n),c=Re.backend_util.getComplexWithIndex(e,u);i+=c.real*s.real-c.imag*s.imag,o+=c.real*s.imag+c.imag*s.real}n&&(i/=t,o/=t),Re.backend_util.assignToTypedArray(r,i,o,a)}return r}(Re.backend_util.mergeRealAndImagArrays(i,o),r,t);return Re.backend_util.splitRealAndImagArrays(y)}function Vh(e,t,n,r,a){if(1===n)return{real:e,imag:t};var i=Re.backend_util.mergeRealAndImagArrays(e,t),o=n/2,u=Re.backend_util.complexWithEvenIndex(i),s=u.real,c=u.imag,l=[s.length],f=a.makeTensorInfo(l,"float32",s),d=a.makeTensorInfo(l,"float32",c),h=kf({inputs:{real:f,imag:d},backend:a}),p=Re.backend_util.complexWithOddIndex(i),v=p.real,g=p.imag,m=[v.length],y=a.makeTensorInfo(m,"float32",v),b=a.makeTensorInfo(m,"float32",g),x=kf({inputs:{real:y,imag:b},backend:a}),k=Vh(s,c,o,r,a),w=k.real,_=k.imag,C=[w.length],S=a.makeTensorInfo(C,"float32",w),A=a.makeTensorInfo(C,"float32",_),E=kf({inputs:{real:S,imag:A},backend:a}),T=Vh(v,g,o,r,a),N=T.real,D=T.imag,F=[N.length],I=a.makeTensorInfo(F,"float32",N),M=a.makeTensorInfo(F,"float32",D),O=kf({inputs:{real:I,imag:M},backend:a}),R=Re.backend_util.exponents(n,r),Z=[R.real.length],B=a.makeTensorInfo(Z,"float32",R.real),z=a.makeTensorInfo(Z,"float32",R.imag),L=kf({inputs:{real:B,imag:z},backend:a}),P=lh({inputs:{a:L,b:O},backend:a}),j=Mf({inputs:{a:E,b:P},backend:a}),U=Ph({inputs:{a:E,b:P},backend:a}),W=Cf({inputs:{input:j},backend:a}),V=Cf({inputs:{input:U},backend:a}),G=Od({inputs:{input:j},backend:a}),q=Od({inputs:{input:U},backend:a}),H=Zd({inputs:[W,V],backend:a,attrs:{axis:0}}),X=Zd({inputs:[G,q],backend:a,attrs:{axis:0}}),Y=a.data.get(H.dataId).values,K=a.data.get(X.dataId).values;return a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(d),a.disposeIntermediateTensorInfo(h),a.disposeIntermediateTensorInfo(y),a.disposeIntermediateTensorInfo(b),a.disposeIntermediateTensorInfo(x),a.disposeIntermediateTensorInfo(S),a.disposeIntermediateTensorInfo(A),a.disposeIntermediateTensorInfo(E),a.disposeIntermediateTensorInfo(I),a.disposeIntermediateTensorInfo(M),a.disposeIntermediateTensorInfo(O),a.disposeIntermediateTensorInfo(B),a.disposeIntermediateTensorInfo(z),a.disposeIntermediateTensorInfo(L),a.disposeIntermediateTensorInfo(P),a.disposeIntermediateTensorInfo(j),a.disposeIntermediateTensorInfo(U),a.disposeIntermediateTensorInfo(W),a.disposeIntermediateTensorInfo(G),a.disposeIntermediateTensorInfo(V),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(X),{real:Y,imag:K}}var Gh={kernelName:Re.FFT,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=Re.util.sizeFromShape(r.shape),i=r.shape[r.shape.length-1],o=Rf({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),u=Uh(o,!1,n),s=Rf({inputs:{x:u},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),s}};function qh(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype||Re.util.inferDtype(a),o=Re.util.getArrayFromDType(i,Re.util.sizeFromShape(r));return function(e,t,n){e.fill(t)}(o,a),t.makeTensorInfo(r,i,o)}var Hh={kernelName:Re.Fill,backendName:"cpu",kernelFunc:qh};var Xh={kernelName:Re.FlipLeftRight,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=(e.attrs,e.backend),r=t.image,a=n,o=Re.util.getTypedArrayFromDType(r.dtype,Re.util.sizeFromShape(r.shape)),u=(0,i.Z)(r.shape,4),s=u[0],c=u[1],l=u[2],f=u[3],d=a.data.get(r.dataId).values,h=0;h<s;h++)for(var p=h*l*c*f,v=0;v<c;v++)for(var g=v*(l*f),m=0;m<l;m++)for(var y=m*f,b=0;b<f;b++){var x=Math.round(l-m-1),k=p+g+y+b,w=d[k];if(x>=0&&x<l)w=d[p+g+x*f+b];o[k]=w}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},Yh=gf((function(e){return Math.floor(e)})),Kh=ef(Re.Floor,Yh),$h={kernelName:Re.Floor,backendName:"cpu",kernelFunc:Kh},Qh=sf((function(e,t){return Math.floor(e/t)})),Jh=Nf(Re.FloorDiv,Qh,null,"int32"),ep={kernelName:Re.FloorDiv,backendName:"cpu",kernelFunc:Jh};var tp={kernelName:Re.FusedConv2D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,u=t.preluActivationWeights,s=r.strides,c=r.pad,l=r.dataFormat,f=r.dilations,d=r.dimRoundingMode,h=r.activation,p=r.leakyreluAlpha,v=zd({inputs:{x:a,filter:i},backend:n,attrs:{strides:s,pad:c,dataFormat:l,dilations:f,dimRoundingMode:d}});if(o){var g=v;if("NCHW"===l&&1===o.shape.length&&1!==o.shape[0]){var m=Rf({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});v=Mf({inputs:{a:v,b:m},backend:n}),n.disposeIntermediateTensorInfo(m)}else v=Mf({inputs:{a:v,b:o},backend:n});n.disposeIntermediateTensorInfo(g)}if(h){var y=v;if("NCHW"===l&&"prelu"===h&&1===u.shape.length&&1!==u.shape[0]){var b=Rf({inputs:{x:u},backend:n,attrs:{shape:[u.shape[0],1,1]}});v=xf(n,v,h,b,p),n.disposeIntermediateTensorInfo(b)}else v=xf(n,v,h,u,p);n.disposeIntermediateTensorInfo(y)}return v}};var np={kernelName:Re.FusedDepthwiseConv2D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,u=t.preluActivationWeights,s=r.strides,c=r.pad,l=r.dataFormat,f=r.dilations,d=r.dimRoundingMode,h=r.activation,p=r.leakyreluAlpha,v=eh({inputs:{x:a,filter:i},backend:n,attrs:{strides:s,pad:c,dataFormat:l,dilations:f,dimRoundingMode:d}});if(o){var g=v;v=Mf({inputs:{a:v,b:o},backend:n}),n.disposeIntermediateTensorInfo(g)}if(h){var m=v;v=xf(n,v,h,u,p),n.disposeIntermediateTensorInfo(m)}return v}};function rp(e,t,n,r,a,i,u,s,c){for(var l=(0,Re.buffer)([r,i],n),f=0;f<r;f++){for(var d=[],h=0,p=0;p<a;p++){var v=e[f*a+p];h+=v*u[p],d.push(v)}if(h<0||h>=c/i)throw new Error("Invalid indices: ".concat(d," does not index into ").concat(s));for(var g=0;g<i;g++)l.values[f*i+g]=t.get.apply(t,(0,o.Z)(t.indexToLoc(h*i+g)))}return l}var ap={kernelName:Re.GatherNd,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,o=Re.util.sizeFromShape(r.shape),u=a.shape,s=u[u.length-1],c=Re.backend_util.prepareAndValidate(r,a),l=(0,i.Z)(c,4),f=l[0],d=l[1],h=l[2],p=l[3];if(0===d)return n.makeTensorInfo(f,r.dtype,[]);var v=rp(n.data.get(a.dataId).values,n.bufferSync(r),r.dtype,d,s,h,p,r.shape,o);return n.makeTensorInfo(f,r.dtype,v.values)}};function ip(e,t,n){for(var r=(0,Re.buffer)(n,e.dtype),a=0;a<r.size;++a){var i=r.indexToLoc(a).slice(),o=i[0],u=i[2],s=t.locToIndex([o,u]);i[2]=t.values[s];var c=e.locToIndex(i);0<=c&&c<e.values.length&&(r.values[a]=e.values[c])}return r}var op={kernelName:Re.GatherV2,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,u=r.batchDims;Kl([a,i],"gatherV2");for(var s=Re.util.parseAxisParam(o,a.shape)[0],c=n.data.get(i.dataId).values,l=a.shape[s],f=function(){var e=c[d];Re.util.assert(e<=l-1&&e>=0,(function(){return"GatherV2: the index value ".concat(e," is not in [0, ").concat(l-1,"]")}))},d=0;d<c.length;++d)f();var h=u;null==u&&(h=0);var p=Re.util.sizeFromShape(i.shape),v=Re.backend_util.segment_util.collectGatherOpShapeInfo(a,i,s,h),g=Rf({inputs:{x:a},backend:n,attrs:{shape:[v.batchSize,v.outerSize,v.dimSize,v.sliceSize]}}),m=Rf({inputs:{x:i},backend:n,attrs:{shape:[v.batchSize,p/v.batchSize]}}),y=[v.batchSize,v.outerSize,p/v.batchSize,v.sliceSize],b=n.bufferSync(m),x=ip(n.bufferSync(g),b,y);return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(v.outputShape,x.dtype,x.values)}},up=sf((function(e,t){return e>t?1:0})),sp=Nf(Re.Greater,up,null,"bool"),cp={kernelName:Re.Greater,backendName:"cpu",kernelFunc:sp},lp=sf((function(e,t){return e>=t?1:0})),fp=Nf(Re.GreaterEqual,lp,null,"bool"),dp={kernelName:Re.GreaterEqual,backendName:"cpu",kernelFunc:fp};var hp={kernelName:Re.IFFT,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.input,a=Re.util.sizeFromShape(r.shape),i=r.shape[r.shape.length-1],o=Rf({inputs:{x:r},backend:n,attrs:{shape:[a/i,i]}}),u=Uh(o,!0,n),s=Rf({inputs:{x:u},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),s}},pp=Jl(Re.IsFinite,(function(e){return Number.isFinite(e)?1:0}),"bool"),vp={kernelName:Re.IsFinite,backendName:"cpu",kernelFunc:pp},gp=Jl(Re.IsInf,(function(e){return Math.abs(e)===1/0?1:0}),"bool"),mp={kernelName:Re.IsInf,backendName:"cpu",kernelFunc:gp},yp=Jl(Re.IsNan,(function(e){return Number.isNaN(e)?1:0}),"bool"),bp={kernelName:Re.IsNan,backendName:"cpu",kernelFunc:yp},xp=sf((function(e,t){return e<t?1:0})),kp=Nf(Re.Less,xp,null,"bool"),wp={kernelName:Re.Less,backendName:"cpu",kernelFunc:kp},_p=sf((function(e,t){return e<=t?1:0})),Cp=Nf(Re.LessEqual,_p,null,"bool"),Sp={kernelName:Re.LessEqual,backendName:"cpu",kernelFunc:Cp};function Ap(e,t,n){var r=(t-e)/(n-1),a=Re.util.makeZerosTypedArray(n,"float32");a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}var Ep={kernelName:Re.LinSpace,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=Ap(n.start,n.stop,n.num);return t.makeTensorInfo([r.length],"float32",r)}},Tp=gf((function(e){return Math.log(e)})),Np=ef(Re.Log,Tp),Dp={kernelName:Re.Log,backendName:"cpu",kernelFunc:Np},Fp=Jl(Re.Log1p,(function(e){return Math.log1p(e)})),Ip={kernelName:Re.Log1p,backendName:"cpu",kernelFunc:Fp},Mp=sf((function(e,t){return e&&t})),Op=Nf(Re.LogicalAnd,Mp,null,"bool"),Rp={kernelName:Re.LogicalAnd,backendName:"cpu",kernelFunc:Op},Zp=Jl(Re.LogicalNot,(function(e){return e?0:1}),"bool"),Bp={kernelName:Re.LogicalNot,backendName:"cpu",kernelFunc:Zp},zp=sf((function(e,t){return e||t})),Lp=Nf(Re.LogicalOr,zp,null,"bool"),Pp={kernelName:Re.LogicalOr,backendName:"cpu",kernelFunc:Lp};var jp={kernelName:Re.LRN,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,o=r.bias,u=r.alpha,s=r.beta;Kl(a,"LRN");var c=a.shape[3],l=c-1,f=n.data.get(a.dataId).values,d=Re.util.sizeFromShape(a.shape),h=new Float32Array(d);function p(e){for(var t=e%c,n=e-t+Math.max(0,t-i),r=e-t+Math.min(t+i,l),a=0;n<=r;n++){var o=f[n];a+=o*o}return a}for(var v=0;v<d;v++){var g=p(v),m=f[v]*Math.pow(o+u*g,-s);h[v]=m}return n.makeTensorInfo(a.shape,a.dtype,h)}};var Up={kernelName:Re.LRNGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,u=r.depthRadius,s=r.bias,c=r.alpha,l=r.beta;Kl(o,"LRNGrad");for(var f=Re.util.sizeFromShape(o.shape),d=o.shape[3],h=n.data.get(o.dataId).values,p=n.data.get(a.dataId).values,v=n.data.get(i.dataId).values,g=new Float32Array(f),m=f,y=0;y<m;y++){for(var b=y%d,x=y-b+Math.max(0,b-u),k=y-b+Math.min(d,b+u+1),w=0,_=x;_<k;_++)w+=Math.pow(p[_],2);w=c*w+s;for(var C=x;C<k;C++){var S=-2*c*l*p[C]*v[y]/w;y===C&&(S+=Math.pow(w,-l)),S*=h[y],g[C]+=S}}return n.makeTensorInfo(o.shape,a.dtype,g)}};function Wp(e,t,n,r){for(var a=Re.util.getTypedArrayFromDType(r,Re.util.sizeFromShape(n)),i=0;i<a.length;++i){for(var o=i*t,u=e[o],s=0;s<t;++s){var c=e[o+s];(Number.isNaN(c)||c>u)&&(u=c)}a[i]=u}return a}function Vp(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.reductionIndices,u=r.keepDims,s=n,c=a.shape,l=c.length,f=Re.util.parseAxisParam(o,c),d=f,h=Re.backend_util.getAxesPermutation(d,l),p=s.data.get(a.dataId).values;if(null!=h){for(var v=new Array(l),g=0;g<v.length;g++)v[g]=c[h[g]];p=Hf(p,c,a.dtype,h,v),d=Re.backend_util.getInnerMostAxes(d.length,l),c=v}Kl(a,"max"),Re.backend_util.assertAxesAreInnerMostDims("max",d,l);var m=Re.backend_util.computeOutAndReduceShapes(c,d),y=(0,i.Z)(m,2),b=y[0],x=y[1],k=Wp(p,Re.util.sizeFromShape(x),b,a.dtype),w=s.write(k,b,a.dtype),_=b;u&&(_=Re.backend_util.expandShapeToKeepDim(b,f));return{dataId:w,shape:_,dtype:a.dtype}}var Gp={kernelName:Re.Max,backendName:"cpu",kernelFunc:Vp},qp=sf((function(e,t){return Math.max(e,t)})),Hp=Nf(Re.Maximum,qp),Xp={kernelName:Re.Maximum,backendName:"cpu",kernelFunc:Hp};var Yp={kernelName:Re.MaxPool,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;Kl(a,"maxPool");var i=r.filterSize,o=r.strides,u=r.pad,s=r.dimRoundingMode;Re.util.assert(Re.backend_util.eitherStridesOrDilationsAreOne(o,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c,l=Re.backend_util.computePool2DInfo(a.shape,i,o,1,u,s);if(1===l.filterWidth&&1===l.filterHeight&&Re.util.arraysEqual(l.inShape,l.outShape))c=rf({inputs:{x:a},backend:n});else{var f=n.data.get(a.dataId).values,d=Re.util.computeStrides(a.shape),h=fd(f,a.shape,a.dtype,d,l,"max");c=n.makeTensorInfo(l.outShape,a.dtype,h.values)}return c}};var Kp={kernelName:Re.MaxPool3D,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,u=r.pad,s=r.dimRoundingMode,c=r.dataFormat;Kl(a,"maxPool3d");var l=Re.backend_util.computePool3DInfo(a.shape,i,o,1,u,s,c),f=hd(n.data.get(a.dataId).values,a.shape,a.dtype,Re.util.computeStrides(a.shape),l,"max");return n.makeTensorInfo(f.shape,"float32",f.values)}};var $p={kernelName:Re.MaxPool3DGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,u=r.strides,s=r.pad,c=r.dimRoundingMode;Kl([a,i],"maxPool3DGrad");for(var l=Re.backend_util.computePool3DInfo(i.shape,o,u,1,s,c),f=function(e,t){for(var n=(0,Re.buffer)(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,u=t.dilationHeight,s=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.front,h=t.padInfo.top,p=t.padInfo.left,v=0;v<t.batchSize;++v)for(var g=0;g<t.inChannels;++g)for(var m=0;m<t.outDepth;++m){for(var y=m*r-d,b=y;b<0;)b+=o;for(var x=Math.min(t.inDepth,c+y),k=0;k<t.outHeight;++k){for(var w=k*a-h,_=w;_<0;)_+=u;for(var C=Math.min(t.inHeight,l+w),S=0;S<t.outWidth;++S){for(var A=S*i-p,E=A;E<0;)E+=s;for(var T=Math.min(t.inWidth,f+A),N=Number.NEGATIVE_INFINITY,D=-1,F=b;F<x;F+=o)for(var I=F-y,M=_;M<C;M+=u)for(var O=M-w,R=E;R<T;R+=s){var Z=R-A,B=e.get(v,F,M,R,g);B>=N&&(N=B,D=I*l*f+O*l+Z)}n.set(D,v,m,k,S,g)}}}return n}(n.bufferSync(i),l),d=l.strideDepth,h=l.strideHeight,p=l.strideWidth,v=l.dilationDepth,g=l.dilationHeight,m=l.dilationWidth,y=l.effectiveFilterDepth,b=l.effectiveFilterHeight,x=l.effectiveFilterWidth,k=y-1-l.padInfo.front,w=x-1-l.padInfo.left,_=b-1-l.padInfo.top,C=(0,Re.buffer)(i.shape,"float32"),S=n.bufferSync(a),A=0;A<l.batchSize;++A)for(var E=0;E<l.inChannels;++E)for(var T=0;T<l.inDepth;++T)for(var N=0;N<l.inHeight;++N)for(var D=0;D<l.inWidth;++D){for(var F=T-k,I=N-_,M=D-w,O=0,R=0;R<y;R+=v){var Z=(F+R)/d;if(!(Z<0||Z>=l.outDepth||Math.floor(Z)!==Z))for(var B=0;B<b;B+=g){var z=(I+B)/h;if(!(z<0||z>=l.outHeight||Math.floor(z)!==z))for(var L=0;L<x;L+=m){var P=(M+L)/p;if(!(P<0||P>=l.outWidth||Math.floor(P)!==P)){var j=y*b*x-1-f.get(A,Z,z,P,E)===R*b*x+B*x+L?1:0;if(0!==j)O+=S.get(A,Z,z,P,E)*j}}}}C.set(O,A,T,N,D,E)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}};var Qp={kernelName:Re.MaxPoolGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;Kl([i,t.output],"maxPoolGrad");for(var u=r.filterSize,s=r.strides,c=r.pad,l=r.dimRoundingMode,f=Re.backend_util.computePool2DInfo(o.shape,u,s,1,c,l),d=n.data.get(o.dataId).values,h=(0,Re.buffer)(f.outShape,o.dtype,dd(d,o.shape,o.dtype,f).values),p=f.strideHeight,v=f.strideWidth,g=f.dilationHeight,m=f.dilationWidth,y=f.effectiveFilterHeight,b=f.effectiveFilterWidth,x=b-1-f.padInfo.left,k=y-1-f.padInfo.top,w=(0,Re.buffer)(o.shape,"float32"),_=n.data.get(a.dataId).values,C=(0,Re.buffer)(a.shape,"float32",_),S=0;S<f.batchSize;++S)for(var A=0;A<f.inChannels;++A)for(var E=0;E<f.inHeight;++E)for(var T=0;T<f.inWidth;++T){for(var N=E-k,D=T-x,F=0,I=0;I<y;I+=g){var M=(N+I)/p;if(!(M<0||M>=f.outHeight||Math.floor(M)!==M))for(var O=0;O<b;O+=m){var R=(D+O)/v;if(!(R<0||R>=f.outWidth||Math.floor(R)!==R)){var Z=y*b-1-h.get(S,M,R,A)===I*b+O?1:0;if(0!==Z)F+=C.get(S,M,R,A)*Z}}}w.set(F,S,E,T,A)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}};var Jp={kernelName:Re.MaxPoolWithArgmax,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,o=n.filterSize,u=n.strides,s=n.pad,c=n.includeBatchInIndex,l=r;Kl(a,"MaxPoolWithArgmax");var f=l.data.get(a.dataId).values,d=Re.backend_util.computePool2DInfo(a.shape,o,u,[1,1],s),h=function(e,t,n,r,a){var i=fd(e,0,n,Re.util.computeStrides(t),a,"max"),o=dd(e,t,n,a,!0,r);return[i.values,o.values]}(f,a.shape,a.dtype,c,d),p=(0,i.Z)(h,2),v=p[0],g=p[1],m=l.write(v,d.outShape,a.dtype),y=l.write(g,d.outShape,a.dtype);return[{dataId:m,shape:d.outShape,dtype:a.dtype},{dataId:y,shape:d.outShape,dtype:"int32"}]}};var ev={kernelName:Re.Mean,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims,u=Re.util.parseAxisParam(i,a.shape),s=Re.backend_util.computeOutAndReduceShapes(a.shape,u)[1],c=Re.util.sizeFromShape(s),l=[],f=n.makeTensorInfo([],"float32",new Float32Array([c]));l.push(f);var d=Ef({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});l.push(d);var h=Zh({inputs:{a:d,b:f},backend:n});l.push(h);var p=dh({inputs:{x:h},backend:n,attrs:{axis:i,keepDims:o}});return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),p}};var tv={kernelName:Re.Min,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.axis,u=r.keepDims;Kl(a,"min");var s=Re.util.parseAxisParam(o,a.shape),c=s,l=Re.backend_util.getAxesPermutation(c,a.shape.length),f=a;null!=l&&(f=Xf({inputs:{x:a},backend:n,attrs:{perm:l}}),c=Re.backend_util.getInnerMostAxes(c.length,a.shape.length)),Re.backend_util.assertAxesAreInnerMostDims("min",c,f.shape.length);for(var d=Re.backend_util.computeOutAndReduceShapes(f.shape,c),h=(0,i.Z)(d,2),p=h[0],v=h[1],g=Re.util.sizeFromShape(v),m=Re.util.makeZerosTypedArray(Re.util.sizeFromShape(p),f.dtype),y=n.data.get(f.dataId).values,b=0;b<m.length;++b){for(var x=b*g,k=y[x],w=0;w<g;++w){var _=y[x+w];(Number.isNaN(_)||_<k)&&(k=_)}m[b]=k}null!=l&&n.disposeIntermediateTensorInfo(f);var C=n.makeTensorInfo(p,f.dtype,m);if(u){var S=Rf({inputs:{x:C},backend:n,attrs:{shape:Re.backend_util.expandShapeToKeepDim(p,s)}});return n.disposeIntermediateTensorInfo(C),S}return C}},nv=sf((function(e,t){return Math.min(e,t)})),rv=Nf(Re.Minimum,nv),av={kernelName:Re.Minimum,backendName:"cpu",kernelFunc:rv};var iv={kernelName:Re.MirrorPad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.mode;Kl(a,"mirrorPad");for(var u=i.map((function(e,t){return e[0]+a.shape[t]+e[1]})),s=i.map((function(e){return e[0]})),c=i.map((function(e,t){return e[0]+a.shape[t]})),l="reflect"===o?0:1,f=n.data.get(a.dataId).values,d=a.shape.length,h=Re.util.computeStrides(a.shape),p=Re.util.sizeFromShape(u),v=u.length,g=Re.util.computeStrides(u),m=Re.util.getTypedArrayFromDType(a.dtype,p),y=0;y<p;y++){for(var b=Re.util.indexToLoc(y,v,g),x=0;x<v;x++)b[x]<s[x]?b[x]=2*s[x]-b[x]-l:b[x]>=c[x]&&(b[x]=2*(c[x]-1)-b[x]+l);b=b.map((function(e,t){return e-s[t]}));var k=Re.util.locToIndex(b,d,h);m[y]=f[k]}return{dataId:n.write(m,u,a.dtype),shape:u,dtype:a.dtype}}},ov=sf((function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),uv=Nf(Re.Mod,ov),sv={kernelName:Re.Mod,backendName:"cpu",kernelFunc:uv};function cv(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.dim,o=a.shape.length,u=i;if(-1===u&&(u=o-1),u!==o-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(o," and dim was ").concat(u));var s=Re.util.parseAxisParam([u],a.shape),c=Vp({inputs:{x:a},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),l=Re.backend_util.expandShapeToKeepDim(c.shape,s),f=Rf({inputs:{x:c},backend:n,attrs:{shape:l}}),d=Ph({inputs:{a:a,b:f},backend:n}),h=Th({inputs:{x:d},backend:n}),p=dh({inputs:{x:h},backend:n,attrs:{axis:s,keepDims:!1}}),v=Rf({inputs:{x:p},backend:n,attrs:{shape:l}}),g=Zh({inputs:{a:h,b:v},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),g}var lv={kernelName:Re.Softmax,backendName:"cpu",kernelFunc:cv};var fv={kernelName:Re.Multinomial,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,u=r.normalized;Kl(a,"multinomial");for(var s=u?a:cv({inputs:{logits:a},backend:n,attrs:{dim:-1}}),c=s.shape[0],l=s.shape[1],f=n.data.get(s.dataId).values,d=[c,i],h=Re.util.makeZerosTypedArray(Re.util.sizeFromShape(d),"int32"),p=0;p<c;++p){var v=p*l,g=new Float32Array(l-1);g[0]=f[v];for(var m=1;m<g.length;++m)g[m]=g[m-1]+f[v+m];for(var y=yl.alea(o.toString()),b=p*i,x=0;x<i;++x){var k=y();h[b+x]=g.length;for(var w=0;w<g.length;w++)if(k<g[w]){h[b+x]=w;break}}}return u||n.disposeIntermediateTensorInfo(s),n.makeTensorInfo(d,"int32",h)}};function dv(e,t,n){var r=Re.util.createScalarValue(-1,n);return sh([],t,r,e,n)}var hv={kernelName:Re.Neg,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x;Kl(r,"neg");var a=dv(n.data.get(r.dataId).values,r.shape,r.dtype),o=(0,i.Z)(a,2),u=o[0],s=o[1];return n.makeTensorInfo(s,r.dtype,u)}},pv=Re.kernel_impls.nonMaxSuppressionV3Impl;var vv={kernelName:Re.NonMaxSuppressionV3,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold;Kl(a,"NonMaxSuppression");var c=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,f=pv(c,l,o,u,s).selectedIndices;return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}},gv=Re.kernel_impls.nonMaxSuppressionV4Impl;var mv={kernelName:Re.NonMaxSuppressionV4,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=r.padToMaxOutputSize;Kl(a,"NonMaxSuppressionPadded");var l=n.data.get(a.dataId).values,f=n.data.get(i.dataId).values,d=gv(l,f,o,u,s,c),h=d.selectedIndices,p=d.validOutputs;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},yv=Re.kernel_impls.nonMaxSuppressionV5Impl;var bv={kernelName:Re.NonMaxSuppressionV5,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=r.softNmsSigma;Kl(a,"NonMaxSuppressionWithScore");var l=n.data.get(a.dataId).values,f=n.data.get(i.dataId).values,d=yv(l,f,o,u,s,c),h=d.selectedIndices,p=d.selectedScores;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([p.length],"float32",new Float32Array(p))]}},xv=sf((function(e,t){return e!==t?1:0})),kv=Nf(Re.NotEqual,xv,null,"bool"),wv={kernelName:Re.NotEqual,backendName:"cpu",kernelFunc:kv};var _v={kernelName:Re.OneHot,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.dtype,u=r.depth,s=r.onValue,c=r.offValue;Kl(a,"oneHot");var l=Re.util.sizeFromShape(a.shape),f=new Float32Array(l*u);f.fill(c);for(var d=n.data.get(a.dataId).values,h=0;h<l;++h)d[h]>=0&&d[h]<u&&(f[h*u+d[h]]=s);return n.makeTensorInfo([].concat((0,o.Z)(a.shape),[u]),i,f)}};function Cv(e){var t=e.inputs,n=e.backend,r=t.x;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){var a=Cf({inputs:{input:r},backend:n}),i=Cv({inputs:{x:a},backend:n}),o=Od({inputs:{input:r},backend:n}),u=Cv({inputs:{x:o},backend:n}),s=kf({inputs:{real:i,imag:u},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),s}return qh({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}var Sv={kernelName:Re.ZerosLike,backendName:"cpu",kernelFunc:Cv};var Av={kernelName:Re.OnesLike,backendName:"cpu",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===a.dtype){var i=Cf({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),u=Od({inputs:{input:a},backend:r}),s=Cv({inputs:{x:u},backend:r}),c=kf({inputs:{real:o,imag:s},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(u),r.disposeIntermediateTensorInfo(s),c}return qh({backend:r,attrs:{shape:a.shape,value:1,dtype:a.dtype}})}};function Ev(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return Dh({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){Re.util.assertShapesMatch(a,e.shape,"All tensors passed to stack must have matching shapes"),Re.util.assert(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],u=Zd({inputs:t.map((function(e){var t=Dh({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),u}var Tv={kernelName:Re.Pack,backendName:"cpu",kernelFunc:Ev};var Nv={kernelName:Re.PadV2,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue;Kl(a,"pad");var u=i.map((function(e,t){return e[0]+a.shape[t]+e[1]})),s=i.map((function(e){return e[0]})),c=n.data.get(a.dataId).values,l=Re.util.sizeFromShape(a.shape),f=a.shape.length,d=Re.util.computeStrides(a.shape),h=Re.util.sizeFromShape(u),p=u.length,v=Re.util.computeStrides(u),g=Re.util.getTypedArrayFromDType(a.dtype,h);0!==o&&g.fill(o);for(var m=0;m<l;m++){var y=Re.util.indexToLoc(m,f,d).map((function(e,t){return e+s[t]}));g[Re.util.locToIndex(y,p,v)]=c[m]}return{dataId:n.write(g,u,a.dtype),shape:u,dtype:a.dtype}}},Dv=sf((function(e,t){return Math.pow(e,t)})),Fv=Nf(Re.Pow,Dv),Iv={kernelName:Re.Pow,backendName:"cpu",kernelFunc:Fv};function Mv(e,t,n,r){for(var a=Re.backend_util.computeOutAndReduceShapes(e,r),o=(0,i.Z)(a,2),u=o[0],s=o[1],c=(0,Re.upcastType)(t,"int32"),l=Re.util.makeZerosTypedArray(Re.util.sizeFromShape(u),c),f=Re.util.sizeFromShape(s),d=0;d<l.length;++d){for(var h=d*f,p=1,v=0;v<f;++v)p*=n[h+v];l[d]=p}return{outVals:l,outShape:u,outDtype:c}}var Ov={kernelName:Re.Prod,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.keepDims;Kl(a,"prod");var u=a.shape.length,s=Re.util.parseAxisParam(i,a.shape),c=Re.backend_util.getAxesPermutation(s,u),l=s,f=a,d=[];null!=c&&(f=Xf({inputs:{x:a},backend:n,attrs:{perm:c}}),d.push(f),l=Re.backend_util.getInnerMostAxes(l.length,u));var h=n.data.get(f.dataId).values,p=Mv(f.shape,f.dtype,h,l),v=p.outVals,g=p.outShape,m=p.outDtype,y=g;return o&&(y=Re.backend_util.expandShapeToKeepDim(g,s)),d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(y,m,v)}};function Rv(e,t,n,r){var a=[],i=0,o=t.length-1+n.length,u=new Array(o).fill(null).map((function(){return[0]}));!function(e,t){for(var n=0;n<e.length;++n){var r=e[n],a=n===e.length-1?t:e[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(var i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}(n,r);for(var s=1,c=0;c<t.length-1;++c){s*=t[c];for(var l=t[c+1],f=1;f<s+1;++f)u[c].push(f*l)}for(var d=0;d<e.length;++d){for(var h=e[d],p=e[d]+1,v=0;v<n.length;++v){var g=n[v],m=v+t.length-1;if(m>=0)for(var y=u[m],b=y[y.length-1]-g[h],x=h;x<p;++x)u[m].push(g[x+1]+b);h=g[h],p=g[p]}p!==h&&(a.push([h,p]),i+=p-h)}return{outSplits:u,valueSlices:a,numValues:i}}function Zv(e,t){for(var n=e.slice(0,t);n.length<t;)n.push(1);for(var r=t;r<e.length;r++)n[t-1]*=e[r];return n}function Bv(e,t,n,r,a){var i=t.slice();i[0]=a;var o=Re.util.getArrayFromDType(n,Re.util.sizeFromShape(i)),u=e.length;return function(e,t,n,r,a,i){var o,u=Zv(t,2)[1],s=Zv(i,2)[1],c=0,l=(0,h.Z)(n);try{for(l.s();!(o=l.n()).done;)for(var f=o.value,d=f[0];d<f[1];++d){for(var p=0;p<r;++p)a[c*s+p]=e[d*u+p];++c}}catch(v){l.e(v)}finally{l.f()}}(e,t,r,0===u?0:u/t[0],o,i),[o,i]}function zv(e,t,n,r,a,i,o,u){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,n){e.forEach((function(e,r){if(e<0||e>=n){var a=Re.util.indexToLoc(r,t.length,Re.util.computeStrides(t)).join(",");throw new Error("indices[".concat(a,"] = ").concat(e," is not in [0, ").concat(n,")"))}}))}(i,o,t[0][0]-1),0===r.length)throw new Error("params.rank must be nonzero");var s=Rv(i,o,e,r[0]),c=s.outSplits,l=s.valueSlices,f=s.numValues,d=function(e){for(var t=[],n=function(){var n=e[r].length,a=Re.util.getArrayFromDType("int32",n);t.push(a),e[r].forEach((function(e,t){return a[t]=e}))},r=0;r<e.length;++r)n();return t}(c),h=Bv(n,r,a,l,f);return[d,h[0],h[1]]}var Lv={kernelName:Re.RaggedGather,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.paramsNestedSplits,o=t.paramsDenseValues,u=t.indices,s=(r.outputRaggedRank,a.map((function(e){return n.data.get(e.dataId).values}))),c=a.map((function(e){return e.shape})),l=n.data.get(o.dataId).values,f=n.data.get(u.dataId).values,d=zv(s,c,l,o.shape,o.dtype,f,u.shape),h=(0,i.Z)(d,3),p=h[0],v=h[1],g=h[2],m=p.map((function(e){return n.makeTensorInfo([e.length],"int32",e)})),y=n.makeTensorInfo(g,o.dtype,v);return m.concat([y])}},Pv=2147483647;function jv(e,t,n,r,a,i,o){if(t.length>1)throw new Error("starts must be a scalar or vector");if(a.length>1)throw new Error("limits must be a scalar or vector");if(o.length>1)throw new Error("deltas must be a scalar or vector");var u=0===t.length,s=0===a.length,c=0===o.length,l=[];u||l.push(t[0]),s||l.push(a[0]),c||l.push(o[0]);for(var f=1;f<l.length;++f)if(l[f]!==l[f-1])throw new Error("starts, limits, and deltas must have the same shape");var d=0===l.length?1:l[0],h=Re.util.getArrayFromDType("int32",d+1);h[0]=0;for(var p=0;p<d;++p){var v=u?e[0]:e[p],g=s?r[0]:r[p],m=c?i[0]:i[p];if(0===m)throw new Error("Requires delta != 0");var y=void 0;if(m>0&&g<v||m<0&&g>v)y=0;else if((y=Math.ceil(Math.abs((g-v)/m)))>Pv)throw new Error("Requires ((limit - start) / delta) <= ".concat(Pv));h[p+1]=h[p]+y}for(var b=h[d],x=Re.util.getArrayFromDType(n,b),k=0,w=0;w<d;++w)for(var _=h[w+1]-h[w],C=u?e[0]:e[w],S=c?i[0]:i[w],A=0;A<_;++A)x[k++]=C,C+=S;return[h,x]}var Uv={kernelName:Re.RaggedRange,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.starts,a=t.limits,o=t.deltas,u=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,c=n.data.get(o.dataId).values,l=jv(u,r.shape,r.dtype,s,a.shape,c,o.shape),f=(0,i.Z)(l,2),d=f[0],h=f[1];return[n.makeTensorInfo([d.length],"int32",d),n.makeTensorInfo([h.length],r.dtype,h)]}},Wv=Re.backend_util.RowPartitionType,Vv=function(){function e(t,n,r,a,i,o,s,c,l,f){(0,u.Z)(this,e),this.shape=t,this.shapeShape=n,this.values=r,this.valuesShape=a,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=s,this.rowPartitionValues=c,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=Re.backend_util.getRowPartitionTypesHelper(f),this.raggedRank=Re.backend_util.getRaggedRank(this.rowPartitionTypes)}return(0,s.Z)(e,[{key:"getRowPartitionTypeByDimension",value:function(e){return this.rowPartitionTypes[0]===Wv.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}},{key:"getRowPartitionTensor",value:function(e){return this.rowPartitionTypes[0]===Wv.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}},{key:"getMaxWidth",value:function(t){var n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case Wv.VALUE_ROWIDS:return e.getMaxWidthValueRowID(n);case Wv.ROW_SPLITS:return e.getMaxWidthRowSplit(n);default:throw new Error("Cannot handle partition type ".concat(Wv[this.getRowPartitionTypeByDimension(t-1)]))}}},{key:"tensorShapeFromTensor",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return qv(e,n)}},{key:"calculateOutputSize",value:function(e){var t=this.valuesShape,n=this.defaultValueShape;Re.backend_util.validateDefaultValueShape(n,t);var r=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=Re.backend_util.combineRaggedTensorToTensorShapes(this.raggedRank,r,t);a[0]<0&&(a[0]=e);for(var i=1;i<=this.raggedRank;++i)a[i]<0&&(a[i]=this.getMaxWidth(i));return a}},{key:"calculateFirstParentOutputIndex",value:function(e,t,n){for(var r=Math.min(e,n),a=[],i=0,o=0;o<r;++o,i+=t)a.push(i);for(var u=r;u<e;++u)a.push(-1);return Re.util.assert(a.length===e,(function(){return"Final length of result must be equal to firstDimension."})),a}},{key:"calculateOutputIndexRowSplit",value:function(e,t,n,r){for(var a=e.length,i=[],o=0;o<a-1;++o){var u=e[o+1]-e[o],s=Math.min(r,u),c=t[o];-1===c&&(s=0);for(var l=0;l<s;++l)i.push(c),c+=n;for(var f=0;f<u-s;++f)i.push(-1)}if(a>0&&i.length!==e[a-1])throw new Error("Invalid row split size.");return i}},{key:"calculateOutputIndexValueRowID",value:function(e,t,n,r){var a=e.length,i=[];if(0===a)return[];var o=0,u=e[0];if(u>=t.length)throw new Error("Got currentValueRowId=".concat(u,", which is not less than ").concat(t.length));var s=t[u];i.push(s);for(var c=1;c<a;++c){var l=e[c];if(l===u)s>=0&&(++o<r?s+=n:s=-1);else{if(o=0,u=l,l>=t.length)throw new Error("Got nextValueRowId=".concat(l," which is not less than ").concat(t.length));s=t[l]}i.push(s)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}},{key:"calculateOutputIndex",value:function(e,t,n,r){var a=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case Wv.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,t,n,r);case Wv.ROW_SPLITS:if(a.length-1>t.length)throw new Error("Row partition size is greater than output size: ".concat(a.length-1," > ").concat(t.length));return this.calculateOutputIndexRowSplit(a,t,n,r);default:throw new Error("Unsupported partition type: ".concat(Wv[i]))}}},{key:"getFirstDimensionSize",value:function(){var e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");var t=this.rowPartitionTypes[0];switch(t){case Wv.FIRST_DIM_SIZE:return e[0];case Wv.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Wv.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type ".concat(Wv[t]))}}},{key:"compute",value:function(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");var e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=new Array(this.raggedRank+1);n[n.length-1]=1;for(var r=n.length-2;r>=0;--r)n[r]=n[r+1]*t[r+1];var a=qv(t,!1),i=Re.util.getArrayFromDType(this.valuesDType,Re.util.sizeFromShape(a));if(n[0]*t[0]>0){for(var o=this.calculateFirstParentOutputIndex(e,n[0],t[0]),u=1;u<=this.raggedRank;++u){o=this.calculateOutputIndex(u-1,o,n[u],t[u])}this.setOutput(this.raggedRank,o,i,a)}return[a,i]}},{key:"setOutput",value:function(e,t,n,r){if(0!==n.length){var a=this.values,i=n,o=r.slice();o=o.slice(e+1);var u=Re.util.sizeFromShape(o),s=t.length,c=this.defaultValue;if(c.length!==u&&1!==c.length){var l=this.defaultValueShape;(0,Re.tidy)((function(){var e=(0,Re.reshape)(c,l),t=(0,Re.broadcastTo)(e,o);c=t.dataSync()}))}for(var f=0,d=0,h=0,p=0;p<=s;++p){var v=p<s?t[p]:-1;if(v!==h){if(d<h){var g=a.subarray(f*u);Gv(i.subarray(d*u),g,(h-d)*u)}if(p>=s){var m=n.length;v=Math.floor(m/u)}if(v>h)if(1===this.defaultValue.length)i.subarray(h*u,v*u).fill(this.defaultValue[0]),h=v;else for(;v>h;){Gv(i.slice(h*u),c,u),++h}v<0?(f=p+1,d=h):(f=p,h=(d=h)+1)}else++h}}}}],[{key:"getMaxWidthRowSplit",value:function(e){var t=e.length;if(0===t||1===t)return 0;for(var n=0,r=0;r<t-1;++r){var a=e[r+1]-e[r];a>n&&(n=a)}return n}},{key:"getMaxWidthValueRowID",value:function(e){var t=e.length;if(0===t)return 0;for(var n=0,r=e[0],a=0,i=1;i<t;++i){var o=e[i];o!==r&&(r=o,a=Math.max(i-n,a),n=i)}return Math.max(t-n,a)}}]),e}();function Gv(e,t,n){for(var r=0;r<n;r++)e[r]=t[r]}function qv(e,t){var n,r=[],a=(0,h.Z)(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i<0){if(!t)throw new Error("Dimension ".concat(i," must be >= 0"));if(i<-1)throw new Error("Dimension ".concat(i," must be >= -1"));i=-1}r.push(i)}}catch(o){a.e(o)}finally{a.f()}return r}function Hv(e,t,n,r,a,i,o,u,s,c){return new Vv(e,t,n,r,a,i,o,u,s,c).compute()}var Xv={kernelName:Re.RaggedTensorToTensor,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.shape,o=t.values,u=t.defaultValue,s=t.rowPartitionTensors,c=r.rowPartitionTypes,l=n.data.get(a.dataId).values,f=n.data.get(o.dataId).values,d=n.data.get(u.dataId).values,h=s.map((function(e){return n.data.get(e.dataId).values})),p=s.map((function(e){return e.shape})),v=Hv(l,a.shape,f,o.shape,o.dtype,d,u.shape,h,p,c),g=(0,i.Z)(v,2),m=g[0],y=g[1];return n.makeTensorInfo(m,o.dtype,y)}};function Yv(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return Re.util.makeZerosTypedArray(0,r);var a=Math.abs(Math.ceil((t-e)/n)),i=Re.util.makeZerosTypedArray(a,r);t<e&&1===n&&(n=-1),i[0]=e;for(var o=1;o<i.length;o++)i[o]=i[o-1]+n;return i}var Kv={kernelName:Re.Range,backendName:"cpu",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.dtype,o=Yv(r,a,n.step,i);return t.makeTensorInfo([o.length],i,o)}},$v=Jl(Re.Reciprocal,(function(e){return 1/e})),Qv={kernelName:Re.Reciprocal,backendName:"cpu",kernelFunc:$v};var Jv={kernelName:Re.ResizeBilinear,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,o=r.alignCorners,u=r.halfPixelCenters,s=r.size;Kl(a,"resizeBilinear");for(var c=Re.util.computeStrides(a.shape),l=(0,i.Z)(s,2),f=l[0],d=l[1],h=(0,i.Z)(a.shape,4),p=h[0],v=h[1],g=h[2],m=h[3],y=n.data.get(a.dataId).values,b=new Float32Array(Re.util.sizeFromShape([p,f,d,m])),x=[o&&f>1?v-1:v,o&&d>1?g-1:g],k=[o&&f>1?f-1:f,o&&d>1?d-1:d],w=0,_=x[0]/k[0],C=x[1]/k[1],S=0;S<p;S++)for(var A=0;A<f;A++){var E=void 0;E=u?_*(A+.5)-.5:_*A;for(var T=Math.max(0,Math.floor(E)),N=E-T,D=Math.min(v-1,Math.ceil(E)),F=S*c[0]+T*c[1],I=S*c[0]+D*c[1],M=0;M<d;M++){var O=void 0;O=u?C*(M+.5)-.5:C*M;for(var R=Math.max(0,Math.floor(O)),Z=O-R,B=Math.min(g-1,Math.ceil(O)),z=F+R*c[2],L=I+R*c[2],P=F+B*c[2],j=I+B*c[2],U=0;U<m;U++){var W=y[z+U],V=y[L+U],G=W+(y[P+U]-W)*Z,q=G+(V+(y[j+U]-V)*Z-G)*N;b[w++]=q}}}return n.makeTensorInfo([p,f,d,m],"float32",b)}};var eg={kernelName:Re.ResizeBilinearGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,o=t.dy,u=r.alignCorners;Kl([o,a],"resizeBilinearGrad");for(var s=Re.util.computeStrides(a.shape),c=(0,i.Z)(a.shape,4),l=c[0],f=c[1],d=c[2],h=c[3],p=(0,i.Z)(o.shape,3),v=p[1],g=p[2],m=new Float32Array(l*f*d*h),y=[u&&v>1?f-1:f,u&&g>1?d-1:d],b=[u&&v>1?v-1:v,u&&g>1?g-1:g],x=y[0]/b[0],k=y[1]/b[1],w=n.data.get(o.dataId).values,_=0,C=0;C<l;C++)for(var S=C*s[0],A=0;A<v;A++)for(var E=A*x,T=Math.floor(E),N=Math.min(Math.ceil(E),f-1),D=S+T*s[1],F=S+N*s[1],I=E-T,M=1-I,O=0;O<g;O++)for(var R=O*k,Z=Math.floor(R),B=Math.min(Math.ceil(R),d-1),z=R-Z,L=1-z,P=D+Z*s[2],j=D+B*s[2],U=F+Z*s[2],W=F+B*s[2],V=M*L,G=M*z,q=I*L,H=I*z,X=0;X<h;X++){var Y=w[_++];m[P+X]+=Y*V,m[j+X]+=Y*G,m[U+X]+=Y*q,m[W+X]+=Y*H}return n.makeTensorInfo([l,d,f,h],"float32",m)}};var tg={kernelName:Re.ResizeNearestNeighbor,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,o=r.alignCorners,u=r.halfPixelCenters,s=r.size;Kl(a,"resizeNearestNeighbor");for(var c=Re.util.computeStrides(a.shape),l=(0,i.Z)(s,2),f=l[0],d=l[1],h=(0,i.Z)(a.shape,4),p=h[0],v=h[1],g=h[2],m=h[3],y=n.data.get(a.dataId).values,b=new Float32Array(p*f*d*m),x=[o&&f>1?v-1:v,o&&d>1?g-1:g],k=[o&&f>1?f-1:f,o&&d>1?d-1:d],w=x[0]/k[0],_=x[1]/k[1],C=0,S=0;S<p;S++)for(var A=S*c[0],E=0;E<f;E++){var T=u?w*(E+.5):w*E,N=Math.min(v-1,o?Math.round(T):Math.floor(T));u&&(N=Math.max(0,N));for(var D=A+N*c[1],F=0;F<d;F++){var I=u?_*(F+.5):_*F,M=Math.min(g-1,o?Math.round(I):Math.floor(I));u&&(M=Math.max(0,M));for(var O=D+M*c[2],R=0;R<m;R++){var Z=y[O+R];b[C++]=Z}}}return n.makeTensorInfo([p,f,d,m],a.dtype,b)}};var ng={kernelName:Re.ResizeNearestNeighborGrad,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,o=t.dy,u=r.alignCorners;Kl([o,a],"resizeNearestNeighborGrad");for(var s=Re.util.computeStrides(a.shape),c=Re.util.computeStrides(o.shape),l=(0,i.Z)(a.shape,4),f=l[0],d=l[1],h=l[2],p=l[3],v=(0,i.Z)(o.shape,3),g=v[1],m=v[2],y=new Float32Array(f*d*h*p),b=n.data.get(o.dataId).values,x=[u&&g>1?d-1:d,u&&m>1?h-1:h],k=[u&&g>1?g-1:g,u&&m>1?m-1:m],w=x[0]/k[0],_=x[1]/k[1],C=1/w,S=1/_,A=2*Math.ceil(C)+2,E=2*Math.ceil(S)+2,T=0;T<f;T++)for(var N=T*s[0],D=0;D<d;D++)for(var F=N+D*s[1],I=Math.floor(D*C),M=Math.floor(I-A/2),O=0;O<h;O++)for(var R=F+O*s[2],Z=Math.floor(O*S),B=Math.floor(Z-E/2),z=0;z<p;z++){for(var L=0,P=0;P<A;P++){var j=P+M;if(!(j<0||j>=g)){var U=N+j*c[1],W=j*w;if(D===Math.min(d-1,u?Math.round(W):Math.floor(W)))for(var V=0;V<E;V++){var G=V+B;if(!(G<0||G>=m)){var q=U+G*c[2],H=G*_;O===Math.min(h-1,u?Math.round(H):Math.floor(H))&&(L+=b[q+z])}}}}y[R+z]=L}return n.makeTensorInfo(a.shape,a.dtype,y)}};var rg={kernelName:Re.Reverse,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims;Kl(a,"reverse");var u=a.shape.length,s=Re.util.parseAxisParam(i,a.shape);if(0===u)return rf({inputs:{x:a},backend:n});for(var c=new Re.TensorBuffer(a.shape,a.dtype),l=n.bufferSync(a),f=function(){var e=c.indexToLoc(d),t=e.slice();s.forEach((function(e){return t[e]=a.shape[e]-1-t[e]})),c.set.apply(c,[l.get.apply(l,(0,o.Z)(t))].concat((0,o.Z)(e)))},d=0;d<c.size;d++)f();return n.makeTensorInfo(c.shape,c.dtype,c.values)}},ag={kernelName:Re.RotateWithOffset,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,o=n.radians,u=n.fillValue,s=n.center,c=r,l=Re.util.getTypedArrayFromDType(a.dtype,Re.util.sizeFromShape(a.shape)),f=(0,i.Z)(a.shape,4),d=f[0],h=f[1],p=f[2],v=f[3],g=Re.backend_util.getImageCenter(s,h,p),m=(0,i.Z)(g,2),y=m[0],b=m[1],x=Math.sin(o),k=Math.cos(o),w=c.data.get(a.dataId).values,_=0;_<d;_++)for(var C=_*p*h*v,S=0;S<h;S++)for(var A=S*(p*v),E=0;E<p;E++)for(var T=E*v,N=0;N<v;N++){var D=[d,S,E,N],F=D[2],I=D[1],M=(F-y)*k-(I-b)*x,O=(F-y)*x+(I-b)*k;M=Math.round(M+y),O=Math.round(O+b);var R=u;if("number"!==typeof u&&(R=3===N?255:u[N]),M>=0&&M<p&&O>=0&&O<h)R=w[C+O*(p*v)+M*v+N];l[C+A+T+N]=R}return{dataId:c.write(l,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},ig=Jl(Re.Round,(function(e){var t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2===0?t:t+1})),og={kernelName:Re.Round,backendName:"cpu",kernelFunc:ig},ug=gf((function(e){return 1/Math.sqrt(e)})),sg=ef(Re.Rsqrt,ug),cg={kernelName:Re.Rsqrt,backendName:"cpu",kernelFunc:sg};function lg(e,t,n,r,a,i,o,u,s,c){var l=[r/a,a],f=e.values,d=t.values;if(0===r)return(0,Re.buffer)(n,t.dtype);var h=(0,Re.buffer)(l,t.dtype);"string"===typeof s||"number"===typeof s?h.values.fill(s):"boolean"===typeof s&&h.values.fill(+s);for(var p=0;p<i;p++){for(var v=[],g=0,m=0;m<o;m++){var y=f[p*o+m];v.push(y),g+=y*u[m]}if(g<0||g>=r/a)throw new Error("Invalid indices: ".concat(v," does not index into ").concat(n));for(var b=0;b<a;b++)c?h.values[g*a+b]+=d[p*a+b]:h.values[g*a+b]=0===t.rank?d[0]:d[p*a+b]}return h}var fg={kernelName:Re.ScatterNd,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,u=Re.backend_util.calculateShapes(i,a,o),s=u.sliceRank,c=u.numUpdates,l=u.sliceSize,f=u.strides,d=u.outputSize,h=lg(n.bufferSync(a),n.bufferSync(i),o,d,l,c,s,f,0,!0);return n.makeTensorInfo(o,h.dtype,h.values)}};function dg(e,t){for(var n=0,r=e.length,a=0;n<r;)e[a=Math.floor((n+r)/2)]<t?n=a+1:r=a;return r}function hg(e,t){for(var n=0,r=e.length,a=0;n<r;)e[a=Math.floor((n+r)/2)]<=t?n=a+1:r=a;return r}var pg={kernelName:Re.SearchSorted,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sortedSequence,i=t.values,o=r.side,u=function(e,t,n,r,a,i){for(var o=Re.util.getArrayFromDType("int32",n*a),u=0;u<n;++u)for(var s=e.slice(u*r,(u+1)*r),c=u*a,l=0;l<a;++l)o[c+l]="left"===i?dg(s,t[l+c]):hg(s,t[l+c]);return o}(n.data.get(a.dataId).values,n.data.get(i.dataId).values,a.shape[0],a.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",u)}};var vg={kernelName:Re.Select,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e;Kl([r,a,i],"select");for(var o=r.shape.length,u=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,l=(0,Re.upcastType)(a.dtype,i.dtype),f=Re.util.makeZerosTypedArray(Re.util.sizeFromShape(a.shape),l),d=0,h=0===o||o>1||1===a.shape.length?1:Re.util.sizeFromShape(a.shape.slice(1)),p=0;p<u.length;p++)for(var v=0;v<h;v++)1===u[p]?f[d++]=s[p]:f[d++]=c[p];return n.makeTensorInfo(a.shape,l,f)}},gg=Re.backend_util.SELU_SCALEALPHA,mg=Re.backend_util.SELU_SCALE,yg=Jl(Re.Selu,(function(e){return e>=0?mg*e:gg*(Math.exp(e)-1)})),bg={kernelName:Re.Selu,backendName:"cpu",kernelFunc:yg},xg=Jl(Re.Sign,(function(e){return e<0?-1:e>0?1:0})),kg={kernelName:Re.Sign,backendName:"cpu",kernelFunc:xg},wg=Jl(Re.Sin,(function(e){return Math.sin(e)})),_g={kernelName:Re.Sin,backendName:"cpu",kernelFunc:wg},Cg=Jl(Re.Sinh,(function(e){return Math.sinh(e)})),Sg={kernelName:Re.Sinh,backendName:"cpu",kernelFunc:Cg},Ag=Math.log(1.1920928955078125e-7)+2,Eg=Jl(Re.Softplus,(function(e){var t=e>-Ag,n=e<Ag,r=Math.exp(e);return n?r:t?e:Math.log(1+r)})),Tg={kernelName:Re.Softplus,backendName:"cpu",kernelFunc:Eg};var Ng={kernelName:Re.SpaceToBatchND,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,u=r.paddings;Kl([a],"spaceToBatchND");var s=Re.util.sizeFromShape(i),c=[[0,0]];c.push.apply(c,(0,o.Z)(u));for(var l=1+i.length;l<a.shape.length;++l)c.push([0,0]);var f=Nv.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:c,constantValue:0}}),d=Re.backend_util.getReshaped(f.shape,i,s,!1),h=Re.backend_util.getPermuted(d.length,i.length,!1),p=Re.backend_util.getReshapedPermuted(f.shape,i,s,!1),v=Rf({inputs:{x:f},backend:n,attrs:{shape:d}}),g=Xf({inputs:{x:v},backend:n,attrs:{perm:h}}),m=Rf({inputs:{x:g},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),m}};function Dg(e,t,n,r,a,i,o){var u=t[0],s=i[0],c=new Array(s),l=new Array(u),f=t[1];if(0===s){if(0!==u)throw new Error(Re.backend_util.getSparseFillEmptyRowsIndicesDenseShapeMismatch(u));return[Re.util.getArrayFromDType(n,0),[0,f],Re.util.getArrayFromDType(a,0),c,l]}for(var d=!0,h=0,p=new Array(s).fill(0),v=0;v<u;++v){var g=e[v*f];if(g<0)throw new Error(Re.backend_util.getSparseFillEmptyRowsNegativeIndexErrorMessage(v,g));if(g>=s)throw new Error(Re.backend_util.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(v,g,s));++p[g],d=d&&g>=h,h=g}for(var m=!0,y=0;y<s;++y){var b=0===p[y];c[y]=b,m=m&&!b,p[y]=Math.max(p[y],1),y>0&&(p[y]+=p[y-1])}if(m&&d){for(var x=e,k=r,w=0;w<u;++w)l[w]=w;return[x,[u,f],k,c,l]}for(var _=p[s-1],C=Re.util.getArrayFromDType(n,_*f),S=Re.util.getArrayFromDType(a,_),A=new Array(s).fill(0),E=0;E<u;++E){var T=e[E*f],N=A[T],D=(0===T?0:p[T-1])+N;A[T]++;for(var F=0;F<f;++F)C[D*f+F]=e[E*f+F];S[D]=r[E],l[E]=D}for(var I=0;I<s;++I){if(0===A[I]){var M=0===I?0:p[I-1];C[M*f+0]=I;for(var O=1;O<f;++O)C[M*f+O]=0;S[M]=o}}return[C,[_,f],S,c,l]}var Fg={kernelName:Re.SparseFillEmptyRows,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.indices,a=t.values,o=t.denseShape,u=t.defaultValue;if(1!==o.shape.length)throw new Error("Dense shape must be a vector, saw:\n        ".concat(o.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n        ".concat(a.shape));if(0!==u.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(u.shape));var s=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,l=n.data.get(o.dataId).values,f=n.data.get(u.dataId).values[0],d=Dg(s,r.shape,r.dtype,c,a.dtype,l,f),h=(0,i.Z)(d,5),p=h[0],v=h[1],g=h[2],m=h[3],y=h[4];return[n.makeTensorInfo(v,r.dtype,p),n.makeTensorInfo([v[0]],a.dtype,g),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map((function(e){return Number(e)})))),n.makeTensorInfo([y.length],r.dtype,new Int32Array(y))]}};function Ig(e,t,n,r,a){for(var i=Re.util.sizeFromShape(r),o=t[0],u=a.length,s=[],c=1,l=-1,f=0;f<u;++f){var d=a[f];if(-1===d){if(-1!==l)throw new Error(Re.backend_util.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(l,f));l=f,s.push(1)}else{if(d<0)throw new Error(Re.backend_util.getSparseReshapeNegativeOutputDimErrorMessage(f,d));c*=d,s.push(d)}}if(-1!==l){if(c<=0)throw new Error(Re.backend_util.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());var h=Math.trunc(i/c);if(c*h!==i)throw new Error(Re.backend_util.getSparseReshapeInputOutputMultipleErrorMessage(r,s));s[l]=h}if(Re.util.sizeFromShape(s)!==i)throw new Error(Re.backend_util.getSparseReshapeInputOutputMismatchErrorMessage(r,s));var p=r.length,v=[];if(p>0){v[p-1]=1;for(var g=p-2;g>=0;--g)v[g]=v[g+1]*r[g+1]}var m=[];if(u>0){m[u-1]=1;for(var y=u-2;y>=0;--y)m[y]=m[y+1]*s[y+1]}for(var b=Re.util.getArrayFromDType(n,o*u),x=0;x<o;++x){for(var k=0,w=0;w<p;++w)k+=e[x*p+w]*v[w];for(var _=0;_<u;++_)b[x*u+_]=Math.trunc(k/m[_]),k%=m[_]}return[b,[o,u],s]}var Mg={kernelName:Re.SparseReshape,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.inputIndices,a=t.inputShape,o=t.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape\n        ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape\n        ".concat(a.shape));if(1!==o.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(o.shape));var u=Array.from(n.data.get(a.dataId).values),s=n.data.get(r.dataId).values,c=Array.from(n.data.get(o.dataId).values),l=Ig(s,r.shape,r.dtype,u,c),f=(0,i.Z)(l,3),d=f[0],h=f[1],p=f[2];return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([p.length],o.dtype,new Int32Array(p))]}};function Og(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=r.length,s=[t[0],e.length/t[0]],c=s[1],l=u>0?a[u-1]+1:0,f=l;if(f<0)throw new Error(Re.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());var d=t.slice();d[0]=f;var h=d.reduce((function(e,t){return e*t}),1),p=Re.util.getArrayFromDType(n,h);if(0===u)return f>0&&p.fill(o),[p,d];if(f<=0)throw new Error(Re.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());for(var v=0,g=1,m=0,y=a[v];;){var b=0;if(g<u){if(y===(b=a[g])){++g;continue}if(y>=b)throw new Error(Re.backend_util.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(y<0||y>=f)throw new Error(Re.backend_util.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(y,f));y>m&&p.fill(o,m*c,y*c);for(var x=v;x<g;++x){var k=r[x];if(k<0||k>=s[0])throw new Error(Re.backend_util.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(x,r[x],s[0]));for(var w=0;w<c;w++)p[y*c+w]+=e[k*c+w]}if(i)for(var _=0;_<c;_++)p[y*c+_]/=g-v;if(v=g,m=y+1,y=b,++g>u)break}return m<f&&p.fill(o,m*c,f*c),[p,d]}var Rg={kernelName:Re.SparseSegmentMean,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,o=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n          ".concat(a.shape));if(1!==o.shape.length)throw new Error("Segment ids should be a vector but received shape\n          ".concat(o.shape));if(a.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");var u=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,c=n.data.get(o.dataId).values,l=Og(u,r.shape,r.dtype,s,c,!0),f=(0,i.Z)(l,2),d=f[0],h=f[1];return n.makeTensorInfo(h,r.dtype,d)}};var Zg={kernelName:Re.SparseSegmentSum,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,o=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n         ".concat(a.shape));if(1!==o.shape.length)throw new Error("Segment ids should be a vector but received shape\n         ".concat(o.shape));if(a.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");var u=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,c=n.data.get(o.dataId).values,l=Og(u,r.shape,r.dtype,s,c),f=(0,i.Z)(l,2),d=f[0],h=f[1];return n.makeTensorInfo(h,r.dtype,d)}};var Bg={kernelName:Re.SparseToDense,backendName:"cpu",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.sparseIndices,o=n.sparseValues,u=n.defaultValue,s=a.outputShape,c=Re.backend_util.calculateShapes(o,i,s),l=c.sliceRank,f=c.numUpdates,d=c.sliceSize,h=c.strides,p=c.outputSize,v=!1,g=r.bufferSync(i);switch(o.dtype){case"bool":t=lg(g,r.bufferSync(o),s,p,d,f,l,h,Boolean(r.data.get(u.dataId).values[0]),v);break;case"float32":t=lg(g,r.bufferSync(o),s,p,d,f,l,h,r.data.get(u.dataId).values[0],v);break;case"int32":t=lg(g,r.bufferSync(o),s,p,d,f,l,h,r.data.get(u.dataId).values[0],v);break;case"string":t=lg(g,r.bufferSync(o),s,p,d,f,l,h,Re.util.decodeString(r.data.get(u.dataId).values[0]),v);break;default:throw new Error("Unsupported type ".concat(o.dtype))}return r.makeTensorInfo(s,t.dtype,t.values)}};var zg={kernelName:Re.SplitV,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,u=r.axis,s=Re.util.parseAxisParam(u,a.shape)[0],c=Re.backend_util.prepareSplitSize(a,i,s),l=new Array(a.shape.length).fill(0),f=a.shape.slice();return c.map((function(e){var t=(0,o.Z)(f);t[s]=e;var r=xd({inputs:{x:a},backend:n,attrs:{begin:l,size:t}});return l[s]+=e,r}))}},Lg=gf((function(e){return Math.sqrt(e)})),Pg=Jl(Re.Sqrt,(function(e){return Math.sqrt(e)})),jg={kernelName:Re.Sqrt,backendName:"cpu",kernelFunc:Pg},Ug={kernelName:Re.Square,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;Kl(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),u=0;u<i.length;++u){var s=i[u];o[u]=s*s}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},Wg=sf((function(e,t){var n=e-t;return n*n})),Vg=Nf(Re.SquaredDifference,Wg),Gg={kernelName:Re.SquaredDifference,backendName:"cpu",kernelFunc:Vg},qg=Jl(Re.Step,(function(e,t){var n=t;return isNaN(e)?NaN:e>0?1:n.alpha})),Hg={kernelName:Re.Step,backendName:"cpu",kernelFunc:qg};function Xg(e,t,n,r){for(var a=(0,Re.buffer)(e,t.dtype),i=0;i<a.size;i++){for(var u=a.indexToLoc(i),s=new Array(u.length),c=0;c<s.length;c++)s[c]=u[c]*n[c]+r[c];a.set.apply(a,[t.get.apply(t,s)].concat((0,o.Z)(u)))}return a}var Yg={kernelName:Re.StridedSlice,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,o=r.end,u=r.strides,s=r.beginMask,c=r.endMask,l=r.ellipsisMask,f=r.newAxisMask,d=r.shrinkAxisMask;Kl(a,"stridedSlice");var h,p=Re.slice_util.sliceInfo(a.shape,i,o,u,s,c,l,f,d),v=p.finalShapeSparse,g=p.finalShape,m=p.isIdentity,y=p.sliceDim0,b=p.isSimpleSlice,x=p.begin,k=p.end,w=p.strides;if(m)h=Rf({inputs:{x:a},backend:n,attrs:{shape:g}});else if(y||b){Re.util.assert(a.shape.length>=1,(function(){return"Input must have rank at least 1, got: ".concat(a.shape.length)}));var _=Re.slice_util.computeOutShape(x,k,w),C=xd({inputs:{x:a},backend:n,attrs:{begin:x,size:_}});h=Rf({inputs:{x:C},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(C)}else{var S=Xg(v,n.bufferSync(a),w,x);h=n.makeTensorInfo(g,S.dtype,S.values)}return h}},Kg=function(){function e(t,n,r,a,i,o){(0,u.Z)(this,e),this.separator=Re.util.encodeString(t),this.nGramWidths=n,this.leftPad=Re.util.encodeString(r),this.rightPad=Re.util.encodeString(a),this.padWidth=i,this.preserveShort=o}return(0,s.Z)(e,[{key:"getPadWidth",value:function(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}},{key:"getNumNGrams",value:function(e,t){var n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}},{key:"createNGrams",value:function(e,t,n,r,a,i){for(var o=this,u=function(){var u=o.getPadWidth(i),c=Math.max(0,u-s),l=Math.max(0,u-(a-(s+1))),f=i-(c+l),d=t+(c>0?0:s-u),h=0;h+=c*o.leftPad.length;for(var p=0;p<f;++p)h+=e[d+p].length;h+=l*o.rightPad.length,h+=(c+l+f-1)*o.separator.length,n[r+s]=new Uint8Array(h);for(var v=n[r+s],g=0,m=function(e){return e.forEach((function(e){return v[g++]=e}))},y=0;y<c;++y)m(o.leftPad),m(o.separator);for(var b=0;b<f-1;++b)m(e[d+b]),m(o.separator);if(f>0){m(e[d+f-1]);for(var x=0;x<l;++x)m(o.separator),m(o.rightPad)}else{for(var k=0;k<l-1;++k)m(o.rightPad),m(o.separator);m(o.rightPad)}},s=0;s<a;++s)u()}},{key:"compute",value:function(e,t){var n=this,r=e.length,a=t.length;if(a>0){var i=t[0];if(0!==i)throw new Error("First split value must be 0, got ".concat(i));for(var o=1;o<a;++o){var u=t[o]>=i;if(!(u=u&&t[o]<=r))throw new Error("Invalid split value ".concat(t[o],", must be in [").concat(i,", ").concat(r,"]"));i=t[o]}if(i!==r)throw new Error("Last split value must be data size. Expected ".concat(r,", got ").concat(i))}var s=a-1,c=Re.util.getArrayFromDType("int32",a);if(0===r||0===a){for(var l=new Array(r),f=0;f<=s;++f)c[f]=0;return[l,c]}c[0]=0;for(var d=function(){var e=t[h]-t[h-1],r=0;n.nGramWidths.forEach((function(t){r+=n.getNumNGrams(e,t)})),n.preserveShort&&e>0&&0===r&&(r=1),c[h]=c[h-1]+r},h=1;h<=s;++h)d();for(var p=new Array(c[s]),v=function(r){var a=t[r],i=c[r];if(n.nGramWidths.forEach((function(o){var u=t[r+1]-t[r],s=n.getNumNGrams(u,o);n.createNGrams(e,a,p,i,s,o),i+=s})),n.preserveShort&&i===c[r]){var o=t[r+1]-t[r];if(0===o)return"continue";var u=o+2*n.padWidth;n.createNGrams(e,a,p,i,1,u)}},g=0;g<s;++g)v(g);return[p,c]}}]),e}();function $g(e,t,n,r,a,i,o,u){return new Kg(n,r,a,i,o,u).compute(e,t)}var Qg={kernelName:Re.StringNGrams,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=r.separator,o=r.nGramWidths,u=r.leftPad,s=r.rightPad,c=r.padWidth,l=r.preserveShortSequences,f=t.data,d=t.dataSplits,h=$g(n.data.get(f.dataId).values,n.data.get(d.dataId).values,a,o,u,s,c,l),p=(0,i.Z)(h,2),v=p[0],g=p[1];return[n.makeTensorInfo([v.length],"string",v),n.makeTensorInfo(d.shape,"int32",g)]}};function Jg(e,t,n,r){if(e.length)if(0!==t.length)if(1!==t.length){for(var a=0,i=0;i<e.length+1;i++)if(i===e.length||-1!==t.indexOf(e[i])){var o=e.subarray(a,i);n&&0===o.length||r.push(o),a=i+1}}else{for(var u=t[0],s=e.indexOf(u);-1!==s;){var c=e.subarray(0,s);n&&0===c.length||r.push(c),s=(e=e.subarray(s+1)).indexOf(u)}n&&0===e.length||r.push(e)}else for(var l=0;l<e.length;++l)r.push(e.subarray(l,l+1))}function em(e,t,n){for(var r=e.length,a=[],i=0,o=0,u=new Array(r),s=0;s<r;++s){var c=a.length;Jg(e[s],t,n,a);var l=a.length-c;u[s]=l,i+=l,o=Math.max(o,l)}for(var f=Re.util.getArrayFromDType("int32",2*i),d=new Array(i),h=[r,o],p=0,v=0;v<r;++v)for(var g=0;g<u[v];++g)f[2*p]=v,f[2*p+1]=g,d[p]=a[p],++p;return[f,d,h]}var tm={kernelName:Re.StringSplit,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.skipEmpty,a=t.input,o=t.delimiter;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==o.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(o.shape));var u=em(n.data.get(a.dataId).values,n.data.get(o.dataId).values[0],r),s=(0,i.Z)(u,3),c=s[0],l=s[1],f=s[2],d=l.length;return[n.makeTensorInfo([d,2],"int32",c),n.makeTensorInfo([d],"string",l),n.makeTensorInfo([2],"int32",new Int32Array(f))]}};function nm(e,t){for(var n=Re.util.getArrayFromDType("int32",e.length),r=0;r<e.length;++r)n[r]=Re.util.fingerPrint64(e[r]).modulo(t).getLowBitsUnsigned();return n}var rm={kernelName:Re.StringToHashBucketFast,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.numBuckets,a=t.input;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");var i=nm(n.data.get(a.dataId).values,r);return n.makeTensorInfo(a.shape,"int32",i)}},am=Jl(Re.Tan,(function(e){return Math.tan(e)})),im={kernelName:Re.Tan,backendName:"cpu",kernelFunc:am},om=Jl(Re.Tanh,(function(e){return Math.tanh(e)})),um={kernelName:Re.Tanh,backendName:"cpu",kernelFunc:om};function sm(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];for(var a=(0,Re.buffer)(n,e.dtype),i=0;i<a.values.length;++i){for(var o=a.indexToLoc(i),u=new Array(e.rank),s=0;s<u.length;s++)u[s]=o[s]%e.shape[s];var c=e.locToIndex(u);a.values[i]=e.values[c]}return a}var cm={kernelName:Re.Tile,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;Kl(a,"tile");var o=sm(n.bufferSync(a),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}},lm=function(e,t){var n=t.value-e.value;return 0===n?e.index-t.index:n};function fm(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1;r>n;){if(r-n>600){var a=r-n+1,i=t-n+1,o=Math.log(a),u=.5*Math.exp(2*o/3),s=.5*Math.sqrt(o*u*(a-u)/a)*Math.sign(i-a/2),c=Math.max(n,Math.floor(t-i*u/a+s)),l=Math.min(r,Math.floor(t+(a-i)*u/a+s));fm(e,t,c,l)}var f=e[t],d=n,h=r;for(Re.util.swap(e,n,t),lm(e[r],f)>0&&Re.util.swap(e,n,r);d<h;){for(Re.util.swap(e,d,h),d++,h--;lm(e[d],f)<0;)d+=1;for(;lm(e[h],f)>0;)h-=1}0===lm(e[n],f)?Re.util.swap(e,n,h):(h+=1,Re.util.swap(e,h,r)),h<=t&&(n=h+1),t<=h&&(r=h-1)}}function dm(e,t,n,r,a){for(var i=t[t.length-1],o=e.length/i,u=i,s=Re.util.getTypedArrayFromDType(n,o*r),c=Re.util.getTypedArrayFromDType("int32",o*r),l=function(){var t=f*u,n=e.subarray(t,t+u),i=new Array(n.length);n.forEach((function(e,t){return i[t]={value:e,index:t}})),r<i.length&&(fm(i,r),i=i.slice(0,r)),a&&i.sort(lm);for(var o=f*r,l=s.subarray(o,o+r),d=c.subarray(o,o+r),h=0;h<r;h++)l[h]=i[h].value,d[h]=i[h].index},f=0;f<o;f++)l();var d=t.slice();return d[d.length-1]=r,[(0,Re.buffer)(d,n,s),(0,Re.buffer)(d,"int32",c)]}var hm={kernelName:Re.TopK,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.k,u=r.sorted;Kl(a,"topk");var s=dm(n.data.get(a.dataId).values,a.shape,a.dtype,o,u),c=(0,i.Z)(s,2),l=c[0],f=c[1];return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(f.shape,f.dtype,f.values)]}};var pm={kernelName:Re.Transform,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,o=t.transforms,u=n.interpolation,s=n.fillMode,c=n.fillValue,l=n.outputShape,f=(0,i.Z)(a.shape,4),d=f[0],h=f[1],p=f[2],v=f[3],g=null!=l?l:[h,p],m=(0,i.Z)(g,2),y=m[0],b=m[1],x=[d,y,b,v],k=Re.util.computeStrides(a.shape),w=k[0],_=k[1],C=k[2],S=Re.util.computeStrides(x),A=S[0],E=S[1],T=S[2],N=Re.util.getTypedArrayFromDType(a.dtype,Re.util.sizeFromShape(x));N.fill(c);for(var D=r.data.get(a.dataId).values,F=r.data.get(o.dataId).values,I=0;I<d;++I){for(var M=1===o.shape[0]?F:F.subarray(8*I,8*I+8),O=0;O<y;++O)for(var R=0;R<b;++R)for(var Z=0;Z<v;++Z){var B=void 0,z=M[6]*R+M[7]*O+1;if(0!==z){var L=(M[0]*R+M[1]*O+M[2])/z,P=(M[3]*R+M[4]*O+M[5])/z,j=vm(L,p,s),U=vm(P,h,s);switch(u){case"nearest":B=mm(D,h,p,w,_,C,I,U,j,Z,c);break;case"bilinear":B=ym(D,h,p,w,_,C,I,U,j,Z,c);break;default:throw new Error("Error in Transform: Expect 'nearest' or "+"'bilinear', but got ".concat(u))}N[I*A+O*E+R*T+Z]=B}}return r.makeTensorInfo(x,a.dtype,N)}return{dataId:r.write(N,x,a.dtype),shape:a.shape,dtype:a.dtype}}};function vm(e,t,n){switch(n){case"reflect":return function(e,t){var n=e;if(n<0)if(t<=1)n=0;else{var r=2*t;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-t?n+r:-n-1}else if(n>t-1)if(t<=1)n=0;else{var a=2*t;(n-=a*Math.trunc(n/a))>=t&&(n=a-n-1)}return Re.util.clamp(0,n,t-1)}(e,t);case"wrap":return function(e,t){var n=e;if(n<0)if(t<=1)n=0;else{var r=t-1;n+=t*(Math.trunc(-n/r)+1)}else if(n>t-1)if(t<=1)n=0;else{var a=t-1;n-=t*Math.trunc(n/a)}return Re.util.clamp(0,n,t-1)}(e,t);case"nearest":return function(e,t){return Re.util.clamp(0,e,t-1)}(e,t);default:return function(e,t){return e}(e)}}function gm(e,t,n,r,a,i,o,u,s,c,l){return 0<=u&&u<t&&0<=s&&s<n?e[o*r+u*a+s*i+c]:l}function mm(e,t,n,r,a,i,o,u,s,c,l){return gm(e,t,n,r,a,i,o,Math.round(u),Math.round(s),c,l)}function ym(e,t,n,r,a,i,o,u,s,c,l){var f=Math.floor(u),d=Math.floor(s),h=f+1,p=d+1;return(h-u)*((p-s)*gm(e,t,n,r,a,i,o,f,d,c,l)+(s-d)*gm(e,t,n,r,a,i,o,f,p,c,l))+(u-f)*((p-s)*gm(e,t,n,r,a,i,o,h,d,c,l)+(s-d)*gm(e,t,n,r,a,i,o,h,p,c,l))}function bm(e,t,n,r){for(var a=Re.util.parseAxisParam(t,n)[0],i=[1,n[0],1],o=0;o<a;o++)i[0]*=n[o];i[1]=n[a];for(var u=a+1;u<n.length;u++)i[2]*=n[u];for(var s={},c=new Int32Array(n[a]),l=new Re.TensorBuffer(i,r,e),f=[],d=1===i[0]&&1===i[2],h=0;h<n[a];h++){var p=void 0;if(d)p=e[h].toString();else{for(var v=[],g=0;g<i[0];g++)for(var m=0;m<i[2];m++)v.push(l.get(g,h,m));p=v.join(",")}if(void 0!==s[p])c[h]=s[p];else{var y=Object.keys(s).length;s[p]=y,c[h]=y,f.push(h)}}var b=i.slice();b[1]=Object.keys(s).length;var x=new Re.TensorBuffer(b,r);f.forEach((function(e,t){for(var n=0;n<i[0];n++)for(var r=0;r<i[2];r++)x.set(l.get(n,e,r),n,t,r)}));var k=n.slice();return k[a]=b[1],{outputValues:x.values,outputShape:k,indices:c}}var xm={kernelName:Re.Unique,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;Kl(i,"unique");var o=bm(r.data.get(i.dataId).values,a,i.shape,i.dtype),u=o.outputValues,s=o.outputShape,c=o.indices;return[r.makeTensorInfo(s,i.dtype,u),r.makeTensorInfo([c.length],"int32",c)]}};var km={kernelName:Re.Unpack,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a.shape.length,u=a.shape[i],s=new Array(o-1),c=0,l=0;l<o;l++)l!==i&&(s[c++]=a.shape[l]);var f=new Array(o).fill(0),d=a.shape.slice();d[i]=1;for(var h=new Array(u),p=0;p<h.length;p++){f[i]=p;var v=xd({inputs:{x:a},backend:n,attrs:{begin:f,size:d}});h[p]=Rf({inputs:{x:v},backend:n,attrs:{shape:s}}),n.disposeIntermediateTensorInfo(v)}return h}};for(var wm={kernelName:Re.UnsortedSegmentSum,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments;Kl(a,"unsortedSegmentSum");for(var u=[],s=[],c=a.shape.length-i.shape.length,l=i,f=0;f<c;++f){var d=Dh({inputs:{input:l},backend:n,attrs:{dim:f+1}});l=d,s.push(d)}for(var h=0;h<o;++h){var p=Re.util.createScalarValue(h,"int32"),v=n.makeTensorInfo([],"int32",p),g=mh({inputs:{a:v,b:l},backend:n}),m=Ef({inputs:{x:g},backend:n,attrs:{dtype:"float32"}}),y=lh({inputs:{a:m,b:a},backend:n}),b=dh({inputs:{x:y},backend:n,attrs:{axis:0,keepDims:!1}});u.push(b),s.push(v),s.push(g),s.push(m),s.push(y),s.push(b)}var x=Ev({inputs:u,backend:n,attrs:{axis:0}});return s.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),x}},_m=0,Cm=[Lf,jf,Wf,Gf,Of,qf,Kf,$f,Qf,Jf,td,rd,id,sd,ld,pd,vd,gd,md,zf,yd,wd,Sd,Ad,Tf,Nd,Fd,wf,Id,Bd,Ld,Pd,jd,Ud,Wd,Vd,qd,Xd,Yd,Kd,$d,Qd,Jd,th,nh,rh,ah,ih,oh,uh,ph,nf,vh,yh,Ah,Nh,Fh,Oh,Gh,Hh,Xh,$h,ep,tp,np,ap,op,cp,dp,af,hp,Rd,vp,mp,bp,uf,wp,Sp,Ep,Dp,Ip,Rp,Bp,Pp,jp,Up,Gp,Xp,Yp,Kp,$p,Qp,Jp,ev,tv,av,iv,sv,fv,fh,hv,vv,mv,bv,wv,_v,Av,Tv,Nv,Iv,ff,Ov,Lv,Uv,Xv,Kv,Sf,Bh,Qv,hf,vf,Zf,Jv,eg,tg,ng,rg,ag,og,cg,fg,pg,vg,bg,bf,kg,_g,Sg,kd,lv,Tg,Ng,Fg,Mg,Rg,Zg,Bg,zg,jg,Ug,Gg,Hg,Yg,Qg,tm,rm,jh,hh,im,um,cm,hm,pm,Yf,xm,km,wm,Sv];_m<Cm.length;_m++){var Sm=Cm[_m];(0,Re.registerKernel)(Sm)}var Am,Em,Tm,Nm={},Dm={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Fm(e,t){if(!(e in Nm)||null!=t){var n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var n=null==t?function(e){if("undefined"!==typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e):t;n.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete Nm[e]}),!1),(0,Re.env)().getBool("SOFTWARE_WEBGL_ENABLED")&&(Dm.failIfMajorPerformanceCaveat=!1);if(1===e)return n.getContext("webgl",Dm)||n.getContext("experimental-webgl",Dm);return n.getContext("webgl2",Dm)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;Nm[e]=n}var r=Nm[e];return null==r||r.isContextLost()?(delete Nm[e],Fm(e)):(r.disable(r.DEPTH_TEST),r.disable(r.STENCIL_TEST),r.disable(r.BLEND),r.disable(r.DITHER),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SAMPLE_COVERAGE),r.enable(r.SCISSOR_TEST),r.enable(r.CULL_FACE),r.cullFace(r.BACK),Nm[e])}function Im(e,t){return[t,e]}function Mm(e){var t=Re.util.sizeFromShape(e),n=Math.ceil(t/4);return Re.util.sizeToSquarishShape(n)}function Om(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function Rm(e,t){var n,r,a,i,o,u,s,c,l,f,d=e;return 2===(0,Re.env)().getNumber("WEBGL_VERSION")?(n=d.R32F,r=d.R16F,a=d.RGBA16F,i=d.RGBA32F,o=d.RED,s=4,c=1,l=d.HALF_FLOAT,f=d.FLOAT,u=d.RGBA8):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=d.RGBA,o=e.RGBA,s=4,c=4,l=null!=t?t.HALF_FLOAT_OES:null,f=e.FLOAT,u=e.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:u,downloadUnpackNumChannels:s,defaultNumChannels:c,textureTypeHalfFloat:l,textureTypeFloat:f}}function Zm(e,t){var n=t();return(0,Re.env)().getBool("DEBUG")&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(Am||(Am={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Em||(Em={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Tm||(Tm={}));function Bm(e){return!!((0,Re.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function zm(e,t){return $m(e,(function(){return e.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}var Lm,Pm,jm=/ERROR: [0-9]+:([0-9]+):/g;function Um(e,t){var n=jm.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);for(var r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,o=a.map((function(e,t){return Re.util.rightPad((t+1).toString(),i)+e})),u=0,s=0;s<o.length;s++)u=Math.max(o[s].length,u);var c=o.slice(0,r-1),l=o.slice(r-1,r),f=o.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(Re.util.rightPad(l[0],u)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join("\n"))}function Wm(e,t){if(Zm(e,(function(){return e.validateProgram(t)})),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function Vm(e,t,n,r,a,i,o){var u=e.getAttribLocation(t,n);return-1!==u&&(Zm(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),Zm(e,(function(){return e.vertexAttribPointer(u,a,e.FLOAT,!1,i,o)})),Zm(e,(function(){return e.enableVertexAttribArray(u)})),!0)}function Gm(e,t,n){return $m(e,(function(){return e.getUniformLocation(t,n)}),'uniform "'+n+'" not present in program.')}function qm(e,t,n){return e.getUniformLocation(t,n)}function Hm(e,t,n,r){Zm(e,(function(){return function(e,t,n){Qm(e,n),Zm(e,(function(){return e.activeTexture(e.TEXTURE0+n)})),Zm(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)}))}(e,t,r)})),Zm(e,(function(){return e.uniform1i(n,r)}))}function Xm(e,t,n){Zm(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),Zm(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}))}function Ym(e,t){Zm(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)})),Zm(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function Km(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function $m(e,t,n){var r=Zm(e,(function(){return t()}));if(null==r)throw new Error(n);return r}function Qm(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){var a="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(a,"."))}}function Jm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Re.util.sizeFromShape(e.slice(0,e.length-t))}function ey(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function ty(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[Jm(e)].concat((0,o.Z)(ey(e)))),t}function ny(e){return e%2===0}function ry(e,t){if(e=e.slice(-2),t=t.slice(-2),Re.util.arraysEqual(e,t))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(ny(n)&&ny(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&ny(e[0])&&ny(t[0])}function ay(e,t){return null!=e.getExtension(t)}function iy(e){try{if(null!=Fm(e))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function oy(e){if(0===e)return!1;var t=Fm(e);if(1!==e){if(ay(t,"EXT_color_buffer_float"))return uy(t);var n="EXT_color_buffer_half_float";if(ay(t,n)){var r=t.getExtension(n);return function(e,t){var n=Rm(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);var a=1,i=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var u=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),u}(t,r)}return!1}return!!ay(t,"OES_texture_float")&&(!!ay(t,"WEBGL_color_buffer_float")&&uy(t))}function uy(e){var t=Rm(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function sy(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&Re.util.assert("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors ")+"in the WebGL backend."}))}))}var cy=(0,Re.env)();function ly(){var e,t,n,r,a,i,o,u,s,c;return 2===(0,Re.env)().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",u=(0,Re.env)().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",s="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",u="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",s="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:u,defineSpecialInf:s,defineRound:c}}function fy(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=Re.util.computeStrides(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / ").concat(t),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(t):"index -= ".concat(e[a]," * ").concat(t);return"".concat(i,"; ").concat(o,";")})).join("")}function dy(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=Re.util.computeStrides(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / outShapeStrides[").concat(a,"]"),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * outShapeStrides[").concat(a,"]"):"index -= ".concat(e[a]," * outShapeStrides[").concat(a,"]");return"".concat(i,"; ").concat(o,";")})).join("")}function hy(e,t){var n=e.length,r=e.map((function(e){return"".concat(t,"[").concat(e,"]")})),a=new Array(n-1);a[n-2]=r[n-1];for(var i=n-3;i>=0;--i)a[i]="(".concat(a[i+1]," * ").concat(r[i+1],")");return a}function py(e){var t=Re.util.computeStrides(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}cy.registerFlag("HAS_WEBGL",(function(){return cy.getNumber("WEBGL_VERSION")>0})),cy.registerFlag("WEBGL_VERSION",(function(){return iy(2)?2:iy(1)?1:0})),cy.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(function(){return!1})),cy.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===cy.get("WEBGL_VERSION")})),cy.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),cy.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),cy.registerFlag("WEBGL_PACK",(function(){return cy.getBool("HAS_WEBGL")})),cy.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return cy.getBool("WEBGL_PACK")})),cy.registerFlag("WEBGL_PACK_CLIP",(function(){return cy.getBool("WEBGL_PACK")})),cy.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return cy.getBool("WEBGL_PACK")})),cy.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return cy.getBool("WEBGL_PACK")})),cy.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return cy.getBool("WEBGL_PACK")})),cy.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return cy.getBool("WEBGL_PACK")})),cy.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return cy.getBool("WEBGL_PACK")})),cy.registerFlag("WEBGL_PACK_REDUCE",(function(){return cy.getBool("WEBGL_PACK")})),cy.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return cy.getBool("WEBGL_PACK")})),cy.registerFlag("WEBGL_CONV_IM2COL",(function(){return cy.getBool("WEBGL_PACK")})),cy.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return function(e){if(null==Lm){var t=Fm(e);Lm=t.getParameter(t.MAX_TEXTURE_SIZE)}return Lm}(cy.getNumber("WEBGL_VERSION"))})),cy.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return function(e){if(null==Pm){var t=Fm(e);Pm=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Pm)}(cy.getNumber("WEBGL_VERSION"))})),cy.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=cy.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;var t=Fm(e);return ay(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:ay(t,"EXT_disjoint_timer_query")?1:0}(e)})),cy.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return cy.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Re.device_util.isMobile()})),cy.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return function(e){if(0===e)return!1;var t=Fm(e);if(1===e){if(!ay(t,"OES_texture_float"))return!1}else if(!ay(t,"EXT_color_buffer_float"))return!1;return uy(t)}(cy.getNumber("WEBGL_VERSION"))})),cy.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!cy.getBool("WEBGL_FORCE_F16_TEXTURES")&&cy.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),cy.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return oy(cy.getNumber("WEBGL_VERSION"))})),cy.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return 2===(e=cy.getNumber("WEBGL_VERSION"))&&null!=Fm(e).fenceSync;var e})),cy.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return cy.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),cy.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(function(){return-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))})),cy.registerFlag("WEBGL_FLUSH_THRESHOLD",(function(){return Re.device_util.isMobile()?1:-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(e,"."))})),cy.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 128})),cy.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(function(){return!1})),cy.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(function(){return 1e5})),cy.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(function(){return 128})),cy.registerFlag("WEBGL_EXP_CONV",(function(){return!1})),cy.registerFlag("SOFTWARE_WEBGL_ENABLED",(function(){return cy.getBool("IS_TEST")})),cy.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(function(){return 1/0})),cy.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(function(){return!1})),cy.registerFlag("WEBGL2_ISNAN_CUSTOM",(function(){return!1})),cy.registerFlag("ENGINE_COMPILE_ONLY",(function(){return!1}));var vy="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",gy=Re.backend_util.getBroadcastDims;function my(e,t,n){var r=[];if(e.forEach((function(e){var t=Re.util.sizeFromShape(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?r.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(r.push("uniform sampler2D ".concat(e.name,";")),r.push("uniform int offset".concat(e.name,";"))),n.enableShapeUniforms){switch(Zy(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape).uniformShape.length){case 1:r.push("uniform int ".concat(e.name,"Shape;"));break;case 2:r.push("uniform ivec2 ".concat(e.name,"Shape;"));break;case 3:r.push("uniform ivec3 ".concat(e.name,"Shape;"));break;case 4:r.push("uniform ivec4 ".concat(e.name,"Shape;"))}r.push("uniform ivec2 ".concat(e.name,"TexShape;"))}})),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((function(e){r.push("uniform ".concat(e.type," ").concat(e.name).concat(e.arrayIndex?"[".concat(e.arrayIndex,"]"):"",";"))}));var a,i,o=r.join("\n"),u=e.map((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,a="";a+=n?by(e,r):yy(e,r);var i=e.shapeInfo.logicalShape,o=t.logicalShape;i.length<=o.length&&(a+=n?My(e,t):Oy(e,t));return a}(e,t,n.packedInputs,n.enableShapeUniforms)})).join("\n"),s=t.texShape,c=ly(),l=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(c),f=function(e){var t="".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(xy,"\n    ").concat(ky,"\n    ").concat(wy,"\n  ");return t}(c);return t.isPacked?(a=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===r[0])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    ");if(1===r[1])return n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(Re.util.arraysEqual(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(r[0],", ").concat(r[1],"));\n      }\n    ");var a=Math.ceil(e[1]/2);if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[2]/2),i=a*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";for(var r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],a=Math.ceil(e[e.length-1]/2),i=a*Math.ceil(e[e.length-2]/2),o=i,u="",s="b, r, c",c=2;c<e.length-1;c++)o*=e[e.length-c-1],u="\n      int b".concat(c," = index / ").concat(o,";\n      index -= b").concat(c," * ").concat(o,";\n    ")+u,s="b".concat(c,", ")+s;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(r[0],", ").concat(r[1],"));\n      int index = resTexRC.x * ").concat(r[1]," + resTexRC.y;\n\n      ").concat(u,"\n\n      int b = index / ").concat(i,";\n      index -= b * ").concat(i,";\n\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec").concat(e.length,"(").concat(s,");\n    }\n  ")}(e,t,n)}}(t.logicalShape,s,n.enableShapeUniforms),i=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(c)):(a=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){if(1===t[0])return n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    ");if(1===t[1])return n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    ");if(n)return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ";return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t,n);case 2:return function(e,t,n){if(Re.util.arraysEqual(e,t))return n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    ");if(1===e[1])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===e[0])return n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");if(n)return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ";return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t,n);case 3:return function(e,t,n){if(n){var r=dy(["r","c","d"],e);return"\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ".concat(r,"\n    return ivec3(r, c, d);\n  }\n")}var a=fy(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t,n);case 4:return function(e,t,n){if(n){var r=dy(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ".concat(r,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}var a=fy(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(a,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t,n);case 5:return function(e,t){var n=fy(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){var n=fy(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,s,n.enableShapeUniforms),i=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(c)),n.packedInputs&&(f+=_y),[f,l,i,o,a,u,n.userCode].join("\n")}function yy(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.shapeInfo.logicalShape;switch(n.length){case 0:return Sy(e,t);case 1:return Ay(e,t);case 2:return Ey(e,t);case 3:return Ty(e,t);case 4:return Ny(e,t);case 5:return Dy(e);case 6:return Fy(e);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}function by(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=ly();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=ly();if(t)return"\n    vec4 ".concat(r,"(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ");var o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 ".concat(r,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(o[0],", ").concat(o[1],", index);\n      return ").concat(i.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t);case 2:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=i[0],u=i[1],s=ly();if(null!=i&&Re.util.arraysEqual(n,i))return t?"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n\n        return ").concat(s.texture2D,"(").concat(r,", uv);\n      }\n    "):"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(u,".0, ").concat(o,".0);\n\n        return ").concat(s.texture2D,"(").concat(r,", uv);\n      }\n    ");if(t)return"\n    vec4 ".concat(a,"(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ");var c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],l=Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(l,", ").concat(c[0],", ").concat(c[1],", row, col);\n      return ").concat(s.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===n[0]){var u=[1,2],s=By(e,n.slice(1)),c=["b","row","col"];return"\n        ".concat(by(s,t),"\n        vec4 ").concat(a,"(int b, int row, int col) {\n          return ").concat(a,"(").concat(zy(c,u),");\n        }\n      ")}var l=ly();if(t)return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(r,"TexShape[0]) / 2.0), ceil(float(").concat(r,"TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(").concat(r,"Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(r,"Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ");var f=o[0],d=o[1],h=Math.ceil(n[2]/2),p=h*Math.ceil(n[1]/2);return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(f,", ").concat(d,", ").concat(p,", ").concat(h,", b, row, col);\n      return ").concat(l.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e,t);default:return function(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=ly();if(t)return"\n    vec4 ".concat(r,"(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(").concat(n,"Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(").concat(n,"Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ").concat(n,"Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(").concat(n,"TexShape[0]) / 2.0), ceil(float(").concat(n,"TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ");for(var i=e.shapeInfo.logicalShape,o=i.length,u=e.shapeInfo.texShape,s=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],c=s[0],l=s[1],f=Math.ceil(i[o-1]/2),d=f*Math.ceil(i[o-2]/2),h="int b, int row, int col",p="b * ".concat(d," + (row / 2) * ").concat(f," + (col / 2)"),v=2;v<o-1;v++)h="int b".concat(v,", ")+h,d*=i[o-v-1],p="b".concat(v," * ").concat(d," + ")+p;return"\n    vec4 ".concat(r,"(").concat(h,") {\n      int index = ").concat(p,";\n      int texR = index / ").concat(l,";\n      int texC = index - texR * ").concat(l,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(l,", ").concat(c,");\n      return ").concat(a.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e,t)}}var xy="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",ky="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",wy="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",_y="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Cy(e){return"offset".concat(e)}function Sy(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(r,"() {return ").concat(n,";}");var a=(0,i.Z)(e.shapeInfo.texShape,2),o=a[0],u=a[1];if(1===o&&1===u)return"\n      float ".concat(r,"() {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");var s=Cy(n);if(t)return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");var c=(0,i.Z)(e.shapeInfo.texShape,2),l=c[0],f=c[1];return"\n    float ".concat(r,"() {\n      vec2 uv = uvFromFlat(").concat(l,", ").concat(f,", ").concat(s,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function Ay(e,t){var n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int index) {\n        ").concat(Iy(e),"\n      }\n    ");var a=e.shapeInfo.texShape,i=a[0],o=a[1];if(1===o&&1===i)return"\n      float ".concat(r,"(int index) {\n        return sampleTexture(").concat(n,", halfCR);\n      }\n    ");var u=Cy(n);return 1===o?t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(u,") + 0.5) / float(").concat(n,"TexShape[0]));\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(u,") + 0.5) / ").concat(i,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):1===i?t?"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(u,") + 0.5) / float(").concat(n,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):"\n      float ".concat(r,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(u,") + 0.5) / ").concat(o,".0, 0.5);\n        return sampleTexture(").concat(n,", uv);\n      }\n    "):t?"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(n,"TexShape[0], ").concat(n,"TexShape[1], index + ").concat(u,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):"\n    float ".concat(r,"(int index) {\n      vec2 uv = uvFromFlat(").concat(i,", ").concat(o,", index + ").concat(u,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function Ey(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape;if(null!=i&&Re.util.arraysEqual(n,i)){if(t)return"\n      float ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");var o=i[0],u=i[1];return"\n    float ".concat(a,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(u,".0, ").concat(o,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}var s=Re.util.squeezeShape(n),c=s.newShape,l=s.keptDims,f=c;if(f.length<n.length){var d=By(e,f);return"\n      ".concat(yy(d,t),"\n      float ").concat(a,"(int row, int col) {\n        return ").concat(a,"(").concat(zy(["row","col"],l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(Iy(e),"\n      }\n    ");var h=i[0],p=i[1],v=Cy(r);return 1===p?t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(").concat(r,"TexShape[0]));\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(h,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):1===h?t?"\n      float ".concat(a,"(int row, int col) {\n        float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(r,"Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(").concat(r,"TexShape[1]), 0.5);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(p,".0, 0.5);\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):t?"\n      float ".concat(a,"(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(r,"Shape[1] + col + ").concat(v,";\n        vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n  float ".concat(a,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(v,";\n    vec2 uv = uvFromFlat(").concat(h,", ").concat(p,", index);\n    return sampleTexture(").concat(r,", uv);\n  }\n")}function Ty(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],u=Re.util.squeezeShape(n),s=u.newShape,c=u.keptDims,l=s;if(l.length<n.length){var f=By(e,l);return"\n        ".concat(yy(f,t),"\n        float ").concat(a,"(int row, int col, int depth) {\n          return ").concat(a,"(").concat(zy(["row","col","depth"],c),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(i,", ").concat(o,", 1)));\n        ").concat(Iy(e),"\n      }\n    ");var d=e.shapeInfo.texShape,h=d[0],p=d[1],v=e.shapeInfo.flatOffset;if(p===i&&null==v)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        int stride1 = ").concat(r,"Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n        float ".concat(a,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(o,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(p,".0, ").concat(h,".0);\n          return sampleTexture(").concat(r,", uv);\n        }\n      ");if(p===o&&null==v)return t?"\n      float ".concat(a,"(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(").concat(r,"Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n    float ".concat(a,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(p,".0, ").concat(h,".0);\n      return sampleTexture(").concat(r,", uv);\n    }\n  ");var g=Cy(r);return t?"\n    float ".concat(a,"(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ").concat(r,"Shape[1] * ").concat(r,"Shape[2];\n      int stride1 = ").concat(r,"Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ").concat(g,";\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index);\n      return sampleTexture(").concat(r,", uv);\n    }\n    "):"\n      float ".concat(a,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(i," + col * ").concat(o," + depth + ").concat(g,";\n        vec2 uv = uvFromFlat(").concat(h,", ").concat(p,", index);\n        return sampleTexture(").concat(r,", uv);\n      }\n  ")}function Ny(e,t){var n=e.shapeInfo.logicalShape,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,u=n[1]*o,s=Re.util.squeezeShape(n),c=s.newShape,l=s.keptDims;if(c.length<n.length){var f=By(e,c);return"\n      ".concat(yy(f,t),"\n      float ").concat(a,"(int row, int col, int depth, int depth2) {\n        return ").concat(a,"(").concat(zy(["row","col","depth","depth2"],l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(u,", ").concat(o,", ").concat(i,", 1)));\n        ").concat(Iy(e),"\n      }\n    ");var d=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,p=h[0],v=h[1],g="int stride2 = ".concat(r,"Shape[3];"),m="int stride1 = ".concat(r,"Shape[2] * stride2;"),y="int stride0 = ".concat(r,"Shape[1] * stride1;");if(v===u&&null==d)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        ").concat(g,"\n        ").concat(m,"\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(o,", ").concat(i,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(v,".0, ").concat(p,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");if(v===i&&null==d)return t?"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(r,"Shape[1] * ").concat(r,"Shape[2], ").concat(r,"Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(r,"TexShape[1], ").concat(r,"TexShape[0]);\n        return sampleTexture(").concat(r,", uv);\n      }\n    "):"\n      float ".concat(a,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(v,".0, ").concat(p,".0);\n        return sampleTexture(").concat(r,", uv);\n      }\n    ");var b=Cy(r);return t?"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ").concat(g,"\n      ").concat(m,"\n      ").concat(y,"\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(").concat(r,"TexShape[0], ").concat(r,"TexShape[1], index + ").concat(b,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  "):"\n    float ".concat(a,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(o," +\n          depth * ").concat(i," + depth2;\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(v,", index + ").concat(b,");\n      return sampleTexture(").concat(r,", uv);\n    }\n  ")}function Dy(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,o=t[2]*i,u=t[1]*o,s=Re.util.squeezeShape(t),c=s.newShape,l=s.keptDims;if(c.length<t.length){var f=By(e,c);return"\n      ".concat(yy(f),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(zy(["row","col","depth","depth2","depth3"],l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(u,", ").concat(o,", ").concat(i,", ").concat(a,")) +\n          depth3;\n        ").concat(Iy(e),"\n      }\n    ");var d=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,p=h[0],v=h[1];if(v===u&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(o,", ").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(v,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(v===a&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(v,".0, ").concat(p,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var g=Cy(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(o," + depth * ").concat(i," +\n          depth2 * ").concat(a," + depth3 + ").concat(g,";\n      vec2 uv = uvFromFlat(").concat(p,", ").concat(v,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function Fy(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=Re.util.squeezeShape(t),i=a.newShape,o=a.keptDims;if(i.length<t.length){var u=By(e,i);return"\n      ".concat(yy(u),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(zy(["row","col","depth","depth2","depth3","depth4"],o),");\n      }\n    ")}var s=t[5],c=t[4]*s,l=t[3]*c,f=t[2]*l,d=t[1]*f;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(d,", ").concat(f,", ").concat(l,", ").concat(c,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(s,", 1)));\n        ").concat(Iy(e),"\n      }\n    ");var h=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,v=p[0],g=p[1];if(g===d&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(f,", ").concat(l,", ").concat(c,", ").concat(s,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(g===s&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var m=Cy(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(d," + col * ").concat(f," + depth * ").concat(l," +\n          depth2 * ").concat(c," + depth3 * ").concat(s," + depth4 + ").concat(m,";\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(g,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}function Iy(e){var t=e.name,n=Re.util.sizeFromShape(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function My(e,t){var n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",o=e.shapeInfo.logicalShape.length,u=t.logicalShape.length,s=gy(e.shapeInfo.logicalShape,t.logicalShape),c=Ry(u),l=u-o,f=["x","y","z","w","u","v"];n=0===o?"":u<2&&s.length>=1?"coords = 0;":s.map((function(e){return"coords.".concat(f[e+l]," = 0;")})).join("\n");var d="";d=u<2&&o>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(f[t+l])})).join(", ");var h="return outputValue;",p=1===Re.util.sizeFromShape(e.shapeInfo.logicalShape),v=1===Re.util.sizeFromShape(t.logicalShape);if(1!==o||p||v){if(p&&!v)h=1===u?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(s.length){var g=o-2,m=o-1;s.indexOf(g)>-1&&s.indexOf(m)>-1?h="return vec4(outputValue.x);":s.indexOf(g)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(m)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}}else h="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(i,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(a,"(").concat(d,");\n      ").concat(h,"\n    }\n  ")}function Oy(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,o=e.shapeInfo.texShape,u=e.shapeInfo.logicalShape.length,s=t.logicalShape.length;if(!e.shapeInfo.isUniform&&u===s&&null==e.shapeInfo.flatOffset&&Re.util.arraysEqual(o,i))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var c,l=Ry(s),f=gy(e.shapeInfo.logicalShape,t.logicalShape),d=s-u,h=["x","y","z","w","u","v"];c=0===u?"":s<2&&f.length>=1?"coords = 0;":f.map((function(e){return"coords.".concat(h[e+d]," = 0;")})).join("\n");var p="";return p=s<2&&u>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(h[t+d])})).join(", "),"\n    float ".concat(a,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(c,"\n      return get").concat(r,"(").concat(p,");\n    }\n  ")}function Ry(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function Zy(e,t,n){var r=Re.util.squeezeShape(t),a=r.newShape,i=r.keptDims,o=t.length,u=e&&3===o&&1===t[0],s=u?t.slice(1):a,c=!e&&o>1&&!Re.util.arraysEqual(t,n)&&a.length<o||u;return{useSqueezeShape:c,uniformShape:c?s:t,keptDims:i}}function By(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function zy(e,t){return t.map((function(t){return e[t]})).join(", ")}function Ly(e,t,n,r){var a=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),i=a.map((function(e){return e.shapeInfo})),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=my(a,o,t),s=function(e,t){var n=$m(e,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(Zm(e,(function(){return e.shaderSource(n,t)})),Zm(e,(function(){return e.compileShader(n)})),(0,Re.env)().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw Um(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(e.gl,u),c=e.createProgram(s);return(0,Re.env)().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:s,source:u,webGLProgram:c,inShapeInfos:i,outShapeInfo:o,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:t,fragmentShader:s,source:u,webGLProgram:c,inShapeInfos:i,outShapeInfo:o},Py(e,t,c))}function Py(e,t,n){var r,a,i,o,u={},s={},c={},l=[],f=null;o=e.getUniformLocation(n,"NAN",!1),1===(0,Re.env)().getNumber("WEBGL_VERSION")&&(f=e.getUniformLocation(n,"INFINITY",!1));for(var d=!1,h=0;h<t.variableNames.length;h++){var p=t.variableNames[h];u[p]=e.getUniformLocation(n,p,d),u["offset".concat(p)]=e.getUniformLocation(n,"offset".concat(p),d),t.enableShapeUniforms&&(s["".concat(p,"Shape")]=e.getUniformLocation(n,"".concat(p,"Shape"),d),c["".concat(p,"TexShape")]=e.getUniformLocation(n,"".concat(p,"TexShape"),d))}return t.enableShapeUniforms&&(r=e.getUniformLocation(n,"outShape",d),i=e.getUniformLocation(n,"outShapeStrides",d),a=e.getUniformLocation(n,"outTexShape",d)),t.customUniforms&&t.customUniforms.forEach((function(t,r){l[r]=e.getUniformLocation(n,t.name,d)})),{uniformLocations:u,customUniformLocations:l,infLoc:f,nanLoc:o,inShapesLocations:s,inTexShapesLocations:c,outShapeLocation:r,outShapeStridesLocation:i,outTexShapeLocation:a}}function jy(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((function(e,n){var r=e.logicalShape,a=t[n],i=a.shape;if(!Re.util.arraysEqual(r,i))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(i," must match"));if(!e.isUniform||!a.isUniform){var o=e.texShape,u=a.isUniform?null:a.texData.texShape;if(!Re.util.arraysEqual(o,u))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(o," and ").concat(u," must match"))}}))}function Uy(e,t,n,r,a){t.program.enableShapeUniforms||(jy(t.inShapeInfos,n),jy([t.outShapeInfo],[r]));var i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):e.setOutputMatrixTexture(i.texture,o[0],o[1]),e.setProgram(t.webGLProgram),1===(0,Re.env)().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,r){var a=t.program.variableNames[r],i=t.uniformLocations[a],o=t.uniformLocations["offset".concat(a)],u=t.inShapesLocations["".concat(a,"Shape")],s=t.inTexShapesLocations["".concat(a,"TexShape")];if(u){var c=Zy(t.program.packedInputs,n.shape,n.texData.texShape).uniformShape;switch(c.length){case 1:e.gl.uniform1iv(u,new Int32Array(c));break;case 2:e.gl.uniform2iv(u,new Int32Array(c));break;case 3:e.gl.uniform3iv(u,new Int32Array(c));break;case 4:e.gl.uniform4iv(u,new Int32Array(c))}}if(s&&e.gl.uniform2i(s,n.texData.texShape[0],n.texData.texShape[1]),null!=i)if(n.isUniform)if(Re.util.sizeFromShape(n.shape)<2)e.gl.uniform1f(i,n.uniformValues[0]);else{var l=n.uniformValues;l instanceof Float32Array||(l=new Float32Array(l)),e.gl.uniform1fv(i,l)}else null!=n.texData.slice&&null!=o&&e.gl.uniform1i(o,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture.texture,i,r)}));var u=t.outShapeLocation;if(u)switch(r.shape.length){case 1:e.gl.uniform1iv(u,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(u,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(u,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(u,new Int32Array(r.shape))}if(t.outShapeStridesLocation){var s=Re.util.computeStrides(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(s));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(s));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(s))}}t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&a&&t.program.customUniforms.forEach((function(n,r){var i=t.customUniformLocations[r],o=a[r];if("float"===n.type)e.gl.uniform1fv(i,o);else if("vec2"===n.type)e.gl.uniform2fv(i,o);else if("vec3"===n.type)e.gl.uniform3fv(i,o);else if("vec4"===n.type)e.gl.uniform4fv(i,o);else if("int"===n.type)e.gl.uniform1iv(i,o);else if("ivec2"===n.type)e.gl.uniform2iv(i,o);else if("ivec3"===n.type)e.gl.uniform3iv(i,o);else{if("ivec4"!==n.type)throw Error("uniform type ".concat(n.type," is not supported yet."));e.gl.uniform4iv(i,o)}})),e.executeProgram()}function Wy(e,t,n){var r="";t.concat(n).forEach((function(t){var a=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){var i=t.texData.texShape,o=Zy(e.packedInputs,t.shape,i),u=o.useSqueezeShape,s=o.uniformShape,c=o.keptDims,l="",f="",d="";if(1===s.length&&e.packedInputs){var h=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];l="".concat(h[0]>1,"_").concat(h[1]>1)}else if(2!==s.length||e.packedInputs){if(s.length>2&&!e.packedInputs){var p=Re.util.computeStrides(s);d="".concat(p[0]===i[1],"_").concat(p[p.length-1]===i[1])}}else f="".concat(s[0]>1,"_").concat(s[1]>1);var v=t.shape.length,g=2===s.length&&Re.util.arraysEqual(t.shape,i),m=1===Re.util.sizeFromShape(t.shape),y=Re.backend_util.getBroadcastDims(t.shape,n.shape),b=!e.packedInputs&&v===n.shape.length&&Re.util.arraysEqual(i,n.texData.texShape),x=e.packedInputs||s.length>2?"":"".concat(i[0]>1,"_").concat(i[1]>1);r+="".concat(v,"_").concat(b,"_").concat(u?c:"","_").concat(s.length,"_").concat(m,"_").concat(y,"_").concat(g,"_").concat(l,"_").concat(f,"_").concat(d,"_").concat(x,"_").concat(a)}else{var k=t.isUniform?"uniform":t.texData.texShape;r+="".concat(t.shape,"_").concat(k,"_").concat(a)}}));var a=e.userCode,i=e.constructor.name;return i+="_"+r+"_"+a+"".concat((0,Re.env)().getNumber("WEBGL_VERSION"))}function Vy(e){return(0,Re.env)().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}var Gy=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Am.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];var n=ly();this.outputShape=t,this.enableShapeUniforms=Vy(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?dy(["r","c","d"],t):fy(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),qy=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Am.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];var n=ly();this.outputShape=t,this.enableShapeUniforms=Vy(this.outputShape.length),this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(this.enableShapeUniforms?dy(["r","c","d"],t):fy(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),Hy=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["A"],this.outTexUsage=Em.DOWNLOAD;var n=ly();this.outputShape=t,this.userCode="\n      ".concat(vy,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),Xy=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Em.DOWNLOAD;var n=ly();this.outputShape=t,this.userCode="\n      ".concat(vy,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),Yy={R:0,G:1,B:2,A:3},Ky=(0,s.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"RGBA";(0,u.Z)(this,e),this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];var a=ly();this.outputShape=t,this.enableShapeUniforms=Vy(this.outputShape.length);var i="result";n&&(i="floor(result * 255. + 0.5)");for(var o="",s=0;s<r.length;s++){var c=r[s];o+="\n          if(offset == ".concat(s,") {\n            result = values[").concat(Yy[c],"];\n          }")}this.userCode="\n      ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":py(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int flatIndex = getFlatIndex(coords);\n        float result = 0.;\n        int offset = imod(flatIndex, ").concat(r.length,");\n\n        flatIndex = idiv(flatIndex, ").concat(r.length,", 1.);\n\n        int r = flatIndex / texShape[1];\n        if (r < texShape[0]) {\n          int c = imod(flatIndex, texShape[1]);\n          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n          vec4 values = ").concat(a.texture2D,"(A, uv);\n          ").concat(o,"\n        }\n        ").concat(a.output," = vec4(").concat(i,", 0., 0., 0.);\n      }\n    ")})),$y=(0,s.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,u.Z)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];var r=ly();this.outputShape=t,this.enableShapeUniforms=Vy(this.outputShape.length);var a="",i="result";n&&(i="floor(result * 255. + 0.5)");for(var o=0;o<=1;o++)for(var s=0;s<=1;s++){var c=2*o+s;a+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(s," < ").concat(this.enableShapeUniforms?"outShape[2]":"".concat(t[2]),") {\n          localCoords[2] += ").concat(s,";\n          if (localCoords[1] + ").concat(o," < ").concat(this.enableShapeUniforms?"outShape[1]":"".concat(t[1]),") {\n            localCoords[1] += ").concat(o,";\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ").concat(r.texture2D,"(A, uv);\n\n            if (offset == 0) {\n              result[").concat(c,"] = values[0];\n            } else if (offset == 1) {\n              result[").concat(c,"] = values[1];\n            } else if (offset == 2) {\n              result[").concat(c,"] = values[2];\n            } else {\n              result[").concat(c,"] = values[3];\n            }\n          }\n        }\n        ")}this.userCode="\n        ".concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":py(t),"\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ").concat(a,"\n\n          ").concat(r.output," = ").concat(i,";\n        }\n    ")}));function Qy(e){var t=ly();return function(e,t){var n=$m(e,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(Zm(e,(function(){return e.shaderSource(n,t)})),Zm(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function Jy(e){return function(e,t){var n=$m(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return Zm(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),Zm(e,(function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function eb(e){return function(e,t){var n=$m(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return Zm(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)})),Zm(e,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Uint16Array([0,1,2,2,1,3]))}function tb(e,t,n,r,a,i){!function(e,t){var n=(0,Re.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){var a="[".concat(e,"x").concat(t,"]"),i="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+i+".")}}(t,n);var o=function(e){return $m(e,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}(e),u=e.TEXTURE_2D;return Zm(e,(function(){return e.bindTexture(u,o)})),Zm(e,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),Zm(e,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),Zm(e,(function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)})),Zm(e,(function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)})),1===(0,Re.env)().getNumber("WEBGL_VERSION")?Zm(e,(function(){return e.texImage2D(u,0,r,t,n,0,a,i,null)})):Zm(e,(function(){return e.texStorage2D(u,1,r,t,n)})),Zm(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),{texture:o,texShape:[n,t]}}function nb(e){return e.internalFormatFloat}function rb(e){return e.internalFormatHalfFloat}function ab(e){return e.downloadTextureFormat}function ib(e){return e.internalFormatPackedFloat}function ob(e){return e.internalFormatPackedHalfFloat}function ub(e,t,n,r,a,o,u,s){var c=e,l=new Float32Array(function(e,t){var n=Om(e,t),r=(0,i.Z)(n,2);return r[0]*r[1]*4}(o,u));return c.bindBuffer(c.PIXEL_PACK_BUFFER,t),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,l),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),l}var sb=function(){function e(t){(0,u.Z)(this,e),this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];var n=(0,Re.env)().getNumber("WEBGL_VERSION");if(null!=t?(this.gl=t,function(e,t){Nm[e]=t}(n,t)):this.gl=Fm(n),t=this.gl,2===(0,Re.env)().getNumber("WEBGL_VERSION")){var r=t;this.createVertexArray=function(){return Zm(r,(function(){return r.createVertexArray()}))},this.bindVertexArray=function(e){return Zm(r,(function(){return r.bindVertexArray(e)}))},this.deleteVertexArray=function(e){return Zm(r,(function(){return r.deleteVertexArray(e)}))},this.getVertexArray=function(){return Zm(r,(function(){return r.getParameter(r.VERTEX_ARRAY_BINDING)}))}}else if(null!=t){var a=t.getExtension("OES_vertex_array_object");if(null==a)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=function(){return Zm(t,(function(){return a.createVertexArrayOES()}))},this.bindVertexArray=function(e){return Zm(t,(function(){return a.bindVertexArrayOES(e)}))},this.deleteVertexArray=function(e){return Zm(t,(function(){return a.deleteVertexArrayOES(e)}))},this.getVertexArray=function(){return Zm(t,(function(){return t.getParameter(a.VERTEX_ARRAY_BINDING_OES)}))}}var i="WEBGL_color_buffer_float",o="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===(0,Re.env)().getNumber("WEBGL_VERSION")){var s="OES_texture_half_float";if(this.textureFloatExtension=zm(this.gl,"OES_texture_float"),ay(this.gl,s))this.textureHalfFloatExtension=zm(this.gl,s);else if((0,Re.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(i),ay(this.gl,o))this.colorBufferHalfFloatExtension=zm(this.gl,o);else if((0,Re.env)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(i="EXT_color_buffer_float",ay(this.gl,i))this.colorBufferFloatExtension=this.gl.getExtension(i);else{if(!ay(this.gl,o))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(o)}this.vertexBuffer=Jy(this.gl),this.indexBuffer=eb(this.gl),this.framebuffer=function(e){return $m(e,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=Rm(this.gl,this.textureHalfFloatExtension)}return(0,s.Z)(e,[{key:"debug",get:function(){return(0,Re.env)().getBool("DEBUG")}},{key:"dispose",value:function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;Zm(t,(function(){return t.finish()})),Zm(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),Zm(t,(function(){return t.deleteFramebuffer(e.framebuffer)})),Zm(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),Zm(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),Zm(t,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}}},{key:"createFloat32MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=Im(t,n),o=(0,i.Z)(a,2);return tb(e,o[0],o[1],nb(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"createFloat16MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=Im(t,n),o=(0,i.Z)(a,2);return tb(e,o[0],o[1],rb(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createUnsignedBytesMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=Im(t,n),o=(0,i.Z)(a,2);return tb(e,o[0],o[1],ab(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}},{key:"uploadPixelDataToTexture",value:function(e,t){this.throwIfDisposed(),function(e,t,n){Zm(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),n.data instanceof Uint8Array?2===(0,Re.env)().getNumber("WEBGL_VERSION")?Zm(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)})):Zm(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)})):2===(0,Re.env)().getNumber("WEBGL_VERSION")?Zm(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)})):Zm(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)})),Zm(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t)}},{key:"uploadDenseMatrixToTexture",value:function(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,i){var o,u,s;Zm(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),a instanceof Uint8Array?(o=new Uint8Array(n*r*4),u=e.UNSIGNED_BYTE,s=e.RGBA):(o=new Float32Array(n*r*4),u=e.FLOAT,s=i.internalFormatPackedFloat),o.set(a),2===(0,Re.env)().getNumber("WEBGL_VERSION")?Zm(e,(function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,u,o)})):Zm(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,s,n,r,0,e.RGBA,u,o)})),Zm(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t,n,r,this.textureConfig)}},{key:"createFloat16PackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=Om(t,n),o=(0,i.Z)(a,2);return tb(e,o[0],o[1],ob(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createPackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=Om(t,n),o=(0,i.Z)(a,2);return tb(e,o[0],o[1],ib(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"deleteMatrixTexture",value:function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(Ym(this.gl,this.framebuffer),this.outputTexture=null),Zm(this.gl,(function(){return t.gl.deleteTexture(e)}))}},{key:"downloadByteEncodedFloatMatrixFromOutputTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n,r){var a=Im(t,n),o=(0,i.Z)(a,2),u=o[0],s=o[1],c=new Uint8Array(t*n*4);return Zm(e,(function(){return e.readPixels(0,0,u,s,r.downloadTextureFormat,e.UNSIGNED_BYTE,c)})),new Float32Array(c.buffer)}(r.gl,t,n,r.textureConfig)}))}},{key:"downloadPackedMatrixFromBuffer",value:function(e,t,n,r,a,i){return ub(this.gl,e,0,0,0,a,i,this.textureConfig)}},{key:"downloadFloat32MatrixFromBuffer",value:function(e,t){return function(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}},{key:"createBufferFromTexture",value:function(e,t,n){this.bindTextureToFrameBuffer(e);var r=function(e,t,n,r){var a=e.createBuffer();Zm(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)}));var i=16*t*n;return Zm(e,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)})),Zm(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)})),Zm(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),a}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}},{key:"createAndWaitForFence",value:function(){var e=this.createFence(this.gl);return this.pollFence(e)}},{key:"createFence",value:function(e){var t,n,r=this;if((0,Re.env)().getBool("WEBGL_FENCE_API_ENABLED")){var a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=a.clientWaitSync(i,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=i}else(0,Re.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,(0,Re.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}}},{key:"downloadMatrixFromPackedTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n){var r=new Float32Array(t*n*4);return Zm(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)})),r}(r.gl,t,n)}))}},{key:"createProgram",value:function(e){var t=this;this.throwIfDisposed();var n=this.gl;null==this.vertexShader&&(this.vertexShader=Qy(n));var r,a=function(e){return $m(e,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}(n);return Zm(n,(function(){return n.attachShader(a,t.vertexShader)})),Zm(n,(function(){return n.attachShader(a,e)})),function(e,t){if(Zm(e,(function(){return e.linkProgram(t)})),!(0,Re.env)().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(n,a),r=Object.assign(a,{vao:this.createVertexArray()}),this.bindVertexArray(r.vao),Zm(n,(function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.indexBuffer)})),console.assert(function(e,t,n){return Zm(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),Vm(e,t,"clipSpacePos",n,3,20,0)&&Vm(e,t,"uv",n,2,20,12)}(n,r,this.vertexBuffer),"gpgpu_util.bindVertexProgramAttributeStreams not fully successful."),this.debug&&Wm(n,r),this.setProgram(r),r}},{key:"deleteProgram",value:function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&(Zm(this.gl,(function(){return t.gl.deleteProgram(e)})),this.deleteVertexArray(e.vao))}},{key:"setProgram",value:function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&(this.bindVertexArray(this.program.vao),this.debug&&Wm(this.gl,this.program)),Zm(this.gl,(function(){return t.gl.useProgram(e)}))}},{key:"getUniformLocation",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?Gm(this.gl,e,t):qm(this.gl,e,t)}},{key:"getAttributeLocation",value:function(e,t){var n=this;return this.throwIfDisposed(),Zm(this.gl,(function(){return n.gl.getAttribLocation(e,t)}))}},{key:"getUniformLocationNoThrow",value:function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}},{key:"setInputMatrixTexture",value:function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),Hm(this.gl,e,t,n)}},{key:"setOutputMatrixTexture",value:function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}},{key:"setOutputPackedMatrixTexture",value:function(e,t,n){this.throwIfDisposed();var r=Om(t,n),a=(0,i.Z)(r,2),o=a[0],u=a[1];this.setOutputMatrixTextureDriver(e,o,u)}},{key:"setOutputMatrixWriteRegion",value:function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}},{key:"setOutputPackedMatrixWriteRegion",value:function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}},{key:"debugValidate",value:function(){null!=this.program&&Wm(this.gl,this.program),Km(this.gl)}},{key:"executeProgram",value:function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;if(this.debug){var t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}Zm(e,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))}},{key:"blockUntilAllProgramsCompleted",value:function(){var e=this;this.throwIfDisposed(),Zm(this.gl,(function(){return e.gl.finish()}))}},{key:"getQueryTimerExtension",value:function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=zm(this.gl,2===(0,Re.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}},{key:"getQueryTimerExtensionWebGL2",value:function(){return this.getQueryTimerExtension()}},{key:"getQueryTimerExtensionWebGL1",value:function(){return this.getQueryTimerExtension()}},{key:"beginQuery",value:function(){if(2===(0,Re.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a}},{key:"endQuery",value:function(){if(2!==(0,Re.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}}},{key:"waitForQueryAndGetTime",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){var n=this;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Re.util.repeatedTry((function(){return n.disposed||n.isQueryAvailable(t,(0,Re.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}));case 2:return e.abrupt("return",this.getQueryTime(t,(0,Re.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQueryTime",value:function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}},{key:"isQueryAvailable",value:function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}var i=this.getQueryTimerExtensionWebGL1(),o=i.getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}},{key:"pollFence",value:function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))}},{key:"pollItems",value:function(){for(var e=function(e){for(var t=0;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t){(0,this.itemsToPoll[t].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}},{key:"addItemToPoll",value:function(e,t){var n=this;if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),!(this.itemsToPoll.length>1)){var r=void 0;"setTimeoutCustom"in(0,Re.env)().platform&&(r=(0,Re.env)().platform.setTimeoutCustom.bind((0,Re.env)().platform)),Re.util.repeatedTry((function(){return n.pollItems(),0===n.itemsToPoll.length}),(function(){return 0}),null,r)}}},{key:"bindTextureToFrameBuffer",value:function(e){this.throwIfDisposed(),Xm(this.gl,e,this.framebuffer),this.debug&&Km(this.gl)}},{key:"unbindTextureToFrameBuffer",value:function(){null!=this.outputTexture?(Xm(this.gl,this.outputTexture,this.framebuffer),this.debug&&Km(this.gl)):Ym(this.gl,this.framebuffer)}},{key:"downloadMatrixDriver",value:function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n}},{key:"setOutputMatrixTextureDriver",value:function(e,t,n){this.throwIfDisposed();var r=this.gl;Xm(r,e,this.framebuffer),this.debug&&Km(r),this.outputTexture=e,Zm(r,(function(){return r.viewport(0,0,t,n)})),Zm(r,(function(){return r.scissor(0,0,t,n)}))}},{key:"setOutputMatrixWriteRegionDriver",value:function(e,t,n,r){var a=this;this.throwIfDisposed(),Zm(this.gl,(function(){return a.gl.scissor(e,t,n,r)}))}},{key:"throwIfDisposed",value:function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}},{key:"throwIfNoProgram",value:function(){if(null==this.program)throw new Error("No GPU program is currently set.")}}]),e}();var cb=Ff,lb=_d,fb=Cd,db=Af,hb=Ed,pb=Md,vb=gh,gb=Eh,mb=Ih,yb=Yh,bb=rp,xb=ip,kb=up,wb=lp,_b=xp,Cb=_p,Sb=Ap,Ab=Tp,Eb=Wp,Tb=qp,Nb=nv,Db=sh,Fb=dv,Ib=xv,Mb=Mv,Ob=zv,Rb=jv,Zb=Hv,Bb=Yv,zb=ug,Lb=lg,Pb=mf,jb=Pf,Ub=bd,Wb=Dg,Vb=Ig,Gb=Og,qb=Lg,Hb=Xg,Xb=$g,Yb=em,Kb=nm,$b=zh,Qb=sm,Jb=dm,ex=Hf,tx=bm;function nx(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return"".concat(e,".").concat(t)}))}function rx(e,t){return 1===t?[e]:nx(e,t)}var ax=function(){function e(t){if((0,u.Z)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=Vy(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=rx("rc",this.rank),r=Ry(this.rank),a=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode="\n        void main() {\n          ".concat(r," rc = getOutputCoords();\n\n          if(").concat(a,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(i,"\n\n            setOutput(vec4(").concat(o,"));\n          }\n        }\n      ")}}return(0,s.Z)(e,[{key:"getSourceCoordsArr",value:function(e){for(var t=[],n=0;n<=1;n++)for(var r=0;r<=1;r++){for(var a="".concat(0===n?"r":"rp1",", ").concat(0===r?"c":"cp1"),i=2;i<this.rank;i++)a="".concat(e[e.length-1-i],",")+a;t.push(a)}return t}},{key:"getOutOfBoundsCondition",value:function(e){if(1===this.rank)return"rc > ".concat(this.enableShapeUniforms?"outShape":this.outputShape[0]);for(var t="",n=this.rank-2;n<this.rank;n++)t+="".concat(e[n]," >= ").concat(this.enableShapeUniforms?"outShape[".concat(n,"]"):this.outputShape[n]),n<this.rank-1&&(t+="||");return t}},{key:"getSetup",value:function(e){if(1===this.rank)return"";var t=e.slice(-2),n=this.enableShapeUniforms?"outShape[".concat(this.rank," - 1]"):this.outputShape[this.rank-1],r=this.enableShapeUniforms?"outShape[".concat(this.rank," - 2]"):this.outputShape[this.rank-2];return"\n      int r = ".concat(t[0],";\n      int c = ").concat(t[1],";\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ").concat(n,";\n      bool rEdge = rp1 >= ").concat(r,";\n    ")}},{key:"getOutput",value:function(e){var t=this.getSourceCoordsArr(e);if(1===this.rank){var n=this.enableShapeUniforms?"outShape":this.outputShape[0];return"getA(rc), (rc + 1 >= ".concat(n," ? 0. : getA(rc + 1)), 0, 0")}return"getA(".concat(t[0],"),\n            cEdge ? 0. : getA(").concat(t[1],"),\n            rEdge ? 0. : getA(").concat(t[2],"),\n            rEdge || cEdge ? 0. : getA(").concat(t[3],")")}}]),e}(),ix=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=Vy(this.outputShape.length);for(var r="",a=0;a<4;a++){var i="thisRC = rc;";a%2===1&&(i+="thisRC.z += 1;"),a>1&&(i+="thisRC.y += 1;"),r+="\n        ".concat(i,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e,t){var n=t?function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=e.map((function(e,t){return t})),a=hy(r,t);return a.map((function(t,r){var i="int ".concat(e[r]," = ").concat(n," / ").concat(a[r]),o=r===a.length-1?"int ".concat(e[r+1]," = ").concat(n," - ").concat(e[r]," * ").concat(a[r]):"index -= ".concat(e[r]," * ").concat(a[r]);return"".concat(i,"; ").concat(o,";")})).join("")}(["r","c","d"],"inputShape"):fy(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(n,this.enableShapeUniforms),"\n      ").concat(this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":py(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(this.enableShapeUniforms?"outShape[1]":t[1],";\n        int cols = ").concat(this.enableShapeUniforms?"outShape[2]":t[2],";\n\n        ").concat(r,"\n\n        setOutput(result);\n      }\n    ")}));var ox=function(){function e(t){(0,u.Z)(this,e),this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return(0,s.Z)(e,[{key:"acquireTexture",value:function(e,t,n){var r=sx(t,n),a=cx(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);var i,o=ux(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();var u=this.freeTextures[a].shift();return this.usedTextures[a].push(u),u}return r===Tm.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Tm.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Tm.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Tm.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Tm.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),i}},{key:"releaseTexture",value:function(e,t,n,r){if(null!=this.freeTextures){var a=sx(n,r),i=cx(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);var o=ux(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),u=(0,Re.env)().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==u&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;var s=this.usedTextures[i],c=s.indexOf(e);if(c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(c,1),this.log()}}},{key:"log",value:function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));var t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}}},{key:"numBytesAllocated",get:function(){return this._numBytesAllocated}},{key:"numBytesFree",get:function(){return this._numBytesFree}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t.texture)}));for(var n in this.usedTextures)this.usedTextures[n].forEach((function(t){e.gpgpu.deleteMatrixTexture(t.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}]),e}();function ux(e,t,n,r,a){var o,u=function(e,t){switch(e){case Tm.PACKED_2X2_FLOAT32:return ib(t);case Tm.PACKED_2X2_FLOAT16:return ob(t);case Tm.UNPACKED_FLOAT32:return nb(t);case Tm.UNPACKED_FLOAT16:return rb(t);case Tm.PACKED_4X1_UNSIGNED_BYTE:return ab(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,r);if(a){var s=Om(e[0],e[1]),c=(0,i.Z)(s,2);o=c[0]*c[1]}else{var l=Im(e[0],e[1]),f=(0,i.Z)(l,2);o=f[0]*f[1]}var d=function(e,t){var n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error("Unknown internal format ".concat(t))}(n,u);return o*d}function sx(e,t){if(e===Em.UPLOAD)return Tm.PACKED_2X2_FLOAT32;if(e===Em.RENDER||null==e)return function(e){return(0,Re.env)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Tm.PACKED_2X2_FLOAT32:Tm.UNPACKED_FLOAT32:e?Tm.PACKED_2X2_FLOAT16:Tm.UNPACKED_FLOAT16}(t);if(e===Em.DOWNLOAD||e===Em.PIXELS)return Tm.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function cx(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}var lx=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=Vy(this.outputShape.length),this.userCode="\n      float unaryOperation(float x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),fx="if (isnan(x)) return x;",dx="return x;",hx="return abs(x);";var px="return (x >= 0.0) ? x : (exp(x) - 1.0);",vx=fx+"\n  return (x < 0.0) ? 0.0 : x;\n",gx=fx+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",mx="return x;",yx="return 1.0 / (1.0 + exp(-1.0 * x));",bx="return x;",xx="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",kx="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",wx="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",_x="return 1.0 / (1.0 + exp(-1.0 * x));",Cx=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=Vy(this.outputShape.length),this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),Sx=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=Vy(this.outputShape.length);var n=t.length,r=rx("rc",n),a=Ry(n),i=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(n,r),o=r.slice(-2),s=n<=1?"rc":"vec2(".concat(o.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(i,");\n\n        setOutput(getChannel(packedInput, ").concat(s,"));\n      }\n    ")})),Ax=Re.kernel_impls.whereImpl,Ex={};var Tx=(0,Re.env)().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");var Nx=function(e){(0,c.Z)(n,e);var t=(0,l.Z)(n);function n(e){var r,a,i;if((0,u.Z)(this,n),(r=t.call(this)).pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.lastGlFlushTime=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!(0,Re.env)().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null!=e){if(e instanceof sb)a=e;else{var o=Fm((0,Re.env)().getNumber("WEBGL_VERSION"),e);a=new sb(o)}r.binaryCache={},r.gpgpuCreatedLocally=!1}else{var s=Fm((0,Re.env)().getNumber("WEBGL_VERSION"));a=new sb(s),r.binaryCache=((i=(0,Re.env)().getNumber("WEBGL_VERSION"))in Ex||(Ex[i]={}),Ex[i]),r.gpgpuCreatedLocally=!0}return r.gpgpu=a,r.canvas=r.gpgpu.gl.canvas,r.textureManager=new ox(r.gpgpu),r.numMBBeforeWarning=null==(0,Re.env)().global.screen?1024:(0,Re.env)().global.screen.height*(0,Re.env)().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new Re.DataStorage((0,ra.Z)(r),(0,Re.engine)()),r}return(0,s.Z)(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"numDataIds",value:function(){return this.texData.numDataIds()-this.pendingDeletes}},{key:"writeTexture",value:function(e,t,n,r,a,i){var o=this.makeTensorInfo(t,n),u=this.texData.get(o.dataId);u.isPacked=!1,u.texture={texture:e,texShape:[r,a]},u.texShape=[r,a];var s=ty(t),c=new Ky(s,!1,i),l=this.runWebGLProgram(c,[o],n,[[r,a]]);return l.shape=t,u.texture=null,this.disposeIntermediateTensorInfo(o),l.dataId}},{key:"write",value:function(e,t,n){if(((0,Re.env)().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||(0,Re.env)().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:Em.UPLOAD,refCount:1}),r}},{key:"refCount",value:function(e){return this.texData.has(e)?this.texData.get(e).refCount:0}},{key:"incRef",value:function(e){this.texData.get(e).refCount++}},{key:"decRef",value:function(e){this.texData.has(e)&&this.texData.get(e).refCount--}},{key:"move",value:function(e,t,n,r,a){if((0,Re.env)().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:Em.UPLOAD,refCount:a})}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"readSync",value:function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,a=t.complexTensorInfos,i=t.slice,o=t.shape,u=t.isPacked;if(null!=i){var s;s=u?new Cx(o,mx):new lx(o,mx);var c=this.runWebGLProgram(s,[{dataId:e,shape:o,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeIntermediateTensorInfo(c),l}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var f,d,h=null!=this.activeTimers;if(h&&(f=Re.util.now()),"complex64"===r){var p=this.readSync(a.real.dataId),v=this.readSync(a.imag.dataId);d=Re.backend_util.mergeRealAndImagArrays(p,v)}else d=this.getValuesFromTexture(e);return h&&(this.downloadWaitMs+=Re.util.now()-f),this.convertAndCacheOnCPU(e,d)}},{key:"read",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){var n,r,a,i,u,s,c,l,f,d,h,p,v,g,m,y,b,x,k,w,_,C,S;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pendingRead.has(t)){e.next=3;break}return n=this.pendingRead.get(t),e.abrupt("return",new Promise((function(e){return n.push(e)})));case 3:if(r=this.texData.get(t),a=r.values,i=r.shape,u=r.slice,s=r.dtype,c=r.complexTensorInfos,l=r.isPacked,null==u){e.next=11;break}return f=l?new Cx(i,mx):new lx(i,mx),d=this.runWebGLProgram(f,[{dataId:t,shape:i,dtype:s}],s),h=this.read(d.dataId),this.disposeIntermediateTensorInfo(d),e.abrupt("return",h);case 11:if(null==a){e.next=13;break}return e.abrupt("return",this.convertAndCacheOnCPU(t));case 13:if(!(0,Re.env)().getBool("DEBUG")){e.next=16;break}if((0,Re.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")||2!==(0,Re.env)().getNumber("WEBGL_VERSION")){e.next=16;break}throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");case 16:if(p=null,"complex64"!==s&&(0,Re.env)().get("WEBGL_BUFFER_SUPPORTED")&&(v=this.decode(t),m=this.texData.get(v.dataId),p=(g=this.gpgpu).createBufferFromTexture.apply(g,[m.texture.texture].concat((0,o.Z)(Mm(i))))),this.pendingRead.set(t,[]),"complex64"===s){e.next=22;break}return e.next=22,this.gpgpu.createAndWaitForFence();case 22:if("complex64"!==s){e.next=31;break}return e.next=25,Promise.all([this.read(c.real.dataId),this.read(c.imag.dataId)]);case 25:b=e.sent,x=b[0],k=b[1],y=Re.backend_util.mergeRealAndImagArrays(x,k),e.next=32;break;case 31:null==p?y=this.getValuesFromTexture(t):(w=Re.util.sizeFromShape(i),y=this.gpgpu.downloadFloat32MatrixFromBuffer(p,w));case 32:return null!=v&&this.disposeIntermediateTensorInfo(v),null!=p&&Zm(_=this.gpgpu.gl,(function(){return _.deleteBuffer(p)})),C=this.convertAndCacheOnCPU(t,y),S=this.pendingRead.get(t),this.pendingRead.delete(t),S.forEach((function(e){return e(C)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&(0,Re.engine)().removeDataId(t,this),this.pendingDeletes--),e.abrupt("return",C);case 40:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readToGPU",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.texData.get(e),r=n.values,a=n.shape,i=n.slice,o=n.dtype,u=n.isPacked,s=n.texture;if("complex64"===o)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=i){var c;c=u?new Cx(a,mx):new lx(a,mx);var l=this.runWebGLProgram(c,[{dataId:e,shape:a,dtype:o}],o),f=this.readToGPU(l,t);return this.disposeIntermediateTensorInfo(l),f}if(null==s)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");var d=this.decode(e,t.customTexShape),h=(0,Re.engine)().makeTensorFromTensorInfo(d),p=this.texData.get(d.dataId);return Object.assign({tensorRef:h},p.texture)}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId);if("string"===e.dtype)try{var n=t.map((function(e){return Re.util.decodeString(e)}));return(0,Re.buffer)(e.shape,e.dtype,n)}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return(0,Re.buffer)(e.shape,e.dtype,t)}},{key:"checkNumericalProblems",value:function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!Bm(n)){if((0,Re.env)().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}},{key:"getValuesFromTexture",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.isPacked,i=Re.util.sizeFromShape(n);if((0,Re.env)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var u,s=this.decode(e),c=this.texData.get(s.dataId),l=(u=this.gpgpu).downloadMatrixFromPackedTexture.apply(u,[c.texture.texture].concat((0,o.Z)(Mm(n)))).subarray(0,i);return this.disposeIntermediateTensorInfo(s),l}var f=(0,Re.env)().getBool("WEBGL_PACK")&&!0===a,d=f?ty(n):n,h=f?new Xy(d):new Hy(d),p=this.runWebGLProgram(h,[{shape:d,dtype:r,dataId:e}],"float32"),v=this.texData.get(p.dataId),g=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(v.texture.texture,v.texShape[0],v.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(p),g}},{key:"timerAvailable",value:function(){return(0,Re.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}},{key:"time",value:function(e){var t=this,n=this.activeTimers,r=[],a=!1;null==this.programTimersStack?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,e();var i=Re.util.flatten(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),o=Re.util.flatten(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e}));this.activeTimers=n,a&&(this.programTimersStack=null);var u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(0,Co.Z)((0,_o.Z)().mark((function e(){var n;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((0,Re.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=8;break}return e.next=3,Promise.all(i);case 3:n=e.sent,u.kernelMs=Re.util.sum(n),u.getExtraProfileInfo=function(){return n.map((function(e,t){return{name:o[t],ms:e}})).map((function(e){return"".concat(e.name,": ").concat(e.ms)})).join(", ")},e.next=9;break;case 8:u.kernelMs={error:"WebGL query timers are not supported in this environment."};case 9:return t.uploadWaitMs=0,t.downloadWaitMs=0,e.abrupt("return",u);case 12:case"end":return e.stop()}}),e)})))()}},{key:"memory",value:function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}},{key:"startTimer",value:function(){return(0,Re.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Re.util.now(),endMs:null}}},{key:"endTimer",value:function(e){return(0,Re.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Re.util.now(),e)}},{key:"getQueryTime",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){var n;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((0,Re.env)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=2;break}return e.abrupt("return",this.gpgpu.waitForQueryAndGetTime(t));case 2:return n=t,e.abrupt("return",n.endMs-n.startMs);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);var n=this.texData.get(e),r=n.complexTensorInfos;return null!=r&&(this.disposeData(r.real.dataId,t),this.disposeData(r.imag.dataId,t)),this.texData.delete(e),!0}},{key:"releaseGPUData",value:function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,u=t.slice,s=u&&u.origDataId||e,c=this.dataRefCount.get(s);c>1?this.dataRefCount.set(s,c-1):(this.dataRefCount.delete(s),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}},{key:"getTexture",value:function(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}},{key:"getDataInfo",value:function(e){return this.texData.get(e)}},{key:"shouldExecuteOnCPU",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tx;return(0,Re.env)().getBool("WEBGL_CPU_FORWARD")&&e.every((function(e){return null==t.texData.get(e.dataId).texture&&Re.util.sizeFromShape(e.shape)<n}))}},{key:"getGPGPUContext",value:function(){return this.gpgpu}},{key:"where",value:function(e){Re.backend_util.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return Ax(e.shape,t)}},{key:"packedUnaryOp",value:function(e,t,n){var r=new Cx(e.shape,t),a=this.compileAndRun(r,[e],n);return(0,Re.engine)().makeTensorFromTensorInfo(a)}},{key:"abs",value:function(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){var t=jb(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if((0,Re.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,hx,e.dtype);var n=new lx(e.shape,hx),r=this.compileAndRun(n,[e]);return(0,Re.engine)().makeTensorFromTensorInfo(r)}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&Re.util.isString(n[0])){var a=n.map((function(e){return Re.util.encodeString(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}},{key:"makeOutput",value:function(e,t,n){return(0,Re.engine)().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}},{key:"unpackTensor",value:function(e){var t=new Sx(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}},{key:"packTensor",value:function(e){var t=new ax(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}},{key:"packedReshape",value:function(e,t){var n=[Jm(e.shape)].concat((0,o.Z)(ey(e.shape))),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[Jm(t)].concat((0,o.Z)(ey(t))),i=new ix(a,n),u=[n],s=this.runWebGLProgram(i,[r],e.dtype,u,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}},{key:"decode",value:function(e,t){var n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype;if(null!=t){var o=Re.util.sizeFromShape(a),u=t[0]*t[1]*4;Re.util.assert(o<=u,(function(){return"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."}))}var s,c=ty(a);s=r?new qy(c):new Gy(c);var l=[null!=t?t:Mm(c)];return{dtype:i,shape:a,dataId:this.runWebGLProgram(s,[{shape:c,dtype:i,dataId:e}],i,l,!0,t).dataId}}},{key:"runWebGLProgram",value:function(e,t,n,r){var a=this,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0,u=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(u.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===Am.DENSE){var c=null!=o?o:Mm(e.outputShape);s.texShape=c.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===Re.util.sizeFromShape(u.shape))return s.values=Re.util.getTypedArrayFromDType(u.dtype,0),u;var l=[],f=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=a.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&Re.util.sizeFromShape(t.shape)<=(0,Re.env)().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(a.uploadToGPU(t.dataId),!!n.isPacked!==!!e.packedInputs)t=n.isPacked?a.unpackTensor(t):a.packTensor(t),l.push(t),n=a.texData.get(t.dataId);else if(n.isPacked&&!ry(n.shape,t.shape)){var r=t,i=t.shape;t.shape=n.shape,t=a.packedReshape(t,i),l.push(t),n=a.texData.get(t.dataId),r.shape=i}return{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(u.dataId);var d,h={shape:u.shape,texData:s,isUniform:!1},p=Wy(e,f,h),v=this.getAndSaveBinary(p,(function(){return Ly(a.gpgpu,e,f,h)})),g=null!=this.activeTimers;g&&(d=this.startTimer()),(0,Re.env)().get("ENGINE_COMPILE_ONLY")||Uy(this.gpgpu,v,f,h,r),l.forEach((function(e){return a.disposeIntermediateTensorInfo(e)})),g&&(d=this.endTimer(d),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(d)}));var m=(0,Re.env)().get("WEBGL_FLUSH_THRESHOLD");if(m>0){var y=Re.util.now();y-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!(0,Re.env)().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===i){var b=this.unpackTensor(u);return this.disposeIntermediateTensorInfo(u),b}return u}},{key:"compileAndRun",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||t[0].dtype;var i=this.runWebGLProgram(e,t,n,r,a);return i}},{key:"getAndSaveBinary",value:function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}},{key:"getTextureManager",value:function(){return this.textureManager}},{key:"dispose",value:function(){var e=this;if(!this.disposed){if(!(0,Re.env)().getBool("IS_TEST"))Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]}));this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}},{key:"floatPrecision",value:function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=(0,Re.tidy)((function(){if(!(0,Re.env)().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=(0,Re.env)().getBool("DEBUG");(0,Re.env)().set("DEBUG",!1);var n=e.abs((0,Re.scalar)(1e-8)).dataSync()[0];if((0,Re.env)().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"uploadToGPU",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.values,u=t.texture,s=t.usage,c=t.isPacked;if(null==u){var l,f=null!=this.activeTimers;f&&(l=Re.util.now());var d=t.texShape;if(null==d&&(d=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(0,Re.env)().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=(0,Re.env)().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&(0,Re.env)().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),t&&(n*=2,r*=2,1===(e=e.map((function(t,n){return n>=e.length-2?Re.util.nearestLargerEven(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var a=Re.util.squeezeShape(e);e=a.newShape}var u=Re.util.sizeFromShape(e),s=null;e.length<=1&&u<=n?s=[1,u]:2===e.length&&e[0]<=n&&e[1]<=n?s=e:3===e.length&&e[0]*e[1]<=n&&e[2]<=n?s=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=n&&e[1]*e[2]<=n?s=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n?s=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(s=[e[0],e[1]*e[2]*e[3]]);var c=null!=s&&Math.max.apply(Math,(0,o.Z)(s))>r&&Math.min.apply(Math,(0,o.Z)(s))<=(t?2:1)&&Math.min.apply(Math,(0,o.Z)(s))>0;if(null==s||c)if(t){var l=Jm(e),f=2,d=2;if(e.length){var h=ey(e),p=(0,i.Z)(h,2);f=p[0],d=p[1]}u=l*(f/2)*(d/2),s=Re.util.sizeToSquarishShape(u).map((function(e){return 2*e}))}else s=Re.util.sizeToSquarishShape(u);return s}(n,c),t.texShape=d),null!=a){var h,p=ty(n),v=d[1],g=d[0],m=a instanceof Uint8Array||a instanceof Uint8ClampedArray;if(c||!m){var y=Om(d[0],d[1]),b=(0,i.Z)(y,2);v=b[0],g=b[1]}h=c?new $y(p,m):new Ky(p,m);var x=m?[g,v]:d,k=this.makeTensorInfo(x,r),w=this.texData.get(k.dataId);w.usage=m?Em.PIXELS:Em.UPLOAD,w.texShape=x,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(k.dataId),v,g,a);var _=[[g,v]],C=this.runWebGLProgram(h,[k],r,_,!0),S=this.texData.get(C.dataId);t.texShape=S.texShape,t.isPacked=S.isPacked,t.usage=S.usage,(0,Re.env)().get("ENGINE_COMPILE_ONLY")?this.disposeData(C.dataId):(t.texture=S.texture,t.values=null,this.texData.delete(C.dataId)),this.disposeIntermediateTensorInfo(k),f&&(this.uploadWaitMs+=Re.util.now()-l)}else{var A=this.acquireTexture(d,s,r,c);t.texture=A}}}},{key:"convertAndCacheOnCPU",value:function(e,t){var n=this.texData.get(e),r=n.dtype;return null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}},{key:"acquireTexture",value:function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(a," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}},{key:"computeBytes",value:function(e,t){return e[0]*e[1]*Re.util.bytesPerElement(t)}},{key:"checkCompileCompletion",value:function(){for(var e=0,t=Object.entries(this.binaryCache);e<t.length;e++){var n=(0,i.Z)(t[e],2)[1];this.checkCompletion_(n)}}},{key:"checkCompileCompletionAsync",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t,n,r,a,o,u,s,c,l=this;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],!this.gpgpu.parallelCompilationExtension){e.next=6;break}for(n=0,r=Object.entries(this.binaryCache);n<r.length;n++)a=(0,i.Z)(r[n],2),o=a[1],t.push(this.checkCompletionAsync_(o));return e.abrupt("return",Promise.all(t));case 6:u=(0,_o.Z)().mark((function e(){var n,r,a;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,i.Z)(c[s],2),r=n[1],a=new Promise((function(e){try{l.checkCompletion_(r),e(!0)}catch(t){throw t}})),t.push(a);case 3:case"end":return e.stop()}}),e)})),s=0,c=Object.entries(this.binaryCache);case 8:if(!(s<c.length)){e.next=13;break}return e.delegateYield(u(),"t0",10);case 10:s++,e.next=8;break;case 13:return e.abrupt("return",Promise.all(t));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkCompletionAsync_",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)){e.next=4;break}return e.abrupt("return",this.checkCompletion_(t));case 4:return e.next=6,(0,Re.nextFrame)();case 6:return e.abrupt("return",this.checkCompletionAsync_(t));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkCompletion_",value:function(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw Um(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}},{key:"getUniformLocations",value:function(){for(var e=0,t=Object.entries(this.binaryCache);e<t.length;e++){var n=(0,i.Z)(t[e],2)[1],r=Py(this.gpgpu,n.program,n.webGLProgram),a=r.uniformLocations,o=r.customUniformLocations,u=r.infLoc,s=r.nanLoc,c=r.inShapesLocations,l=r.inTexShapesLocations,f=r.outShapeLocation,d=r.outShapeStridesLocation,h=r.outTexShapeLocation;n.uniformLocations=a,n.customUniformLocations=o,n.infLoc=u,n.nanLoc=s,n.inShapesLocations=c,n.inTexShapesLocations=l,n.outShapeLocation=f,n.outShapeStridesLocation=d,n.outTexShapeLocation=h}}},{key:"createTensorFromGPUData",value:function(e,t,n){e.channels=e.channels||"RGBA";var r=e.texture,a=e.height,i=e.width,o=e.channels,u=(0,Re.engine)().backend;if(!u.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");var s=u.writeTexture(r,t,n,a,i,o);return(0,Re.engine)().makeTensorFromDataId(s,t,n,u)}}]),n}(Re.KernelBackend);Nx.nextDataId=0;Re.device_util.isBrowser()&&(0,Re.registerBackend)("webgl",(function(){return new Nx}),2);var Dx="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n",Fx=(0,s.Z)((function e(t,n,r){(0,u.Z)(this,e),this.variableNames=["A","B"],this.outputShape=Re.backend_util.assertAndGetBroadcastShape(n,r),this.enableShapeUniforms=Vy(this.outputShape.length),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")})),Ix="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n",Mx=(0,s.Z)((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,u.Z)(this,e),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Re.backend_util.assertAndGetBroadcastShape(n,r);var i=this.outputShape.length;this.enableShapeUniforms=Vy(i);var o="";if(a)if(0===i||1===Re.util.sizeFromShape(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{var s=Ry(i);if(o="\n          ".concat(s," coords = getOutputCoords();\n        "),1===i)this.enableShapeUniforms?o+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":o+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var c=rx("coords",i);this.enableShapeUniforms?o+="\n            bool nextRowOutOfBounds =\n              (".concat(c[i-2]," + 1) >= outShape[").concat(i," - 2];\n            bool nextColOutOfBounds =\n              (").concat(c[i-1]," + 1) >= outShape[").concat(i," - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "):o+="\n            bool nextRowOutOfBounds =\n              (".concat(c[i-2]," + 1) >= ").concat(this.outputShape[i-2],";\n            bool nextColOutOfBounds =\n              (").concat(c[i-1]," + 1) >= ").concat(this.outputShape[i-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(o,"\n\n        setOutput(result);\n      }\n    ")}));function Ox(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var Rx={kernelName:Re.Identity,backendName:"webgl",kernelFunc:Ox};function Zx(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),u=Ox({inputs:{x:r},backend:n}),s=Ox({inputs:{x:a},backend:n});return o.complexTensorInfos={real:u,imag:s},i}var Bx={kernelName:Re.Complex,backendName:"webgl",kernelFunc:Zx},zx="return (a < 0.) ? b * a : a;",Lx="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var Px={kernelName:Re.LeakyRelu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha,o=n.makeTensorInfo([],"float32",Re.util.createScalarValue(i,"float32")),u=(0,Re.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mx(Lx,a.shape,o.shape):new Fx(zx,a.shape,o.shape),s=n.runWebGLProgram(u,[a,o],"float32");return n.disposeIntermediateTensorInfo(o),s}},jx="return (a < 0.) ? b * a : a;",Ux="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var Wx={kernelName:Re.Prelu,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha,i=(0,Re.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mx(Ux,r.shape,a.shape):new Fx(jx,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],"float32")}},Vx="if (isnan(x)) return x;";function Gx(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.cpuKernelImpl,a=e.dtype;return function(e){var i,o=e.inputs,u=e.backend,s=o.x,c=u,l=a||s.dtype;if(c.shouldExecuteOnCPU([s])&&null!=r){var f=c.texData.get(s.dataId),d=r(f.values,l);return c.makeTensorInfo(s.shape,l,d)}return i=(0,Re.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new Cx(s.shape,n):new lx(s.shape,t),c.runWebGLProgram(i,[s],l)}}function qx(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.checkOutOfBounds,a=void 0!==r&&r,o=e.supportsComplex,u=void 0!==o&&o,s=e.cpuKernelImpl,c=e.dtype;return function(e){var r=e.inputs,o=e.backend,l=r.a,f=r.b,d=o;if(u&&"complex64"===l.dtype){var h=d.texData.get(l.dataId),p=d.texData.get(f.dataId),v=[[h.complexTensorInfos.real,p.complexTensorInfos.real],[h.complexTensorInfos.imag,p.complexTensorInfos.imag]].map((function(e){var n=(0,i.Z)(e,2),r=n[0],a=n[1],o={dataId:r.dataId,dtype:r.dtype,shape:l.shape},u={dataId:a.dataId,dtype:a.dtype,shape:f.shape},s=new Fx(t,l.shape,f.shape);return d.runWebGLProgram(s,[o,u],(0,Re.upcastType)(r.dtype,a.dtype))})),g=(0,i.Z)(v,2),m=g[0],y=g[1],b=Zx({inputs:{real:m,imag:y},backend:d});return d.disposeIntermediateTensorInfo(m),d.disposeIntermediateTensorInfo(y),b}var x,k=c||(0,Re.upcastType)(l.dtype,f.dtype);if(("string"===l.dtype||"string"===f.dtype||d.shouldExecuteOnCPU([l,f]))&&null!=s){var w=d.texData.get(l.dataId).values,_=d.texData.get(f.dataId).values,C="string"===l.dtype?Re.backend_util.fromUint8ToStringArray(w):w,S="string"===l.dtype?Re.backend_util.fromUint8ToStringArray(_):_,A=s(l.shape,f.shape,C,S,k),E=(0,i.Z)(A,2),T=E[0],N=E[1],D=d.makeTensorInfo(N,k);return d.texData.get(D.dataId).values=T,D}return x=(0,Re.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new Mx(n,l.shape,f.shape,a):new Fx(t,l.shape,f.shape),d.runWebGLProgram(x,[l,f],k)}}function Hx(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return t?bx:dx;if("relu"===e)return t?kx:vx;if("elu"===e)return t?xx:px;if("relu6"===e)return t?wx:gx;if("prelu"===e)return t?Ux:jx;if("leakyrelu"===e)return t?Lx:zx;if("sigmoid"===e)return t?_x:yx;throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var Xx=(0,s.Z)((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];(0,u.Z)(this,e),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Vy(this.outputShape.length);var f=a?t[1]:t[2],d=Math.ceil(f/2),h=a?"i * 2, rc.y":"rc.y, i * 2",p=i?"rc.z, i * 2":"i * 2, rc.z",v=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],m="",y="";s&&(m=c?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(s,"\n        }"):l?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(s,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(s,"\n        }"),y="result = activation(result);");var b=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");var x="rc.x",k="rc.x";t[0]<n[0]?x="imod(rc.x, ".concat(t[0],")"):n[0]<t[0]&&(k="imod(rc.x, ".concat(n[0],")")),this.userCode="\n      ".concat(m,"\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ").concat(d,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        int batchA = ").concat(x,";\n        int batchB = ").concat(k,";\n        for (int i = 0; i < ").concat(d,"; i++) {\n          vec4 a = getMatrixA(batchA, ").concat(h,");\n          vec4 b = getMatrixB(batchB, ").concat(p,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(v[0]," * ").concat(g[0],");\n          result += (").concat(v[1]," * ").concat(g[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(b,"\n\n        ").concat(y,"\n\n        setOutput(result);\n      }\n    ")})),Yx="return areal * breal - aimag * bimag;",Kx="return areal * bimag + aimag * breal;",$x=(0,s.Z)((function e(t,n,r){(0,u.Z)(this,e),this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Re.backend_util.assertAndGetBroadcastShape(n,r),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")})),Qx="return a * b;";function Jx(e){var t,n=e.inputs,r=e.backend,a=n.a,o=n.b,u=Re.backend_util.upcastType(a.dtype,o.dtype);if("complex64"===a.dtype){var s=r.texData.get(a.dataId),c=r.texData.get(o.dataId),l=new $x(Yx,a.shape,o.shape),f=new $x(Kx,a.shape,o.shape),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:a.shape},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:a.shape},{dataId:c.complexTensorInfos.real.dataId,dtype:c.complexTensorInfos.real.dtype,shape:o.shape},{dataId:c.complexTensorInfos.imag.dataId,dtype:c.complexTensorInfos.imag.dtype,shape:o.shape}],h=r.runWebGLProgram(l,d,"float32"),p=r.runWebGLProgram(f,d,"float32"),v=Zx({inputs:{real:h,imag:p},backend:r});return r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(p),v}if(r.shouldExecuteOnCPU([a,o])){var g=r.texData.get(a.dataId),m=r.texData.get(o.dataId),y=Db(a.shape,o.shape,g.values,m.values,u),b=(0,i.Z)(y,2),x=b[0],k=b[1],w=r.makeTensorInfo(k,u);return r.texData.get(w.dataId).values=x,w}return t=(0,Re.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mx(Qx,a.shape,o.shape):new Fx(Qx,a.shape,o.shape),r.runWebGLProgram(t,[a,o],u)}var ek={kernelName:Re.Multiply,backendName:"webgl",kernelFunc:Jx};function tk(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,u=n,s=Re.util.sizeFromShape(a.shape),c=Re.util.inferFromImplicitShape(i,s),l=Re.util.sizeFromShape(c);Re.util.assert(s===l,(function(){return"The new shape (".concat(c,") has ").concat(l," elements and the old ")+"shape (".concat(a.shape,") has ").concat(s," elements. The new shape and old ")+"shape must have the same number of elements."}));var f=u.texData.get(a.dataId);return!f.isPacked||ry(a.shape,c)||null!==f.texture&&ry(f.shape,c)?(u.incRef(a.dataId),{dataId:a.dataId,shape:c,dtype:a.dtype}):function(e,t,n){var r=[Jm(e.shape)].concat((0,o.Z)(ey(e.shape))),a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[Jm(t)].concat((0,o.Z)(ey(t))),u=new ix(i,r),s=[r],c=n.runWebGLProgram(u,[a],e.dtype,s,!0);return{dataId:c.dataId,shape:t,dtype:c.dtype}}(a,c,u)}var nk={kernelName:Re.Reshape,backendName:"webgl",kernelFunc:tk},rk=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var s=4*Math.floor(r/4),c=r%4,l="sumValue += dot(values, ones);";if(null!=n){var f=1/n;l="sumValue += dot(values * ".concat(Re.util.isInt(f)?f.toPrecision(2):f,", ones);")}var d="";i%r>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(d,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")})),ak=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var s="0.0",c="";"prod"===n?s="1.0":"min"===n?(s="1.0 / 1e-20",c="min"):"max"===n&&(s="-1.0 / 1e-20",c="max");var l="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?l="sumValue":"prod"===n?l="prodValue":"all"===n?l="allValue":"any"===n&&(l="anyValue");var f=4*Math.floor(r/4),d=r%4,h="\n      if (".concat("sum"===n,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===n,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(c,"(values, minMaxValue);\n        if (").concat("min"===n," || ").concat("max"===n,") {\n          minMaxValue = ").concat(c,"(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    "),p="vec4";"all"===n?(s="1.0",h="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",p="bvec4"):"any"===n&&(s="0.0",h="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",p="bvec4");var v="";i%r>0&&(v="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(s,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(v,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        vec4 minMaxValue = vec4(").concat(s,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(f,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(h,"\n        }\n\n        int inIdx = inOffset + ").concat(f,";\n        if (").concat(1===d,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(2===d,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(h,"\n        } else if (").concat(3===d,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(h,"\n        }\n        setOutput(").concat(l,");\n      }\n    ")}));function ik(e,t,n,r){for(var a=function(e){for(var t=[];0===t.length||1!==t[t.length-1].outSize;){var n=t.length?t[t.length-1].outSize:e[1],r=Re.backend_util.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape),i=e,o=0;o<a.length;o++){var u,s=a[o],c=s.inSize,l=s.windowSize,f=s.outSize,d=void 0;d="mean"===n?0===o?new rk({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:f},c):new rk({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:f}):new ak({windowSize:l,inSize:c,batchSize:e.shape[0],outSize:f},n),u=i,i=r.runWebGLProgram(d,[i],t),u.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(u)}return i}var ok=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.rank=r.length;var i=Ry(this.rank),o=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(n);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")}));var uk=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));for(var i=Ry(this.rank),o=nx("rc",this.rank),s=new Array(this.rank),c=0;c<n.length;c++)s[n[c]]=o[c];var l="vec2(".concat(s.slice(-2).join(),")"),f="++".concat(o[this.rank-1]," < ").concat(r[this.rank-1]),d="getChannel(getA(".concat(s.join(),"), ").concat(l,")");this.userCode="\n    void main() {\n      ".concat(i," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(d,";\n      if(").concat(f,") {\n        result[1] = ").concat(d,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(r[this.rank-2],") {\n        result[2] = ").concat(d,";\n        if(").concat(f,") {\n          result[3] = ").concat(d,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}));function sk(e,t,n){var r=(0,Re.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new uk(e.shape,t):new ok(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function ck(e){var t=e.inputs,n=e.backend,r=e.attrs;return function(e,t,n,r){var a=t,o=e.shape.length,u=Re.util.parseAxisParam(a,e.shape),s=u,c=Re.backend_util.getAxesPermutation(s,o),l=null!=c,f=e;l&&(f=sk(e,c,r),s=Re.backend_util.getInnerMostAxes(s.length,o)),Re.backend_util.assertAxesAreInnerMostDims("sum",s,o);var d=Re.backend_util.computeOutAndReduceShapes(f.shape,s),h=(0,i.Z)(d,2),p=h[0],v=h[1],g=p;n&&(g=Re.backend_util.expandShapeToKeepDim(p,u));var m=Re.util.sizeFromShape(v),y=tk({inputs:{x:f},attrs:{shape:[Re.util.sizeFromShape(e.shape)/m,m]},backend:r}),b=ik(y,(0,Re.sumOutType)(e.dtype),"sum",r),x=tk({inputs:{x:b},attrs:{shape:g},backend:r});return r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(b),l&&r.disposeIntermediateTensorInfo(f),x}(t.x,r.axis,r.keepDims,n)}var lk={kernelName:Re.Sum,backendName:"webgl",kernelFunc:ck};function fk(e){for(var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.perm,u=r,s=i.shape.length,c=new Array(s),l=0;l<c.length;l++)c[l]=i.shape[o[l]];if(u.shouldExecuteOnCPU([i])){var f=u.texData.get(i.dataId).values,d=ex(f,i.shape,i.dtype,o,c);t=u.makeTensorInfo(c,i.dtype),u.texData.get(t.dataId).values=d}else t=sk(i,o,u);return t}var dk={kernelName:Re.Transpose,backendName:"webgl",kernelFunc:fk};function hk(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.backend,o=e.bias,u=void 0===o?null:o,s=e.preluActivationWeights,c=void 0===s?null:s,l=e.leakyreluAlpha,f=void 0===l?0:l,d=e.activation,h=void 0===d?null:d,p=t.shape.length,v=n.shape.length,g=r?t.shape[p-2]:t.shape[p-1],m=a?n.shape[v-1]:n.shape[v-2],y=r?t.shape[p-1]:t.shape[p-2],b=a?n.shape[v-2]:n.shape[v-1],x=t.shape.slice(0,-2),k=n.shape.slice(0,-2),w=Re.util.sizeFromShape(x),_=Re.util.sizeFromShape(k),C=Re.broadcast_util.assertAndGetBroadcastShape(t.shape.slice(0,-2),n.shape.slice(0,-2)).concat([y,b]);Re.util.assert(g===m,(function(){return"Error in matMul: inner shapes (".concat(g,") and (")+"".concat(m,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match.")}));var S,A=r?[w,g,y]:[w,y,g],E=a?[_,b,m]:[_,m,b],T=tk({inputs:{x:t},backend:i,attrs:{shape:A}}),N=tk({inputs:{x:n},backend:i,attrs:{shape:E}}),D=[T,N],F=Math.max(w,_),I=r?T.shape[1]:T.shape[2],M=null!=u,O=null!=c,R="leakyrelu"===h,Z=null!=h?Hx(h,!0):null;if((1===y||1===b)&&I>1e3&&!1===(M||O||R||null!=Z)){var B=T,z=N;r&&(B=fk({inputs:{x:T},backend:i,attrs:{perm:[0,2,1]}}),D.push(B)),a&&(z=fk({inputs:{x:N},backend:i,attrs:{perm:[0,2,1]}}),D.push(z));var L=1===b,P=B;1!==b&&(P=tk({inputs:{x:B},backend:i,attrs:{shape:[F,I,1]}}),D.push(P));var j=1===b?2:1,U=z;L&&(U=tk({inputs:{x:z},backend:i,attrs:{shape:[F,1,I]}}),D.push(U));var W=Jx({inputs:{a:P,b:U},backend:i});S=ck({inputs:{x:W},backend:i,attrs:{axis:j,keepDims:!0}}),D.push(W)}else{var V=(0,Re.upcastType)(t.dtype,n.dtype),G=new Xx(A,E,[F,y,b],r,a,M,Z,O,R),q=[T,N];if(null!=u&&q.push(u),O&&q.push(c),R){var H=i.makeTensorInfo([],"float32",Re.util.createScalarValue(f,"float32"));q.push(H),D.push(H)}S=i.runWebGLProgram(G,q,V)}var X=tk({inputs:{x:S},backend:i,attrs:{shape:C}});D.push(S);for(var Y=0,K=D;Y<K.length;Y++){var $=K[Y];i.disposeIntermediateTensorInfo($)}return X}var pk={kernelName:Re._FusedMatMul,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=t.bias,u=t.preluActivationWeights,s=r.transposeA,c=r.transposeB,l=r.activation;return hk({a:a,b:i,transposeA:s,transposeB:c,backend:n,bias:o,preluActivationWeights:u,leakyreluAlpha:r.leakyreluAlpha,activation:l})}},vk="return abs(x);";var gk={kernelName:Re.Abs,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])&&"complex64"!==a.dtype){var i=r.texData.get(a.dataId),o=jb(i.values);return r.makeTensorInfo(a.shape,a.dtype,o)}return t=(0,Re.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Cx(a.shape,vk):new lx(a.shape,vk),r.runWebGLProgram(t,[a],a.dtype)}},mk=Gx({opSnippet:fx+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),yk={kernelName:Re.Acos,backendName:"webgl",kernelFunc:mk},bk=Gx({opSnippet:fx+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),xk={kernelName:Re.Acosh,backendName:"webgl",kernelFunc:bk},kk="return a + b;",wk=qx({opSnippet:kk,packedOpSnippet:kk,supportsComplex:!0,cpuKernelImpl:cb}),_k={kernelName:Re.Add,backendName:"webgl",kernelFunc:wk},Ck=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.outputShape=[],this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")})),Sk=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")}));var Ak={kernelName:Re.AddN,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n;if(1===a.length)return Ox({inputs:{x:a[0]},backend:r});if(a.length>(0,Re.env)().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(a.length/2),o=e({inputs:a.slice(0,i),backend:r}),u=e({inputs:a.slice(i),backend:r});return e({inputs:[o,u],backend:r})}var s=a.map((function(e){return e.dtype})).reduce((function(e,t){return(0,Re.upcastType)(e,t)})),c=a.map((function(e){return e.shape})),l=(0,Re.env)().getBool("WEBGL_PACK")?new Sk(a[0].shape,c):new Ck(a[0].shape,c);return r.runWebGLProgram(l,a,s)}};var Ek={kernelName:Re.All,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.axis,u=r.keepDims,s=a.shape.length,c=Re.util.parseAxisParam(o,a.shape),l=c,f=Re.backend_util.getAxesPermutation(l,s),d=a;null!=f&&(d=fk({inputs:{x:a},backend:n,attrs:{perm:f}}),l=Re.backend_util.getInnerMostAxes(l.length,s)),Re.backend_util.assertAxesAreInnerMostDims("all",l,s);var h,p=Re.backend_util.computeOutAndReduceShapes(d.shape,l),v=(0,i.Z)(p,2),g=v[0],m=v[1],y=tk({inputs:{x:d},backend:n,attrs:{shape:[-1,Re.util.sizeFromShape(m)]}}),b=ik(y,y.dtype,"all",n);return h=tk(u?{inputs:{x:b},backend:n,attrs:{shape:Re.backend_util.expandShapeToKeepDim(g,c)}}:{inputs:{x:b},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),null!=f&&n.disposeIntermediateTensorInfo(d),h}};var Tk={kernelName:Re.Any,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.axis,u=r.keepDims,s=a.shape.length,c=Re.util.parseAxisParam(o,a.shape),l=c,f=Re.backend_util.getAxesPermutation(l,s),d=a;null!=f&&(d=fk({inputs:{x:a},backend:n,attrs:{perm:f}}),l=Re.backend_util.getInnerMostAxes(l.length,s)),Re.backend_util.assertAxesAreInnerMostDims("any",l,s);var h,p=Re.backend_util.computeOutAndReduceShapes(d.shape,l),v=(0,i.Z)(p,2),g=v[0],m=v[1],y=tk({inputs:{x:d},backend:n,attrs:{shape:[-1,Re.util.sizeFromShape(m)]}}),b=ik(y,y.dtype,"any",n);return h=tk(u?{inputs:{x:b},backend:n,attrs:{shape:Re.backend_util.expandShapeToKeepDim(g,c)}}:{inputs:{x:b},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),null!=f&&n.disposeIntermediateTensorInfo(d),h}},Nk=(0,s.Z)((function e(t,n,r){(0,u.Z)(this,e),this.variableNames=["A"];var a=t.windowSize,i=t.batchSize,o=t.outSize;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var s="max"===n?">":"<",c=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(c,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(s," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")})),Dk=(0,s.Z)((function e(t,n,r,a){(0,u.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,Re.util.assert(t.length>2,(function(){return"Packed arg".concat(r.charAt(0).toUpperCase()+r.slice(1)," supports only inputs with rank above 2.")}));var i=t[t.length-1],o=Math.ceil(i/n);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),a||this.variableNames.push("bestIndicesA");var s,c,l=this.outputShape,f=l.length,d=Ry(f),h=rx("coords",f);if(1===o){var p=Ry(c=f+1);s="\n        ".concat(p," sourceLocR = ").concat(p,"(").concat(h.join(),", 0);\n        ++").concat(h[f-1],";\n        ").concat(p," sourceLocG = ").concat(p,"(").concat(h.join(),", 0);\n        ++").concat(h[f-2],";\n        ").concat(p," sourceLocA = ").concat(p,"(").concat(h.join(),", 0);\n        --").concat(h[f-1],";\n        ").concat(p," sourceLocB = ").concat(p,"(").concat(h.join(),", 0);\n        --").concat(h[f-2],";")}else c=f,s="\n        ".concat(d," sourceLocR = coords;\n        ++").concat(h[f-1],";\n        ").concat(d," sourceLocG = coords;\n        ++").concat(h[f-2],";\n        ").concat(d," sourceLocA = coords;\n        --").concat(h[f-1],";\n        ").concat(d," sourceLocB = coords;\n        --").concat(h[f-2],";");var v=["x","y","z","w","u","v"].slice(0,c),g="."+v[c-1],m=v.map((function(e){return"int "+e})),y=rx("sourceLocR",c-1).concat("inIdx.r"),b=rx("sourceLocG",c-1).concat("inIdx.g"),x=rx("sourceLocB",c-1).concat("inIdx.b"),k=rx("sourceLocA",c-1).concat("inIdx.a"),w="max"===r?"greaterThan":"lessThan",_=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),"),\n                             getBestIndicesAChannel(").concat(x.join(),"),\n                             getBestIndicesAChannel(").concat(k.join(),")));"),C="vec4(\n            getAChannel(".concat(y.join(),"),\n            hasNextCol ? getAChannel(").concat(b.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(x.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(k.join(),") : 0.)"),S=a?"":"\n      float getBestIndicesAChannel(".concat(m.join(),") {\n        return getChannel(getBestIndicesA(").concat(v.join(),"),\n                                          vec2(").concat(v.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(m.join(),") {\n        return getChannel(getA(").concat(v.join(),"),\n                               vec2(").concat(v.slice(-2).join(),"));\n      }\n      ").concat(S,"\n      void main() {\n        ").concat(d," coords = getOutputCoords();\n        bool hasNextCol = ").concat(h[f-1]," < ").concat(l[f-1]-1,";\n        bool hasNextRow = ").concat(h[f-2]," < ").concat(l[f-2]-1,";\n        ").concat(s,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(g,", sourceLocG").concat(g,",\n          sourceLocB").concat(g,", sourceLocA").concat(g,") * ").concat(n,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(C,";\n\n        for (int i = 0; i < ").concat(n,"; i++) {\n          inIdx = srcIdx;\n          ").concat(_,"\n          vec4 candidate = ").concat(C,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(w,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")}));function Fk(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.shape[0],i=t.shape[1];null!=r&&(a=r.shape[0],i=r.shape[1]);var o=Re.backend_util.computeOptimalWindowSize(i),u={windowSize:o,inSize:i,batchSize:a,outSize:Math.ceil(i/o)},s=new Nk(u,n,null==r),c=[t];null!=r&&c.push(r);var l=e.runWebGLProgram(s,c,"int32");if(1===l.shape[1])return l;var f=Fk(e,t,n,l);return e.disposeIntermediateTensorInfo(l),f}function Ik(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=null!=r?r.shape:t.shape,i=a[a.length-1],o=Re.backend_util.computeOptimalWindowSize(i),u=new Dk(a,o,n,null==r),s=null==r?[t]:[t,r],c=e.runWebGLProgram(u,s,"int32");if(c.shape.length===t.shape.length){var l=Ik(e,t,n,c);return e.disposeIntermediateTensorInfo(c),l}return c}function Mk(e,t,n,r){var a=[n];if(Re.backend_util.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!(0,Re.env)().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){var o=[],u=e.texData.get(t.dataId),s=t;null!==u&&u.isPacked&&(s=e.unpackTensor(t),o.push(s));var c=Re.backend_util.computeOutAndReduceShapes(s.shape,a),l=(0,i.Z)(c,2),f=l[0],d=l[1],h=Re.util.sizeFromShape(d),p=tk({inputs:{x:s},backend:e,attrs:{shape:[-1,h]}});o.push(p);var v=Fk(e,p,r);o.push(v);var g=tk({inputs:{x:v},backend:e,attrs:{shape:f}});return o.forEach((function(t){return e.disposeIntermediateTensorInfo(t)})),g}return Ik(e,t,r)}var Ok={kernelName:Re.ArgMax,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=Re.util.parseAxisParam(i,a.shape),u=Re.backend_util.getAxesPermutation(o,a.shape.length),s=a,c=[];null!=u&&(s=fk({inputs:{x:a},backend:n,attrs:{perm:u}}),c.push(s),o=Re.backend_util.getInnerMostAxes(o.length,s.shape.length)),Re.backend_util.assertAxesAreInnerMostDims("argMax",[o[0]],s.shape.length);var l=Mk(n,s,o[0],"max");return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),l}};var Rk={kernelName:Re.ArgMin,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=Re.util.parseAxisParam(i,a.shape),u=Re.backend_util.getAxesPermutation(o,a.shape.length),s=a,c=[];null!=u&&(s=fk({inputs:{x:a},backend:n,attrs:{perm:u}}),c.push(s),o=Re.backend_util.getInnerMostAxes(o.length,s.shape.length)),Re.backend_util.assertAxesAreInnerMostDims("argMin",[o[0]],s.shape.length);var l=Mk(n,s,o[0],"min");return c.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),l}},Zk=Gx({opSnippet:fx+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),Bk={kernelName:Re.Asin,backendName:"webgl",kernelFunc:Zk},zk=Gx({opSnippet:fx+"return log(x + sqrt(x * x + 1.0));"}),Lk={kernelName:Re.Asinh,backendName:"webgl",kernelFunc:zk},Pk=Gx({opSnippet:fx+"\n  return atan(x);\n"}),jk={kernelName:Re.Atan,backendName:"webgl",kernelFunc:Pk},Uk=qx({opSnippet:Dx+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Ix+"\n  return result;\n"}),Wk={kernelName:Re.Atan2,backendName:"webgl",kernelFunc:Uk},Vk=Gx({opSnippet:fx+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),Gk={kernelName:Re.Atanh,backendName:"webgl",kernelFunc:Vk},qk=(0,s.Z)((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if((0,u.Z)(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,f=t.dilationWidth,d=t.effectiveFilterHeight,h=t.effectiveFilterWidth,p=t.padInfo.top,v=t.padInfo.left;this.outputShape=t.outShape;var g="avg"===n,m="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),y="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),b="0.0";if(g||(b="-1.0 / 1e-20"),r){var x=">=";this.userCode="\n        const ivec2 strides = ivec2(".concat(s,", ").concat(c,");\n        const ivec2 pads = ivec2(").concat(p,", ").concat(v,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(d,";\n              wR += ").concat(l,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(f,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(x," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?i?m:y:"wR * ".concat(h," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var k="max",w="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(w="avgValue / max(count, 1.0)");var _=4*Math.floor(o/4),C=o%4,S="\n      if (".concat(g,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(k,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(s,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(p,", ").concat(v,");\n      const float initializationValue = ").concat(b,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(b,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(d,";\n            wR += ").concat(l,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(_,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(f,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(f,", d),\n              getValue(batch, xR, xC + 2 * ").concat(f,", d),\n              getValue(batch, xR, xC + 3 * ").concat(f,", d)\n            );\n\n            ").concat(S,"\n          }\n\n          int xC = xCCorner + ").concat(_,";\n          if (").concat(1===C,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(S,"\n          } else if (").concat(2===C,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(f,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(S,"\n          } else if (").concat(3===C,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(f,", d),\n              getValue(batch, xR, xC + 2 * ").concat(f,", d),\n              initializationValue\n            );\n\n            ").concat(S,"\n          }\n        }\n        setOutput(").concat(w,");\n      }\n    ")}})),Hk=(0,s.Z)((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if((0,u.Z)(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideDepth,c=t.strideHeight,l=t.strideWidth,f=t.dilationDepth,d=t.dilationHeight,h=t.dilationWidth,p=t.effectiveFilterDepth,v=t.effectiveFilterHeight,g=t.effectiveFilterWidth,m=t.padInfo.front,y=t.padInfo.top,b=t.padInfo.left;this.outputShape=t.outShape;var x="avg"===n,k="0.0";if(x||(k="-1.0 / 1e-20"),r){var w=">=";this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(s,", ").concat(c,", ").concat(l,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(y,", ").concat(b,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(p,";\n              wD += ").concat(f,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(v,";\n                wR += ").concat(d,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(g,";\n                  wC += ").concat(h,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(w," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(v," * ").concat(g," +\n                      wR * ").concat(g," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var _="max",C="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(C="avgValue / max(count, 1.0)");var S=4*Math.floor(o/4),A=o%4,E="\n      if (".concat(x,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(_,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(s,", ").concat(c,", ").concat(l,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(y,", ").concat(b,");\n      const float initializationValue = ").concat(k,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(k,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(p,";\n            wD += ").concat(f,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(v,";\n            wR += ").concat(d,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(S,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(h,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(h,", ch)\n              );\n\n              ").concat(E,"\n            }\n\n            int xC = xCCorner + ").concat(S,";\n            if (").concat(1===A,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(E,"\n            } else if (").concat(2===A,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(E,"\n            } else if (").concat(3===A,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(h,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(h,", ch),\n                initializationValue\n              );\n\n              ").concat(E,"\n            }\n          }\n        }\n        setOutput(").concat(C,");\n      }\n    ")}}));var Xk={kernelName:Re.AvgPool,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;sy(a,"avgPool");var i=r.filterSize,o=r.strides,u=r.pad,s=r.dimRoundingMode;Re.util.assert(Re.backend_util.eitherStridesOrDilationsAreOne(o,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c=Re.backend_util.computePool2DInfo(a.shape,i,o,1,u,s);if(1===c.filterWidth&&1===c.filterHeight&&Re.util.arraysEqual(c.inShape,c.outShape))return Ox({inputs:{x:a},backend:n});var l=new qk(c,"avg",!1);return n.runWebGLProgram(l,[a],"float32")}};var Yk={kernelName:Re.AvgPool3D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,u=r.pad,s=r.dimRoundingMode,c=r.dataFormat,l=Re.backend_util.computePool3DInfo(a.shape,i,o,[1,1,1],u,s,c),f=new Hk(l,"avg",!1);return n.runWebGLProgram(f,[a],"float32")}},Kk=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,s=t.dilationWidth,c=t.effectiveFilterHeight,l=t.effectiveFilterWidth,f=c-1-t.padInfo.top,d=l-1-t.padInfo.left,h=1/(n*r);this.userCode="\n      const ivec2 pads = ivec2(".concat(f,", ").concat(d,");\n      const float avgMultiplier = float(").concat(h,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(c,";\n            wR += ").concat(o,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(l,";\n            wC+= ").concat(s,") {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),$k=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,c=t.dilationDepth,l=t.dilationHeight,f=t.dilationWidth,d=t.effectiveFilterDepth,h=t.effectiveFilterHeight,p=t.effectiveFilterWidth,v=d-1-t.padInfo.front,g=h-1-t.padInfo.top,m=p-1-t.padInfo.left,y=1/(n*r*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(v,", ").concat(g,", ").concat(m,");\n      const float avgMultiplier = float(").concat(y,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(c,") {\n          float dyD = float(dyDCorner + wD) / ").concat(i,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(l,") {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(p,";\n                wC += ").concat(f,") {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var Qk={kernelName:Re.AvgPool3DGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,u=r.strides,s=r.pad,c=r.dimRoundingMode,l=Re.backend_util.computePool3DInfo(i.shape,o,u,[1,1,1],s,c),f=new $k(l);return n.runWebGLProgram(f,[a],i.dtype)}};var Jk={kernelName:Re.AvgPoolGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;sy([a,i],"avgPoolGrad");var u=r.filterSize,s=r.strides,c=r.pad,l=Re.backend_util.computePool2DInfo(o.shape,u,s,1,c),f=new Kk(l);return n.runWebGLProgram(f,[a],o.dtype)}};var ew={kernelName:Re.BatchMatMul,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;return hk({a:t.a,b:t.b,transposeA:r.transposeA,transposeB:r.transposeB,backend:n})}},tw=(0,s.Z)((function e(t,n,r,a,i,o){(0,u.Z)(this,e),this.outputShape=[],this.variableNames=["x","mean","variance"],Re.backend_util.assertAndGetBroadcastShape(t,n),Re.backend_util.assertAndGetBroadcastShape(t,r);var s="0.0";null!=a&&(Re.backend_util.assertAndGetBroadcastShape(t,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var c="1.0";null!=i&&(Re.backend_util.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(s,";\n        float scale = ").concat(c,";\n        float inv = scale * inversesqrt(variance + float(").concat(o,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")})),nw=(0,s.Z)((function e(t,n,r,a,i,o){(0,u.Z)(this,e),this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Re.backend_util.assertAndGetBroadcastShape(t,n),Re.backend_util.assertAndGetBroadcastShape(t,r);var s="vec4(0.0)";null!=a&&(Re.backend_util.assertAndGetBroadcastShape(t,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var c="vec4(1.0)";null!=i&&(Re.backend_util.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(s,";\n        vec4 scale = ").concat(c,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(o,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")})),rw={kernelName:Re.FusedBatchNorm,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.mean,o=t.variance,u=t.offset,s=t.scale;Re.util.assert(i.shape.length===o.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),Re.util.assert(null==u||i.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),Re.util.assert(null==s||i.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var c=r.varianceEpsilon;null==c&&(c=.001);var l=[a,i,o],f=null;null!=u&&(f=u.shape,l.push(u));var d=null;null!=s&&(d=s.shape,l.push(s));var h=(0,Re.env)().getBool("WEBGL_PACK_NORMALIZATION")?new nw(a.shape,i.shape,o.shape,f,d,c):new tw(a.shape,i.shape,o.shape,f,d,c);return n.runWebGLProgram(h,l,l[0].dtype)}},aw=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n=Ry(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];var r,a=function(e){if(1===e)return"sourceLoc";if(e<=6)return iw.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank),i=t.map((function(e,t){return"sourceLoc.".concat(iw[t]," = start[").concat(t,"] + coords.").concat(iw[t],";")}));r="\n        ".concat(n," sourceLoc;\n        ").concat(n," coords = getOutputCoords();\n        ").concat(i.join("\n"),"\n      "),this.userCode="\n      void main() {\n        ".concat(r,"\n        setOutput(getSource(").concat(a,"));\n      }\n    ")})),iw=["x","y","z","w","u","v"];var ow=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];var n=Ry(this.rank),r=rx("coords",this.rank),a=rx("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),o="getChannel(getSource(".concat(a.join(),"), ").concat(i,")"),s="\n      result.x = ".concat(o,";\n      if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(o,";\n        --").concat(a[this.rank-1],";\n      }\n    "),c=1===this.rank?"":"\n      --".concat(r[this.rank-1],";\n      if (++").concat(r[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(o,";\n        if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(o,";\n        }\n      }\n    "),l=this.rank<=4?"sourceLoc = coords +\n            ".concat(n,"(").concat(t.map((function(e,t){return"start[".concat(t,"]")})).join(),");"):t.map((function(e,t){return"".concat(a[t]," = ").concat(r[t]," + start[").concat(t,"];")})).join("\n");this.userCode="\n      void main() {\n        ".concat(n," coords = getOutputCoords();\n        ").concat(n," sourceLoc;\n        ").concat(l,"\n        vec4 result = vec4(0.);\n        ").concat(s,"\n        ").concat(c,"\n        setOutput(result);\n      }\n    ")}));function uw(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.begin,u=r.size,s=Re.slice_util.parseSliceParams(a,o,u),c=(0,i.Z)(s,2),l=c[0],f=c[1];if(Re.slice_util.assertParamsValid(a,l,f),0===Re.util.sizeFromShape(f))return n.makeTensorInfo(f,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){var d=n.texData.get(a.dataId),h=Ub(d.values,l,f,a.shape,a.dtype);return n.makeTensorInfo(f,a.dtype,h)}var p=n.texData.get(a.dataId).isPacked,v=Re.slice_util.isSliceContinous(a.shape,l,f);if(p||!v){var g=(0,Re.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ow(f):new aw(f),m=[l];return n.runWebGLProgram(g,[a],a.dtype,m)}return n.uploadToGPU(a.dataId),function(e,t,n,r){var a=r.texData.get(e.dataId),i=r.makeTensorInfo(n,e.dtype),o=r.texData.get(i.dataId);Object.assign(o,a),o.refCount=1,o.shape=n,o.dtype=e.dtype;var u=Re.slice_util.computeFlatOffset(t,Re.util.computeStrides(e.shape));a.slice&&(u+=a.slice.flatOffset),o.slice={flatOffset:u,origDataId:a.slice&&a.slice.origDataId||e.dataId};var s=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,s+1),i}(a,l,f,n)}var sw={kernelName:Re.Slice,backendName:"webgl",kernelFunc:uw},cw={kernelName:Re.BatchToSpaceND,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,o=r.crops;Re.util.assert(a.shape.length<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var u=i.reduce((function(e,t){return e*t})),s=Re.backend_util.getReshaped(a.shape,i,u),c=Re.backend_util.getPermuted(s.length,i.length),l=Re.backend_util.getReshapedPermuted(a.shape,i,u),f=Re.backend_util.getSliceBeginCoords(o,i.length),d=Re.backend_util.getSliceSize(l,o,i.length),h=[],p=tk({inputs:{x:a},backend:n,attrs:{shape:s}}),v=fk({inputs:{x:p},backend:n,attrs:{perm:c}}),g=tk({inputs:{x:v},backend:n,attrs:{shape:l}}),m=uw({inputs:{x:g},backend:n,attrs:{begin:f,size:d}});return h.push(p),h.push(v),h.push(g),h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}};var lw={kernelName:Re.Bincount,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,u=n.readSync(a.dataId),s=n.readSync(i.dataId),c=lb(u,s,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}};var fw={kernelName:Re.BroadcastArgs,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.s0,a=t.s1,i=n.readSync(r.dataId),o=n.readSync(a.dataId),u=Re.backend_util.assertAndGetBroadcastShape(Array.from(i),Array.from(o));return n.makeTensorInfo([u.length],"int32",Int32Array.from(u))}},dw=qx({opSnippet:"return float(a != b);",cpuKernelImpl:Ib,dtype:"bool"}),hw={kernelName:Re.NotEqual,backendName:"webgl",kernelFunc:dw};function pw(e){var t=e.inputs,n=e.backend,r=t.input;return Ox({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}var vw={kernelName:Re.Real,backendName:"webgl",kernelFunc:pw};var gw={kernelName:Re.Cast,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=t.attrs,o=n.x,u=a.dtype;if("complex64"===u){if("complex64"===o.dtype)return Ox({inputs:{x:o},backend:r});var s=Re.zeros(o.shape),c=e({inputs:{x:o},backend:r,attrs:{dtype:"float32"}}),l=Zx({inputs:{real:c,imag:s},backend:r});return s.dispose(),r.disposeIntermediateTensorInfo(c),l}if("complex64"===o.dtype){var f=pw({inputs:{input:o},backend:r}),d=e({inputs:{x:f},backend:r,attrs:{dtype:u}});return r.disposeIntermediateTensorInfo(f),d}if(!Re.util.hasEncodingLoss(o.dtype,u)){var h=Ox({inputs:{x:o},backend:r});return{dataId:h.dataId,shape:h.shape,dtype:u}}if(r.shouldExecuteOnCPU([o])){var p=r.texData.get(o.dataId).values,v=db(p,o.shape,o.dtype,u),g=(0,i.Z)(v,3),m=g[0],y=g[1],b=g[2];return r.makeTensorInfo(m,y,b)}if("int32"===u)return function(e,t){var n=new lx(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(o,r);if("bool"===u){var x=r.makeTensorInfo([],"bool",Re.util.getTypedArrayFromDType("bool",1)),k=dw({inputs:{a:o,b:x},backend:r});return r.disposeIntermediateTensorInfo(x),k}throw new Error("Error in Cast: failed to cast ".concat(o.dtype," to ").concat(u))}},mw="return ceil(x);",yw=Gx({opSnippet:mw,packedOpSnippet:mw,cpuKernelImpl:hb}),bw={kernelName:Re.Ceil,backendName:"webgl",kernelFunc:yw},xw=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "})),kw=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}));var ww={kernelName:Re.ClipByValue,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.clipValueMin,u=a.clipValueMax;t=(0,Re.env)().getBool("WEBGL_PACK_CLIP")?new kw(i.shape):new xw(i.shape);var s=[[o],[u]];return r.runWebGLProgram(t,[i],i.dtype,s)}},_w=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}));function Cw(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}var Sw={kernelName:Re.ComplexAbs,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n.texData.get(r.dataId),i=new _w(r.shape),o=[Cw(r,a.complexTensorInfos.real),Cw(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}},Aw=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.outputShape=[],this.outputShape=Re.backend_util.computeOutShape(t,1),this.variableNames=t.map((function(e,t){return"T".concat(t)}));var n=new Array(t.length-1);n[0]=t[0][1];for(var r=1;r<n.length;r++)n[r]=n[r-1]+t[r][1];for(var a=["if (yC < ".concat(n[0],") setOutput(getT0(yR, yC));")],i=1;i<n.length;i++){var o=n[i-1];a.push("else if (yC < ".concat(n[i],") ")+"setOutput(getT".concat(i,"(yR, yC-").concat(o,"));"))}var s=n.length,c=n[n.length-1];a.push("else setOutput(getT".concat(s,"(yR, yC-").concat(c,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(a.join("\n        "),"\n      }\n    ")})),Ew=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Re.backend_util.computeOutShape(t,n);var r=this.outputShape,a=r.length,i=Ry(a),o=rx("coords",a),s=["x","y","z","w","u","v"].slice(0,a);this.variableNames=t.map((function(e,t){return"T".concat(t)}));var c=new Array(t.length-1);c[0]=t[0][n];for(var l=1;l<c.length;l++)c[l]=c[l-1]+t[l][n];for(var f=s[n],d=s.slice(-2),h=s.join(),p="if (".concat(f," < ").concat(c[0],") {\n        return getChannel(\n            getT0(").concat(h,"), vec2(").concat(d.join(),"));\n        }"),v=1;v<c.length;v++){var g=c[v-1];p+="\n        if (".concat(f," < ").concat(c[v],"  && ").concat(f," >= ").concat(c[v-1],") {\n          return getChannel(\n            getT").concat(v,"(").concat(Tw(s,f,g),"),\n            vec2(").concat(Tw(d,f,g),"));\n        }")}var m=c.length,y=c[c.length-1];p+="\n        return getChannel(\n          getT".concat(m,"(").concat(Tw(s,f,y),"),\n          vec2(").concat(Tw(d,f,y),"));"),this.userCode="\n      float getValue(".concat(s.map((function(e){return"int "+e})),") {\n        ").concat(p,"\n      }\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(o,"), 0., 0., 0.);\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," + 1;\n        if (").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.g = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-2]," = ").concat(o[a-2]," + 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2],") {\n          result.a = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," - 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2]," &&\n            ").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.b = getValue(").concat(o,");\n        }\n        setOutput(result);\n      }\n    ")}));function Tw(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?"".concat(e," - ").concat(n):e})).join()}function Nw(e){var t=e.inputs,n=e.backend,r=t.input;return Ox({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}var Dw={kernelName:Re.Imag,backendName:"webgl",kernelFunc:Nw};function Fw(e,t,n){var r=e[0].dtype;if("complex64"===r){var a=e.map((function(e){return pw({inputs:{input:e},backend:n})})),i=e.map((function(e){return Nw({inputs:{input:e},backend:n})})),o=Fw(a,t,n),u=Fw(i,t,n),s=Zx({inputs:{real:o,imag:u},backend:n});return a.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),i.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),s}var c=n.shouldExecuteOnCPU(e);if("string"===r&&(c=!0),c){var l=e.map((function(e){var r=Re.util.sizeFromShape(e.shape.slice(t));return tk({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})})),f=l.map((function(e){return{vals:n.readSync(e.dataId),shape:e.shape}})),d=Re.backend_util.computeOutShape(l.map((function(e){return e.shape})),1),h=1===l[0].shape[0],p=pb(f,d,r,h),v=Re.backend_util.computeOutShape(e.map((function(e){return e.shape})),t),g=n.makeTensorInfo(v,r,p);return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}var m=e.filter((function(e){return Re.util.sizeFromShape(e.shape)>0})),y=(0,Re.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&m[0].shape.length>1;if(1===m.length){var b=y?new lx(e[0].shape,mx):new Cx(e[0].shape,mx);return n.runWebGLProgram(b,e,r)}var x=(0,Re.env)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(m.length>x){for(var k=[],w=0;w<m.length;w+=x){var _=m.slice(w,w+x);k.push(Fw(_,t,n))}for(var C=Fw(k,t,n),S=0,A=k;S<A.length;S++){var E=A[S];n.disposeIntermediateTensorInfo(E)}return C}if(y){var T=new Ew(m.map((function(e){return e.shape})),t);return n.runWebGLProgram(T,m,r)}var N=function(e,t,n){var r=Re.backend_util.computeOutShape(e.map((function(e){return e.shape})),t),a=e.map((function(e){return tk({inputs:{x:e},attrs:{shape:[-1,Re.util.sizeFromShape(e.shape.slice(t))]},backend:n})}));return{tensors2D:a,outShape:r}}(m,t,n),D=N.tensors2D,F=N.outShape,I=new Aw(D.map((function(e){return e.shape}))),M=n.runWebGLProgram(I,D,r);D.forEach((function(e){return n.disposeIntermediateTensorInfo(e)}));var O=tk({inputs:{x:M},attrs:{shape:F},backend:n});return n.disposeIntermediateTensorInfo(M),O}function Iw(e){var t=e.inputs,n=e.backend,r=e.attrs.axis,a=Re.util.parseAxisParam(r,t[0].shape)[0],i=t.map((function(e){return e.shape}));Re.backend_util.assertParamsConsistent(i,a);var o=Re.backend_util.computeOutShape(t.map((function(e){return e.shape})),a);if(0===Re.util.sizeFromShape(o))return n.makeTensorInfo(o,t[0].dtype,[]);var u=t.filter((function(e){return Re.util.sizeFromShape(e.shape)>0}));return 1===u.length?Ox({inputs:{x:u[0]},backend:n}):Fw(u,a,n)}var Mw={kernelName:Re.Concat,backendName:"webgl",kernelFunc:Iw},Ow=(0,s.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,u.Z)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,s=t.padInfo.left,c=t.strideHeight,l=t.strideWidth,f=t.dilationHeight,d=t.dilationWidth,h=t.filterHeight,p=t.filterWidth,v=4*Math.floor(t.inChannels/4),g=t.inChannels%4,m="channelsLast"===t.dataFormat,y=m?1:2,b=m?2:3,x=m?3:1,k="",w="";r&&(k=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),w="result = activation(result);");var _=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(k,"\n\n      const ivec2 strides = ivec2(").concat(c,", ").concat(l,");\n      const ivec2 pads = ivec2(").concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(x,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(y,"], coords[").concat(b,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(h,"; wR++) {\n          int xR = xRCorner + wR * ").concat(f,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(p,"; wC++) {\n            int xC = xCCorner + wC * ").concat(d,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(v,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===g,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(v,") *\n                    getW(wR, wC, ").concat(v,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(v,", xR, xC) *\n                    getW(wR, wC, ").concat(v,", d2);\n              }\n\n            } else if (").concat(2===g,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(v,", d2),\n                getW(wR, wC, ").concat(v," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(v,"),\n                  getX(batch, xR, xC, ").concat(v," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(v,", xR, xC),\n                  getX(batch, ").concat(v," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===g,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(v,", d2),\n                getW(wR, wC, ").concat(v," + 1, d2),\n                getW(wR, wC, ").concat(v," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(v,"),\n                  getX(batch, xR, xC, ").concat(v," + 1),\n                  getX(batch, xR, xC, ").concat(v," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(v,", xR, xC),\n                  getX(batch, ").concat(v," + 1, xR, xC),\n                  getX(batch, ").concat(v," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(_,"\n        ").concat(w,"\n        setOutput(result);\n      }\n    ")})),Rw=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.padInfo.front,r=t.padInfo.top,a=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,c=t.dilationDepth,l=t.dilationHeight,f=t.dilationWidth,d=t.filterDepth,h=t.filterHeight,p=t.filterWidth,v=4*Math.floor(t.inChannels/4),g=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(o,", ").concat(s,");\n      const ivec3 pads = ivec3(").concat(n,", ").concat(r,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(d,"; wF++) {\n          int xF = xFCorner + wF * ").concat(c,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(h,"; wR++) {\n            int xR = xRCorner + wR * ").concat(l,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(p,"; wC++) {\n              int xC = xCCorner + wC * ").concat(f,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(v,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===g,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(v,") *\n                  getW(wF, wR, wC, ").concat(v,", d2);\n              } else if (").concat(2===g,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(v,"),\n                  getX(batch, xF, xR, xC, ").concat(v," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(v,", d2),\n                  getW(wF, wR, wC, ").concat(v," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===g,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(v,"),\n                  getX(batch, xF, xR, xC, ").concat(v," + 1),\n                  getX(batch, xF, xR, xC, ").concat(v," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(v,", d2),\n                  getW(wF, wR, wC, ").concat(v," + 1, d2),\n                  getW(wF, wR, wC, ").concat(v," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),Zw=(0,s.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,u.Z)(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Vy(this.outputShape.length);for(var o=t.padInfo.left,s=t.strideWidth,c=t.dilationWidth,l=t.filterHeight,f=t.filterWidth,d=f,h="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;",p=0;p<f;p++)h+="\n           vec4 xTexelC".concat(2*p,";\n           int xTexelC").concat(2*p,"Ready;\n           vec4 xTexelC").concat(2*p+1,";\n           int xTexelC").concat(2*p+1,"Ready;\n           vec4 xC").concat(p,";");h+="\n     for (int r = 0; r < ".concat(l,"; r++) {\n      for (int d1 = 0; d1 < ").concat(t.inChannels,"; d1 += 2) {\n       ");for(var v=0;v<f;v++)h+="\n           xTexelC".concat(2*v," = vec4(0.0);\n           xTexelC").concat(2*v,"Ready = 0;\n           xTexelC").concat(2*v+1," = vec4(0.0);\n           xTexelC").concat(2*v+1,"Ready = 0;\n           xC").concat(v," = vec4(0.0);");h+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(var g=0;g<(d+1)/2;g++){var m=2*g;if(h+="\n           xC = xCCorner + ".concat(m*c,";\n           "),1===s){if(m<f&&(o%2===1?(h+="\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n               "),h+=1===c&&m>0?"\n                 xC".concat(m," = vec4(xTexelC").concat(m-2,".zw, xTexelC").concat(m,".xy);\n                 "):"\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC".concat(m," = vec4(previous.zw, xTexelC").concat(m,".xy);\n                   } else {\n                     xC").concat(m," = vec4(0.0, 0.0, xTexelC").concat(m,".xy);\n                   }\n                   ")):h+="\n                 if (xC >= 0 && xC < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n\n                 xC").concat(m," = xTexelC").concat(m,";\n                 "),m+1<f)){var y=o%2===0?Re.util.nearestLargerEven(c):c;c%2===0&&o%2===1||c%2!==0&&o%2!==1?(h+="\n                   xCOffset = xC + imod(pads[1], 2) + ".concat(y,";\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                     xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC").concat(m+1,".zw = vec2(0.0);\n                     }\n                     xTexelC").concat(m+1,"Ready = 1;\n                   }\n                   "),h+=c>1?"\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC".concat(m+1," = vec4(previous.zw, xTexelC").concat(m+1,".xy);\n                     } else {\n                      xC").concat(m+1," = vec4(0.0, 0.0, xTexelC").concat(m+1,".xy);\n                     }\n                     "):"\n                     xC".concat(m+1," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".xy);\n                     ")):h+=1===y?"\n                     xC".concat(m+1," = xTexelC").concat(m,";\n                     "):"\n                     xCOffset = xC + ".concat(y,";\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                       xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC").concat(m+1,".zw = vec2(0.0);\n                       }\n                       xTexelC").concat(m+1,"Ready = 1;\n                     }\n\n                     xC").concat(m+1," = xTexelC").concat(m+1,";\n                     ")}}else m<f&&(o%2===1?(h+="\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                   xTexelC").concat(m+1," = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC").concat(m+1,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m+1,"Ready = 1;\n                 }\n\n                 xC").concat(m," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".zw);\n               "),m+1<f&&(h+="\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC".concat(m+1," = vec4(xTexelC").concat(m+1,".xy, final.xy);\n                 "))):(h+="\n                 if(xC >= 0 && xC < inDims[1] && xTexelC".concat(m,"Ready == 0) {\n                   xTexelC").concat(m," = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC").concat(m,".zw = vec2(0.0);\n                   }\n                   xTexelC").concat(m,"Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(m+1,"Ready == 0) {\n                   xTexelC").concat(m+1," = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC").concat(m+1,".zw = vec2(0.);\n                   }\n                   xTexelC").concat(m+1,"Ready = 1;\n                 }\n\n                 xC").concat(m," = vec4(\n                   xTexelC").concat(m,".xy, xTexelC").concat(m+1,".xy);\n               "),m+1<f&&(h+="\n                   xC".concat(m+1," = vec4(xTexelC").concat(m,".zw, xTexelC").concat(m+1,".zw);\n                 "))));m<f&&(h+="\n             wTexel = getW(r, ".concat(m,", d1, d2);\n             dotProd += xC").concat(m,".xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ").concat(t.inChannels,") {\n               dotProd += xC").concat(m,".yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           "),m+1<f&&(h+="\n               wTexel = getW(r, ".concat(m+1,", d1, d2);\n               dotProd += xC").concat(m+1,".xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ").concat(t.inChannels,") {\n                 dotProd += xC").concat(m+1,".yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             ")))}h+="\n     }\n   ",h+="\n     }\n   ",h+="\n     }\n   ";var b="",x="";r&&(b=a?"vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ".concat(r,"\n         }"):i?"vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ".concat(r,"\n         }"):"vec4 activation(vec4 x) {\n           ".concat(r,"\n         }"),x="result = activation(result);");var k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n       ".concat(b,"\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ").concat(h,"\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ").concat(k,"\n         ").concat(x,"\n         setOutput(result);\n       }\n     ")})),Bw=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=Vy(this.outputShape.length);for(var r=n.dataFormat,a=ly(),i="channelsLast"===r,o=i?1:2,s=i?2:3,c=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":"if(blockIndex < ".concat(t[2]," && pos < ").concat(t[1],") {"),l="",f=0;f<=1;f++)for(var d=0;d<=1;d++)l+="\n          blockIndex = rc.z + ".concat(d,";\n          pos = rc.y + ").concat(f,";\n\n          ").concat(c,"\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[").concat(o,"] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[").concat(s,"] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (").concat(i,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*f+d,"] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*f+d,"] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(l,"\n\n        ").concat(a.output," = result;\n      }\n    ")}));function zw(e,t){var n=e.length;return n>=3?[].concat((0,o.Z)(e.slice(0,-3)),t?[e[n-3]*e[n-2],e[n-1]]:[e[n-3],e[n-2]*e[n-1]]):!t&&1===n&&e[0]>1?[e[0],1]:null}function Lw(e){var t,n=e.x,r=e.filter,a=e.convInfo,i=e.backend,o=e.bias,u=void 0===o?null:o,s=e.preluActivationWeights,c=void 0===s?null:s,l=e.leakyreluAlpha,f=void 0===l?0:l,d=e.activation,h=void 0===d?null:d,p=n.shape,v=i.texData.get(n.dataId),g=a.inChannels,m=p[0]*p[1]*p[2],y=a.outChannels,b="channelsLast"===a.dataFormat,x=[];if(null!=c){var k=zw(c.shape,b);null!=k&&(c=tk({inputs:{x:c},backend:i,attrs:{shape:k}}),x.push(c))}if(null!=u){var w=zw(u.shape,b);null!=w&&(u=tk({inputs:{x:u},backend:i,attrs:{shape:w}}),x.push(u))}if(!((1===m||1===y)&&g>1e3)&&v.isPacked&&b&&null!=v.texture&&p[2]%2!==0&&Re.util.arraysEqual(v.shape.slice(-3),p.slice(-3))){var _=p[0]*p[1]*(p[2]+1),C={dataId:n.dataId,shape:[1,_,a.inChannels],dtype:n.dtype},S=v.shape;v.shape=v.shape.slice(),v.shape[v.shape.length-2]++,Re.util.assert(ry(v.shape,C.shape),(function(){return"packed reshape ".concat(v.shape," to ").concat(C.shape," isn't free")}));var A=tk({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}});x.push(A);var E=hk({a:C,b:A,backend:i,transposeA:!1,transposeB:false,bias:u,activation:h,preluActivationWeights:c,leakyreluAlpha:f}),T=i.texData.get(E.dataId);Re.util.assert(T.isPacked,(function(){return"batchMatMul result is expected to be packed"})),v.shape=S,T.shape=a.outShape,(t=Ox({inputs:{x:E},backend:i})).shape=a.outShape,x.push(E)}else{var N=a.outHeight*a.outWidth,D=tk({inputs:{x:n},backend:i,attrs:{shape:b?[a.batchSize,N,a.inChannels]:[a.batchSize,a.inChannels,N]}}),F=tk({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}}),I=hk({a:b?D:F,b:b?F:D,transposeA:!b,transposeB:false,backend:i,bias:u,activation:h,preluActivationWeights:c,leakyreluAlpha:f});t=tk({inputs:{x:I},backend:i,attrs:{shape:a.outShape}}),x.push(D),x.push(F),x.push(I)}for(var M=0,O=x;M<O.length;M++){var R=O[M];i.disposeIntermediateTensorInfo(R)}return t}function Pw(e){var t=e.x,n=e.filter,r=e.convInfo,a=e.backend,i=e.bias,o=void 0===i?null:i,u=e.preluActivationWeights,s=void 0===u?null:u,c=e.leakyreluAlpha,l=void 0===c?0:c,f=e.activation,d=void 0===f?null:f,h=r.filterWidth,p=r.filterHeight,v=r.inChannels,g=r.outWidth,m=r.outHeight,y="channelsLast"===r.dataFormat,b=h*p*v,x=m*g,k=[r.batchSize,b,x],w=[];if(null!=s){var _=zw(s.shape,y);null!=_&&(s=tk({inputs:{x:s},backend:a,attrs:{shape:_}}),w.push(s))}if(null!=o){var C=zw(o.shape,y);null!=C&&(o=tk({inputs:{x:o},backend:a,attrs:{shape:C}}),w.push(o))}var S=tk({inputs:{x:n},backend:a,attrs:{shape:[1,b,Re.util.sizeFromShape(n.shape)/b]}});w.push(S);var A=new Bw(k,r),E=[t.shape,[r.padInfo.top,r.padInfo.left],[r.strideHeight,r.strideWidth],[r.dilationHeight,r.dilationWidth],[r.inChannels],[r.filterWidth*r.inChannels],[r.outWidth]],T=a.runWebGLProgram(A,[t],"float32",E),N=tk({inputs:{x:T},backend:a,attrs:{shape:k}});w.push(T),w.push(N);var D=null!=o,F=null!=s,I="leakyrelu"===d,M=d?Hx(d,!0):null,O=new Xx(y?N.shape:S.shape,y?S.shape:N.shape,y?[r.batchSize,x,r.outChannels]:[r.batchSize,r.outChannels,x],!0,!1,D,M,F,I),R=y?[N,S]:[S,N];if(o&&R.push(o),F&&R.push(s),I){var Z=a.makeTensorInfo([],"float32",Re.util.createScalarValue(l,"float32"));R.push(Z),w.push(Z)}var B=a.runWebGLProgram(O,R,"float32"),z=tk({inputs:{x:B},backend:a,attrs:{shape:r.outShape}});w.push(B);for(var L=0,P=w;L<P.length;L++){var j=P[L];a.disposeIntermediateTensorInfo(j)}return z}var jw={kernelName:Re.Conv2D,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,u=a.strides,s=a.pad,c=a.dataFormat,l=a.dilations,f=a.dimRoundingMode,d=Re.backend_util.convertConv2DDataFormat(c),h=Re.backend_util.computeConv2DInfo(i.shape,o.shape,u,l,s,f,!1,d);if(1!==h.filterHeight||1!==h.filterWidth||1!==h.dilationHeight||1!==h.dilationWidth||1!==h.strideHeight||1!==h.strideWidth||"SAME"!==h.padInfo.type&&"VALID"!==h.padInfo.type)if(h.strideWidth<=2&&"channelsLast"===d&&(0,Re.env)().getBool("WEBGL_EXP_CONV")){var p=new Zw(h),v=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];t=r.runWebGLProgram(p,[i,o],"float32",v)}else if((0,Re.env)().getBool("WEBGL_CONV_IM2COL"))t=Pw({x:i,filter:o,convInfo:h,backend:r});else{var g=new Ow(h);t=r.runWebGLProgram(g,[i,o],"float32")}else t=Lw({x:i,filter:o,convInfo:h,backend:r});var m=tk({inputs:{x:t},backend:r,attrs:{shape:h.outShape}});return r.disposeIntermediateTensorInfo(t),m}},Uw=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              if (").concat(o,") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),Ww=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o="channelsLast"===t.dataFormat,s=n-1-t.padInfo.top,c=r-1-t.padInfo.left,l=o?1:2,f=o?2:3,d=o?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(c,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(d,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(l,"], coords[").concat(f,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(o,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),Vw=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.padInfo.front,o=t.padInfo.top,s=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(n," - ").concat(i,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(r," - ").concat(o,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(s,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),Gw=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,c=n-1-t.padInfo.front,l=r-1-t.padInfo.top,f=a-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(c,", ").concat(l,", ").concat(f,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(n,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(i,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(n," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(r,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(r," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var qw={kernelName:Re.Conv2DBackpropFilter,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,u=r.pad,s=r.dataFormat,c=r.dimRoundingMode,l=r.filterShape,f=Re.backend_util.convertConv2DDataFormat(s),d=Re.backend_util.computeConv2DInfo(a.shape,l,o,1,u,c,!1,f),h=new Uw(d);return n.runWebGLProgram(h,[a,i],"float32")}};var Hw={kernelName:Re.Conv2DBackpropInput,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.inputShape,u=r.strides,s=r.pad,c=r.dataFormat,l=r.dimRoundingMode,f=Re.backend_util.convertConv2DDataFormat(c),d=Re.backend_util.computeConv2DInfo(o,i.shape,u,1,s,l,!1,f),h=new Ww(d);return n.runWebGLProgram(h,[a,i],"float32")}};var Xw={kernelName:Re.Conv3D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,u=r.pad,s=r.dilations,c=Re.backend_util.computeConv3DInfo(a.shape,i.shape,o,s,u),l=new Rw(c);return n.runWebGLProgram(l,[a,i],"float32")}};var Yw={kernelName:Re.Conv3DBackpropFilterV2,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,u=r.pad,s=r.filterShape,c=Re.backend_util.computeConv3DInfo(a.shape,s,o,1,u),l=new Vw(c);return n.runWebGLProgram(l,[a,i],"float32")}};var Kw,$w={kernelName:Re.Conv3DBackpropInputV2,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.pad,u=r.strides,s=r.inputShape,c=Re.backend_util.computeConv3DInfo(s,i.shape,u,1,o),l=new Gw(c);return n.runWebGLProgram(l,[a,i],"float32")}},Qw=Gx({opSnippet:Vx+"\n  return cos(x);\n"}),Jw={kernelName:Re.Cos,backendName:"webgl",kernelFunc:Qw},e_=Gx({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),t_={kernelName:Re.Cosh,backendName:"webgl",kernelFunc:e_},n_=(0,s.Z)((function e(t,n,r,a,o){(0,u.Z)(this,e),this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var s=(0,i.Z)(t,4),c=s[0],l=s[1],f=s[2],d=s[3],h=(0,i.Z)(n,1)[0],p=(0,i.Z)(r,2),v=p[0],g=p[1];this.outputShape=[h,v,g,d];var m="bilinear"===a?1:0,y="".concat(l-1,".0"),b="".concat(f-1,".0"),x=v>1?["".concat((l-1)/(v-1)),"(y2-y1) * height_ratio","y1*".concat(y," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(y)],k=(0,i.Z)(x,3),w=k[0],_=k[1],C=k[2],S=g>1?["".concat((f-1)/(g-1)),"(x2-x1) * width_ratio","x1*".concat(b," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(b)],A=(0,i.Z)(S,3),E=A[0],T=A[1],N=A[2];this.userCode="\n      const float height_ratio = float(".concat(w,");\n      const float width_ratio = float(").concat(E,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(c,") {\n          return;\n        }\n\n        float height_scale = ").concat(_,";\n        float width_scale = ").concat(T,";\n\n        float in_y = ").concat(C,";\n        if( in_y < 0.0 || in_y > ").concat(y," ) {\n          setOutput(float(").concat(o,"));\n          return;\n        }\n        float in_x = ").concat(N,";\n        if( in_x < 0.0 || in_x > ").concat(b," ) {\n          setOutput(float(").concat(o,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(m," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")})),r_={kernelName:Re.CropAndResize,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,u=r.cropSize,s=r.method,c=r.extrapolationValue,l=new n_(a.shape,i.shape,u,s,c);return n.runWebGLProgram(l,[a,i,o],"float32")}};!function(e){e.Prod="*",e.Sum="+"}(Kw||(Kw={}));var a_=(0,s.Z)((function e(t,n,r,a){(0,u.Z)(this,e),this.op=t,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];var i=this.outputShape.length,o=this.op===Kw.Prod?"1.0":"0.0",s=r?o:"getX(".concat(i_(i,"coords",this.op),")"),c=this.outputShape[this.outputShape.length-1],l="",f="";r?(l=a?"end != ".concat(c-1):"end != 0",f=a?"end + 1":"end - 1"):(l=a?"end + pow2 < ".concat(c):"end >= pow2",f=a?"end + pow2":"end - pow2"),this.userCode="\n      void main() {\n        ".concat(Ry(i)," coords = getOutputCoords();\n        int end = ").concat(o_(i,"coords",this.op),";\n        float val = ").concat(s,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(l,") {\n          int idx = ").concat(f,";\n          ").concat(o_(i,"coords",this.op)," = idx;\n          val ").concat(this.op,"= getX(").concat(i_(i,"coords",this.op),");\n        }\n        setOutput(val);\n      }\n    ")}));function i_(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function o_(e,t,n){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw new Error("Cumulative ".concat(n," for rank ").concat(e," is not yet supported"))}function u_(e,t,n,r,a,i){var o=t.shape.length,u=Re.backend_util.getAxesPermutation([r],o),s=t;null!=u&&(s=fk({inputs:{x:t},backend:n,attrs:{perm:u}}));var c=Re.backend_util.getInnerMostAxes(1,o)[0];if(c!==o-1)throw new Error("WebGL cumprod shader expects an inner-most axis=".concat(t.shape.length-1," ")+"but got axis=".concat(r));for(var l=s.shape[c],f=Ox({inputs:{x:s},backend:n}),d=0;d<=Math.ceil(Math.log2(l))-1;d++){var h=new a_(e,s.shape,!1,i),p=[[d]],v=f;f=n.runWebGLProgram(h,[f],f.dtype,p),n.disposeIntermediateTensorInfo(v)}if(a){var g=new a_(e,s.shape,a,i),m=f;f=n.runWebGLProgram(g,[f],f.dtype),n.disposeIntermediateTensorInfo(m)}if(null!=u){var y=fk({inputs:{x:f},backend:n,attrs:{perm:Re.backend_util.getUndoAxesPermutation(u)}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(s),y}return f}var s_={kernelName:Re.Cumprod,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,u=r.reverse;return u_(Kw.Prod,a,n,i,o,u)}};var c_={kernelName:Re.Cumsum,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,o=r.exclusive,u=r.reverse;return u_(Kw.Sum,a,n,i,o,u)}};var l_={kernelName:Re.DenseBincount,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,u=r.binaryOutput;if(1===a.shape.length){var s=n.readSync(a.dataId),c=n.readSync(i.dataId),l=lb(s,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,l)}if(2===a.shape.length){var f=n.bufferSync(a),d=n.bufferSync(i),h=fb(f,d,o,u);return n.makeTensorInfo(h.shape,i.dtype,h.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}},f_=function(){function e(t,n,r){(0,u.Z)(this,e),this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(n,";\n      int offset_h = imod(h, ").concat(n,");\n      int in_w = w / ").concat(n,";\n      int offset_w = imod(w, ").concat(n,");\n      int offset_d = (offset_h * ").concat(n," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return(0,s.Z)(e,[{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),e}();var d_={kernelName:Re.DepthToSpace,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,o=r.dataFormat,u=a.shape[0],s=("NHWC"===o?a.shape[1]:a.shape[2])*i,c=("NHWC"===o?a.shape[2]:a.shape[3])*i,l=("NHWC"===o?a.shape[3]:a.shape[1])/(i*i),f=new f_("NHWC"===o?[u,s,c,l]:[u,l,s,c],i,o);return n.runWebGLProgram(f,[a],a.dtype)}},h_=(0,s.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,u.Z)(this,e),this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Vy(this.outputShape.length);var o=t.filterHeight,s=t.filterWidth,c=t.outChannels/t.inChannels,l="",f="";r&&(l=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),f="result = activation(result);");var d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(l,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(c,";\n        int q = d2 - d1 * ").concat(c,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(o,"; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(s,"; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(d,"\n        ").concat(f,"\n        setOutput(result);\n      }\n    ")})),p_=(0,s.Z)((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,u.Z)(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Vy(this.outputShape.length);for(var o=t.outChannels/t.inChannels,s=t.padInfo.left,c=t.strideWidth,l=t.dilationWidth,f=t.filterHeight,d=t.filterWidth,h=d,p="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;",v=0;v<d;v++)p+="\n          vec4 xTexelC".concat(2*v,";\n          int xTexelC").concat(2*v,"Ready;\n          vec4 xTexelC").concat(2*v+1,";\n          int xTexelC").concat(2*v+1,"Ready;\n          vec4 xC").concat(v,";");p+="\n    for (int r = 0; r < ".concat(f,"; r++) {\n      ");for(var g=0;g<d;g++)p+="\n          xTexelC".concat(2*g," = vec4(0.0);\n          xTexelC").concat(2*g,"Ready = 0;\n          xTexelC").concat(2*g+1," = vec4(0.0);\n          xTexelC").concat(2*g+1,"Ready = 0;\n          xC").concat(g," = vec4(0.0);");p+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(var m=0;m<(h+1)/2;m++){var y=2*m;if(p+="\n          xC = xCCorner + ".concat(y*l,";\n          "),1===c){if(y<d&&(s%2===1?(p+="\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(y,"Ready == 0) {\n                  xTexelC").concat(y," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(y,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(y,"Ready = 1;\n                }\n              "),p+=1===l&&y>0?"\n                xC".concat(y," = vec4(xTexelC").concat(y-2,".zw, xTexelC").concat(y,".xy);\n                "):"\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC".concat(y," = vec4(previous.zw, xTexelC").concat(y,".xy);\n                  } else {\n                    xC").concat(y," = vec4(0.0, 0.0, xTexelC").concat(y,".xy);\n                  }\n                  ")):p+="\n                if (xC >= 0 && xC < inDims[1] && xTexelC".concat(y,"Ready == 0) {\n                  xTexelC").concat(y," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(y,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(y,"Ready = 1;\n                }\n\n                xC").concat(y," = xTexelC").concat(y,";\n                "),y+1<d)){var b=s%2===0?Re.util.nearestLargerEven(l):l;l%2===0&&s%2===1||l%2!==0&&s%2!==1?(p+="\n                  xCOffset = xC + imod(pads[1], 2) + ".concat(b,";\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(y+1,"Ready == 0) {\n                    xTexelC").concat(y+1," = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC").concat(y+1,".zw = vec2(0.0);\n                    }\n                    xTexelC").concat(y+1,"Ready = 1;\n                  }\n                  "),p+=l>1?"\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC".concat(y+1," = vec4(previous.zw, xTexelC").concat(y+1,".xy);\n                    } else {\n                     xC").concat(y+1," = vec4(0.0, 0.0, xTexelC").concat(y+1,".xy);\n                    }\n                    "):"\n                    xC".concat(y+1," = vec4(xTexelC").concat(y,".zw, xTexelC").concat(y+1,".xy);\n                    ")):p+=1===b?"\n                    xC".concat(y+1," = xTexelC").concat(y,";\n                    "):"\n                    xCOffset = xC + ".concat(b,";\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(y+1,"Ready == 0) {\n                      xTexelC").concat(y+1," = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC").concat(y+1,".zw = vec2(0.0);\n                      }\n                      xTexelC").concat(y+1,"Ready = 1;\n                    }\n\n                    xC").concat(y+1," = xTexelC").concat(y+1,";\n                    ")}}else y<d&&(s%2===1?(p+="\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC".concat(y,"Ready == 0) {\n                  xTexelC").concat(y," = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(y,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(y,"Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC").concat(y+1,"Ready == 0) {\n                  xTexelC").concat(y+1," = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC").concat(y+1,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(y+1,"Ready = 1;\n                }\n\n                xC").concat(y," = vec4(xTexelC").concat(y,".zw, xTexelC").concat(y+1,".zw);\n              "),y+1<d&&(p+="\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC".concat(y+1," = vec4(xTexelC").concat(y+1,".xy, final.xy);\n                "))):(p+="\n                if(xC >= 0 && xC < inDims[1] && xTexelC".concat(y,"Ready == 0) {\n                  xTexelC").concat(y," = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC").concat(y,".zw = vec2(0.0);\n                  }\n                  xTexelC").concat(y,"Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC").concat(y+1,"Ready == 0) {\n                  xTexelC").concat(y+1," = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC").concat(y+1,".zw = vec2(0.);\n                  }\n                  xTexelC").concat(y+1,"Ready = 1;\n                }\n\n                xC").concat(y," = vec4(\n                  xTexelC").concat(y,".xy, xTexelC").concat(y+1,".xy);\n              "),y+1<d&&(p+="\n                  xC".concat(y+1," = vec4(xTexelC").concat(y,".zw, xTexelC").concat(y+1,".zw);\n                "))));y<d&&(p+="\n            wTexel = getW(r, ".concat(y,", d1, q);\n            dotProd += xC").concat(y," * vec4(wTexel.xz, wTexel.xz);\n          "),y+1<d&&(p+="\n              wTexel = getW(r, ".concat(y+1,", d1, q);\n              dotProd += xC").concat(y+1," * vec4(wTexel.xz, wTexel.xz);\n            ")))}p+="\n    }\n  ",p+="\n      }\n    ";var x="",k="";r&&(x=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(r,"\n        }"),k="result = activation(result);");var w=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(x,"\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(o,";\n        int q = d2 - d1 * ").concat(o,";\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ").concat(p,"\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ").concat(w,"\n        ").concat(k,"\n        setOutput(result);\n      }\n    ")}));var v_={kernelName:Re.DepthwiseConv2dNative,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,u=r.pad,s=r.dilations,c=r.dimRoundingMode,l=s;null==l&&(l=[1,1]),Re.util.assert(Re.backend_util.eitherStridesOrDilationsAreOne(o,l),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(o," and dilations '").concat(l,"'")}));var f,d=Re.backend_util.computeConv2DInfo(a.shape,i.shape,o,l,u,c,!0);f=(0,Re.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?new p_(d):new h_(d);var h=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(f,[a,i],"float32",h)}},g_=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(o," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),m_=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=n-1-t.padInfo.top,s=r-1-t.padInfo.left,c=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(c,"; dm++) {\n              int d2 = d1 * ").concat(c," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var y_={kernelName:Re.DepthwiseConv2dNativeBackpropFilter,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,o=r.strides,u=r.dilations,s=r.pad,c=r.dimRoundingMode,l=r.filterShape,f=Re.backend_util.computeConv2DInfo(a.shape,l,o,u,s,c,!0),d=new g_(f);return n.runWebGLProgram(d,[a,i],"float32")}};var b_={kernelName:Re.DepthwiseConv2dNativeBackpropInput,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,o=r.strides,u=r.dilations,s=r.pad,c=r.dimRoundingMode,l=r.inputShape,f=Re.backend_util.computeConv2DInfo(l,i.shape,o,u,s,c,!0),d=new m_(f);return n.runWebGLProgram(d,[a,i],"float32")}},x_=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}));var k_={kernelName:Re.Diag,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=[].concat((0,o.Z)(r.shape),(0,o.Z)(r.shape)),i=Re.util.sizeFromShape(r.shape),u=tk({inputs:{x:r},backend:n,attrs:{shape:[i]}}),s=new x_(i),c=n.runWebGLProgram(s,[u],u.dtype),l=tk({inputs:{x:c},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),l}},w_=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.inHeight,r=t.inWidth,a=t.padInfo,i=t.strideHeight,o=t.strideWidth,s=t.filterHeight,c=t.filterWidth,l=t.dilationHeight,f=t.dilationWidth,d=a.top,h=a.left;this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(h,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(s,"; h++) {\n          int hIn = hBeg + h * ").concat(l,";\n\n          if (hIn >= 0 && hIn < ").concat(n,") {\n            for (int w = 0; w < ").concat(c,"; w++) {\n              int wIn = wBeg + w * ").concat(f,";\n\n              if (wIn >= 0 && wIn < ").concat(r,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")}));var __={kernelName:Re.Dilation2D,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,u=a.strides,s=a.pad,c=a.dilations,l=Re.backend_util.computeDilation2DInfo(i.shape,o.shape,u,s,"NHWC",c),f=new w_(l),d=tk({inputs:{x:t=r.runWebGLProgram(f,[i,o],"float32")},backend:r,attrs:{shape:l.outShape}});return r.disposeIntermediateTensorInfo(t),d}};var C_={kernelName:Re.Einsum,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.equation,a=t,i=Re.backend_util.decodeEinsumEquation(r,a.length),o=i.allDims,u=i.summedDims,s=i.idDims;Re.backend_util.checkEinsumDimSizes(o.length,s,a);for(var c=Re.backend_util.getEinsumComputePath(u,s),l=c.path,f=c.steps,d=f.length,p=null,v=o.length,g=[],m=0;m<d;++m){var y,b=(0,h.Z)(f[m]);try{for(b.s();!(y=b.n()).done;){var x=y.value,k=Re.backend_util.getEinsumPermutation(v,s[x]),w=k.permutationIndices,_=k.expandDims,C=void 0;Re.backend_util.isIdentityPermutation(w)?C=a[x]:(C=fk({inputs:{x:a[x]},backend:n,attrs:{perm:w}}),g.push(C));for(var S=C.shape.slice(),A=0;A<_.length;++A)S.splice(_[A],0,1);Re.util.arraysEqual(C.shape,S)||(C=tk({inputs:{x:C},backend:n,attrs:{shape:S}}),g.push(C)),null===p?p=C:(p=Jx({inputs:{a:C,b:p},backend:n}),g.push(p))}}catch(D){b.e(D)}finally{b.f()}m<d-1&&(l[m]>=0&&(p=ck({inputs:{x:p},backend:n,attrs:{axis:l[m]-(o.length-v),keepDims:!1}}),g.push(p)),v--)}for(var E=0,T=g;E<T.length;E++){var N=T[E];N!==p&&n.disposeIntermediateTensorInfo(N)}return p}},S_=Gx({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),A_={kernelName:Re.Elu,backendName:"webgl",kernelFunc:S_},E_={kernelName:Re.EluGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y,i=(0,Re.env)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mx("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,a.shape):new Fx("return (b >= 1.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}},T_=qx({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:vb}),N_={kernelName:Re.Equal,backendName:"webgl",kernelFunc:T_},D_=Gx({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(Re.backend_util.ERF_P,";\n  float a1 = ").concat(Re.backend_util.ERF_A1,";\n  float a2 = ").concat(Re.backend_util.ERF_A2,";\n  float a3 = ").concat(Re.backend_util.ERF_A3,";\n  float a4 = ").concat(Re.backend_util.ERF_A4,";\n  float a5 = ").concat(Re.backend_util.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),F_={kernelName:Re.Erf,backendName:"webgl",kernelFunc:D_},I_=Gx({opSnippet:Vx+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:gb,dtype:"float32"}),M_={kernelName:Re.Exp,backendName:"webgl",kernelFunc:I_};function O_(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.dim,i=t.input,o=i.shape.length,u=i.shape.slice(),s=a;return a<0&&(Re.util.assert(-(o+1)<=a,(function(){return"Axis must be in the interval [".concat(-(o+1),", ").concat(o,"]")})),s=o+a+1),u.splice(s,0,1),tk({inputs:{x:i},backend:r,attrs:{shape:u}})}var R_={kernelName:Re.ExpandDims,backendName:"webgl",kernelFunc:O_},Z_="return exp(x) - 1.0;",B_=Gx({opSnippet:Z_,packedOpSnippet:Z_,cpuKernelImpl:mb}),z_={kernelName:Re.Expm1,backendName:"webgl",kernelFunc:B_},L_=(0,s.Z)((function e(t,n,r){(0,u.Z)(this,e),this.variableNames=["real","imag"];var a=n[1];this.outputShape=n;var i,o=r?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),s=r?"".concat(a,".0"):"1.0";if("real"===t)i="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));i="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(o,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(i,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(s,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")}));function P_(e,t,n){var r=n.texData.get(e.dataId),a=Re.util.sizeFromShape(e.shape),i=e.shape[e.shape.length-1],o=tk({inputs:{x:e},backend:n,attrs:{shape:[a/i,i]}}),u=o.shape,s=new L_("real",u,t),c=new L_("imag",u,t),l=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:u},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:u}],f=n.runWebGLProgram(s,l,"float32"),d=n.runWebGLProgram(c,l,"float32"),h=Zx({inputs:{real:f,imag:d},backend:n});n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d);var p=tk({inputs:{x:h},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(h),p}var j_={kernelName:Re.FFT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return P_(t.input,!1,n)}},U_=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}));function W_(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype;if("string"===(i=i||Re.util.inferDtype(a))){var o=Re.util.getArrayFromDType(i,Re.util.sizeFromShape(r));return o.fill(a),t.makeTensorInfo(r,i,o)}var u=new U_(r,a),s=[[a]];return t.runWebGLProgram(u,[],i,s)}var V_,G_={kernelName:Re.Fill,backendName:"webgl",kernelFunc:W_},q_=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["Image"],this.outputShape=[];var n=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(n," - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(n,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")})),H_={kernelName:Re.FlipLeftRight,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.image,a=n,i=new q_(r.shape);return a.runWebGLProgram(i,[r],r.dtype)}},X_="return floor(x);",Y_=Gx({opSnippet:X_,packedOpSnippet:X_,cpuKernelImpl:yb}),K_={kernelName:Re.Floor,backendName:"webgl",kernelFunc:Y_},$_=qx({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),Q_={kernelName:Re.FloorDiv,backendName:"webgl",kernelFunc:$_},J_=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["A"];var n=ly(),r=(0,i.Z)(t,2),a=r[0],o=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(o,".0, ").concat(a,".0);\n\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")})),eC=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=ly(),r=(0,i.Z)(t,2),a=r[0],o=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(o,".0, ").concat(a,".0);\n            vec4 values = ").concat(n.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),tC={kernelName:Re.FromPixels,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,o=r.numChannels,u="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,c=u?[a.videoWidth,a.videoHeight]:[a.width,a.height],l=(0,i.Z)(c,2),f=l[0],d=l[1],h=[d,f],p=[d,f,o];if(s||u){var v=(0,Re.env)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=V_&&v===nC||(nC=v,V_=document.createElement("canvas").getContext("2d",{willReadFrequently:nC})),V_.canvas.width=f,V_.canvas.height=d,V_.drawImage(a,0,0,f,d),a=V_.canvas}var g=n.makeTensorInfo(h,"int32");n.texData.get(g.dataId).usage=Em.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(g.dataId),a);var m=(0,Re.env)().getBool("WEBGL_PACK")?new eC(p):new J_(p),y=n.runWebGLProgram(m,[g],"int32");return n.disposeData(g.dataId),y}},nC=(0,Re.env)().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");var rC={kernelName:Re.FusedConv2D,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=n.filter,u=n.bias,s=n.preluActivationWeights,c=a.strides,l=a.pad,f=a.dataFormat,d=a.dilations,h=a.dimRoundingMode,p=a.activation,v=a.leakyreluAlpha,g=Re.backend_util.convertConv2DDataFormat(f),m=Re.backend_util.computeConv2DInfo(i.shape,o.shape,c,d,l,h,!1,g),y=[],b=null!=u,x=null!=s,k="leakyrelu"===p,w=function(){var e=[i,o],t=function(e,t){if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){var n=tk({inputs:{x:e},backend:r,attrs:{shape:[e.shape[0],1,1]}});return y.push(n),n}return e};if(b&&e.push(t(u,f)),x&&e.push(t(s,f)),k){var n=r.makeTensorInfo([],"float32",Re.util.createScalarValue(v,"float32"));e.push(n),y.push(n)}return e};if(1!==m.filterHeight||1!==m.filterWidth||1!==m.dilationHeight||1!==m.dilationWidth||1!==m.strideHeight||1!==m.strideWidth||"SAME"!==m.padInfo.type&&"VALID"!==m.padInfo.type)if(m.strideWidth<=2&&"channelsLast"===g&&(0,Re.env)().getBool("WEBGL_EXP_CONV")){var _=p?Hx(p,!0):null,C=new Zw(m,b,_,x,k),S=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],A=w();t=r.runWebGLProgram(C,A,"float32",S)}else if((0,Re.env)().getBool("WEBGL_CONV_IM2COL"))t=Pw({x:i,filter:o,convInfo:m,backend:r,bias:u,activation:p,preluActivationWeights:s,leakyreluAlpha:v});else{var E=p?Hx(p,!1):null,T=new Ow(m,b,E,x,k),N=w();t=r.runWebGLProgram(T,N,"float32")}else t=Lw({x:i,filter:o,convInfo:m,backend:r,bias:u,activation:p,preluActivationWeights:s,leakyreluAlpha:v});var D=tk({inputs:{x:t},backend:r,attrs:{shape:m.outShape}});return y.push(t),y.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),D}};var aC={kernelName:Re.FusedDepthwiseConv2D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.bias,u=t.preluActivationWeights,s=r.strides,c=r.pad,l=r.dilations,f=r.dimRoundingMode,d=r.activation,h=r.leakyreluAlpha,p=[],v=l;null==v&&(v=[1,1]),Re.util.assert(Re.backend_util.eitherStridesOrDilationsAreOne(s,v),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(s," and dilations '").concat(v,"'")}));var g,m=Re.backend_util.computeConv2DInfo(a.shape,i.shape,s,v,c,f,!0),y=(0,Re.env)().getBool("WEBGL_PACK_DEPTHWISECONV")&&m.strideWidth<=2&&m.outChannels/m.inChannels===1,b=d?Hx(d,y):null,x=[a,i],k=null!=o,w=null!=u,_="leakyrelu"===d;if(k&&x.push(o),w&&x.push(u),_){var C=n.makeTensorInfo([],"float32",Re.util.createScalarValue(h,"float32"));x.push(C),p.push(C)}g=y?new p_(m,k,b,w,_):new h_(m,k,b,w,_);var S=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],A=n.runWebGLProgram(g,x,"float32",S);return p.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),A}},iC=(0,s.Z)((function e(t,n,r,a){(0,u.Z)(this,e),this.sliceDim=t,this.strides=n,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=r;for(var i=Ry(r.length),o="\n    int index;",s=0;s<this.sliceDim;s++)o+="\n          index = round(getIndices(coords[0], ".concat(s,"));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ").concat(this.paramsShape[s],";\n          flattenIndex += index * ").concat(this.strides[s],";");this.userCode="\n         void main() {\n          ".concat(i," coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ").concat(o,"\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      ")}));var oC={kernelName:Re.GatherNd,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,o=a.shape,u=o[o.length-1],s=Re.util.sizeFromShape(r.shape),c=Re.backend_util.prepareAndValidate(r,a),l=(0,i.Z)(c,4),f=l[0],d=l[1],h=l[2],p=l[3],v=tk({inputs:{x:a},backend:n,attrs:{shape:[d,u]}}),g=tk({inputs:{x:r},backend:n,attrs:{shape:[Re.util.sizeFromShape(r.shape)/h,h]}});if(n.shouldExecuteOnCPU([r,a])||"string"===r.dtype){var m=n.readSync(a.dataId),y=n.bufferSync(r),b=bb(m,y,r.dtype,d,u,h,p,r.shape,s);return n.makeTensorInfo(f,r.dtype,b.values)}var x=new iC(u,p,[d,h],r.shape),k=n.runWebGLProgram(x,[g,v],g.dtype),w=tk({inputs:{x:k},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(k),w}},uC=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;var r=Ry(this.rank),a=function(e,t){for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],a=0;a<e.length;a++)2===a?r.push("index"):r.push("".concat(n[a]));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ").concat(t[2],") ? 1.0 : 0.0;\n        setOutput(inBounds * getA(").concat(a,"));\n      }\n    ")}));function sC(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,o=r.axis,u=r.batchDims,s=Re.util.parseAxisParam(o,a.shape)[0];if((0,Re.env)().get("DEBUG"))for(var c=n.readSync(i.dataId),l=a.shape[s],f=function(){var e=c[d];Re.util.assert(e<=l-1&&e>=0,(function(){return"GatherV2: the index value ".concat(e," is not in [0, ").concat(l-1,"]")}))},d=0;d<c.length;++d)f();var h=Re.backend_util.segment_util.collectGatherOpShapeInfo(a,i,s,u),p=Re.util.sizeFromShape(i.shape),v=[],g=tk({inputs:{x:a},backend:n,attrs:{shape:[h.batchSize,h.outerSize,h.dimSize,h.sliceSize]}}),m=tk({inputs:{x:i},backend:n,attrs:{shape:[h.batchSize,p/h.batchSize]}});v.push(g),v.push(m);var y=[h.batchSize,h.outerSize,p/h.batchSize,h.sliceSize];if(n.shouldExecuteOnCPU([a,i])||"string"===a.dtype){var b=n.bufferSync(m),x=n.bufferSync(g),k=xb(x,b,y);return v.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(h.outputShape,k.dtype,k.values)}var w=new uC(g.shape,y),_=n.runWebGLProgram(w,[g,m],g.dtype);v.push(_);var C=tk({inputs:{x:_},backend:n,attrs:{shape:h.outputShape}});return v.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),C}var cC={kernelName:Re.GatherV2,backendName:"webgl",kernelFunc:sC},lC=qx({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:kb,dtype:"bool"}),fC={kernelName:Re.Greater,backendName:"webgl",kernelFunc:lC},dC=qx({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:wb}),hC={kernelName:Re.GreaterEqual,backendName:"webgl",kernelFunc:dC};var pC={kernelName:Re.IFFT,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return P_(t.input,!0,n)}},vC=Gx({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),gC={kernelName:Re.IsFinite,backendName:"webgl",kernelFunc:vC},mC=Gx({opSnippet:"return float(isinf(x));",dtype:"bool"}),yC={kernelName:Re.IsInf,backendName:"webgl",kernelFunc:mC},bC=Gx({opSnippet:"return float(isnan(x));",dtype:"bool"}),xC={kernelName:Re.IsNan,backendName:"webgl",kernelFunc:bC},kC=qx({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:_b,dtype:"bool"}),wC={kernelName:Re.Less,backendName:"webgl",kernelFunc:kC},_C=qx({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:Cb,dtype:"bool"}),CC={kernelName:Re.LessEqual,backendName:"webgl",kernelFunc:_C};var SC={kernelName:Re.LinSpace,backendName:"webgl",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.num,o=Sb(r,a,i);return t.makeTensorInfo([o.length],"float32",o)}},AC=Gx({opSnippet:Vx+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:Ab}),EC={kernelName:Re.Log,backendName:"webgl",kernelFunc:AC},TC=Gx({opSnippet:Vx+"\n  return log(1.0 + x);\n"}),NC={kernelName:Re.Log1p,backendName:"webgl",kernelFunc:TC},DC=qx({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),FC={kernelName:Re.LogicalAnd,backendName:"webgl",kernelFunc:DC},IC=Gx({opSnippet:"return float(!(x >= 1.0));"}),MC={kernelName:Re.LogicalNot,backendName:"webgl",kernelFunc:IC},OC=qx({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),RC={kernelName:Re.LogicalOr,backendName:"webgl",kernelFunc:OC},ZC=(0,s.Z)((function e(t,n,r,a,i){(0,u.Z)(this,e),this.variableNames=["x"],this.outputShape=[];var o,s=n,c=t[3]-1;this.outputShape=t;var l="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(l,")"):1===i?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(s,"; j <= ").concat(s,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(c,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")})),BC=(0,s.Z)((function e(t,n,r,a,i){(0,u.Z)(this,e),this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,s=n,c=t[3]-1;this.outputShape=t;var l="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(l,")"):1===i?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(s,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(s,"; j <= ").concat(s,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(c,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")})),zC={kernelName:Re.LRN,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,o=r.bias,u=r.alpha,s=r.beta,c=(0,Re.env)().getBool("WEBGL_PACK_NORMALIZATION")?new BC(a.shape,i,o,u,s):new ZC(a.shape,i,o,u,s);return n.runWebGLProgram(c,[a],a.dtype)}},LC=(0,s.Z)((function e(t,n,r,a,i){(0,u.Z)(this,e),this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(n,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(n," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(r,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(i,")\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")})),PC={kernelName:Re.LRNGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,u=r.depthRadius,s=r.bias,c=r.alpha,l=r.beta,f=new LC(a.shape,u,s,c,l);return n.runWebGLProgram(f,[a,i,o],a.dtype)}};function jC(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.reductionIndices,u=r.keepDims,s=a.shape.length,c=Re.util.parseAxisParam(o,a.shape),l=c,f=Re.backend_util.getAxesPermutation(l,s),d=null!=f,h=n.shouldExecuteOnCPU([a]),p=a;if(d){if(h){for(var v=n.texData.get(p.dataId).values,g=new Array(s),m=0;m<g.length;m++)g[m]=a.shape[f[m]];var y=ex(v,a.shape,a.dtype,f,g);p=n.makeTensorInfo(g,a.dtype),n.texData.get(p.dataId).values=y}else p=sk(a,f,n);l=Re.backend_util.getInnerMostAxes(l.length,s)}Re.backend_util.assertAxesAreInnerMostDims("max",l,s);var b,x=Re.backend_util.computeOutAndReduceShapes(p.shape,l),k=(0,i.Z)(x,2),w=k[0],_=k[1],C=w;if(u&&(C=Re.backend_util.expandShapeToKeepDim(w,c)),h){var S=n.texData.get(p.dataId).values,A=Eb(S,Re.util.sizeFromShape(_),C,a.dtype);b=n.makeTensorInfo(C,a.dtype),n.texData.get(b.dataId).values=A}else b=function(e,t,n,r){var a=Re.util.sizeFromShape(t),i=tk({inputs:{x:e},attrs:{shape:[Re.util.sizeFromShape(e.shape)/a,a]},backend:r}),o=ik(i,e.dtype,"max",r),u=tk({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),u}(p,_,C,n);return d&&n.disposeIntermediateTensorInfo(p),b}var UC={kernelName:Re.Max,backendName:"webgl",kernelFunc:jC},WC=qx({opSnippet:Dx+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Ix+"\n  return result;\n",cpuKernelImpl:Tb}),VC={kernelName:Re.Maximum,backendName:"webgl",kernelFunc:WC};var GC={kernelName:Re.MaxPool,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;sy(a,"maxPool");var i=r.filterSize,o=r.strides,u=r.pad,s=r.dimRoundingMode;Re.util.assert(Re.backend_util.eitherStridesOrDilationsAreOne(o,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(1,"'")}));var c=Re.backend_util.computePool2DInfo(a.shape,i,o,1,u,s);if(1===c.filterWidth&&1===c.filterHeight&&Re.util.arraysEqual(c.inShape,c.outShape))return Ox({inputs:{x:a},backend:n});var l=new qk(c,"max",!1);return n.runWebGLProgram(l,[a],a.dtype)}};var qC={kernelName:Re.MaxPool3D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,o=r.strides,u=r.pad,s=r.dataFormat,c=r.dimRoundingMode,l=Re.backend_util.computePool3DInfo(a.shape,i,o,[1,1,1],u,c,s),f=new Hk(l,"max",!1);return n.runWebGLProgram(f,[a],a.dtype)}},HC=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideHeight,r=t.strideWidth,a=t.dilationHeight,i=t.effectiveFilterHeight,o=t.effectiveFilterWidth,s=i-1-t.padInfo.top,c=o-1-t.padInfo.left,l=i*o-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(c,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(i,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(l," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(o," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),XC=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,s=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=c-1-t.padInfo.front,h=l-1-t.padInfo.top,p=f-1-t.padInfo.left,v=c*l*f-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(d,", ").concat(h,", ").concat(p,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(c,";\n           wD += ").concat(i,") {\n          float dyD = float(dyDCorner + wD) / ").concat(n,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(l,";\n              wR += ").concat(o,") {\n            float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(f,";\n                wC += ").concat(s,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(v," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(l," * ").concat(f," +\n                  wR * ").concat(f," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")}));var YC={kernelName:Re.MaxPool3DGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=r.filterSize,u=r.strides,s=r.pad,c=r.dimRoundingMode,l=Re.backend_util.computePool3DInfo(i.shape,o,u,[1,1,1],s,c),f=new Hk(l,"max",!0),d=n.runWebGLProgram(f,[i],i.dtype),h=new XC(l),p=n.runWebGLProgram(h,[a,d],i.dtype);return n.disposeIntermediateTensorInfo(d),p}};var KC={kernelName:Re.MaxPoolGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,o=i;sy([i,t.output],"maxPoolGrad");var u=r.filterSize,s=r.strides,c=r.pad,l=r.dimRoundingMode,f=Re.backend_util.computePool2DInfo(o.shape,u,s,1,c,l),d=new qk(f,"max",!0),h=n.runWebGLProgram(d,[o],o.dtype),p=new HC(f),v=n.runWebGLProgram(p,[a,h],o.dtype);return n.disposeIntermediateTensorInfo(h),v}};var $C={kernelName:Re.MaxPoolWithArgmax,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,o=n.filterSize,u=n.strides,s=n.pad,c=n.includeBatchInIndex,l=r;Re.util.assert(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,".")}));var f=[1,1];Re.util.assert(Re.backend_util.eitherStridesOrDilationsAreOne(u,f),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(u," and dilations '").concat(f,"'")}));var d=Re.backend_util.computePool2DInfo(a.shape,o,u,f,s),h=function(e,t,n,r){var a=new qk(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");return a=new qk(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(a,c,d,l),p=(0,i.Z)(h,2);return[p[0],p[1]]}};var QC={kernelName:Re.Mean,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,o=n.keepDims,u=n.axis,s=r,c=a.shape.length,l=Re.util.parseAxisParam(u,a.shape),f=l,d=Re.backend_util.getAxesPermutation(f,c),h=null!=d,p=s.shouldExecuteOnCPU([a]),v=[],g=a;if(h){if(p){for(var m=s.texData.get(g.dataId).values,y=new Array(c),b=0;b<y.length;b++)y[b]=a.shape[d[b]];var x=ex(m,a.shape,a.dtype,d,y);g=s.makeTensorInfo(y,a.dtype),s.texData.get(g.dataId).values=x}else g=sk(a,d,s);v.push(g),f=Re.backend_util.getInnerMostAxes(f.length,c)}Re.backend_util.assertAxesAreInnerMostDims("sum",f,c);var k=Re.backend_util.computeOutAndReduceShapes(g.shape,f),w=(0,i.Z)(k,2),_=w[0],C=w[1],S=_;o&&(S=Re.backend_util.expandShapeToKeepDim(_,l));for(var A=function(e,t,n,r){var a=Re.util.sizeFromShape(t),i=tk({inputs:{x:e},attrs:{shape:[Re.util.sizeFromShape(e.shape)/a,a]},backend:r}),o=ik(i,"float32","mean",r),u=tk({inputs:{x:o},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),u}(g,C,S,s),E=0,T=v;E<T.length;E++){var N=T[E];s.disposeIntermediateTensorInfo(N)}return A}};var JC={kernelName:Re.Min,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.axis,u=r.keepDims,s=a.shape.length,c=Re.util.parseAxisParam(o,a.shape),l=c,f=Re.backend_util.getAxesPermutation(l,s),d=a;null!=f&&(d=fk({inputs:{x:a},backend:n,attrs:{perm:f}}),l=Re.backend_util.getInnerMostAxes(l.length,a.shape.length)),Re.backend_util.assertAxesAreInnerMostDims("min",l,s);var h,p=Re.backend_util.computeOutAndReduceShapes(d.shape,l),v=(0,i.Z)(p,2),g=v[0],m=v[1],y=tk({inputs:{x:d},backend:n,attrs:{shape:[-1,Re.util.sizeFromShape(m)]}}),b=ik(y,y.dtype,"min",n);return h=tk(u?{inputs:{x:b},backend:n,attrs:{shape:Re.backend_util.expandShapeToKeepDim(g,c)}}:{inputs:{x:b},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b),null!=f&&n.disposeIntermediateTensorInfo(d),h}},eS=qx({opSnippet:Dx+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Ix+"\n  return result;\n",cpuKernelImpl:Nb}),tS={kernelName:Re.Minimum,backendName:"webgl",kernelFunc:eS},nS=(0,s.Z)((function e(t,n,r){(0,u.Z)(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=Ry(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),l="reflect"===r?0:1;this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(l,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(l,";\n          }\n        }\n        ").concat(i," coords = outC - start;\n        setOutput(getX(").concat(c,"));\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(l,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(l,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")})),rS=(0,s.Z)((function e(t,n,r){(0,u.Z)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=Ry(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),c=rx("rc",a),l=rx("source",a),f="".concat(c[a-1]," < ").concat(this.outputShape[a-1]),d=1===a?"source":"vec2(".concat(l.slice(-2).join(),")"),h="reflect"===r?0:1,p="";if(1===a){var v="\n        ".concat(i," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(h,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(h,";\n        }\n        source -= start;\n      ");p="\n        ".concat(i," rc = outputLoc;\n        ").concat(v,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(d,");\n        ").concat(c[a-1]," += 1;\n        if(").concat(f,") {\n          ").concat(v,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(d,");\n        }\n      ")}else{var g="\n        ".concat(i," source = rc;\n        ").concat(i," lt = ").concat(i,"(lessThan(source, start));\n        ").concat(i," gte = ").concat(i,"(greaterThanEqual(source, end));\n        ").concat(i," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(h,") +\n                gte * ((end - 1) * 2 - source + ").concat(h,");\n        source -= start;\n      ");p="\n        ".concat(i," rc = outputLoc;\n        ").concat(g,"\n        result[0] = getChannel(getX(").concat(l.join(),"), ").concat(d,");\n        ").concat(c[a-1]," += 1;\n        if(").concat(f,") {\n          ").concat(g,"\n          result[1] = getChannel(getX(").concat(l.join(),"), ").concat(d,");\n        }\n        rc = outputLoc;\n        ").concat(c[a-2]," += 1;\n        if(").concat(c[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(g,"\n          result[2] = getChannel(getX(").concat(l.join(),"), ").concat(d,");\n          ").concat(c[a-1]," += 1;\n          if(").concat(f,") {\n            ").concat(g,"\n            result[3] = getChannel(getX(").concat(l.join(),"), ").concat(d,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")})),aS={kernelName:Re.MirrorPad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.mode,u=(0,Re.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new rS(a.shape,i,o):new nS(a.shape,i,o);return n.runWebGLProgram(u,[a],a.dtype)}},iS=qx({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+Ix+"\n  return result;\n"}),oS={kernelName:Re.Mod,backendName:"webgl",kernelFunc:iS},uS=(0,s.Z)((function e(t,n,r){(0,u.Z)(this,e),this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,r],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(n-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(n-1,"));\n      }\n    ")})),sS=qx({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),cS={kernelName:Re.RealDiv,backendName:"webgl",kernelFunc:sS},lS="return a - b;",fS=qx({opSnippet:lS,packedOpSnippet:lS,supportsComplex:!0,cpuKernelImpl:$b}),dS={kernelName:Re.Sub,backendName:"webgl",kernelFunc:fS};function hS(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.dim,o=Re.util.parseAxisParam([i],a.shape),u=jC({inputs:{x:a},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),s=Re.backend_util.expandShapeToKeepDim(u.shape,o),c=tk({inputs:{x:u},backend:n,attrs:{shape:s}}),l=fS({inputs:{a:a,b:c},backend:n}),f=I_({inputs:{x:l},backend:n}),d=ck({inputs:{x:f},backend:n,attrs:{axis:o,keepDims:!1}}),h=tk({inputs:{x:d},backend:n,attrs:{shape:s}}),p=sS({inputs:{a:f,b:h},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),p}var pS={kernelName:Re.Softmax,backendName:"webgl",kernelFunc:hS};var vS={kernelName:Re.Multinomial,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,u=r.normalized,s=u?a:hS({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),c=s.shape[0],l=s.shape[1],f=new uS(c,l,i),d=[[o]],h=n.runWebGLProgram(f,[s],"int32",d);return u||n.disposeIntermediateTensorInfo(s),h}},gS=fx+"\n  return -x;\n";var mS={kernelName:Re.Neg,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])){var o=r.texData.get(a.dataId),u=Fb(o.values,a.shape,a.dtype),s=(0,i.Z)(u,2),c=s[0],l=s[1];return r.makeTensorInfo(l,a.dtype,c)}return t=(0,Re.env)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new Cx(a.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new lx(a.shape,gS),r.runWebGLProgram(t,[a],a.dtype)}},yS=Re.kernel_impls.nonMaxSuppressionV3Impl;var bS={kernelName:Re.NonMaxSuppressionV3,backendName:"webgl",kernelFunc:function(e){Re.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=n.readSync(a.dataId),l=n.readSync(i.dataId),f=yS(c,l,o,u,s).selectedIndices;return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}},xS=Re.kernel_impls.nonMaxSuppressionV4Impl;var kS={kernelName:Re.NonMaxSuppressionV4,backendName:"webgl",kernelFunc:function(e){Re.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=r.padToMaxOutputSize,l=n.readSync(a.dataId),f=n.readSync(i.dataId),d=xS(l,f,o,u,s,c),h=d.selectedIndices,p=d.validOutputs;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},wS=Re.kernel_impls.nonMaxSuppressionV5Impl;var _S={kernelName:Re.NonMaxSuppressionV5,backendName:"webgl",kernelFunc:function(e){Re.backend_util.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=r.softNmsSigma,l=n.readSync(a.dataId),f=n.readSync(i.dataId),d=wS(l,f,o,u,s,c),h=d.selectedIndices,p=d.selectedScores;return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([p.length],"float32",new Float32Array(p))]}},CS=(0,s.Z)((function e(t,n,r,a){(0,u.Z)(this,e),this.variableNames=["indices"],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(r,"),\n                      float(index == coords.y)));\n      }\n    ")})),SS={kernelName:Re.OneHot,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.dtype,u=r.depth,s=r.onValue,c=r.offValue,l=Re.util.sizeFromShape(a.shape),f=new CS(l,u,s,c),d=tk({inputs:{x:a},backend:n,attrs:{shape:[l]}}),h=n.runWebGLProgram(f,[d],i);n.disposeIntermediateTensorInfo(d);var p=tk({inputs:{x:h},backend:n,attrs:{shape:[].concat((0,o.Z)(a.shape),[u])}});return n.disposeIntermediateTensorInfo(h),p}};function AS(e){var t=e.inputs,n=e.backend,r=t.x;if("complex64"===r.dtype){var a=pw({inputs:{input:r},backend:n}),i=AS({inputs:{x:a},backend:n}),o=Nw({inputs:{input:r},backend:n}),u=AS({inputs:{x:o},backend:n}),s=Zx({inputs:{real:i,imag:u},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),s}return W_({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}var ES={kernelName:Re.ZerosLike,backendName:"webgl",kernelFunc:AS};var TS={kernelName:Re.OnesLike,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){var i=pw({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),u=Nw({inputs:{input:a},backend:r}),s=AS({inputs:{x:u},backend:r}),c=Zx({inputs:{real:o,imag:s},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(u),r.disposeIntermediateTensorInfo(s),c}return W_({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};var NS={kernelName:Re.Pack,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return O_({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){Re.util.assertShapesMatch(a,e.shape,"All tensors passed to stack must have matching shapes"),Re.util.assert(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=[],u=Iw({inputs:t.map((function(e){var t=O_({inputs:{input:e},backend:n,attrs:{dim:r}});return o.push(t),t})),backend:n,attrs:{axis:r}});return o.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),u}},DS=(0,s.Z)((function e(t,n,r){(0,u.Z)(this,e),this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=Ry(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(i," coords = outC - start;\n          setOutput(getX(").concat(c,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")})),FS=(0,s.Z)((function e(t,n,r){(0,u.Z)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));for(var a=t.length,i=Ry(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),c=rx("rc",a),l=rx("source",a),f="".concat(c[a-1]," < ").concat(this.outputShape[a-1]),d=1===a?"source":"vec2(".concat(l.slice(-2).join(),")"),h=["".concat(i," rc = outputLoc;"),"".concat(c[a-1]," += 1;\n       if(").concat(f,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(c[a-2]," += 1;\n       if(").concat(c[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(c[a-1]," += 1;\n         if(").concat(f,") {")],p=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",v="",g=0,m=1===a?2:4;g<m;g++)v+="\n        ".concat(h[g],"\n        if (").concat(p,") {\n          result[").concat(g,"] = float(value);\n        } else {\n          ").concat(i," source = rc - start;\n          result[").concat(g,"] = getChannel(getX(").concat(l.join(),"), ").concat(d,");\n        }\n      ");v+=1===a?"} ":"}}",this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(v,"\n        setOutput(result);\n      }\n    ")})),IS=function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue;if(0===Re.util.sizeFromShape(a.shape)){var u=i.map((function(e,t){return e[0]+a.shape[t]+e[1]}));return W_({backend:n,attrs:{shape:u,value:o,dtype:a.dtype}})}var s=(0,Re.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new FS(a.shape,i,o):new DS(a.shape,i,o),c=[[o]];return n.runWebGLProgram(s,[a],a.dtype,c)},MS={kernelName:Re.PadV2,backendName:"webgl",kernelFunc:IS},OS=qx({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+Ix+"\n  return result;\n"}),RS={kernelName:Re.Pow,backendName:"webgl",kernelFunc:OS};var ZS={kernelName:Re.Prod,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,o=n.x,u=a.axis,s=a.keepDims,c=o.shape.length,l=[],f=Re.util.parseAxisParam(u,o.shape),d=f,h=Re.backend_util.getAxesPermutation(d,c),p=o;if(null!=h&&(p=fk({inputs:{x:o},backend:r,attrs:{perm:h}}),d=Re.backend_util.getInnerMostAxes(d.length,c),l.push(p)),Re.backend_util.assertAxesAreInnerMostDims("prod",d,c),r.shouldExecuteOnCPU([p])){var v=r.texData.get(p.dataId).values,g=Mb(p.shape,p.dtype,v,d),m=g.outVals,y=g.outShape,b=g.outDtype;t=r.makeTensorInfo(y,b,m)}else{var x=Re.backend_util.computeOutAndReduceShapes(p.shape,d),k=(0,i.Z)(x,2),w=k[0],_=k[1],C=Re.util.sizeFromShape(_),S=tk({inputs:{x:p},backend:r,attrs:{shape:[-1,C]}}),A=ik(S,(0,Re.sumOutType)(o.dtype),"prod",r);t=tk({inputs:{x:A},backend:r,attrs:{shape:w}}),l.push(S),l.push(A)}if(s){l.push(t);var E=Re.backend_util.expandShapeToKeepDim(t.shape,f);t=tk({inputs:{x:t},backend:r,attrs:{shape:E}})}return l.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),t}};var BS={kernelName:Re.RaggedGather,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.paramsNestedSplits,o=t.paramsDenseValues,u=t.indices,s=r.outputRaggedRank,c=a.map((function(e){return n.readSync(e.dataId)})),l=a.map((function(e){return e.shape})),f=n.readSync(o.dataId),d=n.readSync(u.dataId),h=Ob(c,l,f,o.shape,o.dtype,d,u.shape,s),p=(0,i.Z)(h,3),v=p[0],g=p[1],m=p[2],y=v.map((function(e){return n.makeTensorInfo([e.length],"int32",e)})),b=n.makeTensorInfo(m,o.dtype,g);return y.concat([b])}};var zS={kernelName:Re.RaggedRange,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.starts,a=t.limits,o=t.deltas,u=n.readSync(r.dataId),s=n.readSync(a.dataId),c=n.readSync(o.dataId),l=Rb(u,r.shape,r.dtype,s,a.shape,c,o.shape),f=(0,i.Z)(l,2),d=f[0],h=f[1];return[n.makeTensorInfo([d.length],"int32",d),n.makeTensorInfo([h.length],r.dtype,h)]}};var LS={kernelName:Re.RaggedTensorToTensor,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.shape,o=t.values,u=t.defaultValue,s=t.rowPartitionTensors,c=r.rowPartitionTypes,l=n.readSync(a.dataId),f=n.readSync(o.dataId),d=n.readSync(u.dataId),h=s.map((function(e){return n.readSync(e.dataId)})),p=s.map((function(e){return e.shape})),v=Zb(l,a.shape,f,o.shape,o.dtype,d,u.shape,h,p,c),g=(0,i.Z)(v,2),m=g[0],y=g[1];return n.makeTensorInfo(m,o.dtype,y)}},PS=function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.step,o=n.dtype,u=Bb(r,a,i,o);return t.makeTensorInfo([u.length],o,u)},jS={kernelName:Re.Range,backendName:"webgl",kernelFunc:PS},US=Gx({opSnippet:"return 1.0 / x;"}),WS={kernelName:Re.Reciprocal,backendName:"webgl",kernelFunc:US},VS=Gx({opSnippet:fx+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),GS={kernelName:Re.Relu,backendName:"webgl",kernelFunc:VS},qS=Gx({opSnippet:fx+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),HS={kernelName:Re.Relu6,backendName:"webgl",kernelFunc:qS},XS=(0,s.Z)((function e(t,n,r,a,o){(0,u.Z)(this,e),this.variableNames=["A"],this.outputShape=[];var s=(0,i.Z)(t,4),c=s[0],l=s[1],f=s[2],d=s[3];this.outputShape=[c,n,r,d];var h,p=[a&&n>1?l-1:l,a&&r>1?f-1:f],v=[a&&n>1?n-1:n,a&&r>1?r-1:r];h=o?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/v[0],",\n          ").concat(p[1]/v[1],");\n      const vec2 inputShapeRC = vec2(").concat(l,".0, ").concat(f,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")})),YS=(0,s.Z)((function e(t,n,r,a,o){(0,u.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var s=(0,i.Z)(t,4),c=s[0],l=s[1],f=s[2],d=s[3];this.outputShape=[c,n,r,d];var h,p=[a&&n>1?l-1:l,a&&r>1?f-1:f],v=[a&&n>1?n-1:n,a&&r>1?r-1:r];h=o?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(p[0]/v[0],",\n          ").concat(p[1]/v[1],",\n          ").concat(p[1]/v[1],");\n      const vec3 inputShapeRC = vec3(").concat(l,".0, ").concat(f,".0,\n                                     ").concat(f,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(d-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")}));var KS={kernelName:Re.ResizeBilinear,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,o=r.alignCorners,u=r.halfPixelCenters,s=r.size,c=(0,i.Z)(s,2),l=c[0],f=c[1],d=(0,Re.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new YS(a.shape,l,f,o,u):new XS(a.shape,l,f,o,u);return n.runWebGLProgram(d,[a],"float32")}},$S=(0,s.Z)((function e(t,n,r){(0,u.Z)(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=(0,i.Z)(n,3),o=a[1],s=a[2],c=(0,i.Z)(t,3),l=c[1],f=c[2],d=[r&&l>1?o-1:o,r&&f>1?s-1:s],h=[r&&l>1?l-1:l,r&&f>1?f-1:f],p=d[0]/h[0],v=d[1]/h[1],g=1/p,m=1/v,y=2*Math.ceil(g)+2,b=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(v,");\n\n        const float invHeightScale = float(").concat(g,");\n        const float invWidthScale = float(").concat(m,");\n\n        const int winHeight = int(").concat(y,");\n        const int winWidth = int(").concat(b,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(l,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(f,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(o-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(s-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}));var QS={kernelName:Re.ResizeBilinearGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,u=new $S(i.shape,a.shape,o);return n.runWebGLProgram(u,[i],i.dtype)}},JS=(0,s.Z)((function e(t,n,r,a,o){(0,u.Z)(this,e),this.variableNames=["A"],this.outputShape=[];var s=(0,i.Z)(t,4),c=s[0],l=s[1],f=s[2],d=s[3];this.outputShape=[c,n,r,d];var h,p=[a&&n>1?l-1:l,a&&r>1?f-1:f],v=[a&&n>1?n-1:n,a&&r>1?r-1:r],g=a?"0.5":"0.0";h=o?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/v[0],",\n          ").concat(p[1]/v[1],");\n      const vec2 inputShapeRC = vec2(").concat(l,".0, ").concat(f,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(g,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")})),eA=(0,s.Z)((function e(t,n,r,a,o){(0,u.Z)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var s=(0,i.Z)(t,4),c=s[0],l=s[1],f=s[2],d=s[3];this.outputShape=[c,n,r,d];var h,p=[a&&n>1?l-1:l,a&&r>1?f-1:f],v=[a&&n>1?n-1:n,a&&r>1?r-1:r],g=a?"0.5":"0.0";h=o?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(p[0]/v[0],",\n          ").concat(p[1]/v[1],",\n          ").concat(p[1]/v[1],");\n      const vec3 inputShapeRC = vec3(").concat(l,".0, ").concat(f,".0,\n                                     ").concat(f,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(h,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(g,")));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(d-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    ")}));var tA={kernelName:Re.ResizeNearestNeighbor,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,o=r.alignCorners,u=r.halfPixelCenters,s=r.size,c=(0,i.Z)(s,2),l=c[0],f=c[1],d=(0,Re.env)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new eA(a.shape,l,f,o,u):new JS(a.shape,l,f,o,u);return n.runWebGLProgram(d,[a],a.dtype)}},nA=(0,s.Z)((function e(t,n,r){(0,u.Z)(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=(0,i.Z)(n,3),o=a[1],s=a[2],c=(0,i.Z)(t,3),l=c[1],f=c[2],d=[r&&l>1?o-1:o,r&&f>1?s-1:s],h=[r&&l>1?l-1:l,r&&f>1?f-1:f],p=d[0]/h[0],v=d[1]/h[1],g=1/p,m=1/v,y=2*Math.ceil(g)+2,b=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(v,");\n\n        const float invHeightScale = float(").concat(g,");\n        const float invWidthScale = float(").concat(m,");\n\n        const int winHeight = int(").concat(y,");\n        const int winWidth = int(").concat(b,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(l,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(f,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(d[0],") *\n                (float(dyR) / float(").concat(h[0],"));\n\n            float sourceFracCol =\n                float(").concat(d[1],") *\n                  (float(dyC) / float(").concat(h[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(r," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(s,") - 1),\n                ").concat(r," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")}));var rA={kernelName:Re.ResizeNearestNeighborGrad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,u=new nA(i.shape,a.shape,o);return n.runWebGLProgram(u,[i],i.dtype)}},aA=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.variableNames=["x"];var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));if(this.outputShape=t,1!==r){var a=t.map((function(e,r){return function(e){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - coords[").concat(e,"] - 1"):"coords[".concat(e,"]")}(r)})).join(","),i=Ry(r);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      ")})),iA=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));this.outputShape=t;var a=rx("rc",r),i="".concat(a[r-1]," + 1 < ").concat(this.outputShape[r-1]),o="".concat(a[r-2]," + 1 < ").concat(this.outputShape[r-2]),s=Ry(r);function c(e){var r=t.map((function(r,a){return function(e,r){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - ").concat(r[e]," - 1"):"".concat(r[e])}(a,e)})),a=r.join(","),i=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(i,"))")}this.userCode=1===r?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(i,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(s," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return c(e)}(a.slice()),";\n          if(").concat(i,"){\n            result.g = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",c(e)}(a.slice()),";\n          }\n          if(").concat(o,") {\n            result.b = ").concat(function(e){return e[r-2]="("+e[r-2]+" + 1)",c(e)}(a.slice()),";\n            if(").concat(i,") {\n              result.a = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",e[r-2]="("+e[r-2]+" + 1)",c(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")}));var oA={kernelName:Re.Reverse,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims,o=a.shape.length,u=Re.util.parseAxisParam(i,a.shape);if(0===o)return Ox({inputs:{x:a},backend:n});var s=(0,Re.env)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new iA(a.shape,u):new aA(a.shape,u);return n.runWebGLProgram(s,[a],a.dtype)}},uA=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];var r=t[1],a=t[2];this.outputShape=t;var i="";i="number"===typeof n?"float outputValue = ".concat(n.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(n.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(i,"\n          if(coordX >= 0 && coordX < ").concat(a," && coordY >= 0 && coordY < ").concat(r,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")})),sA={kernelName:Re.RotateWithOffset,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,o=n.radians,u=n.fillValue,s=n.center,c=r,l=new uA(a.shape,u),f=Re.backend_util.getImageCenter(s,a.shape[1],a.shape[2]),d=(0,i.Z)(f,2),h=[[d[0],d[1],Math.sin(o),Math.cos(o)]];return c.runWebGLProgram(l,[a],a.dtype,h)}},cA=Gx({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),lA={kernelName:Re.Round,backendName:"webgl",kernelFunc:cA},fA=Gx({opSnippet:"return inversesqrt(x);",cpuKernelImpl:zb}),dA={kernelName:Re.Rsqrt,backendName:"webgl",kernelFunc:fA},hA=(0,s.Z)((function e(t,n,r,a,i,o){(0,u.Z)(this,e),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=Ry(i.length),c=Ry(o.length),l="";1===r?l="i":2===r&&(l="i, j");var f="getIndices(".concat(l,")"),d="";1===a?d="i":2===a&&(d="i, coords[1]");var h="getUpdates(".concat(d,")"),p=n>1?"strides[j]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(i,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(n,"; j++) {\n              int index = round(").concat(f,");\n              flattenedIndex += index * ").concat(p,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(h,";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      ")}));var pA={kernelName:Re.ScatterNd,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,o=r.shape,u=Re.backend_util.calculateShapes(i,a,o),s=u.sliceRank,c=u.numUpdates,l=u.sliceSize,f=u.strides,d=u.outputSize,h=[d/l,l];if(0===d)return n.makeTensorInfo(o,a.dtype);var p=tk({inputs:{x:a},backend:n,attrs:{shape:[c,s]}}),v=tk({inputs:{x:i},backend:n,attrs:{shape:[c,l]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0])),m=new hA(c,s,p.shape.length,v.shape.length,f,h),y=n.runWebGLProgram(m,[v,p,g],v.dtype),b=tk({inputs:{x:y},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(g),b}},vA=(0,s.Z)((function e(t,n,r,a){(0,u.Z)(this,e),this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,r];var i="for (int i = 0; i < ".concat(Math.ceil(Math.log2(n+1)),"; ++i) { if (left >= right) break;"),o=2===(0,Re.env)().getNumber("WEBGL_VERSION")?"while (left < right) {":i,s="left"===a?"<":"<=";this.userCode="\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ".concat(o,"\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ").concat(s," value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     ")}));var gA={kernelName:Re.SearchSorted,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sortedSequence,i=t.values,o=r.side,u=new vA(a.shape[0],a.shape[1],i.shape[1],o),s=[[a.shape[1]]];return n.runWebGLProgram(u,[a,i],"int32",s)}},mA=(0,s.Z)((function e(t,n,r){var a,i;if((0,u.Z)(this,e),this.variableNames=["c","a","b"],this.outputShape=n,r>4)throw Error("Where for rank ".concat(r," is not yet supported"));if(1===r)i="resRC",a="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],c=[],l=0;l<n.length;l++)c.push("".concat(o[l])),l<t&&s.push("".concat(o[l]));a=s.join(),i=c.join()}var f=Ry(r);this.userCode="\n      void main() {\n        ".concat(f," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(i,"));\n        } else {\n          setOutput(getB(").concat(i,"));\n        }\n      }\n    ")}));var yA={kernelName:Re.Select,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e,o=new mA(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(o,[r,a,i],(0,Re.upcastType)(a.dtype,i.dtype))}},bA=Gx({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(Re.backend_util.SELU_SCALEALPHA,";\n  float scale = ").concat(Re.backend_util.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),xA={kernelName:Re.Selu,backendName:"webgl",kernelFunc:bA},kA=Gx({opSnippet:Vx+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:Pb}),wA={kernelName:Re.Sigmoid,backendName:"webgl",kernelFunc:kA},_A=Gx({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),CA={kernelName:Re.Sign,backendName:"webgl",kernelFunc:_A},SA=Gx({opSnippet:Vx+"\n  return sin(x);\n"}),AA={kernelName:Re.Sin,backendName:"webgl",kernelFunc:SA},EA=Gx({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),TA={kernelName:Re.Sinh,backendName:"webgl",kernelFunc:EA},NA=Gx({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),DA={kernelName:Re.Softplus,backendName:"webgl",kernelFunc:NA},FA={kernelName:Re.SpaceToBatchND,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,u=r.paddings;Re.util.assert(a.shape.length<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var s=i.reduce((function(e,t){return e*t})),c=[[0,0]];c.push.apply(c,(0,o.Z)(u));for(var l=1+i.length;l<a.shape.length;++l)c.push([0,0]);var f=[],d=IS({inputs:{x:a},backend:n,attrs:{paddings:c,constantValue:0}}),h=Re.backend_util.getReshaped(d.shape,i,s,!1),p=Re.backend_util.getPermuted(h.length,i.length,!1),v=Re.backend_util.getReshapedPermuted(d.shape,i,s,!1),g=tk({inputs:{x:d},backend:n,attrs:{shape:h}}),m=fk({inputs:{x:g},backend:n,attrs:{perm:p}}),y=tk({inputs:{x:m},backend:n,attrs:{shape:v}});return f.push(d),f.push(g),f.push(m),f.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),y}};var IA={kernelName:Re.SparseFillEmptyRows,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.indices,a=t.values,o=t.denseShape,u=t.defaultValue;if(1!==o.shape.length)throw new Error("Dense shape must be a vector, saw:\n         ".concat(o.shape));if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         ".concat(r.shape));if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n         ".concat(a.shape));if(0!==u.shape.length)throw new Error("Default value must be a scalar, saw:\n        ".concat(u.shape));var s=n.readSync(r.dataId),c=n.readSync(a.dataId),l=n.readSync(o.dataId),f=n.readSync(u.dataId)[0],d=Wb(s,r.shape,r.dtype,c,a.dtype,l,f),h=(0,i.Z)(d,5),p=h[0],v=h[1],g=h[2],m=h[3],y=h[4];return[n.makeTensorInfo(v,r.dtype,p),n.makeTensorInfo([v[0]],a.dtype,g),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map((function(e){return Number(e)})))),n.makeTensorInfo([y.length],r.dtype,new Int32Array(y))]}};var MA={kernelName:Re.SparseReshape,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.inputIndices,a=t.inputShape,o=t.newShape;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape ".concat(r.shape));if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape ".concat(a.shape));if(1!==o.shape.length)throw new Error("Target shape should be a vector but received shape ".concat(o.shape));var u=Array.from(n.readSync(a.dataId)),s=n.readSync(r.dataId),c=Array.from(n.readSync(o.dataId)),l=Vb(s,r.shape,r.dtype,u,c),f=(0,i.Z)(l,3),d=f[0],h=f[1],p=f[2];return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([p.length],o.dtype,new Int32Array(p))]}};var OA={kernelName:Re.SparseSegmentMean,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,o=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n              ".concat(a.shape));if(1!==o.shape.length)throw new Error("Segment ids should be a vector but received shape\n              ".concat(o.shape));var u=n.readSync(r.dataId),s=n.readSync(a.dataId),c=n.readSync(o.dataId),l=Gb(u,r.shape,r.dtype,s,c,!0),f=(0,i.Z)(l,2),d=f[0],h=f[1];return n.makeTensorInfo(h,r.dtype,d)}};var RA={kernelName:Re.SparseSegmentSum,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.data,a=t.indices,o=t.segmentIds;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n             ".concat(a.shape));if(1!==o.shape.length)throw new Error("Segment ids should be a vector but received shape\n             ".concat(o.shape));var u=n.readSync(r.dataId),s=n.readSync(a.dataId),c=n.readSync(o.dataId),l=Gb(u,r.shape,r.dtype,s,c),f=(0,i.Z)(l,2),d=f[0],h=f[1];return n.makeTensorInfo(h,r.dtype,d)}};var ZA={kernelName:Re.SparseToDense,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sparseIndices,i=t.sparseValues,o=t.defaultValue,u=r.outputShape,s=Re.backend_util.calculateShapes(i,a,u),c=s.sliceRank,l=s.numUpdates,f=s.sliceSize,d=s.strides,h=s.outputSize;if("string"===i.dtype){var p=n.bufferSync(a),v=n.bufferSync(i),g=Re.util.decodeString(n.readSync(o.dataId)[0]),m=Lb(p,v,u,h,f,l,c,d,g,false);return n.makeTensorInfo(u,m.dtype,m.values)}var y=new hA(l,c,a.shape.length,i.shape.length,d,[h,1],false),b=n.runWebGLProgram(y,[i,a,o],i.dtype),x=tk({inputs:{x:b},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(b),x}};var BA={kernelName:Re.SplitV,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,u=r.axis,s=Re.util.parseAxisParam(u,a.shape)[0],c=Re.backend_util.prepareSplitSize(a,i,s),l=a.shape.length,f=new Array(l).fill(0),d=a.shape.slice();return c.map((function(e){var t=(0,o.Z)(d);t[s]=e;var r=uw({inputs:{x:a},backend:n,attrs:{begin:f,size:t}});return f[s]+=e,r}))}},zA="return sqrt(x);",LA=Gx({opSnippet:zA,packedOpSnippet:zA,cpuKernelImpl:qb}),PA={kernelName:Re.Sqrt,backendName:"webgl",kernelFunc:LA},jA=Gx({opSnippet:"return x * x;"}),UA={kernelName:Re.Square,backendName:"webgl",kernelFunc:jA},WA="return (a - b) * (a - b);",VA=qx({opSnippet:WA,packedOpSnippet:WA}),GA={kernelName:Re.SquaredDifference,backendName:"webgl",kernelFunc:VA};var qA={kernelName:Re.Step,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=fx+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),o=new lx(a.shape,i);return r.runWebGLProgram(o,[a],a.dtype)}},HA=(0,s.Z)((function e(t,n,r){(0,u.Z)(this,e),this.variableNames=["x"],this.outputShape=r;var a=r.length,i=Ry(r.length),o=Ry(r.length),s="";if(1===a)s="coords * strides + begin";else{var c=0;s=r.map((function(e,t){return c++,1===r.length?"coords * strides[".concat(t,"] + begin[").concat(t,"]"):"coords[".concat(c-1,"] * strides[").concat(t,"] + begin[").concat(t,"]")})).join(",")}this.userCode="\n      ".concat(i," begin = ").concat(i,"(").concat(t,");\n      ").concat(i," strides = ").concat(i,"(").concat(n,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(s,"));\n      }\n    ")}));var XA={kernelName:Re.StridedSlice,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.begin,u=a.end,s=a.strides,c=a.beginMask,l=a.endMask,f=a.ellipsisMask,d=a.newAxisMask,h=a.shrinkAxisMask,p=Re.slice_util.sliceInfo(i.shape,o,u,s,c,l,f,d,h),v=p.finalShapeSparse,g=p.finalShape,m=p.isIdentity,y=p.sliceDim0,b=p.isSimpleSlice,x=p.begin,k=p.end,w=p.strides;if(m)t=tk({inputs:{x:i},backend:r,attrs:{shape:g}});else if(y||b){Re.util.assert(i.shape.length>=1,(function(){return"Input must have rank at least 1, got: ".concat(i.shape.length)}));var _=Re.slice_util.computeOutShape(x,k,w),C=uw({inputs:{x:i},backend:r,attrs:{begin:x,size:_}});t=tk({inputs:{x:C},backend:r,attrs:{shape:g}}),r.disposeIntermediateTensorInfo(C)}else{if(r.shouldExecuteOnCPU([i])){var S=r.readSync(i.dataId),A=(0,Re.buffer)(i.shape,i.dtype,S),E=Hb(v,A,w,x);t=r.makeTensorInfo(g,i.dtype,E.values)}else{var T=new HA(x,w,v);t=r.runWebGLProgram(T,[i],i.dtype)}}var N=tk({inputs:{x:t},backend:r,attrs:{shape:g}});return r.disposeIntermediateTensorInfo(t),N}};var YA={kernelName:Re.StringNGrams,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=r.separator,o=r.nGramWidths,u=r.leftPad,s=r.rightPad,c=r.padWidth,l=r.preserveShortSequences,f=t.data,d=t.dataSplits,h=n.readSync(f.dataId),p=n.readSync(d.dataId),v=Xb(h,p,a,o,u,s,c,l),g=(0,i.Z)(v,2),m=g[0],y=g[1];return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(d.shape,"int32",y)]}};var KA={kernelName:Re.StringSplit,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.skipEmpty,a=t.input,o=t.delimiter;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error("Input must be a vector, got shape: ".concat(a.shape));if(0!==o.shape.length)throw new Error("Delimiter must be a scalar, got shape: ".concat(o.shape));var u=n.readSync(a.dataId),s=n.readSync(o.dataId)[0],c=Yb(u,s,r),l=(0,i.Z)(c,3),f=l[0],d=l[1],h=l[2],p=d.length;return[n.makeTensorInfo([p,2],"int32",f),n.makeTensorInfo([p],"string",d),n.makeTensorInfo([2],"int32",new Int32Array(h))]}};var $A={kernelName:Re.StringToHashBucketFast,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.numBuckets,a=t.input;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");var i=n.readSync(a.dataId),o=Kb(i,r);return n.makeTensorInfo(a.shape,"int32",o)}},QA=Gx({opSnippet:"return tan(x);"}),JA={kernelName:Re.Tan,backendName:"webgl",kernelFunc:QA},eE=Gx({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),tE={kernelName:Re.Tanh,backendName:"webgl",kernelFunc:eE},nE=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.rank=r.length;var i=Ry(this.rank),o=function(e){var t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")}));function rE(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;if("string"===a.dtype||a.shape.length>5){var o=n.readSync(a.dataId),u="string"===a.dtype?o.map((function(e){return Re.util.decodeString(e)})):o,s=(0,Re.buffer)(a.shape,a.dtype,u),c=Qb(s,i);return n.makeTensorInfo(c.shape,c.dtype,c.values)}var l=new nE(a.shape,i);return n.runWebGLProgram(l,[a],a.dtype)}var aE={kernelName:Re.Tile,backendName:"webgl",kernelFunc:rE},iE=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "})),oE=(0,s.Z)((function e(t){(0,u.Z)(this,e),this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}));function uE(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function sE(e){for(var t=1;t<e;)t*=2;return t}var cE={kernelName:Re.TopK,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,o=r.k,u=r.sorted,s=(0,Re.env)().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),c=(0,Re.env)().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),l=a.shape,f=l[l.length-1];if(n.shouldExecuteOnCPU([a])||f<s||o>c){var d=n.readSync(a.dataId),h=Jb(d,l,a.dtype,o,u),p=(0,i.Z)(h,2),v=p[0],g=p[1];return[n.makeTensorInfo(v.shape,v.dtype,v.values),n.makeTensorInfo(g.shape,g.dtype,g.values)]}if(0===o)return l[l.length-1]=0,[n.makeTensorInfo(l,a.dtype,[]),n.makeTensorInfo(l,"int32",[])];if(1===f)return[a,W_({attrs:{shape:l,dtype:"int32",value:0},backend:n})];var m=n.texData.get(a.dataId),y=null!==m&&m.isPacked,b=y?n.unpackTensor(a):a,x=Re.util.sizeFromShape(l)/f,k=tk({inputs:{x:b},attrs:{shape:[x,f]},backend:n});y&&uE(n,b);for(var w=sE(o),_=sE(f),C=null,S=function(){return null===C?[k,k]:[k,C]},A=function(e,t,r){var a=S(),i=new iE(r),o=[[f],[null===C?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],u=C;C=n.runWebGLProgram(i,a,"int32",o),uE(n,u)},E=1;E<w;E*=2)for(var T=2*E,N=E;N>=1;N/=2)A(T,N,[x,_]);for(var D=_;D>w;D/=2){var F=S(),I=new oE([x,D/2]),M=[[f],[null===C?1:0],[w]],O=C;C=n.runWebGLProgram(I,F,"int32",M),uE(n,O);for(var R=w/2,Z=2*R,B=R;B>=1;B/=2)A(Z,B,C.shape)}var z=C;C=uw({inputs:{x:C},backend:n,attrs:{begin:0,size:[x,o]}}),uE(n,z);var L=sC({inputs:{x:k,indices:C},backend:n,attrs:{axis:1,batchDims:1}});uE(n,k);var P=l.slice(0,-1);P.push(o),z=C,C=tk({inputs:{x:C},attrs:{shape:P},backend:n}),uE(n,z);var j=L;return L=tk({inputs:{x:L},attrs:{shape:P},backend:n}),uE(n,j),[L,C]}},lE=(0,s.Z)((function e(t,n,r,a,i,o){(0,u.Z)(this,e),this.variableNames=["Image","Transforms"],this.outputShape=o;var s,c="nearest"===r?1:2;switch(a){case"constant":default:s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(t," && 0 <= coordX && coordX < ").concat(n,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(i,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(i,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(n,"));\n                float mapY = mapCoord(inY, float(").concat(t,"));\n\n                if (").concat(c," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")}));var fE={kernelName:Re.Transform,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,o=t.transforms,u=r.interpolation,s=r.fillMode,c=r.fillValue,l=r.outputShape,f=(0,i.Z)(a.shape,4),d=f[0],h=f[1],p=f[2],v=f[3],g=null!=l?l:[h,p],m=(0,i.Z)(g,2),y=m[0],b=m[1],x=new lE(h,p,u,s,c,[d,y,b,v]);return n.runWebGLProgram(x,[a,o],"float32")}};var dE={kernelName:Re.Unique,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;sy(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");var o=r.readSync(i.dataId),u=tx(o,a,i.shape,i.dtype),s=u.outputValues,c=u.outputShape,l=u.indices;return[r.makeTensorInfo(c,i.dtype,s),r.makeTensorInfo([l.length],"int32",l)]}};var hE={kernelName:Re.Unpack,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a,u=o.shape.length,s=a.shape[i],c=new Array(u-1),l=0,f=0;f<u;f++)f!==i&&(c[l++]=o.shape[f]);var d=[],h=new Array(u).fill(0),p=o.shape.slice();p[i]=1;for(var v=new Array(s),g=0;g<v.length;g++){h[i]=g;var m=uw({inputs:{x:o},backend:n,attrs:{begin:h,size:p}}),y=tk({inputs:{x:m},backend:n,attrs:{shape:c}});v[g]=y,d.push(m)}return d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),v}},pE=(0,s.Z)((function e(t,n){(0,u.Z)(this,e),this.variableNames=["x","segmentIds"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.numSegments,s=o*Math.ceil(i/r);this.outputShape=[a,s];var c=4*Math.floor(r/4),l=r%4,f="\n        sumValue += dot(values, segFilter);\n    ",d="";i%r>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));var h="";i%r>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(d,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(h,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(o,")) * float(").concat(r,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(o,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(f,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(1===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(f,"\n        } else if (").concat(2===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(f,"\n        } else if (").concat(3===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(f,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")}));for(var vE={kernelName:Re.UnsortedSegmentSum,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,o=r.numSegments,u=a.shape.length,s=[],c=0,l=Re.backend_util.getAxesPermutation([c],u),f=a;null!=l&&(f=fk({inputs:{x:a},backend:n,attrs:{perm:l}}),s.push(f),c=Re.backend_util.getInnerMostAxes(1,u)[0]);var d=Re.backend_util.segment_util.computeOutShape(f.shape,c,o),h=Re.util.sizeFromShape([f.shape[c]]),p=tk({inputs:{x:f},backend:n,attrs:{shape:[-1,h]}});s.push(p);var v=function e(t,r,a,i,o){var u=t.shape[0],c=t.shape[1],l=Re.backend_util.segment_util.segOpComputeOptimalWindowSize(c,o),f=new pE({windowSize:l,inSize:c,batchSize:u,numSegments:o},r),d=n.compileAndRun(f,[t,a],i);if(s.push(d),d.shape[1]===o)return d;var h=PS({backend:n,attrs:{start:0,stop:o,step:1,dtype:"float32"}}),p=rE({inputs:{x:h},backend:n,attrs:{reps:[c/l]}});return s.push(h),s.push(p),e(d,r,p,i,o)}(p,"unsortedSegmentSum",i,(0,Re.sumOutType)(a.dtype),o),g=tk({inputs:{x:v},backend:n,attrs:{shape:d}}),m=g;if(null!=l){s.push(g);var y=Re.backend_util.getUndoAxesPermutation(l);m=fk({inputs:{x:m},backend:n,attrs:{perm:y}})}return s.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}},gE=0,mE=[pk,gk,yk,xk,_k,Ak,Ek,Tk,Ok,Rk,Bk,Lk,jk,Wk,Gk,Xk,Yk,Qk,Jk,ew,rw,cw,lw,fw,gw,bw,ww,Bx,Sw,Mw,jw,qw,Hw,Xw,Yw,$w,Jw,t_,r_,s_,c_,l_,d_,v_,y_,b_,k_,__,C_,A_,E_,N_,F_,M_,R_,z_,j_,G_,H_,K_,Q_,tC,rC,aC,oC,cC,fC,hC,Rx,pC,Dw,gC,yC,xC,Px,wC,CC,SC,EC,NC,FC,MC,RC,zC,PC,UC,VC,GC,qC,YC,KC,$C,QC,JC,tS,aS,oS,vS,ek,mS,bS,kS,_S,hw,SS,TS,NS,MS,RS,Wx,ZS,BS,zS,LS,jS,vw,cS,WS,GS,HS,nk,KS,QS,tA,rA,oA,sA,lA,dA,pA,gA,yA,xA,wA,CA,AA,TA,sw,pS,DA,FA,IA,MA,OA,RA,ZA,BA,PA,UA,GA,qA,XA,YA,KA,$A,dS,lk,JA,tE,aE,cE,fE,dk,dE,hE,vE,ES];gE<mE.length;gE++){var yE=mE[gE];(0,Re.registerKernel)(yE)}Re.version_core;var bE=n(184),xE=(0,t.createContext)(null),kE=function(e){var n=(0,t.useState)(localStorage.user),r=(0,i.Z)(n,2),a=r[0],o=r[1];return(0,bE.jsx)(xE.Provider,{value:{user:a,login:function(e){o(e)},logout:function(){localStorage.removeItem("soma_token"),localStorage.removeItem("user"),o(null)}},children:e.children})},wE=function(){return(0,t.useContext)(xE)},_E={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},CE=t.createContext&&t.createContext(_E),SE=function(){return SE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},SE.apply(this,arguments)},AE=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};function EE(e){return e&&e.map((function(e,n){return t.createElement(e.tag,SE({key:n},e.attr),EE(e.child))}))}function TE(e){return function(n){return t.createElement(NE,SE({attr:SE({},e.attr)},n),EE(e.child))}}function NE(e){var n=function(n){var r,a=e.attr,i=e.size,o=e.title,u=AE(e,["attr","size","title"]),s=i||n.size||"1em";return n.className&&(r=n.className),e.className&&(r=(r?r+" ":"")+e.className),t.createElement("svg",SE({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,a,u,{className:r,style:SE(SE({color:e.color||n.color},n.style),e.style),height:s,width:s,xmlns:"http://www.w3.org/2000/svg"}),o&&t.createElement("title",null,o),e.children)};return void 0!==CE?t.createElement(CE.Consumer,null,(function(e){return n(e)})):n(_E)}function DE(e){return TE({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"}},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}}]})(e)}var FE=void 0,IE="dense",ME="conv2d",OE="maxPool2d",RE="avgPool2d",ZE="http://54.206.20.11:5050",BE=function(e,t,n){var r=(0,o.Z)(t);r[e].neurons++,n(r)},zE=function(e,t,n){if(t[e].neurons>1){var r=(0,o.Z)(t);r[e].neurons--,n(r)}else if(1===t[e].neurons)return},LE=function(e,t,n){var r=100+t,a=document.createElementNS("http://www.w3.org/2000/svg","line");a.setAttribute("x1",5+r),a.setAttribute("y1",330),a.setAttribute("x2",50+r),a.setAttribute("y2",255),a.setAttribute("stroke","#6a229b"),a.setAttribute("strokeLinecap","round"),a.setAttribute("stroke-width",2);var i=document.createElementNS("http://www.w3.org/2000/svg","line");i.setAttribute("x1",-70+r),i.setAttribute("y1",255),i.setAttribute("x2",-25+r),i.setAttribute("y2",180),i.setAttribute("stroke","#6a229b"),i.setAttribute("strokeLinecap","round"),i.setAttribute("stroke-width",2);var o=document.createElementNS("http://www.w3.org/2000/svg","line");o.setAttribute("x1",5+r),o.setAttribute("y1",255),o.setAttribute("x2",50+r),o.setAttribute("y2",180),o.setAttribute("stroke","#6a229b"),o.setAttribute("strokeLinecap","round"),o.setAttribute("stroke-width",2);var u=document.createElementNS("http://www.w3.org/2000/svg","line");u.setAttribute("x1",-70+r),u.setAttribute("y1",330),u.setAttribute("x2",5+r),u.setAttribute("y2",330),u.setAttribute("stroke","#6a229b"),u.setAttribute("strokeLinecap","round"),u.setAttribute("stroke-width",2);var s=document.createElementNS("http://www.w3.org/2000/svg","line");s.setAttribute("x1",-70+r),s.setAttribute("y1",255),s.setAttribute("x2",5+r),s.setAttribute("y2",255),s.setAttribute("stroke","#6a229b"),s.setAttribute("strokeLinecap","round"),s.setAttribute("stroke-width",2);var c=document.createElementNS("http://www.w3.org/2000/svg","line");c.setAttribute("x1",-25+r),c.setAttribute("y1",180),c.setAttribute("x2",50+r),c.setAttribute("y2",180),c.setAttribute("stroke","#6a229b"),c.setAttribute("strokeLinecap","round"),c.setAttribute("stroke-width",2);var l=document.createElementNS("http://www.w3.org/2000/svg","line");l.setAttribute("x1",-70+r),l.setAttribute("y1",330),l.setAttribute("x2",-70+r),l.setAttribute("y2",255),l.setAttribute("stroke","#6a229b"),l.setAttribute("strokeLinecap","round"),l.setAttribute("stroke-width",2);var f=document.createElementNS("http://www.w3.org/2000/svg","line");f.setAttribute("x1",5+r),f.setAttribute("y1",330),f.setAttribute("x2",5+r),f.setAttribute("y2",255),f.setAttribute("stroke","#6a229b"),f.setAttribute("strokeLinecap","round"),f.setAttribute("stroke-width",2);var d=document.createElementNS("http://www.w3.org/2000/svg","line");d.setAttribute("x1",50+r),d.setAttribute("y1",255),d.setAttribute("x2",50+r),d.setAttribute("y2",180),d.setAttribute("stroke","#6a229b"),d.setAttribute("strokeLinecap","round"),d.setAttribute("stroke-width",2),e.append(a,i,o,u,s,c,l,f,d);var h=document.createElementNS("http://www.w3.org/2000/svg","text");h.setAttribute("x","".concat(r)),h.setAttribute("y","".concat(375)),h.setAttribute("text-anchor","middle"),h.setAttribute("fill","rgb(96 165 250)"),h.textContent="".concat(n),e.appendChild(h)},PE=function(e,t,n,r){var a,i=150,o=100;for(a=0;a<t[r].neurons;a++){if(a>6){var u=document.createElementNS("http://www.w3.org/2000/svg","text");u.setAttribute("x","".concat(o+r*i)),u.setAttribute("y","".concat(100+50*a)),u.setAttribute("text-anchor","middle"),u.setAttribute("fill","rgb(96 165 250)"),u.textContent="+".concat(t[r].neurons-7),e.appendChild(u);break}var s=document.createElementNS("http://www.w3.org/2000/svg","circle");if(s.setAttribute("cx","".concat(o+r*i)),s.setAttribute("cy","".concat(100+50*a)),s.setAttribute("r",20),s.setAttribute("fill","white"),s.setAttribute("stroke","#6a229b"),s.setAttribute("stroke-width","2"),e.appendChild(s),r>0)for(var c=0;c<t[r-1].neurons&&!(c>6);c++){var l=document.createElementNS("http://www.w3.org/2000/svg","line");l.setAttribute("x1",s.getAttribute("cx")-20),l.setAttribute("y1",s.getAttribute("cy")),l.setAttribute("x2","".concat(o+(r-1)*i+20)),l.setAttribute("y2","".concat(100+50*c)),l.setAttribute("stroke","#6a229b"),l.style.display="block",e.appendChild(l)}}var f=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");f.setAttribute("x","".concat(o+r*i-30)),f.setAttribute("y","".concat(40)),f.setAttribute("width","70"),f.setAttribute("height","30");var d=document.createElement("div"),h=document.createElement("button"),p=document.createElement("button");h.textContent="+",h.style="width: 30px; border-radius: 25%; font-size: large; font-weight: 600; color: white; background-color: rgb(96 165 250); margin-right: 2px",h.addEventListener("click",BE.bind(FE,r,t,n)),p.textContent="-",p.style="width: 30px; border-radius: 25%; font-size: large; font-weight: 600; color: white; background-color:  rgb(96 165 250)",p.addEventListener("click",zE.bind(FE,r,t,n)),d.append(h,p),f.appendChild(d),e.appendChild(f)},jE=function(e,t,n){LE(e,150*t,"".concat(n," filters"))},UE=function(e,t){LE(e,150*t,"Pool Layer")},WE=function(e){var n=e.openModal,r=e.setSearchResults,a=(0,t.useState)(""),o=(0,i.Z)(a,2),u=o[0],s=o[1];return(0,bE.jsxs)("div",{className:"flex items-center bg-white rounded-full px-4 py-2",children:[(0,bE.jsx)(DE,{className:"mr-2"}),(0,bE.jsx)("input",{className:"bg-transparent outline-none flex-1",type:"text",placeholder:"Type model name...",value:u,onChange:function(e){return s(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&""!==u&&(n(),fetch(ZE+"/models/".concat(u.trim(),"/getByName"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"bearer "+localStorage.soma_token}}).then((function(e){return e.json()})).then((function(e){console.log(e),r(e)})).catch((function(e){return console.log(e)})))}})]})};function VE(e){return TE({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 0 0 203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"}}]})(e)}function GE(e){return TE({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M352.92 80C288 80 256 144 256 144s-32-64-96.92-64c-52.76 0-94.54 44.14-95.08 96.81-1.1 109.33 86.73 187.08 183 252.42a16 16 0 0018 0c96.26-65.34 184.09-143.09 183-252.42-.54-52.67-42.32-96.81-95.08-96.81z"}}]})(e)}function qE(e){return TE({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 448l-9-6c-42.78-28.57-96.91-60.86-137-108.32-42.25-50-62.52-101.35-62-157C48.63 114.54 98.46 64 159.08 64c48.11 0 80.1 28 96.92 48.21C272.82 92 304.81 64 352.92 64c60.62 0 110.45 50.54 111.08 112.65.56 55.68-19.71 107-62 157-40.09 47.49-94.22 79.78-137 108.35z"}}]})(e)}function HE(e){return TE({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 32C114.6 32 0 125.1 0 240c0 47.6 19.9 91.2 52.9 126.3C38 405.7 7 439.1 6.5 439.5c-6.6 7-8.4 17.2-4.6 26S14.4 480 24 480c61.5 0 110-25.7 139.1-46.3C192 442.8 223.2 448 256 448c141.4 0 256-93.1 256-208S397.4 32 256 32zm0 368c-26.7 0-53.1-4.1-78.4-12.1l-22.7-7.2-19.5 13.8c-14.3 10.1-33.9 21.4-57.5 29 7.3-12.1 14.4-25.7 19.9-40.2l10.6-28.1-20.6-21.8C69.7 314.1 48 282.2 48 240c0-88.2 93.3-160 208-160s208 71.8 208 160-93.3 160-208 160z"}}]})(e)}var XE=function(e){var t=e.comment;return(0,bE.jsx)(bE.Fragment,{children:(0,bE.jsx)("div",{className:"flex flex-col p-3 mt-2 mb-2 border border-solid border-purple-300 w-96 h-16 rounded-lg",children:(0,bE.jsx)("div",{id:"",className:"text-gray-600 h-16 text-xs text-clamp",children:t})})})},YE=function(e){var n=e.isOpen,r=e.onClose,a=e.comments,o=e.model,u=(0,t.useState)(""),s=(0,i.Z)(u,2),c=s[0],l=s[1],f=function(){r(),l("")};return(0,bE.jsx)(bE.Fragment,{children:n?(0,bE.jsxs)("div",{onClick:function(e){"background"===e.target.id&&f()},children:[(0,bE.jsx)("div",{className:"fixed inset-0 bg-gray-800 opacity-50 z-50"}),(0,bE.jsx)("div",{id:"background",className:"fixed inset-0 z-50 flex justify-center items-center",children:(0,bE.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full h-3/4 sm:max-w-md relative",children:[(0,bE.jsxs)("div",{className:"absolute top-0 left-0 flex flex-row justify-between items-center w-full h-10 rounded-t-lg bg-purple-900",children:[(0,bE.jsx)("h2",{className:"absolute top-0 left-0 p-2 text-lg text-white",children:"Comments"}),(0,bE.jsx)("button",{className:"text-white absolute top-0 right-0 p-2",onClick:f,children:(0,bE.jsx)(VE,{size:24})})]}),(0,bE.jsxs)("div",{className:"mt-10 w-96 mr-auto ml-auto flex flex-row items-center justify-between",children:[(0,bE.jsx)("input",{className:"border border-gray-400 p-2 w-4/5 rounded focus:outline-gray-400",type:"text",placeholder:"Type something...",value:c,onChange:function(e){return l(e.target.value)}}),(0,bE.jsx)("button",{className:"text-xs bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-2 rounded",onClick:function(){fetch(ZE+"/comments/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"bearer "+localStorage.soma_token},body:JSON.stringify({model_id:o.model_id,user_id:localStorage.user,text:c})}).then((function(e){return e.json()})).then((function(e){e.comment_id&&(console.log("Added Comment"),o.comments.push(c),f())})).catch((function(e){return console.log(e)}))},children:"ADD"})]}),(0,bE.jsx)("div",{className:"flex flex-col justify-start items-center overflow-auto h-3/5 mt-5 mb-5",children:a.map((function(e){return(0,bE.jsx)(XE,{comment:e})}))})]})})]}):null})},KE=function(e){var n=e.model,r=e.setModels,a=e.models,u=se(),s=(0,t.useState)(!1),c=(0,i.Z)(s,2),l=c[0],f=c[1],d=(0,t.useState)(!1),h=(0,i.Z)(d,2),p=h[0],v=h[1],g=(0,t.useState)(!1),m=(0,i.Z)(g,2),y=m[0],b=m[1];(0,t.useEffect)((function(){var e=n.likes.findIndex((function(e){return e===Number(localStorage.user)}));v(-1!==e)}),[]);return(0,bE.jsxs)(bE.Fragment,{children:[(0,bE.jsx)(YE,{isOpen:y,onClose:function(){return b(!1)},comments:n.comments,model:n}),(0,bE.jsxs)("div",{className:"flex flex-col p-5 pb-3 border border-solid border-purple-300 w-96 h-36 rounded-lg",children:[(0,bE.jsx)("h1",{onClick:function(){u("/model",{replace:!1,state:n})},id:"title",className:"text-blue-400 text-lg font-normal hover:underline hover:cursor-pointer truncate",children:n.name}),(0,bE.jsx)("div",{id:"",className:"text-xs text-clamp",children:n.description?n.description:"No description provided"}),(0,bE.jsxs)("div",{id:"likes and comments and visibility",className:"flex items-center flex-row w-auto mt-auto ml-auto hover:cursor-pointer",children:[(0,bE.jsxs)("div",{onClick:function(){fetch(ZE+(p?"/model-likes/delete":"/model-likes/create"),{method:p?"DELETE":"POST",headers:{"Content-Type":"application/json",Authorization:"bearer "+localStorage.soma_token},body:JSON.stringify({model_id:n.model_id,user_id:localStorage.user})}).then((function(e){return e.json()})).then((function(e){if(e.model_id){console.log("Model updated");var t=(0,o.Z)(a),i=t.findIndex((function(e){return e.model_id===n.model_id}));p?(t[i].likes=n.likes.filter((function(e){return e!==localStorage.user})),v(!1)):(t[i].likes.push(localStorage.user),v(!0)),r(t)}})).catch((function(e){return console.log(e)}))},className:"flex flex-row items-center w-auto",children:[p?(0,bE.jsx)(qE,{className:"text-red-400 text-lg"}):(0,bE.jsx)(GE,{className:"text-red-400 text-lg"}),(0,bE.jsx)("div",{className:"text-xs text-gray-400 mr-1",children:null!==n.likes[0]?n.likes.length:0})]}),(0,bE.jsxs)("div",{onClick:function(){b(!0)},className:"text-xs text-gray-400 mr-1",children:[(0,bE.jsx)(HE,{className:"text-gray-400 mr-1"}),null!==n.comments[0]?n.comments.length:0]}),(0,bE.jsx)("div",{onClick:function(){n.user_id===Number(localStorage.user)&&fetch(ZE+"/models/update",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"bearer "+localStorage.soma_token},body:JSON.stringify({model_id:n.model_id,public:0!==n.public?0:1})}).then((function(e){return e.json()})).then((function(e){e.model_id&&(console.log("Model updated"),n.public=0!==n.public?0:1,f(!l))})).catch((function(e){return console.log(e)}))},className:"text-purple-400 text-sm border border-solid rounded-lg px-1",children:0!==n.public?"public":"private"})]})]})]})},$E=function(e){var t=e.results,n=e.setSearchResults,r=e.isOpen,a=e.onClose,i=function(){a()};return(0,bE.jsx)(bE.Fragment,{children:r?(0,bE.jsxs)("div",{onClick:function(e){"background"===e.target.id&&i()},children:[(0,bE.jsx)("div",{className:"fixed inset-0 bg-gray-800 opacity-50 z-50"}),(0,bE.jsx)("div",{id:"background",className:"fixed inset-0 z-50 flex justify-center items-center",children:(0,bE.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full h-3/4 sm:max-w-md relative",children:[(0,bE.jsxs)("div",{className:"absolute top-0 left-0 flex flex-row justify-between items-center w-full h-10 rounded-t-lg bg-purple-900",children:[(0,bE.jsx)("h2",{className:"absolute top-0 left-0 p-2 text-lg text-white",children:"Results"}),(0,bE.jsx)("button",{className:"text-white absolute top-0 right-0 p-2",onClick:i,children:(0,bE.jsx)(VE,{size:24})})]}),(0,bE.jsx)("div",{className:"overflow-auto h-5/6 flex flex-col  items-center  mt-10 mb-5",children:0===t.length?(0,bE.jsx)("div",{children:"No results!"}):t.map((function(e){return(0,bE.jsx)("div",{className:"mb-2 mt-2",children:(0,bE.jsx)(KE,{models:t,setModels:n,model:e},e.model_id)})}))})]})})]}):null})},QE=function(e){var n=wE(),r=se(),a=(0,t.useState)([]),o=(0,i.Z)(a,2),u=o[0],s=o[1],c=(0,t.useState)(!1),l=(0,i.Z)(c,2),f=l[0],d=l[1];return(0,bE.jsxs)(bE.Fragment,{children:[(0,bE.jsx)($E,{results:u,setSearchResults:s,isOpen:f,onClose:function(){return d(!1)}}),(0,bE.jsxs)("div",{className:"bg-purple-900 h-12 flex flex-row items-center",children:[(0,bE.jsx)("h1",{className:"text-white text-2xl ml-2",children:"Soma"}),n.user?(0,bE.jsxs)("div",{className:"flex flex-row items-center justify-evenly w-fit ml-auto mr-5",children:[(0,bE.jsx)(WE,{openModal:function(){return d(!0)},setSearchResults:s}),(0,bE.jsx)("div",{className:"ml-2 mr-2 text-white transition ease-in hover:scale-110 duration-200",children:(0,bE.jsx)("a",{href:"https://towardsdatascience.com/convolutional-neural-networks-explained-9cc5188c4939",target:"_blank",rel:"noopener noreferrer",children:"Learn"})}),(0,bE.jsx)(Ie,{to:"/profile",children:(0,bE.jsx)("div",{className:"ml-2 mr-2 text-white transition ease-in hover:scale-110 duration-200",children:"Dashboard"})}),(0,bE.jsx)(Ie,{to:"/model",children:(0,bE.jsx)("div",{className:"ml-2 mr-2 text-white transition ease-in hover:scale-110 duration-200",children:"Create"})}),(0,bE.jsx)("div",{className:"ml-2 mr-2 text-white transition ease-in hover:cursor-pointer hover:scale-110 duration-200",onClick:function(e){n.logout(),r("/login",{replace:!0})},children:"Logout"})]}):(0,bE.jsxs)("div",{className:"flex justify-evenly w-fit ml-auto mr-5",children:[(0,bE.jsx)(Ie,{to:"/model",children:(0,bE.jsx)("div",{className:"ml-2 mr-2 text-white transition ease-in hover:scale-110 duration-200",children:"Create"})}),(0,bE.jsx)(Ie,{to:"/login",children:(0,bE.jsx)("div",{className:"ml-2 mr-2 text-white transition ease-in hover:scale-110 duration-200",children:"Login"})}),(0,bE.jsx)(Ie,{to:"/signUp",children:(0,bE.jsx)("div",{className:"ml-2 mr-2 text-white transition ease-in hover:scale-110 duration-200",children:"SignUp"})})]})]})]})},JE=function(e){return wE().user?e.children:(0,bE.jsx)(be,{to:"/login",replace:!0})},eT=n.p+"static/media/wallpaper.121b74738de1a0fe4fb8.jpg",tT=function(){return(0,bE.jsx)("div",{children:(0,bE.jsx)("img",{className:"h-72 w-72",style:{borderRadius:"50%"},src:eT,alt:"Profile Picture"})})},nT=function(){var e=se(),n=(0,t.useState)([]),r=(0,i.Z)(n,2),a=r[0],o=r[1];return(0,t.useEffect)((function(){fetch(ZE+"/models/".concat(localStorage.user,"/getUserModels"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"bearer "+localStorage.soma_token}}).then((function(e){return e.json()})).then((function(e){console.log(e),o(e)})).catch((function(e){return console.log(e)}))}),[]),(0,bE.jsxs)("div",{className:"bg-white flex min-h-screen",children:[(0,bE.jsxs)("div",{id:"profile-section",className:"bg-white pt-10 flex flex-col items-center w-1/4",style:{boxShadow:"1px 0px 1px 0 lightgray"},children:[(0,bE.jsx)(tT,{}),(0,bE.jsx)("p",{className:"mt-5 text-justify w-9/12 text-clamp",children:"Description will go here. Description will go here. Description will go here. Description will go here . Description will go here."}),(0,bE.jsx)("button",{className:"w-64 h-8 mt-6 bg-purple-900 text-white text-md hover:bg-purple-800 rounded",onClick:function(){return e("/settings",{replace:!1})},children:"Edit Profile"}),(0,bE.jsx)("hr",{className:"mt-5 bg-gray-400 h-0.5",style:{width:"80%"}})]}),(0,bE.jsx)("div",{id:"projects",className:"p-20 grid grid-cols-2 auto-rows-min gap-6",children:0===a.length?(0,bE.jsx)("div",{children:"No projects yet."}):a.map((function(e){return(0,bE.jsx)(KE,{models:a,setModels:o,model:e},e.model_id)}))})]})},rT=n(386),aT="https://storage.googleapis.com/kagglesdsdata/datasets/20079/26025/iris.json?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=gcp-kaggle-com%40kaggle-161607.iam.gserviceaccount.com%2F20230508%2Fauto%2Fstorage%2Fgoog4_request&X-Goog-Date=20230508T054754Z&X-Goog-Expires=259200&X-Goog-SignedHeaders=host&X-Goog-Signature=33e4ed8d9f7c3a1725da6e0459737df8d7c765541945895f617ed84e543a755578eb36cfa230c5e6fb6a0addc28009cca7c7a76b121829331608cd6315f9d52c0c7ff8fa5e3ae23d32f844076da5a30a44bb96b793eaefb39053cb43cf58916b53c5785f7549c0419f565c046ac85cdf6565443c6ff4304a0a991745b70a5e9ad87ffe57a30439c841e3dc0d1fee47744daba94b58759b1b6d9788874372fce15f643b04bca634fe8615f217d4be3420179f86175381e61e85269e011c4982f95c80ba7b8deebd4784764bac3380e4eb1b5ea2c11f6b5be1981bc436db9fd970dcfe9df2588ffdc0a901863ac9cda7144c7ef2cac06c7c6a7b75e1ccd11a6b2f";function iT(){return oT.apply(this,arguments)}function oT(){return(oT=(0,Co.Z)((0,_o.Z)().mark((function e(){var t,n,r;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(aT);case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,r=n.map((function(e){return{sepalLength:e.sepalLength,sepalWidth:e.sepalWidth,petalLength:e.petalLength,petalWidth:e.petalWidth,species:e.species}})).filter((function(e){return null!=e.price&&null!=e.rooms})),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function uT(){return sT.apply(this,arguments)}function sT(){return(sT=(0,Co.Z)((0,_o.Z)().mark((function e(){var t,n,r;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://raw.githubusercontent.com/meetnandu05/ml1/master/house.json");case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,r=n.map((function(e){return{price:e.Price,rooms:e.AvgAreaNumberofRooms}})).filter((function(e){return null!=e.price&&null!=e.rooms})),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function cT(e){return Re.tidy((function(){Re.util.shuffle(e);var t=e.map((function(e){return e.rooms})),n=e.map((function(e){return e.price})),r=Re.tensor2d(t,[t.length,1]),a=Re.tensor2d(n,[n.length,1]),i=r.max(),o=r.min(),u=a.max(),s=a.min();return{inputs:r.sub(o).div(i.sub(o)),labels:a.sub(s).div(u.sub(s)),inputMax:i,inputMin:o,labelMax:u,labelMin:s}}))}var lT=function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t,n;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,uT();case 2:t=e.sent,n=t.map((function(e){return{x:e.rooms,y:e.price}})),rT.render.scatterplot({name:"No.of rooms v Price"},{values:n},{xLabel:"No. of rooms",yLabel:"Price",height:300});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fT=function(e,t){var n=Ku();return n.add(hl({inputShape:[1],units:1,useBias:!0})),e.forEach((function(e){n.add(hl({activation:t.activation,units:e.neurons}))})),n.add(hl({activation:"relu",units:1})),n.compile({optimizer:Re.train[t.optimizer](Number(t.learningRate)),loss:"meanSquaredError"}),n},dT=function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n,r){var a,i,o,u;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=cT,e.next=3,uT();case 3:return e.t1=e.sent,a=(0,e.t0)(e.t1),i=a.inputs,o=a.labels,u=fT(t,n),e.next=10,iT();case 10:return e.sent,console.log(i),console.log(n),console.log(u.summary()),rT.show.modelSummary({name:"Model Summary"},u),e.abrupt("return",u.fit(i,o,{batchSize:8,epochs:10,callbacks:[{onEpochEnd:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t,n.loss),document.getElementById("epoch").textContent=hT(t,6);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},rT.show.fitCallbacks({name:"Training Performance"},["loss","mse"],{height:200,callbacks:["onEpochEnd"]})]}));case 16:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),hT=function(e,t){return String(e).padStart(t,"0")};function pT(e){return TE({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.348c1.295.712 1.295 2.573 0 3.285L7.28 19.991c-1.25.687-2.779-.217-2.779-1.643V5.653z",clipRule:"evenodd"}}]})(e)}var vT="hyperparametersView_container__wR83X",gT="hyperparametersView_card__auEGB",mT="hyperparametersView_epoch__sh3Gx",yT="hyperparametersView_start_button__P9srD";function bT(e){return TE({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M346.5 240H272v-74.5c0-8.8-7.2-16-16-16s-16 7.2-16 16V240h-74.5c-8.8 0-16 6-16 16s7.5 16 16 16H240v74.5c0 9.5 7 16 16 16s16-7.2 16-16V272h74.5c8.8 0 16-7.2 16-16s-7.2-16-16-16z"}},{tag:"path",attr:{d:"M256 76c48.1 0 93.3 18.7 127.3 52.7S436 207.9 436 256s-18.7 93.3-52.7 127.3S304.1 436 256 436c-48.1 0-93.3-18.7-127.3-52.7S76 304.1 76 256s18.7-93.3 52.7-127.3S207.9 76 256 76m0-28C141.1 48 48 141.1 48 256s93.1 208 208 208 208-93.1 208-208S370.9 48 256 48z"}}]})(e)}function xT(e){return TE({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M346.5 240h-181c-8.8 0-16 6-16 16s7.5 16 16 16h181c8.8 0 16-7.2 16-16s-7.2-16-16-16z"}},{tag:"path",attr:{d:"M256 76c48.1 0 93.3 18.7 127.3 52.7S436 207.9 436 256s-18.7 93.3-52.7 127.3S304.1 436 256 436c-48.1 0-93.3-18.7-127.3-52.7S76 304.1 76 256s18.7-93.3 52.7-127.3S207.9 76 256 76m0-28C141.1 48 48 141.1 48 256s93.1 208 208 208 208-93.1 208-208S370.9 48 256 48z"}}]})(e)}function kT(e){return TE({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M128 192l128 128 128-128z"}}]})(e)}var wT="dropdownMenu_dropdownMenu__L-h6S",_T="dropdownMenu_title__vQhzm",CT="dropdownMenu_dropdownMenuContent__fJOEo",ST=function(e){return(0,bE.jsxs)("div",{className:wT,children:[(0,bE.jsxs)("div",{className:_T,children:[e.title," ",(0,bE.jsx)(kT,{})]}),(0,bE.jsx)("div",{className:CT,children:e.children})]})},AT=function(e){var n=e.isOpen,r=e.onClose,a=e.params,o=e.model,u=(0,t.useState)(null!==o?o.name:"My Model"),s=(0,i.Z)(u,2),c=s[0],l=s[1],f=(0,t.useState)(null!==o?o.description:""),d=(0,i.Z)(f,2),h=d[0],p=d[1],v=(0,t.useState)(!1),g=(0,i.Z)(v,2),m=g[0],y=g[1],b=function(){return y(!1)},x=function(){r()},k=function(){o&&o.user_id!==Number(localStorage.user)||(""===c?(y(!0),setTimeout(b,3e3)):null!==o?(fetch(ZE+"/models/update",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"bearer "+localStorage.soma_token},body:JSON.stringify({model_id:o.model_id,name:c,description:h,user_id:localStorage.user,learning_rate:a.learningRate,optimizer:a.optimizer,layers:JSON.stringify(a.layers)})}).then((function(e){return e.json()})).then((function(e){e.model_id&&console.log("Model updated")})).catch((function(e){return console.log(e)})),x()):(fetch(ZE+"/models/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"bearer "+localStorage.soma_token},body:JSON.stringify({name:c,description:h,user_id:localStorage.user,learning_rate:a.learningRate,optimizer:a.optimizer,layers:JSON.stringify(a.layers)})}).then((function(e){return e.json()})).then((function(e){e.model_id&&console.log("Model saved")})).catch((function(e){return console.log(e)})),x()))};return(0,bE.jsx)(bE.Fragment,{children:n?(0,bE.jsxs)("div",{onClick:function(e){"background"===e.target.id&&x()},children:[(0,bE.jsx)("div",{className:"fixed inset-0 bg-gray-800 opacity-50 z-50"}),(0,bE.jsx)("div",{id:"background",className:"fixed inset-0 z-50 flex justify-center items-center",children:(0,bE.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full sm:max-w-md relative",children:[(0,bE.jsxs)("div",{className:"absolute top-0 left-0 flex flex-row justify-between items-center w-full h-10 rounded-t-lg bg-purple-900",children:[(0,bE.jsx)("h2",{className:"absolute top-0 left-0 p-2 text-lg text-white",children:"Save Model Architecture"}),(0,bE.jsx)("button",{className:"text-white absolute top-0 right-0 p-2",onClick:x,children:(0,bE.jsx)(VE,{size:24})})]}),(0,bE.jsxs)("div",{className:"mt-10 flex flex-col items-center justify-center",children:[(0,bE.jsxs)("div",{className:"flex flex-row w-11/12 items-center justify-between mb-4 mt-2",children:[(0,bE.jsx)("label",{className:"block font-bold mr-2",children:"Model Name:"}),(0,bE.jsx)("input",{className:"border border-gray-400 p-2 w-6/12 rounded focus:outline-gray-400",type:"text",value:c,onChange:function(e){return l(e.target.value)}})]}),(0,bE.jsxs)("div",{className:"flex flex-row w-11/12 items-center justify-between mb-4 mt-2",children:[(0,bE.jsx)("label",{className:"block font-bold mr-2",children:"Description:"}),(0,bE.jsx)("input",{className:"border border-gray-400 p-2 w-6/12 rounded focus:outline-gray-400",type:"text",value:h,onChange:function(e){return p(e.target.value)}})]}),m?(0,bE.jsx)("div",{className:"text-red-500 mx-auto mt-2 mb-2",children:"Please give model name!"}):"",(0,bE.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",onClick:function(){k()},children:"Save"})]})]})})]}):null})},ET=784,TT=10,NT=65e3,DT=Math.floor(54166.66666666667),FT=NT-DT,IT=function(){function e(){(0,u.Z)(this,e),this.shuffledTrainIndex=0,this.shuffledTestIndex=0}return(0,s.Z)(e,[{key:"load",value:function(){var e=(0,Co.Z)((0,_o.Z)().mark((function e(){var t,n,r,a,o,u,s,c,l=this;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Image,n=document.createElement("canvas"),r=n.getContext("2d"),a=new Promise((function(e,a){t.crossOrigin="",t.onload=function(){t.width=t.naturalWidth,t.height=t.naturalHeight;var a=new ArrayBuffer(20384e4),i=5e3;n.width=t.width,n.height=i;for(var o=0;o<13;o++){var u=new Float32Array(a,o*ET*i*4,392e4);r.drawImage(t,0,o*i,t.width,i,0,0,t.width,i);for(var s=r.getImageData(0,0,n.width,n.height),c=0;c<s.data.length/4;c++)u[c]=s.data[4*c]/255}l.datasetImages=new Float32Array(a),e()},t.src="https://storage.googleapis.com/learnjs-data/model-builder/mnist_images.png"})),o=fetch("https://storage.googleapis.com/learnjs-data/model-builder/mnist_labels_uint8"),e.next=7,Promise.all([a,o]);case 7:return u=e.sent,s=(0,i.Z)(u,2),s[0],c=s[1],e.t0=Uint8Array,e.next=14,c.arrayBuffer();case 14:e.t1=e.sent,this.datasetLabels=new e.t0(e.t1),this.trainIndices=Re.util.createShuffledIndices(DT),this.testIndices=Re.util.createShuffledIndices(FT),this.trainImages=this.datasetImages.slice(0,ET*DT),this.testImages=this.datasetImages.slice(ET*DT),this.trainLabels=this.datasetLabels.slice(0,TT*DT),this.testLabels=this.datasetLabels.slice(TT*DT);case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"nextTrainBatch",value:function(e){var t=this;return this.nextBatch(e,[this.trainImages,this.trainLabels],(function(){return t.shuffledTrainIndex=(t.shuffledTrainIndex+1)%t.trainIndices.length,t.trainIndices[t.shuffledTrainIndex]}))}},{key:"nextTestBatch",value:function(e){var t=this;return this.nextBatch(e,[this.testImages,this.testLabels],(function(){return t.shuffledTestIndex=(t.shuffledTestIndex+1)%t.testIndices.length,t.testIndices[t.shuffledTestIndex]}))}},{key:"nextBatch",value:function(e,t,n){for(var r=new Float32Array(e*ET),a=new Uint8Array(e*TT),i=0;i<e;i++){var o=n(),u=t[0].slice(o*ET,o*ET+ET);r.set(u,i*ET);var s=t[1].slice(o*TT,o*TT+TT);a.set(s,i*TT)}return{xs:Re.tensor2d(r,[e,ET]),labels:Re.tensor2d(a,[e,TT])}}}]),e}();function MT(e){return OT.apply(this,arguments)}function OT(){return(OT=(0,Co.Z)((0,_o.Z)().mark((function e(t){var n,r,a,i,o;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=rT.visor().surface({name:"Input Data Examples",tab:"Input Data"}),r=t.nextTestBatch(20),a=r.xs.shape[0],i=(0,_o.Z)().mark((function e(t){var a,i;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Re.tidy((function(){return r.xs.slice([t,0],[1,r.xs.shape[1]]).reshape([28,28,1])})),(i=document.createElement("canvas")).width=28,i.height=28,i.style="margin: 4px;",e.next=7,Re.browser.toPixels(a,i);case 7:n.drawArea.appendChild(i),a.dispose();case 9:case"end":return e.stop()}}),e)})),o=0;case 5:if(!(o<a)){e.next=10;break}return e.delegateYield(i(o),"t0",7);case 7:o++,e.next=5;break;case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function RT(){return RT=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){var r,a;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Loading data...."),r=new IT,e.next=4,r.load();case 4:return console.log("Loaded...."),e.next=7,MT(r);case 7:return a=ZT(t,n),rT.show.modelSummary({name:"Model Architecture",tab:"Model"},a),e.next=11,BT(a,r);case 11:case"end":return e.stop()}}),e)}))),RT.apply(this,arguments)}function ZT(e,t){var n=Ku();n.add(dl({inputShape:[28,28,1],kernelSize:5,filters:8,strides:1,activation:"relu",kernelInitializer:"varianceScaling"}));var r=!1;e.forEach((function(e){switch(e.type){case"conv2d":n.add(dl({kernelSize:Number(e.kernel_size),filters:Number(e.num_of_kernels),strides:Number(e.stride),activation:"relu",kernelInitializer:"varianceScaling"}));break;case"maxPool2d":n.add(vl({poolSize:[2,2],strides:[2,2]}));break;case"avgPool2d":break;default:r||(n.add(pl()),r=!0),n.add(hl({units:Number(e.neurons),kernelInitializer:"varianceScaling",activation:"relu"}))}})),r||n.add(pl());n.add(hl({units:10,kernelInitializer:"varianceScaling",activation:"softmax"}));var a=Re.train.adam();return n.compile({optimizer:a,loss:"categoricalCrossentropy",metrics:["accuracy"]}),n}function BT(e,t){return zT.apply(this,arguments)}function zT(){return zT=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){var r,a,o,u,s,c,l,f,d,h,p;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=["loss","val_loss","acc","val_acc"],a={name:"Model Training",tab:"Model",styles:{height:"1000px"}},o=rT.show.fitCallbacks(a,r),512,5500,1e3,u=Re.tidy((function(){var e=n.nextTrainBatch(5500);return[e.xs.reshape([5500,28,28,1]),e.labels]})),s=(0,i.Z)(u,2),c=s[0],l=s[1],f=Re.tidy((function(){var e=n.nextTestBatch(1e3);return[e.xs.reshape([1e3,28,28,1]),e.labels]})),d=(0,i.Z)(f,2),h=d[0],p=d[1],e.abrupt("return",t.fit(c,l,{batchSize:512,validationData:[h,p],epochs:10,shuffle:!0,callbacks:o}));case 9:case"end":return e.stop()}}),e)}))),zT.apply(this,arguments)}var LT=["Iris-setosa","Iris-versicolor","Iris-virginica"],PT=LT.length,jT=[[5.1,3.5,1.4,.2,0],[4.9,3,1.4,.2,0],[4.7,3.2,1.3,.2,0],[4.6,3.1,1.5,.2,0],[5,3.6,1.4,.2,0],[5.4,3.9,1.7,.4,0],[4.6,3.4,1.4,.3,0],[5,3.4,1.5,.2,0],[4.4,2.9,1.4,.2,0],[4.9,3.1,1.5,.1,0],[5.4,3.7,1.5,.2,0],[4.8,3.4,1.6,.2,0],[4.8,3,1.4,.1,0],[4.3,3,1.1,.1,0],[5.8,4,1.2,.2,0],[5.7,4.4,1.5,.4,0],[5.4,3.9,1.3,.4,0],[5.1,3.5,1.4,.3,0],[5.7,3.8,1.7,.3,0],[5.1,3.8,1.5,.3,0],[5.4,3.4,1.7,.2,0],[5.1,3.7,1.5,.4,0],[4.6,3.6,1,.2,0],[5.1,3.3,1.7,.5,0],[4.8,3.4,1.9,.2,0],[5,3,1.6,.2,0],[5,3.4,1.6,.4,0],[5.2,3.5,1.5,.2,0],[5.2,3.4,1.4,.2,0],[4.7,3.2,1.6,.2,0],[4.8,3.1,1.6,.2,0],[5.4,3.4,1.5,.4,0],[5.2,4.1,1.5,.1,0],[5.5,4.2,1.4,.2,0],[4.9,3.1,1.5,.1,0],[5,3.2,1.2,.2,0],[5.5,3.5,1.3,.2,0],[4.9,3.1,1.5,.1,0],[4.4,3,1.3,.2,0],[5.1,3.4,1.5,.2,0],[5,3.5,1.3,.3,0],[4.5,2.3,1.3,.3,0],[4.4,3.2,1.3,.2,0],[5,3.5,1.6,.6,0],[5.1,3.8,1.9,.4,0],[4.8,3,1.4,.3,0],[5.1,3.8,1.6,.2,0],[4.6,3.2,1.4,.2,0],[5.3,3.7,1.5,.2,0],[5,3.3,1.4,.2,0],[7,3.2,4.7,1.4,1],[6.4,3.2,4.5,1.5,1],[6.9,3.1,4.9,1.5,1],[5.5,2.3,4,1.3,1],[6.5,2.8,4.6,1.5,1],[5.7,2.8,4.5,1.3,1],[6.3,3.3,4.7,1.6,1],[4.9,2.4,3.3,1,1],[6.6,2.9,4.6,1.3,1],[5.2,2.7,3.9,1.4,1],[5,2,3.5,1,1],[5.9,3,4.2,1.5,1],[6,2.2,4,1,1],[6.1,2.9,4.7,1.4,1],[5.6,2.9,3.6,1.3,1],[6.7,3.1,4.4,1.4,1],[5.6,3,4.5,1.5,1],[5.8,2.7,4.1,1,1],[6.2,2.2,4.5,1.5,1],[5.6,2.5,3.9,1.1,1],[5.9,3.2,4.8,1.8,1],[6.1,2.8,4,1.3,1],[6.3,2.5,4.9,1.5,1],[6.1,2.8,4.7,1.2,1],[6.4,2.9,4.3,1.3,1],[6.6,3,4.4,1.4,1],[6.8,2.8,4.8,1.4,1],[6.7,3,5,1.7,1],[6,2.9,4.5,1.5,1],[5.7,2.6,3.5,1,1],[5.5,2.4,3.8,1.1,1],[5.5,2.4,3.7,1,1],[5.8,2.7,3.9,1.2,1],[6,2.7,5.1,1.6,1],[5.4,3,4.5,1.5,1],[6,3.4,4.5,1.6,1],[6.7,3.1,4.7,1.5,1],[6.3,2.3,4.4,1.3,1],[5.6,3,4.1,1.3,1],[5.5,2.5,4,1.3,1],[5.5,2.6,4.4,1.2,1],[6.1,3,4.6,1.4,1],[5.8,2.6,4,1.2,1],[5,2.3,3.3,1,1],[5.6,2.7,4.2,1.3,1],[5.7,3,4.2,1.2,1],[5.7,2.9,4.2,1.3,1],[6.2,2.9,4.3,1.3,1],[5.1,2.5,3,1.1,1],[5.7,2.8,4.1,1.3,1],[6.3,3.3,6,2.5,2],[5.8,2.7,5.1,1.9,2],[7.1,3,5.9,2.1,2],[6.3,2.9,5.6,1.8,2],[6.5,3,5.8,2.2,2],[7.6,3,6.6,2.1,2],[4.9,2.5,4.5,1.7,2],[7.3,2.9,6.3,1.8,2],[6.7,2.5,5.8,1.8,2],[7.2,3.6,6.1,2.5,2],[6.5,3.2,5.1,2,2],[6.4,2.7,5.3,1.9,2],[6.8,3,5.5,2.1,2],[5.7,2.5,5,2,2],[5.8,2.8,5.1,2.4,2],[6.4,3.2,5.3,2.3,2],[6.5,3,5.5,1.8,2],[7.7,3.8,6.7,2.2,2],[7.7,2.6,6.9,2.3,2],[6,2.2,5,1.5,2],[6.9,3.2,5.7,2.3,2],[5.6,2.8,4.9,2,2],[7.7,2.8,6.7,2,2],[6.3,2.7,4.9,1.8,2],[6.7,3.3,5.7,2.1,2],[7.2,3.2,6,1.8,2],[6.2,2.8,4.8,1.8,2],[6.1,3,4.9,1.8,2],[6.4,2.8,5.6,2.1,2],[7.2,3,5.8,1.6,2],[7.4,2.8,6.1,1.9,2],[7.9,3.8,6.4,2,2],[6.4,2.8,5.6,2.2,2],[6.3,2.8,5.1,1.5,2],[6.1,2.6,5.6,1.4,2],[7.7,3,6.1,2.3,2],[6.3,3.4,5.6,2.4,2],[6.4,3.1,5.5,1.8,2],[6,3,4.8,1.8,2],[6.9,3.1,5.4,2.1,2],[6.7,3.1,5.6,2.4,2],[6.9,3.1,5.1,2.3,2],[5.8,2.7,5.1,1.9,2],[6.8,3.2,5.9,2.3,2],[6.7,3.3,5.7,2.5,2],[6.7,3,5.2,2.3,2],[6.3,2.5,5,1.9,2],[6.5,3,5.2,2,2],[6.2,3.4,5.4,2.3,2],[5.9,3,5.1,1.8,2]];function UT(e,t,n){var r=e.length;if(r!==t.length)throw new Error("data and split have different numbers of examples");for(var a=[],i=0;i<r;++i)a.push(i);Re.util.shuffle(a);for(var o=[],u=[],s=0;s<r;++s)o.push(e[a[s]]),u.push(t[a[s]]);var c=Math.round(r*n),l=r-c,f=o[0].length,d=Re.tensor2d(o,[r,f]),h=Re.oneHot(Re.tensor1d(u).toInt(),PT),p=d.slice([0,0],[l,f]),v=d.slice([l,0],[c,f]);return[p,h.slice([0,0],[l,PT]),v,h.slice([0,0],[c,PT])]}function WT(e){return Re.tidy((function(){for(var t=[],n=[],r=0;r<LT.length;++r)t.push([]),n.push([]);var a,o=(0,h.Z)(jT);try{for(o.s();!(a=o.n()).done;){var u=a.value,s=u[u.length-1],c=u.slice(0,u.length-1);t[s].push(c),n[s].push(s)}}catch(w){o.e(w)}finally{o.f()}for(var l=[],f=[],d=[],p=[],v=0;v<LT.length;++v){var g=UT(t[v],n[v],e),m=(0,i.Z)(g,4),y=m[0],b=m[1],x=m[2],k=m[3];l.push(y),f.push(b),d.push(x),p.push(k)}return[Re.concat(l,0),Re.concat(f,0),Re.concat(d,0),Re.concat(p,0)]}))}function VT(e,t,n,r,a,i){return GT.apply(this,arguments)}function GT(){return GT=(0,Co.Z)((0,_o.Z)().mark((function e(t,n,r,a,i,o){var u,s,c,l,f,d;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u={learningRate:.001,epochs:10},(s=Ku()).add(hl({units:10,activation:"sigmoid",inputShape:[t.shape[1]]})),i.forEach((function(e){s.add(hl({activation:o.activation,units:e.neurons}))})),s.add(hl({units:3,activation:"softmax"})),s.summary(),rT.show.modelSummary({name:"Model Architecture",tab:"Model"},s),c=Re.train.adam(u.learningRate),s.compile({optimizer:c,loss:"categoricalCrossentropy",metrics:["accuracy"]}),l=["loss","val_loss","acc","val_acc"],f={name:"Model Training",tab:"Model",styles:{height:"1000px"}},d=rT.show.fitCallbacks(f,l),e.next=14,s.fit(t,n,{epochs:u.epochs,validationData:[r,a],callbacks:d});case 14:return e.sent,e.abrupt("return",s);case 16:case"end":return e.stop()}}),e)}))),GT.apply(this,arguments)}function qT(){return(qT=(0,Co.Z)((0,_o.Z)().mark((function e(t,n){var r,a,o,u,s,c;return(0,_o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=WT(.15),a=(0,i.Z)(r,4),o=a[0],u=a[1],s=a[2],c=a[3],e.next=3,VT(o,u,s,c,t,n);case 3:e.sent;case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var HT={rateOptions:[.001,.003,.01,.03,.1,.3,1,3,10],activation:["relu","sigmoid","tanh","linear"],optimizer:["adam","sgd","rmsprop","adadelta","adagrad"],dataset:["iris","mnist","boston-housing"]},XT=function(e){var n=(0,t.useState)(e.options?e.options[0]:""),r=(0,i.Z)(n,2),a=r[0],o=r[1];return(0,bE.jsxs)("div",{className:gT,children:[(0,bE.jsx)("h4",{children:e.title}),(0,bE.jsx)(ST,{title:a,children:e.options?e.options.map((function(t,n){return(0,bE.jsx)("div",{onClick:function(){o(t),e.update(t)},children:t},n)})):""})]})},YT=function(e){var n=wE(),r=(0,t.useRef)("0.001"),a=(0,t.useRef)("relu"),o=(0,t.useRef)("adam"),u=(0,t.useState)(!1),s=(0,i.Z)(u,2),c=s[0],l=s[1];return(0,bE.jsxs)(bE.Fragment,{children:[(0,bE.jsx)(AT,{isOpen:c,onClose:function(){return l(!1)},model:e.model,params:{layers:e.layers,learningRate:r.current,optimizer:o.current}}),(0,bE.jsxs)("div",{className:vT,children:[(0,bE.jsx)("div",{className:"hover:cursor-pointer text-sm font-medium",children:(0,bE.jsx)("div",{className:yT,onClick:function(){switch(e.dataset){case"mnist":!function(e,t){RT.apply(this,arguments)}(e.layers,{learningRate:r.current,activation:a.current,optimizer:o.current});break;case"boston-housing":dT(e.layers,{learningRate:r.current,activation:a.current,optimizer:o.current}),lT();break;default:!function(e,t){qT.apply(this,arguments)}(e.layers,{learningRate:r.current,activation:a.current,optimizer:o.current})}},children:(0,bE.jsx)(pT,{})})}),(0,bE.jsxs)("div",{className:mT,children:[(0,bE.jsx)("h4",{children:"Epoch"}),(0,bE.jsx)("p",{id:"epoch",className:"text-lg",children:"000000"})]}),(0,bE.jsx)("div",{children:(0,bE.jsx)("button",{id:"show-graphs",className:"text-sm rounded-lg border border-black p-2 hover:bg-purple-200",onClick:function(){rT.visor().toggle();rT.visor().surface({name:"My First Surface",tab:"Input Data"}).drawArea},children:"Show graphs"})}),(0,bE.jsx)("div",{children:n.user?(0,bE.jsx)("button",{onClick:function(){e.model&&e.model.user_id!==Number(localStorage.user)||l(!0)},className:"text-sm rounded-lg border border-black p-2 hover:bg-purple-200",children:"Save Model"}):""}),(0,bE.jsxs)("div",{className:"flex flex-row justify-evenly w-3/5",children:[(0,bE.jsx)(XT,{title:"Learning Rate",options:HT.rateOptions,update:function(e){return r.current=e}}),(0,bE.jsx)(XT,{title:"Activation",options:HT.activation,update:function(e){return a.current=e}}),(0,bE.jsx)(XT,{title:"optimizer",options:HT.optimizer,update:function(e){return o.current=e}}),(0,bE.jsx)(XT,{title:"Dataset",options:HT.dataset,update:e.setDataset})]})]})]})},KT="architectureView_buttonsContainer__4HCfz",$T="architectureView_button__WlQaC",QT=function(e){var n=e.isOpen,r=e.onClose,a=e.addLayer,o=e.denseLayer,u=e.setDenseLayer,s=(0,t.useState)(!0),c=(0,i.Z)(s,2),l=c[0],f=c[1],d=(0,t.useState)(!1),h=(0,i.Z)(d,2),p=h[0],v=h[1],g=(0,t.useState)(!1),m=(0,i.Z)(g,2),y=m[0],b=m[1],x=(0,t.useState)(!1),k=(0,i.Z)(x,2),w=k[0],_=k[1],C=(0,t.useState)("Choose Layer"),S=(0,i.Z)(C,2),A=S[0],E=S[1],T=(0,t.useState)(3),N=(0,i.Z)(T,2),D=N[0],F=N[1],I=(0,t.useState)(1),M=(0,i.Z)(I,2),O=M[0],R=M[1],Z=(0,t.useState)(0),B=(0,i.Z)(Z,2),z=B[0],L=B[1],P=(0,t.useState)(1),j=(0,i.Z)(P,2),U=j[0],W=j[1],V=function(){f(!0),v(!1),b(!1),_(!1),E("Choose Layer"),F(3),R(1),L(0),W(1),r()};return(0,bE.jsx)(bE.Fragment,{children:n?(0,bE.jsxs)("div",{onClick:function(e){"background"===e.target.id&&V()},children:[(0,bE.jsx)("div",{className:"fixed inset-0 bg-gray-800 opacity-50 z-50"}),(0,bE.jsx)("div",{id:"background",className:"fixed inset-0 z-50 flex justify-center items-center",children:(0,bE.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full sm:max-w-md relative",children:[(0,bE.jsxs)("div",{className:"absolute top-0 left-0 flex flex-row justify-between items-center w-full h-10 rounded-t-lg bg-purple-900",children:[(0,bE.jsx)("h2",{className:"absolute top-0 left-0 p-2 text-lg text-white",children:A}),(0,bE.jsx)("button",{className:"text-white absolute top-0 right-0 p-2",onClick:V,children:(0,bE.jsx)(VE,{size:24})})]}),l?(0,bE.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,bE.jsx)("button",{onClick:function(){a(),u(!0),V()},className:"w-5/6 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mb-2 mt-8",children:"Dense Layer"}),(0,bE.jsx)("button",{disabled:o,onClick:function(){v(!0),b(!1),_(!1),f(!1),E("Convolutional Layer")},className:"w-5/6 bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded mb-2 mt-2",children:"Convolutional Layer"}),(0,bE.jsx)("button",{disabled:o,onClick:function(){v(!1),b(!0),_(!1),f(!1),E("Max Pool Layer")},className:"w-5/6 bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded mb-2 mt-2",children:"Max Pool Layer"}),(0,bE.jsx)("button",{disabled:o,onClick:function(){v(!1),b(!1),_(!0),f(!1),E("Avg Pool Layer")},className:"w-5/6 bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded mb-2 mt-2",children:"Avg Pool Layer"})]}):p?(0,bE.jsxs)("div",{className:"mt-10 flex flex-col items-center justify-center",children:[(0,bE.jsxs)("div",{className:"flex flex-row w-11/12 items-center justify-between mb-2 mt-2",children:[(0,bE.jsx)("label",{className:"block font-bold mr-2",children:"Kernel Size:"}),(0,bE.jsx)("input",{className:"border border-gray-400 p-2 w-6/12 rounded",type:"number",value:D,onChange:function(e){return F(e.target.value)}})]}),(0,bE.jsxs)("div",{className:"flex flex-row w-11/12 items-center justify-between mb-2 mt-2",children:[(0,bE.jsx)("label",{className:"block font-bold mr-2",children:"Num of Kernels:"}),(0,bE.jsx)("input",{className:"border border-gray-400 p-2 w-6/12 rounded",type:"number",value:O,onChange:function(e){return R(e.target.value)}})]}),(0,bE.jsxs)("div",{className:"flex flex-row w-11/12 items-center justify-between mb-2 mt-2",children:[(0,bE.jsx)("label",{className:"block font-bold mr-2",children:"Stride:"}),(0,bE.jsx)("input",{className:"border border-gray-400 p-2 w-6/12 rounded",type:"number",value:U,onChange:function(e){return W(e.target.value)}})]}),(0,bE.jsxs)("div",{className:"flex flex-row w-11/12 items-center justify-between mb-2 mt-2",children:[(0,bE.jsx)("label",{className:"block font-bold mr-2",children:"Padding:"}),(0,bE.jsx)("input",{className:"border border-gray-400 p-2 w-6/12 rounded",type:"number",value:z,onChange:function(e){return L(e.target.value)}})]}),(0,bE.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",onClick:function(){a("conv2d",{kernel_size:D,num_of_kernels:O,padding:z,stride:U}),V()},children:"Save"})]}):y||w?(0,bE.jsxs)("div",{className:"mt-10 flex flex-col items-center justify-center",children:[(0,bE.jsxs)("div",{className:"flex flex-row w-11/12 items-center justify-between mb-2 mt-2",children:[(0,bE.jsx)("label",{className:"block font-bold mr-2",children:"Kernel Size:"}),(0,bE.jsx)("input",{className:"border border-gray-400 p-2 w-6/12 rounded",type:"number",value:D,onChange:function(e){return F(e.target.value)}})]}),(0,bE.jsxs)("div",{className:"flex flex-row w-11/12 items-center justify-between mb-2 mt-2",children:[(0,bE.jsx)("label",{className:"block font-bold mr-2",children:"Stride:"}),(0,bE.jsx)("input",{className:"border border-gray-400 p-2 w-6/12 rounded",type:"number",value:U,onChange:function(e){return W(e.target.value)}})]}),(0,bE.jsx)("button",{className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",onClick:function(){a("maxPool2d",{kernel_size:D,stride:U}),V()},children:"Save"})]}):null]})})]}):null})},JT=function(e){var n=e.layers,r=e.updateLayers,a=e.dataset,u=(0,t.useState)(!1),s=(0,i.Z)(u,2),c=s[0],l=s[1],f=(0,t.useState)("mnist"!==a),d=(0,i.Z)(f,2),h=d[0],p=d[1];(0,t.useEffect)((function(){console.log("mnist"!==a),p("mnist"!==a)}),[a]);return(0,t.useEffect)((function(){!function(){var e=document.getElementById("network");e.childNodes.forEach((function(t){e.removeChild(t)}));var t=1e3*Math.ceil(n.length/6),a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("id","svg"),a.setAttribute("viewBox","0 0 ".concat(t," ").concat(500)),a.setAttribute("width","".concat(t)),a.setAttribute("height","".concat(500)),a.style.display="block";for(var i=0;i<n.length;i++)switch(n[i].type){case"conv2d":jE(a,i,n[i].num_of_kernels);break;case"maxPool2d":case"avgPool2d":UE(a,i);break;default:PE(a,n,r,i)}e.appendChild(a)}()}),[n]),(0,bE.jsxs)("div",{children:[(0,bE.jsx)(QT,{isOpen:c,addLayer:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dense",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t){case"conv2d":e={kernel_size:a.kernel_size,num_of_kernels:a.num_of_kernels,padding:a.padding,stride:a.stride,type:ME,number:n.length+1};break;case"maxPool2d":e={kernel_size:a.kernel_size,stride:a.stride,type:OE,number:n.length+1};break;case"avgPool2d":e={kernel_size:a.kernel_size,stride:a.stride,type:RE,number:n.length+1};break;default:e={neurons:1,type:IE,number:n.length+1}}r([].concat((0,o.Z)(n),[e]))},onClose:function(){return l(!1)},denseLayer:h,setDenseLayer:p}),(0,bE.jsxs)("div",{className:KT,children:[(0,bE.jsx)(bT,{className:$T+" text-blue-400",onClick:function(){l(!0)}}),(0,bE.jsx)(xT,{className:$T+" text-blue-400",onClick:function(){!function(e,t){e.pop(),t((0,o.Z)(e))}(n,r),p(function(){if("mnist"!==a)return!0;for(var e=n.length-1;e>-1;e--)if("dense"===n[e].type)return!0;return!1}())}}),n.length," Hidden",n.length>1?" Layers":" Layer"]}),(0,bE.jsx)("p",{className:"mx-auto w-fit text-sm text-gray-500",children:"Input/Output layers are handled by default"}),(0,bE.jsx)("div",{id:"network",className:"overflow-auto overflow-y-auto mx-auto mb-10 w-4/5",style:{height:"500px"}})]})},eN=function(e){var n=ue().state,r=(0,t.useState)(null!==n?n.layers:[]),a=(0,i.Z)(r,2),o=a[0],u=a[1],s=(0,t.useState)("iris"),c=(0,i.Z)(s,2),l=c[0],f=c[1];return(0,bE.jsxs)("div",{style:{border:"1px solid transparent",backgroundColor:"rgba(255, 255, 255, 0.75)"},children:[(0,bE.jsx)(YT,{layers:o,model:null!==n?n:null,dataset:l,setDataset:function(e){f(e),console.log("Dataset changed")}}),(0,bE.jsx)(JT,{layers:o,updateLayers:u,dataset:l})]})},tN=function(){var e=(0,t.useState)(""),n=(0,i.Z)(e,2),r=(n[0],n[1]),a=(0,t.useState)(""),o=(0,i.Z)(a,2),u=(o[0],o[1]),s=(0,t.useState)(""),c=(0,i.Z)(s,2),l=(c[0],c[1]),f=(0,t.useState)(""),d=(0,i.Z)(f,2),h=(d[0],d[1]),p=(0,t.useState)(""),v=(0,i.Z)(p,2),g=(v[0],v[1],(0,t.useState)("")),m=(0,i.Z)(g,2),y=(m[0],m[1]),b=(0,t.useState)(""),x=(0,i.Z)(b,2),k=(x[0],x[1]),w=(0,t.useState)(""),_=(0,i.Z)(w,2),C=(_[0],_[1]),S=(0,t.useState)(""),A=(0,i.Z)(S,2),E=A[0],T=A[1],N=null;return N=E?(0,bE.jsx)("div",{style:{backgroundImage:"url(".concat(E,")"),backgroundSize:"cover",backgroundPosition:"center",width:200,height:200,borderRadius:"50%"}}):(0,bE.jsx)("div",{style:{backgroundImage:"url(https://www.google.com/url?sa=i&url=https%3A%2F%2Fwww.freepik.com%2Ffree-photos-vectors%2Fboy-standing&psig=AOvVaw1uGs-_k8ZWbsXGyHJCXqUp&ust=1675958955488000&source=images&cd=vfe&ved=0CA8QjRxqFwoTCPC9yuOnhv0CFQAAAAAdAAAAABAG)",width:200,height:200,borderRadius:"50%",backgroundColor:"white",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,bE.jsx)("p",{children:"Please select an image"})}),(0,bE.jsx)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.75)"},className:"flex items-center",children:(0,bE.jsx)("div",{className:"ml-28 mr-28",children:(0,bE.jsxs)("div",{children:[(0,bE.jsx)("h2",{className:" text-4xl text-black mt-5 mb-5",children:"Public Profile"}),(0,bE.jsx)("div",{children:(0,bE.jsxs)("form",{className:" ml-28",children:[(0,bE.jsxs)("div",{className:"flex flex-column max-w-full",children:[(0,bE.jsxs)("div",{children:[(0,bE.jsxs)("div",{className:"w-80 mb-6",children:[(0,bE.jsx)("label",{children:"Name"}),(0,bE.jsx)("br",{}),(0,bE.jsx)("input",{type:"text",className:"rounded-md p-1 shadow-md w-80 h-8 mx-auto",placeholder:"Talha Munir",onChange:r}),(0,bE.jsx)("br",{}),(0,bE.jsx)("label",{className:"text-sm font-thin text-gray-500",children:"Your name may appear around SOMA where you contribute or are mentioned."})]}),(0,bE.jsxs)("div",{className:"w-80 mb-6",children:[(0,bE.jsx)("label",{children:"Email"}),(0,bE.jsx)("br",{}),(0,bE.jsx)("input",{type:"email",placeholder:"abcd@gmail.com",className:"rounded-md p-1 shadow-md h-8 mx-auto w-80",onChange:u}),(0,bE.jsx)("br",{})]}),(0,bE.jsxs)("div",{className:"w-80 mb-6",children:[(0,bE.jsx)("label",{children:"Bio"}),(0,bE.jsx)("br",{}),(0,bE.jsx)("textarea",{type:"text",placeholder:"Tell us a little bit about yourself",className:"rounded-md p-1 shadow-md mx-auto w-80 h-32",onChange:l})]})]}),(0,bE.jsxs)("div",{className:" mx-auto ml-96",children:[(0,bE.jsxs)("div",{children:[" ",N]}),(0,bE.jsx)("br",{}),(0,bE.jsx)("input",{type:"file",id:"files",className:"text-transparent",onChange:function(e){e.preventDefault();var t=new FileReader,n=e.target.files[0];t.onloadend=function(){C(n),T(t.result)},t.readAsDataURL(n)}})]})]}),(0,bE.jsxs)("div",{className:"w-80 mb-6",children:[(0,bE.jsx)("label",{children:"URL"}),(0,bE.jsx)("br",{}),(0,bE.jsx)("input",{type:"url",placeholder:"URL of your linkedin profile",className:"rounded-md p-1 shadow-md w-80 h-8 mx-auto",onChange:h}),(0,bE.jsx)("label",{})]}),(0,bE.jsxs)("div",{className:"w-80 mb-6",children:[(0,bE.jsx)("label",{children:"Company"}),(0,bE.jsx)("br",{}),(0,bE.jsx)("input",{type:"text",placeholder:"e.g Bitnine Global",className:"rounded-md p-1 shadow-md w-80 h-8 mx-auto",onChange:y}),(0,bE.jsx)("label",{className:"text-sm font-thin text-gray-500",children:"You can mention your company name or your school name here"})]}),(0,bE.jsxs)("div",{className:"w-80 mb-6",children:[(0,bE.jsx)("label",{children:"Location"}),(0,bE.jsx)("br",{}),(0,bE.jsx)("input",{type:"text",placeholder:"Provide your country name here",className:"rounded-md p-1 shadow-md w-80 h-8 mx-auto",onChange:k})]}),(0,bE.jsx)("button",{className:"bg-purple-800 hover:bg-purple-900 text-xl text-white rounded-lg mt-1 ml-96 mb-10 w-44 h-10",children:"Update Profile"})]})})]})})})};var nN=function(){return(0,t.useEffect)((function(){Re.ready().then((function(){console.log("TensorFlow Ready")}))}),[]),(0,bE.jsxs)("div",{className:"",children:[(0,bE.jsx)(QE,{}),(0,bE.jsxs)(we,{children:[(0,bE.jsx)(xe,{path:"/",element:(0,bE.jsx)(be,{to:"/model",replace:!0})}),(0,bE.jsx)(xe,{path:"/model",element:(0,bE.jsx)(eN,{})}),(0,bE.jsx)(xe,{path:"/profile",element:(0,bE.jsx)(JE,{children:(0,bE.jsx)(nT,{})})}),(0,bE.jsx)(xe,{path:"/settings",element:(0,bE.jsx)(JE,{children:(0,bE.jsx)(tN,{})})})]})]})},rN=function(){var e=wE(),n=se(),r=(0,t.useState)(""),a=(0,i.Z)(r,2),o=a[0],u=a[1],s=(0,t.useState)(""),c=(0,i.Z)(s,2),l=c[0],f=c[1],d=(0,t.useState)(!1),h=(0,i.Z)(d,2),p=h[0],v=h[1],g=function(){return v(!1)},m=function(t){t.preventDefault(),fetch(ZE+"/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:o,password:l})}).then((function(e){return e.json()})).then((function(t){return t.user?(localStorage.setItem("soma_token",t.user),localStorage.setItem("user",t.id),e.login(!0),n("/profile",{replace:!0}),void v(!1)):(v(!0),setTimeout(g,3e3),void e.logout())})).catch((function(e){return console.log(e)}))};return(0,bE.jsxs)("div",{children:[(0,bE.jsx)(QE,{}),(0,bE.jsx)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.75)"},className:"flex h-screen items-center",children:(0,bE.jsx)("div",{className:"bg-slate-50 container mx-auto py-6 w-96 max-h-max shadow-lg rounded-md p-1",children:(0,bE.jsxs)("form",{className:"grid justify-center",children:[(0,bE.jsx)("h1",{className:"text-4xl text-purple-500 mx-auto mb-5",children:"Login to SOMA"}),(0,bE.jsx)("br",{}),(0,bE.jsxs)("label",{className:"text-[#a454fc] mb-1",children:["Username ",(0,bE.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,bE.jsx)("input",{className:"rounded-md p-1 mx-auto mb-8 shadow-md w-full h-8",type:"email",placeholder:"e.g talhahaha",value:o,onChange:function(e){return u(e.target.value)}}),(0,bE.jsxs)("label",{className:"text-[#a454fc] mb-1",children:["Password ",(0,bE.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,bE.jsx)("input",{className:"rounded-md p-1 mx-auto shadow-md w-full h-8",type:"password",placeholder:"Password",value:l,onChange:function(e){return f(e.target.value)}}),p?(0,bE.jsx)("div",{className:"text-red-500 mx-auto mt-2",children:"Incorrect Username or Password"}):"",(0,bE.jsx)("button",{className:"bg-purple-900 hover:bg-purple-800 mt-10 font-sans text-xl text-white rounded-lg w-80 h-12 mb-5",onClick:function(e){return m(e)},children:"Log in"})]})})})]})},aN=function(){var e=wE(),n=se(),r=(0,t.useState)(""),a=(0,i.Z)(r,2),o=a[0],u=a[1],s=(0,t.useState)(""),c=(0,i.Z)(s,2),l=c[0],f=c[1],d=(0,t.useState)(""),h=(0,i.Z)(d,2),p=h[0],v=h[1],g=(0,t.useState)(!1),m=(0,i.Z)(g,2),y=m[0],b=m[1],x=(0,t.useState)(!1),k=(0,i.Z)(x,2),w=k[0],_=k[1],C=function(){return b(!1)},S=function(){return _(!1)},A=function(){b(!0),setTimeout(C,3e3)},E=function(t){t.preventDefault(),""===o&&""===l&&""===p||l!==p?A():""===o?(_(!0),setTimeout(S,3e3)):fetch(ZE+"/users/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:o,password:l})}).then((function(e){return e.json()})).then((function(t){return t.user?(localStorage.setItem("soma_token",t.user),localStorage.setItem("user",t.id),e.login(!0),n("/profile",{replace:!0}),void b(!1)):(A(),void e.logout())})).catch((function(e){return console.log(e)}))};return(0,bE.jsxs)("div",{children:[(0,bE.jsx)(QE,{}),(0,bE.jsx)("div",{style:{backgroundColor:"rgba(255, 255, 255, 0.75)"},className:"flex items-center h-screen",children:(0,bE.jsx)("div",{className:"bg-slate-50 container mx-auto py-6 w-96 max-h-max shadow-lg rounded-md p-1",children:(0,bE.jsxs)("form",{className:"grid justify-center",children:[(0,bE.jsx)("h1",{className:"text-4xl text-purple-500 mx-auto mb-5",children:"SignUp for SOMA"}),(0,bE.jsxs)("label",{className:"text-[#a454fc] mb-1",children:["Username ",(0,bE.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,bE.jsx)("input",{className:"rounded-md p-1 shadow-md w-full h-8 mx-auto mb-3",type:"email",placeholder:"e.g talhahahae",value:o,onChange:function(e){return u(e.target.value)}}),(0,bE.jsxs)("label",{className:"text-[#a454fc] mb-1",children:["Password ",(0,bE.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,bE.jsx)("input",{className:"rounded-md p-1 shadow-md w-full h-8 mx-auto mb-3",type:"password",placeholder:"Password",value:l,onChange:function(e){return f(e.target.value)}}),(0,bE.jsxs)("label",{className:"text-[#a454fc] mb-1",children:["Confirm Password ",(0,bE.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,bE.jsx)("input",{className:"rounded-md p-1 shadow-md w-full h-8 mx-auto",type:"password",placeholder:"Confirm Password",value:p,onChange:function(e){return v(e.target.value)}}),y?(0,bE.jsxs)("div",{className:"text-red-500 mx-auto mt-2",children:["Password and Confirm password must match.",(0,bE.jsx)("br",{}),"Required fields marked with *"]}):"",w?(0,bE.jsx)("div",{className:"text-red-500 mx-auto mt-2",children:"Username cannot be empty."}):"",(0,bE.jsx)("button",{className:"bg-purple-900 hover:bg-purple-800 mt-10 font-sans text-2xl text-white rounded-lg w-80 h-12 mb-5",onClick:function(e){return E(e)},children:"Sign Up"})]})})})]})};a.createRoot(document.getElementById("root")).render((0,bE.jsx)(kE,{children:(0,bE.jsx)(Ne,{children:(0,bE.jsxs)(we,{children:[(0,bE.jsx)(xe,{path:"/*",element:(0,bE.jsx)(nN,{})}),(0,bE.jsx)(xe,{path:"/login",element:(0,bE.jsx)(rN,{})}),(0,bE.jsx)(xe,{path:"/signUp",element:(0,bE.jsx)(aN,{})})]})})}))}()}();
//# sourceMappingURL=main.fc8ebd8b.js.map